# ====================================================================
# FILE: strawberry/aiohttp/views.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 73-122 ---
    73| ):
    74|     _is_coroutine = asyncio.coroutines._is_coroutine  # type: ignore[attr-defined]
    75|     graphql_transport_ws_handler_class = GraphQLTransportWSHandler
    76|     graphql_ws_handler_class = GraphQLWSHandler
    77|     allow_queries_via_get = True
    78|     request_adapter_class = AioHTTPRequestAdapter
    79|     def __init__(
    80|         self,
    81|         schema: BaseSchema,
    82|         graphiql: Optional[bool] = None,
    83|         graphql_ide: Optional[GraphQL_IDE] = "graphiql",
    84|         allow_queries_via_get: bool = True,
    85|         keep_alive: bool = True,
    86|         keep_alive_interval: float = 1,
    87|         debug: bool = False,
    88|         subscription_protocols: Iterable[str] = (
    89|             GRAPHQL_TRANSPORT_WS_PROTOCOL,
    90|             GRAPHQL_WS_PROTOCOL,
    91|         ),
    92|         connection_init_wait_timeout: timedelta = timedelta(minutes=1),
    93|         multipart_uploads_enabled: bool = False,
    94|     ) -> None:
    95|         self.schema = schema
    96|         self.allow_queries_via_get = allow_queries_via_get
    97|         self.keep_alive = keep_alive
    98|         self.keep_alive_interval = keep_alive_interval
    99|         self.debug = debug
   100|         self.subscription_protocols = subscription_protocols
   101|         self.connection_init_wait_timeout = connection_init_wait_timeout
   102|         self.multipart_uploads_enabled = multipart_uploads_enabled
   103|         if graphiql is not None:
   104|             warnings.warn(
   105|                 "The `graphiql` argument is deprecated in favor of `graphql_ide`",
   106|                 DeprecationWarning,
   107|                 stacklevel=2,
   108|             )
   109|             self.graphql_ide = "graphiql" if graphiql else None
   110|         else:
   111|             self.graphql_ide = graphql_ide
   112|     async def render_graphql_ide(self, request: web.Request) -> web.Response:
   113|         return web.Response(text=self.graphql_ide_html, content_type="text/html")
   114|     async def get_sub_response(self, request: web.Request) -> web.Response:
   115|         return web.Response()
   116|     async def __call__(self, request: web.Request) -> web.StreamResponse:
   117|         ws = web.WebSocketResponse(protocols=self.subscription_protocols)
   118|         ws_test = ws.can_prepare(request)
   119|         if not ws_test.ok:
   120|             try:
   121|                 return await self.run(request=request)
   122|             except HTTPException as e:


# ====================================================================
# FILE: strawberry/asgi/__init__.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 72-121 ---
    72|     ]
    73| ):
    74|     graphql_transport_ws_handler_class = GraphQLTransportWSHandler
    75|     graphql_ws_handler_class = GraphQLWSHandler
    76|     allow_queries_via_get = True
    77|     request_adapter_class = ASGIRequestAdapter  # pyright: ignore
    78|     def __init__(
    79|         self,
    80|         schema: BaseSchema,
    81|         graphiql: Optional[bool] = None,
    82|         graphql_ide: Optional[GraphQL_IDE] = "graphiql",
    83|         allow_queries_via_get: bool = True,
    84|         keep_alive: bool = False,
    85|         keep_alive_interval: float = 1,
    86|         debug: bool = False,
    87|         subscription_protocols: Sequence[str] = (
    88|             GRAPHQL_TRANSPORT_WS_PROTOCOL,
    89|             GRAPHQL_WS_PROTOCOL,
    90|         ),
    91|         connection_init_wait_timeout: timedelta = timedelta(minutes=1),
    92|         multipart_uploads_enabled: bool = False,
    93|     ) -> None:
    94|         self.schema = schema
    95|         self.allow_queries_via_get = allow_queries_via_get
    96|         self.keep_alive = keep_alive
    97|         self.keep_alive_interval = keep_alive_interval
    98|         self.debug = debug
    99|         self.protocols = subscription_protocols
   100|         self.connection_init_wait_timeout = connection_init_wait_timeout
   101|         self.multipart_uploads_enabled = multipart_uploads_enabled
   102|         if graphiql is not None:
   103|             warnings.warn(
   104|                 "The `graphiql` argument is deprecated in favor of `graphql_ide`",
   105|                 DeprecationWarning,
   106|                 stacklevel=2,
   107|             )
   108|             self.graphql_ide = "graphiql" if graphiql else None
   109|         else:
   110|             self.graphql_ide = graphql_ide
   111|     async def __call__(self, scope: Scope, receive: Receive, send: Send) -> None:
   112|         if scope["type"] == "http":
   113|             return await self.handle_http(scope, receive, send)
   114|         elif scope["type"] == "websocket":
   115|             ws = WebSocket(scope, receive=receive, send=send)
   116|             preferred_protocol = self.pick_preferred_protocol(ws)
   117|             if preferred_protocol == GRAPHQL_TRANSPORT_WS_PROTOCOL:
   118|                 await self.graphql_transport_ws_handler_class(
   119|                     schema=self.schema,
   120|                     debug=self.debug,
   121|                     connection_init_wait_timeout=self.connection_init_wait_timeout,


# ====================================================================
# FILE: strawberry/channels/handlers/http_handler.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 112-159 ---
   112| class SyncChannelsRequestAdapter(BaseChannelsRequestAdapter, SyncHTTPRequestAdapter):
   113|     @property
   114|     def body(self) -> bytes:
   115|         return self.request.body
   116|     @property
   117|     def post_data(self) -> Mapping[str, Union[str, bytes]]:
   118|         return self.request.form_data["form"]
   119|     @property
   120|     def files(self) -> Mapping[str, Any]:
   121|         return self.request.form_data["files"]
   122| class BaseGraphQLHTTPConsumer(ChannelsConsumer, AsyncHttpConsumer):
   123|     graphql_ide_html: str
   124|     graphql_ide: Optional[GraphQL_IDE] = "graphiql"
   125|     def __init__(
   126|         self,
   127|         schema: BaseSchema,
   128|         graphiql: Optional[bool] = None,
   129|         graphql_ide: Optional[GraphQL_IDE] = "graphiql",
   130|         allow_queries_via_get: bool = True,
   131|         subscriptions_enabled: bool = True,
   132|         multipart_uploads_enabled: bool = False,
   133|         **kwargs: Any,
   134|     ) -> None:
   135|         self.schema = schema
   136|         self.allow_queries_via_get = allow_queries_via_get
   137|         self.subscriptions_enabled = subscriptions_enabled
   138|         self._ide_subscriptions_enabled = subscriptions_enabled
   139|         self.multipart_uploads_enabled = multipart_uploads_enabled
   140|         if graphiql is not None:
   141|             warnings.warn(
   142|                 "The `graphiql` argument is deprecated in favor of `graphql_ide`",
   143|                 DeprecationWarning,
   144|                 stacklevel=2,
   145|             )
   146|             self.graphql_ide = "graphiql" if graphiql else None
   147|         else:
   148|             self.graphql_ide = graphql_ide
   149|         super().__init__(**kwargs)
   150|     def create_response(
   151|         self, response_data: GraphQLHTTPResponse, sub_response: TemporalResponse
   152|     ) -> ChannelsResponse:
   153|         return ChannelsResponse(
   154|             content=json.dumps(response_data).encode(),
   155|             status=sub_response.status_code,
   156|             headers={k.encode(): v.encode() for k, v in sub_response.headers.items()},
   157|         )
   158|     async def handle(self, body: bytes) -> None:
   159|         request = ChannelsRequest(consumer=self, body=body)


# ====================================================================
# FILE: strawberry/django/views.py
# Total hunks: 4
# ====================================================================
# --- HUNK 1: Lines 9-49 ---
     9|     Dict,
    10|     Mapping,
    11|     Optional,
    12|     Union,
    13|     cast,
    14| )
    15| from asgiref.sync import markcoroutinefunction
    16| from django.core.serializers.json import DjangoJSONEncoder
    17| from django.http import (
    18|     HttpRequest,
    19|     HttpResponse,
    20|     HttpResponseNotAllowed,
    21|     JsonResponse,
    22|     StreamingHttpResponse,
    23| )
    24| from django.http.response import HttpResponseBase
    25| from django.template import RequestContext, Template
    26| from django.template.exceptions import TemplateDoesNotExist
    27| from django.template.loader import render_to_string
    28| from django.template.response import TemplateResponse
    29| from django.utils.decorators import classonlymethod
    30| from django.views.generic import View
    31| from strawberry.http.async_base_view import AsyncBaseHTTPView, AsyncHTTPRequestAdapter
    32| from strawberry.http.exceptions import HTTPException
    33| from strawberry.http.sync_base_view import SyncBaseHTTPView, SyncHTTPRequestAdapter
    34| from strawberry.http.types import FormData, HTTPMethod, QueryParams
    35| from strawberry.http.typevars import (
    36|     Context,
    37|     RootValue,
    38| )
    39| from .context import StrawberryDjangoContext
    40| if TYPE_CHECKING:
    41|     from strawberry.http import GraphQLHTTPResponse
    42|     from strawberry.http.ides import GraphQL_IDE
    43|     from ..schema import BaseSchema
    44| class TemporalHttpResponse(JsonResponse):
    45|     status_code: Optional[int] = None  # pyright: ignore
    46|     def __init__(self) -> None:
    47|         super().__init__({})
    48|     def __repr__(self) -> str:
    49|         """Adopted from Django to handle `status_code=None`."""

# --- HUNK 2: Lines 95-141 ---
    95|     @property
    96|     def content_type(self) -> Optional[str]:
    97|         return self.headers.get("Content-type")
    98|     async def get_body(self) -> str:
    99|         return self.request.body.decode()
   100|     async def get_form_data(self) -> FormData:
   101|         return FormData(
   102|             files=self.request.FILES,
   103|             form=self.request.POST,
   104|         )
   105| class BaseView:
   106|     _ide_replace_variables = False
   107|     graphql_ide_html: str
   108|     def __init__(
   109|         self,
   110|         schema: BaseSchema,
   111|         graphiql: Optional[str] = None,
   112|         graphql_ide: Optional[GraphQL_IDE] = "graphiql",
   113|         allow_queries_via_get: bool = True,
   114|         subscriptions_enabled: bool = False,
   115|         multipart_uploads_enabled: bool = False,
   116|         **kwargs: Any,
   117|     ) -> None:
   118|         self.schema = schema
   119|         self.allow_queries_via_get = allow_queries_via_get
   120|         self.subscriptions_enabled = subscriptions_enabled
   121|         self.multipart_uploads_enabled = multipart_uploads_enabled
   122|         if graphiql is not None:
   123|             warnings.warn(
   124|                 "The `graphiql` argument is deprecated in favor of `graphql_ide`",
   125|                 DeprecationWarning,
   126|                 stacklevel=2,
   127|             )
   128|             self.graphql_ide = "graphiql" if graphiql else None
   129|         else:
   130|             self.graphql_ide = graphql_ide
   131|         super().__init__(**kwargs)
   132|     def create_response(
   133|         self, response_data: GraphQLHTTPResponse, sub_response: HttpResponse
   134|     ) -> HttpResponseBase:
   135|         data = self.encode_json(response_data)
   136|         response = HttpResponse(
   137|             data,
   138|             content_type="application/json",
   139|         )
   140|         for name, value in sub_response.items():
   141|             response[name] = value

# --- HUNK 3: Lines 163-202 ---
   163|         return json.dumps(response_data, cls=DjangoJSONEncoder)
   164| class GraphQLView(
   165|     BaseView,
   166|     SyncBaseHTTPView[
   167|         HttpRequest, HttpResponseBase, TemporalHttpResponse, Context, RootValue
   168|     ],
   169|     View,
   170| ):
   171|     subscriptions_enabled = False
   172|     graphiql: Optional[bool] = None
   173|     graphql_ide: Optional[GraphQL_IDE] = "graphiql"
   174|     allow_queries_via_get = True
   175|     schema: BaseSchema = None  # type: ignore
   176|     request_adapter_class = DjangoHTTPRequestAdapter
   177|     def get_root_value(self, request: HttpRequest) -> Optional[RootValue]:
   178|         return None
   179|     def get_context(self, request: HttpRequest, response: HttpResponse) -> Any:
   180|         return StrawberryDjangoContext(request=request, response=response)
   181|     def get_sub_response(self, request: HttpRequest) -> TemporalHttpResponse:
   182|         return TemporalHttpResponse()
   183|     def dispatch(
   184|         self, request: HttpRequest, *args: Any, **kwargs: Any
   185|     ) -> Union[HttpResponseNotAllowed, TemplateResponse, HttpResponseBase]:
   186|         try:
   187|             return self.run(request=request)
   188|         except HTTPException as e:
   189|             return HttpResponse(
   190|                 content=e.reason,
   191|                 status=e.status_code,
   192|             )
   193|     def render_graphql_ide(self, request: HttpRequest) -> HttpResponse:
   194|         try:
   195|             template = Template(render_to_string("graphql/graphiql.html"))
   196|         except TemplateDoesNotExist:
   197|             template = Template(self.graphql_ide_html)
   198|         context = {"SUBSCRIPTION_ENABLED": json.dumps(self.subscriptions_enabled)}
   199|         response = TemplateResponse(request=request, template=None, context=context)
   200|         response.content = template.render(RequestContext(request, context))
   201|         return response
   202| class AsyncGraphQLView(

# --- HUNK 4: Lines 206-245 ---
   206|     ],
   207|     View,
   208| ):
   209|     subscriptions_enabled = False
   210|     graphiql: Optional[bool] = None
   211|     graphql_ide: Optional[GraphQL_IDE] = "graphiql"
   212|     allow_queries_via_get = True
   213|     schema: BaseSchema = None  # type: ignore
   214|     request_adapter_class = AsyncDjangoHTTPRequestAdapter
   215|     @classonlymethod  # pyright: ignore[reportIncompatibleMethodOverride]
   216|     def as_view(cls, **initkwargs: Any) -> Callable[..., HttpResponse]:
   217|         view = super().as_view(**initkwargs)
   218|         markcoroutinefunction(view)
   219|         return view
   220|     async def get_root_value(self, request: HttpRequest) -> Any:
   221|         return None
   222|     async def get_context(self, request: HttpRequest, response: HttpResponse) -> Any:
   223|         return StrawberryDjangoContext(request=request, response=response)
   224|     async def get_sub_response(self, request: HttpRequest) -> TemporalHttpResponse:
   225|         return TemporalHttpResponse()
   226|     async def dispatch(  # pyright: ignore
   227|         self, request: HttpRequest, *args: Any, **kwargs: Any
   228|     ) -> Union[HttpResponseNotAllowed, TemplateResponse, HttpResponseBase]:
   229|         try:
   230|             return await self.run(request=request)
   231|         except HTTPException as e:
   232|             return HttpResponse(
   233|                 content=e.reason,
   234|                 status=e.status_code,
   235|             )
   236|     async def render_graphql_ide(self, request: HttpRequest) -> HttpResponse:
   237|         try:
   238|             template = Template(render_to_string("graphql/graphiql.html"))
   239|         except TemplateDoesNotExist:
   240|             template = Template(self.graphql_ide_html)
   241|         context = {"SUBSCRIPTION_ENABLED": json.dumps(self.subscriptions_enabled)}
   242|         response = TemplateResponse(request=request, template=None, context=context)
   243|         response.content = template.render(RequestContext(request, context))
   244|         return response
   245| __all__ = ["GraphQLView", "AsyncGraphQLView"]


# ====================================================================
# FILE: strawberry/fastapi/router.py
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 121-195 ---
   121|         connection_init_wait_timeout: timedelta = timedelta(minutes=1),
   122|         prefix: str = "",
   123|         tags: Optional[List[Union[str, Enum]]] = None,
   124|         dependencies: Optional[Sequence[params.Depends]] = None,
   125|         default_response_class: Type[Response] = Default(JSONResponse),
   126|         responses: Optional[Dict[Union[int, str], Dict[str, Any]]] = None,
   127|         callbacks: Optional[List[BaseRoute]] = None,
   128|         routes: Optional[List[BaseRoute]] = None,
   129|         redirect_slashes: bool = True,
   130|         default: Optional[ASGIApp] = None,
   131|         dependency_overrides_provider: Optional[Any] = None,
   132|         route_class: Type[APIRoute] = APIRoute,
   133|         on_startup: Optional[Sequence[Callable[[], Any]]] = None,
   134|         on_shutdown: Optional[Sequence[Callable[[], Any]]] = None,
   135|         lifespan: Optional[Lifespan[Any]] = None,
   136|         deprecated: Optional[bool] = None,
   137|         include_in_schema: bool = True,
   138|         generate_unique_id_function: Callable[[APIRoute], str] = Default(
   139|             generate_unique_id
   140|         ),
   141|         multipart_uploads_enabled: bool = False,
   142|         **kwargs: Any,
   143|     ) -> None:
   144|         super().__init__(
   145|             prefix=prefix,
   146|             tags=tags,
   147|             dependencies=dependencies,
   148|             default_response_class=default_response_class,
   149|             responses=responses,
   150|             callbacks=callbacks,
   151|             routes=routes,
   152|             redirect_slashes=redirect_slashes,
   153|             default=default,
   154|             dependency_overrides_provider=dependency_overrides_provider,
   155|             route_class=route_class,
   156|             on_startup=on_startup,
   157|             on_shutdown=on_shutdown,
   158|             lifespan=lifespan,
   159|             deprecated=deprecated,
   160|             include_in_schema=include_in_schema,
   161|             generate_unique_id_function=generate_unique_id_function,
   162|             **kwargs,
   163|         )
   164|         self.schema = schema
   165|         self.allow_queries_via_get = allow_queries_via_get
   166|         self.keep_alive = keep_alive
   167|         self.keep_alive_interval = keep_alive_interval
   168|         self.debug = debug
   169|         self.root_value_getter = root_value_getter or self.__get_root_value
   170|         self.context_getter = self.__get_context_getter(
   171|             context_getter or (lambda: None)  # type: ignore
   172|         )
   173|         self.protocols = subscription_protocols
   174|         self.connection_init_wait_timeout = connection_init_wait_timeout
   175|         self.multipart_uploads_enabled = multipart_uploads_enabled
   176|         if graphiql is not None:
   177|             warnings.warn(
   178|                 "The `graphiql` argument is deprecated in favor of `graphql_ide`",
   179|                 DeprecationWarning,
   180|                 stacklevel=2,
   181|             )
   182|             self.graphql_ide = "graphiql" if graphiql else None
   183|         else:
   184|             self.graphql_ide = graphql_ide
   185|         @self.get(
   186|             path,
   187|             responses={
   188|                 200: {
   189|                     "description": "The GraphiQL integrated development environment.",
   190|                 },
   191|                 404: {
   192|                     "description": (
   193|                         "Not found if GraphiQL or query via GET are not enabled."
   194|                     )
   195|                 },


# ====================================================================
# FILE: strawberry/flask/views.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 39-84 ---
    39|     def headers(self) -> Mapping[str, str]:
    40|         return self.request.headers
    41|     @property
    42|     def post_data(self) -> Mapping[str, Union[str, bytes]]:
    43|         return self.request.form
    44|     @property
    45|     def files(self) -> Mapping[str, Any]:
    46|         return self.request.files
    47|     @property
    48|     def content_type(self) -> Optional[str]:
    49|         return self.request.content_type
    50| class BaseGraphQLView:
    51|     _ide_subscription_enabled = False
    52|     graphql_ide: Optional[GraphQL_IDE]
    53|     def __init__(
    54|         self,
    55|         schema: BaseSchema,
    56|         graphiql: Optional[bool] = None,
    57|         graphql_ide: Optional[GraphQL_IDE] = "graphiql",
    58|         allow_queries_via_get: bool = True,
    59|         multipart_uploads_enabled: bool = False,
    60|     ) -> None:
    61|         self.schema = schema
    62|         self.graphiql = graphiql
    63|         self.allow_queries_via_get = allow_queries_via_get
    64|         self.multipart_uploads_enabled = multipart_uploads_enabled
    65|         if graphiql is not None:
    66|             warnings.warn(
    67|                 "The `graphiql` argument is deprecated in favor of `graphql_ide`",
    68|                 DeprecationWarning,
    69|                 stacklevel=2,
    70|             )
    71|             self.graphql_ide = "graphiql" if graphiql else None
    72|         else:
    73|             self.graphql_ide = graphql_ide
    74|     def create_response(
    75|         self, response_data: GraphQLHTTPResponse, sub_response: Response
    76|     ) -> Response:
    77|         sub_response.set_data(self.encode_json(response_data))  # type: ignore
    78|         return sub_response
    79| class GraphQLView(
    80|     BaseGraphQLView,
    81|     SyncBaseHTTPView[Request, Response, Response, Context, RootValue],
    82|     View,
    83| ):
    84|     methods = ["GET", "POST"]


# ====================================================================
# FILE: strawberry/http/async_base_view.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 248-282 ---
   248|         return self._stream_with_heartbeat(stream)
   249|     async def parse_multipart_subscriptions(
   250|         self, request: AsyncHTTPRequestAdapter
   251|     ) -> Dict[str, str]:
   252|         if request.method == "GET":
   253|             return self.parse_query_params(request.query_params)
   254|         return self.parse_json(await request.get_body())
   255|     async def parse_http_body(
   256|         self, request: AsyncHTTPRequestAdapter
   257|     ) -> GraphQLRequestData:
   258|         headers = {key.lower(): value for key, value in request.headers.items()}
   259|         content_type, _ = parse_content_type(request.content_type or "")
   260|         accept = headers.get("accept", "")
   261|         protocol: Literal["http", "multipart-subscription"] = "http"
   262|         if self._is_multipart_subscriptions(*parse_content_type(accept)):
   263|             protocol = "multipart-subscription"
   264|         if request.method == "GET":
   265|             data = self.parse_query_params(request.query_params)
   266|         elif "application/json" in content_type:
   267|             data = self.parse_json(await request.get_body())
   268|         elif self.multipart_uploads_enabled and content_type == "multipart/form-data":
   269|             data = await self.parse_multipart(request)
   270|         else:
   271|             raise HTTPException(400, "Unsupported content type")
   272|         return GraphQLRequestData(
   273|             query=data.get("query"),
   274|             variables=data.get("variables"),
   275|             operation_name=data.get("operationName"),
   276|             protocol=protocol,
   277|         )
   278|     async def process_result(
   279|         self, request: Request, result: ExecutionResult
   280|     ) -> GraphQLHTTPResponse:
   281|         return process_result(result)
   282| __all__ = ["AsyncBaseHTTPView"]


# ====================================================================
# FILE: strawberry/http/base.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-38 ---
     1| import json
     2| from typing import Any, Dict, Generic, List, Mapping, Optional, Union
     3| from typing_extensions import Protocol
     4| from strawberry.http import GraphQLHTTPResponse
     5| from strawberry.http.ides import GraphQL_IDE, get_graphql_ide_html
     6| from strawberry.http.types import HTTPMethod, QueryParams
     7| from .exceptions import HTTPException
     8| from .typevars import Request
     9| class BaseRequestProtocol(Protocol):
    10|     @property
    11|     def query_params(self) -> Mapping[str, Optional[Union[str, List[str]]]]: ...
    12|     @property
    13|     def method(self) -> HTTPMethod: ...
    14|     @property
    15|     def headers(self) -> Mapping[str, str]: ...
    16| class BaseView(Generic[Request]):
    17|     graphql_ide: Optional[GraphQL_IDE]
    18|     multipart_uploads_enabled: bool = False
    19|     _ide_replace_variables: bool = True
    20|     _ide_subscription_enabled: bool = True
    21|     def should_render_graphql_ide(self, request: BaseRequestProtocol) -> bool:
    22|         return (
    23|             request.method == "GET"
    24|             and request.query_params.get("query") is None
    25|             and any(
    26|                 supported_header in request.headers.get("accept", "")
    27|                 for supported_header in ("text/html", "*/*")
    28|             )
    29|         )
    30|     def is_request_allowed(self, request: BaseRequestProtocol) -> bool:
    31|         return request.method in ("GET", "POST")
    32|     def parse_json(self, data: Union[str, bytes]) -> Any:
    33|         try:
    34|             return json.loads(data)
    35|         except json.JSONDecodeError as e:
    36|             raise HTTPException(400, "Unable to parse request body as JSON") from e
    37|     def encode_json(self, response_data: GraphQLHTTPResponse) -> str:
    38|         return json.dumps(response_data)


# ====================================================================
# FILE: strawberry/http/sync_base_view.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 93-133 ---
    93|             request_data.query,
    94|             root_value=root_value,
    95|             variable_values=request_data.variables,
    96|             context_value=context,
    97|             operation_name=request_data.operation_name,
    98|             allowed_operation_types=allowed_operation_types,
    99|         )
   100|     def parse_multipart(self, request: SyncHTTPRequestAdapter) -> Dict[str, str]:
   101|         operations = self.parse_json(request.post_data.get("operations", "{}"))
   102|         files_map = self.parse_json(request.post_data.get("map", "{}"))
   103|         try:
   104|             return replace_placeholders_with_files(operations, files_map, request.files)
   105|         except KeyError as e:
   106|             raise HTTPException(400, "File(s) missing in form data") from e
   107|     def parse_http_body(self, request: SyncHTTPRequestAdapter) -> GraphQLRequestData:
   108|         content_type, params = parse_content_type(request.content_type or "")
   109|         if request.method == "GET":
   110|             data = self.parse_query_params(request.query_params)
   111|         elif "application/json" in content_type:
   112|             data = self.parse_json(request.body)
   113|         elif self.multipart_uploads_enabled and content_type == "multipart/form-data":
   114|             data = self.parse_multipart(request)
   115|         elif self._is_multipart_subscriptions(content_type, params):
   116|             raise HTTPException(
   117|                 400, "Multipart subcriptions are not supported in sync mode"
   118|             )
   119|         else:
   120|             raise HTTPException(400, "Unsupported content type")
   121|         return GraphQLRequestData(
   122|             query=data.get("query"),
   123|             variables=data.get("variables"),
   124|             operation_name=data.get("operationName"),
   125|         )
   126|     def _handle_errors(
   127|         self, errors: List[GraphQLError], response_data: GraphQLHTTPResponse
   128|     ) -> None:
   129|         """Hook to allow custom handling of errors, used by the Sentry Integration."""
   130|     def run(
   131|         self,
   132|         request: Request,
   133|         context: Optional[Context] = UNSET,


# ====================================================================
# FILE: strawberry/quart/views.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 30-74 ---
    30|     async def get_body(self) -> str:
    31|         return (await self.request.data).decode()
    32|     async def get_form_data(self) -> FormData:
    33|         files = await self.request.files
    34|         form = await self.request.form
    35|         return FormData(files=files, form=form)
    36| class GraphQLView(
    37|     AsyncBaseHTTPView[Request, Response, Response, Context, RootValue],
    38|     View,
    39| ):
    40|     _ide_subscription_enabled = False
    41|     methods = ["GET", "POST"]
    42|     allow_queries_via_get: bool = True
    43|     request_adapter_class = QuartHTTPRequestAdapter
    44|     def __init__(
    45|         self,
    46|         schema: "BaseSchema",
    47|         graphiql: Optional[bool] = None,
    48|         graphql_ide: Optional[GraphQL_IDE] = "graphiql",
    49|         allow_queries_via_get: bool = True,
    50|         multipart_uploads_enabled: bool = False,
    51|     ) -> None:
    52|         self.schema = schema
    53|         self.allow_queries_via_get = allow_queries_via_get
    54|         self.multipart_uploads_enabled = multipart_uploads_enabled
    55|         if graphiql is not None:
    56|             warnings.warn(
    57|                 "The `graphiql` argument is deprecated in favor of `graphql_ide`",
    58|                 DeprecationWarning,
    59|                 stacklevel=2,
    60|             )
    61|             self.graphql_ide = "graphiql" if graphiql else None
    62|         else:
    63|             self.graphql_ide = graphql_ide
    64|     async def render_graphql_ide(self, request: Request) -> Response:
    65|         return Response(self.graphql_ide_html)
    66|     def create_response(
    67|         self, response_data: "GraphQLHTTPResponse", sub_response: Response
    68|     ) -> Response:
    69|         sub_response.set_data(self.encode_json(response_data))
    70|         return sub_response
    71|     async def get_context(self, request: Request, response: Response) -> Context:
    72|         return {"request": request, "response": response}  # type: ignore
    73|     async def get_root_value(self, request: Request) -> Optional[RootValue]:
    74|         return None


# ====================================================================
# FILE: strawberry/sanic/views.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 60-106 ---
    60|         graphiql: bool, default is True
    61|         allow_queries_via_get: bool, default is True
    62|     Returns:
    63|         None
    64|     Example:
    65|         app.add_route(
    66|             GraphQLView.as_view(schema=schema, graphiql=True),
    67|             "/graphql"
    68|         )
    69|     """
    70|     allow_queries_via_get = True
    71|     request_adapter_class = SanicHTTPRequestAdapter
    72|     def __init__(
    73|         self,
    74|         schema: BaseSchema,
    75|         graphiql: Optional[bool] = None,
    76|         graphql_ide: Optional[GraphQL_IDE] = "graphiql",
    77|         allow_queries_via_get: bool = True,
    78|         json_encoder: Optional[Type[json.JSONEncoder]] = None,
    79|         json_dumps_params: Optional[Dict[str, Any]] = None,
    80|         multipart_uploads_enabled: bool = False,
    81|     ) -> None:
    82|         self.schema = schema
    83|         self.allow_queries_via_get = allow_queries_via_get
    84|         self.json_encoder = json_encoder
    85|         self.json_dumps_params = json_dumps_params
    86|         self.multipart_uploads_enabled = multipart_uploads_enabled
    87|         if self.json_encoder is not None:  # pragma: no cover
    88|             warnings.warn(
    89|                 "json_encoder is deprecated, override encode_json instead",
    90|                 DeprecationWarning,
    91|                 stacklevel=2,
    92|             )
    93|         if self.json_dumps_params is not None:  # pragma: no cover
    94|             warnings.warn(
    95|                 "json_dumps_params is deprecated, override encode_json instead",
    96|                 DeprecationWarning,
    97|                 stacklevel=2,
    98|             )
    99|             self.json_encoder = json.JSONEncoder
   100|         if graphiql is not None:
   101|             warnings.warn(
   102|                 "The `graphiql` argument is deprecated in favor of `graphql_ide`",
   103|                 DeprecationWarning,
   104|                 stacklevel=2,
   105|             )
   106|             self.graphql_ide = "graphiql" if graphiql else None

