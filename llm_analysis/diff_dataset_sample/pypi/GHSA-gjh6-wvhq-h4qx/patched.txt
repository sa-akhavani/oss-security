# ====================================================================
# FILE: FreeTAKServer-UI/app/__init__.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 43-75 ---
    43|       ex. url_for('static', filename='', theme='')
    44|     If the file cannot be found in the /static/<theme>/ location then
    45|       the url will not be modified and the file is expected to be
    46|       in the default /static/ location
    47|     """
    48|     @app.context_processor
    49|     def override_url_for():
    50|         return dict(url_for=_generate_url_for_theme)
    51|     def _generate_url_for_theme(endpoint, **values):
    52|         if endpoint.endswith('static'):
    53|             themename = values.get('theme', None) or \
    54|                 app.config.get('DEFAULT_THEME', None)
    55|             if themename:
    56|                 theme_file = "{}/{}".format(themename, values.get('filename', ''))
    57|                 if path.isfile(path.join(app.static_folder, theme_file)):
    58|                     values['filename'] = theme_file
    59|         return url_for(endpoint, **values)
    60| def create_app(config, selenium=False):
    61|     app = Flask(__name__, static_folder='base/static')
    62|     app.config.from_object(config)
    63|     app.config['UIVERSION'] = '1.9.9.1'
    64|     app.config['USERINTERVAL'] = '180000';
    65|     app.config['SERVERHEALTHINTERVAL'] = '180000';
    66|     app.config['SYSSTATUSINTERVAL'] = '600000';
    67|     app.config['DATAPACKAGESIZELIMIT'] = '15360000';
    68|     if selenium:
    69|         app.config['LOGIN_DISABLED'] = True
    70|     register_extensions(app)
    71|     register_blueprints(app)
    72|     configure_database(app)
    73|     configure_logs(app)
    74|     apply_themes(app)
    75|     return app


# ====================================================================
# FILE: FreeTAKServer-UI/app/home/routes.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 75-108 ---
    75| @blueprint.route('/page-user', methods=['GET', 'POST'])
    76| @login_required
    77| def page_user():
    78|     import copy
    79|     update_account_form = UpdateAccountForm(request.form)
    80|     y = request.form
    81|     if "update" in request.form:
    82|         password = request.form['password']
    83|         token = request.form['token']
    84|         group = request.form['group']
    85|         user = User.query.filter_by(uid=current_user.uid).first()
    86|         user.token = token
    87|         user.group = group
    88|         user.password = password
    89|         db.session.add(user)
    90|         db.session.commit()
    91|         return render_template('page-user.html', form=update_account_form)
    92|     else:
    93|         uid = copy.copy(current_user.uid)
    94|         return render_template('page-user.html', form=update_account_form, ip=app.config["IP"], port=app.config["PORT"], websocketkey=app.config['WEBSOCKETKEY'], apikey=app.config['APIKEY'], user_id=uid)
    95| @blueprint.route('/mission/<id>/qr')
    96| def qr(id):
    97|     qr_link = 'http://' + app.config['IP'] + ':' + app.config['PORT'] + '/GenerateQR'+ '?datapackage_id=' + id
    98|     return render_template('qr.html', qr_link=qr_link)
    99| @blueprint.route('/<template>')
   100| def route_template(template):
   101|     if not current_user.is_authenticated:
   102|         return redirect(url_for('base_blueprint.login'))
   103|     try:
   104|         return render_template(template + '.html')
   105|     except TemplateNotFound:
   106|         return render_template('page-404.html'), 404
   107|     except:
   108|         return render_template('page-500.html'), 500


# ====================================================================
# FILE: setup.py
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-23 ---
     1| from setuptools import setup
     2| setup(
     3|     name='FreeTAKServer-UI',
     4|     version='1.9.9.1',
     5|     packages=['FreeTAKServer-UI', 'FreeTAKServer-UI.app', 'FreeTAKServer-UI.app.base', 'FreeTAKServer-UI.app.home', 'FreeTAKServer-UI.tests'],
     6|     url='https://github.com/FreeTAKTeam/FreeTakServer',
     7|     license='Eclipse License',
     8|     author='Ghost, C0rv0',
     9|     author_email='your.email@domain.com',
    10|     description='an optional UI for FreeTAKServer',
    11|     install_requires = [
    12|         "flask",
    13|         "flask_login",
    14|         "flask_migrate",
    15|         "flask_wtf",
    16|         "flask_sqlalchemy",
    17|         "email_validator",
    18|         "gunicorn",
    19|         "python-decouple",
    20|         "sqlalchemy-utils"
    21|     ],
    22|     include_package_data=True
    23| )

