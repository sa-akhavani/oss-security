# ====================================================================
# FILE: src/index.ts
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-6 ---
     1| export * from './execute';
     2| export * from './device';
     3| export * from './checks';
     4| export * from './validate';
     5| export * from './update-state';
     6| export * from './notification';


# ====================================================================
# FILE: src/schema.ts
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-3027 ---
     1| /* This file is auto-generated during build. Don't modify it! any changes will be overwritten. */
     2| /* tslint:disable */
     3| export type SchemaType = keyof typeof Schema;
     4| export type IndividualSchemaType = keyof typeof IndividualSchema;
     5| export type TraitName = keyof typeof Schema['device'];
     6| export const Schema = {
     7|   "device": {
     8|     "brightness": {
     9|       "$schema": "http://json-schema.org/draft-07/schema#",
    10|       "type": "object",
    11|       "additionalProperties": false,
    12|       "properties": {
    13|         "traits": {
    14|           "type": "array",
    15|           "items": {
    16|             "$ref": "#/definitions/Trait"
    17|           }
    18|         },
    19|         "id": {
    20|           "type": "string"
    21|         },
    22|         "type": {
    23|           "type": "string",
    24|           "enum": [
    25|             "action.devices.types.LIGHT",
    26|             "action.devices.types.SWITCH",
    27|             "action.devices.types.SCENE",
    28|             "action.devices.types.OUTLET",
    29|             "action.devices.types.THERMOSTAT",
    30|             "action.devices.types.SPEAKER",
    31|             "action.devices.types.LOCK",
    32|             "action.devices.types.CLOSET",
    33|             "action.devices.types.AWNING",
    34|             "action.devices.types.CURTAIN",
    35|             "action.devices.types.DOOR",
    36|             "action.devices.types.DRAWER",
    37|             "action.devices.types.BLINDS",
    38|             "action.devices.types.GARAGE",
    39|             "action.devices.types.GATE",
    40|             "action.devices.types.PERGOLA",
    41|             "action.devices.types.SHUTTER",
    42|             "action.devices.types.VALVE",
    43|             "action.devices.types.WINDOW"
    44|           ]
    45|         },
    46|         "name": {
    47|           "type": "object",
    48|           "properties": {
    49|             "defaultNames": {
    50|               "type": "array",
    51|               "items": {
    52|                 "type": "string"
    53|               }
    54|             },
    55|             "name": {
    56|               "type": "string",
    57|               "maxLength": 40
    58|             },
    59|             "nicknames": {
    60|               "type": "array",
    61|               "items": {
    62|                 "type": "string"
    63|               }
    64|             }
    65|           },
    66|           "required": [
    67|             "name"
    68|           ],
    69|           "additionalProperties": false
    70|         },
    71|         "willReportState": {
    72|           "type": "boolean"
    73|         },
    74|         "notificationSupportedByAgent": {
    75|           "type": "boolean"
    76|         },
    77|         "structureHint": {
    78|           "type": "string",
    79|           "description": "Name of the home this device belongs to",
    80|           "maxLength": 40
    81|         },
    82|         "roomHint": {
    83|           "type": "string",
    84|           "description": "Name of the room this device belongs to",
    85|           "maxLength": 40
    86|         },
    87|         "deviceInfo": {
    88|           "type": "object",
    89|           "properties": {
    90|             "manufacturer": {
    91|               "type": "string"
    92|             },
    93|             "model": {
    94|               "type": "string"
    95|             },
    96|             "hwVersion": {
    97|               "type": "string"
    98|             },
    99|             "swVersion": {
   100|               "type": "string"
   101|             }
   102|           },
   103|           "required": [
   104|             "manufacturer",
   105|             "model",
   106|             "hwVersion",
   107|             "swVersion"
   108|           ],
   109|           "additionalProperties": false
   110|         },
   111|         "otherDeviceIds": {
   112|           "type": "array",
   113|           "items": {
   114|             "type": "object",
   115|             "properties": {
   116|               "agentId": {
   117|                 "type": "string"
   118|               },
   119|               "deviceId": {
   120|                 "type": "string"
   121|               }
   122|             },
   123|             "required": [
   124|               "deviceId"
   125|             ],
   126|             "additionalProperties": false
   127|           }
   128|         },
   129|         "customData": {
   130|           "type": "object",
   131|           "properties": {
   132|             "proxyId": {
   133|               "type": "string",
   134|               "description": "Used for local execution to identity the instance responsible of this device",
   135|               "maxLength": 40
   136|             }
   137|           },
   138|           "additionalProperties": false
   139|         },
   140|         "noraSpecific": {
   141|           "type": "object",
   142|           "additionalProperties": false,
   143|           "properties": {
   144|             "turnOnWhenBrightnessChanges": {
   145|               "type": "boolean"
   146|             },
   147|             "disabled": {
   148|               "type": "boolean"
   149|             },
   150|             "twoFactor": {
   151|               "$ref": "#/definitions/TwoFactor"
   152|             }
   153|           },
   154|           "required": [
   155|             "turnOnWhenBrightnessChanges"
   156|           ]
   157|         },
   158|         "state": {
   159|           "type": "object",
   160|           "additionalProperties": false,
   161|           "properties": {
   162|             "brightness": {
   163|               "type": "number"
   164|             },
   165|             "online": {
   166|               "type": "boolean"
   167|             }
   168|           },
   169|           "required": [
   170|             "brightness",
   171|             "online"
   172|           ]
   173|         },
   174|         "attributes": {
   175|           "type": "object",
   176|           "properties": {
   177|             "commandOnlyBrightness": {
   178|               "type": "boolean"
   179|             }
   180|           },
   181|           "additionalProperties": false
   182|         }
   183|       },
   184|       "required": [
   185|         "attributes",
   186|         "id",
   187|         "name",
   188|         "noraSpecific",
   189|         "state",
   190|         "traits",
   191|         "type",
   192|         "willReportState"
   193|       ],
   194|       "definitions": {
   195|         "Trait": {
   196|           "type": "string",
   197|           "enum": [
   198|             "action.devices.traits.Brightness"
   199|           ]
   200|         },
   201|         "TwoFactor": {
   202|           "anyOf": [
   203|             {
   204|               "type": "object",
   205|               "properties": {
   206|                 "type": {
   207|                   "type": "string",
   208|                   "const": "ack"
   209|                 }
   210|               },
   211|               "required": [
   212|                 "type"
   213|               ],
   214|               "additionalProperties": false
   215|             },
   216|             {
   217|               "type": "object",
   218|               "properties": {
   219|                 "type": {
   220|                   "type": "string",
   221|                   "const": "pin"
   222|                 },
   223|                 "pin": {
   224|                   "type": "string",
   225|                   "maxLength": 20
   226|                 }
   227|               },
   228|               "required": [
   229|                 "type",
   230|                 "pin"
   231|               ],
   232|               "additionalProperties": false
   233|             }
   234|           ]
   235|         }
   236|       }
   237|     },
   238|     "colorsetting": {
   239|       "$schema": "http://json-schema.org/draft-07/schema#",
   240|       "type": "object",
   241|       "additionalProperties": false,
   242|       "properties": {
   243|         "traits": {
   244|           "type": "array",
   245|           "items": {
   246|             "$ref": "#/definitions/Trait"
   247|           }
   248|         },
   249|         "id": {
   250|           "type": "string"
   251|         },
   252|         "type": {
   253|           "type": "string",
   254|           "enum": [
   255|             "action.devices.types.LIGHT",
   256|             "action.devices.types.SWITCH",
   257|             "action.devices.types.SCENE",
   258|             "action.devices.types.OUTLET",
   259|             "action.devices.types.THERMOSTAT",
   260|             "action.devices.types.SPEAKER",
   261|             "action.devices.types.LOCK",
   262|             "action.devices.types.CLOSET",
   263|             "action.devices.types.AWNING",
   264|             "action.devices.types.CURTAIN",
   265|             "action.devices.types.DOOR",
   266|             "action.devices.types.DRAWER",
   267|             "action.devices.types.BLINDS",
   268|             "action.devices.types.GARAGE",
   269|             "action.devices.types.GATE",
   270|             "action.devices.types.PERGOLA",
   271|             "action.devices.types.SHUTTER",
   272|             "action.devices.types.VALVE",
   273|             "action.devices.types.WINDOW"
   274|           ]
   275|         },
   276|         "name": {
   277|           "type": "object",
   278|           "properties": {
   279|             "defaultNames": {
   280|               "type": "array",
   281|               "items": {
   282|                 "type": "string"
   283|               }
   284|             },
   285|             "name": {
   286|               "type": "string",
   287|               "maxLength": 40
   288|             },
   289|             "nicknames": {
   290|               "type": "array",
   291|               "items": {
   292|                 "type": "string"
   293|               }
   294|             }
   295|           },
   296|           "required": [
   297|             "name"
   298|           ],
   299|           "additionalProperties": false
   300|         },
   301|         "willReportState": {
   302|           "type": "boolean"
   303|         },
   304|         "notificationSupportedByAgent": {
   305|           "type": "boolean"
   306|         },
   307|         "structureHint": {
   308|           "type": "string",
   309|           "description": "Name of the home this device belongs to",
   310|           "maxLength": 40
   311|         },
   312|         "roomHint": {
   313|           "type": "string",
   314|           "description": "Name of the room this device belongs to",
   315|           "maxLength": 40
   316|         },
   317|         "deviceInfo": {
   318|           "type": "object",
   319|           "properties": {
   320|             "manufacturer": {
   321|               "type": "string"
   322|             },
   323|             "model": {
   324|               "type": "string"
   325|             },
   326|             "hwVersion": {
   327|               "type": "string"
   328|             },
   329|             "swVersion": {
   330|               "type": "string"
   331|             }
   332|           },
   333|           "required": [
   334|             "manufacturer",
   335|             "model",
   336|             "hwVersion",
   337|             "swVersion"
   338|           ],
   339|           "additionalProperties": false
   340|         },
   341|         "otherDeviceIds": {
   342|           "type": "array",
   343|           "items": {
   344|             "type": "object",
   345|             "properties": {
   346|               "agentId": {
   347|                 "type": "string"
   348|               },
   349|               "deviceId": {
   350|                 "type": "string"
   351|               }
   352|             },
   353|             "required": [
   354|               "deviceId"
   355|             ],
   356|             "additionalProperties": false
   357|           }
   358|         },
   359|         "customData": {
   360|           "type": "object",
   361|           "properties": {
   362|             "proxyId": {
   363|               "type": "string",
   364|               "description": "Used for local execution to identity the instance responsible of this device",
   365|               "maxLength": 40
   366|             }
   367|           },
   368|           "additionalProperties": false
   369|         },
   370|         "noraSpecific": {
   371|           "type": "object",
   372|           "additionalProperties": false,
   373|           "properties": {
   374|             "disabled": {
   375|               "type": "boolean"
   376|             },
   377|             "twoFactor": {
   378|               "$ref": "#/definitions/TwoFactor"
   379|             }
   380|           }
   381|         },
   382|         "state": {
   383|           "type": "object",
   384|           "additionalProperties": false,
   385|           "properties": {
   386|             "color": {
   387|               "anyOf": [
   388|                 {
   389|                   "type": "object",
   390|                   "properties": {
   391|                     "temperatureK": {
   392|                       "type": "number"
   393|                     }
   394|                   },
   395|                   "required": [
   396|                     "temperatureK"
   397|                   ],
   398|                   "additionalProperties": false
   399|                 },
   400|                 {
   401|                   "type": "object",
   402|                   "properties": {
   403|                     "spectrumRgb": {
   404|                       "type": "number"
   405|                     }
   406|                   },
   407|                   "required": [
   408|                     "spectrumRgb"
   409|                   ],
   410|                   "additionalProperties": false
   411|                 },
   412|                 {
   413|                   "type": "object",
   414|                   "properties": {
   415|                     "spectrumHsv": {
   416|                       "type": "object",
   417|                       "properties": {
   418|                         "hue": {
   419|                           "type": "number"
   420|                         },
   421|                         "saturation": {
   422|                           "type": "number"
   423|                         },
   424|                         "value": {
   425|                           "type": "number"
   426|                         }
   427|                       },
   428|                       "required": [
   429|                         "hue",
   430|                         "saturation",
   431|                         "value"
   432|                       ],
   433|                       "additionalProperties": false
   434|                     }
   435|                   },
   436|                   "required": [
   437|                     "spectrumHsv"
   438|                   ],
   439|                   "additionalProperties": false
   440|                 }
   441|               ]
   442|             },
   443|             "online": {
   444|               "type": "boolean"
   445|             }
   446|           },
   447|           "required": [
   448|             "color",
   449|             "online"
   450|           ]
   451|         },
   452|         "attributes": {
   453|           "anyOf": [
   454|             {
   455|               "type": "object",
   456|               "additionalProperties": false,
   457|               "properties": {
   458|                 "colorModel": {
   459|                   "type": "string",
   460|                   "enum": [
   461|                     "rgb",
   462|                     "hsv"
   463|                   ]
   464|                 },
   465|                 "commandOnlyColorSetting": {
   466|                   "type": "boolean"
   467|                 }
   468|               },
   469|               "required": [
   470|                 "colorModel"
   471|               ]
   472|             },
   473|             {
   474|               "type": "object",
   475|               "additionalProperties": false,
   476|               "properties": {
   477|                 "colorTemperatureRange": {
   478|                   "type": "object",
   479|                   "properties": {
   480|                     "temperatureMinK": {
   481|                       "type": "number"
   482|                     },
   483|                     "temperatureMaxK": {
   484|                       "type": "number"
   485|                     }
   486|                   },
   487|                   "required": [
   488|                     "temperatureMinK",
   489|                     "temperatureMaxK"
   490|                   ],
   491|                   "additionalProperties": false
   492|                 },
   493|                 "commandOnlyColorSetting": {
   494|                   "type": "boolean"
   495|                 }
   496|               },
   497|               "required": [
   498|                 "colorTemperatureRange"
   499|               ]
   500|             }
   501|           ]
   502|         }
   503|       },
   504|       "required": [
   505|         "attributes",
   506|         "id",
   507|         "name",
   508|         "noraSpecific",
   509|         "state",
   510|         "traits",
   511|         "type",
   512|         "willReportState"
   513|       ],
   514|       "definitions": {
   515|         "Trait": {
   516|           "type": "string",
   517|           "enum": [
   518|             "action.devices.traits.ColorSetting"
   519|           ]
   520|         },
   521|         "TwoFactor": {
   522|           "anyOf": [
   523|             {
   524|               "type": "object",
   525|               "properties": {
   526|                 "type": {
   527|                   "type": "string",
   528|                   "const": "ack"
   529|                 }
   530|               },
   531|               "required": [
   532|                 "type"
   533|               ],
   534|               "additionalProperties": false
   535|             },
   536|             {
   537|               "type": "object",
   538|               "properties": {
   539|                 "type": {
   540|                   "type": "string",
   541|                   "const": "pin"
   542|                 },
   543|                 "pin": {
   544|                   "type": "string",
   545|                   "maxLength": 20
   546|                 }
   547|               },
   548|               "required": [
   549|                 "type",
   550|                 "pin"
   551|               ],
   552|               "additionalProperties": false
   553|             }
   554|           ]
   555|         }
   556|       }
   557|     },
   558|     "onoff": {
   559|       "$schema": "http://json-schema.org/draft-07/schema#",
   560|       "type": "object",
   561|       "additionalProperties": false,
   562|       "properties": {
   563|         "traits": {
   564|           "type": "array",
   565|           "items": {
   566|             "$ref": "#/definitions/Trait"
   567|           }
   568|         },
   569|         "id": {
   570|           "type": "string"
   571|         },
   572|         "type": {
   573|           "type": "string",
   574|           "enum": [
   575|             "action.devices.types.LIGHT",
   576|             "action.devices.types.SWITCH",
   577|             "action.devices.types.SCENE",
   578|             "action.devices.types.OUTLET",
   579|             "action.devices.types.THERMOSTAT",
   580|             "action.devices.types.SPEAKER",
   581|             "action.devices.types.LOCK",
   582|             "action.devices.types.CLOSET",
   583|             "action.devices.types.AWNING",
   584|             "action.devices.types.CURTAIN",
   585|             "action.devices.types.DOOR",
   586|             "action.devices.types.DRAWER",
   587|             "action.devices.types.BLINDS",
   588|             "action.devices.types.GARAGE",
   589|             "action.devices.types.GATE",
   590|             "action.devices.types.PERGOLA",
   591|             "action.devices.types.SHUTTER",
   592|             "action.devices.types.VALVE",
   593|             "action.devices.types.WINDOW"
   594|           ]
   595|         },
   596|         "name": {
   597|           "type": "object",
   598|           "properties": {
   599|             "defaultNames": {
   600|               "type": "array",
   601|               "items": {
   602|                 "type": "string"
   603|               }
   604|             },
   605|             "name": {
   606|               "type": "string",
   607|               "maxLength": 40
   608|             },
   609|             "nicknames": {
   610|               "type": "array",
   611|               "items": {
   612|                 "type": "string"
   613|               }
   614|             }
   615|           },
   616|           "required": [
   617|             "name"
   618|           ],
   619|           "additionalProperties": false
   620|         },
   621|         "willReportState": {
   622|           "type": "boolean"
   623|         },
   624|         "notificationSupportedByAgent": {
   625|           "type": "boolean"
   626|         },
   627|         "structureHint": {
   628|           "type": "string",
   629|           "description": "Name of the home this device belongs to",
   630|           "maxLength": 40
   631|         },
   632|         "roomHint": {
   633|           "type": "string",
   634|           "description": "Name of the room this device belongs to",
   635|           "maxLength": 40
   636|         },
   637|         "deviceInfo": {
   638|           "type": "object",
   639|           "properties": {
   640|             "manufacturer": {
   641|               "type": "string"
   642|             },
   643|             "model": {
   644|               "type": "string"
   645|             },
   646|             "hwVersion": {
   647|               "type": "string"
   648|             },
   649|             "swVersion": {
   650|               "type": "string"
   651|             }
   652|           },
   653|           "required": [
   654|             "manufacturer",
   655|             "model",
   656|             "hwVersion",
   657|             "swVersion"
   658|           ],
   659|           "additionalProperties": false
   660|         },
   661|         "otherDeviceIds": {
   662|           "type": "array",
   663|           "items": {
   664|             "type": "object",
   665|             "properties": {
   666|               "agentId": {
   667|                 "type": "string"
   668|               },
   669|               "deviceId": {
   670|                 "type": "string"
   671|               }
   672|             },
   673|             "required": [
   674|               "deviceId"
   675|             ],
   676|             "additionalProperties": false
   677|           }
   678|         },
   679|         "customData": {
   680|           "type": "object",
   681|           "properties": {
   682|             "proxyId": {
   683|               "type": "string",
   684|               "description": "Used for local execution to identity the instance responsible of this device",
   685|               "maxLength": 40
   686|             }
   687|           },
   688|           "additionalProperties": false
   689|         },
   690|         "noraSpecific": {
   691|           "type": "object",
   692|           "additionalProperties": false,
   693|           "properties": {
   694|             "disabled": {
   695|               "type": "boolean"
   696|             },
   697|             "twoFactor": {
   698|               "$ref": "#/definitions/TwoFactor"
   699|             }
   700|           }
   701|         },
   702|         "state": {
   703|           "type": "object",
   704|           "additionalProperties": false,
   705|           "properties": {
   706|             "on": {
   707|               "type": "boolean"
   708|             },
   709|             "online": {
   710|               "type": "boolean"
   711|             }
   712|           },
   713|           "required": [
   714|             "on",
   715|             "online"
   716|           ]
   717|         },
   718|         "attributes": {
   719|           "type": "object",
   720|           "properties": {
   721|             "commandOnlyOnOff": {
   722|               "type": "boolean"
   723|             },
   724|             "queryOnlyOnOff": {
   725|               "type": "boolean"
   726|             }
   727|           },
   728|           "additionalProperties": false
   729|         }
   730|       },
   731|       "required": [
   732|         "attributes",
   733|         "id",
   734|         "name",
   735|         "noraSpecific",
   736|         "state",
   737|         "traits",
   738|         "type",
   739|         "willReportState"
   740|       ],
   741|       "definitions": {
   742|         "Trait": {
   743|           "type": "string",
   744|           "enum": [
   745|             "action.devices.traits.OnOff"
   746|           ]
   747|         },
   748|         "TwoFactor": {
   749|           "anyOf": [
   750|             {
   751|               "type": "object",
   752|               "properties": {
   753|                 "type": {
   754|                   "type": "string",
   755|                   "const": "ack"
   756|                 }
   757|               },
   758|               "required": [
   759|                 "type"
   760|               ],
   761|               "additionalProperties": false
   762|             },
   763|             {
   764|               "type": "object",
   765|               "properties": {
   766|                 "type": {
   767|                   "type": "string",
   768|                   "const": "pin"
   769|                 },
   770|                 "pin": {
   771|                   "type": "string",
   772|                   "maxLength": 20
   773|                 }
   774|               },
   775|               "required": [
   776|                 "type",
   777|                 "pin"
   778|               ],
   779|               "additionalProperties": false
   780|             }
   781|           ]
   782|         }
   783|       }
   784|     },
   785|     "lockunlock": {
   786|       "$schema": "http://json-schema.org/draft-07/schema#",
   787|       "type": "object",
   788|       "additionalProperties": false,
   789|       "properties": {
   790|         "traits": {
   791|           "type": "array",
   792|           "items": {
   793|             "$ref": "#/definitions/Trait"
   794|           }
   795|         },
   796|         "id": {
   797|           "type": "string"
   798|         },
   799|         "type": {
   800|           "type": "string",
   801|           "enum": [
   802|             "action.devices.types.LIGHT",
   803|             "action.devices.types.SWITCH",
   804|             "action.devices.types.SCENE",
   805|             "action.devices.types.OUTLET",
   806|             "action.devices.types.THERMOSTAT",
   807|             "action.devices.types.SPEAKER",
   808|             "action.devices.types.LOCK",
   809|             "action.devices.types.CLOSET",
   810|             "action.devices.types.AWNING",
   811|             "action.devices.types.CURTAIN",
   812|             "action.devices.types.DOOR",
   813|             "action.devices.types.DRAWER",
   814|             "action.devices.types.BLINDS",
   815|             "action.devices.types.GARAGE",
   816|             "action.devices.types.GATE",
   817|             "action.devices.types.PERGOLA",
   818|             "action.devices.types.SHUTTER",
   819|             "action.devices.types.VALVE",
   820|             "action.devices.types.WINDOW"
   821|           ]
   822|         },
   823|         "name": {
   824|           "type": "object",
   825|           "properties": {
   826|             "defaultNames": {
   827|               "type": "array",
   828|               "items": {
   829|                 "type": "string"
   830|               }
   831|             },
   832|             "name": {
   833|               "type": "string",
   834|               "maxLength": 40
   835|             },
   836|             "nicknames": {
   837|               "type": "array",
   838|               "items": {
   839|                 "type": "string"
   840|               }
   841|             }
   842|           },
   843|           "required": [
   844|             "name"
   845|           ],
   846|           "additionalProperties": false
   847|         },
   848|         "willReportState": {
   849|           "type": "boolean"
   850|         },
   851|         "notificationSupportedByAgent": {
   852|           "type": "boolean"
   853|         },
   854|         "structureHint": {
   855|           "type": "string",
   856|           "description": "Name of the home this device belongs to",
   857|           "maxLength": 40
   858|         },
   859|         "roomHint": {
   860|           "type": "string",
   861|           "description": "Name of the room this device belongs to",
   862|           "maxLength": 40
   863|         },
   864|         "deviceInfo": {
   865|           "type": "object",
   866|           "properties": {
   867|             "manufacturer": {
   868|               "type": "string"
   869|             },
   870|             "model": {
   871|               "type": "string"
   872|             },
   873|             "hwVersion": {
   874|               "type": "string"
   875|             },
   876|             "swVersion": {
   877|               "type": "string"
   878|             }
   879|           },
   880|           "required": [
   881|             "manufacturer",
   882|             "model",
   883|             "hwVersion",
   884|             "swVersion"
   885|           ],
   886|           "additionalProperties": false
   887|         },
   888|         "otherDeviceIds": {
   889|           "type": "array",
   890|           "items": {
   891|             "type": "object",
   892|             "properties": {
   893|               "agentId": {
   894|                 "type": "string"
   895|               },
   896|               "deviceId": {
   897|                 "type": "string"
   898|               }
   899|             },
   900|             "required": [
   901|               "deviceId"
   902|             ],
   903|             "additionalProperties": false
   904|           }
   905|         },
   906|         "customData": {
   907|           "type": "object",
   908|           "properties": {
   909|             "proxyId": {
   910|               "type": "string",
   911|               "description": "Used for local execution to identity the instance responsible of this device",
   912|               "maxLength": 40
   913|             }
   914|           },
   915|           "additionalProperties": false
   916|         },
   917|         "noraSpecific": {
   918|           "type": "object",
   919|           "additionalProperties": false,
   920|           "properties": {
   921|             "disabled": {
   922|               "type": "boolean"
   923|             },
   924|             "twoFactor": {
   925|               "$ref": "#/definitions/TwoFactor"
   926|             }
   927|           }
   928|         },
   929|         "state": {
   930|           "type": "object",
   931|           "additionalProperties": false,
   932|           "properties": {
   933|             "isLocked": {
   934|               "type": "boolean"
   935|             },
   936|             "isJammed": {
   937|               "type": "boolean"
   938|             },
   939|             "online": {
   940|               "type": "boolean"
   941|             }
   942|           },
   943|           "required": [
   944|             "isJammed",
   945|             "isLocked",
   946|             "online"
   947|           ]
   948|         },
   949|         "attributes": {
   950|           "type": "object",
   951|           "additionalProperties": false
   952|         }
   953|       },
   954|       "required": [
   955|         "attributes",
   956|         "id",
   957|         "name",
   958|         "noraSpecific",
   959|         "state",
   960|         "traits",
   961|         "type",
   962|         "willReportState"
   963|       ],
   964|       "definitions": {
   965|         "Trait": {
   966|           "type": "string",
   967|           "enum": [
   968|             "action.devices.traits.LockUnlock"
   969|           ]
   970|         },
   971|         "TwoFactor": {
   972|           "anyOf": [
   973|             {
   974|               "type": "object",
   975|               "properties": {
   976|                 "type": {
   977|                   "type": "string",
   978|                   "const": "ack"
   979|                 }
   980|               },
   981|               "required": [
   982|                 "type"
   983|               ],
   984|               "additionalProperties": false
   985|             },
   986|             {
   987|               "type": "object",
   988|               "properties": {
   989|                 "type": {
   990|                   "type": "string",
   991|                   "const": "pin"
   992|                 },
   993|                 "pin": {
   994|                   "type": "string",
   995|                   "maxLength": 20
   996|                 }
   997|               },
   998|               "required": [
   999|                 "type",
  1000|                 "pin"
  1001|               ],
  1002|               "additionalProperties": false
  1003|             }
  1004|           ]
  1005|         }
  1006|       }
  1007|     },
  1008|     "scene": {
  1009|       "$schema": "http://json-schema.org/draft-07/schema#",
  1010|       "type": "object",
  1011|       "additionalProperties": false,
  1012|       "properties": {
  1013|         "traits": {
  1014|           "type": "array",
  1015|           "items": {
  1016|             "$ref": "#/definitions/Trait"
  1017|           }
  1018|         },
  1019|         "id": {
  1020|           "type": "string"
  1021|         },
  1022|         "type": {
  1023|           "type": "string",
  1024|           "enum": [
  1025|             "action.devices.types.LIGHT",
  1026|             "action.devices.types.SWITCH",
  1027|             "action.devices.types.SCENE",
  1028|             "action.devices.types.OUTLET",
  1029|             "action.devices.types.THERMOSTAT",
  1030|             "action.devices.types.SPEAKER",
  1031|             "action.devices.types.LOCK",
  1032|             "action.devices.types.CLOSET",
  1033|             "action.devices.types.AWNING",
  1034|             "action.devices.types.CURTAIN",
  1035|             "action.devices.types.DOOR",
  1036|             "action.devices.types.DRAWER",
  1037|             "action.devices.types.BLINDS",
  1038|             "action.devices.types.GARAGE",
  1039|             "action.devices.types.GATE",
  1040|             "action.devices.types.PERGOLA",
  1041|             "action.devices.types.SHUTTER",
  1042|             "action.devices.types.VALVE",
  1043|             "action.devices.types.WINDOW"
  1044|           ]
  1045|         },
  1046|         "name": {
  1047|           "type": "object",
  1048|           "properties": {
  1049|             "defaultNames": {
  1050|               "type": "array",
  1051|               "items": {
  1052|                 "type": "string"
  1053|               }
  1054|             },
  1055|             "name": {
  1056|               "type": "string",
  1057|               "maxLength": 40
  1058|             },
  1059|             "nicknames": {
  1060|               "type": "array",
  1061|               "items": {
  1062|                 "type": "string"
  1063|               }
  1064|             }
  1065|           },
  1066|           "required": [
  1067|             "name"
  1068|           ],
  1069|           "additionalProperties": false
  1070|         },
  1071|         "willReportState": {
  1072|           "type": "boolean"
  1073|         },
  1074|         "notificationSupportedByAgent": {
  1075|           "type": "boolean"
  1076|         },
  1077|         "structureHint": {
  1078|           "type": "string",
  1079|           "description": "Name of the home this device belongs to",
  1080|           "maxLength": 40
  1081|         },
  1082|         "roomHint": {
  1083|           "type": "string",
  1084|           "description": "Name of the room this device belongs to",
  1085|           "maxLength": 40
  1086|         },
  1087|         "deviceInfo": {
  1088|           "type": "object",
  1089|           "properties": {
  1090|             "manufacturer": {
  1091|               "type": "string"
  1092|             },
  1093|             "model": {
  1094|               "type": "string"
  1095|             },
  1096|             "hwVersion": {
  1097|               "type": "string"
  1098|             },
  1099|             "swVersion": {
  1100|               "type": "string"
  1101|             }
  1102|           },
  1103|           "required": [
  1104|             "manufacturer",
  1105|             "model",
  1106|             "hwVersion",
  1107|             "swVersion"
  1108|           ],
  1109|           "additionalProperties": false
  1110|         },
  1111|         "otherDeviceIds": {
  1112|           "type": "array",
  1113|           "items": {
  1114|             "type": "object",
  1115|             "properties": {
  1116|               "agentId": {
  1117|                 "type": "string"
  1118|               },
  1119|               "deviceId": {
  1120|                 "type": "string"
  1121|               }
  1122|             },
  1123|             "required": [
  1124|               "deviceId"
  1125|             ],
  1126|             "additionalProperties": false
  1127|           }
  1128|         },
  1129|         "customData": {
  1130|           "type": "object",
  1131|           "properties": {
  1132|             "proxyId": {
  1133|               "type": "string",
  1134|               "description": "Used for local execution to identity the instance responsible of this device",
  1135|               "maxLength": 40
  1136|             }
  1137|           },
  1138|           "additionalProperties": false
  1139|         },
  1140|         "noraSpecific": {
  1141|           "type": "object",
  1142|           "additionalProperties": false,
  1143|           "properties": {
  1144|             "pendingScene": {
  1145|               "type": "object",
  1146|               "properties": {
  1147|                 "deactivate": {
  1148|                   "type": "boolean"
  1149|                 }
  1150|               },
  1151|               "required": [
  1152|                 "deactivate"
  1153|               ],
  1154|               "additionalProperties": false
  1155|             },
  1156|             "disabled": {
  1157|               "type": "boolean"
  1158|             },
  1159|             "twoFactor": {
  1160|               "$ref": "#/definitions/TwoFactor"
  1161|             }
  1162|           }
  1163|         },
  1164|         "state": {
  1165|           "type": "object",
  1166|           "additionalProperties": false,
  1167|           "properties": {
  1168|             "online": {
  1169|               "type": "boolean"
  1170|             }
  1171|           },
  1172|           "required": [
  1173|             "online"
  1174|           ]
  1175|         },
  1176|         "attributes": {
  1177|           "type": "object",
  1178|           "properties": {
  1179|             "sceneReversible": {
  1180|               "type": "boolean"
  1181|             }
  1182|           },
  1183|           "additionalProperties": false
  1184|         }
  1185|       },
  1186|       "required": [
  1187|         "attributes",
  1188|         "id",
  1189|         "name",
  1190|         "noraSpecific",
  1191|         "state",
  1192|         "traits",
  1193|         "type",
  1194|         "willReportState"
  1195|       ],
  1196|       "definitions": {
  1197|         "Trait": {
  1198|           "type": "string",
  1199|           "enum": [
  1200|             "action.devices.traits.Scene"
  1201|           ]
  1202|         },
  1203|         "TwoFactor": {
  1204|           "anyOf": [
  1205|             {
  1206|               "type": "object",
  1207|               "properties": {
  1208|                 "type": {
  1209|                   "type": "string",
  1210|                   "const": "ack"
  1211|                 }
  1212|               },
  1213|               "required": [
  1214|                 "type"
  1215|               ],
  1216|               "additionalProperties": false
  1217|             },
  1218|             {
  1219|               "type": "object",
  1220|               "properties": {
  1221|                 "type": {
  1222|                   "type": "string",
  1223|                   "const": "pin"
  1224|                 },
  1225|                 "pin": {
  1226|                   "type": "string",
  1227|                   "maxLength": 20
  1228|                 }
  1229|               },
  1230|               "required": [
  1231|                 "type",
  1232|                 "pin"
  1233|               ],
  1234|               "additionalProperties": false
  1235|             }
  1236|           ]
  1237|         }
  1238|       }
  1239|     },
  1240|     "temperaturesetting": {
  1241|       "$schema": "http://json-schema.org/draft-07/schema#",
  1242|       "type": "object",
  1243|       "additionalProperties": false,
  1244|       "properties": {
  1245|         "traits": {
  1246|           "type": "array",
  1247|           "items": {
  1248|             "$ref": "#/definitions/Trait"
  1249|           }
  1250|         },
  1251|         "id": {
  1252|           "type": "string"
  1253|         },
  1254|         "type": {
  1255|           "type": "string",
  1256|           "enum": [
  1257|             "action.devices.types.LIGHT",
  1258|             "action.devices.types.SWITCH",
  1259|             "action.devices.types.SCENE",
  1260|             "action.devices.types.OUTLET",
  1261|             "action.devices.types.THERMOSTAT",
  1262|             "action.devices.types.SPEAKER",
  1263|             "action.devices.types.LOCK",
  1264|             "action.devices.types.CLOSET",
  1265|             "action.devices.types.AWNING",
  1266|             "action.devices.types.CURTAIN",
  1267|             "action.devices.types.DOOR",
  1268|             "action.devices.types.DRAWER",
  1269|             "action.devices.types.BLINDS",
  1270|             "action.devices.types.GARAGE",
  1271|             "action.devices.types.GATE",
  1272|             "action.devices.types.PERGOLA",
  1273|             "action.devices.types.SHUTTER",
  1274|             "action.devices.types.VALVE",
  1275|             "action.devices.types.WINDOW"
  1276|           ]
  1277|         },
  1278|         "name": {
  1279|           "type": "object",
  1280|           "properties": {
  1281|             "defaultNames": {
  1282|               "type": "array",
  1283|               "items": {
  1284|                 "type": "string"
  1285|               }
  1286|             },
  1287|             "name": {
  1288|               "type": "string",
  1289|               "maxLength": 40
  1290|             },
  1291|             "nicknames": {
  1292|               "type": "array",
  1293|               "items": {
  1294|                 "type": "string"
  1295|               }
  1296|             }
  1297|           },
  1298|           "required": [
  1299|             "name"
  1300|           ],
  1301|           "additionalProperties": false
  1302|         },
  1303|         "willReportState": {
  1304|           "type": "boolean"
  1305|         },
  1306|         "notificationSupportedByAgent": {
  1307|           "type": "boolean"
  1308|         },
  1309|         "structureHint": {
  1310|           "type": "string",
  1311|           "description": "Name of the home this device belongs to",
  1312|           "maxLength": 40
  1313|         },
  1314|         "roomHint": {
  1315|           "type": "string",
  1316|           "description": "Name of the room this device belongs to",
  1317|           "maxLength": 40
  1318|         },
  1319|         "deviceInfo": {
  1320|           "type": "object",
  1321|           "properties": {
  1322|             "manufacturer": {
  1323|               "type": "string"
  1324|             },
  1325|             "model": {
  1326|               "type": "string"
  1327|             },
  1328|             "hwVersion": {
  1329|               "type": "string"
  1330|             },
  1331|             "swVersion": {
  1332|               "type": "string"
  1333|             }
  1334|           },
  1335|           "required": [
  1336|             "manufacturer",
  1337|             "model",
  1338|             "hwVersion",
  1339|             "swVersion"
  1340|           ],
  1341|           "additionalProperties": false
  1342|         },
  1343|         "otherDeviceIds": {
  1344|           "type": "array",
  1345|           "items": {
  1346|             "type": "object",
  1347|             "properties": {
  1348|               "agentId": {
  1349|                 "type": "string"
  1350|               },
  1351|               "deviceId": {
  1352|                 "type": "string"
  1353|               }
  1354|             },
  1355|             "required": [
  1356|               "deviceId"
  1357|             ],
  1358|             "additionalProperties": false
  1359|           }
  1360|         },
  1361|         "customData": {
  1362|           "type": "object",
  1363|           "properties": {
  1364|             "proxyId": {
  1365|               "type": "string",
  1366|               "description": "Used for local execution to identity the instance responsible of this device",
  1367|               "maxLength": 40
  1368|             }
  1369|           },
  1370|           "additionalProperties": false
  1371|         },
  1372|         "noraSpecific": {
  1373|           "type": "object",
  1374|           "additionalProperties": false,
  1375|           "properties": {
  1376|             "previousMode": {
  1377|               "type": "string",
  1378|               "enum": [
  1379|                 "heat",
  1380|                 "cool",
  1381|                 "auto",
  1382|                 "fan-only",
  1383|                 "purifier",
  1384|                 "eco",
  1385|                 "dry",
  1386|                 "heatcool"
  1387|               ]
  1388|             },
  1389|             "disabled": {
  1390|               "type": "boolean"
  1391|             },
  1392|             "twoFactor": {
  1393|               "$ref": "#/definitions/TwoFactor"
  1394|             }
  1395|           }
  1396|         },
  1397|         "state": {
  1398|           "type": "object",
  1399|           "additionalProperties": false,
  1400|           "properties": {
  1401|             "thermostatMode": {
  1402|               "$ref": "#/definitions/ThermostatMode"
  1403|             },
  1404|             "thermostatTemperatureAmbient": {
  1405|               "type": "number"
  1406|             },
  1407|             "thermostatHumidityAmbient": {
  1408|               "type": "number",
  1409|               "minimum": 0,
  1410|               "maximum": 100
  1411|             },
  1412|             "thermostatTemperatureSetpoint": {
  1413|               "type": "number"
  1414|             },
  1415|             "thermostatTemperatureSetpointHigh": {
  1416|               "type": "number"
  1417|             },
  1418|             "thermostatTemperatureSetpointLow": {
  1419|               "type": "number"
  1420|             },
  1421|             "online": {
  1422|               "type": "boolean"
  1423|             }
  1424|           },
  1425|           "required": [
  1426|             "online",
  1427|             "thermostatMode",
  1428|             "thermostatTemperatureAmbient",
  1429|             "thermostatTemperatureSetpoint"
  1430|           ]
  1431|         },
  1432|         "attributes": {
  1433|           "type": "object",
  1434|           "properties": {
  1435|             "availableThermostatModes": {
  1436|               "type": "array",
  1437|               "items": {
  1438|                 "$ref": "#/definitions/ThermostatMode"
  1439|               }
  1440|             },
  1441|             "thermostatTemperatureRange": {
  1442|               "type": "object",
  1443|               "properties": {
  1444|                 "minThresholdCelsius": {
  1445|                   "type": "number"
  1446|                 },
  1447|                 "maxThresholdCelsius": {
  1448|                   "type": "number"
  1449|                 }
  1450|               },
  1451|               "required": [
  1452|                 "minThresholdCelsius",
  1453|                 "maxThresholdCelsius"
  1454|               ],
  1455|               "additionalProperties": false
  1456|             },
  1457|             "thermostatTemperatureUnit": {
  1458|               "type": "string",
  1459|               "enum": [
  1460|                 "C",
  1461|                 "F"
  1462|               ]
  1463|             },
  1464|             "bufferRangeCelsius": {
  1465|               "type": "number"
  1466|             },
  1467|             "commandOnlyTemperatureSetting": {
  1468|               "type": "boolean"
  1469|             },
  1470|             "queryOnlyTemperatureSetting": {
  1471|               "type": "boolean"
  1472|             }
  1473|           },
  1474|           "required": [
  1475|             "availableThermostatModes",
  1476|             "thermostatTemperatureUnit"
  1477|           ],
  1478|           "additionalProperties": false
  1479|         }
  1480|       },
  1481|       "required": [
  1482|         "attributes",
  1483|         "id",
  1484|         "name",
  1485|         "noraSpecific",
  1486|         "state",
  1487|         "traits",
  1488|         "type",
  1489|         "willReportState"
  1490|       ],
  1491|       "definitions": {
  1492|         "Trait": {
  1493|           "type": "string",
  1494|           "enum": [
  1495|             "action.devices.traits.TemperatureSetting"
  1496|           ]
  1497|         },
  1498|         "TwoFactor": {
  1499|           "anyOf": [
  1500|             {
  1501|               "type": "object",
  1502|               "properties": {
  1503|                 "type": {
  1504|                   "type": "string",
  1505|                   "const": "ack"
  1506|                 }
  1507|               },
  1508|               "required": [
  1509|                 "type"
  1510|               ],
  1511|               "additionalProperties": false
  1512|             },
  1513|             {
  1514|               "type": "object",
  1515|               "properties": {
  1516|                 "type": {
  1517|                   "type": "string",
  1518|                   "const": "pin"
  1519|                 },
  1520|                 "pin": {
  1521|                   "type": "string",
  1522|                   "maxLength": 20
  1523|                 }
  1524|               },
  1525|               "required": [
  1526|                 "type",
  1527|                 "pin"
  1528|               ],
  1529|               "additionalProperties": false
  1530|             }
  1531|           ]
  1532|         },
  1533|         "ThermostatMode": {
  1534|           "type": "string",
  1535|           "enum": [
  1536|             "off",
  1537|             "heat",
  1538|             "cool",
  1539|             "on",
  1540|             "auto",
  1541|             "fan-only",
  1542|             "purifier",
  1543|             "eco",
  1544|             "dry",
  1545|             "heatcool"
  1546|           ]
  1547|         }
  1548|       }
  1549|     },
  1550|     "volume": {
  1551|       "$schema": "http://json-schema.org/draft-07/schema#",
  1552|       "type": "object",
  1553|       "additionalProperties": false,
  1554|       "properties": {
  1555|         "traits": {
  1556|           "type": "array",
  1557|           "items": {
  1558|             "$ref": "#/definitions/Trait"
  1559|           }
  1560|         },
  1561|         "id": {
  1562|           "type": "string"
  1563|         },
  1564|         "type": {
  1565|           "type": "string",
  1566|           "enum": [
  1567|             "action.devices.types.LIGHT",
  1568|             "action.devices.types.SWITCH",
  1569|             "action.devices.types.SCENE",
  1570|             "action.devices.types.OUTLET",
  1571|             "action.devices.types.THERMOSTAT",
  1572|             "action.devices.types.SPEAKER",
  1573|             "action.devices.types.LOCK",
  1574|             "action.devices.types.CLOSET",
  1575|             "action.devices.types.AWNING",
  1576|             "action.devices.types.CURTAIN",
  1577|             "action.devices.types.DOOR",
  1578|             "action.devices.types.DRAWER",
  1579|             "action.devices.types.BLINDS",
  1580|             "action.devices.types.GARAGE",
  1581|             "action.devices.types.GATE",
  1582|             "action.devices.types.PERGOLA",
  1583|             "action.devices.types.SHUTTER",
  1584|             "action.devices.types.VALVE",
  1585|             "action.devices.types.WINDOW"
  1586|           ]
  1587|         },
  1588|         "name": {
  1589|           "type": "object",
  1590|           "properties": {
  1591|             "defaultNames": {
  1592|               "type": "array",
  1593|               "items": {
  1594|                 "type": "string"
  1595|               }
  1596|             },
  1597|             "name": {
  1598|               "type": "string",
  1599|               "maxLength": 40
  1600|             },
  1601|             "nicknames": {
  1602|               "type": "array",
  1603|               "items": {
  1604|                 "type": "string"
  1605|               }
  1606|             }
  1607|           },
  1608|           "required": [
  1609|             "name"
  1610|           ],
  1611|           "additionalProperties": false
  1612|         },
  1613|         "willReportState": {
  1614|           "type": "boolean"
  1615|         },
  1616|         "notificationSupportedByAgent": {
  1617|           "type": "boolean"
  1618|         },
  1619|         "structureHint": {
  1620|           "type": "string",
  1621|           "description": "Name of the home this device belongs to",
  1622|           "maxLength": 40
  1623|         },
  1624|         "roomHint": {
  1625|           "type": "string",
  1626|           "description": "Name of the room this device belongs to",
  1627|           "maxLength": 40
  1628|         },
  1629|         "deviceInfo": {
  1630|           "type": "object",
  1631|           "properties": {
  1632|             "manufacturer": {
  1633|               "type": "string"
  1634|             },
  1635|             "model": {
  1636|               "type": "string"
  1637|             },
  1638|             "hwVersion": {
  1639|               "type": "string"
  1640|             },
  1641|             "swVersion": {
  1642|               "type": "string"
  1643|             }
  1644|           },
  1645|           "required": [
  1646|             "manufacturer",
  1647|             "model",
  1648|             "hwVersion",
  1649|             "swVersion"
  1650|           ],
  1651|           "additionalProperties": false
  1652|         },
  1653|         "otherDeviceIds": {
  1654|           "type": "array",
  1655|           "items": {
  1656|             "type": "object",
  1657|             "properties": {
  1658|               "agentId": {
  1659|                 "type": "string"
  1660|               },
  1661|               "deviceId": {
  1662|                 "type": "string"
  1663|               }
  1664|             },
  1665|             "required": [
  1666|               "deviceId"
  1667|             ],
  1668|             "additionalProperties": false
  1669|           }
  1670|         },
  1671|         "customData": {
  1672|           "type": "object",
  1673|           "properties": {
  1674|             "proxyId": {
  1675|               "type": "string",
  1676|               "description": "Used for local execution to identity the instance responsible of this device",
  1677|               "maxLength": 40
  1678|             }
  1679|           },
  1680|           "additionalProperties": false
  1681|         },
  1682|         "noraSpecific": {
  1683|           "type": "object",
  1684|           "additionalProperties": false,
  1685|           "properties": {
  1686|             "disabled": {
  1687|               "type": "boolean"
  1688|             },
  1689|             "twoFactor": {
  1690|               "$ref": "#/definitions/TwoFactor"
  1691|             }
  1692|           }
  1693|         },
  1694|         "state": {
  1695|           "type": "object",
  1696|           "additionalProperties": false,
  1697|           "properties": {
  1698|             "currentVolume": {
  1699|               "type": "number"
  1700|             },
  1701|             "isMuted": {
  1702|               "type": "boolean"
  1703|             },
  1704|             "online": {
  1705|               "type": "boolean"
  1706|             }
  1707|           },
  1708|           "required": [
  1709|             "currentVolume",
  1710|             "online"
  1711|           ]
  1712|         },
  1713|         "attributes": {
  1714|           "type": "object",
  1715|           "properties": {
  1716|             "volumeMaxLevel": {
  1717|               "type": "number"
  1718|             },
  1719|             "volumeCanMuteAndUnmute": {
  1720|               "type": "boolean"
  1721|             },
  1722|             "volumeDefaultPercentage": {
  1723|               "type": "number"
  1724|             },
  1725|             "levelStepSize": {
  1726|               "type": "number"
  1727|             },
  1728|             "commandOnlyVolume": {
  1729|               "type": "boolean"
  1730|             }
  1731|           },
  1732|           "required": [
  1733|             "volumeMaxLevel",
  1734|             "volumeCanMuteAndUnmute"
  1735|           ],
  1736|           "additionalProperties": false
  1737|         }
  1738|       },
  1739|       "required": [
  1740|         "attributes",
  1741|         "id",
  1742|         "name",
  1743|         "noraSpecific",
  1744|         "state",
  1745|         "traits",
  1746|         "type",
  1747|         "willReportState"
  1748|       ],
  1749|       "definitions": {
  1750|         "Trait": {
  1751|           "type": "string",
  1752|           "enum": [
  1753|             "action.devices.traits.Volume"
  1754|           ]
  1755|         },
  1756|         "TwoFactor": {
  1757|           "anyOf": [
  1758|             {
  1759|               "type": "object",
  1760|               "properties": {
  1761|                 "type": {
  1762|                   "type": "string",
  1763|                   "const": "ack"
  1764|                 }
  1765|               },
  1766|               "required": [
  1767|                 "type"
  1768|               ],
  1769|               "additionalProperties": false
  1770|             },
  1771|             {
  1772|               "type": "object",
  1773|               "properties": {
  1774|                 "type": {
  1775|                   "type": "string",
  1776|                   "const": "pin"
  1777|                 },
  1778|                 "pin": {
  1779|                   "type": "string",
  1780|                   "maxLength": 20
  1781|                 }
  1782|               },
  1783|               "required": [
  1784|                 "type",
  1785|                 "pin"
  1786|               ],
  1787|               "additionalProperties": false
  1788|             }
  1789|           ]
  1790|         }
  1791|       }
  1792|     },
  1793|     "openclose": {
  1794|       "$schema": "http://json-schema.org/draft-07/schema#",
  1795|       "type": "object",
  1796|       "additionalProperties": false,
  1797|       "properties": {
  1798|         "traits": {
  1799|           "type": "array",
  1800|           "items": {
  1801|             "$ref": "#/definitions/Trait"
  1802|           }
  1803|         },
  1804|         "id": {
  1805|           "type": "string"
  1806|         },
  1807|         "type": {
  1808|           "type": "string",
  1809|           "enum": [
  1810|             "action.devices.types.LIGHT",
  1811|             "action.devices.types.SWITCH",
  1812|             "action.devices.types.SCENE",
  1813|             "action.devices.types.OUTLET",
  1814|             "action.devices.types.THERMOSTAT",
  1815|             "action.devices.types.SPEAKER",
  1816|             "action.devices.types.LOCK",
  1817|             "action.devices.types.CLOSET",
  1818|             "action.devices.types.AWNING",
  1819|             "action.devices.types.CURTAIN",
  1820|             "action.devices.types.DOOR",
  1821|             "action.devices.types.DRAWER",
  1822|             "action.devices.types.BLINDS",
  1823|             "action.devices.types.GARAGE",
  1824|             "action.devices.types.GATE",
  1825|             "action.devices.types.PERGOLA",
  1826|             "action.devices.types.SHUTTER",
  1827|             "action.devices.types.VALVE",
  1828|             "action.devices.types.WINDOW"
  1829|           ]
  1830|         },
  1831|         "name": {
  1832|           "type": "object",
  1833|           "properties": {
  1834|             "defaultNames": {
  1835|               "type": "array",
  1836|               "items": {
  1837|                 "type": "string"
  1838|               }
  1839|             },
  1840|             "name": {
  1841|               "type": "string",
  1842|               "maxLength": 40
  1843|             },
  1844|             "nicknames": {
  1845|               "type": "array",
  1846|               "items": {
  1847|                 "type": "string"
  1848|               }
  1849|             }
  1850|           },
  1851|           "required": [
  1852|             "name"
  1853|           ],
  1854|           "additionalProperties": false
  1855|         },
  1856|         "willReportState": {
  1857|           "type": "boolean"
  1858|         },
  1859|         "notificationSupportedByAgent": {
  1860|           "type": "boolean"
  1861|         },
  1862|         "structureHint": {
  1863|           "type": "string",
  1864|           "description": "Name of the home this device belongs to",
  1865|           "maxLength": 40
  1866|         },
  1867|         "roomHint": {
  1868|           "type": "string",
  1869|           "description": "Name of the room this device belongs to",
  1870|           "maxLength": 40
  1871|         },
  1872|         "deviceInfo": {
  1873|           "type": "object",
  1874|           "properties": {
  1875|             "manufacturer": {
  1876|               "type": "string"
  1877|             },
  1878|             "model": {
  1879|               "type": "string"
  1880|             },
  1881|             "hwVersion": {
  1882|               "type": "string"
  1883|             },
  1884|             "swVersion": {
  1885|               "type": "string"
  1886|             }
  1887|           },
  1888|           "required": [
  1889|             "manufacturer",
  1890|             "model",
  1891|             "hwVersion",
  1892|             "swVersion"
  1893|           ],
  1894|           "additionalProperties": false
  1895|         },
  1896|         "otherDeviceIds": {
  1897|           "type": "array",
  1898|           "items": {
  1899|             "type": "object",
  1900|             "properties": {
  1901|               "agentId": {
  1902|                 "type": "string"
  1903|               },
  1904|               "deviceId": {
  1905|                 "type": "string"
  1906|               }
  1907|             },
  1908|             "required": [
  1909|               "deviceId"
  1910|             ],
  1911|             "additionalProperties": false
  1912|           }
  1913|         },
  1914|         "customData": {
  1915|           "type": "object",
  1916|           "properties": {
  1917|             "proxyId": {
  1918|               "type": "string",
  1919|               "description": "Used for local execution to identity the instance responsible of this device",
  1920|               "maxLength": 40
  1921|             }
  1922|           },
  1923|           "additionalProperties": false
  1924|         },
  1925|         "noraSpecific": {
  1926|           "type": "object",
  1927|           "additionalProperties": false,
  1928|           "properties": {
  1929|             "disabled": {
  1930|               "type": "boolean"
  1931|             },
  1932|             "twoFactor": {
  1933|               "$ref": "#/definitions/TwoFactor"
  1934|             }
  1935|           }
  1936|         },
  1937|         "state": {
  1938|           "anyOf": [
  1939|             {
  1940|               "type": "object",
  1941|               "additionalProperties": false,
  1942|               "properties": {
  1943|                 "openPercent": {
  1944|                   "type": "number",
  1945|                   "minimum": 0,
  1946|                   "maximum": 100
  1947|                 },
  1948|                 "online": {
  1949|                   "type": "boolean"
  1950|                 }
  1951|               },
  1952|               "required": [
  1953|                 "online",
  1954|                 "openPercent"
  1955|               ]
  1956|             },
  1957|             {
  1958|               "type": "object",
  1959|               "additionalProperties": false,
  1960|               "properties": {
  1961|                 "openState": {
  1962|                   "type": "array",
  1963|                   "items": {
  1964|                     "type": "object",
  1965|                     "properties": {
  1966|                       "openPercent": {
  1967|                         "type": "number",
  1968|                         "minimum": 0,
  1969|                         "maximum": 100
  1970|                       },
  1971|                       "openDirection": {
  1972|                         "$ref": "#/definitions/OpenCloseDirection"
  1973|                       }
  1974|                     },
  1975|                     "required": [
  1976|                       "openPercent",
  1977|                       "openDirection"
  1978|                     ],
  1979|                     "additionalProperties": false
  1980|                   }
  1981|                 },
  1982|                 "online": {
  1983|                   "type": "boolean"
  1984|                 }
  1985|               },
  1986|               "required": [
  1987|                 "online",
  1988|                 "openState"
  1989|               ]
  1990|             }
  1991|           ]
  1992|         },
  1993|         "attributes": {
  1994|           "type": "object",
  1995|           "properties": {
  1996|             "discreteOnlyOpenClose": {
  1997|               "type": "boolean"
  1998|             },
  1999|             "openDirection": {
  2000|               "type": "array",
  2001|               "items": {
  2002|                 "$ref": "#/definitions/OpenCloseDirection"
  2003|               }
  2004|             },
  2005|             "commandOnlyOpenClose": {
  2006|               "type": "boolean"
  2007|             },
  2008|             "queryOnlyOpenClose": {
  2009|               "type": "boolean"
  2010|             }
  2011|           },
  2012|           "additionalProperties": false
  2013|         }
  2014|       },
  2015|       "required": [
  2016|         "attributes",
  2017|         "id",
  2018|         "name",
  2019|         "noraSpecific",
  2020|         "state",
  2021|         "traits",
  2022|         "type",
  2023|         "willReportState"
  2024|       ],
  2025|       "definitions": {
  2026|         "Trait": {
  2027|           "type": "string",
  2028|           "enum": [
  2029|             "action.devices.traits.OpenClose"
  2030|           ]
  2031|         },
  2032|         "TwoFactor": {
  2033|           "anyOf": [
  2034|             {
  2035|               "type": "object",
  2036|               "properties": {
  2037|                 "type": {
  2038|                   "type": "string",
  2039|                   "const": "ack"
  2040|                 }
  2041|               },
  2042|               "required": [
  2043|                 "type"
  2044|               ],
  2045|               "additionalProperties": false
  2046|             },
  2047|             {
  2048|               "type": "object",
  2049|               "properties": {
  2050|                 "type": {
  2051|                   "type": "string",
  2052|                   "const": "pin"
  2053|                 },
  2054|                 "pin": {
  2055|                   "type": "string",
  2056|                   "maxLength": 20
  2057|                 }
  2058|               },
  2059|               "required": [
  2060|                 "type",
  2061|                 "pin"
  2062|               ],
  2063|               "additionalProperties": false
  2064|             }
  2065|           ]
  2066|         },
  2067|         "OpenCloseDirection": {
  2068|           "type": "string",
  2069|           "enum": [
  2070|             "UP",
  2071|             "DOWN",
  2072|             "LEFT",
  2073|             "RIGHT",
  2074|             "IN",
  2075|             "OUT"
  2076|           ]
  2077|         }
  2078|       }
  2079|     },
  2080|     "mediastate": {
  2081|       "$schema": "http://json-schema.org/draft-07/schema#",
  2082|       "type": "object",
  2083|       "additionalProperties": false,
  2084|       "properties": {
  2085|         "traits": {
  2086|           "type": "array",
  2087|           "items": {
  2088|             "$ref": "#/definitions/Trait"
  2089|           }
  2090|         },
  2091|         "id": {
  2092|           "type": "string"
  2093|         },
  2094|         "type": {
  2095|           "type": "string",
  2096|           "enum": [
  2097|             "action.devices.types.LIGHT",
  2098|             "action.devices.types.SWITCH",
  2099|             "action.devices.types.SCENE",
  2100|             "action.devices.types.OUTLET",
  2101|             "action.devices.types.THERMOSTAT",
  2102|             "action.devices.types.SPEAKER",
  2103|             "action.devices.types.LOCK",
  2104|             "action.devices.types.CLOSET",
  2105|             "action.devices.types.AWNING",
  2106|             "action.devices.types.CURTAIN",
  2107|             "action.devices.types.DOOR",
  2108|             "action.devices.types.DRAWER",
  2109|             "action.devices.types.BLINDS",
  2110|             "action.devices.types.GARAGE",
  2111|             "action.devices.types.GATE",
  2112|             "action.devices.types.PERGOLA",
  2113|             "action.devices.types.SHUTTER",
  2114|             "action.devices.types.VALVE",
  2115|             "action.devices.types.WINDOW"
  2116|           ]
  2117|         },
  2118|         "name": {
  2119|           "type": "object",
  2120|           "properties": {
  2121|             "defaultNames": {
  2122|               "type": "array",
  2123|               "items": {
  2124|                 "type": "string"
  2125|               }
  2126|             },
  2127|             "name": {
  2128|               "type": "string",
  2129|               "maxLength": 40
  2130|             },
  2131|             "nicknames": {
  2132|               "type": "array",
  2133|               "items": {
  2134|                 "type": "string"
  2135|               }
  2136|             }
  2137|           },
  2138|           "required": [
  2139|             "name"
  2140|           ],
  2141|           "additionalProperties": false
  2142|         },
  2143|         "willReportState": {
  2144|           "type": "boolean"
  2145|         },
  2146|         "notificationSupportedByAgent": {
  2147|           "type": "boolean"
  2148|         },
  2149|         "structureHint": {
  2150|           "type": "string",
  2151|           "description": "Name of the home this device belongs to",
  2152|           "maxLength": 40
  2153|         },
  2154|         "roomHint": {
  2155|           "type": "string",
  2156|           "description": "Name of the room this device belongs to",
  2157|           "maxLength": 40
  2158|         },
  2159|         "deviceInfo": {
  2160|           "type": "object",
  2161|           "properties": {
  2162|             "manufacturer": {
  2163|               "type": "string"
  2164|             },
  2165|             "model": {
  2166|               "type": "string"
  2167|             },
  2168|             "hwVersion": {
  2169|               "type": "string"
  2170|             },
  2171|             "swVersion": {
  2172|               "type": "string"
  2173|             }
  2174|           },
  2175|           "required": [
  2176|             "manufacturer",
  2177|             "model",
  2178|             "hwVersion",
  2179|             "swVersion"
  2180|           ],
  2181|           "additionalProperties": false
  2182|         },
  2183|         "otherDeviceIds": {
  2184|           "type": "array",
  2185|           "items": {
  2186|             "type": "object",
  2187|             "properties": {
  2188|               "agentId": {
  2189|                 "type": "string"
  2190|               },
  2191|               "deviceId": {
  2192|                 "type": "string"
  2193|               }
  2194|             },
  2195|             "required": [
  2196|               "deviceId"
  2197|             ],
  2198|             "additionalProperties": false
  2199|           }
  2200|         },
  2201|         "customData": {
  2202|           "type": "object",
  2203|           "properties": {
  2204|             "proxyId": {
  2205|               "type": "string",
  2206|               "description": "Used for local execution to identity the instance responsible of this device",
  2207|               "maxLength": 40
  2208|             }
  2209|           },
  2210|           "additionalProperties": false
  2211|         },
  2212|         "noraSpecific": {
  2213|           "type": "object",
  2214|           "additionalProperties": false,
  2215|           "properties": {
  2216|             "disabled": {
  2217|               "type": "boolean"
  2218|             },
  2219|             "twoFactor": {
  2220|               "$ref": "#/definitions/TwoFactor"
  2221|             }
  2222|           }
  2223|         },
  2224|         "state": {
  2225|           "type": "object",
  2226|           "additionalProperties": false,
  2227|           "properties": {
  2228|             "activityState": {
  2229|               "type": "string",
  2230|               "enum": [
  2231|                 "INACTIVE",
  2232|                 "STANDBY",
  2233|                 "ACTIVE"
  2234|               ]
  2235|             },
  2236|             "playbackState": {
  2237|               "type": "string",
  2238|               "enum": [
  2239|                 "PAUSED",
  2240|                 "PLAYING",
  2241|                 "FAST_FORWARDING",
  2242|                 "REWINDING",
  2243|                 "BUFFERING",
  2244|                 "STOPPED"
  2245|               ]
  2246|             },
  2247|             "online": {
  2248|               "type": "boolean"
  2249|             }
  2250|           },
  2251|           "required": [
  2252|             "activityState",
  2253|             "online",
  2254|             "playbackState"
  2255|           ]
  2256|         },
  2257|         "attributes": {
  2258|           "type": "object",
  2259|           "properties": {
  2260|             "supportActivityState": {
  2261|               "type": "boolean"
  2262|             },
  2263|             "supportPlaybackState": {
  2264|               "type": "boolean"
  2265|             }
  2266|           },
  2267|           "additionalProperties": false
  2268|         }
  2269|       },
  2270|       "required": [
  2271|         "attributes",
  2272|         "id",
  2273|         "name",
  2274|         "noraSpecific",
  2275|         "state",
  2276|         "traits",
  2277|         "type",
  2278|         "willReportState"
  2279|       ],
  2280|       "definitions": {
  2281|         "Trait": {
  2282|           "type": "string",
  2283|           "enum": [
  2284|             "action.devices.traits.MediaState"
  2285|           ]
  2286|         },
  2287|         "TwoFactor": {
  2288|           "anyOf": [
  2289|             {
  2290|               "type": "object",
  2291|               "properties": {
  2292|                 "type": {
  2293|                   "type": "string",
  2294|                   "const": "ack"
  2295|                 }
  2296|               },
  2297|               "required": [
  2298|                 "type"
  2299|               ],
  2300|               "additionalProperties": false
  2301|             },
  2302|             {
  2303|               "type": "object",
  2304|               "properties": {
  2305|                 "type": {
  2306|                   "type": "string",
  2307|                   "const": "pin"
  2308|                 },
  2309|                 "pin": {
  2310|                   "type": "string",
  2311|                   "maxLength": 20
  2312|                 }
  2313|               },
  2314|               "required": [
  2315|                 "type",
  2316|                 "pin"
  2317|               ],
  2318|               "additionalProperties": false
  2319|             }
  2320|           ]
  2321|         }
  2322|       }
  2323|     }
  2324|   },
  2325|   "state": {
  2326|     "brightness": {
  2327|       "$schema": "http://json-schema.org/draft-07/schema#",
  2328|       "type": "object",
  2329|       "additionalProperties": false,
  2330|       "properties": {
  2331|         "brightness": {
  2332|           "type": "number"
  2333|         },
  2334|         "online": {
  2335|           "type": "boolean"
  2336|         }
  2337|       },
  2338|       "required": [
  2339|         "brightness",
  2340|         "online"
  2341|       ],
  2342|       "definitions": {}
  2343|     },
  2344|     "colorsetting": {
  2345|       "$schema": "http://json-schema.org/draft-07/schema#",
  2346|       "type": "object",
  2347|       "additionalProperties": false,
  2348|       "properties": {
  2349|         "color": {
  2350|           "anyOf": [
  2351|             {
  2352|               "type": "object",
  2353|               "properties": {
  2354|                 "temperatureK": {
  2355|                   "type": "number"
  2356|                 }
  2357|               },
  2358|               "required": [
  2359|                 "temperatureK"
  2360|               ],
  2361|               "additionalProperties": false
  2362|             },
  2363|             {
  2364|               "type": "object",
  2365|               "properties": {
  2366|                 "spectrumRgb": {
  2367|                   "type": "number"
  2368|                 }
  2369|               },
  2370|               "required": [
  2371|                 "spectrumRgb"
  2372|               ],
  2373|               "additionalProperties": false
  2374|             },
  2375|             {
  2376|               "type": "object",
  2377|               "properties": {
  2378|                 "spectrumHsv": {
  2379|                   "type": "object",
  2380|                   "properties": {
  2381|                     "hue": {
  2382|                       "type": "number"
  2383|                     },
  2384|                     "saturation": {
  2385|                       "type": "number"
  2386|                     },
  2387|                     "value": {
  2388|                       "type": "number"
  2389|                     }
  2390|                   },
  2391|                   "required": [
  2392|                     "hue",
  2393|                     "saturation",
  2394|                     "value"
  2395|                   ],
  2396|                   "additionalProperties": false
  2397|                 }
  2398|               },
  2399|               "required": [
  2400|                 "spectrumHsv"
  2401|               ],
  2402|               "additionalProperties": false
  2403|             }
  2404|           ]
  2405|         },
  2406|         "online": {
  2407|           "type": "boolean"
  2408|         }
  2409|       },
  2410|       "required": [
  2411|         "color",
  2412|         "online"
  2413|       ],
  2414|       "definitions": {}
  2415|     },
  2416|     "onoff": {
  2417|       "$schema": "http://json-schema.org/draft-07/schema#",
  2418|       "type": "object",
  2419|       "additionalProperties": false,
  2420|       "properties": {
  2421|         "on": {
  2422|           "type": "boolean"
  2423|         },
  2424|         "online": {
  2425|           "type": "boolean"
  2426|         }
  2427|       },
  2428|       "required": [
  2429|         "on",
  2430|         "online"
  2431|       ],
  2432|       "definitions": {}
  2433|     },
  2434|     "lockunlock": {
  2435|       "$schema": "http://json-schema.org/draft-07/schema#",
  2436|       "type": "object",
  2437|       "additionalProperties": false,
  2438|       "properties": {
  2439|         "isLocked": {
  2440|           "type": "boolean"
  2441|         },
  2442|         "isJammed": {
  2443|           "type": "boolean"
  2444|         },
  2445|         "online": {
  2446|           "type": "boolean"
  2447|         }
  2448|       },
  2449|       "required": [
  2450|         "isJammed",
  2451|         "isLocked",
  2452|         "online"
  2453|       ],
  2454|       "definitions": {}
  2455|     },
  2456|     "scene": {
  2457|       "$schema": "http://json-schema.org/draft-07/schema#",
  2458|       "type": "object",
  2459|       "additionalProperties": false,
  2460|       "properties": {
  2461|         "online": {
  2462|           "type": "boolean"
  2463|         }
  2464|       },
  2465|       "required": [
  2466|         "online"
  2467|       ],
  2468|       "definitions": {}
  2469|     },
  2470|     "temperaturesetting": {
  2471|       "$schema": "http://json-schema.org/draft-07/schema#",
  2472|       "type": "object",
  2473|       "additionalProperties": false,
  2474|       "properties": {
  2475|         "thermostatMode": {
  2476|           "$ref": "#/definitions/ThermostatMode"
  2477|         },
  2478|         "thermostatTemperatureAmbient": {
  2479|           "type": "number"
  2480|         },
  2481|         "thermostatHumidityAmbient": {
  2482|           "type": "number",
  2483|           "minimum": 0,
  2484|           "maximum": 100
  2485|         },
  2486|         "thermostatTemperatureSetpoint": {
  2487|           "type": "number"
  2488|         },
  2489|         "thermostatTemperatureSetpointHigh": {
  2490|           "type": "number"
  2491|         },
  2492|         "thermostatTemperatureSetpointLow": {
  2493|           "type": "number"
  2494|         },
  2495|         "online": {
  2496|           "type": "boolean"
  2497|         }
  2498|       },
  2499|       "required": [
  2500|         "online",
  2501|         "thermostatMode",
  2502|         "thermostatTemperatureAmbient",
  2503|         "thermostatTemperatureSetpoint"
  2504|       ],
  2505|       "definitions": {
  2506|         "ThermostatMode": {
  2507|           "type": "string",
  2508|           "enum": [
  2509|             "off",
  2510|             "heat",
  2511|             "cool",
  2512|             "on",
  2513|             "auto",
  2514|             "fan-only",
  2515|             "purifier",
  2516|             "eco",
  2517|             "dry",
  2518|             "heatcool"
  2519|           ]
  2520|         }
  2521|       }
  2522|     },
  2523|     "volume": {
  2524|       "$schema": "http://json-schema.org/draft-07/schema#",
  2525|       "type": "object",
  2526|       "additionalProperties": false,
  2527|       "properties": {
  2528|         "currentVolume": {
  2529|           "type": "number"
  2530|         },
  2531|         "isMuted": {
  2532|           "type": "boolean"
  2533|         },
  2534|         "online": {
  2535|           "type": "boolean"
  2536|         }
  2537|       },
  2538|       "required": [
  2539|         "currentVolume",
  2540|         "online"
  2541|       ],
  2542|       "definitions": {}
  2543|     },
  2544|     "openclose": {
  2545|       "$schema": "http://json-schema.org/draft-07/schema#",
  2546|       "anyOf": [
  2547|         {
  2548|           "type": "object",
  2549|           "additionalProperties": false,
  2550|           "properties": {
  2551|             "openPercent": {
  2552|               "type": "number",
  2553|               "minimum": 0,
  2554|               "maximum": 100
  2555|             },
  2556|             "online": {
  2557|               "type": "boolean"
  2558|             }
  2559|           },
  2560|           "required": [
  2561|             "online",
  2562|             "openPercent"
  2563|           ]
  2564|         },
  2565|         {
  2566|           "type": "object",
  2567|           "additionalProperties": false,
  2568|           "properties": {
  2569|             "openState": {
  2570|               "type": "array",
  2571|               "items": {
  2572|                 "type": "object",
  2573|                 "properties": {
  2574|                   "openPercent": {
  2575|                     "type": "number",
  2576|                     "minimum": 0,
  2577|                     "maximum": 100
  2578|                   },
  2579|                   "openDirection": {
  2580|                     "$ref": "#/definitions/OpenCloseDirection"
  2581|                   }
  2582|                 },
  2583|                 "required": [
  2584|                   "openPercent",
  2585|                   "openDirection"
  2586|                 ],
  2587|                 "additionalProperties": false
  2588|               }
  2589|             },
  2590|             "online": {
  2591|               "type": "boolean"
  2592|             }
  2593|           },
  2594|           "required": [
  2595|             "online",
  2596|             "openState"
  2597|           ]
  2598|         }
  2599|       ],
  2600|       "definitions": {
  2601|         "OpenCloseDirection": {
  2602|           "type": "string",
  2603|           "enum": [
  2604|             "UP",
  2605|             "DOWN",
  2606|             "LEFT",
  2607|             "RIGHT",
  2608|             "IN",
  2609|             "OUT"
  2610|           ]
  2611|         }
  2612|       }
  2613|     },
  2614|     "mediastate": {
  2615|       "$schema": "http://json-schema.org/draft-07/schema#",
  2616|       "type": "object",
  2617|       "additionalProperties": false,
  2618|       "properties": {
  2619|         "activityState": {
  2620|           "type": "string",
  2621|           "enum": [
  2622|             "INACTIVE",
  2623|             "STANDBY",
  2624|             "ACTIVE"
  2625|           ]
  2626|         },
  2627|         "playbackState": {
  2628|           "type": "string",
  2629|           "enum": [
  2630|             "PAUSED",
  2631|             "PLAYING",
  2632|             "FAST_FORWARDING",
  2633|             "REWINDING",
  2634|             "BUFFERING",
  2635|             "STOPPED"
  2636|           ]
  2637|         },
  2638|         "online": {
  2639|           "type": "boolean"
  2640|         }
  2641|       },
  2642|       "required": [
  2643|         "activityState",
  2644|         "online",
  2645|         "playbackState"
  2646|       ],
  2647|       "definitions": {}
  2648|     }
  2649|   },
  2650|   "state-update": {
  2651|     "brightness": {
  2652|       "$schema": "http://json-schema.org/draft-07/schema#",
  2653|       "type": "object",
  2654|       "additionalProperties": false,
  2655|       "properties": {
  2656|         "brightness": {
  2657|           "type": "number"
  2658|         },
  2659|         "online": {
  2660|           "type": "boolean"
  2661|         }
  2662|       },
  2663|       "definitions": {}
  2664|     },
  2665|     "colorsetting": {
  2666|       "$schema": "http://json-schema.org/draft-07/schema#",
  2667|       "type": "object",
  2668|       "additionalProperties": false,
  2669|       "properties": {
  2670|         "color": {
  2671|           "anyOf": [
  2672|             {
  2673|               "type": "object",
  2674|               "properties": {
  2675|                 "temperatureK": {
  2676|                   "type": "number"
  2677|                 }
  2678|               },
  2679|               "additionalProperties": false
  2680|             },
  2681|             {
  2682|               "type": "object",
  2683|               "properties": {
  2684|                 "spectrumRgb": {
  2685|                   "type": "number"
  2686|                 }
  2687|               },
  2688|               "additionalProperties": false
  2689|             },
  2690|             {
  2691|               "type": "object",
  2692|               "properties": {
  2693|                 "spectrumHsv": {
  2694|                   "type": "object",
  2695|                   "properties": {
  2696|                     "hue": {
  2697|                       "type": "number"
  2698|                     },
  2699|                     "saturation": {
  2700|                       "type": "number"
  2701|                     },
  2702|                     "value": {
  2703|                       "type": "number"
  2704|                     }
  2705|                   },
  2706|                   "additionalProperties": false
  2707|                 }
  2708|               },
  2709|               "additionalProperties": false
  2710|             }
  2711|           ]
  2712|         },
  2713|         "online": {
  2714|           "type": "boolean"
  2715|         }
  2716|       },
  2717|       "definitions": {}
  2718|     },
  2719|     "onoff": {
  2720|       "$schema": "http://json-schema.org/draft-07/schema#",
  2721|       "type": "object",
  2722|       "additionalProperties": false,
  2723|       "properties": {
  2724|         "on": {
  2725|           "type": "boolean"
  2726|         },
  2727|         "online": {
  2728|           "type": "boolean"
  2729|         }
  2730|       },
  2731|       "definitions": {}
  2732|     },
  2733|     "lockunlock": {
  2734|       "$schema": "http://json-schema.org/draft-07/schema#",
  2735|       "type": "object",
  2736|       "additionalProperties": false,
  2737|       "properties": {
  2738|         "isLocked": {
  2739|           "type": "boolean"
  2740|         },
  2741|         "isJammed": {
  2742|           "type": "boolean"
  2743|         },
  2744|         "online": {
  2745|           "type": "boolean"
  2746|         }
  2747|       },
  2748|       "definitions": {}
  2749|     },
  2750|     "scene": {
  2751|       "$schema": "http://json-schema.org/draft-07/schema#",
  2752|       "type": "object",
  2753|       "additionalProperties": false,
  2754|       "properties": {
  2755|         "online": {
  2756|           "type": "boolean"
  2757|         }
  2758|       },
  2759|       "definitions": {}
  2760|     },
  2761|     "temperaturesetting": {
  2762|       "$schema": "http://json-schema.org/draft-07/schema#",
  2763|       "type": "object",
  2764|       "additionalProperties": false,
  2765|       "properties": {
  2766|         "thermostatMode": {
  2767|           "$ref": "#/definitions/ThermostatMode"
  2768|         },
  2769|         "thermostatTemperatureAmbient": {
  2770|           "type": "number"
  2771|         },
  2772|         "thermostatHumidityAmbient": {
  2773|           "type": "number",
  2774|           "minimum": 0,
  2775|           "maximum": 100
  2776|         },
  2777|         "thermostatTemperatureSetpoint": {
  2778|           "type": "number"
  2779|         },
  2780|         "thermostatTemperatureSetpointHigh": {
  2781|           "type": "number"
  2782|         },
  2783|         "thermostatTemperatureSetpointLow": {
  2784|           "type": "number"
  2785|         },
  2786|         "online": {
  2787|           "type": "boolean"
  2788|         }
  2789|       },
  2790|       "definitions": {
  2791|         "ThermostatMode": {
  2792|           "type": "string",
  2793|           "enum": [
  2794|             "off",
  2795|             "heat",
  2796|             "cool",
  2797|             "on",
  2798|             "auto",
  2799|             "fan-only",
  2800|             "purifier",
  2801|             "eco",
  2802|             "dry",
  2803|             "heatcool"
  2804|           ]
  2805|         }
  2806|       }
  2807|     },
  2808|     "volume": {
  2809|       "$schema": "http://json-schema.org/draft-07/schema#",
  2810|       "type": "object",
  2811|       "additionalProperties": false,
  2812|       "properties": {
  2813|         "currentVolume": {
  2814|           "type": "number"
  2815|         },
  2816|         "isMuted": {
  2817|           "type": "boolean"
  2818|         },
  2819|         "online": {
  2820|           "type": "boolean"
  2821|         }
  2822|       },
  2823|       "definitions": {}
  2824|     },
  2825|     "openclose": {
  2826|       "$schema": "http://json-schema.org/draft-07/schema#",
  2827|       "anyOf": [
  2828|         {
  2829|           "type": "object",
  2830|           "additionalProperties": false,
  2831|           "properties": {
  2832|             "openPercent": {
  2833|               "type": "number",
  2834|               "minimum": 0,
  2835|               "maximum": 100
  2836|             },
  2837|             "online": {
  2838|               "type": "boolean"
  2839|             }
  2840|           }
  2841|         },
  2842|         {
  2843|           "type": "object",
  2844|           "additionalProperties": false,
  2845|           "properties": {
  2846|             "openState": {
  2847|               "type": "array",
  2848|               "items": {
  2849|                 "type": "object",
  2850|                 "properties": {
  2851|                   "openPercent": {
  2852|                     "type": "number",
  2853|                     "minimum": 0,
  2854|                     "maximum": 100
  2855|                   },
  2856|                   "openDirection": {
  2857|                     "$ref": "#/definitions/OpenCloseDirection"
  2858|                   }
  2859|                 },
  2860|                 "additionalProperties": false
  2861|               }
  2862|             },
  2863|             "online": {
  2864|               "type": "boolean"
  2865|             }
  2866|           }
  2867|         }
  2868|       ],
  2869|       "definitions": {
  2870|         "OpenCloseDirection": {
  2871|           "type": "string",
  2872|           "enum": [
  2873|             "UP",
  2874|             "DOWN",
  2875|             "LEFT",
  2876|             "RIGHT",
  2877|             "IN",
  2878|             "OUT"
  2879|           ]
  2880|         }
  2881|       }
  2882|     },
  2883|     "mediastate": {
  2884|       "$schema": "http://json-schema.org/draft-07/schema#",
  2885|       "type": "object",
  2886|       "additionalProperties": false,
  2887|       "properties": {
  2888|         "activityState": {
  2889|           "type": "string",
  2890|           "enum": [
  2891|             "INACTIVE",
  2892|             "STANDBY",
  2893|             "ACTIVE"
  2894|           ]
  2895|         },
  2896|         "playbackState": {
  2897|           "type": "string",
  2898|           "enum": [
  2899|             "PAUSED",
  2900|             "PLAYING",
  2901|             "FAST_FORWARDING",
  2902|             "REWINDING",
  2903|             "BUFFERING",
  2904|             "STOPPED"
  2905|           ]
  2906|         },
  2907|         "online": {
  2908|           "type": "boolean"
  2909|         }
  2910|       },
  2911|       "definitions": {}
  2912|     }
  2913|   }
  2914| };
  2915| export const IndividualSchema = {
  2916|   "notification": {
  2917|     "$schema": "http://json-schema.org/draft-07/schema#",
  2918|     "type": "object",
  2919|     "properties": {
  2920|       "title": {
  2921|         "type": "string",
  2922|         "description": "Title text of the notification."
  2923|       },
  2924|       "actions": {
  2925|         "type": "array",
  2926|         "items": {
  2927|           "type": "object",
  2928|           "properties": {
  2929|             "action": {
  2930|               "type": "string",
  2931|               "description": "An action available to the user when the notification is presented"
  2932|             },
  2933|             "icon": {
  2934|               "type": "string",
  2935|               "description": "Optional icon for a notification action."
  2936|             },
  2937|             "title": {
  2938|               "type": "string",
  2939|               "description": "Title of the notification action."
  2940|             }
  2941|           },
  2942|           "required": [
  2943|             "action",
  2944|             "title"
  2945|           ],
  2946|           "additionalProperties": false
  2947|         },
  2948|         "description": "An array of notification actions representing the actions\r available to the user when the notification is presented."
  2949|       },
  2950|       "badge": {
  2951|         "type": "string",
  2952|         "description": "URL of the image used to represent the notification when there is\r not enough space to display the notification itself."
  2953|       },
  2954|       "body": {
  2955|         "type": "string",
  2956|         "description": "Body text of the notification."
  2957|       },
  2958|       "dir": {
  2959|         "type": "string",
  2960|         "enum": [
  2961|           "auto",
  2962|           "ltr",
  2963|           "rtl"
  2964|         ],
  2965|         "description": "The direction in which to display the notification. Must be one\r of `auto`, `ltr` or `rtl`."
  2966|       },
  2967|       "icon": {
  2968|         "type": "string",
  2969|         "description": "URL to the notification icon."
  2970|       },
  2971|       "image": {
  2972|         "type": "string",
  2973|         "description": "URL of an image to be displayed in the notification."
  2974|       },
  2975|       "lang": {
  2976|         "type": "string",
  2977|         "description": "The notification's language as a BCP 47 language tag."
  2978|       },
  2979|       "renotify": {
  2980|         "type": "boolean",
  2981|         "description": "A boolean specifying whether the user should be notified after a\r new notification replaces an old one. Defaults to false."
  2982|       },
  2983|       "requireInteraction": {
  2984|         "type": "boolean",
  2985|         "description": "Indicates that a notification should remain active until the user\r clicks or dismisses it, rather than closing automatically.\r Defaults to false."
  2986|       },
  2987|       "silent": {
  2988|         "type": "boolean",
  2989|         "description": "A boolean specifying whether the notification should be silent.\r Defaults to false."
  2990|       },
  2991|       "tag": {
  2992|         "type": "string",
  2993|         "description": "An identifying tag for the notification."
  2994|       },
  2995|       "timestamp": {
  2996|         "type": "number",
  2997|         "description": "Timestamp of the notification. Refer to\r https://developer.mozilla.org/en-US/docs/Web/API/notification/timestamp\r for details."
  2998|       },
  2999|       "vibrate": {
  3000|         "anyOf": [
  3001|           {
  3002|             "type": "number"
  3003|           },
  3004|           {
  3005|             "type": "array",
  3006|             "items": {
  3007|               "type": "number"
  3008|             }
  3009|           }
  3010|         ],
  3011|         "description": "A vibration pattern for the device's vibration hardware to emit\r when the notification fires."
  3012|       },
  3013|       "data": {
  3014|         "type": "object",
  3015|         "properties": {
  3016|           "sender": {
  3017|             "type": "string",
  3018|             "description": "Used by NORA to identify the notification sender."
  3019|           }
  3020|         },
  3021|         "additionalProperties": false
  3022|       }
  3023|     },
  3024|     "additionalProperties": false,
  3025|     "definitions": {}
  3026|   }
  3027| };


# ====================================================================
# FILE: src/update-state.ts
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 1-72 ---
     1| export function updateState(update: any, state: any) {
     2|     const updatedState = deepClone(state);
     3|     const hasChanges = updateStateInternal(update, updatedState);
     4|     return {
     5|         hasChanges,
     6|         state: updatedState,
     7|     };
     8| }
     9| export function deepClone(o: any) {
    10|     return JSON.parse(JSON.stringify(o));
    11| }
    12| const keyResolvers = new Map<string, (item: any, index: number) => any>([
    13|     ['openState', (item) => item.openDirection]
    14| ]);
    15| function updateArrayState(update: any[], state: any[], path = ''): boolean {
    16|     let hasChanges = false;
    17|     const keyResolver = keyResolvers.get(path);
    18|     if (keyResolver) {
    19|         for (const [index, item] of update.entries()) {
    20|             const key = keyResolver(item, index);
    21|             const stateItem = state.find((stateChild, stateIndex) => keyResolver(stateChild, stateIndex) === key);
    22|             if (stateItem) {
    23|                 if (updateStateInternal(item, stateItem, `${path}[${index}]`)) {
    24|                     hasChanges = true;
    25|                 }
    26|             } else {
    27|                 state.push(item);
    28|                 hasChanges = true;
    29|             }
    30|         }
    31|     } else {
    32|         state.splice(0, state.length, ...update);
    33|         return true;
    34|     }
    35|     return hasChanges;
    36| }
    37| function updateStateInternal(update: any, state: any, path = ''): boolean {
    38|     if (Array.isArray(update)) {
    39|         if (!Array.isArray(state)) {
    40|             throw new Error(`${path} is not an array in state`);
    41|         }
    42|         return updateArrayState(update, state, path);
    43|     }
    44|     let hasChanges = false;
    45|     for (const [key, newValue] of entries(update)) {
    46|         const oldValue = state[key];
    47|         const newType = typeof newValue;
    48|         const oldType = typeof oldValue;
    49|         if (newType !== oldType) {
    50|             if (newType === 'object' && oldType === 'undefined' && Object.keys(newValue).length === 0) {
    51|                 continue;
    52|             }
    53|         }
    54|         if (newType === 'object' && oldType === 'object') {
    55|             const keyString = String(key);
    56|             const currentPath = path && path.endsWith('.') ? `${path}.${keyString}` : `${path}${keyString}`;
    57|             if (updateStateInternal(newValue, oldValue as any, currentPath)) {
    58|                 hasChanges = true;
    59|             }
    60|             continue;
    61|         }
    62|         if (newValue !== oldValue) {
    63|             state[key] = newValue;
    64|             hasChanges = true;
    65|             continue;
    66|         }
    67|     }
    68|     return hasChanges;
    69| }
    70| function entries<T>(o: T): [keyof T, any][] {
    71|     return Object.entries(o) as any;
    72| }

