# ====================================================================
# FILE: src/categoryButtons.ts
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-21 ---
     1| import { TinyEmitter as Emitter } from 'tiny-emitter';
     2| import { CLASS_CATEGORY_BUTTONS, CLASS_CATEGORY_BUTTON } from './classes';
     3| import emojiData from './data/emoji';
     4| import { CATEGORY_CLICKED } from './events';
     5| import * as icons from './icons';
     6| import { createElement } from './util';
     7| import { EmojiButtonOptions, I18NCategory, I18NStrings } from './types';
     8| const categoryIcons: { [key in I18NCategory]: string } = {
     9|   recents: icons.history,
    10|   smileys: icons.smile,
    11|   people: icons.user,
    12|   animals: icons.cat,
    13|   food: icons.coffee,
    14|   activities: icons.futbol,
    15|   travel: icons.building,
    16|   objects: icons.lightbulb,
    17|   symbols: icons.music,
    18|   flags: icons.flag,
    19|   custom: icons.icons
    20| };
    21| export class CategoryButtons {


# ====================================================================
# FILE: src/emojiArea.ts
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 1-21 ---
     1| import { TinyEmitter as Emitter } from 'tiny-emitter';
     2| import emojiData from './data/emoji';
     3| import { i18n as defaultI18n } from './i18n';
     4| import {
     5|   CLASS_EMOJI_CONTAINER,
     6|   CLASS_EMOJI,
     7|   CLASS_EMOJI_AREA,
     8|   CLASS_EMOJIS,
     9|   CLASS_CATEGORY_NAME
    10| } from './classes';
    11| import { CategoryButtons } from './categoryButtons';
    12| import { EmojiContainer } from './emojiContainer';
    13| import { CATEGORY_CLICKED } from './events';
    14| import {
    15|   I18NStrings,
    16|   EmojiButtonOptions,
    17|   EmojiRecord,
    18|   RecentEmoji
    19| } from './types';
    20| import { createElement } from './util';
    21| import { load } from './recent';

# --- HUNK 2: Lines 237-278 ---
   237|         break;
   238|     }
   239|     requestAnimationFrame(() =>
   240|       this.emojis.addEventListener('scroll', this.highlightCategory)
   241|     );
   242|   };
   243|   private setFocusedEmoji(index: number, focus = true): void {
   244|     this.focusedIndex = index;
   245|     if (this.focusedEmoji) {
   246|       this.focusedEmoji.tabIndex = 0;
   247|       if (focus) {
   248|         this.focusedEmoji.focus();
   249|       }
   250|     }
   251|   }
   252|   private addCategory = (
   253|     category: string,
   254|     emojis: Array<EmojiRecord | RecentEmoji>
   255|   ): void => {
   256|     const name = createElement('h2', CLASS_CATEGORY_NAME);
   257|     name.innerHTML =
   258|       this.i18n.categories[category] || defaultI18n.categories[category];
   259|     this.emojis.appendChild(name);
   260|     this.headers.push(name);
   261|     this.emojis.appendChild(
   262|       new EmojiContainer(
   263|         emojis,
   264|         true,
   265|         this.events,
   266|         this.options,
   267|         category !== 'recents'
   268|       ).render()
   269|     );
   270|   };
   271|   selectCategory = (category: string, focus = true): void => {
   272|     this.emojis.removeEventListener('scroll', this.highlightCategory);
   273|     if (this.focusedEmoji) {
   274|       this.focusedEmoji.tabIndex = -1;
   275|     }
   276|     const categoryIndex = this.categories.indexOf(category);
   277|     this.currentCategory = categoryIndex;
   278|     this.setFocusedEmoji(0, false);


# ====================================================================
# FILE: src/preview.ts
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 19-45 ---
    19|     this.emoji = createElement('div', CLASS_PREVIEW_EMOJI);
    20|     preview.appendChild(this.emoji);
    21|     this.name = createElement('div', CLASS_PREVIEW_NAME);
    22|     preview.appendChild(this.name);
    23|     this.events.on(SHOW_PREVIEW, (emoji: EmojiRecord) =>
    24|       this.showPreview(emoji)
    25|     );
    26|     this.events.on(HIDE_PREVIEW, () => this.hidePreview());
    27|     return preview;
    28|   }
    29|   showPreview(emoji: EmojiRecord): void {
    30|     let content = emoji.emoji;
    31|     if (emoji.custom) {
    32|       content = `<img class="${CLASS_CUSTOM_EMOJI}" src="${escape(
    33|         emoji.emoji
    34|       )}">`;
    35|     } else if (this.options.style === 'twemoji') {
    36|       content = twemoji.parse(emoji.emoji, this.options.twemojiOptions);
    37|     }
    38|     this.emoji.innerHTML = content;
    39|     this.name.innerHTML = emoji.name;
    40|   }
    41|   hidePreview(): void {
    42|     this.emoji.innerHTML = '';
    43|     this.name.innerHTML = '';
    44|   }
    45| }


# ====================================================================
# FILE: src/search.ts
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 1-53 ---
     1| import { TinyEmitter as Emitter } from 'tiny-emitter';
     2| import * as icons from './icons';
     3| import { EmojiContainer } from './emojiContainer';
     4| import {
     5|   HIDE_PREVIEW,
     6|   HIDE_VARIANT_POPUP,
     7|   SHOW_SEARCH_RESULTS,
     8|   HIDE_SEARCH_RESULTS
     9| } from './events';
    10| import { createElement, empty } from './util';
    11| import { I18NStrings, EmojiButtonOptions, EmojiRecord } from './types';
    12| import {
    13|   CLASS_SEARCH_CONTAINER,
    14|   CLASS_SEARCH_FIELD,
    15|   CLASS_SEARCH_ICON,
    16|   CLASS_NOT_FOUND,
    17|   CLASS_NOT_FOUND_ICON,
    18|   CLASS_EMOJI
    19| } from './classes';
    20| import fuzzysort from 'fuzzysort';
    21| class NotFoundMessage {
    22|   constructor(private message: string, private iconUrl?: string) {}
    23|   render(): HTMLElement {
    24|     const container = createElement('div', CLASS_NOT_FOUND);
    25|     const iconContainer = createElement('div', CLASS_NOT_FOUND_ICON);
    26|     if (this.iconUrl) {
    27|       iconContainer.appendChild(icons.createIcon(this.iconUrl));
    28|     } else {
    29|       iconContainer.innerHTML = icons.frown;
    30|     }
    31|     container.appendChild(iconContainer);
    32|     const messageContainer = createElement('h2');
    33|     messageContainer.innerHTML = this.message;
    34|     container.appendChild(messageContainer);
    35|     return container;
    36|   }
    37| }
    38| export class Search {
    39|   private emojiData: EmojiRecord[];
    40|   private emojisPerRow: number;
    41|   private focusedEmojiIndex = 0;
    42|   private searchContainer: HTMLElement;
    43|   private searchField: HTMLInputElement;
    44|   private searchIcon: HTMLElement;
    45|   private resultsContainer: HTMLElement | null;
    46|   constructor(
    47|     private events: Emitter,
    48|     private i18n: I18NStrings,
    49|     private options: EmojiButtonOptions,
    50|     emojiData: EmojiRecord[],
    51|     categories: number[]
    52|   ) {
    53|     this.emojisPerRow = this.options.emojisPerRow || 8;

