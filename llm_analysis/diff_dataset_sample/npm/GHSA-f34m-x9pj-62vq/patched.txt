# ====================================================================
# FILE: src/categoryButtons.ts
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-22 ---
     1| import { TinyEmitter as Emitter } from 'tiny-emitter';
     2| import escape from 'escape-html';
     3| import { CLASS_CATEGORY_BUTTONS, CLASS_CATEGORY_BUTTON } from './classes';
     4| import emojiData from './data/emoji';
     5| import { CATEGORY_CLICKED } from './events';
     6| import * as icons from './icons';
     7| import { createElement } from './util';
     8| import { EmojiButtonOptions, I18NCategory, I18NStrings } from './types';
     9| const categoryIcons: { [key in I18NCategory]: string } = {
    10|   recents: icons.history,
    11|   smileys: icons.smile,
    12|   people: icons.user,
    13|   animals: icons.cat,
    14|   food: icons.coffee,
    15|   activities: icons.futbol,
    16|   travel: icons.building,
    17|   objects: icons.lightbulb,
    18|   symbols: icons.music,
    19|   flags: icons.flag,
    20|   custom: icons.icons
    21| };
    22| export class CategoryButtons {


# ====================================================================
# FILE: src/emojiArea.ts
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 1-22 ---
     1| import { TinyEmitter as Emitter } from 'tiny-emitter';
     2| import escape from 'escape-html';
     3| import emojiData from './data/emoji';
     4| import { i18n as defaultI18n } from './i18n';
     5| import {
     6|   CLASS_EMOJI_CONTAINER,
     7|   CLASS_EMOJI,
     8|   CLASS_EMOJI_AREA,
     9|   CLASS_EMOJIS,
    10|   CLASS_CATEGORY_NAME
    11| } from './classes';
    12| import { CategoryButtons } from './categoryButtons';
    13| import { EmojiContainer } from './emojiContainer';
    14| import { CATEGORY_CLICKED } from './events';
    15| import {
    16|   I18NStrings,
    17|   EmojiButtonOptions,
    18|   EmojiRecord,
    19|   RecentEmoji
    20| } from './types';
    21| import { createElement } from './util';
    22| import { load } from './recent';

# --- HUNK 2: Lines 238-280 ---
   238|         break;
   239|     }
   240|     requestAnimationFrame(() =>
   241|       this.emojis.addEventListener('scroll', this.highlightCategory)
   242|     );
   243|   };
   244|   private setFocusedEmoji(index: number, focus = true): void {
   245|     this.focusedIndex = index;
   246|     if (this.focusedEmoji) {
   247|       this.focusedEmoji.tabIndex = 0;
   248|       if (focus) {
   249|         this.focusedEmoji.focus();
   250|       }
   251|     }
   252|   }
   253|   private addCategory = (
   254|     category: string,
   255|     emojis: Array<EmojiRecord | RecentEmoji>
   256|   ): void => {
   257|     const name = createElement('h2', CLASS_CATEGORY_NAME);
   258|     name.innerHTML = escape(
   259|       this.i18n.categories[category] || defaultI18n.categories[category]
   260|     );
   261|     this.emojis.appendChild(name);
   262|     this.headers.push(name);
   263|     this.emojis.appendChild(
   264|       new EmojiContainer(
   265|         emojis,
   266|         true,
   267|         this.events,
   268|         this.options,
   269|         category !== 'recents'
   270|       ).render()
   271|     );
   272|   };
   273|   selectCategory = (category: string, focus = true): void => {
   274|     this.emojis.removeEventListener('scroll', this.highlightCategory);
   275|     if (this.focusedEmoji) {
   276|       this.focusedEmoji.tabIndex = -1;
   277|     }
   278|     const categoryIndex = this.categories.indexOf(category);
   279|     this.currentCategory = categoryIndex;
   280|     this.setFocusedEmoji(0, false);


# ====================================================================
# FILE: src/preview.ts
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 19-45 ---
    19|     this.emoji = createElement('div', CLASS_PREVIEW_EMOJI);
    20|     preview.appendChild(this.emoji);
    21|     this.name = createElement('div', CLASS_PREVIEW_NAME);
    22|     preview.appendChild(this.name);
    23|     this.events.on(SHOW_PREVIEW, (emoji: EmojiRecord) =>
    24|       this.showPreview(emoji)
    25|     );
    26|     this.events.on(HIDE_PREVIEW, () => this.hidePreview());
    27|     return preview;
    28|   }
    29|   showPreview(emoji: EmojiRecord): void {
    30|     let content = emoji.emoji;
    31|     if (emoji.custom) {
    32|       content = `<img class="${CLASS_CUSTOM_EMOJI}" src="${escape(
    33|         emoji.emoji
    34|       )}">`;
    35|     } else if (this.options.style === 'twemoji') {
    36|       content = twemoji.parse(emoji.emoji, this.options.twemojiOptions);
    37|     }
    38|     this.emoji.innerHTML = content;
    39|     this.name.innerHTML = escape(emoji.name);
    40|   }
    41|   hidePreview(): void {
    42|     this.emoji.innerHTML = '';
    43|     this.name.innerHTML = '';
    44|   }
    45| }


# ====================================================================
# FILE: src/search.ts
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 1-54 ---
     1| import { TinyEmitter as Emitter } from 'tiny-emitter';
     2| import escape from 'escape-html';
     3| import * as icons from './icons';
     4| import { EmojiContainer } from './emojiContainer';
     5| import {
     6|   HIDE_PREVIEW,
     7|   HIDE_VARIANT_POPUP,
     8|   SHOW_SEARCH_RESULTS,
     9|   HIDE_SEARCH_RESULTS
    10| } from './events';
    11| import { createElement, empty } from './util';
    12| import { I18NStrings, EmojiButtonOptions, EmojiRecord } from './types';
    13| import {
    14|   CLASS_SEARCH_CONTAINER,
    15|   CLASS_SEARCH_FIELD,
    16|   CLASS_SEARCH_ICON,
    17|   CLASS_NOT_FOUND,
    18|   CLASS_NOT_FOUND_ICON,
    19|   CLASS_EMOJI
    20| } from './classes';
    21| import fuzzysort from 'fuzzysort';
    22| class NotFoundMessage {
    23|   constructor(private message: string, private iconUrl?: string) {}
    24|   render(): HTMLElement {
    25|     const container = createElement('div', CLASS_NOT_FOUND);
    26|     const iconContainer = createElement('div', CLASS_NOT_FOUND_ICON);
    27|     if (this.iconUrl) {
    28|       iconContainer.appendChild(icons.createIcon(this.iconUrl));
    29|     } else {
    30|       iconContainer.innerHTML = icons.frown;
    31|     }
    32|     container.appendChild(iconContainer);
    33|     const messageContainer = createElement('h2');
    34|     messageContainer.innerHTML = escape(this.message);
    35|     container.appendChild(messageContainer);
    36|     return container;
    37|   }
    38| }
    39| export class Search {
    40|   private emojiData: EmojiRecord[];
    41|   private emojisPerRow: number;
    42|   private focusedEmojiIndex = 0;
    43|   private searchContainer: HTMLElement;
    44|   private searchField: HTMLInputElement;
    45|   private searchIcon: HTMLElement;
    46|   private resultsContainer: HTMLElement | null;
    47|   constructor(
    48|     private events: Emitter,
    49|     private i18n: I18NStrings,
    50|     private options: EmojiButtonOptions,
    51|     emojiData: EmojiRecord[],
    52|     categories: number[]
    53|   ) {
    54|     this.emojisPerRow = this.options.emojisPerRow || 8;

