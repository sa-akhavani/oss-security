# ====================================================================
# FILE: lib/phoenix_html/tag.ex
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 76-150 ---
    76|     name = to_string(name)
    77|     {:safe, escaped} = html_escape(content)
    78|     {:safe, [?<, name, sorted_attrs(attrs), ?>, escaped, ?<, ?/, name, ?>]}
    79|   end
    80|   @doc ~S"""
    81|   Escapes an enumerable of attributes, returning iodata.
    82|   Pay attention that, unlike `tag/2` and `content_tag/2`, this
    83|   function does not sort the attributes. However if given a map,
    84|   note also that the key ordering may change.
    85|       iex> safe_to_string attributes_escape(title: "the title", id: "the id", selected: true)
    86|       " title=\"the title\" id=\"the id\" selected"
    87|       iex> safe_to_string attributes_escape(%{data: [phx: [value: [foo: "bar"]]], class: "foo"})
    88|       " class=\"foo\" data-phx-value-foo=\"bar\""
    89|   """
    90|   def attributes_escape(attrs) when is_list(attrs) do
    91|     {:safe, build_attrs(attrs)}
    92|   end
    93|   def attributes_escape(attrs) do
    94|     {:safe, attrs |> Enum.to_list() |> build_attrs()}
    95|   end
    96|   defp build_attrs([{k, true} | t]),
    97|     do: [?\s, key_escape(k) | build_attrs(t)]
    98|   defp build_attrs([{_, false} | t]),
    99|     do: build_attrs(t)
   100|   defp build_attrs([{_, nil} | t]),
   101|     do: build_attrs(t)
   102|   defp build_attrs([{"data", v} | t]) when is_list(v),
   103|     do: nested_attrs(v, " data", t)
   104|   defp build_attrs([{"aria", v} | t]) when is_list(v),
   105|     do: nested_attrs(v, " aria", t)
   106|   defp build_attrs([{"class", v} | t]) when is_list(v),
   107|     do: [" class=\"", class_value(v), ?" | build_attrs(t)]
   108|   defp build_attrs([{:data, v} | t]) when is_list(v),
   109|     do: nested_attrs(v, " data", t)
   110|   defp build_attrs([{:aria, v} | t]) when is_list(v),
   111|     do: nested_attrs(v, " aria", t)
   112|   defp build_attrs([{:class, v} | t]) when is_list(v),
   113|     do: [" class=\"", class_value(v), ?" | build_attrs(t)]
   114|   defp build_attrs([{k, v} | t]),
   115|     do: [?\s, key_escape(k), ?=, ?", attr_escape(v), ?" | build_attrs(t)]
   116|   defp build_attrs([]), do: []
   117|   defp nested_attrs([{k, v} | kv], attr, t) when is_list(v),
   118|     do: [nested_attrs(v, "#{attr}-#{key_escape(k)}", []) | nested_attrs(kv, attr, t)]
   119|   defp nested_attrs([{k, v} | kv], attr, t),
   120|     do: [attr, ?-, key_escape(k), ?=, ?", attr_escape(v), ?" | nested_attrs(kv, attr, t)]
   121|   defp nested_attrs([], _attr, t),
   122|     do: build_attrs(t)
   123|   defp class_value(value) when is_list(value) do
   124|     value
   125|     |> Enum.filter(& &1)
   126|     |> Enum.join(" ")
   127|     |> attr_escape()
   128|   end
   129|   defp class_value(value) do
   130|     attr_escape(value)
   131|   end
   132|   defp key_escape(value) when is_atom(value), do: String.replace(Atom.to_string(value), "_", "-")
   133|   defp key_escape(value), do: attr_escape(value)
   134|   defp attr_escape({:safe, data}), do: data
   135|   defp attr_escape(nil), do: []
   136|   defp attr_escape(other) when is_binary(other), do: Phoenix.HTML.Engine.encode_to_iodata!(other)
   137|   defp attr_escape(other), do: Phoenix.HTML.Safe.to_iodata(other)
   138|   defp sorted_attrs(attrs) when is_list(attrs),
   139|     do: attrs |> normalize_attrs() |> Enum.sort() |> build_attrs()
   140|   defp sorted_attrs(attrs),
   141|     do: attrs |> Enum.to_list() |> sorted_attrs()
   142|   defp normalize_attrs([{k, v} | tail]), do: [{k, v} | normalize_attrs(tail)]
   143|   defp normalize_attrs([k | tail]), do: [{k, true} | normalize_attrs(tail)]
   144|   defp normalize_attrs([]), do: []
   145|   @doc ~S"""
   146|   Generates a form tag.
   147|   This function generates the `<form>` tag without its closing part.
   148|   Check `form_tag/3` for generating an enclosing tag.
   149|       form_tag("/hello")
   150|       <form action="/hello" method="post">


# ====================================================================
# FILE: mix.exs
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-23 ---
     1| defmodule PhoenixHtml.Mixfile do
     2|   use Mix.Project
     3|   @version "3.0.4"
     4|   def project do
     5|     [
     6|       app: :phoenix_html,
     7|       version: @version,
     8|       elixir: "~> 1.7",
     9|       deps: deps(),
    10|       name: "Phoenix.HTML",
    11|       description: "Phoenix view functions for working with HTML templates",
    12|       package: package(),
    13|       docs: [
    14|         source_ref: "v#{@version}",
    15|         main: "Phoenix.HTML",
    16|         source_url: "https://github.com/phoenixframework/phoenix_html"
    17|       ]
    18|     ]
    19|   end
    20|   def application do
    21|     [
    22|       extra_applications: [:eex, :logger],
    23|       env: [csrf_token_reader: {Plug.CSRFProtection, :get_csrf_token_for, []}]

