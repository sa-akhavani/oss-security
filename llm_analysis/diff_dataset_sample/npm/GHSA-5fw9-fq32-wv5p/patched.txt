# ====================================================================
# FILE: lib/utils.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 241-283 ---
   241|   var keyExtra = extra.keyExtra || '';
   242|   var allowedArguments = extra.allowedArguments || [];
   243|   var noEscape = extra.noEscape !== undefined;
   244|   var checkForAllowed = extra.allowedArguments !== undefined;
   245|   var explicitTrue = !!extra.explicitTrue;
   246|   var keepNewlines = !!extra.keepNewlines;
   247|   var wrapper = extra.wrapper === undefined ? '"' : extra.wrapper;
   248|   var escapeFn = function (arg) {
   249|     if (isArray(arg)) {
   250|       return removeNewLines(arg.join(','));
   251|     }
   252|     if (!noEscape) {
   253|       arg = escapeQuotes(arg);
   254|     }
   255|     if (typeof arg === 'string' && !keepNewlines) {
   256|       arg = removeNewLines(arg);
   257|     }
   258|     return wrapper + arg + wrapper;
   259|   };
   260|   initial.forEach(function (val) {
   261|     if (typeof val === 'string') {
   262|       args.push(escapeFn(val));
   263|     }
   264|   });
   265|   for (var key in options) {
   266|     if (
   267|       options.hasOwnProperty(key) &&
   268|       (!checkForAllowed || inArray(allowedArguments, key))
   269|     ) {
   270|       if (explicitTrue && options[key] === true) {
   271|         args.push('-' + keyExtra + key);
   272|       } else if (explicitTrue && options[key] === false) continue;
   273|       else args.push('-' + keyExtra + key, escapeFn(options[key]));
   274|     }
   275|   }
   276|   return args;
   277| };
   278| function removeNewLines(str) {
   279|   var excapedNewline = process.platform === 'win32' ? '\\r\\n' : '\\n';
   280|   return str.replace(/\r?\n/g, excapedNewline);
   281| }
   282| /*
   283| ---- Options ----

