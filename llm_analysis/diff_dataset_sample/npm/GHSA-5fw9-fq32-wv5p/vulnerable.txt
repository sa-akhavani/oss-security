# ====================================================================
# FILE: lib/utils.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 241-281 ---
   241|   var keyExtra = extra.keyExtra || '';
   242|   var allowedArguments = extra.allowedArguments || [];
   243|   var noEscape = extra.noEscape !== undefined;
   244|   var checkForAllowed = extra.allowedArguments !== undefined;
   245|   var explicitTrue = !!extra.explicitTrue;
   246|   var keepNewlines = !!extra.keepNewlines;
   247|   var wrapper = extra.wrapper === undefined ? '"' : extra.wrapper;
   248|   var escapeFn = function (arg) {
   249|     if (isArray(arg)) {
   250|       return removeNewLines(arg.join(','));
   251|     }
   252|     if (!noEscape) {
   253|       arg = escapeQuotes(arg);
   254|     }
   255|     if (typeof arg === 'string' && !keepNewlines) {
   256|       arg = removeNewLines(arg);
   257|     }
   258|     return wrapper + arg + wrapper;
   259|   };
   260|   initial.forEach(function (val) {
   261|     args.push(escapeFn(val));
   262|   });
   263|   for (var key in options) {
   264|     if (
   265|       options.hasOwnProperty(key) &&
   266|       (!checkForAllowed || inArray(allowedArguments, key))
   267|     ) {
   268|       if (explicitTrue && options[key] === true) {
   269|         args.push('-' + keyExtra + key);
   270|       } else if (explicitTrue && options[key] === false) continue;
   271|       else args.push('-' + keyExtra + key, escapeFn(options[key]));
   272|     }
   273|   }
   274|   return args;
   275| };
   276| function removeNewLines(str) {
   277|   var excapedNewline = process.platform === 'win32' ? '\\r\\n' : '\\n';
   278|   return str.replace(/\r?\n/g, excapedNewline);
   279| }
   280| /*
   281| ---- Options ----

