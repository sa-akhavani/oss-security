# ====================================================================
# FILE: karma.conf.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 15-54 ---
    15|     preprocessors.push(bundler);
    16|   } else if(bundler === 'webpack') {
    17|     preprocessors.push(bundler);
    18|     preprocessors.push('sourcemap');
    19|     files.push('tests/karma/web-worker-rsa.js');
    20|   } else {
    21|     throw Error('Unknown bundler');
    22|   }
    23|   config.set({
    24|     basePath: '',
    25|     frameworks: frameworks,
    26|     files: files,
    27|     exclude: [
    28|     ],
    29|     preprocessors: {
    30|       'tests/unit/**.js': preprocessors,
    31|       'tests/karma/**.js': preprocessors,
    32|       'lib/prime.worker.js': workerPreprocessors
    33|     },
    34|     webpack: {
    35|       devtool: 'inline-source-map',
    36|       node: {
    37|         Buffer: false,
    38|         process: false,
    39|         crypto: false,
    40|         setImmediate: false
    41|       }
    42|     },
    43|     browserify: {
    44|       debug: true
    45|     },
    46|     reporters: ['mocha'],
    47|     port: 9876,
    48|     colors: true,
    49|     logLevel: config.LOG_INFO,
    50|     autoWatch: false,
    51|     browsers: ['ChromeHeadless'],
    52|     customLaunchers: {
    53|       IE9: {
    54|         base: 'IE',


# ====================================================================
# FILE: lib/util.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 2164-2290 ---
  2164| /**
  2165|  * Makes a URI out of a path, an object with query parameters, and a
  2166|  * fragment. Uses jQuery.param() internally for query string creation.
  2167|  * If the path is an array, it will be joined with '/'.
  2168|  *
  2169|  * @param path string path or array of strings.
  2170|  * @param query object with query parameters. (optional)
  2171|  * @param fragment fragment string. (optional)
  2172|  *
  2173|  * @return string object with request parameters.
  2174|  */
  2175| util.makeLink = function(path, query, fragment) {
  2176|   path = jQuery.isArray(path) ? path.join('/') : path;
  2177|   var qstr = jQuery.param(query || {});
  2178|   fragment = fragment || '';
  2179|   return path +
  2180|     ((qstr.length > 0) ? ('?' + qstr) : '') +
  2181|     ((fragment.length > 0) ? ('#' + fragment) : '');
  2182| };
  2183| /**
  2184|  * Follows a path of keys deep into an object hierarchy and set a value.
  2185|  * If a key does not exist or it's value is not an object, create an
  2186|  * object in it's place. This can be destructive to a object tree if
  2187|  * leaf nodes are given as non-final path keys.
  2188|  * Used to avoid exceptions from missing parts of the path.
  2189|  *
  2190|  * SECURITY NOTE: Do not use unsafe inputs. Doing so could expose a prototype
  2191|  * pollution security issue.
  2192|  *
  2193|  * @param object the starting object.
  2194|  * @param keys an array of string keys.
  2195|  * @param value the value to set.
  2196|  */
  2197| util.setPath = function(object, keys, value) {
  2198|   if(typeof(object) === 'object' && object !== null) {
  2199|     var i = 0;
  2200|     var len = keys.length;
  2201|     while(i < len) {
  2202|       var next = keys[i++];
  2203|       if(i == len) {
  2204|         object[next] = value;
  2205|       } else {
  2206|         var hasNext = (next in object);
  2207|         if(!hasNext ||
  2208|           (hasNext && typeof(object[next]) !== 'object') ||
  2209|           (hasNext && object[next] === null)) {
  2210|           object[next] = {};
  2211|         }
  2212|         object = object[next];
  2213|       }
  2214|     }
  2215|   }
  2216| };
  2217| /**
  2218|  * Follows a path of keys deep into an object hierarchy and return a value.
  2219|  * If a key does not exist, create an object in it's place.
  2220|  * Used to avoid exceptions from missing parts of the path.
  2221|  *
  2222|  * @param object the starting object.
  2223|  * @param keys an array of string keys.
  2224|  * @param _default value to return if path not found.
  2225|  *
  2226|  * @return the value at the path if found, else default if given, else
  2227|  *         undefined.
  2228|  */
  2229| util.getPath = function(object, keys, _default) {
  2230|   var i = 0;
  2231|   var len = keys.length;
  2232|   var hasNext = true;
  2233|   while(hasNext && i < len &&
  2234|     typeof(object) === 'object' && object !== null) {
  2235|     var next = keys[i++];
  2236|     hasNext = next in object;
  2237|     if(hasNext) {
  2238|       object = object[next];
  2239|     }
  2240|   }
  2241|   return (hasNext ? object : _default);
  2242| };
  2243| /**
  2244|  * Follow a path of keys deep into an object hierarchy and delete the
  2245|  * last one. If a key does not exist, do nothing.
  2246|  * Used to avoid exceptions from missing parts of the path.
  2247|  *
  2248|  * @param object the starting object.
  2249|  * @param keys an array of string keys.
  2250|  */
  2251| util.deletePath = function(object, keys) {
  2252|   if(typeof(object) === 'object' && object !== null) {
  2253|     var i = 0;
  2254|     var len = keys.length;
  2255|     while(i < len) {
  2256|       var next = keys[i++];
  2257|       if(i == len) {
  2258|         delete object[next];
  2259|       } else {
  2260|         if(!(next in object) ||
  2261|           (typeof(object[next]) !== 'object') ||
  2262|           (object[next] === null)) {
  2263|            break;
  2264|         }
  2265|         object = object[next];
  2266|       }
  2267|     }
  2268|   }
  2269| };
  2270| /**
  2271|  * Check if an object is empty.
  2272|  *
  2273|  * Taken from:
  2274|  * http://stackoverflow.com/questions/679915/how-do-i-test-for-an-empty-javascript-object-from-json/679937#679937
  2275|  *
  2276|  * @param object the object to check.
  2277|  */
  2278| util.isEmpty = function(obj) {
  2279|   for(var prop in obj) {
  2280|     if(obj.hasOwnProperty(prop)) {
  2281|       return false;
  2282|     }
  2283|   }
  2284|   return true;
  2285| };
  2286| /**
  2287|  * Format with simple printf-style interpolation.
  2288|  *
  2289|  * %%: literal '%'
  2290|  * %s,%o: convert next argument into a string.


# ====================================================================
# FILE: webpack.config.js
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 1-81 ---
     1| /**
     2|  * Forge webpack build rules.
     3|  *
     4|  * @author Digital Bazaar, Inc.
     5|  *
     6|  * Copyright 2011-2016 Digital Bazaar, Inc.
     7|  */
     8| const path = require('path');
     9| const webpack = require('webpack');
    10| module.exports = [];
    11| const outputs = [
    12|   {
    13|     entry: ['./lib/index.js'],
    14|     filenameBase: 'forge'
    15|   },
    16|   {
    17|     entry: ['./lib/index.all.js'],
    18|     filenameBase: 'forge.all'
    19|   },
    20|   {
    21|     entry: ['./lib/prime.worker.js', './lib/forge.js'],
    22|     filenameBase: 'prime.worker',
    23|     library: null,
    24|     libraryTarget: null
    25|   }
    26| ];
    27| outputs.forEach(info => {
    28|   const common = {
    29|     entry: {
    30|       forge: info.entry
    31|     },
    32|     node: {
    33|       Buffer: false,
    34|       process: false,
    35|       crypto: false,
    36|       setImmediate: false
    37|     }
    38|   };
    39|   const bundle = Object.assign({}, common, {
    40|     output: {
    41|       path: path.join(__dirname, 'dist'),
    42|       filename: info.filenameBase + '.js',
    43|       library: info.library || '[name]',
    44|       libraryTarget: info.libraryTarget || 'umd'
    45|     }
    46|   });
    47|   if(info.library === null) {
    48|     delete bundle.output.library;
    49|   }
    50|   if(info.libraryTarget === null) {
    51|     delete bundle.output.libraryTarget;
    52|   }
    53|   const minify = Object.assign({}, common, {
    54|     output: {
    55|       path: path.join(__dirname, 'dist'),
    56|       filename: info.filenameBase + '.min.js',
    57|       library: info.library || '[name]',
    58|       libraryTarget: info.libraryTarget || 'umd'
    59|     },
    60|     devtool: 'cheap-module-source-map',
    61|     plugins: [
    62|       new webpack.optimize.UglifyJsPlugin({
    63|         sourceMap: true,
    64|         compress: {
    65|           warnings: true
    66|         },
    67|         output: {
    68|           comments: false
    69|         }
    70|       })
    71|     ]
    72|   });
    73|   if(info.library === null) {
    74|     delete minify.output.library;
    75|   }
    76|   if(info.libraryTarget === null) {
    77|     delete minify.output.libraryTarget;
    78|   }
    79|   module.exports.push(bundle);
    80|   module.exports.push(minify);
    81| });

