# ====================================================================
# FILE: src/Formie.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-626 ---
     1| <?php
     2| namespace verbb\formie;
     3| use verbb\formie\base\PluginTrait;
     4| use verbb\formie\elements\Form;
     5| use verbb\formie\elements\SentNotification;
     6| use verbb\formie\elements\Submission;
     7| use verbb\formie\elements\exporters\FormExport;
     8| use verbb\formie\elements\exporters\SubmissionExport;
     9| use verbb\formie\fields\Forms;
    10| use verbb\formie\fields\Submissions;
    11| use verbb\formie\gql\interfaces\FieldInterface;
    12| use verbb\formie\gql\interfaces\FormInterface;
    13| use verbb\formie\gql\interfaces\PageInterface;
    14| use verbb\formie\gql\interfaces\PageSettingsInterface;
    15| use verbb\formie\gql\interfaces\RowInterface;
    16| use verbb\formie\gql\interfaces\SubmissionInterface;
    17| use verbb\formie\gql\mutations\SubmissionMutation;
    18| use verbb\formie\gql\queries\FormQuery;
    19| use verbb\formie\gql\queries\SubmissionQuery;
    20| use verbb\formie\helpers\Gql as GqlHelper;
    21| use verbb\formie\helpers\ProjectConfigHelper;
    22| use verbb\formie\integrations\feedme\elements\Submission as FeedMeSubmission;
    23| use verbb\formie\integrations\link\FormLinkType;
    24| use verbb\formie\jobs\BaseJob;
    25| use verbb\formie\models\Settings;
    26| use verbb\formie\services\EmailTemplates as EmailTemplatesService;
    27| use verbb\formie\services\FormTemplates as FormTemplatesService;
    28| use verbb\formie\services\Integrations as IntegrationsService;
    29| use verbb\formie\services\PdfTemplates as PdfTemplatesService;
    30| use verbb\formie\services\Statuses as StatusesService;
    31| use verbb\formie\services\Stencils as StencilsService;
    32| use verbb\formie\variables\Formie as FormieVariable;
    33| use verbb\formie\web\twig\Extension;
    34| use verbb\formie\widgets\RecentSubmissions;
    35| use Craft;
    36| use craft\base\Model;
    37| use craft\base\Plugin;
    38| use craft\controllers\UsersController;
    39| use craft\console\Application as ConsoleApplication;
    40| use craft\console\Controller as ConsoleController;
    41| use craft\console\controllers\ResaveController;
    42| use craft\elements\User as UserElement;
    43| use craft\elements\exporters\Expanded;
    44| use craft\elements\exporters\Raw;
    45| use craft\enums\CmsEdition;
    46| use craft\events\DefineConsoleActionsEvent;
    47| use craft\events\FieldLayoutEvent;
    48| use craft\events\PluginEvent;
    49| use craft\events\RebuildConfigEvent;
    50| use craft\events\RegisterComponentTypesEvent;
    51| use craft\events\RegisterElementExportersEvent;
    52| use craft\events\RegisterEmailMessagesEvent;
    53| use craft\events\RegisterGqlMutationsEvent;
    54| use craft\events\RegisterGqlQueriesEvent;
    55| use craft\events\RegisterGqlSchemaComponentsEvent;
    56| use craft\events\RegisterGqlTypesEvent;
    57| use craft\events\RegisterTemplateRootsEvent;
    58| use craft\events\RegisterUrlRulesEvent;
    59| use craft\events\RegisterUserPermissionsEvent;
    60| use craft\fields\Link;
    61| use craft\helpers\Cp;
    62| use craft\queue\Queue;
    63| use craft\services\Dashboard;
    64| use craft\services\Elements;
    65| use craft\services\ElementSources;
    66| use craft\services\Fields;
    67| use craft\services\Gc;
    68| use craft\services\Gql;
    69| use craft\services\Plugins;
    70| use craft\services\ProjectConfig;
    71| use craft\services\SystemMessages;
    72| use craft\services\UserPermissions;
    73| use craft\helpers\UrlHelper;
    74| use craft\web\twig\variables\CraftVariable;
    75| use craft\web\UrlManager;
    76| use craft\web\View;
    77| use craft\gatsbyhelper\events\RegisterSourceNodeTypesEvent;
    78| use craft\gatsbyhelper\services\SourceNodes;
    79| use craft\feedme\events\RegisterFeedMeElementsEvent;
    80| use craft\feedme\events\RegisterFeedMeFieldsEvent;
    81| use craft\feedme\services\Elements as FeedMeElements;
    82| use craft\feedme\services\Fields as FeedMeFields;
    83| use yii\base\Event;
    84| use yii\queue\ExecEvent;
    85| class Formie extends Plugin
    86| {
    87|     public const EVENT_MODIFY_TWIG_ENVIRONMENT = 'modifyTwigEnvironment';
    88|     public bool $hasCpSection = true;
    89|     public bool $hasCpSettings = true;
    90|     public string $schemaVersion = '3.4.8';
    91|     public string $minVersionRequired = '2.1.5';
    92|     use PluginTrait;
    93|     public function init(): void
    94|     {
    95|         parent::init();
    96|         self::$plugin = $this;
    97|         $this->_registerTwigExtensions();
    98|         $this->_registerFieldTypes();
    99|         $this->_registerVariable();
   100|         $this->_registerElementTypes();
   101|         $this->_registerGarbageCollection();
   102|         $this->_registerGraphQl();
   103|         $this->_registerEventHandlers();
   104|         $this->_registerProjectConfigEventHandlers();
   105|         $this->_registerEmailMessages();
   106|         $this->_registerTemplateRoots();
   107|         $this->_registerTemplateHooks();
   108|         if (Craft::$app->getRequest()->getIsCpRequest()) {
   109|             $this->_registerCpRoutes();
   110|             $this->_registerWidgets();
   111|             $this->_registerElementExports();
   112|         }
   113|         if (Craft::$app->getRequest()->getIsConsoleRequest()) {
   114|             $this->_registerResaveCommand();
   115|         }
   116|         if (Craft::$app->getRequest()->getIsSiteRequest()) {
   117|             $this->_registerSiteRoutes();
   118|         }
   119|         if (Craft::$app->getEdition() !== Craft::Solo) {
   120|             $this->_registerPermissions();
   121|         }
   122|     }
   123|     public function getPluginName(): string
   124|     {
   125|         return Craft::t('formie', $this->getSettings()->pluginName);
   126|     }
   127|     public function getSettingsResponse(): mixed
   128|     {
   129|         return Craft::$app->getResponse()->redirect(UrlHelper::cpUrl('formie/settings'));
   130|     }
   131|     public function getCpNavItem(): ?array
   132|     {
   133|         $nav = parent::getCpNavItem();
   134|         /* @var Settings $settings */
   135|         $settings = Formie::$plugin->getSettings();
   136|         $nav['label'] = $this->getPluginName();
   137|         if (Craft::$app->getUser()->checkPermission('formie-accessForms')) {
   138|             $nav['subnav']['forms'] = [
   139|                 'label' => Craft::t('formie', 'Forms'),
   140|                 'url' => 'formie/forms',
   141|             ];
   142|         }
   143|         if (Craft::$app->getUser()->checkPermission('formie-accessSubmissions')) {
   144|             $nav['subnav']['submissions'] = [
   145|                 'label' => Craft::t('formie', 'Submissions'),
   146|                 'url' => 'formie/submissions',
   147|             ];
   148|         }
   149|         if (Craft::$app->getUser()->checkPermission('formie-accessSentNotifications') && $settings->sentNotifications) {
   150|             $nav['subnav']['sentNotifications'] = [
   151|                 'label' => Craft::t('formie', 'Sent Notifications'),
   152|                 'url' => 'formie/sent-notifications',
   153|             ];
   154|         }
   155|         if (Craft::$app->getUser()->getIsAdmin()) {
   156|             $nav['subnav']['settings'] = [
   157|                 'label' => Craft::t('formie', 'Settings'),
   158|                 'url' => 'formie/settings',
   159|             ];
   160|         }
   161|         return $nav;
   162|     }
   163|     protected function createSettingsModel(): Settings
   164|     {
   165|         return new Settings();
   166|     }
   167|     private function _registerTwigExtensions(): void
   168|     {
   169|         Craft::$app->getView()->registerTwigExtension(new Extension);
   170|     }
   171|     public function _registerSiteRoutes(): void
   172|     {
   173|         Event::on(UrlManager::class, UrlManager::EVENT_REGISTER_SITE_URL_RULES, function(RegisterUrlRulesEvent $event) {
   174|             $event->rules['formie/integrations/callback'] = 'formie/integrations/callback';
   175|             $event->rules['formie/payment-webhooks/process-webhook'] = 'formie/payment-webhooks/process-webhook';
   176|             $event->rules['formie/payment-webhooks/process-callback'] = 'formie/payment-webhooks/process-callback';
   177|         });
   178|     }
   179|     public function _registerCpRoutes(): void
   180|     {
   181|         Event::on(UrlManager::class, UrlManager::EVENT_REGISTER_CP_URL_RULES, function(RegisterUrlRulesEvent $event) {
   182|             $event->rules['formie'] = 'formie/base/index';
   183|             $event->rules['formie/forms'] = 'formie/forms/index';
   184|             $event->rules['formie/forms/new'] = 'formie/forms/new';
   185|             $event->rules['formie/forms/edit/<formId:\d+>'] = 'formie/forms/edit';
   186|             $event->rules['formie/submissions'] = 'formie/submissions/index';
   187|             $event->rules['formie/submissions/<formHandle:{handle}>'] = 'formie/submissions/index';
   188|             $event->rules['formie/submissions/<formHandle:{handle}>/new'] = 'formie/submissions/edit-submission';
   189|             $event->rules['formie/submissions/<formHandle:{handle}>/<submissionId:\d+>'] = 'formie/submissions/edit-submission';
   190|             $event->rules['formie/sent-notifications'] = 'formie/sent-notifications/index';
   191|             $event->rules['formie/sent-notifications/edit/<sentNotificationId:\d+>'] = 'formie/sent-notifications/edit';
   192|             $event->rules['formie/settings'] = 'formie/settings/index';
   193|             $event->rules['formie/settings/general'] = 'formie/settings/index';
   194|             $event->rules['formie/settings/forms'] = 'formie/settings/forms';
   195|             $event->rules['formie/settings/fields'] = 'formie/settings/fields';
   196|             $event->rules['formie/settings/submissions'] = 'formie/settings/submissions';
   197|             $event->rules['formie/settings/spam'] = 'formie/settings/spam';
   198|             $event->rules['formie/settings/notifications'] = 'formie/notifications/index';
   199|             $event->rules['formie/settings/sent-notifications'] = 'formie/sent-notifications/settings';
   200|             $event->rules['formie/settings/statuses'] = 'formie/statuses/index';
   201|             $event->rules['formie/settings/statuses/new'] = 'formie/statuses/edit';
   202|             $event->rules['formie/settings/statuses/edit/<id:\d+>'] = 'formie/statuses/edit';
   203|             $event->rules['formie/settings/stencils'] = 'formie/stencils/index';
   204|             $event->rules['formie/settings/stencils/new'] = 'formie/stencils/new';
   205|             $event->rules['formie/settings/stencils/edit/<id:\d+>'] = 'formie/stencils/edit';
   206|             $event->rules['formie/settings/form-templates'] = 'formie/form-templates/index';
   207|             $event->rules['formie/settings/form-templates/new'] = 'formie/form-templates/edit';
   208|             $event->rules['formie/settings/form-templates/edit/<id:\d+>'] = 'formie/form-templates/edit';
   209|             $event->rules['formie/settings/email-templates'] = 'formie/email-templates/index';
   210|             $event->rules['formie/settings/email-templates/new'] = 'formie/email-templates/edit';
   211|             $event->rules['formie/settings/email-templates/edit/<id:\d+>'] = 'formie/email-templates/edit';
   212|             $event->rules['formie/settings/pdf-templates'] = 'formie/pdf-templates/index';
   213|             $event->rules['formie/settings/pdf-templates/new'] = 'formie/pdf-templates/edit';
   214|             $event->rules['formie/settings/pdf-templates/edit/<id:\d+>'] = 'formie/pdf-templates/edit';
   215|             $event->rules['formie/settings/security'] = 'formie/security/index';
   216|             $event->rules['formie/settings/privacy'] = 'formie/privacy/index';
   217|             $event->rules['formie/settings/captchas'] = 'formie/integration-settings/captcha-index';
   218|             $event->rules['formie/settings/address-providers'] = 'formie/integration-settings/address-provider-index';
   219|             $event->rules['formie/settings/address-providers/new'] = 'formie/integration-settings/edit-address-provider';
   220|             $event->rules['formie/settings/address-providers/edit/<integrationId:\d+>'] = 'formie/integration-settings/edit-address-provider';
   221|             $event->rules['formie/settings/elements'] = 'formie/integration-settings/element-index';
   222|             $event->rules['formie/settings/elements/new'] = 'formie/integration-settings/edit-element';
   223|             $event->rules['formie/settings/elements/edit/<integrationId:\d+>'] = 'formie/integration-settings/edit-element';
   224|             $event->rules['formie/settings/email-marketing'] = 'formie/integration-settings/email-marketing-index';
   225|             $event->rules['formie/settings/email-marketing/new'] = 'formie/integration-settings/edit-email-marketing';
   226|             $event->rules['formie/settings/email-marketing/edit/<integrationId:\d+>'] = 'formie/integration-settings/edit-email-marketing';
   227|             $event->rules['formie/settings/crm'] = 'formie/integration-settings/crm-index';
   228|             $event->rules['formie/settings/crm/new'] = 'formie/integration-settings/edit-crm';
   229|             $event->rules['formie/settings/crm/edit/<integrationId:\d+>'] = 'formie/integration-settings/edit-crm';
   230|             $event->rules['formie/settings/payments'] = 'formie/integration-settings/payment-index';
   231|             $event->rules['formie/settings/payments/new'] = 'formie/integration-settings/edit-payment';
   232|             $event->rules['formie/settings/payments/edit/<integrationId:\d+>'] = 'formie/integration-settings/edit-payment';
   233|             $event->rules['formie/settings/webhooks'] = 'formie/integration-settings/webhook-index';
   234|             $event->rules['formie/settings/webhooks/new'] = 'formie/integration-settings/edit-webhook';
   235|             $event->rules['formie/settings/webhooks/edit/<integrationId:\d+>'] = 'formie/integration-settings/edit-webhook';
   236|             $event->rules['formie/settings/miscellaneous'] = 'formie/integration-settings/miscellaneous-index';
   237|             $event->rules['formie/settings/miscellaneous/new'] = 'formie/integration-settings/edit-miscellaneous';
   238|             $event->rules['formie/settings/miscellaneous/edit/<integrationId:\d+>'] = 'formie/integration-settings/edit-miscellaneous';
   239|             $event->rules['formie/settings/support'] = 'formie/support/index';
   240|             $event->rules['formie/settings/import-export'] = 'formie/import-export/index';
   241|             $event->rules['formie/settings/import-export/import-configure/<filename:.*>'] = 'formie/import-export/import-configure';
   242|             $event->rules['formie/settings/import-export/import-completed/<formId:\d+>'] = 'formie/import-export/import-completed';
   243|         });
   244|     }
   245|     private function _registerPermissions(): void
   246|     {
   247|         Event::on(UserPermissions::class, UserPermissions::EVENT_REGISTER_PERMISSIONS, function(RegisterUserPermissionsEvent $event) {
   248|             $formPermissions = [
   249|                 'formie-createForms' => [
   250|                     'label' => Craft::t('formie', 'Create forms'),
   251|                     'nested' => [
   252|                         'formie-createFormAppearance' => ['label' => Craft::t('formie', 'Show form appearance tab')],
   253|                         'formie-createFormBehavior' => ['label' => Craft::t('formie', 'Show form behaviour tab')],
   254|                         'formie-createNotifications' => ['label' => Craft::t('formie', 'Show form email notifications tab')],
   255|                         'formie-createFormIntegrations' => ['label' => Craft::t('formie', 'Show form integrations tab')],
   256|                         'formie-createFormUsage' => ['label' => Craft::t('formie', 'Show form usage tab')],
   257|                         'formie-createFormSettings' => ['label' => Craft::t('formie', 'Show form settings tab')],
   258|                     ],
   259|                 ],
   260|                 'formie-deleteForms' => ['label' => Craft::t('formie', 'Delete forms')],
   261|                 'formie-manageForms' => [
   262|                     'label' => Craft::t('formie', 'Manage all forms'),
   263|                     'nested' => [
   264|                         'formie-showFormAppearance' => ['label' => Craft::t('formie', 'Show form appearance tab')],
   265|                         'formie-showFormBehavior' => ['label' => Craft::t('formie', 'Show form behaviour tab')],
   266|                         'formie-showNotifications' => [
   267|                             'label' => Craft::t('formie', 'Show form email notifications tab'), 'nested' => [
   268|                                 'formie-showNotificationsAdvanced' => ['label' => Craft::t('formie', 'Show email notification advanced tab')],
   269|                                 'formie-showNotificationsTemplates' => ['label' => Craft::t('formie', 'Show email notification templates tab')],
   270|                             ],
   271|                         ],
   272|                         'formie-showFormIntegrations' => ['label' => Craft::t('formie', 'Show form integrations tab')],
   273|                         'formie-showFormUsage' => ['label' => Craft::t('formie', 'Show form usage tab')],
   274|                         'formie-showFormSettings' => ['label' => Craft::t('formie', 'Show form settings tab')],
   275|                     ],
   276|                 ],
   277|             ];
   278|             $submissionPermissions = [
   279|                 'formie-viewSubmissions' => [
   280|                     'label' => Craft::t('formie', 'View all submissions'),
   281|                     'nested' => [
   282|                         'formie-createSubmissions' => ['label' => Craft::t('formie', 'Create submissions')],
   283|                         'formie-saveSubmissions' => ['label' => Craft::t('formie', 'Save submissions')],
   284|                         'formie-deleteSubmissions' => ['label' => Craft::t('formie', 'Delete submissions')],
   285|                     ],
   286|                 ],
   287|             ];
   288|             $sentNotificationsPermissions = [
   289|                 'formie-viewSentNotifications' => [
   290|                     'label' => Craft::t('formie', 'View all sent notifications'),
   291|                     'nested' => [
   292|                         'formie-resendSentNotifications' => ['label' => Craft::t('formie', 'Resend sent notifications')],
   293|                         'formie-deleteSentNotifications' => ['label' => Craft::t('formie', 'Delete sent notifications')],
   294|                     ],
   295|                 ],
   296|             ];
   297|             if (Craft::$app->edition === CmsEdition::Pro) {
   298|                 foreach (Form::find()->all() as $form) {
   299|                     $suffix = ':' . $form->uid;
   300|                     $formPermissions["formie-manageForms{$suffix}"] = [
   301|                         'label' => Craft::t('formie', 'Manage “{name}” form', ['name' => $form->title]),
   302|                         'nested' => [
   303|                             "formie-showFormAppearance{$suffix}" => ['label' => Craft::t('formie', 'Show form appearance tab')],
   304|                             "formie-showFormBehavior{$suffix}" => ['label' => Craft::t('formie', 'Show form behaviour tab')],
   305|                             "formie-showNotifications{$suffix}" => [
   306|                                 'label' => Craft::t('formie', 'Show form email notifications tab'), 'nested' => [
   307|                                     "formie-showNotificationsAdvanced{$suffix}" => ['label' => Craft::t('formie', 'Show email notification advanced tab')],
   308|                                     "formie-showNotificationsTemplates{$suffix}" => ['label' => Craft::t('formie', 'Show email notification templates tab')],
   309|                                 ],
   310|                             ],
   311|                             "formie-showFormIntegrations{$suffix}" => ['label' => Craft::t('formie', 'Show form integrations tab')],
   312|                             "formie-showFormUsage{$suffix}" => ['label' => Craft::t('formie', 'Show form usage tab')],
   313|                             "formie-showFormSettings{$suffix}" => ['label' => Craft::t('formie', 'Show form settings tab')],
   314|                         ],
   315|                     ];
   316|                     $submissionPermissions["formie-viewSubmissions{$suffix}"] = [
   317|                         'label' => Craft::t('formie', 'View “{name}” submissions', ['name' => $form->title]),
   318|                         'nested' => [
   319|                             "formie-createSubmissions{$suffix}" => ['label' => Craft::t('formie', 'Create submissions')],
   320|                             "formie-saveSubmissions{$suffix}" => ['label' => Craft::t('formie', 'Save submissions')],
   321|                             "formie-deleteSubmissions{$suffix}" => ['label' => Craft::t('formie', 'Delete submissions')],
   322|                         ],
   323|                     ];
   324|                     $sentNotificationsPermissions["formie-viewSentNotifications{$suffix}"] = [
   325|                         'label' => Craft::t('formie', 'View “{name}” sent notifications', ['name' => $form->title]),
   326|                         'nested' => [
   327|                             "formie-resendSentNotifications{$suffix}" => ['label' => Craft::t('formie', 'Resend sent notifications')],
   328|                             "formie-deleteSentNotifications{$suffix}" => ['label' => Craft::t('formie', 'Delete sent notifications')],
   329|                         ],
   330|                     ];
   331|                 }
   332|             }
   333|             $event->permissions[] = [
   334|                 'heading' => Craft::t('formie', 'Formie'),
   335|                 'permissions' => [
   336|                     'formie-accessForms' => ['label' => Craft::t('formie', 'Access forms'), 'nested' => $formPermissions],
   337|                     'formie-accessSubmissions' => ['label' => Craft::t('formie', 'Access submissions'), 'nested' => $submissionPermissions],
   338|                     'formie-accessSentNotifications' => ['label' => Craft::t('formie', 'Access sent notifications'), 'nested' => $sentNotificationsPermissions],
   339|                 ],
   340|             ];
   341|         });
   342|     }
   343|     private function _registerVariable(): void
   344|     {
   345|         Event::on(CraftVariable::class, CraftVariable::EVENT_INIT, function(Event $event) {
   346|             $event->sender->set('formie', FormieVariable::class);
   347|         });
   348|     }
   349|     private function _registerElementTypes(): void
   350|     {
   351|         Event::on(Elements::class, Elements::EVENT_REGISTER_ELEMENT_TYPES, function(RegisterComponentTypesEvent $event) {
   352|             $event->types[] = Form::class;
   353|             $event->types[] = SentNotification::class;
   354|             $event->types[] = Submission::class;
   355|         });
   356|     }
   357|     private function _registerFieldTypes(): void
   358|     {
   359|         Event::on(Fields::class, Fields::EVENT_REGISTER_FIELD_TYPES, function(RegisterComponentTypesEvent $event) {
   360|             $event->types[] = Forms::class;
   361|             $event->types[] = Submissions::class;
   362|         });
   363|     }
   364|     private function _registerGarbageCollection(): void
   365|     {
   366|         Event::on(Gc::class, Gc::EVENT_RUN, function() {
   367|             $this->getSubmissions()->pruneIncompleteSubmissions();
   368|             $this->getSubmissions()->pruneDataRetentionSubmissions();
   369|             $this->getSentNotifications()->pruneSentNotifications();
   370|         });
   371|     }
   372|     private function _registerGraphQl(): void
   373|     {
   374|         Event::on(Gql::class, Gql::EVENT_REGISTER_GQL_TYPES, function(RegisterGqlTypesEvent $event) {
   375|             $event->types[] = FormInterface::class;
   376|             $event->types[] = PageInterface::class;
   377|             $event->types[] = PageSettingsInterface::class;
   378|             $event->types[] = RowInterface::class;
   379|             $event->types[] = FieldInterface::class;
   380|             $event->types[] = SubmissionInterface::class;
   381|         });
   382|         Event::on(Gql::class, Gql::EVENT_REGISTER_GQL_QUERIES, function(RegisterGqlQueriesEvent $event) {
   383|             $queries = [
   384|                 FormQuery::getQueries(),
   385|                 SubmissionQuery::getQueries(),
   386|             ];
   387|             foreach ($queries as $k => $v) {
   388|                 foreach ($v as $key => $value) {
   389|                     $event->queries[$key] = $value;
   390|                 }
   391|             }
   392|         });
   393|         Event::on(Gql::class, Gql::EVENT_REGISTER_GQL_MUTATIONS, function(RegisterGqlMutationsEvent $event) {
   394|             $mutations = [
   395|                 SubmissionMutation::getMutations(),
   396|             ];
   397|             foreach ($mutations as $k => $v) {
   398|                 foreach ($v as $key => $value) {
   399|                     $event->mutations[$key] = $value;
   400|                 }
   401|             }
   402|         });
   403|         Event::on(Gql::class, Gql::EVENT_REGISTER_GQL_SCHEMA_COMPONENTS, function(RegisterGqlSchemaComponentsEvent $event) {
   404|             $label = Craft::t('formie', 'Formie');
   405|             $forms = Form::find()->all();
   406|             $event->queries[$label]['formieForms.all:read'] = ['label' => Craft::t('formie', 'View all forms')];
   407|             foreach ($forms as $form) {
   408|                 $suffix = 'formieForms.' . $form->uid;
   409|                 $event->queries[$label][$suffix . ':read'] = ['label' => Craft::t('formie', 'View “{form}” form', ['form' => Craft::t('formie', $form->title)])];
   410|             }
   411|             $event->queries[$label]['formieSubmissions.all:read'] = ['label' => Craft::t('formie', 'View all submissions')];
   412|             foreach ($forms as $form) {
   413|                 $suffix = 'formieSubmissions.' . $form->uid;
   414|                 $event->queries[$label][$suffix . ':read'] = ['label' => Craft::t('formie', 'View submissions for form “{form}”', ['form' => Craft::t('formie', $form->title)])];
   415|             }
   416|             $event->mutations[$label]['formieSubmissions.all:edit'] = [
   417|                 'label' => Craft::t('formie', 'Edit all submissions'),
   418|                 'nested' => [
   419|                     'formieSubmissions.all:create' => ['label' => Craft::t('app', 'Create all submissions')],
   420|                     'formieSubmissions.all:save' => ['label' => Craft::t('app', 'Modify all submissions')],
   421|                     'formieSubmissions.all:delete' => ['label' => Craft::t('app', 'Delete all submissions')],
   422|                 ],
   423|             ];
   424|             foreach ($forms as $form) {
   425|                 $suffix = 'formieSubmissions.' . $form->uid;
   426|                 $event->mutations[$label][$suffix . ':edit'] = [
   427|                     'label' => Craft::t('formie', 'Edit submissions for form “{form}”', ['form' => Craft::t('formie', $form->title)]),
   428|                     'nested' => [
   429|                         $suffix . ':create' => ['label' => Craft::t('app', 'Create submissions for form “{form}”', ['form' => Craft::t('formie', $form->title)])],
   430|                         $suffix . ':save' => ['label' => Craft::t('app', 'Modify submissions for form “{form}”', ['form' => Craft::t('formie', $form->title)])],
   431|                         $suffix . ':delete' => ['label' => Craft::t('app', 'Delete submissions for form “{form}”', ['form' => Craft::t('formie', $form->title)])],
   432|                     ],
   433|                 ];
   434|             }
   435|         });
   436|     }
   437|     private function _registerEventHandlers(): void
   438|     {
   439|         Event::on(UsersController::class, UsersController::EVENT_DEFINE_CONTENT_SUMMARY, [$this->getSubmissions(), 'defineUserSubmissions']);
   440|         Event::on(UserElement::class, UserElement::EVENT_AFTER_DELETE, [$this->getSubmissions(), 'deleteUserSubmissions']);
   441|         Event::on(UserElement::class, UserElement::EVENT_AFTER_RESTORE, [$this->getSubmissions(), 'restoreUserSubmissions']);
   442|         Event::on(ElementSources::class, ElementSources::EVENT_DEFINE_SOURCE_TABLE_ATTRIBUTES, [$this->getSubmissions(), 'defineSourceTableAttributes']);
   443|         Event::on(ElementSources::class, ElementSources::EVENT_DEFINE_SOURCE_SORT_OPTIONS, [$this->getSubmissions(), 'defineSourceSortOptions']);
   444|         Event::on(Cp::class, Cp::EVENT_DEFINE_ELEMENT_CHIP_HTML, [Submission::class, 'defineElementChipHtml']);
   445|         Event::on(Queue::class, Queue::EVENT_AFTER_ERROR, function(ExecEvent $event) {
   446|             if ($event->error && $event->job instanceof BaseJob) {
   447|                 $event->job->onError($event);
   448|             }
   449|         });
   450|         Event::on(Plugins::class, Plugins::EVENT_BEFORE_SAVE_PLUGIN_SETTINGS, function(PluginEvent $event) {
   451|             if ($event->plugin === $this) {
   452|                 $this->getService()->onBeforeSavePluginSettings($event);
   453|             }
   454|         });
   455|         if (class_exists(SourceNodes::class)) {
   456|             Event::on(SourceNodes::class, SourceNodes::EVENT_REGISTER_SOURCE_NODE_TYPES, function(RegisterSourceNodeTypesEvent $event) {
   457|                 if (GqlHelper::canQueryForms()) {
   458|                     $event->types[FormInterface::getName()] = [
   459|                         'node' => 'formieForm',
   460|                         'list' => 'formieForms',
   461|                         'filterArgument' => '',
   462|                         'filterTypeExpression' => '(.+)_Form',
   463|                         'targetInterface' => FormInterface::getName(),
   464|                     ];
   465|                 }
   466|                 if (GqlHelper::canQuerySubmissions()) {
   467|                     $event->types[SubmissionInterface::getName()] = [
   468|                         'node' => 'formieSubmission',
   469|                         'list' => 'formieSubmissions',
   470|                         'filterArgument' => '',
   471|                         'filterTypeExpression' => '(.+)_Submission',
   472|                         'targetInterface' => SubmissionInterface::getName(),
   473|                     ];
   474|                 }
   475|             });
   476|         }
   477|         if (class_exists(FeedMeElements::class)) {
   478|             Event::on(FeedMeElements::class, FeedMeElements::EVENT_REGISTER_FEED_ME_ELEMENTS, function(RegisterFeedMeElementsEvent $event) {
   479|                 $event->elements[] = FeedMeSubmission::class;
   480|             });
   481|         }
   482|         if (class_exists(FeedMeFields::class)) {
   483|             Event::on(FeedMeFields::class, FeedMeFields::EVENT_REGISTER_FEED_ME_FIELDS, function(RegisterFeedMeFieldsEvent $event) {
   484|                 $fields = Formie::$plugin->getFields()->getRegisteredFormieFields();
   485|                 $event->fields = array_merge($event->fields, $fields);
   486|             });
   487|         }
   488|         if (version_compare(Craft::$app->getInfo()->version, '5.3.0', '>=')) {
   489|             Event::on(Link::class, Link::EVENT_REGISTER_LINK_TYPES, function(RegisterComponentTypesEvent $event) {
   490|                 $event->types[] = FormLinkType::class;
   491|             });
   492|         }
   493|     }
   494|     private function _registerProjectConfigEventHandlers(): void
   495|     {
   496|         $projectConfigService = Craft::$app->getProjectConfig();
   497|         if (!Craft::$app->getPlugins()->isPluginInstalled(Formie::getInstance()->id)) {
   498|             return;
   499|         }
   500|         $statusesService = $this->getStatuses();
   501|         $projectConfigService
   502|             ->onAdd(StatusesService::CONFIG_STATUSES_KEY . '.{uid}', [$statusesService, 'handleChangedStatus'])
   503|             ->onUpdate(StatusesService::CONFIG_STATUSES_KEY . '.{uid}', [$statusesService, 'handleChangedStatus'])
   504|             ->onRemove(StatusesService::CONFIG_STATUSES_KEY . '.{uid}', [$statusesService, 'handleDeletedStatus']);
   505|         $stencilsService = $this->getStencils();
   506|         $projectConfigService
   507|             ->onAdd(StencilsService::CONFIG_STENCILS_KEY . '.{uid}', [$stencilsService, 'handleChangedStencil'])
   508|             ->onUpdate(StencilsService::CONFIG_STENCILS_KEY . '.{uid}', [$stencilsService, 'handleChangedStencil'])
   509|             ->onRemove(StencilsService::CONFIG_STENCILS_KEY . '.{uid}', [$stencilsService, 'handleDeletedStencil']);
   510|         $formTemplatesService = $this->getFormTemplates();
   511|         $projectConfigService
   512|             ->onAdd(FormTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$formTemplatesService, 'handleChangedTemplate'])
   513|             ->onUpdate(FormTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$formTemplatesService, 'handleChangedTemplate'])
   514|             ->onRemove(FormTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$formTemplatesService, 'handleDeletedTemplate']);
   515|         $emailTemplatesService = $this->getEmailTemplates();
   516|         $projectConfigService
   517|             ->onAdd(EmailTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$emailTemplatesService, 'handleChangedTemplate'])
   518|             ->onUpdate(EmailTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$emailTemplatesService, 'handleChangedTemplate'])
   519|             ->onRemove(EmailTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$emailTemplatesService, 'handleDeletedTemplate']);
   520|         $pdfTemplatesService = $this->getPdfTemplates();
   521|         $projectConfigService
   522|             ->onAdd(PdfTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$pdfTemplatesService, 'handleChangedTemplate'])
   523|             ->onUpdate(PdfTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$pdfTemplatesService, 'handleChangedTemplate'])
   524|             ->onRemove(PdfTemplatesService::CONFIG_TEMPLATES_KEY . '.{uid}', [$pdfTemplatesService, 'handleDeletedTemplate']);
   525|         $integrationsService = $this->getIntegrations();
   526|         $projectConfigService
   527|             ->onAdd(IntegrationsService::CONFIG_INTEGRATIONS_KEY . '.{uid}', [$integrationsService, 'handleChangedIntegration'])
   528|             ->onUpdate(IntegrationsService::CONFIG_INTEGRATIONS_KEY . '.{uid}', [$integrationsService, 'handleChangedIntegration'])
   529|             ->onRemove(IntegrationsService::CONFIG_INTEGRATIONS_KEY . '.{uid}', [$integrationsService, 'handleDeletedIntegration']);
   530|         Event::on(ProjectConfig::class, ProjectConfig::EVENT_REBUILD, function(RebuildConfigEvent $event) {
   531|             $event->config['formie'] = ProjectConfigHelper::rebuildProjectConfig();
   532|         });
   533|     }
   534|     private function _registerEmailMessages(): void
   535|     {
   536|         Event::on(SystemMessages::class, SystemMessages::EVENT_REGISTER_MESSAGES, function(RegisterEmailMessagesEvent $event) {
   537|             $event->messages[] = [
   538|                 'key' => 'formie_failed_notification',
   539|                 'heading' => Craft::t('formie', 'formie_failed_notification_heading'),
   540|                 'subject' => Craft::t('formie', 'formie_failed_notification_subject'),
   541|                 'body' => Craft::t('formie', 'formie_failed_notification_body'),
   542|             ];
   543|         });
   544|     }
   545|     private function _registerElementExports(): void
   546|     {
   547|         Event::on(Form::class, Form::EVENT_REGISTER_EXPORTERS, function(RegisterElementExportersEvent $event) {
   548|             foreach ($event->exporters as $key => $exporter) {
   549|                 if ($exporter === Raw::class) {
   550|                     unset($event->exporters[$key]);
   551|                 }
   552|                 if ($exporter === Expanded::class) {
   553|                     unset($event->exporters[$key]);
   554|                 }
   555|             }
   556|             $event->exporters = array_values($event->exporters);
   557|             $event->exporters[] = FormExport::class;
   558|         });
   559|         Event::on(Submission::class, Submission::EVENT_REGISTER_EXPORTERS, function(RegisterElementExportersEvent $event) {
   560|             foreach ($event->exporters as $key => $exporter) {
   561|                 if ($exporter === Raw::class) {
   562|                     unset($event->exporters[$key]);
   563|                 }
   564|                 if ($exporter === Expanded::class) {
   565|                     unset($event->exporters[$key]);
   566|                 }
   567|             }
   568|             $event->exporters = array_values($event->exporters);
   569|             $event->exporters[] = SubmissionExport::class;
   570|         });
   571|     }
   572|     private function _registerTemplateRoots(): void
   573|     {
   574|         Event::on(View::class, View::EVENT_REGISTER_SITE_TEMPLATE_ROOTS, function(RegisterTemplateRootsEvent $event) {
   575|             $event->roots[$this->id] = $this->getBasePath() . DIRECTORY_SEPARATOR . 'templates/_special';
   576|         });
   577|     }
   578|     private function _registerWidgets(): void
   579|     {
   580|         Event::on(Dashboard::class, Dashboard::EVENT_REGISTER_WIDGET_TYPES, function(RegisterComponentTypesEvent $event) {
   581|             $event->types[] = RecentSubmissions::class;
   582|         });
   583|     }
   584|     private function _registerResaveCommand(): void
   585|     {
   586|         if (!Craft::$app instanceof ConsoleApplication) {
   587|             return;
   588|         }
   589|         Event::on(ResaveController::class, ConsoleController::EVENT_DEFINE_ACTIONS, function(DefineConsoleActionsEvent $event) {
   590|             $event->actions['formie-forms'] = [
   591|                 'action' => function(): int {
   592|                     $controller = Craft::$app->controller;
   593|                     return $controller->resaveElements(Form::class);
   594|                 },
   595|                 'options' => [],
   596|                 'helpSummary' => 'Re-saves Formie forms.',
   597|             ];
   598|             $event->actions['formie-submissions'] = [
   599|                 'action' => function(): int {
   600|                     $controller = Craft::$app->controller;
   601|                     if ($controller->formId !== null) {
   602|                         $formIds = explode(',', $controller->formId);
   603|                     } else {
   604|                         $formIds = Form::find()->ids();
   605|                     }
   606|                     foreach ($formIds as $formId) {
   607|                         $criteria = ['formId' => $formId];
   608|                         $controller->resaveElements(Submission::class, $criteria);
   609|                     }
   610|                     return true;
   611|                 },
   612|                 'options' => ['formId'],
   613|                 'helpSummary' => 'Re-saves Forms submissions.',
   614|                 'optionsHelp' => [
   615|                     'formId' => 'The form ID of the submissions to resave.',
   616|                 ],
   617|             ];
   618|         });
   619|     }
   620|     private function _registerTemplateHooks(): void
   621|     {
   622|         Craft::$app->getView()->hook('formie.buttons.before', static function(array $context) {
   623|             return Formie::$plugin->getForms()->handleBeforeSubmitHook($context);
   624|         });
   625|     }
   626| }


# ====================================================================
# FILE: src/base/ElementField.php
# Total hunks: 8
# ====================================================================
# --- HUNK 1: Lines 1-233 ---
     1| <?php
     2| namespace verbb\formie\base;
     3| use verbb\formie\base\Element as ElementIntegration;
     4| use verbb\formie\base\Integration;
     5| use verbb\formie\base\IntegrationInterface;
     6| use verbb\formie\elements\Form;
     7| use verbb\formie\elements\Submission;
     8| use verbb\formie\events\ModifyElementFieldQueryEvent;
     9| use verbb\formie\fields\conditions\ElementFieldConditionRule;
    10| use verbb\formie\fields\data\MultiOptionsFieldData;
    11| use verbb\formie\fields\data\OptionData;
    12| use verbb\formie\fields\data\SingleOptionFieldData;
    13| use verbb\formie\fields\Dropdown;
    14| use verbb\formie\fields\Checkboxes;
    15| use verbb\formie\fields\Radio;
    16| use verbb\formie\fields\SingleLineText;
    17| use verbb\formie\fields\Tags;
    18| use verbb\formie\helpers\ArrayHelper;
    19| use verbb\formie\models\HtmlTag;
    20| use verbb\formie\models\IntegrationField;
    21| use verbb\formie\models\Notification;
    22| use Craft;
    23| use craft\base\EagerLoadingFieldInterface;
    24| use craft\base\Element;
    25| use craft\base\ElementInterface;
    26| use craft\base\InlineEditableFieldInterface;
    27| use craft\base\NestedElementInterface;
    28| use craft\behaviors\EventBehavior;
    29| use craft\db\Query;
    30| use craft\elements\db\ElementQuery;
    31| use craft\elements\db\ElementQueryInterface;
    32| use craft\elements\ElementCollection;
    33| use craft\elements\conditions\ElementCondition;
    34| use craft\elements\conditions\ElementConditionInterface;
    35| use craft\elements\db\ElementRelationParamParser;
    36| use craft\elements\db\OrderByPlaceholderExpression;
    37| use craft\errors\SiteNotFoundException;
    38| use craft\events\CancelableEvent;
    39| use craft\events\ElementCriteriaEvent;
    40| use craft\fields as CraftFields;
    41| use craft\helpers\Cp;
    42| use craft\helpers\Db;
    43| use craft\helpers\ElementHelper;
    44| use craft\helpers\Json;
    45| use craft\helpers\Queue;
    46| use craft\helpers\StringHelper;
    47| use craft\helpers\Template as TemplateHelper;
    48| use craft\records\EntryType as EntryTypeRecord;
    49| use craft\services\ElementSources;
    50| use craft\services\Elements;
    51| use DateTime;
    52| use ReflectionClass;
    53| use ReflectionProperty;
    54| use Throwable;
    55| use Faker\Generator as FakerFactory;
    56| use Twig\Markup;
    57| use Illuminate\Support\Collection;
    58| use GraphQL\Type\Definition\Type;
    59| use yii\base\Event;
    60| use yii\base\InvalidConfigException;
    61| use yii\db\Expression;
    62| use yii\db\ExpressionInterface;
    63| use yii\validators\NumberValidator;
    64| abstract class ElementField extends Field implements ElementFieldInterface
    65| {
    66|     abstract public static function elementType(): string;
    67|     public static function queryCondition(array $instances, mixed $value, array &$params): array|string|ExpressionInterface|false|null
    68|     {
    69|         $values = [];
    70|         if (is_array($value)) {
    71|             foreach ($value as $element) {
    72|                 if ($element instanceof ElementInterface) {
    73|                     $values[] = $element->id;
    74|                 }
    75|                 if (is_int($element)) {
    76|                     $values[] = $element;
    77|                 }
    78|             }
    79|         }
    80|         if ($value instanceof ElementInterface) {
    81|             $values[] = $value->id;
    82|         }
    83|         if (is_int($value)) {
    84|             $values[] = $value;
    85|         }
    86|         return parent::queryCondition($instances, Json::encode($values), $params);
    87|     }
    88|     public const EVENT_MODIFY_ELEMENT_QUERY = 'modifyElementQuery';
    89|     public const EVENT_DEFINE_SELECTION_CRITERIA = 'defineSelectionCriteria';
    90|     public string|array|null $sources = '*';
    91|     public ?string $source = null;
    92|     public bool $allowMultipleSources = true;
    93|     public bool $limit = false;
    94|     public ?string $limitOptions = null;
    95|     public string $displayType = 'dropdown';
    96|     public string $labelSource = 'title';
    97|     public string $orderBy = 'title ASC';
    98|     public bool $multi = false;
    99|     protected ?ElementQuery $elementsQuery = null;
   100|     protected ?string $cpInputJsClass = null;
   101|     protected string $cpInputTemplate = '_includes/forms/elementSelect';
   102|     private array|null|ElementConditionInterface $_selectionCondition = null;
   103|     public function __construct($config = [])
   104|     {
   105|         if (array_key_exists('multiple', $config)) {
   106|             $config['multi'] = ArrayHelper::remove($config, 'multiple');
   107|         }
   108|         parent::__construct($config);
   109|     }
   110|     public function settingsAttributes(): array
   111|     {
   112|         $attributes = parent::settingsAttributes();
   113|         $attributes[] = 'sources';
   114|         $attributes[] = 'source';
   115|         $attributes[] = 'limitOptions';
   116|         $attributes[] = 'displayType';
   117|         $attributes[] = 'labelSource';
   118|         $attributes[] = 'orderBy';
   119|         $attributes[] = 'multi';
   120|         return $attributes;
   121|     }
   122|     public function getFormBuilderConfig(): array
   123|     {
   124|         $config = parent::getFormBuilderConfig();
   125|         $config['isElementField'] = true;
   126|         return $config;
   127|     }
   128|     public function isValueEmpty(mixed $value, ?ElementInterface $element): bool
   129|     {
   130|         if ($value instanceof ElementQueryInterface) {
   131|             return !$value->exists();
   132|         }
   133|         return $value->isEmpty();
   134|     }
   135|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
   136|     {
   137|         if ($value instanceof ElementQueryInterface) {
   138|             return $value;
   139|         }
   140|         $query = static::elementType()::find();
   141|         if (Craft::$app->getIsMultiSite()) {
   142|             $query->siteId($this->targetSiteId($element));
   143|         }
   144|         if (is_array($value)) {
   145|             if (isset($value[0]) && is_array($value[0]) && array_key_exists('id', $value[0])) {
   146|                 $value = ArrayHelper::getColumn($value, 'id');
   147|             }
   148|             $ids = array_values(array_filter($value, function($id) {
   149|                 return !empty($id);
   150|             }));
   151|             $query->id($ids)->fixedOrder();
   152|         } else {
   153|             $query->id(false);
   154|         }
   155|         $query->status(null);
   156|         return $query;
   157|     }
   158|     public function serializeValue(mixed $value, ?ElementInterface $element): mixed
   159|     {
   160|         $value->status(null);
   161|         return $value->ids();
   162|     }
   163|     public function getElementConditionRuleType(): array|string|null
   164|     {
   165|         return ElementFieldConditionRule::class;
   166|     }
   167|     public function getElementsQuery(): ElementQueryInterface
   168|     {
   169|         $query = static::elementType()::find();
   170|         $conditionsService = Craft::$app->getConditions();
   171|         if (Craft::$app->getIsMultiSite()) {
   172|             $query->siteId(Craft::$app->getSites()->getCurrentSite()->id);
   173|         }
   174|         $criteria = [];
   175|         $sources = $this->getInputSources();
   176|         if (is_array($sources)) {
   177|             foreach ($sources as $sourceKey) {
   178|                 $elementSource = ArrayHelper::firstWhere($this->availableSources(), 'key', $sourceKey);
   179|                 if ($elementSource && $elementSource['type'] === ElementSources::TYPE_CUSTOM) {
   180|                     $sourceCondition = $conditionsService->createCondition($elementSource['condition']);
   181|                     $sourceCondition->modifyQuery($query);
   182|                 } else if (str_contains($sourceKey, 'type:')) {
   183|                     $entryTypeUid = str_replace('type:', '', $sourceKey);
   184|                     $entryType = EntryTypeRecord::find()->where(['uid' => $entryTypeUid])->one();
   185|                     if ($entryType) {
   186|                         $criteria[] = ['typeId' => $entryType->id];
   187|                     }
   188|                 } else {
   189|                     $sourceCriteria = $elementSource['criteria'] ?? [];
   190|                     unset($sourceCriteria['editable']);
   191|                     $criteria[] = $sourceCriteria;
   192|                 }
   193|             }
   194|         }
   195|         $criteria = array_merge_recursive(...$criteria);
   196|         Craft::configure($query, $criteria);
   197|         if ($this->defaultValue && $this->limitOptions) {
   198|             $ids = [];
   199|             if ($this->defaultValue instanceof ElementQueryInterface) {
   200|                 $ids = $this->defaultValue->id;
   201|             } else {
   202|                 $ids = ArrayHelper::getColumn($this->defaultValue, 'id');
   203|             }
   204|             if ($ids) {
   205|                 $query->id($ids);
   206|             }
   207|         }
   208|         if ($this->limitOptions) {
   209|             $query->limit($this->limitOptions);
   210|         }
   211|         if ($this->orderBy) {
   212|             $query->orderBy($this->orderBy);
   213|         }
   214|         if ($this->elementsQuery) {
   215|             $query = $this->elementsQuery;
   216|         }
   217|         $event = new ModifyElementFieldQueryEvent([
   218|             'query' => $query,
   219|             'field' => $this,
   220|         ]);
   221|         $this->trigger(self::EVENT_MODIFY_ELEMENT_QUERY, $event);
   222|         return $event->query;
   223|     }
   224|     public function getDefaultValueQuery()
   225|     {
   226|         $defaultValue = $this->defaultValue ?? '';
   227|         if ($defaultValue instanceof ElementQuery) {
   228|             $defaultValue = $defaultValue->all();
   229|         }
   230|         if (!is_array($defaultValue)) {
   231|             $defaultValue = $defaultValue ? [['id' => $defaultValue]] : [];
   232|         }
   233|         $defaultValue = array_filter($defaultValue);

# --- HUNK 2: Lines 268-308 ---
   268|         }
   269|         if ($this->displayType === 'checkboxes' || $this->displayType === 'radio' || $this->getIsMultiDropdown()) {
   270|             $settings['elements'] = $this->getPreviewElements();
   271|         }
   272|         return $settings;
   273|     }
   274|     public function getFrontEndInputOptions(Form $form, mixed $value, array $renderOptions = []): array
   275|     {
   276|         $inputOptions = parent::getFrontendInputOptions($form, $value, $renderOptions);
   277|         $inputOptions['elementsQuery'] = $this->getElementsQuery();
   278|         return $inputOptions;
   279|     }
   280|     public function populateValue(mixed $value, ?Submission $submission): void
   281|     {
   282|         if ($value) {
   283|             if ($value instanceof ElementQuery) {
   284|                 $query = $value;
   285|             } else {
   286|                 $query = static::elementType()::find()->id($value);
   287|             }
   288|             $query->status(null);
   289|             $this->defaultValue = $query;
   290|         }
   291|     }
   292|     public function getFieldOptions(): array
   293|     {
   294|         $options = [];
   295|         foreach ($this->getElementsQuery()->all() as $element) {
   296|             $options[] = ['label' => $this->getElementLabel($element), 'value' => (string)$element->id];
   297|         }
   298|         return $options;
   299|     }
   300|     public function getDisplayTypeFieldConfig(): array
   301|     {
   302|         $config = [
   303|             'options' => $this->getFieldOptions(),
   304|             'hasMultiNamespace' => true,
   305|             'multi' => $this->multi,
   306|         ];
   307|         if ($this->getParentField()) {
   308|             $config['parentField'] = $this->getParentField();

# --- HUNK 3: Lines 389-456 ---
   389|     public function getSourceOptions(): array
   390|     {
   391|         $options = array_map(fn($s) => [
   392|             'label' => $s['label'],
   393|             'value' => $s['key'],
   394|             'data' => [
   395|                 'structure-id' => $s['structureId'] ?? null,
   396|             ],
   397|         ], $this->availableSources());
   398|         ArrayHelper::multisort($options, 'label', SORT_ASC, SORT_NATURAL | SORT_FLAG_CASE);
   399|         return $options;
   400|     }
   401|     public function getInputSources(?ElementInterface $element = null): array|string|null
   402|     {
   403|         if ($this->allowMultipleSources) {
   404|             $sources = $this->sources;
   405|         } else {
   406|             $sources = [$this->source];
   407|         }
   408|         return $sources;
   409|     }
   410|     public function getInputSelectionCriteria(): array
   411|     {
   412|         if ($this->hasEventHandlers(self::EVENT_DEFINE_SELECTION_CRITERIA)) {
   413|             $event = new ElementCriteriaEvent();
   414|             $this->trigger(self::EVENT_DEFINE_SELECTION_CRITERIA, $event);
   415|             return $event->criteria;
   416|         }
   417|         return [];
   418|     }
   419|     public function getSelectionCondition(): ?ElementConditionInterface
   420|     {
   421|         if ($this->_selectionCondition !== null && !$this->_selectionCondition instanceof ConditionInterface) {
   422|             $condition = Craft::$app->getConditions()->createCondition($this->_selectionCondition);
   423|             if (!empty($condition->getConditionRules())) {
   424|                 $this->_selectionCondition = $condition;
   425|             } else {
   426|                 $this->_selectionCondition = null;
   427|             }
   428|         }
   429|         return $this->_selectionCondition;
   430|     }
   431|     public function setSelectionCondition(mixed $condition): void
   432|     {
   433|         if ($condition instanceof ConditionInterface && !$condition->getConditionRules()) {
   434|             $condition = null;
   435|         }
   436|         $this->_selectionCondition = $condition;
   437|     }
   438|     public function getSettingGqlTypes(): array
   439|     {
   440|         return array_merge(parent::getSettingGqlTypes(), [
   441|             'sources' => [
   442|                 'name' => 'sources',
   443|                 'type' => Type::string(),
   444|                 'resolve' => function($field) {
   445|                     $value = $field->sources;
   446|                     return is_array($value) ? Json::encode($value) : $value;
   447|                 },
   448|             ],
   449|             'source' => [
   450|                 'name' => 'source',
   451|                 'type' => Type::string(),
   452|             ],
   453|             'limitOptions' => [
   454|                 'name' => 'limitOptions',
   455|                 'type' => Type::string(),
   456|             ],

# --- HUNK 4: Lines 522-585 ---
   522|             'elementType' => static::elementType(),
   523|             'storageKey' => 'field.' . $this->id,
   524|             'condition' => [],
   525|             'criteria' => [],
   526|             'fieldId' => $this->id,
   527|             'selectionLabel' => Craft::t('formie', 'Choose'),
   528|             'name' => $this->handle,
   529|             'elements' => $value,
   530|             'sources' => $this->getInputSources($element),
   531|             'sourceElementId' => !empty($element->id) ? $element->id : null,
   532|             'showSiteMenu' => 'auto',
   533|             'viewMode' => 'list',
   534|             'limit' => $this->limitOptions ? $this->limitOptions : null,
   535|             'modalSettings' => [
   536|                 'defaultSiteId' => $element->siteId ?? null,
   537|             ],
   538|         ];
   539|     }
   540|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
   541|     {
   542|         $value->status(null);
   543|         return Craft::$app->getView()->renderTemplate($this->cpInputTemplate, $this->cpInputTemplateVariables($value->all(), $element));
   544|     }
   545|     protected function availableSources(): array
   546|     {
   547|         $sources = ArrayHelper::where(
   548|             Craft::$app->getElementSources()->getSources(static::elementType(), 'modal'),
   549|             fn($s) => $s['type'] !== ElementSources::TYPE_HEADING
   550|         );
   551|         if ($this->allowMultipleSources) {
   552|             $hasAllSource = false;
   553|             foreach ($sources as $key => $source) {
   554|                 if (isset($source['key']) && $source['key'] === '*') {
   555|                     $hasAllSource = true;
   556|                 }
   557|             }
   558|             if (!$hasAllSource) {
   559|                 array_unshift($sources, [
   560|                     'key' => '*',
   561|                     'label' => Craft::t('formie', 'All'),
   562|                 ]);
   563|             }
   564|         }
   565|         return $sources;
   566|     }
   567|     protected function setPrePopulatedValue(mixed $value): array
   568|     {
   569|         $ids = [];
   570|         if (is_array($value)) {
   571|             $ids = array_values(array_filter($value));
   572|         } else {
   573|             $ids = [$value];
   574|         }
   575|         return $ids;
   576|     }
   577|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
   578|     {
   579|         return implode(', ', array_map(function($item) {
   580|             return $this->getElementLabel($item);
   581|         }, $value->all()));
   582|     }
   583|     protected function defineValueAsJson(mixed $value, ElementInterface $element = null): mixed
   584|     {
   585|         return array_map(function($item) {

# --- HUNK 5: Lines 593-678 ---
   593|             return $this->defineValueAsString($value, $element);
   594|         }
   595|         if ($integrationField->getType() === IntegrationField::TYPE_ARRAY) {
   596|             if ($integration instanceof ElementIntegration) {
   597|                 return $value->ids();
   598|             }
   599|             return array_map(function($item) {
   600|                 return $this->getElementLabel($item);
   601|             }, $value->all());
   602|         }
   603|         if ($integrationField->getType() === IntegrationField::TYPE_NUMBER) {
   604|             return $value->ids()[0] ?? null;
   605|         }
   606|         if ($integrationField->getType() === IntegrationField::TYPE_FLOAT) {
   607|             return $value->ids()[0] ?? null;
   608|         }
   609|         return null;
   610|     }
   611|     protected function defineValueForEmailPreview(FakerFactory $faker): mixed
   612|     {
   613|         $query = $this->getElementsQuery();
   614|         if (Craft::$app->getDb()->getIsMysql()) {
   615|             $query->orderBy('RAND()');
   616|         } else {
   617|             $query->orderBy('RANDOM()');
   618|         }
   619|         if ($this->displayType === 'radio' || ($this->displayType === 'dropdown' && !$this->multi)) {
   620|             $query->limit(1);
   621|         }
   622|         return $query;
   623|     }
   624|     protected function getStringCustomFieldOptions(array $fields): array
   625|     {
   626|         $options = [];
   627|         $excludedFields = [
   628|             CraftFields\Assets::class,
   629|             CraftFields\Categories::class,
   630|             CraftFields\Checkboxes::class,
   631|             CraftFields\Entries::class,
   632|             CraftFields\Matrix::class,
   633|             CraftFields\MultiSelect::class,
   634|             CraftFields\Table::class,
   635|             CraftFields\Tags::class,
   636|             CraftFields\Users::class,
   637|         ];
   638|         foreach ($fields as $field) {
   639|             if (in_array(get_class($field), $excludedFields)) {
   640|                 continue;
   641|             }
   642|             $options[] = ['label' => $field->name, 'value' => $field->handle];
   643|         }
   644|         return $options;
   645|     }
   646|     protected function getElementLabel(ElementInterface $element): string
   647|     {
   648|         try {
   649|             return (string)$element->{$this->labelSource};
   650|         } catch (Throwable $e) {
   651|         }
   652|         return $element->title;
   653|     }
   654|     protected function targetSiteId(?ElementInterface $element = null): int
   655|     {
   656|         return $element->siteId ?? Craft::$app->getSites()->getCurrentSite()->id;
   657|     }
   658|     protected function createSelectionCondition(): ?ElementConditionInterface
   659|     {
   660|         return null;
   661|     }
   662|     private function _elementToArray(ElementInterface $element)
   663|     {
   664|         $array = get_object_vars($element);
   665|         $array['url'] = $element->getUrl();
   666|         $array['link'] = $element->getLink();
   667|         $array['uriFormat'] = $element->getUriFormat();
   668|         $array['isHomepage'] = $element->getIsHomepage();
   669|         $array['uiLabel'] = $element->getUiLabel();
   670|         $array['cpEditUrl'] = $element->getCpEditUrl();
   671|         $array['postEditUrl'] = $element->getPostEditUrl();
   672|         $array['cpRevisionsUrl'] = $element->getCpRevisionsUrl();
   673|         $array['status'] = $element->getStatus();
   674|         $array = array_merge($array, $element->serializedFieldValues);
   675|         ksort($array);
   676|         return Json::decode(Json::encode($array));
   677|     }
   678| }


# ====================================================================
# FILE: src/base/Field.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-1419 ---
     1| <?php
     2| namespace verbb\formie\base;
     3| use verbb\formie\Formie;
     4| use verbb\formie\elements\Form;
     5| use verbb\formie\elements\Submission;
     6| use verbb\formie\events\ModifyFieldConfigEvent;
     7| use verbb\formie\events\ModifyFieldEmailValueEvent;
     8| use verbb\formie\events\ModifyFieldHtmlTagEvent;
     9| use verbb\formie\events\ModifyFieldIntegrationValueEvent;
    10| use verbb\formie\events\ModifyFieldUniqueQueryEvent;
    11| use verbb\formie\events\ModifyFieldValueEvent;
    12| use verbb\formie\fields;
    13| use verbb\formie\fields\Hidden;
    14| use verbb\formie\helpers\ArrayHelper;
    15| use verbb\formie\helpers\ConditionsHelper;
    16| use verbb\formie\helpers\Html;
    17| use verbb\formie\helpers\SchemaHelper;
    18| use verbb\formie\helpers\StringHelper;
    19| use verbb\formie\helpers\Table;
    20| use verbb\formie\helpers\Variables;
    21| use verbb\formie\models\FieldLayout;
    22| use verbb\formie\models\FieldLayoutPage;
    23| use verbb\formie\models\FieldLayoutRow;
    24| use verbb\formie\models\IntegrationField;
    25| use verbb\formie\models\Notification;
    26| use verbb\formie\models\HtmlTag;
    27| use verbb\formie\models\Settings;
    28| use verbb\formie\positions\AboveInput;
    29| use verbb\formie\positions\BelowInput;
    30| use verbb\formie\positions\Hidden as HiddenPosition;
    31| use verbb\formie\records\Field as FieldRecord;
    32| use verbb\formie\validators\HandleValidator;
    33| use Craft;
    34| use craft\base\ElementInterface;
    35| use craft\base\Field as CraftField;
    36| use craft\base\FieldInterface as CraftFieldInterface;
    37| use craft\base\SavableComponent;
    38| use craft\db\Query;
    39| use craft\fieldlayoutelements\CustomField;
    40| use craft\fields\BaseRelationField;
    41| use craft\gql\types\DateTime as DateTimeType;
    42| use craft\gql\types\QueryArgument;
    43| use craft\helpers\Cp;
    44| use craft\helpers\DateTimeHelper;
    45| use craft\helpers\Db;
    46| use craft\helpers\Json;
    47| use craft\helpers\Template;
    48| use craft\validators\UniqueValidator;
    49| use GraphQL\Type\Definition\Type;
    50| use Faker\Generator as FakerFactory;
    51| use Twig\Markup;
    52| use Arrayable;
    53| use DateTime;
    54| use ReflectionClass;
    55| use ReflectionException;
    56| use ReflectionNamedType;
    57| use ReflectionProperty;
    58| use ReflectionUnionType;
    59| use Serializable;
    60| use Throwable;
    61| use yii\db\ExpressionInterface;
    62| use yii\db\Schema;
    63| abstract class Field extends SavableComponent implements CraftFieldInterface, FieldInterface
    64| {
    65|     public const EVENT_BEFORE_ELEMENT_SAVE = 'beforeElementSave';
    66|     public const EVENT_AFTER_ELEMENT_SAVE = 'afterElementSave';
    67|     public const EVENT_AFTER_ELEMENT_PROPAGATE = 'afterElementPropagate';
    68|     public const EVENT_BEFORE_ELEMENT_DELETE = 'beforeElementDelete';
    69|     public const EVENT_AFTER_ELEMENT_DELETE = 'afterElementDelete';
    70|     public const EVENT_BEFORE_ELEMENT_RESTORE = 'beforeElementRestore';
    71|     public const EVENT_AFTER_ELEMENT_RESTORE = 'afterElementRestore';
    72|     public const EVENT_MODIFY_DEFAULT_VALUE = 'modifyDefaultValue';
    73|     public const EVENT_MODIFY_FIELD_CONFIG = 'modifyFieldConfig';
    74|     public const EVENT_MODIFY_HTML_TAG = 'modifyHtmlTag';
    75|     public const EVENT_MODIFY_VALUE_AS_STRING = 'modifyValueAsString';
    76|     public const EVENT_MODIFY_VALUE_AS_JSON = 'modifyValueAsJson';
    77|     public const EVENT_MODIFY_VALUE_FOR_EXPORT = 'modifyValueForExport';
    78|     public const EVENT_MODIFY_VALUE_FOR_INTEGRATION = 'modifyValueForIntegration';
    79|     public const EVENT_MODIFY_VALUE_FOR_SUMMARY = 'modifyValueForSummary';
    80|     public const EVENT_MODIFY_VALUE_FOR_EMAIL = 'modifyValueForEmail';
    81|     public const EVENT_MODIFY_VALUE_FOR_EMAIL_PREVIEW = 'modifyValueForEmailPreview';
    82|     public const EVENT_MODIFY_VALUE_FOR_VARIABLE = 'modifyValueForVariable';
    83|     public const EVENT_MODIFY_UNIQUE_QUERY = 'modifyUniqueQuery';
    84|     public const TRANSLATION_METHOD_NONE = 'none';
    85|     public const TRANSLATION_METHOD_SITE = 'site';
    86|     public const TRANSLATION_METHOD_SITE_GROUP = 'siteGroup';
    87|     public const TRANSLATION_METHOD_LANGUAGE = 'language';
    88|     public const TRANSLATION_METHOD_CUSTOM = 'custom';
    89|     use FieldLegacy;
    90|     public static function className(): string
    91|     {
    92|         $classNameParts = explode('\\', static::class);
    93|         return array_pop($classNameParts);
    94|     }
    95|     public static function kebabClassName(): string
    96|     {
    97|         return StringHelper::toKebabCase(static::className());
    98|     }
    99|     public static function lowerClassName(): string
   100|     {
   101|         return StringHelper::toLowerCase(static::className());
   102|     }
   103|     public static function phpType(): string
   104|     {
   105|         return 'mixed';
   106|     }
   107|     public static function dbType(): array|string|null
   108|     {
   109|         return Schema::TYPE_TEXT;
   110|     }
   111|     public static function queryCondition(array $instances, mixed $value, array &$params): array|string|ExpressionInterface|false|null
   112|     {
   113|         $valueSql = static::valueSql($instances);
   114|         if ($valueSql === null) {
   115|             return false;
   116|         }
   117|         if (is_array($value) && isset($value['value'])) {
   118|             $caseInsensitive = $value['caseInsensitive'] ?? false;
   119|             $value = $value['value'];
   120|         } else {
   121|             $caseInsensitive = false;
   122|         }
   123|         return Db::parseParam($valueSql, $value, caseInsensitive: $caseInsensitive, columnType: Schema::TYPE_JSON);
   124|     }
   125|     protected static function valueSql(array $instances, string $key = null): ?string
   126|     {
   127|         $valuesSql = array_filter(
   128|             array_map(fn(self $field) => $field->getValueSql($key), $instances),
   129|             fn(?string $valueSql) => $valueSql !== null,
   130|         );
   131|         if (empty($valuesSql)) {
   132|             return null;
   133|         }
   134|         if (count($valuesSql) === 1) {
   135|             return reset($valuesSql);
   136|         }
   137|         return sprintf('COALESCE(%s)', implode(',', $valuesSql));
   138|     }
   139|     public static function getFrontEndInputTemplatePath(): string
   140|     {
   141|         return 'fields/' . static::kebabClassName();
   142|     }
   143|     public static function getEmailTemplatePath(): string
   144|     {
   145|         return 'fields/' . static::kebabClassName();
   146|     }
   147|     public static function getSvgIcon(): string
   148|     {
   149|         if (static::getSvgIconPath()) {
   150|             return Craft::$app->getView()->renderTemplate(static::getSvgIconPath());
   151|         }
   152|         return '';
   153|     }
   154|     public static function getSvgIconPath(): string
   155|     {
   156|         return '';
   157|     }
   158|     public static function getRequiredPlugins(): array
   159|     {
   160|         return [];
   161|     }
   162|     public static function getFieldSelectOptions(): array
   163|     {
   164|         return [];
   165|     }
   166|     public ?int $layoutId = null;
   167|     public ?int $pageId = null;
   168|     public ?int $rowId = null;
   169|     public ?int $syncId = null;
   170|     public ?string $label = null;
   171|     public ?string $handle = null;
   172|     public ?int $sortOrder = null;
   173|     public ?DateTime $dateCreated = null;
   174|     public ?DateTime $dateUpdated = null;
   175|     public ?string $uid = null;
   176|     public ?string $instructions = null;
   177|     public bool $required = false;
   178|     public bool $enabled = true;
   179|     public ?string $matchField = null;
   180|     public ?string $placeholder = null;
   181|     public mixed $defaultValue = null;
   182|     public ?string $prePopulate = null;
   183|     public ?string $errorMessage = null;
   184|     public ?string $labelPosition = null;
   185|     public ?string $instructionsPosition = null;
   186|     public ?string $cssClasses = null;
   187|     public ?array $containerAttributes = null;
   188|     public ?array $inputAttributes = null;
   189|     public bool $includeInEmail = true;
   190|     public ?string $emailValue = null;
   191|     public bool $enableConditions = false;
   192|     public ?array $conditions = null;
   193|     public bool $enableContentEncryption = false;
   194|     public ?string $visibility = null;
   195|     private ?Form $_form = null;
   196|     private ?FieldLayout $_layout = null;
   197|     private ?FieldLayoutPage $_page = null;
   198|     private ?FieldLayoutRow $_row = null;
   199|     private array $_themeConfig = [];
   200|     private ?FieldInterface $_parentField = null;
   201|     private string $_namespace = 'fields';
   202|     private ?string $_customNamespace = null;
   203|     private ?bool $_isFresh = null;
   204|     private array $_valueSql = [];
   205|     private array $_renderOptions = [];
   206|     public function __construct(array $config = [])
   207|     {
   208|         self::normalizeConfig($config);
   209|         parent::__construct($config);
   210|     }
   211|     public function settingsAttributes(): array
   212|     {
   213|         $names = parent::settingsAttributes();
   214|         $names[] = 'instructions';
   215|         $names[] = 'enabled';
   216|         $names[] = 'required';
   217|         $names[] = 'matchField';
   218|         $names[] = 'placeholder';
   219|         $names[] = 'defaultValue';
   220|         $names[] = 'prePopulate';
   221|         $names[] = 'errorMessage';
   222|         $names[] = 'labelPosition';
   223|         $names[] = 'instructionsPosition';
   224|         $names[] = 'cssClasses';
   225|         $names[] = 'containerAttributes';
   226|         $names[] = 'inputAttributes';
   227|         $names[] = 'includeInEmail';
   228|         $names[] = 'emailValue';
   229|         $names[] = 'enableConditions';
   230|         $names[] = 'conditions';
   231|         $names[] = 'enableContentEncryption';
   232|         $names[] = 'visibility';
   233|         return $names;
   234|     }
   235|     public function getType(): string
   236|     {
   237|         return static::class;
   238|     }
   239|     public function getDisplayType(): ?string
   240|     {
   241|         if (property_exists($this, 'displayType')) {
   242|             return $this->displayType;
   243|         }
   244|         return null;
   245|     }
   246|     public function hasLabel(): bool
   247|     {
   248|         return true;
   249|     }
   250|     public function hasSubFields(): bool
   251|     {
   252|         return false;
   253|     }
   254|     public function hasNestedFields(): bool
   255|     {
   256|         return false;
   257|     }
   258|     public function getIsCosmetic(): bool
   259|     {
   260|         return false;
   261|     }
   262|     public function hasEmailPlaceholder(): bool
   263|     {
   264|         return true;
   265|     }
   266|     public function getIsHidden(): bool
   267|     {
   268|         return $this->visibility === 'hidden';
   269|     }
   270|     public function getIsDisabled(): bool
   271|     {
   272|         return !$this->enabled || $this->visibility === 'disabled';
   273|     }
   274|     public function getIsRequired(): ?bool
   275|     {
   276|         return $this->required;
   277|     }
   278|     public function getIsNested(): bool
   279|     {
   280|         return (bool)$this->getParentField();
   281|     }
   282|     public function setIsFresh(?bool $isFresh = null): void
   283|     {
   284|         $this->_isFresh = $isFresh;
   285|     }
   286|     public function getForm(): ?Form
   287|     {
   288|         if ($this->_form || !$this->layoutId) {
   289|             return $this->_form;
   290|         }
   291|         if ($parentField = $this->getParentField()) {
   292|             return $this->_form = Formie::$plugin->getForms()->getFormByLayoutId($parentField->layoutId);
   293|         }
   294|         return $this->_form = Formie::$plugin->getForms()->getFormByLayoutId($this->layoutId);
   295|     }
   296|     public function getLayout(): ?FieldLayout
   297|     {
   298|         if ($this->_layout || !$this->layoutId) {
   299|             return $this->_layout;
   300|         }
   301|         return $this->_layout = Formie::$plugin->getFields()->getLayoutById($this->layoutId);
   302|     }
   303|     public function getPage(): ?FieldLayoutPage
   304|     {
   305|         if ($this->_page || !$this->pageId) {
   306|             return $this->_page;
   307|         }
   308|         return $this->_page = Formie::$plugin->getFields()->getPageById($this->pageId);
   309|     }
   310|     public function getRow(): ?FieldLayoutRow
   311|     {
   312|         if ($this->_row || !$this->rowId) {
   313|             return $this->_row;
   314|         }
   315|         return $this->_row = Formie::$plugin->getFields()->getRowById($this->rowId);
   316|     }
   317|     public function modifyAttributeLabels(array &$labels): void
   318|     {
   319|         return;
   320|     }
   321|     public function normalizeValueFromRequest(mixed $value, ?ElementInterface $element): mixed
   322|     {
   323|         return $this->normalizeValue($value, $element);
   324|     }
   325|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
   326|     {
   327|         if (is_string($value)) {
   328|             $value = StringHelper::cleanString($value);
   329|             if ($this->enableContentEncryption || str_contains($value, 'base64:')) {
   330|                 $value = StringHelper::decdec($value);
   331|             }
   332|         }
   333|         return $value;
   334|     }
   335|     public function serializeValue(mixed $value, ?ElementInterface $element): mixed
   336|     {
   337|         if ($value instanceof Serializable) {
   338|             $value = $value->serialize();
   339|         } else if ($value instanceof Arrayable) {
   340|             $value = $value->toArray();
   341|         } else if ($value instanceof DateTime || DateTimeHelper::isIso8601($value)) {
   342|             $value = Db::prepareDateForDb($value);
   343|         }
   344|         if ($this->enableContentEncryption && is_string($value)) {
   345|             $value = StringHelper::encenc($value);
   346|         }
   347|         return $value;
   348|     }
   349|     public function isValueEmpty(mixed $value, ?ElementInterface $element): bool
   350|     {
   351|         return $value === null || $value === [] || $value === '';
   352|     }
   353|     public function getElementConditionRuleType(): array|string|null
   354|     {
   355|         return null;
   356|     }
   357|     public function getValueSql(?string $key = null): ?string
   358|     {
   359|         $cacheKey = $key ?? '*';
   360|         $this->_valueSql[$cacheKey] ??= $this->_valueSql($key) ?? false;
   361|         return $this->_valueSql[$cacheKey] ?: null;
   362|     }
   363|     public function getSortOption(): array
   364|     {
   365|         return [
   366|             'label' => Craft::t('site', $this->label),
   367|             'orderBy' => [$this->getValueSql(), 'id'],
   368|             'attribute' => "field:{$this->handle}",
   369|         ];
   370|     }
   371|     public function getValueAsString(mixed $value, ?ElementInterface $element = null): mixed
   372|     {
   373|         $value = $this->defineValueAsString($value, $element);
   374|         $event = new ModifyFieldValueEvent([
   375|             'value' => $value,
   376|             'field' => $this,
   377|             'submission' => $element,
   378|         ]);
   379|         $this->trigger(static::EVENT_MODIFY_VALUE_AS_STRING, $event);
   380|         return $event->value;
   381|     }
   382|     public function getValueAsJson(mixed $value, ?ElementInterface $element = null): mixed
   383|     {
   384|         $value = $this->defineValueAsJson($value, $element);
   385|         $event = new ModifyFieldValueEvent([
   386|             'value' => $value,
   387|             'field' => $this,
   388|             'submission' => $element,
   389|         ]);
   390|         $this->trigger(static::EVENT_MODIFY_VALUE_AS_JSON, $event);
   391|         return $event->value;
   392|     }
   393|     public function getValueForExport(mixed $value, ?ElementInterface $element = null): mixed
   394|     {
   395|         $value = $this->defineValueForExport($value, $element);
   396|         $event = new ModifyFieldValueEvent([
   397|             'value' => $value,
   398|             'field' => $this,
   399|             'submission' => $element,
   400|         ]);
   401|         $this->trigger(static::EVENT_MODIFY_VALUE_FOR_EXPORT, $event);
   402|         return $event->value;
   403|     }
   404|     public function getValueForIntegration(mixed $value, IntegrationField $integrationField, IntegrationInterface $integration, ?ElementInterface $element = null, string $fieldKey = ''): mixed
   405|     {
   406|         $rawValue = $value;
   407|         $value = $this->defineValueForIntegration($value, $integrationField, $integration, $element, $fieldKey);
   408|         $event = new ModifyFieldIntegrationValueEvent([
   409|             'value' => $value,
   410|             'rawValue' => $rawValue,
   411|             'field' => $this,
   412|             'submission' => $element,
   413|             'integrationField' => $integrationField,
   414|             'integration' => $integration,
   415|         ]);
   416|         $this->trigger(static::EVENT_MODIFY_VALUE_FOR_INTEGRATION, $event);
   417|         if ($integration) {
   418|             $integration->init(); // We need to manually trigger `init()` as it doesn't seem to kick off in a queue job
   419|             $integration->trigger($integration::EVENT_MODIFY_FIELD_MAPPING_VALUE, $event);
   420|         }
   421|         return $event->value;
   422|     }
   423|     public function getValueForSummary(mixed $value, ?ElementInterface $element = null): mixed
   424|     {
   425|         $value = $this->defineValueForSummary($value, $element);
   426|         $event = new ModifyFieldValueEvent([
   427|             'value' => $value,
   428|             'field' => $this,
   429|             'submission' => $element,
   430|         ]);
   431|         $this->trigger(static::EVENT_MODIFY_VALUE_FOR_SUMMARY, $event);
   432|         return $event->value;
   433|     }
   434|     public function getValueForEmail(mixed $value, Notification $notification, ?ElementInterface $element = null): mixed
   435|     {
   436|         $value = $this->defineValueForEmail($value, $notification, $element);
   437|         $event = new ModifyFieldEmailValueEvent([
   438|             'value' => $value,
   439|             'field' => $this,
   440|             'submission' => $element,
   441|             'notification' => $notification,
   442|         ]);
   443|         $this->trigger(static::EVENT_MODIFY_VALUE_FOR_EMAIL, $event);
   444|         return $event->value;
   445|     }
   446|     public function getValueForEmailPreview(FakerFactory $faker): mixed
   447|     {
   448|         $value = $this->defineValueForEmailPreview($faker);
   449|         $event = new ModifyFieldEmailValueEvent([
   450|             'value' => $value,
   451|             'field' => $this,
   452|             'faker' => $faker,
   453|         ]);
   454|         $this->trigger(static::EVENT_MODIFY_VALUE_FOR_EMAIL_PREVIEW, $event);
   455|         return $event->value;
   456|     }
   457|     public function getValueForCondition(mixed $value, Submission $submission): mixed
   458|     {
   459|         return $this->serializeValue($value, $submission);
   460|     }
   461|     public function getValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
   462|     {
   463|         $value = $this->defineValueForVariable($value, $submission, $notification);
   464|         $event = new ModifyFieldEmailValueEvent([
   465|             'value' => $value,
   466|             'field' => $this,
   467|             'submission' => $submission,
   468|             'notification' => $notification,
   469|         ]);
   470|         $this->trigger(static::EVENT_MODIFY_VALUE_FOR_VARIABLE, $event);
   471|         return $event->value;
   472|     }
   473|     public function populateValue(mixed $value, ?Submission $submission): void
   474|     {
   475|         $this->defaultValue = $this->normalizeValue($value, $submission);
   476|     }
   477|     public function getMatchField(): ?string
   478|     {
   479|         return $this->matchField ? str_replace(['{', '}', 'field:'], '', $this->matchField) : null;
   480|     }
   481|     public function getElementValidationRules(): array
   482|     {
   483|         $rules = [];
   484|         if ($this->matchField) {
   485|             $rules[] = ['validateMatchField', 'skipOnEmpty' => false];
   486|         }
   487|         return $rules;
   488|     }
   489|     public function validateMatchField(ElementInterface $element): void
   490|     {
   491|         $fieldHandle = $this->getMatchField();
   492|         $sourceValue = $element->getFieldValue($fieldHandle);
   493|         $value = $element->getFieldValue($this->fieldKey);
   494|         if ($sourceValue !== $value) {
   495|             $sourceField = $element->getFieldByHandle($fieldHandle);
   496|             $element->addError($this->fieldKey, Craft::t('formie', '{name} must match {value}.', [
   497|                 'name' => $this->label,
   498|                 'value' => $sourceField->label ?? '',
   499|             ]));
   500|         }
   501|     }
   502|     public function validateUniqueValue(ElementInterface $element): void
   503|     {
   504|         $value = $element->getFieldValue($this->fieldKey);
   505|         $value = trim($value);
   506|         $contentQuery = Craft::$app->getDb()->getQueryBuilder()->jsonContains('s.content', [$this->uid => $value]);
   507|         $query = (new Query())
   508|             ->from(['s' => Table::FORMIE_SUBMISSIONS])
   509|             ->where(['isIncomplete' => false, 'e.dateDeleted' => null])
   510|             ->andWhere($contentQuery)
   511|             ->leftJoin(['e' => Table::ELEMENTS], '[[e.id]] = [[s.id]]');
   512|         if ($element->id) {
   513|             $query->andWhere(['!=', 's.id', $element->id]);
   514|         }
   515|         $event = new ModifyFieldUniqueQueryEvent([
   516|             'query' => $query,
   517|             'field' => $this,
   518|         ]);
   519|         $this->trigger(self::EVENT_MODIFY_UNIQUE_QUERY, $event);
   520|         $valueExists = $event->query->exists();
   521|         if ($valueExists) {
   522|             $element->addError($this->fieldKey, Craft::t('formie', '“{name}” must be unique.', [
   523|                 'name' => $this->label,
   524|             ]));
   525|         }
   526|     }
   527|     public function getHtmlId(Form $form, ?string $extra = null): string
   528|     {
   529|         $ids = [$form->getFormId(), ...$this->getFullNamespace(), $this->handle, $extra];
   530|         return Html::getInputIdAttribute(ArrayHelper::filterEmpty($ids));
   531|     }
   532|     public function getHtmlDataId(Form $form, ?string $extra = null): string
   533|     {
   534|         $ids = [$form->handle, ...$this->getFullHandle(), $extra];
   535|         return implode('-', ArrayHelper::filterEmpty($ids));
   536|     }
   537|     public function getHtmlName(?string $extra = null): string
   538|     {
   539|         $names = [...$this->getFullNamespace(), $this->handle, $extra];
   540|         $names = ArrayHelper::filterEmpty($names);
   541|         return Html::getInputNameAttribute($names);
   542|     }
   543|     public function getFieldKey(): string
   544|     {
   545|         $names = [];
   546|         foreach ($this->getFullNamespace() as $namespaceKey => $item) {
   547|             if ($item === 'fields') {
   548|                 continue;
   549|             }
   550|             $names[] = explode('[', str_replace(']', '', $item));
   551|         }
   552|         $names = array_merge(...$names);
   553|         $names = ArrayHelper::filterEmpty([...$names, $this->handle]);
   554|         return implode('.', $names);
   555|     }
   556|     public function getErrorKey(): string
   557|     {
   558|         return $this->fieldKey;
   559|     }
   560|     public function getFieldTypeConfig(): array
   561|     {
   562|         $config = [
   563|             'icon' => static::getSvgIcon(),
   564|             'type' => get_class($this),
   565|             'label' => static::displayName(),
   566|             'preview' => $this->getPreviewInputHtml(),
   567|             'hasLabel' => $this->hasLabel(),
   568|             'hasSubFields' => $this->hasSubFields(),
   569|             'hasNestedFields' => $this->hasNestedFields(),
   570|             'hasEditableFields' => !($this instanceof NestedFieldInterface && !($this instanceof SubFieldInterface)),
   571|             'isPickable' => !($this instanceof SubFieldInnerFieldInterface),
   572|             'schema' => $this->getFieldSchema(),
   573|             'labelPositions' => Formie::$plugin->getFields()->getLabelPositionsOptions($this),
   574|             'instructionsPositions' => Formie::$plugin->getFields()->getInstructionsPositionsOptions($this),
   575|             'fieldSelectOptions' => static::getFieldSelectOptions(),
   576|             'newField' => $this->getFormBuilderConfig(),
   577|             'data' => $this->getFieldTypeConfigData(),
   578|         ];
   579|         return $config;
   580|     }
   581|     public function getFieldTypeConfigData(): array
   582|     {
   583|         return [];
   584|     }
   585|     public function getFormBuilderConfig(): array
   586|     {
   587|         $config = [
   588|             'type' => get_class($this),
   589|             'id' => $this->id,
   590|             'errors' => $this->getErrors(),
   591|             'hasLabel' => $this->hasLabel(),
   592|             'hasSubFields' => $this->hasSubFields(),
   593|             'hasNestedFields' => $this->hasNestedFields(),
   594|             'hasConditions' => $this->hasConditions(),
   595|             'isCosmetic' => $this->getIsCosmetic(),
   596|             'isSynced' => $this->getIsSynced(),
   597|             'isNested' => $this->getIsNested(),
   598|             'isMultiNested' => $this instanceof MultiNestedFieldInterface,
   599|             'isSingleNested' => $this instanceof SingleNestedFieldInterface,
   600|             'settings' => $this->getFormBuilderSettings(),
   601|         ];
   602|         $config = $this->modifyFieldSettings($config);
   603|         $event = new ModifyFieldConfigEvent([
   604|             'config' => $config,
   605|         ]);
   606|         $this->trigger(self::EVENT_MODIFY_FIELD_CONFIG, $event);
   607|         return $event->config;
   608|     }
   609|     public function getFormBuilderSettings(): array
   610|     {
   611|         $settings = $this->getSettings();
   612|         $settings['layoutId'] = $this->layoutId;
   613|         $settings['pageId'] = $this->pageId;
   614|         $settings['rowId'] = $this->rowId;
   615|         $settings['syncId'] = $this->syncId;
   616|         $settings['label'] = $this->label;
   617|         $settings['handle'] = $this->handle;
   618|         $settings['sortOrder'] = $this->sortOrder;
   619|         return $settings;
   620|     }
   621|     public function modifyFieldSettings(array $settings): array
   622|     {
   623|         return $settings;
   624|     }
   625|     public function getDefaultValue(): mixed
   626|     {
   627|         $defaultValue = null;
   628|         if ($this->prePopulate) {
   629|             $queryParam = Craft::$app->getRequest()->getParam($this->prePopulate);
   630|             if ($queryParam !== null) {
   631|                 $defaultValue = $this->setPrePopulatedValue($queryParam);
   632|             }
   633|         }
   634|         if (!$defaultValue) {
   635|             $defaultValue = $this->defaultValue;
   636|             if (!is_array($defaultValue) && !is_object($defaultValue)) {
   637|                 if (!($this instanceof Hidden)) {
   638|                     $defaultValue = Variables::getParsedValue($defaultValue);
   639|                 }
   640|             }
   641|         }
   642|         $defaultValue = $this->normalizeValue($defaultValue, null);
   643|         $event = new ModifyFieldValueEvent([
   644|             'value' => $defaultValue,
   645|             'field' => $this,
   646|         ]);
   647|         $this->trigger(static::EVENT_MODIFY_DEFAULT_VALUE, $event);
   648|         if (is_string($event->value)) {
   649|             $event->value = trim($event->value);
   650|         }
   651|         return $event->value;
   652|     }
   653|     public function getFieldSchema(): array
   654|     {
   655|         $tabs = [];
   656|         $fields = [];
   657|         $definedTabs = [
   658|             'General',
   659|             'Settings',
   660|             'Appearance',
   661|             'Advanced',
   662|             'Conditions',
   663|         ];
   664|         foreach ($definedTabs as $definedTab) {
   665|             $methodName = 'define' . $definedTab . 'Schema';
   666|             if (method_exists($this, $methodName)) {
   667|                 if ($fieldSchema = $this->$methodName()) {
   668|                     $tabLabel = Craft::t('formie', $definedTab);
   669|                     SchemaHelper::setFieldAttributes($fieldSchema);
   670|                     $fields[] = [
   671|                         '$cmp' => 'TabPanel',
   672|                         'attrs' => [
   673|                             'data-tab-panel' => $tabLabel,
   674|                         ],
   675|                         'children' => $fieldSchema,
   676|                     ];
   677|                     $tabs[] = [
   678|                         'label' => $tabLabel,
   679|                         'fields' => SchemaHelper::extractFieldsFromSchema($fieldSchema),
   680|                     ];
   681|                 }
   682|             }
   683|         }
   684|         return [
   685|             'tabs' => $tabs,
   686|             'fields' => [
   687|                 [
   688|                     '$cmp' => 'TabPanels',
   689|                     'attrs' => [
   690|                         'class' => 'fui-modal-content',
   691|                     ],
   692|                     'children' => $fields,
   693|                 ],
   694|             ],
   695|         ];
   696|     }
   697|     public function getValidationConfigString(array $context = []): string
   698|     {
   699|         $validators = [];
   700|         if ($this->required) {
   701|             $validators[] = 'required';
   702|         }
   703|         $htmlTag = $this->renderHtmlTag('fieldInput', $context);
   704|         $type = $htmlTag->attributes['type'] ?? null;
   705|         if (in_array($type, ['url', 'email', 'number'])) {
   706|             $validators[] = $type;
   707|         }
   708|         if ($this->matchField) {
   709|             $validators[] = 'match:' . $this->getMatchField();
   710|         }
   711|         return implode('|', $validators);
   712|     }
   713|     public function renderHtmlTag(string $key, array $context = []): ?HtmlTag
   714|     {
   715|         $tag = $this->defineHtmlTag($key, $context);
   716|         if ($tag) {
   717|             $form = $context['form'] ?? $this->getForm();
   718|             $templateConfig = $form->getThemeConfigItem($key);
   719|             $classTemplateConfig = $form->getThemeConfigItem(Html::getFieldClassKey($this) . '.' . $key);
   720|             $config = Html::mergeHtmlConfigs([$key => $templateConfig], [$key => $classTemplateConfig])[$key] ?? [];
   721|             if (!$config) {
   722|                 $tag = null;
   723|             } else {
   724|                 if ($form->resetClasses) {
   725|                     $config['resetClass'] = true;
   726|                 }
   727|                 $tag->setFromConfig($config, $context);
   728|             }
   729|         }
   730|         $event = new ModifyFieldHtmlTagEvent([
   731|             'field' => $this,
   732|             'tag' => $tag,
   733|             'key' => $key,
   734|             'context' => $context,
   735|         ]);
   736|         $this->trigger(static::EVENT_MODIFY_HTML_TAG, $event);
   737|         return $event->tag;
   738|     }
   739|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   740|     {
   741|         $form = $context['form'] ?? null;
   742|         $submission = $context['element'] ?? null;
   743|         $errors = $context['errors'] ?? null;
   744|         $id = $this->getHtmlId($form);
   745|         $dataId = $this->getHtmlDataId($form);
   746|         if ($key === 'field') {
   747|             $labelPosition = $context['labelPosition'] ?? null;
   748|             $subFieldLabelPosition = $context['subFieldLabelPosition'] ?? null;
   749|             $instructionsPosition = $context['instructionsPosition'] ?? null;
   750|             $containerAttributes = $this->getContainerAttributes() ?? [];
   751|             return new HtmlTag('div', [
   752|                 'class' => [
   753|                     'fui-field',
   754|                     'fui-type-' . static::kebabClassName(),
   755|                     'fui-label-' . $labelPosition,
   756|                     'fui-subfield-label-' . $subFieldLabelPosition,
   757|                     'fui-instructions-' . $instructionsPosition,
   758|                     $errors ? 'fui-field-error fui-error' : null,
   759|                     $this->required ? 'fui-field-required' : null,
   760|                     $this->getIsHidden() ? 'fui-hidden' : null,
   761|                     $this->getParentField() ? 'fui-' . $this->getParentField()->kebabClassName() . '-' . StringHelper::toKebabCase($this->handle) : 'fui-page-field',
   762|                 ],
   763|                 'data' => [
   764|                     'field-handle' => $this->fieldKey,
   765|                     'field-type' => static::kebabClassName(),
   766|                     'field-display-type' => $this->getDisplayType(),
   767|                     'field-config' => $this->getConfigJson(),
   768|                     'field-conditions' => $this->getConditionsJson($submission),
   769|                     'validation' => $this->getValidationConfigString($context),
   770|                 ],
   771|             ], $containerAttributes, $this->cssClasses);
   772|         }
   773|         if ($key === 'fieldContainer') {
   774|             return new HtmlTag('div', [
   775|                 'class' => 'fui-field-container',
   776|             ]);
   777|         }
   778|         if ($key === 'fieldLabel') {
   779|             if (!$this->hasLabel()) {
   780|                 return null;
   781|             }
   782|             $labelPosition = $context['labelPosition'] ?? null;
   783|             return new HtmlTag('label', [
   784|                 'class' => [
   785|                     'fui-label',
   786|                 ],
   787|                 'data' => [
   788|                     'field-label' => true,
   789|                     'fui-sr-only' => $labelPosition instanceof HiddenPosition ? true : false,
   790|                 ],
   791|                 'for' => $id,
   792|             ]);
   793|         }
   794|         if ($key === 'fieldRequired') {
   795|             return new HtmlTag('span', [
   796|                 'class' => 'fui-required',
   797|                 'aria-hidden' => 'true',
   798|             ]);
   799|         }
   800|         if ($key === 'fieldOptional') {
   801|             return new HtmlTag('span', [
   802|                 'class' => 'fui-optional',
   803|             ]);
   804|         }
   805|         if ($key === 'fieldInstructions') {
   806|             return new HtmlTag('div', [
   807|                 'id' => "{$id}-instructions",
   808|                 'class' => 'fui-instructions',
   809|             ]);
   810|         }
   811|         if ($key === 'fieldInputWrapper') {
   812|             return new HtmlTag('div', [
   813|                 'class' => 'fui-input-wrapper',
   814|             ]);
   815|         }
   816|         if ($key === 'fieldErrors') {
   817|             return new HtmlTag('div', [
   818|                 'class' => 'fui-errors',
   819|                 'data' => [
   820|                     'field-error-messages' => true,
   821|                 ],
   822|             ]);
   823|         }
   824|         if ($key === 'fieldError') {
   825|             return new HtmlTag('div', [
   826|                 'class' => 'fui-error-message',
   827|                 'data' => [
   828|                     'field-error-message' => true,
   829|                 ],
   830|             ]);
   831|         }
   832|         if ($key === 'subFieldRows') {
   833|             return new HtmlTag('div', [
   834|                 'class' => 'fui-field-rows',
   835|             ]);
   836|         }
   837|         if ($key === 'subFieldRow') {
   838|             $fields = $context['row']['fields'] ?? [];
   839|             return new HtmlTag('div', [
   840|                 'class' => 'fui-row',
   841|                 'data-fui-field-count' => count($fields),
   842|             ]);
   843|         }
   844|         if ($key === 'nestedFieldRows') {
   845|             return new HtmlTag('div', [
   846|                 'class' => 'fui-field-rows',
   847|             ]);
   848|         }
   849|         if ($key === 'nestedFieldRow') {
   850|             $fields = $context['row']['fields'] ?? [];
   851|             return new HtmlTag('div', [
   852|                 'class' => 'fui-row',
   853|                 'data-fui-field-count' => count($fields),
   854|             ]);
   855|         }
   856|         return null;
   857|     }
   858|     public function getContainerAttributes(): array
   859|     {
   860|         if (!$this->containerAttributes) {
   861|             return [];
   862|         }
   863|         return ArrayHelper::map($this->containerAttributes, 'label', 'value');
   864|     }
   865|     public function getInputAttributes(): array
   866|     {
   867|         if (!$this->inputAttributes) {
   868|             return [];
   869|         }
   870|         return ArrayHelper::map($this->inputAttributes, 'label', 'value');
   871|     }
   872|     public function getNamespace(): string
   873|     {
   874|         return $this->_namespace;
   875|     }
   876|     public function setNamespace(string|bool|null $value): void
   877|     {
   878|         $this->_namespace = $value;
   879|     }
   880|     public function getParentField(): ?FieldInterface
   881|     {
   882|         return $this->_parentField;
   883|     }
   884|     public function setParentField(FieldInterface $value, string $namespace = ''): void
   885|     {
   886|         $this->_parentField = $value;
   887|         if ($namespace !== '') {
   888|             $this->setNamespace(Html::namespaceInputName($namespace, $value->handle));
   889|         } else {
   890|             $this->setNamespace($value->handle);
   891|         }
   892|     }
   893|     public function getCpInputHtml(mixed $value, ?ElementInterface $element): Markup
   894|     {
   895|         $input = $this->cpInputHtml($value, $element, false);
   896|         $errors = $element ? $element->getErrors($this->handle) : '';
   897|         $field = Cp::fieldHtml($input, [
   898|             'label' => $this->hasLabel() ? Craft::t('site', $this->label) : null,
   899|             'attribute' => $this->handle,
   900|             'required' => $this->required,
   901|             'instructions' => Craft::t('site', $this->instructions),
   902|             'id' => $this->handle,
   903|             'errors' => $errors,
   904|             'fieldAttributes' => [
   905|                 'data-type' => get_class($this),
   906|             ],
   907|         ]);
   908|         return Template::raw($field);
   909|     }
   910|     public function getFrontEndInputHtml(Form $form, mixed $value, array $renderOptions = []): Markup
   911|     {
   912|         if (!static::getFrontEndInputTemplatePath()) {
   913|             return Template::raw('');
   914|         }
   915|         $inputOptions = $this->getFrontEndInputOptions($form, $value, $renderOptions);
   916|         $html = $form->renderTemplate(static::getFrontEndInputTemplatePath(), $inputOptions);
   917|         return Template::raw($html);
   918|     }
   919|     public function getFrontEndInputOptions(Form $form, mixed $value, array $renderOptions = []): array
   920|     {
   921|         $field = $renderOptions['field'] ?? $this;
   922|         $errors = ArrayHelper::remove($renderOptions, 'errors');
   923|         $submission = ArrayHelper::remove($renderOptions, 'submission');
   924|         return [
   925|             'form' => $form,
   926|             'name' => $this->handle,
   927|             'value' => $value,
   928|             'field' => $field,
   929|             'errors' => $errors,
   930|             'submission' => $submission,
   931|             'renderOptions' => $renderOptions,
   932|         ];
   933|     }
   934|     public function applyRenderOptions(Form $form, array $renderOptions = []): void
   935|     {
   936|         /* @var Settings $pluginSettings */
   937|         $pluginSettings = Formie::$plugin->getSettings();
   938|         $this->_customNamespace = $renderOptions['fieldNamespace'] ?? null;
   939|         if ($this->_customNamespace !== null) {
   940|             $this->setNamespace($this->_customNamespace);
   941|         }
   942|         $templateConfig = $renderOptions['themeConfig'] ?? [];
   943|         if ($templateConfig) {
   944|             $form->setThemeConfig($templateConfig);
   945|         }
   946|         $this->_renderOptions = $renderOptions;
   947|     }
   948|     public function getRenderOptions(): array
   949|     {
   950|         return $this->_renderOptions;
   951|     }
   952|     public function getFrontEndJsModules(): ?array
   953|     {
   954|         return null;
   955|     }
   956|     public function getConfigJson(): ?string
   957|     {
   958|         $modules = $this->getFrontEndJsModules();
   959|         if (!isset($modules[0])) {
   960|             $modules = [$modules];
   961|         }
   962|         if ($modules) {
   963|             $config = [];
   964|             foreach ($modules as $module) {
   965|                 $settings = $module['settings'] ?? [];
   966|                 $settings['module'] = $module['module'] ?? '';
   967|                 $settings = array_filter($settings);
   968|                 if ($settings) {
   969|                     $config[] = $settings;
   970|                 }
   971|             }
   972|             if ($config) {
   973|                 return Json::encode($config);
   974|             }
   975|         }
   976|         return null;
   977|     }
   978|     public function getIsSynced(): bool
   979|     {
   980|         return (bool)$this->syncId;
   981|     }
   982|     public function hasConditions(): bool
   983|     {
   984|         return ($this->enableConditions && $this->getConditions());
   985|     }
   986|     public function getConditions(): array
   987|     {
   988|         $conditions = $this->conditions ?? [];
   989|         $conditionRows = $conditions['conditions'] ?? [];
   990|         foreach ($conditionRows as $key => $condition) {
   991|             if (!($condition['condition'] ?? null)) {
   992|                 unset($conditions['conditions'][$key]);
   993|             }
   994|         }
   995|         return $conditions;
   996|     }
   997|     public function getConditionsJson(): ?string
   998|     {
   999|         if ($this->hasConditions()) {
  1000|             $conditionSettings = $this->getConditions();
  1001|             $conditions = $conditionSettings['conditions'] ?? [];
  1002|             $namespace = $this->_customNamespace ?? 'fields';
  1003|             $conditionSettings['conditions'] = ConditionsHelper::prepConditionsForJs($conditions, $namespace);
  1004|             $conditionSettings['isNested'] = $this->getIsNested();
  1005|             return Json::encode($conditionSettings);
  1006|         }
  1007|         return null;
  1008|     }
  1009|     public function isConditionallyHidden(Submission $submission): bool
  1010|     {
  1011|         $isFieldHidden = false;
  1012|         $isPageHidden = false;
  1013|         if ($this->enableConditions) {
  1014|             $conditionSettings = $this->getConditions();
  1015|             $conditions = $conditionSettings['conditions'] ?? [];
  1016|             if ($conditionSettings && $conditions) {
  1017|                 $result = ConditionsHelper::getConditionalTestResult($conditionSettings, $submission);
  1018|                 if (($result && $conditionSettings['showRule'] !== 'show') || (!$result && $conditionSettings['showRule'] === 'show')) {
  1019|                     $isFieldHidden = true;
  1020|                 }
  1021|             }
  1022|         }
  1023|         if (!$isFieldHidden && $page = $this->getPage($submission)) {
  1024|             $isPageHidden = $page->isConditionallyHidden($submission);
  1025|         }
  1026|         return $isFieldHidden || $isPageHidden;
  1027|     }
  1028|     public function getEmailHtml(Submission $submission, Notification $notification, mixed $value, array $renderOptions = []): string|null|bool
  1029|     {
  1030|         $value = $this->getValueForEmail($value, $notification, $submission);
  1031|         $inputOptions = $this->getEmailOptions($submission, $notification, $value, $renderOptions);
  1032|         $html = $notification->renderTemplate(static::getEmailTemplatePath(), $inputOptions);
  1033|         return Template::raw($html);
  1034|     }
  1035|     public function getEmailOptions(Submission $submission, Notification $notification, mixed $value, array $renderOptions = []): array
  1036|     {
  1037|         return [
  1038|             'notification' => $notification,
  1039|             'submission' => $submission,
  1040|             'name' => $this->handle,
  1041|             'value' => $value,
  1042|             'field' => $this,
  1043|             'renderOptions' => $renderOptions,
  1044|         ];
  1045|     }
  1046|     public function defineGeneralSchema(): array
  1047|     {
  1048|         return [];
  1049|     }
  1050|     public function defineSettingsSchema(): array
  1051|     {
  1052|         return [];
  1053|     }
  1054|     public function defineAppearanceSchema(): array
  1055|     {
  1056|         return [];
  1057|     }
  1058|     public function defineAdvancedSchema(): array
  1059|     {
  1060|         return [];
  1061|     }
  1062|     public function afterCreateField(array $data): void
  1063|     {
  1064|     }
  1065|     public function getSettingGqlTypes(): array
  1066|     {
  1067|         return [];
  1068|     }
  1069|     public function getGqlTypeName(): string
  1070|     {
  1071|         $classNameParts = explode('\\', static::class);
  1072|         $end = array_pop($classNameParts);
  1073|         return 'Field_' . $end;
  1074|     }
  1075|     public function getContentGqlType(): Type|array
  1076|     {
  1077|         return Type::string();
  1078|     }
  1079|     public function getContentGqlMutationArgumentType(): Type|array
  1080|     {
  1081|         return [
  1082|             'name' => $this->handle,
  1083|             'type' => Type::string(),
  1084|             'description' => $this->instructions,
  1085|         ];
  1086|     }
  1087|     public function getContentGqlQueryArgumentType(): Type|array
  1088|     {
  1089|         return [
  1090|             'name' => $this->handle,
  1091|             'type' => Type::listOf(QueryArgument::getType()),
  1092|         ];
  1093|     }
  1094|     public function getExportLabel(ElementInterface $element): string
  1095|     {
  1096|         foreach ($element->getFields() as $field) {
  1097|             if ($field->id === $this->id) {
  1098|                 continue;
  1099|             }
  1100|             if ($field->label === $this->label) {
  1101|                 return $this->label . ' (' . $this->handle . ')';
  1102|             }
  1103|         }
  1104|         return $this->label;
  1105|     }
  1106|     public function getFullHandle()
  1107|     {
  1108|         $handles = [];
  1109|         $field = $this;
  1110|         while ($field) {
  1111|             array_unshift($handles, $field->handle);
  1112|             $field = $field->getParentField();
  1113|         }
  1114|         return $handles;
  1115|     }
  1116|     public function getFullNamespace()
  1117|     {
  1118|         $names = [];
  1119|         $field = $this;
  1120|         while ($field) {
  1121|             array_unshift($names, $field->getNamespace());
  1122|             $field = $field->getParentField();
  1123|         }
  1124|         return $names;
  1125|     }
  1126|     public function getReservedHandles(): array
  1127|     {
  1128|         try {
  1129|             $reflection = new ReflectionClass(Submission::class);
  1130|             $handles = array_map(function($prop) {
  1131|                 return $prop->name;
  1132|             }, $reflection->getProperties(ReflectionProperty::IS_PUBLIC));
  1133|         } catch (Throwable $e) {
  1134|             $handles = [];
  1135|         }
  1136|         return $handles;
  1137|     }
  1138|     protected function defineRules(): array
  1139|     {
  1140|         $rules = parent::defineRules();
  1141|         $rules[] = [['label', 'handle'], 'required'];
  1142|         $rules[] = [['placeholder', 'errorMessage', 'cssClasses'], 'string', 'max' => 255];
  1143|         $rules[] = [['handle'], HandleValidator::class, 'reservedWords' => $this->getReservedHandles()];
  1144|         $rules[] = [['handle'], 'string', 'max' => 64];
  1145|         $rules[] = [
  1146|             ['handle'],
  1147|             UniqueValidator::class,
  1148|             'targetClass' => FieldRecord::class,
  1149|             'targetAttribute' => ['handle', 'layoutId'],
  1150|             'message' => Craft::t('yii', '{attribute} "{value}" has already been taken.'),
  1151|         ];
  1152|         if (!$this->getIsNew()) {
  1153|             $rules[] = [['id'], 'number', 'integerOnly' => true];
  1154|         }
  1155|         $rules[] = [
  1156|             ['labelPosition'],
  1157|             'in',
  1158|             'range' => Formie::$plugin->getFields()->getLabelPositions($this),
  1159|             'skipOnEmpty' => true,
  1160|         ];
  1161|         $rules[] = [
  1162|             ['instructionsPosition'],
  1163|             'in',
  1164|             'range' => Formie::$plugin->getFields()->getInstructionsPositions($this),
  1165|             'skipOnEmpty' => true,
  1166|         ];
  1167|         return $rules;
  1168|     }
  1169|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
  1170|     {
  1171|         if (method_exists($this, 'inputHtml')) {
  1172|             $html = $this->inputHtml($value, $element, $inline);
  1173|             if ($html) {
  1174|                 Craft::$app->getDeprecator()->log(__METHOD__, 'Formie fields’ `inputHtml()` method has been deprecated. Use `cpInputHtml()` instead.');
  1175|                 return $html;
  1176|             }
  1177|         }
  1178|         return Html::textarea($this->handle, $value);
  1179|     }
  1180|     protected function isFresh(?ElementInterface $element = null): bool
  1181|     {
  1182|         if (isset($this->_isFresh)) {
  1183|             return $this->_isFresh;
  1184|         }
  1185|         if ($element) {
  1186|             return $element->getIsFresh();
  1187|         }
  1188|         return true;
  1189|     }
  1190|     protected function requestParamName(ElementInterface $element): ?string
  1191|     {
  1192|         $namespace = $element->getFieldParamNamespace();
  1193|         return ($namespace ? $namespace . '.' : '') . $this->getFieldKey();
  1194|     }
  1195|     protected function setPrePopulatedValue(mixed $value): mixed
  1196|     {
  1197|         return $value;
  1198|     }
  1199|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
  1200|     {
  1201|         return StringHelper::cleanString((string)$value);
  1202|     }
  1203|     protected function defineValueAsJson(mixed $value, ElementInterface $element = null): mixed
  1204|     {
  1205|         return Json::decode(Json::encode($value));
  1206|     }
  1207|     protected function defineValueForExport(mixed $value, ElementInterface $element = null): mixed
  1208|     {
  1209|         return $this->defineValueAsString($value, $element);
  1210|     }
  1211|     protected function defineValueForIntegration(mixed $value, IntegrationField $integrationField, IntegrationInterface $integration, ElementInterface $element = null, string $fieldKey = ''): mixed
  1212|     {
  1213|         $fieldValue = $this->defineValueAsString($value, $element);
  1214|         if ($integrationField->getType() === IntegrationField::TYPE_ARRAY) {
  1215|             $fieldValue = $this->defineValueAsJson($value, $element);
  1216|         }
  1217|         return Integration::convertValueForIntegration($fieldValue, $integrationField);
  1218|     }
  1219|     protected function defineValueForSummary(mixed $value, ElementInterface $element = null): string
  1220|     {
  1221|         return $this->defineValueAsString($value, $element);
  1222|     }
  1223|     protected function defineValueForEmail(mixed $value, Notification $notification, ElementInterface $element = null): mixed
  1224|     {
  1225|         return $value;
  1226|     }
  1227|     protected function defineValueForEmailPreview(FakerFactory $faker): mixed
  1228|     {
  1229|         return $faker->text;
  1230|     }
  1231|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
  1232|     {
  1233|         return (string)$this->getEmailHtml($submission, $notification, $value);
  1234|     }
  1235|     protected static function normalizeConfig(array &$config = []): void
  1236|     {
  1237|         if (array_key_exists('columnWidth', $config)) {
  1238|             unset($config['columnWidth']);
  1239|         }
  1240|         $supportedLimitConfigTypes = [
  1241|             fields\MultiLineText::class,
  1242|             fields\SingleLineText::class,
  1243|         ];
  1244|         $supportedLimitTypes = [
  1245|             fields\Categories::class,
  1246|             fields\Entries::class,
  1247|             fields\FileUpload::class,
  1248|             fields\MultiLineText::class,
  1249|             fields\Number::class,
  1250|             fields\Products::class,
  1251|             fields\SingleLineText::class,
  1252|             fields\Tags::class,
  1253|             fields\Users::class,
  1254|             fields\Variants::class,
  1255|             fields\subfields\AddressAutoComplete::class,
  1256|             fields\subfields\Address1::class,
  1257|             fields\subfields\Address2::class,
  1258|             fields\subfields\Address3::class,
  1259|             fields\subfields\AddressCity::class,
  1260|             fields\subfields\AddressZip::class,
  1261|             fields\subfields\AddressState::class,
  1262|             fields\subfields\AddressCountry::class,
  1263|             fields\subfields\DateYearDropdown::class,
  1264|             fields\subfields\DateMonthDropdown::class,
  1265|             fields\subfields\DateDayDropdown::class,
  1266|             fields\subfields\DateHourDropdown::class,
  1267|             fields\subfields\DateMinuteDropdown::class,
  1268|             fields\subfields\DateSecondDropdown::class,
  1269|             fields\subfields\DateAmPmDropdown::class,
  1270|             fields\subfields\DateYearNumber::class,
  1271|             fields\subfields\DateMonthNumber::class,
  1272|             fields\subfields\DateDayNumber::class,
  1273|             fields\subfields\DateHourNumber::class,
  1274|             fields\subfields\DateMinuteNumber::class,
  1275|             fields\subfields\DateSecondNumber::class,
  1276|             fields\subfields\DateAmPmNumber::class,
  1277|             fields\subfields\NamePrefix::class,
  1278|             fields\subfields\NameFirst::class,
  1279|             fields\subfields\NameMiddle::class,
  1280|             fields\subfields\NameLast::class,
  1281|         ];
  1282|         if (array_key_exists('limitType', $config)) {
  1283|             if (!in_array(static::class, $supportedLimitConfigTypes)) {
  1284|                 unset($config['limitType']);
  1285|             }
  1286|         }
  1287|         if (array_key_exists('limitAmount', $config)) {
  1288|             if (!in_array(static::class, $supportedLimitConfigTypes)) {
  1289|                 unset($config['limitAmount']);
  1290|             }
  1291|         }
  1292|         if (array_key_exists('limit', $config)) {
  1293|             if (!in_array(static::class, $supportedLimitTypes)) {
  1294|                 unset($config['limit']);
  1295|             }
  1296|         }
  1297|         if (array_key_exists('maxType', $config)) {
  1298|             if (!in_array(static::class, $supportedLimitConfigTypes)) {
  1299|                 unset($config['maxType']);
  1300|             }
  1301|         }
  1302|         if (array_key_exists('instructionsPosition', $config)) {
  1303|             if ($config['instructionsPosition'] === 'verbb\\formie\\positions\\FieldsetStart') {
  1304|                 $config['instructionsPosition'] = AboveInput::class;
  1305|             }
  1306|             if ($config['instructionsPosition'] === 'verbb\\formie\\positions\\FieldsetEnd') {
  1307|                 $config['instructionsPosition'] = BelowInput::class;
  1308|             }
  1309|         }
  1310|         if (array_key_exists('subfieldLabelPosition', $config)) {
  1311|             $config['subFieldLabelPosition'] = ArrayHelper::remove($config, 'subfieldLabelPosition');
  1312|         }
  1313|         $removedProperties = [
  1314|             'vid',
  1315|             'brandNewField',
  1316|             'hasLabel',
  1317|             'isNested',
  1318|             'isSynced',
  1319|             'allowSelfRelations',
  1320|             'localizeRelations',
  1321|             'minRelations',
  1322|             'maxRelations',
  1323|             'selectionLabel',
  1324|             'showSiteMenu',
  1325|             'targetSiteId',
  1326|             'validateRelatedElements',
  1327|             'viewMode',
  1328|             'maintainHierarchy',
  1329|             'branchLimit',
  1330|             'restrictedLocationSource',
  1331|             'restrictedLocationSubpath',
  1332|             'allowSubfolders',
  1333|             'restrictedDefaultUploadSubpath',
  1334|             'defaultUploadLocationSource',
  1335|             'defaultUploadLocationSubpath',
  1336|             'allowUploads',
  1337|             'showUnpermittedVolumes',
  1338|             'showUnpermittedFiles',
  1339|             'previewMode',
  1340|             'showCardsInGrid',
  1341|             'useSingleFolder',
  1342|             'singleUploadLocationSource',
  1343|             'singleUploadLocationSubpath',
  1344|             'allowLimit',
  1345|             'enableAutocomplete',
  1346|             'rowUid',
  1347|             'formId',
  1348|             'searchable',
  1349|             'translationMethod',
  1350|             'translationKeyFormat',
  1351|             'rowsConfig',
  1352|         ];
  1353|         foreach ($removedProperties as $removedProperty) {
  1354|             if (array_key_exists($removedProperty, $config)) {
  1355|                 unset($config[$removedProperty]);
  1356|             }
  1357|         }
  1358|     }
  1359|     private function _valueSql(?string $key): ?string
  1360|     {
  1361|         $dbType = static::dbType();
  1362|         if ($dbType === null) {
  1363|             return null;
  1364|         }
  1365|         if ($key !== null && (!is_array($dbType) || !isset($dbType[$key]))) {
  1366|             throw new InvalidArgumentException(sprintf('%s doesn’t store values under the key “%s”.', __CLASS__, $key));
  1367|         }
  1368|         $jsonPath = [$this->uid];
  1369|         if (is_array($dbType)) {
  1370|             $key ??= array_key_first($dbType);
  1371|             $jsonPath[] = $key;
  1372|             $dbType = $dbType[$key];
  1373|         }
  1374|         $db = Craft::$app->getDb();
  1375|         $qb = $db->getQueryBuilder();
  1376|         $sql = $qb->jsonExtract('formie_submissions.content', $jsonPath);
  1377|         if ($db->getIsMysql()) {
  1378|             $castType = match (Db::parseColumnType($dbType)) {
  1379|                 Schema::TYPE_CHAR,
  1380|                 Schema::TYPE_STRING,
  1381|                 'varchar' => 'CHAR(255)',
  1382|                 Schema::TYPE_BOOLEAN => 'CHAR(5)',
  1383|                 Schema::TYPE_DATE => 'DATE',
  1384|                 Schema::TYPE_DATETIME => 'DATETIME',
  1385|                 Schema::TYPE_DECIMAL => 'DECIMAL',
  1386|                 Schema::TYPE_DOUBLE => 'DOUBLE',
  1387|                 Schema::TYPE_FLOAT => 'FLOAT',
  1388|                 Schema::TYPE_TINYINT,
  1389|                 Schema::TYPE_SMALLINT,
  1390|                 Schema::TYPE_INTEGER,
  1391|                 Schema::TYPE_BIGINT => 'SIGNED',
  1392|                 SCHEMA::TYPE_TIME => 'TIME',
  1393|                 default => null,
  1394|             };
  1395|             if ($castType !== null) {
  1396|                 $length = Db::parseColumnLength($dbType);
  1397|                 if ($length) {
  1398|                     $castType = preg_replace('/\(\d+\)/', "($length)", $castType);
  1399|                 } else if ($castType === 'DECIMAL') {
  1400|                     [$precision, $scale] = Db::parseColumnPrecisionAndScale($dbType) ?? [null, null];
  1401|                     if ($precision && $scale) {
  1402|                         $castType .= "($precision,$scale)";
  1403|                     }
  1404|                 }
  1405|                 $sql = "CAST($sql AS $castType)";
  1406|             }
  1407|         }
  1408|         return $sql;
  1409|     }
  1410|     public function getName(): string
  1411|     {
  1412|         Craft::$app->getDeprecator()->log(__METHOD__, 'Formie fields’ `name` attribute has been deprecated. Use `label` instead.');
  1413|         return (string)$this->label;
  1414|     }
  1415|     public function setName(mixed $name): void
  1416|     {
  1417|         Craft::$app->getDeprecator()->log(__METHOD__, 'Formie fields’ `name` attribute has been deprecated. Use `label` instead.');
  1418|     }
  1419| }


# ====================================================================
# FILE: src/base/FieldLegacy.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-231 ---
     1| <?php
     2| namespace verbb\formie\base;
     3| use Craft;
     4| use craft\base\ElementInterface;
     5| use craft\base\PreviewableFieldInterface;
     6| use craft\elements\db\ElementQueryInterface;
     7| use craft\enums\AttributeStatus;
     8| use craft\gql\types\QueryArgument;
     9| use craft\helpers\ElementHelper;
    10| use craft\helpers\Html;
    11| use craft\helpers\UrlHelper;
    12| use craft\models\GqlSchema;
    13| use GraphQL\Type\Definition\Type;
    14| use yii\base\Component as YiiComponent;
    15| use yii\db\ExpressionInterface;
    16| use yii\db\Schema;
    17| use yii\validators\Validator;
    18| trait FieldLegacy
    19| {
    20|     public mixed $layoutElement = null;
    21|     public mixed $columnType = null;
    22|     public ?string $context = null;
    23|     public ?string $columnSuffix = null;
    24|     public static function get(int|string $id): ?static
    25|     {
    26|         return null;
    27|     }
    28|     public static function icon(): string
    29|     {
    30|         return '';
    31|     }
    32|     public static function isMultiInstance(): bool
    33|     {
    34|         return false;
    35|     }
    36|     public static function isRequirable(): bool
    37|     {
    38|         return true;
    39|     }
    40|     public static function supportedTranslationMethods(): array
    41|     {
    42|         return [];
    43|     }
    44|     public static function phpType(): string
    45|     {
    46|         return 'mixed';
    47|     }
    48|     public static function dbType(): array|string|null
    49|     {
    50|         return Schema::TYPE_TEXT;
    51|     }
    52|     public static function queryCondition(array $instances, mixed $value, array &$params): array|string|ExpressionInterface|false|null {
    53|         $valueSql = static::valueSql($instances);
    54|         if ($valueSql === null) {
    55|             return false;
    56|         }
    57|         return Db::parseParam($valueSql, $value, columnType: Schema::TYPE_JSON);
    58|     }
    59|     public function getPreviewHtml(mixed $value, ElementInterface $element): string
    60|     {
    61|         return ElementHelper::attributeHtml($value);
    62|     }
    63|     public function previewPlaceholderHtml(mixed $value, ?ElementInterface $element): string
    64|     {
    65|         if (!$this instanceof PreviewableFieldInterface) {
    66|             return '';
    67|         }
    68|         if ($value !== null) {
    69|             return $value;
    70|         }
    71|         if ($element !== null) {
    72|             return $element->getFieldValue($this->handle);
    73|         }
    74|         return $this->getUiLabel();
    75|     }
    76|     public function getId(): ?int
    77|     {
    78|         return $this->id;
    79|     }
    80|     public function getHandle(): ?string
    81|     {
    82|         return $this->handle;
    83|     }
    84|     public function getCpEditUrl(): ?string
    85|     {
    86|         return $this->id ? UrlHelper::cpUrl("settings/fields/edit/$this->id") : null;
    87|     }
    88|     public function getUiLabel(): string
    89|     {
    90|         return Craft::t('site', $this->name);
    91|     }
    92|     public function getOrientation(?ElementInterface $element): string
    93|     {
    94|         return '';
    95|     }
    96|     public function getIsTranslatable(?ElementInterface $element): bool
    97|     {
    98|         return false;
    99|     }
   100|     public function getTranslationDescription(?ElementInterface $element): ?string
   101|     {
   102|         return null;
   103|     }
   104|     public function getTranslationKey(ElementInterface $element): string
   105|     {
   106|         return '';
   107|     }
   108|     public function getStatus(ElementInterface $element): ?array
   109|     {
   110|         return null;
   111|     }
   112|     public function getInputId(): string
   113|     {
   114|         return Html::id($this->handle);
   115|     }
   116|     public function getLabelId(): string
   117|     {
   118|         return sprintf('%s-label', $this->getInputId());
   119|     }
   120|     public function useFieldset(): bool
   121|     {
   122|         return false;
   123|     }
   124|     public function getInputHtml(mixed $value, ?ElementInterface $element): string
   125|     {
   126|         return '';
   127|     }
   128|     public function getStaticHtml(mixed $value, ElementInterface $element): string
   129|     {
   130|         return '';
   131|     }
   132|     public function getElementValidationRules(): array
   133|     {
   134|         return [];
   135|     }
   136|     public function isValueEmpty(mixed $value, ElementInterface $element): bool
   137|     {
   138|         return $value === null || $value === [] || $value === '';
   139|     }
   140|     public function getSearchKeywords(mixed $value, ElementInterface $element): string
   141|     {
   142|         return '';
   143|     }
   144|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
   145|     {
   146|         return $value;
   147|     }
   148|     public function normalizeValueFromRequest(mixed $value, ?ElementInterface $element): mixed
   149|     {
   150|         return $this->normalizeValue($value, $element);
   151|     }
   152|     public function serializeValue(mixed $value, ?ElementInterface $element): mixed
   153|     {
   154|         return $value;
   155|     }
   156|     public function copyValue(ElementInterface $from, ElementInterface $to): void
   157|     {
   158|     }
   159|     public function getElementConditionRuleType(): array|string|null
   160|     {
   161|         return null;
   162|     }
   163|     public function getValueSql(?string $key = null): ?string
   164|     {
   165|         return null;
   166|     }
   167|     public function modifyElementIndexQuery(ElementQueryInterface $query): void
   168|     {
   169|     }
   170|     public function setIsFresh(?bool $isFresh = null): void
   171|     {
   172|     }
   173|     public function includeInGqlSchema(GqlSchema $schema): bool
   174|     {
   175|         return true;
   176|     }
   177|     public function getContentGqlType(): Type|array
   178|     {
   179|         return Type::string();
   180|     }
   181|     public function getContentGqlMutationArgumentType(): Type|array
   182|     {
   183|         return [
   184|             'name' => $this->handle,
   185|             'type' => Type::string(),
   186|             'description' => $this->instructions,
   187|         ];
   188|     }
   189|     public function getContentGqlQueryArgumentType(): Type|array
   190|     {
   191|         return [
   192|             'name' => $this->handle,
   193|             'type' => Type::listOf(QueryArgument::getType()),
   194|         ];
   195|     }
   196|     public function beforeElementSave(ElementInterface $element, bool $isNew): bool
   197|     {
   198|         return true;
   199|     }
   200|     public function afterElementSave(ElementInterface $element, bool $isNew): void
   201|     {
   202|     }
   203|     public function afterElementPropagate(ElementInterface $element, bool $isNew): void
   204|     {
   205|     }
   206|     public function beforeElementDelete(ElementInterface $element): bool
   207|     {
   208|         return true;
   209|     }
   210|     public function afterElementDelete(ElementInterface $element): void
   211|     {
   212|     }
   213|     public function beforeElementDeleteForSite(ElementInterface $element): bool
   214|     {
   215|         return true;
   216|     }
   217|     public function afterElementDeleteForSite(ElementInterface $element): void
   218|     {
   219|     }
   220|     public function beforeElementRestore(ElementInterface $element): bool
   221|     {
   222|         return true;
   223|     }
   224|     public function afterElementRestore(ElementInterface $element): void
   225|     {
   226|     }
   227|     public function serializeValueForDb(mixed $value, ElementInterface $element): mixed
   228|     {
   229|         return $this->serializeValue($value, $element);
   230|     }
   231| }


# ====================================================================
# FILE: src/base/OptionsField.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-387 ---
     1| <?php
     2| namespace verbb\formie\base;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\base\FieldInterface;
     6| use verbb\formie\base\Integration;
     7| use verbb\formie\base\IntegrationInterface;
     8| use verbb\formie\elements\Submission;
     9| use verbb\formie\fields\conditions\OptionsFieldConditionRule;
    10| use verbb\formie\fields\data\MultiOptionsFieldData;
    11| use verbb\formie\fields\data\OptionData;
    12| use verbb\formie\fields\data\SingleOptionFieldData;
    13| use verbb\formie\gql\arguments\OptionFieldArguments;
    14| use verbb\formie\gql\resolvers\OptionFieldResolver;
    15| use verbb\formie\gql\types\generators\FieldOptionGenerator;
    16| use verbb\formie\helpers\ArrayHelper;
    17| use verbb\formie\helpers\StringHelper;
    18| use verbb\formie\models\IntegrationField;
    19| use verbb\formie\models\Notification;
    20| use Craft;
    21| use craft\base\ElementInterface;
    22| use craft\base\PreviewableFieldInterface;
    23| use craft\helpers\Json;
    24| use yii\db\Schema;
    25| use GraphQL\Type\Definition\Type;
    26| use Throwable;
    27| abstract class OptionsField extends Field implements OptionsFieldInterface, PreviewableFieldInterface
    28| {
    29|     public static function dbType(): string
    30|     {
    31|         return Schema::TYPE_STRING;
    32|     }
    33|     public bool $multi = false;
    34|     public ?string $layout = null;
    35|     public array $options = [];
    36|     public bool $optgroups = false;
    37|     public bool $hasMultiNamespace = false;
    38|     public function __construct($config = [])
    39|     {
    40|         if (!array_key_exists('options', $config) && empty($config['options'])) {
    41|             $config['options'] = $this->getDefaultOptions();
    42|         }
    43|         $options = [];
    44|         if (isset($config['options']) && is_array($config['options'])) {
    45|             foreach ($config['options'] as $key => $option) {
    46|                 if (!is_array($option)) {
    47|                     $options[] = [
    48|                         'label' => $option,
    49|                         'value' => $key,
    50|                         'isDefault' => '',
    51|                     ];
    52|                 } elseif (!empty($option['isOptgroup'])) {
    53|                     $options[] = [
    54|                         'optgroup' => $option['label'],
    55|                     ];
    56|                 } else {
    57|                     unset($option['isOptgroup']);
    58|                     $options[] = $option;
    59|                 }
    60|             }
    61|         }
    62|         $config['options'] = $options;
    63|         unset($config['columnType'], $config['multiple']);
    64|         parent::__construct($config);
    65|     }
    66|     public function settingsAttributes(): array
    67|     {
    68|         $attributes = parent::settingsAttributes();
    69|         $attributes[] = 'options';
    70|         $attributes[] = 'multi';
    71|         $attributes[] = 'layout';
    72|         return $attributes;
    73|     }
    74|     public function options(): array
    75|     {
    76|         return $this->options;
    77|     }
    78|     public function getDefaultOptions(): array
    79|     {
    80|         return [];
    81|     }
    82|     public function allowDuplicateLabels(): bool
    83|     {
    84|         return false;
    85|     }
    86|     public function allowDuplicateValues(): bool
    87|     {
    88|         return false;
    89|     }
    90|     public function validateOptions(): void
    91|     {
    92|         $labels = [];
    93|         $values = [];
    94|         $hasDuplicateLabels = false;
    95|         $hasDuplicateValues = false;
    96|         $optgroup = '__root__';
    97|         foreach ($this->options() as &$option) {
    98|             if (array_key_exists('optgroup', $option)) {
    99|                 $optgroup = $option['optgroup'];
   100|                 continue;
   101|             }
   102|             $label = (string)$option['label'] ?? '';
   103|             $value = (string)$option['value'] ?? '';
   104|             if (isset($labels[$optgroup][$label])) {
   105|                 $option['label'] = [
   106|                     'value' => $label,
   107|                     'hasErrors' => true,
   108|                 ];
   109|                 $hasDuplicateLabels = true;
   110|             }
   111|             if (isset($values[$value])) {
   112|                 $option['value'] = [
   113|                     'value' => $value,
   114|                     'hasErrors' => true,
   115|                 ];
   116|                 $hasDuplicateValues = true;
   117|             }
   118|             $labels[$optgroup][$label] = $values[$value] = true;
   119|         }
   120|         if (!$this->allowDuplicateLabels() && $hasDuplicateLabels) {
   121|             $this->addError('options', Craft::t('app', 'All option labels must be unique.'));
   122|         }
   123|         if (!$this->allowDuplicateValues() && $hasDuplicateValues) {
   124|             $this->addError('options', Craft::t('app', 'All option values must be unique.'));
   125|         }
   126|     }
   127|     public function normalizeValue(mixed $value, ?ElementInterface $element = null): mixed
   128|     {
   129|         if ($value instanceof MultiOptionsFieldData || $value instanceof SingleOptionFieldData) {
   130|             return $value;
   131|         }
   132|         if ($value === '' && $this->multi) {
   133|             $value = [];
   134|         }
   135|         if (is_string($value) && Json::isJsonObject($value)) {
   136|             $value = Json::decodeIfJson($value);
   137|         } else if (is_string($value) && strtolower($value) === '__blank__') {
   138|             $value = '';
   139|         } else if (empty($value) && $this->isFresh($element)) {
   140|             $value = $this->defaultValue();
   141|         }
   142|         $selectedValues = [];
   143|         foreach ((array)$value as $val) {
   144|             $selectedValues[] = (string)$val;
   145|         }
   146|         $selectedBlankOption = false;
   147|         $options = [];
   148|         $optionValues = [];
   149|         $optionLabels = [];
   150|         foreach ($this->options() as $option) {
   151|             if (!isset($option['optgroup'])) {
   152|                 $selected = $this->isOptionSelected($option, $value, $selectedValues, $selectedBlankOption);
   153|                 $options[] = new OptionData($option['label'], (string)$option['value'], $selected, true);
   154|                 $optionValues[] = (string)$option['value'];
   155|                 $optionLabels[] = (string)$option['label'];
   156|             }
   157|         }
   158|         if ($this->multi) {
   159|             $selectedOptions = [];
   160|             foreach ($selectedValues as $selectedValue) {
   161|                 $index = array_search($selectedValue, $optionValues, true);
   162|                 $valid = $index !== false;
   163|                 $label = $valid ? $optionLabels[$index] : null;
   164|                 $selectedOptions[] = new OptionData($label, $selectedValue, true, $valid);
   165|             }
   166|             $value = new MultiOptionsFieldData($selectedOptions);
   167|         } else if (!empty($selectedValues)) {
   168|             $selectedValue = reset($selectedValues);
   169|             $index = array_search($selectedValue, $optionValues, false);
   170|             $valid = $index !== false;
   171|             $label = $valid ? $optionLabels[$index] : null;
   172|             $value = new SingleOptionFieldData($label, $selectedValue, true, $valid);
   173|         } else {
   174|             $value = new SingleOptionFieldData(null, null, true, false);
   175|         }
   176|         $value->setOptions($options);
   177|         return $value;
   178|     }
   179|     public function serializeValue(mixed $value, ?ElementInterface $element = null): mixed
   180|     {
   181|         if ($value instanceof MultiOptionsFieldData) {
   182|             $serialized = [];
   183|             foreach ($value as $selectedValue) {
   184|                 /** @var OptionData $selectedValue */
   185|                 $serialized[] = $selectedValue->value;
   186|             }
   187|             return $serialized;
   188|         } else if ($value instanceof SingleOptionFieldData) {
   189|             return $value->value;
   190|         }
   191|         return parent::serializeValue($value, $element);
   192|     }
   193|     public function getElementConditionRuleType(): array|string|null
   194|     {
   195|         return OptionsFieldConditionRule::class;
   196|     }
   197|     public function getElementValidationRules(): array
   198|     {
   199|         $range = parent::getElementValidationRules();
   200|         foreach ($this->options() as $option) {
   201|             if (!isset($option['optgroup'])) {
   202|                 $range[] = (string)$option['value'];
   203|             }
   204|         }
   205|         $rules[] = ['in', 'range' => $range, 'allowArray' => $this->multi];
   206|         return $rules;
   207|     }
   208|     public function isValueEmpty(mixed $value, ?ElementInterface $element): bool
   209|     {
   210|         /** @var MultiOptionsFieldData|SingleOptionFieldData $value */
   211|         if ($value instanceof SingleOptionFieldData) {
   212|             return $value->value === null || $value->value === '';
   213|         }
   214|         if ($value instanceof MultiOptionsFieldData) {
   215|             return count($value) === 0;
   216|         }
   217|         return parent::isValueEmpty($value, $element);
   218|     }
   219|     public function getPreviewHtml(mixed $value, ElementInterface $element): string
   220|     {
   221|         if ($this->multi) {
   222|             /** @var MultiOptionsFieldData $value */
   223|             $labels = [];
   224|             foreach ($value as $option) {
   225|                 /** @var OptionData $option */
   226|                 if ($option->value) {
   227|                     $labels[] = Craft::t('site', $option->label);
   228|                 }
   229|             }
   230|             return implode(', ', $labels);
   231|         }
   232|         /** @var SingleOptionFieldData $value */
   233|         return $value->value ? Craft::t('site', (string)$value->label) : '';
   234|     }
   235|     public function getIsMultiOptionsField(): bool
   236|     {
   237|         return $this->multi;
   238|     }
   239|     public function getSettingGqlTypes(): array
   240|     {
   241|         return array_merge(parent::getSettingGqlTypes(), [
   242|             'multi' => [
   243|                 'name' => 'multi',
   244|                 'type' => Type::boolean(),
   245|             ],
   246|             'layout' => [
   247|                 'name' => 'layout',
   248|                 'type' => Type::string(),
   249|             ],
   250|             'options' => [
   251|                 'name' => 'options',
   252|                 'type' => Type::listOf(FieldOptionGenerator::generateType()),
   253|                 'resolve' => function($field) {
   254|                     return $field->options();
   255|                 },
   256|             ],
   257|         ]);
   258|     }
   259|     public function getContentGqlType(): Type|array
   260|     {
   261|         return [
   262|             'name' => $this->handle,
   263|             'type' => $this->multi ? Type::listOf(Type::string()) : Type::string(),
   264|             'args' => OptionFieldArguments::getArguments(),
   265|             'resolve' => OptionFieldResolver::class . '::resolve',
   266|         ];
   267|     }
   268|     public function getContentGqlMutationArgumentType(): Type|array
   269|     {
   270|         $values = [];
   271|         foreach ($this->options() as $option) {
   272|             if (!isset($option['optgroup'])) {
   273|                 $values[] = '“' . $option['value'] . '”';
   274|             }
   275|         }
   276|         return [
   277|             'name' => $this->handle,
   278|             'type' => $this->multi ? Type::listOf(Type::string()) : Type::string(),
   279|             'description' => Craft::t('app', 'The allowed values are [{values}]', ['values' => implode(', ', $values)]),
   280|         ];
   281|     }
   282|     abstract protected function optionsSettingLabel(): string;
   283|     protected function defineRules(): array
   284|     {
   285|         $rules = parent::defineRules();
   286|         $rules[] = ['options', 'validateOptions'];
   287|         return $rules;
   288|     }
   289|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
   290|     {
   291|         if ($value instanceof MultiOptionsFieldData) {
   292|             return implode(', ', array_map(function($item) {
   293|                 return $item->value;
   294|             }, (array)$value));
   295|         }
   296|         return $value->value ?? '';
   297|     }
   298|     protected function defineValueForIntegration(mixed $value, IntegrationField $integrationField, IntegrationInterface $integration, ElementInterface $element = null, string $fieldKey = ''): mixed
   299|     {
   300|         if ($integrationField->getType() === IntegrationField::TYPE_ARRAY) {
   301|             if ($value instanceof MultiOptionsFieldData) {
   302|                 return array_map(function($item) {
   303|                     return $item->value;
   304|                 }, (array)$value);
   305|             }
   306|             return [$value->value];
   307|         }
   308|         return parent::defineValueForIntegration($value, $integrationField, $integration, $element);
   309|     }
   310|     protected function defineValueForSummary(mixed $value, ElementInterface $element = null): string
   311|     {
   312|         if ($value instanceof MultiOptionsFieldData) {
   313|             return implode(', ', array_map(function($item) {
   314|                 return $item->label;
   315|             }, (array)$value));
   316|         }
   317|         return $value->label ?? '';
   318|     }
   319|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
   320|     {
   321|         if ($value instanceof SingleOptionFieldData) {
   322|             return $this->emailValue === 'label' ? $value->label : $value->value;
   323|         }
   324|         return parent::defineValueForVariable($value, $submission, $notification);
   325|     }
   326|     protected function getPredefinedOptions(): array
   327|     {
   328|         return Formie::$plugin->getPredefinedOptions()->getPredefinedOptions();
   329|     }
   330|     protected function setPrePopulatedValue(mixed $value): mixed
   331|     {
   332|         if ($this->multi) {
   333|             return explode(',', $value);
   334|         }
   335|         return parent::setPrePopulatedValue($value);
   336|     }
   337|     protected function isOptionSelected(array $option, mixed $value, array &$selectedValues, bool &$selectedBlankOption): bool
   338|     {
   339|         return in_array((string)$option['value'], $selectedValues, true);
   340|     }
   341|     protected function translatedOptions(): array
   342|     {
   343|         $translatedOptions = [];
   344|         foreach ($this->options() as $option) {
   345|             if (isset($option['optgroup'])) {
   346|                 $translatedOptions[] = [
   347|                     'optgroup' => Craft::t('formie', $option['optgroup']),
   348|                 ];
   349|             } else {
   350|                 $translatedOptions[] = [
   351|                     'label' => Craft::t('formie', $option['label']),
   352|                     'value' => (string)$option['value'],
   353|                 ];
   354|             }
   355|         }
   356|         return $translatedOptions;
   357|     }
   358|     protected function defaultValue(): array|string|null
   359|     {
   360|         if ($this->multi) {
   361|             $defaultValues = [];
   362|             foreach ($this->options() as $option) {
   363|                 if (!empty($option['isDefault'])) {
   364|                     $defaultValues[] = (string)$option['value'];
   365|                 }
   366|             }
   367|             return $defaultValues;
   368|         }
   369|         foreach ($this->options() as $option) {
   370|             if (!empty($option['isDefault'])) {
   371|                 return (string)$option['value'];
   372|             }
   373|         }
   374|         return null;
   375|     }
   376|     protected function getFieldInputOptionValue(array $context = [])
   377|     {
   378|         $options = $context['fieldOptions'] ?? [];
   379|         $option = $context['option'] ?? null;
   380|         $optionIndex = array_search($option, $options);
   381|         $optionValue = $context['option']['value'] ?? '';
   382|         if ($optionValue && $optionIndex !== false) {
   383|             $optionValue .= '-' . $optionIndex;
   384|         }
   385|         return StringHelper::toKebabCase($optionValue);
   386|     }
   387| }


# ====================================================================
# FILE: src/base/SubField.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-131 ---
     1| <?php
     2| namespace verbb\formie\base;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Integration;
     5| use verbb\formie\base\IntegrationInterface;
     6| use verbb\formie\elements\Submission;
     7| use verbb\formie\helpers\ArrayHelper;
     8| use verbb\formie\helpers\StringHelper;
     9| use verbb\formie\helpers\Variables;
    10| use verbb\formie\events\ModifyNestedFieldLayoutEvent;
    11| use verbb\formie\models\FieldLayout;
    12| use verbb\formie\models\FieldLayoutRow;
    13| use verbb\formie\models\IntegrationField;
    14| use verbb\formie\models\Notification;
    15| use Craft;
    16| use craft\base\ElementInterface;
    17| use GraphQL\Type\Definition\Type;
    18| abstract class SubField extends SingleNestedField implements SubFieldInterface
    19| {
    20|     public ?string $subFieldLabelPosition = null;
    21|     private ?FieldLayout $_fieldLayout = null;
    22|     public function hasSubFields(): bool
    23|     {
    24|         return true;
    25|     }
    26|     public function hasNestedFields(): bool
    27|     {
    28|         return false;
    29|     }
    30|     public function hasFieldLayout(): bool
    31|     {
    32|         return $this->hasSubFields();
    33|     }
    34|     public function settingsAttributes(): array
    35|     {
    36|         $attributes = parent::settingsAttributes();
    37|         $attributes[] = 'subFieldLabelPosition';
    38|         return $attributes;
    39|     }
    40|     public function getSubFields(): array
    41|     {
    42|         return $this->defineSubFields();
    43|     }
    44|     public function getDefaultFieldLayout(): FieldLayout
    45|     {
    46|         $fieldLayout = new FieldLayout();
    47|         $fieldLayout->setPages([['rows' => $this->getSubFields()]]);
    48|         $event = new ModifyNestedFieldLayoutEvent([
    49|             'fieldLayout' => $fieldLayout,
    50|         ]);
    51|         $this->trigger(static::EVENT_MODIFY_NESTED_FIELD_LAYOUT, $event);
    52|         return $event->fieldLayout;
    53|     }
    54|     public function getFormBuilderSettings(): array
    55|     {
    56|         $settings = parent::getFormBuilderSettings();
    57|         $fieldLayout = $this->getDefaultFieldLayout();
    58|         if (!$settings['rows']) {
    59|             $settings['rows'] = $fieldLayout->getFormBuilderConfig()[0]['rows'] ?? [];
    60|         } else {
    61|             $defaultFields = ArrayHelper::getColumn($fieldLayout->getFields(), 'handle');
    62|             $currentFields = ArrayHelper::getColumn($this->getFieldLayout()->getFields(), 'handle');
    63|             foreach ($settings['rows'] as $rowKey => $row) {
    64|                 foreach ($row['fields'] as $fieldKey => $field) {
    65|                     $handle = $field['settings']['handle'] ?? null;
    66|                     if (!$handle || !in_array($handle, $defaultFields)) {
    67|                         unset($settings['rows'][$rowKey]['fields'][$fieldKey]);
    68|                     }
    69|                 }
    70|                 if (!$settings['rows'][$rowKey]['fields']) {
    71|                     unset($settings['rows'][$rowKey]);
    72|                 }
    73|             }
    74|             $settings['rows'] = array_values($settings['rows']);
    75|             $subFieldRows = $fieldLayout->getFormBuilderConfig()[0]['rows'] ?? [];
    76|             foreach ($subFieldRows as $rowKey => $row) {
    77|                 foreach ($row['fields'] as $fieldKey => $field) {
    78|                     $handle = $field['settings']['handle'] ?? null;
    79|                     if (!$handle || !in_array($handle, $currentFields)) {
    80|                         $newRow = $row;
    81|                         $newRow['fields'] = [$field];
    82|                         array_splice($settings['rows'], $rowKey, 0, [$newRow]);
    83|                     }
    84|                 }
    85|             }
    86|         }
    87|         return $settings;
    88|     }
    89|     public function getSettingGqlTypes(): array
    90|     {
    91|         return array_merge(parent::getSettingGqlTypes(), [
    92|             'subFieldLabelPosition' => [
    93|                 'name' => 'subFieldLabelPosition',
    94|                 'type' => Type::string(),
    95|             ],
    96|         ]);
    97|     }
    98|     protected function defineRules(): array
    99|     {
   100|         $rules = parent::defineRules();
   101|         $rules[] = [
   102|             ['subFieldLabelPosition'],
   103|             'in',
   104|             'range' => Formie::$plugin->getFields()->getLabelPositions(),
   105|             'skipOnEmpty' => true,
   106|         ];
   107|         return $rules;
   108|     }
   109|     protected function defineSubFields(): array
   110|     {
   111|         return [];
   112|     }
   113|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
   114|     {
   115|         $values = [
   116|             '__toString' => StringHelper::toString($value),
   117|         ];
   118|         foreach ($this->getFields() as $subField) {
   119|             $value = $submission->getFieldValue($subField->fieldKey);
   120|             $fieldValues = Variables::getParsedFieldValue($subField, $value, $submission, $notification);
   121|             if (is_array($fieldValues)) {
   122|                 foreach ($fieldValues as $key => $fieldValue) {
   123|                     $values[$subField->handle][$key] = $fieldValue;
   124|                 }
   125|             } else {
   126|                 $values[$subField->handle] = $fieldValues;
   127|             }
   128|         }
   129|         return $values;
   130|     }
   131| }


# ====================================================================
# FILE: src/console/controllers/FormsController.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-248 ---
     1| <?php
     2| namespace verbb\formie\console\controllers;
     3| use verbb\formie\elements\Form;
     4| use verbb\formie\helpers\ImportExportHelper;
     5| use verbb\formie\jobs\ImportForm;
     6| use verbb\formie\Formie;
     7| use Craft;
     8| use craft\console\Controller;
     9| use craft\helpers\Db;
    10| use craft\helpers\Console;
    11| use craft\helpers\Json;
    12| use craft\helpers\Queue;
    13| use craft\helpers\FileHelper;
    14| use Throwable;
    15| use yii\console\ExitCode;
    16| /**
    17|  * Manages Formie Forms.
    18|  */
    19| class FormsController extends Controller
    20| {
    21|     /**
    22|      * @var string form ID as a comma-separated list
    23|      */
    24|     public ?string $formId = null;
    25|     /**
    26|      * @var string form handle as a comma-separated list
    27|      */
    28|     public ?string $formHandle = null;
    29|     /**
    30|      * @var bool Create a new form, prevent updating an existing form
    31|      */
    32|     public bool $create = false;
    33|     public function options($actionID): array
    34|     {
    35|         $options = parent::options($actionID);
    36|         switch ($actionID) {
    37|             case 'delete':
    38|                 $options[] = 'formId';
    39|                 $options[] = 'formHandle';
    40|                 break;
    41|             case 'import':
    42|             case 'import-all':
    43|                 $options[] = 'create';
    44|                 break;
    45|         }
    46|         return $options;
    47|     }
    48|     /**
    49|      * Delete Formie forms.
    50|      */
    51|     public function actionDelete(): int
    52|     {
    53|         $formIds = null;
    54|         if ($this->formId !== null) {
    55|             $formIds = explode(',', $this->formId);
    56|         }
    57|         if ($this->formHandle !== null) {
    58|             $formHandle = explode(',', $this->formHandle);
    59|             $formIds = Form::find()->handle($formHandle)->ids();
    60|         }
    61|         if (!$this->formId && !$this->formHandle) {
    62|             $this->stderr('You must provide either a --form-id or --form-handle option.' . PHP_EOL, Console::FG_RED);
    63|             return ExitCode::UNSPECIFIED_ERROR;
    64|         }
    65|         if (!$formIds) {
    66|             $this->stderr('Unable to find any matching forms.' . PHP_EOL, Console::FG_RED);
    67|             return ExitCode::UNSPECIFIED_ERROR;
    68|         }
    69|         foreach ($formIds as $formId) {
    70|             $query = Form::find()->id($formId);
    71|             $count = (int)$query->count();
    72|             if ($count === 0) {
    73|                 $this->stdout('No forms exist for that criteria.' . PHP_EOL, Console::FG_YELLOW);
    74|                 continue;
    75|             }
    76|             $elementsText = $count === 1 ? 'form' : 'forms';
    77|             $this->stdout("Deleting $count $elementsText for form $formId ..." . PHP_EOL, Console::FG_YELLOW);
    78|             $elementsService = Craft::$app->getElements();
    79|             foreach (Db::each($query) as $element) {
    80|                 $elementsService->deleteElement($element);
    81|                 $this->stdout("Deleted form $element->id ..." . PHP_EOL, Console::FG_GREEN);
    82|             }
    83|         }
    84|         return ExitCode::OK;
    85|     }
    86|     /**
    87|      * List all available Formie forms that can be exported or imported.
    88|      */
    89|     public function actionList($folderPath = null): int
    90|     {
    91|         $path = $folderPath ?? $this->getExportPath();
    92|         try {
    93|             $files = FileHelper::findFiles($path, ['only' => ['*.json']]);
    94|         } catch (\Throwable $th) {
    95|             $this->stderr("The export directory is empty or does not exist." . PHP_EOL, Console::FG_RED);
    96|             return ExitCode::UNSPECIFIED_ERROR;
    97|         }
    98|         if (!empty($files)) {
    99|             $listEntries[] = [
   100|                 'title' => 'JSON to import:',
   101|                 'entriesList' => array_map(function ($file) {
   102|                     return [
   103|                         'name' => $file,
   104|                         'title' => ''
   105|                     ];
   106|                 }, $files)
   107|             ];
   108|         }
   109|         $allForms = Formie::$plugin->getForms()->getAllForms();
   110|         if (!empty($allForms)) {
   111|             $listEntries[] = [
   112|                 'title' => 'Existing forms:',
   113|                 'entriesList' => array_map(function ($form) {
   114|                     return [
   115|                         'name' => "[$form->id] $form->handle",
   116|                         'title' => $form->title
   117|                     ];
   118|                 }, $allForms)
   119|             ];
   120|         }
   121|         foreach ($listEntries as $entries) {
   122|             $this->stdout($entries['title'] . PHP_EOL, Console::FG_YELLOW);
   123|             $handleMaxLen = max(array_map('strlen', array_column($entries['entriesList'], 'name')));
   124|             foreach ($entries['entriesList'] as $entry) {
   125|                 $this->stdout("- " . $entry['name'], Console::FG_GREEN);
   126|                 $this->stdout(Console::moveCursorTo($handleMaxLen + 5));
   127|                 $this->stdout($entry['title'] . PHP_EOL);
   128|             }
   129|         }
   130|         return ExitCode::OK;
   131|     }
   132|     /**
   133|      * Export Formie forms as JSON. Accepts comma-separated lists of form IDs and/or handles.
   134|      */
   135|     public function actionExport($idsOrHandles = null): int
   136|     {
   137|         $formIds = null;
   138|         if ($idsOrHandles === null) {
   139|             $this->stderr('No arguments provided' . PHP_EOL, Console::FG_RED);
   140|             return ExitCode::UNSPECIFIED_ERROR;
   141|         }
   142|         foreach (explode(',', $idsOrHandles) as $idOrHandle) {
   143|             if (is_numeric($idOrHandle)) {
   144|                 $formIds[] = $idOrHandle;
   145|             } else {
   146|                 $formIds[] = Form::find()->handle($idOrHandle)->one()->id ?? null;
   147|             }
   148|         }
   149|         if (!$formIds) {
   150|             $this->stderr('Unable to find any matching forms.' . PHP_EOL, Console::FG_RED);
   151|             return ExitCode::UNSPECIFIED_ERROR;
   152|         }
   153|         $query = Form::find()->id($formIds);
   154|         $count = (int)$query->count();
   155|         if ($count === 0) {
   156|             $this->stdout('No forms exist for that criteria.' . PHP_EOL, Console::FG_YELLOW);
   157|         }
   158|         $elementsText = $count === 1 ? 'form' : 'forms';
   159|         $this->stdout("Exporting $count $elementsText ..." . PHP_EOL, Console::FG_YELLOW);
   160|         foreach (Db::each($query) as $element) {
   161|             try {
   162|                 $formExport = ImportExportHelper::generateFormExport($element);
   163|                 $json = Json::encode($formExport, JSON_PRETTY_PRINT);
   164|                 $exportPath = $this->generateExportPathByHandle($element->handle);
   165|                 FileHelper::writeToFile($exportPath, $json);
   166|                 $this->stdout("Exporting form $element->id to $exportPath" . PHP_EOL, Console::FG_GREEN);
   167|             } catch (Throwable $e) {
   168|                 $this->stderr("Unable to export form $element->id." . PHP_EOL, Console::FG_RED);
   169|                 return ExitCode::UNSPECIFIED_ERROR;
   170|             }
   171|         }
   172|         return ExitCode::OK;
   173|     }
   174|     /**
   175|      * Import a Formie form JSON from a path.
   176|      */
   177|     public function actionImport($fileLocation = null): int
   178|     {
   179|         if ($fileLocation === null) {
   180|             $this->stderr('You must provide a path to a JSON file.' . PHP_EOL, Console::FG_RED);
   181|             return ExitCode::UNSPECIFIED_ERROR;
   182|         }
   183|         if (!is_file($fileLocation)) {
   184|             $fileLocation = $this->getExportPath() . DIRECTORY_SEPARATOR  . $fileLocation;
   185|             if (!is_file($fileLocation)) {
   186|                 $this->stderr("No file exists at the given path." . PHP_EOL, Console::FG_RED);
   187|                 return ExitCode::UNSPECIFIED_ERROR;
   188|             }
   189|         }
   190|         if (strtolower(pathinfo($fileLocation, PATHINFO_EXTENSION)) !== 'json') {
   191|             $this->stderr("The file is not of type JSON." . PHP_EOL, Console::FG_RED);
   192|             return ExitCode::UNSPECIFIED_ERROR;
   193|         }
   194|         try {
   195|             $json = Json::decode(file_get_contents($fileLocation));
   196|         } catch (\Exception $e) {
   197|             $this->stderr("Failed to decode JSON from the file." . PHP_EOL, Console::FG_RED);
   198|             return ExitCode::UNSPECIFIED_ERROR;
   199|         }
   200|         $formAction = $this->create ? 'create' : 'update';
   201|         $form = ImportExportHelper::importFormFromJson($json, $formAction);
   202|         if ($form->getConsolidatedErrors()) {
   203|             $this->stderr("Unable to import the form." . PHP_EOL, Console::FG_RED);
   204|             $errors = Json::encode($form->getConsolidatedErrors());
   205|             $this->stderr("Errors: $errors" . PHP_EOL, Console::FG_RED);
   206|             return ExitCode::UNSPECIFIED_ERROR;
   207|         }
   208|         $this->stdout("Form $form->handle has be {$formAction}d." . PHP_EOL, Console::FG_GREEN);
   209|         return ExitCode::OK;
   210|     }
   211|     /**
   212|      * Import all Formie JSON from a folder.
   213|      */
   214|     public function actionImportAll($folderPath = null): int
   215|     {
   216|         $path = $folderPath ?? $this->getExportPath();
   217|         try {
   218|             $files = FileHelper::findFiles($path, ['only' => ['*.json']]);
   219|         } catch (\Throwable $th) {
   220|             $this->stderr("The export directory is empty or does not exist." . PHP_EOL, Console::FG_RED);
   221|             return ExitCode::UNSPECIFIED_ERROR;
   222|         }
   223|         if (empty($files)) {
   224|             $this->stderr("No JSON files found in folder $path." . PHP_EOL, Console::FG_RED);
   225|             return ExitCode::UNSPECIFIED_ERROR;
   226|         }
   227|         foreach ($files as $file) {
   228|             Queue::push(new ImportForm(
   229|                 [
   230|                     'fileLocation' => $file,
   231|                     'formAction' => $this->create ? 'create' : 'update'
   232|                 ]
   233|             ));
   234|             $basename = basename($file);
   235|             $this->stdout("File '$basename' has been added to the import queue." . PHP_EOL, Console::FG_GREEN);
   236|         }
   237|         return ExitCode::OK;
   238|     }
   239|     private function generateExportPathByHandle($handle): string
   240|     {
   241|         return $this->getExportPath() . DIRECTORY_SEPARATOR . "formie-$handle.json";
   242|     }
   243|     private function getExportPath(): string
   244|     {
   245|         $settings = Formie::$plugin->getSettings();
   246|         return $settings->getAbsoluteDefaultExportFolder();
   247|     }
   248| }


# ====================================================================
# FILE: src/controllers/EmailController.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-80 ---
     1| <?php
     2| namespace verbb\formie\controllers;
     3| use verbb\formie\Formie;
     4| use verbb\formie\elements\Form;
     5| use verbb\formie\elements\Submission;
     6| use verbb\formie\helpers\StringHelper;
     7| use verbb\formie\models\Notification;
     8| use Craft;
     9| use craft\web\Controller;
    10| use yii\web\Response;
    11| class EmailController extends Controller
    12| {
    13|     public function actionPreview(): Response
    14|     {
    15|         $this->requirePostRequest();
    16|         $request = $this->request;
    17|         $notification = new Notification();
    18|         $submission = new Submission();
    19|         $this->_populateFromPost($notification, $submission);
    20|         $emailRender = Formie::$plugin->getEmails()->renderEmail($notification, $submission);
    21|         if (isset($emailRender['error']) && $emailRender['error']) {
    22|             Formie::error($emailRender['error']);
    23|             if (isset($emailRender['exception']) && $emailRender['exception']) {
    24|                 Formie::error($emailRender['exception']);
    25|             }
    26|             return $this->asJson([
    27|                 'error' => $emailRender['error'],
    28|             ]);
    29|         }
    30|         $email = $emailRender['email'];
    31|         return $this->asJson([
    32|             'from' => $email->getFrom(),
    33|             'to' => $email->getTo(),
    34|             'bcc' => $email->getBcc(),
    35|             'cc' => $email->getCc(),
    36|             'sender' => $email->getSender(),
    37|             'replyTo' => $email->getReplyTo(),
    38|             'subject' => $email->getSubject(),
    39|             'body' => StringHelper::cleanString($email->getSymfonyEmail()->getHtmlBody()),
    40|         ]);
    41|     }
    42|     public function actionSendTestEmail(): Response
    43|     {
    44|         $this->requirePostRequest();
    45|         $request = $this->request;
    46|         $notification = new Notification();
    47|         $submission = new Submission();
    48|         $this->_populateFromPost($notification, $submission);
    49|         $notification->to = $request->getParam('to');
    50|         $sentResponse = Formie::$plugin->getEmails()->sendEmail($notification, $submission, null, false);
    51|         $success = $sentResponse['success'] ?? false;
    52|         $error = $sentResponse['error'] ?? false;
    53|         return $this->asJson([
    54|             'success' => $success,
    55|             'error' => $error,
    56|         ]);
    57|     }
    58|     private function _populateFromPost(Notification $notification, Submission $submission): void
    59|     {
    60|         $request = $this->request;
    61|         $formId = $request->getParam('formId');
    62|         $handle = $request->getParam('handle');
    63|         if ($notificationParams = $request->getParam('notification')) {
    64|             $notification->setAttributes($notificationParams, false);
    65|         }
    66|         $notification->enabled = StringHelper::toBoolean((string)$notification->enabled);
    67|         $notification->attachFiles = StringHelper::toBoolean((string)$notification->attachFiles);
    68|         $notification->attachPdf = StringHelper::toBoolean((string)$notification->attachPdf);
    69|         $notification->enableConditions = StringHelper::toBoolean((string)$notification->enableConditions);
    70|         if (!$formId) {
    71|             $form = new Form();
    72|             $stencil = Formie::$plugin->getStencils()->getStencilByHandle($handle);
    73|             $stencil->applyStencilToForm($form);
    74|         } else {
    75|             $form = Formie::$plugin->getForms()->getFormById($formId);
    76|         }
    77|         $submission->setForm($form);
    78|         Formie::$plugin->getSubmissions()->populateFakeSubmission($submission);
    79|     }
    80| }


# ====================================================================
# FILE: src/controllers/FormsController.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-332 ---
     1| <?php
     2| namespace verbb\formie\controllers;
     3| use verbb\formie\Formie;
     4| use verbb\formie\elements\Form;
     5| use verbb\formie\helpers\HandleHelper;
     6| use verbb\formie\helpers\ArrayHelper;
     7| use verbb\formie\helpers\Plugin;
     8| use verbb\formie\helpers\StringHelper;
     9| use verbb\formie\helpers\Table;
    10| use verbb\formie\helpers\Variables;
    11| use verbb\formie\models\Stencil;
    12| use verbb\formie\models\StencilData;
    13| use Craft;
    14| use craft\db\Query;
    15| use craft\enums\CmsEdition;
    16| use craft\helpers\DateTimeHelper;
    17| use craft\helpers\Json;
    18| use craft\helpers\Session;
    19| use craft\helpers\UrlHelper;
    20| use craft\models\Site;
    21| use craft\web\Controller;
    22| use yii\base\Exception;
    23| use yii\web\ForbiddenHttpException;
    24| use yii\web\NotFoundHttpException;
    25| use yii\web\Response;
    26| use Throwable;
    27| class FormsController extends Controller
    28| {
    29|     protected array|bool|int $allowAnonymous = ['refresh-tokens'];
    30|     public function actionIndex(): Response
    31|     {
    32|         $this->requirePermission('formie-accessForms');
    33|         return $this->renderTemplate('formie/forms/index', []);
    34|     }
    35|     public function actionNew(Form $form = null): Response
    36|     {
    37|         $this->requirePermission('formie-createForms');
    38|         $formHandles = ArrayHelper::getColumn(Form::find()->all(), 'handle');
    39|         $stencilArray = Formie::$plugin->getStencils()->getStencilArray();
    40|         $applyStencilId = $this->request->getParam('applyStencilId');
    41|         $variables = compact('formHandles', 'form', 'stencilArray', 'applyStencilId');
    42|         if (!$variables['form']) {
    43|             $variables['form'] = new Form();
    44|         }
    45|         $variables['reservedHandles'] = Formie::$plugin->getFields()->getReservedHandles();
    46|         $variables['maxFormHandleLength'] = HandleHelper::getMaxFormHandle();
    47|         Plugin::registerAsset('src/js/formie-form-new.js');
    48|         if (Craft::$app->edition === CmsEdition::Team && !Craft::$app->getUser()->checkPermission('formie-manageForms')) {
    49|             return $this->renderTemplate('formie/forms/_team');
    50|         }
    51|         return $this->renderTemplate('formie/forms/_new', $variables);
    52|     }
    53|     public function actionEdit(int $formId = null, Form $form = null): Response
    54|     {
    55|         $variables = compact('formId', 'form');
    56|         $this->_prepareVariableArray($variables);
    57|         if (!empty($variables['form']->id)) {
    58|             $variables['title'] = $variables['form']->title;
    59|             $formsPermission = Craft::$app->getUser()->checkPermission('formie-manageForms');
    60|             $formPermission = Craft::$app->getUser()->checkPermission('formie-manageForms:' . $variables['form']->uid);
    61|             if (!$formsPermission && !$formPermission) {
    62|                 throw new ForbiddenHttpException('User is not permitted to perform this action');
    63|             }
    64|         } else {
    65|             $variables['title'] = Craft::t('formie', 'Create a new form');
    66|         }
    67|         $variables['baseCpEditUrl'] = 'formie/forms/edit/{id}';
    68|         $variables['continueEditingUrl'] = $variables['baseCpEditUrl'];
    69|         Plugin::registerAsset('src/js/formie-form.js');
    70|         return $this->renderTemplate('formie/forms/_edit', $variables);
    71|     }
    72|     public function actionSave(): ?Response
    73|     {
    74|         $this->requirePostRequest();
    75|         $settings = Formie::$plugin->getSettings();
    76|         $form = Formie::$plugin->getForms()->buildFormFromPost();
    77|         $duplicate = (bool)$this->request->getParam('duplicate');
    78|         if (!$form->uid) {
    79|             $this->requirePermission('formie-createForms');
    80|         } else {
    81|             $formsPermission = Craft::$app->getUser()->checkPermission('formie-manageForms');
    82|             $formPermission = Craft::$app->getUser()->checkPermission('formie-manageForms:' . $form->uid);
    83|             if (!$formsPermission && !$formPermission) {
    84|                 throw new ForbiddenHttpException('User is not permitted to perform this action');
    85|             }
    86|         }
    87|         if ($duplicate) {
    88|             $duplicatedForm = Craft::$app->getElements()->duplicateElement($form, $form->getDuplicateAttributes());
    89|             if (!$duplicatedForm) {
    90|                 Formie::error('Couldn’t duplicate form - {e}.', ['e' => Json::encode($form->getConsolidatedErrors())]);
    91|                 if ($this->request->getAcceptsJson()) {
    92|                     return $this->asJson([
    93|                         'success' => false,
    94|                         'config' => $form->getFormBuilderConfig(),
    95|                         'notifications' => $form->getNotificationsConfig(),
    96|                     ]);
    97|                 }
    98|                 $this->setFailFlash(Craft::t('formie', 'Couldn’t duplicate form.'));
    99|                 Craft::$app->getUrlManager()->setRouteParams([
   100|                     'form' => $form,
   101|                 ]);
   102|                 return null;
   103|             }
   104|         } else {
   105|             if (!Craft::$app->getElements()->saveElement($form)) {
   106|                 Formie::error('Couldn’t save form - {e}.', ['e' => Json::encode($form->getConsolidatedErrors())]);
   107|                 if ($this->request->getAcceptsJson()) {
   108|                     return $this->asJson([
   109|                         'success' => false,
   110|                         'config' => $form->getFormBuilderConfig(),
   111|                         'notifications' => $form->getNotificationsConfig(),
   112|                     ]);
   113|                 }
   114|                 $this->setFailFlash(Craft::t('formie', 'Couldn’t save form.'));
   115|                 Craft::$app->getUrlManager()->setRouteParams([
   116|                     'form' => $form,
   117|                 ]);
   118|                 return null;
   119|             }
   120|         }
   121|         $savedForm = ($duplicate) ? $duplicatedForm : $form;
   122|         $this->_updateFormPermission($savedForm);
   123|         if ($this->request->getAcceptsJson()) {
   124|             return $this->asJson([
   125|                 'success' => true,
   126|                 'config' => $form->getFormBuilderConfig(),
   127|                 'notifications' => $form->getNotificationsConfig(),
   128|                 'redirect' => ($duplicate) ? $duplicatedForm->getCpEditUrl() : null,
   129|             ]);
   130|         }
   131|         $this->setSuccessFlash(Craft::t('formie', 'Form saved.'));
   132|         return $this->redirectToPostedUrl($savedForm);
   133|     }
   134|     public function actionSaveAsStencil(): ?Response
   135|     {
   136|         $this->requirePostRequest();
   137|         $stencils = Formie::$plugin->getStencils()->getAllStencils();
   138|         $stencilHandles = ArrayHelper::getColumn($stencils, 'handle');
   139|         $handle = $this->request->getParam('handle');
   140|         $stencil = new Stencil();
   141|         $stencil->name = $this->request->getParam('title');
   142|         $stencil->handle = HandleHelper::getUniqueHandle($stencilHandles, $handle);
   143|         if ($templateId = $this->request->getParam('templateId')) {
   144|             $template = Formie::$plugin->getFormTemplates()->getTemplateById($templateId);
   145|             $stencil->setTemplate($template);
   146|         }
   147|         if ($statusId = $this->request->getParam('defaultStatusId')) {
   148|             $status = Formie::$plugin->getStatuses()->getStatusById($statusId);
   149|             $stencil->setDefaultStatus($status);
   150|         }
   151|         $stencil->data = new StencilData();
   152|         $stencil->data->userDeletedAction = $this->request->getParam('userDeletedAction', $stencil->data->userDeletedAction);
   153|         $stencil->data->fileUploadsAction = $this->request->getParam('fileUploadsAction', $stencil->data->fileUploadsAction);
   154|         $stencil->data->dataRetention = $this->request->getParam('dataRetention', $stencil->data->dataRetention);
   155|         $stencil->data->dataRetentionValue = $this->request->getParam('dataRetentionValue', $stencil->data->dataRetentionValue);
   156|         $form = Formie::$plugin->getForms()->buildFormFromPost();
   157|         $stencil->data->populateFormData($form);
   158|         $form->handle .= random_int(0, mt_getrandmax());
   159|         $form->validate();
   160|         $formErrors = $form->getErrors();
   161|         if ($formErrors || !Formie::$plugin->getStencils()->saveStencil($stencil)) {
   162|             if ($this->request->getAcceptsJson()) {
   163|                 return $this->asJson([
   164|                     'success' => false,
   165|                     'config' => $stencil->getFormBuilderConfig(),
   166|                     'notifications' => $stencil->getNotificationsConfig(),
   167|                 ]);
   168|             }
   169|             $this->setFailFlash(Craft::t('formie', 'Couldn’t save stencil.'));
   170|             Craft::$app->getUrlManager()->setRouteParams([
   171|                 'form' => $stencil,
   172|                 'stencil' => $stencil,
   173|             ]);
   174|             return null;
   175|         }
   176|         if ($this->request->getAcceptsJson()) {
   177|             return $this->asJson([
   178|                 'success' => true,
   179|                 'config' => $stencil->getFormBuilderConfig(),
   180|                 'notifications' => $stencil->getNotificationsConfig(),
   181|                 'redirect' => $stencil->getCpEditUrl(),
   182|                 'redirectMessage' => Craft::t('formie', 'Stencil saved.'),
   183|             ]);
   184|         }
   185|         $this->setSuccessFlash(Craft::t('formie', 'Stencil saved.'));
   186|         return $this->redirectToPostedUrl($stencil);
   187|     }
   188|     public function actionDeleteForm(): ?Response
   189|     {
   190|         $this->requirePostRequest();
   191|         $this->requirePermission('formie-deleteForms');
   192|         $formId = $this->request->getRequiredBodyParam('formId');
   193|         $form = Formie::$plugin->getForms()->getFormById($formId);
   194|         if (!$form) {
   195|             throw new NotFoundHttpException('Form not found');
   196|         }
   197|         if (!Craft::$app->getElements()->deleteElement($form)) {
   198|             if ($this->request->getAcceptsJson()) {
   199|                 return $this->asJson(['success' => false]);
   200|             }
   201|             $this->setFailFlash(Craft::t('app', 'Couldn’t delete form.'));
   202|             Craft::$app->getUrlManager()->setRouteParams([
   203|                 'form' => $form,
   204|             ]);
   205|             return null;
   206|         }
   207|         $this->setSuccessFlash(Craft::t('app', 'Form deleted.'));
   208|         if ($this->request->getAcceptsJson()) {
   209|             $url = $this->request->getValidatedBodyParam('redirect');
   210|             $url = Formie::$plugin->getTemplates()->renderObjectTemplate($url, $form);
   211|             return $this->asJson([
   212|                 'success' => false,
   213|                 'redirect' => UrlHelper::url($url),
   214|             ]);
   215|         }
   216|         return $this->redirectToPostedUrl($form);
   217|     }
   218|     public function actionRefreshTokens(): Response
   219|     {
   220|         Craft::$app->getSession()->open();
   221|         $params = [
   222|             'csrf' => [
   223|                 'param' => $this->request->csrfParam,
   224|                 'token' => $this->request->getCsrfToken(),
   225|                 'input' => '<input type="hidden" name="' . $this->request->csrfParam . '" value="' . $this->request->getCsrfToken() . '">',
   226|             ],
   227|         ];
   228|         $formHandle = $this->request->getRequiredParam('form');
   229|         $form = Formie::$plugin->getForms()->getFormByHandle($formHandle);
   230|         $captchas = Formie::$plugin->getIntegrations()->getAllEnabledCaptchasForForm($form, null, true);
   231|         foreach ($captchas as $captcha) {
   232|             if ($jsVariables = $captcha->getRefreshJsVariables($form)) {
   233|                 $params['captchas'][$captcha->handle] = $jsVariables;
   234|             }
   235|         }
   236|         $this->response->setNoCacheHeaders();
   237|         return $this->asJson($params);
   238|     }
   239|     public function actionGetExistingFields(): Response
   240|     {
   241|         $formId = $this->request->getRequiredParam('formId');
   242|         $form = Formie::$plugin->getForms()->getFormById($formId);
   243|         $existingFields = Formie::$plugin->getFields()->getExistingFields($form);
   244|         return $this->asJson($existingFields);
   245|     }
   246|     public function actionGetExistingNotifications(): Response
   247|     {
   248|         $formId = $this->request->getRequiredParam('formId');
   249|         $form = Formie::$plugin->getForms()->getFormById($formId);
   250|         $existingNotifications = Formie::$plugin->getNotifications()->getExistingNotifications($form);
   251|         return $this->asJson($existingNotifications);
   252|     }
   253|     private function _prepareVariableArray(array &$variables): void
   254|     {
   255|         if (!$variables['form']) {
   256|             $variables['form'] = Formie::$plugin->getForms()->getFormById($variables['formId']);
   257|             if (!$variables['form']) {
   258|                 throw new Exception('Missing form data.');
   259|             }
   260|         }
   261|         $settings = Formie::$plugin->getSettings();
   262|         /** @var Form $form */
   263|         $form = $variables['form'];
   264|         $variables['notificationsSchema'] = Formie::$plugin->getNotifications()->getNotificationsSchema();
   265|         $variables['groupedIntegrations'] = Formie::$plugin->getIntegrations()->getAllIntegrationsForForm();
   266|         $variables['formUsage'] = Formie::$plugin->getForms()->getFormUsage($form);
   267|         $variables['jsBuilderConfig'] = [
   268|             'config' => $form->getFormBuilderConfig(),
   269|             'fields' => Formie::$plugin->getFields()->getFormBuilderFieldTypes(),
   270|             'notifications' => $form->getNotificationsConfig(),
   271|             'variables' => Variables::getVariablesArray(),
   272|             'emailTemplates' => Formie::$plugin->getEmailTemplates()->getAllTemplates(),
   273|             'reservedHandles' => Formie::$plugin->getFields()->getReservedHandles(),
   274|             'formHandles' => $this->_getFormHandles($form->id),
   275|             'statuses' => Formie::$plugin->getStatuses()->getAllStatuses(),
   276|             'maxFormHandleLength' => HandleHelper::getMaxFormHandle(),
   277|             'maxFieldHandleLength' => HandleHelper::getMaxFieldHandle(),
   278|             'filterIntegrationMapping' => $settings->filterIntegrationMapping,
   279|         ];
   280|         $variables['tabs'] = Formie::$plugin->getForms()->getFormBuilderTabs($form, $variables);
   281|         $variables['formTabs'] = $variables['tabs'];
   282|     }
   283|     private function _updateFormPermission(Form $form): void
   284|     {
   285|         if (Craft::$app->edition === CmsEdition::Solo) {
   286|             return;
   287|         }
   288|         $suffix = ':' . $form->uid;
   289|         $userService = Craft::$app->getUser();
   290|         $currentUser = $userService->getIdentity();
   291|         $permissions = Craft::$app->getUserPermissions()->getPermissionsByUserId($currentUser->id);
   292|         $permissions[] = "formie-manageForms{$suffix}";
   293|         if ($userService->checkPermission('formie-showFormAppearance') || $userService->checkPermission('formie-createFormAppearance')) {
   294|             $permissions[] = "formie-showFormAppearance{$suffix}";
   295|         }
   296|         if ($userService->checkPermission('formie-showFormBehavior') || $userService->checkPermission('formie-createFormBehavior')) {
   297|             $permissions[] = "formie-showFormBehavior{$suffix}";
   298|         }
   299|         if ($userService->checkPermission('formie-showNotifications') || $userService->checkPermission('formie-createNotifications')) {
   300|             $permissions[] = "formie-showNotifications{$suffix}";
   301|         }
   302|         if ($userService->checkPermission('formie-showNotificationsAdvanced') || $userService->checkPermission('formie-createNotifications')) {
   303|             $permissions[] = "formie-showNotificationsAdvanced{$suffix}";
   304|         }
   305|         if ($userService->checkPermission('formie-showNotificationsTemplates') || $userService->checkPermission('formie-createNotifications')) {
   306|             $permissions[] = "formie-showNotificationsTemplates{$suffix}";
   307|         }
   308|         if ($userService->checkPermission('formie-showFormIntegrations') || $userService->checkPermission('formie-createFormIntegrations')) {
   309|             $permissions[] = "formie-showFormIntegrations{$suffix}";
   310|         }
   311|         if ($userService->checkPermission('formie-showFormSettings') || $userService->checkPermission('formie-createFormSettings')) {
   312|             $permissions[] = "formie-showFormSettings{$suffix}";
   313|         }
   314|         if ($userService->checkPermission('formie-viewSubmissions')) {
   315|             $permissions[] = "formie-viewSubmissions{$suffix}";
   316|             $permissions[] = "formie-createSubmissions{$suffix}";
   317|             $permissions[] = "formie-saveSubmissions{$suffix}";
   318|             $permissions[] = "formie-deleteSubmissions{$suffix}";
   319|         }
   320|         if (Craft::$app->edition === CmsEdition::Pro) {
   321|             Craft::$app->getUserPermissions()->saveUserPermissions($currentUser->id, $permissions);
   322|         }
   323|     }
   324|     private function _getFormHandles(int $formId): array
   325|     {
   326|         return (new Query())
   327|             ->select(['handle'])
   328|             ->from([Table::FORMIE_FORMS])
   329|             ->where(['not', ['id' => $formId]])
   330|             ->column();
   331|     }
   332| }


# ====================================================================
# FILE: src/controllers/ImportExportController.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-152 ---
     1| <?php
     2| namespace verbb\formie\controllers;
     3| use verbb\formie\Formie;
     4| use verbb\formie\helpers\HandleHelper;
     5| use verbb\formie\helpers\ImportExportHelper;
     6| use verbb\formie\helpers\StringHelper;
     7| use verbb\formie\helpers\Table;
     8| use verbb\formie\models\Settings;
     9| use Craft;
    10| use craft\db\Query;
    11| use craft\helpers\Console;
    12| use craft\helpers\Html;
    13| use craft\helpers\Json;
    14| use craft\web\Controller;
    15| use craft\web\UploadedFile;
    16| use yii\helpers\Markdown;
    17| use yii\web\HttpException;
    18| use yii\web\Response;
    19| use stdClass;
    20| class ImportExportController extends Controller
    21| {
    22|     public function actionIndex(?string $importError = null, ?string $exportError = null): ?Response
    23|     {
    24|         /* @var Settings $settings */
    25|         $settings = Formie::$plugin->getSettings();
    26|         return $this->renderTemplate('formie/settings/import-export', compact('settings', 'importError', 'exportError'));
    27|     }
    28|     public function actionImport(): ?Response
    29|     {
    30|         $request = $this->request;
    31|         $uploadedFile = UploadedFile::getInstanceByName('file');
    32|         if (!$uploadedFile) {
    33|             $this->setFailFlash(Craft::t('formie', 'An error occurred.'));
    34|             Craft::$app->getUrlManager()->setRouteParams([
    35|                 'importError' => Craft::t('formie', 'You must upload a file.'),
    36|             ]);
    37|             return null;
    38|         }
    39|         $filename = 'formie-import-' . gmdate('ymd_His') . '.json';
    40|         $fileLocation = Craft::$app->getPath()->getTempPath() . DIRECTORY_SEPARATOR . $filename;
    41|         move_uploaded_file($uploadedFile->tempName, $fileLocation);
    42|         $object = new stdClass();
    43|         $object->filename = $filename;
    44|         return $this->redirectToPostedUrl($object);
    45|     }
    46|     public function actionImportConfigure(string $filename): ?Response
    47|     {
    48|         $request = $this->request;
    49|         $fileLocation = Craft::$app->getPath()->getTempPath() . DIRECTORY_SEPARATOR . $filename;
    50|         if (!file_exists($fileLocation)) {
    51|             throw new HttpException(404);
    52|         }
    53|         $json = Json::decode(file_get_contents($fileLocation));
    54|         if (isset($json[0])) {
    55|             $json = $json[0];
    56|         }
    57|         $existingForm = null;
    58|         $formHandle = $json['handle'] ?? null;
    59|         if ($formHandle) {
    60|             $existingForm = Formie::$plugin->getForms()->getFormByHandle($formHandle);
    61|         }
    62|         ob_start();
    63|         $this->stdout("Form: Preparing to import form “{$json['title']}”.");
    64|         $this->stdout("    > Form title is “{$json['title']}”.", Console::FG_GREEN);
    65|         $this->stdout("    > Form handle is “{$json['handle']}”.", ($existingForm ? Console::FG_RED : Console::FG_GREEN));
    66|         $pageCount = Craft::t('app', '{num, number} {num, plural, =1{page} other{pages}}', ['num' => count($json['pages'])]);
    67|         $this->stdout("    > Form contains {$pageCount}.", Console::FG_GREEN);
    68|         $formFields = [];
    69|         $pages = $json['pages'] ?? [];
    70|         foreach ($pages as $page) {
    71|             $rows = $page['rows'] ?? [];
    72|             foreach ($rows as $row) {
    73|                 $fields = $row['fields'] ?? [];
    74|                 foreach ($fields as $field) {
    75|                     $formFields[] = $field;
    76|                 }
    77|             }
    78|         }
    79|         $fieldCount = Craft::t('app', '{num, number} {num, plural, =1{field} other{fields}}', ['num' => count($formFields)]);
    80|         $this->stdout("    > Form contains {$fieldCount}.", Console::FG_GREEN);
    81|         foreach ($formFields as $field) {
    82|             $type = explode('\\', $field['type']);
    83|             $type = array_pop($type);
    84|             $label = Html::encode($field['label'] ?? $field['settings']['label'] ?? '');
    85|             $handle = Html::encode($field['handle'] ?? $field['settings']['handle'] ?? '');
    86|             $this->stdout("        > {$type}: “{$label}” `({$handle})`.", Console::FG_GREEN);
    87|         }
    88|         $notificationCount = Craft::t('app', '{num, number} {num, plural, =1{notification} other{notifications}}', ['num' => count($json['notifications'])]);
    89|         if (count($json['notifications'])) {
    90|             $this->stdout("Notifications: Preparing to import {$notificationCount}.");
    91|             foreach ($json['notifications'] as $notification) {
    92|                 $this->stdout("    > “{$notification['name']}”.", Console::FG_GREEN);
    93|             }
    94|         }
    95|         $summary = ob_get_clean();
    96|         $variables = compact('filename', 'summary', 'json', 'existingForm');
    97|         $variables = array_merge($variables, Craft::$app->getUrlManager()->getRouteParams());
    98|         return $this->renderTemplate('formie/settings/import-export/import-configure', $variables);
    99|     }
   100|     public function actionImportComplete(): ?Response
   101|     {
   102|         $request = $this->request;
   103|         $filename = $request->getParam('filename');
   104|         $formAction = $request->getParam('formAction');
   105|         $fileLocation = Craft::$app->getPath()->getTempPath() . DIRECTORY_SEPARATOR . $filename;
   106|         if (!file_exists($fileLocation)) {
   107|             throw new HttpException(404);
   108|         }
   109|         $json = Json::decode(file_get_contents($fileLocation));
   110|         $form = ImportExportHelper::importFormFromJson($json, $formAction);
   111|         if( $form->getConsolidatedErrors() ){
   112|             $this->setFailFlash(Craft::t('formie', 'Unable to import form.'));
   113|             Craft::$app->getUrlManager()->setRouteParams([
   114|                 'form' => $form,
   115|                 'errors' => $form->getConsolidatedErrors(),
   116|             ]);
   117|             return null;
   118|         }
   119|         $this->setSuccessFlash(Craft::t('formie', 'Form imported.'));
   120|         return $this->redirectToPostedUrl($form);
   121|     }
   122|     public function actionImportCompleted(?int $formId): Response
   123|     {
   124|         $form = Formie::$plugin->getForms()->getFormById($formId);
   125|         return $this->renderTemplate('formie/settings/import-export/import-completed', compact('form'));
   126|     }
   127|     public function actionExport(): void
   128|     {
   129|         $request = $this->request;
   130|         $formId = $request->getRequiredParam('formId');
   131|         if (!$formId) {
   132|             $this->setFailFlash(Craft::t('formie', 'An error occurred.'));
   133|             Craft::$app->getUrlManager()->setRouteParams([
   134|                 'exportError' => Craft::t('formie', 'You must select a form.'),
   135|             ]);
   136|             return;
   137|         }
   138|         $formElement = Formie::$plugin->getForms()->getFormById($formId);
   139|         $data = ImportExportHelper::generateFormExport($formElement);
   140|         $json = Json::encode($data, JSON_PRETTY_PRINT);
   141|         Craft::$app->getResponse()->sendContentAsFile($json, 'formie-' . $formElement->handle . '-' . StringHelper::UUID() . '.json');
   142|         Craft::$app->end();
   143|     }
   144|     private function stdout(string $string, string $color = ''): void
   145|     {
   146|         $class = '';
   147|         if ($color) {
   148|             $class = 'color-' . $color;
   149|         }
   150|         echo '<div class="log-label ' . $class . '">' . Markdown::processParagraph($string) . '</div>';
   151|     }
   152| }


# ====================================================================
# FILE: src/controllers/SubmissionsController.php
# Total hunks: 6
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| namespace verbb\formie\controllers;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\elements\Form;
     6| use verbb\formie\elements\Submission;
     7| use verbb\formie\events\SubmissionEvent;
     8| use verbb\formie\helpers\ArrayHelper;
     9| use verbb\formie\helpers\StringHelper;
    10| use verbb\formie\helpers\Variables;
    11| use verbb\formie\models\FieldLayoutPage;
    12| use verbb\formie\models\IntegrationResponse;
    13| use verbb\formie\models\Settings;
    14| use verbb\formie\storage\SessionStorage;
    15| use verbb\formie\web\assets\cp\CpAsset;
    16| use Craft;
    17| use craft\base\Element;
    18| use craft\errors\SiteNotFoundException;
    19| use craft\helpers\Json;
    20| use craft\helpers\Session;
    21| use craft\models\Site;
    22| use craft\web\Controller;
    23| use yii\base\InvalidConfigException;
    24| use yii\web\BadRequestHttpException;
    25| use yii\web\ForbiddenHttpException;
    26| use yii\web\HttpException;
    27| use yii\web\NotFoundHttpException;
    28| use yii\web\Response;
    29| use DateTime;
    30| use DateTimeZone;
    31| use Throwable;
    32| class SubmissionsController extends Controller
    33| {
    34|     public const EVENT_AFTER_SUBMISSION_REQUEST = 'afterSubmissionRequest';
    35|     public const EVENT_BEFORE_SUBMISSION_REQUEST = 'beforeSubmissionRequest';
    36|     protected array|bool|int $allowAnonymous = [
    37|         'api' => self::ALLOW_ANONYMOUS_LIVE,
    38|         'submit' => self::ALLOW_ANONYMOUS_LIVE,
    39|         'set-page' => self::ALLOW_ANONYMOUS_LIVE,
    40|         'save-submission' => self::ALLOW_ANONYMOUS_LIVE,

# --- HUNK 2: Lines 42-85 ---
    42|     ];
    43|     private string $_namespace = 'fields';
    44|     public function beforeAction($action): bool
    45|     {
    46|         $settings = Formie::$plugin->getSettings();
    47|         if ($action->id === 'submit' && Craft::$app->getUser()->isGuest && !$settings->enableCsrfValidationForGuests) {
    48|             $this->enableCsrfValidation = false;
    49|         }
    50|         if ($action->id === 'api') {
    51|             $this->enableCsrfValidation = false;
    52|         }
    53|         if ($this->request->getIsLivePreview() || $this->request->getIsPreview()) {
    54|             $this->enableCsrfValidation = false;
    55|         }
    56|         return parent::beforeAction($action);
    57|     }
    58|     public function actionIndex(): Response
    59|     {
    60|         /* @var Settings $settings */
    61|         $settings = Formie::$plugin->getSettings();
    62|         $this->getView()->registerAssetBundle(CpAsset::class);
    63|         $this->requirePermission('formie-accessSubmissions');
    64|         return $this->renderTemplate('formie/submissions/index', [
    65|             'defaultState' => $settings->submissionsBehaviour,
    66|         ]);
    67|     }
    68|     public function actionEditSubmission(string $formHandle, int $submissionId = null, ?Submission $submission = null, ?string $site = null): Response
    69|     {
    70|         $currentUser = Craft::$app->getUser()->getIdentity();
    71|         $sitesService = Craft::$app->getSites();
    72|         $editableSiteIds = $sitesService->getEditableSiteIds();
    73|         if ($site !== null) {
    74|             $siteModel = $sitesService->getSiteByHandle($site);
    75|             if (!$siteModel) {
    76|                 throw new BadRequestHttpException("Invalid site handle: $site");
    77|             }
    78|             if (!in_array($siteModel->id, $editableSiteIds, false)) {
    79|                 throw new ForbiddenHttpException('User not permitted to edit content in this site');
    80|             }
    81|         } else {
    82|             $siteModel = $sitesService->getCurrentSite();
    83|             if (!in_array($siteModel->id, $editableSiteIds, false)) {
    84|                 $siteModel = $sitesService->getSiteById($editableSiteIds[0]);
    85|             }

# --- HUNK 3: Lines 276-332 ---
   276|                 'title' => $submission->title,
   277|                 'status' => $submission->getStatusModel()->handle ?? '',
   278|                 'url' => $submission->getUrl(),
   279|                 'cpEditUrl' => $submission->getCpEditUrl(),
   280|             ]);
   281|         }
   282|         $this->setSuccessFlash(Craft::t('formie', 'Submission saved.'));
   283|         return $this->redirectToPostedUrl($submission);
   284|     }
   285|     public function actionSubmit(): ?Response
   286|     {
   287|         $this->requirePostRequest();
   288|         $request = $this->request;
   289|         /* @var Settings $settings */
   290|         $formieSettings = Formie::$plugin->getSettings();
   291|         $handle = $this->_getTypedParam('handle', 'string');
   292|         $pageIndex = $this->_getTypedParam('pageIndex', 'int');
   293|         $goToPageId = $this->_getTypedParam('goToPageId', 'id');
   294|         $completeSubmission = $this->_getTypedParam('completeSubmission', 'boolean');
   295|         $submitAction = $this->_getTypedParam('submitAction', 'string', 'submit');
   296|         $storage = $this->_getTypedParam('storage', 'string', 'session');
   297|         Formie::info("Submission triggered for {$handle}.");
   298|         /* @var Form $form */
   299|         $form = $this->_getForm($handle);
   300|         if (!$form) {
   301|             throw new BadRequestHttpException("No form exists with the handle \"$handle\"");
   302|         }
   303|         $submission = $this->_populateSubmission($form);
   304|         $submission->isNewSubmission = true;
   305|         $pages = $form->getPages();
   306|         $settings = $form->settings;
   307|         $defaultStatus = $form->getDefaultStatus();
   308|         $errorMessage = $form->settings->getErrorMessage();
   309|         $form->setStorageBehaviour($storage);
   310|         if ($form->getStorage() instanceof SessionStorage) {
   311|             Session::set('formie:nonce', rand());
   312|         }
   313|         if ($submitAction === 'back' && !$formieSettings->enableBackSubmission) {
   314|             $nextPage = $form->getPreviousPage(null, $submission, true) ?? $form->getCurrentPage();
   315|             $form->setCurrentPage($nextPage);
   316|             if ($request->getAcceptsJson()) {
   317|                 return $this->_returnJsonResponse(true, $submission, $form, $nextPage);
   318|             }
   319|             return $this->refresh();
   320|         }
   321|         if (is_numeric($pageIndex)) {
   322|             $currentPage = $pages[$pageIndex] ?? null;
   323|             if ($currentPage) {
   324|                 $form->setCurrentPage($currentPage);
   325|             }
   326|         }
   327|         if ($completeSubmission) {
   328|             $currentPage = $pages[(is_countable($pages) ? count($pages) : 0) - 1] ?? null;
   329|             if ($currentPage) {
   330|                 $form->setCurrentPage($currentPage);
   331|             }
   332|         }

# --- HUNK 4: Lines 429-493 ---
   429|             return null;
   430|         }
   431|         if (!empty($nextPage)) {
   432|             $form->setCurrentPage($nextPage);
   433|             $form->setCurrentSubmission($submission);
   434|         }
   435|         if (!$submission->isIncomplete) {
   436|             $form->resetCurrentPage();
   437|             $form->resetCurrentSubmission();
   438|         }
   439|         $event = new SubmissionEvent([
   440|             'submission' => $submission,
   441|             'form' => $form,
   442|             'submitAction' => $submitAction,
   443|             'success' => true,
   444|         ]);
   445|         $this->trigger(self::EVENT_AFTER_SUBMISSION_REQUEST, $event);
   446|         $submission = $event->submission;
   447|         $form = $event->form;
   448|         if ($request->getAcceptsJson()) {
   449|             return $this->_returnJsonResponse(true, $submission, $form, $nextPage, [
   450|                 'redirectUrl' => $event->redirectUrl,
   451|             ]);
   452|         }
   453|         if (!empty($nextPage)) {
   454|             if ($settings->pageRedirectUrl) {
   455|                 $url = Formie::$plugin->getTemplates()->renderObjectTemplate($settings->pageRedirectUrl, $submission);
   456|                 return $this->redirect($url);
   457|             }
   458|             return $this->refresh();
   459|         }
   460|         Formie::$plugin->getService()->setFlash($form->id, 'submitted', true);
   461|         if ($form->settings->submitAction == 'message' || $form->settings->submitAction == 'reload') {
   462|             if ($form->settings->submitAction == 'message') {
   463|                 Formie::$plugin->getService()->setNotice($form->id, $form->settings->getSubmitActionMessage($submission));
   464|             }
   465|             Craft::$app->getUrlManager()->setRouteParams([
   466|                 'submission' => $submission,
   467|             ]);
   468|             return $this->refresh();
   469|         }
   470|         $url = $form->getRedirectUrl(false);
   471|         if ($event->redirectUrl) {
   472|             return $this->redirect($event->redirectUrl);
   473|         }
   474|         return $this->redirectToPostedUrl($submission, $url);
   475|     }
   476|     public function actionSetPage(): Response
   477|     {
   478|         $request = $this->request;
   479|         $handle = $this->_getTypedParam('handle', 'string', null, false);
   480|         $pageId = $this->_getTypedParam('pageId', 'id', null, false);
   481|         $submissionId = $this->_getTypedParam('submissionId', 'id', null, false);
   482|         /* @var Form $form */
   483|         $form = $this->_getForm($handle);
   484|         if (!$form) {
   485|             throw new BadRequestHttpException("No form exists with the handle `$handle`.");
   486|         }
   487|         if ($submissionId) {
   488|             $submission = Submission::find()
   489|                 ->id($submissionId)
   490|                 ->isIncomplete(null)
   491|                 ->isSpam(null)
   492|                 ->one();
   493|             if ($submission) {

# --- HUNK 5: Lines 659-706 ---
   659|         } else if ($generalConfig->allowedGraphqlOrigins !== false) {
   660|             $headers->setDefault('Access-Control-Allow-Origin', '*');
   661|         }
   662|         if ($this->request->getIsPost()) {
   663|             return Craft::$app->runAction($this->request->getParam('action'));
   664|         }
   665|         if ($this->request->getIsOptions()) {
   666|             $this->response->format = Response::FORMAT_RAW;
   667|             $this->response->data = '';
   668|             return $this->response;
   669|         }
   670|         return $this->response;
   671|     }
   672|     private function _returnJsonResponse(bool $success, Submission $submission, Form $form, ?FieldLayoutPage $nextPage, array $extras = []): Response
   673|     {
   674|         $redirect = $this->request->getValidatedBodyParam('redirect');
   675|         if (!$redirect) {
   676|             $redirect = $form->getRedirectUrl();
   677|         }
   678|         $redirectUrl = Formie::$plugin->getTemplates()->renderObjectTemplate($redirect, $submission);
   679|         $extras['redirectUrl'] = $extras['redirectUrl'] ?? $redirectUrl;
   680|         $params = array_merge([
   681|             'success' => $success,
   682|             'submissionId' => $submission->id,
   683|             'nextPageId' => $nextPage->id ?? null,
   684|             'nextPageIndex' => $form->getPageIndex($nextPage) ?? null,
   685|             'isFinalPage' => $nextPage ? false : true,
   686|             'totalPages' => is_countable($form->getPages()) ? count($form->getPages()) : 0,
   687|             'submitActionMessage' => $form->settings->getSubmitActionMessage($submission),
   688|             'events' => $form->getFrontEndJsEvents(),
   689|         ], $extras);
   690|         return $this->asJson($params);
   691|     }
   692|     private function _prepEditSubmissionVariables(array &$variables): void
   693|     {
   694|         $request = $this->request;
   695|         if (Craft::$app->getIsMultiSite()) {
   696|             $variables['siteIds'] = Craft::$app->getSites()->getEditableSiteIds();
   697|         } else {
   698|             $variables['siteIds'] = [Craft::$app->getSites()->getPrimarySite()->id];
   699|         }
   700|         if (!$variables['siteIds']) {
   701|             throw new ForbiddenHttpException('User not permitted to edit content in any sites supported by this form');
   702|         }
   703|         if (empty($variables['site'])) {
   704|             $variables['site'] = Craft::$app->getSites()->currentSite;
   705|             if (!in_array($variables['site']->id, $variables['siteIds'], false)) {
   706|                 $variables['site'] = Craft::$app->getSites()->getSiteById($variables['siteIds'][0]);

# --- HUNK 6: Lines 778-819 ---
   778|         $this->_setTitle($submission, $form);
   779|         if ($editingSubmission) {
   780|             $form->setSubmission($submission);
   781|         }
   782|         return $submission;
   783|     }
   784|     private function _checkPageFieldErrors(submission $submission, Form $form, ?FieldLayoutPage $nextPage): ?FieldLayoutPage
   785|     {
   786|         if ($pageFieldErrors = $form->getPageFieldErrors($submission)) {
   787|             $firstErrorPageId = array_keys($pageFieldErrors)[0];
   788|             if ($firstErrorPageId) {
   789|                 $errorPage = ArrayHelper::firstWhere($form->getPages(), 'id', $firstErrorPageId);
   790|                 $form->setCurrentPage($errorPage);
   791|                 return $form->getCurrentPage();
   792|             }
   793|         }
   794|         return $nextPage;
   795|     }
   796|     private function _setTitle(Submission $submission, Form $form): void
   797|     {
   798|         $title = Variables::getParsedValue($form->settings->submissionTitleFormat, $submission, $form);
   799|         $submission->title = html_entity_decode($title);
   800|         if (!$submission->title) {
   801|             $now = new DateTime('now', new DateTimeZone(Craft::$app->getTimeZone()));
   802|             $submission->title = $now->format('D, d M Y H:i:s');
   803|         }
   804|     }
   805|     private function _getTypedParam(string $name, string $type, mixed $default = null, bool $bodyParam = true): mixed
   806|     {
   807|         $request = $this->request;
   808|         if ($bodyParam) {
   809|             $value = $request->getBodyParam($name);
   810|         } else {
   811|             $value = $request->getParam($name);
   812|         }
   813|         if ($name === 'submitAction') {
   814|             if (!in_array($value, ['submit', 'back', 'save'])) {
   815|                 return $default;
   816|             }
   817|         }
   818|         if ($value !== null) {
   819|             if ($type === 'string' && is_string($value)) {


# ====================================================================
# FILE: src/elements/Submission.php
# Total hunks: 9
# ====================================================================
# --- HUNK 1: Lines 1-56 ---
     1| <?php
     2| namespace verbb\formie\elements;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Captcha;
     5| use verbb\formie\base\Field;
     6| use verbb\formie\base\FieldInterface;
     7| use verbb\formie\base\FieldTrait;
     8| use verbb\formie\base\NestedFieldInterface;
     9| use verbb\formie\base\MultiNestedFieldInterface;
    10| use verbb\formie\base\SingleNestedFieldInterface;
    11| use verbb\formie\elements\actions\SetSubmissionSpam;
    12| use verbb\formie\elements\actions\SetSubmissionStatus;
    13| use verbb\formie\elements\conditions\SubmissionCondition;
    14| use verbb\formie\elements\db\SubmissionQuery;
    15| use verbb\formie\events\SubmissionMarkedAsSpamEvent;
    16| use verbb\formie\events\SubmissionRulesEvent;
    17| use verbb\formie\fields\FileUpload;
    18| use verbb\formie\fields\Payment;
    19| use verbb\formie\helpers\ArrayHelper;
    20| use verbb\formie\helpers\Table;
    21| use verbb\formie\helpers\Variables;
    22| use verbb\formie\models\FieldLayout as FormLayout;
    23| use verbb\formie\models\Settings;
    24| use verbb\formie\models\Status;
    25| use verbb\formie\records\Submission as SubmissionRecord;
    26| use verbb\formie\web\assets\cp\CpAsset;
    27| use Craft;
    28| use craft\base\Component;
    29| use craft\base\Element;
    30| use craft\base\FieldInterface as CraftFieldInterface;
    31| use craft\base\Model;
    32| use craft\db\Query;
    33| use craft\elements\User;
    34| use craft\elements\actions\Delete;
    35| use craft\elements\actions\Restore;
    36| use craft\elements\conditions\ElementConditionInterface;
    37| use craft\elements\db\ElementQueryInterface;
    38| use craft\helpers\Cp;
    39| use craft\helpers\Db;
    40| use craft\helpers\Html;
    41| use craft\helpers\Json;
    42| use craft\helpers\Template;
    43| use craft\helpers\UrlHelper;
    44| use craft\models\FieldLayout;
    45| use craft\validators\SiteIdValidator;
    46| use craft\validators\StringValidator;
    47| use yii\base\Exception;
    48| use yii\base\InvalidConfigException;
    49| use yii\validators\NumberValidator;
    50| use yii\validators\RequiredValidator;
    51| use yii\validators\Validator;
    52| use ReflectionClass;
    53| use Throwable;
    54| use Twig\Markup;
    55| class Submission extends CustomElement
    56| {

# --- HUNK 2: Lines 59-102 ---
    59|     public static function displayName(): string
    60|     {
    61|         return Craft::t('formie', 'Submission');
    62|     }
    63|     public static function refHandle(): ?string
    64|     {
    65|         return 'submission';
    66|     }
    67|     public static function hasTitles(): bool
    68|     {
    69|         return true;
    70|     }
    71|     public static function hasStatuses(): bool
    72|     {
    73|         return true;
    74|     }
    75|     public static function isLocalized(): bool
    76|     {
    77|         return true;
    78|     }
    79|     public static function createCondition(): ElementConditionInterface
    80|     {
    81|         return Craft::createObject(SubmissionCondition::class, [static::class]);
    82|     }
    83|     public static function find(): SubmissionQuery
    84|     {
    85|         return new SubmissionQuery(static::class);
    86|     }
    87|     public static function gqlTypeNameByContext(mixed $context): string
    88|     {
    89|         return $context->handle . '_Submission';
    90|     }
    91|     public static function gqlScopesByContext(mixed $context): array
    92|     {
    93|         return ['formieSubmissions.' . $context->uid];
    94|     }
    95|     public static function gqlMutationNameByContext(mixed $context): string
    96|     {
    97|         return 'save_' . $context->handle . '_Submission';
    98|     }
    99|     public static function statuses(): array
   100|     {
   101|         return Formie::$plugin->getStatuses()->getStatusesArray();
   102|     }

# --- HUNK 3: Lines 283-337 ---
   283|             return false;
   284|         }
   285|         return true;
   286|     }
   287|     public function canDelete(User $user): bool
   288|     {
   289|         if (parent::canDelete($user)) {
   290|             return true;
   291|         }
   292|         if ($user->can('formie-deleteSubmissions')) {
   293|             return true;
   294|         }
   295|         $form = $this->getForm();
   296|         if (!$form) {
   297|             return false;
   298|         }
   299|         if (!$user->can("formie-deleteSubmissions:$form->uid")) {
   300|             return false;
   301|         }
   302|         return true;
   303|     }
   304|     public function attributeLabels(): array
   305|     {
   306|         $labels = parent::attributeLabels();
   307|         $processFields = function ($fields) use (&$processFields, &$labels) {
   308|             foreach ($fields as $field) {
   309|                 $labels[$field->fieldKey] = $field->label;
   310|                 $field->modifyAttributeLabels($labels);
   311|                 if ($field instanceof NestedFieldInterface) {
   312|                     $processFields($field->getFields());
   313|                 }
   314|             }
   315|         };
   316|         $processFields($this->getFields());
   317|         return $labels;
   318|     }
   319|     public function getStatus(): ?string
   320|     {
   321|         return $this->getStatusModel(true)->handle ?? null;
   322|     }
   323|     public static function defineElementChipHtml(\craft\events\DefineElementHtmlEvent $event): void
   324|     {
   325|         $element = $event->element;
   326|         if (!($element instanceof self)) {
   327|             return;
   328|         }
   329|         $elementsService = Craft::$app->getElements();
   330|         $user = Craft::$app->getUser()->getIdentity();
   331|         $editable = $user && $elementsService->canView($element, $user);
   332|         $id = sprintf('chip-%s', mt_rand());
   333|         $attributes = array_merge($element->getHtmlAttributes($event->context), [
   334|             'class' => ['element', 'chip', 'small'],
   335|             'title' => $element->getUiLabel(),
   336|             'id' => $id,
   337|             'data' => [

# --- HUNK 4: Lines 488-683 ---
   488|     {
   489|         return $this->getFields();
   490|     }
   491|     public function getFieldValue(string $fieldHandle): mixed
   492|     {
   493|         $fieldKey = explode('.', $fieldHandle);
   494|         $handle = array_shift($fieldKey);
   495|         $fieldKey = implode('.', $fieldKey);
   496|         $fieldValue = parent::getFieldValue($handle);
   497|         if ($fieldKey) {
   498|             if (is_array($fieldValue) || $fieldValue instanceof Model) {
   499|                 return ArrayHelper::getValue($fieldValue, $fieldKey);
   500|             }
   501|         }
   502|         return $fieldValue;
   503|     }
   504|     public function getFieldValuesForField(string $type): array
   505|     {
   506|         $fieldValues = [];
   507|         foreach ($this->getFields() as $field) {
   508|             if ($field instanceof $type) {
   509|                 $fieldValues[$field->handle] = $this->getFieldValue($field->handle);
   510|             }
   511|             if ($field instanceof SingleNestedFieldInterface) {
   512|                 foreach ($field->getFields() as $nestedField) {
   513|                     if ($nestedField instanceof $type) {
   514|                         $fieldKey = "$field->handle.$nestedField->handle";
   515|                         $fieldValues[$fieldKey] = $this->getFieldValue($fieldKey);
   516|                     }
   517|                 }
   518|             }
   519|             if ($field instanceof MultiNestedFieldInterface) {
   520|                 $value = $this->getFieldValue($field->handle);
   521|                 foreach ($value as $rowKey => $row) {
   522|                     foreach ($this->getFields() as $nestedField) {
   523|                         if ($nestedField instanceof $type) {
   524|                             $fieldKey = "$field->handle.$rowKey.$nestedField->handle";
   525|                             $fieldValues[$fieldKey] = $this->getFieldValue($fieldKey);
   526|                         }
   527|                     }
   528|                 }
   529|             }
   530|         }
   531|         return $fieldValues;
   532|     }
   533|     public function setCaptchaData(string $key, mixed $value): void
   534|     {
   535|         $this->_captchaData[$key] = $value;
   536|     }
   537|     public function getCaptchaData(string $key): mixed
   538|     {
   539|         return $this->_captchaData[$key] ?? null;
   540|     }
   541|     public function updateTitle(Form $form): void
   542|     {
   543|         if ($customTitle = Variables::getParsedValue($form->settings->submissionTitleFormat, $this, $form)) {
   544|             $this->title = html_entity_decode($customTitle);
   545|             Db::update(Table::ELEMENTS_SITES, ['title' => $customTitle], ['elementId' => $this->id, 'siteId' => $this->siteId]);
   546|         }
   547|     }
   548|     public function getForm(): ?Form
   549|     {
   550|         if (!$this->_form && $this->formId) {
   551|             $query = Form::find()->id($this->formId);
   552|             $this->_form = $query->one();
   553|             if (!$this->_form && $this->trashed) {
   554|                 $query->trashed(true);
   555|                 $this->_form = $query->one();
   556|             }
   557|         }
   558|         return $this->_form;
   559|     }
   560|     public function setForm(Form $form): void
   561|     {
   562|         $this->_form = $form;
   563|         $this->formId = $form->id;
   564|         if (Craft::$app->getRequest()->getIsSiteRequest() && !$this->snapshot) {
   565|             if ($snapshotData = $form->getSnapshotData()) {
   566|                 $this->snapshot = $snapshotData;
   567|             }
   568|         }
   569|         $fields = $this->snapshot['fields'] ?? [];
   570|         foreach ($fields as $handle => $settings) {
   571|             $this->setFieldSettings($handle, $settings);
   572|         }
   573|         $formSettings = $this->snapshot['form'] ?? null;
   574|         if ($formSettings) {
   575|             $this->_form->settings->setAttributes($formSettings, false);
   576|         }
   577|     }
   578|     public function setFieldSettings(string $handle, array $settings): void
   579|     {
   580|         $field = null;
   581|         $handles = explode('.', $handle);
   582|         if (count($handles) > 1) {
   583|             $parentField = $this->getFieldByHandle($handles[0]);
   584|             if ($parentField) {
   585|                 $field = $parentField->getFieldByHandle($handles[1]);
   586|             }
   587|         } else {
   588|             $field = $this->getFieldByHandle($handles[0]);
   589|         }
   590|         if ($field) {
   591|             $field->setAttributes($settings, false);
   592|         }
   593|     }
   594|     public function getFormName(): ?string
   595|     {
   596|         if ($form = $this->getForm()) {
   597|             return $form->title;
   598|         }
   599|         return null;
   600|     }
   601|     public function getFormHandle(): ?string
   602|     {
   603|         if ($form = $this->getForm()) {
   604|             return $form->handle;
   605|         }
   606|         return null;
   607|     }
   608|     public function getSiteHandle(): ?string
   609|     {
   610|         if ($site = $this->getSite()) {
   611|             return $site->handle;
   612|         }
   613|         return null;
   614|     }
   615|     public function getStatusModel(): Status
   616|     {
   617|         if (!$this->_status && $this->statusId) {
   618|             $this->_status = Formie::$plugin->getStatuses()->getStatusById($this->statusId);
   619|         }
   620|         if ($this->_status) {
   621|             return $this->_status;
   622|         }
   623|         if ($form = $this->getForm()) {
   624|             return $this->_status = $form->getDefaultStatus();
   625|         }
   626|         if ($status = Formie::$plugin->getStatuses()->getDefaultStatus()) {
   627|             return $this->_status = $status;
   628|         }
   629|         return $this->_status = Formie::$plugin->getStatuses()->getAllStatuses()[0];
   630|     }
   631|     public function setStatus(Status|string $status): void
   632|     {
   633|         if (is_string($status)) {
   634|             if ($foundStatus = Formie::$plugin->getStatuses()->getStatusByHandle($status)) {
   635|                 $status = $foundStatus;
   636|             }
   637|         }
   638|         $this->_status = $status;
   639|         $this->statusId = $status->id;
   640|     }
   641|     public function getUser(): ?User
   642|     {
   643|         if (!$this->userId) {
   644|             return null;
   645|         }
   646|         if ($this->_user) {
   647|             return $this->_user;
   648|         }
   649|         return $this->_user = Craft::$app->getUsers()->getUserById($this->userId);
   650|     }
   651|     public function setUser(User $user): void
   652|     {
   653|         $this->_user = $user;
   654|         $this->userId = $user->id;
   655|     }
   656|     public function getPaymentSummaryHtml(): ?Markup
   657|     {
   658|         $html = '';
   659|         foreach ($this->getFields() as $field) {
   660|             if ($field instanceof Payment && ($paymentIntegration = $field->getPaymentIntegration())) {
   661|                 if (!$paymentIntegration->field || $paymentIntegration->field->id !== $field->id) {
   662|                     continue;
   663|                 }
   664|                 if ($summaryHtml = $paymentIntegration->getSubmissionSummaryHtml($this, $field)) {
   665|                     $html .= $summaryHtml;
   666|                 }
   667|             }
   668|         }
   669|         if (!$html) {
   670|             return null;
   671|         }
   672|         return Template::raw($html);
   673|     }
   674|     public function getPayments(): ?array
   675|     {
   676|         return Formie::$plugin->getPayments()->getSubmissionPayments($this);
   677|     }
   678|     public function getSubscriptions(): ?array
   679|     {
   680|         return Formie::$plugin->getSubscriptions()->getSubmissionSubscriptions($this);
   681|     }
   682|     public function setFieldValuesFromRequest(string $paramNamespace = ''): void
   683|     {

# --- HUNK 5: Lines 949-1026 ---
   949|         return parent::beforeDelete();
   950|     }
   951|     public function afterDelete(): void
   952|     {
   953|         $elementsService = Craft::$app->getElements();
   954|         if ($this->_assetsToDelete) {
   955|             foreach ($this->_assetsToDelete as $asset) {
   956|                 if (!$elementsService->deleteElement($asset)) {
   957|                     Formie::error("Unable to delete file ”{$asset->id}” for submission ”{$this->id}”: " . Json::encode($asset->getErrors()) . ".");
   958|                 }
   959|             }
   960|         }
   961|         parent::beforeDelete();
   962|     }
   963|     public function afterValidate(): void
   964|     {
   965|         if (Craft::$app->getIsInstalled() && $formLayout = $this->getFormLayout()) {
   966|             $scenario = $this->getScenario();
   967|             $fields = $formLayout->getVisiblePageFields($this);
   968|             foreach ($fields as $field) {
   969|                 $attribute = 'field:' . $field->getErrorKey();
   970|                 if ($field->getIsDisabled()) {
   971|                     continue;
   972|                 }
   973|                 if (isset($this->_attributeNames) && !isset($this->_attributeNames[$attribute])) {
   974|                     continue;
   975|                 }
   976|                 $isEmpty = fn() => $field->isValueEmpty($this->getFieldValue($field->handle), $this);
   977|                 if ($scenario === self::SCENARIO_LIVE && $field->required) {
   978|                     (new RequiredValidator(['isEmpty' => $isEmpty, 'message' => $field->errorMessage]))
   979|                         ->validateAttribute($this, $attribute);
   980|                 }
   981|                 foreach ($field->getElementValidationRules() as $rule) {
   982|                     $validator = $this->_callPrivateMethod('_normalizeFieldValidator', $attribute, $rule, $field, $isEmpty);
   983|                     if (
   984|                         in_array($scenario, $validator->on) ||
   985|                         (empty($validator->on) && !in_array($scenario, $validator->except))
   986|                     ) {
   987|                         $validator->validateAttributes($this);
   988|                     }
   989|                 }
   990|             }
   991|         }
   992|         Component::afterValidate();
   993|     }
   994|     protected function defineRules(): array
   995|     {
   996|         $rules = parent::defineRules();
   997|         foreach ($rules as $key => $rule) {
   998|             [$attribute, $validator] = $rule;
   999|             if ($validator === SiteIdValidator::class) {
  1000|                 $rules[$key]['allowDisabled'] = true;
  1001|             }
  1002|         }
  1003|         $rules[] = [['title'], 'required'];
  1004|         $rules[] = [['title'], 'string', 'max' => 255];
  1005|         $rules[] = [['formId'], 'number', 'integerOnly' => true];
  1006|         $rules[] = [['content'], 'safe'];
  1007|         $event = new SubmissionRulesEvent([
  1008|             'rules' => $rules,
  1009|             'submission' => $this,
  1010|         ]);
  1011|         $this->trigger(self::EVENT_DEFINE_RULES, $event);
  1012|         return $event->rules;
  1013|     }
  1014|     protected function attributeHtml(string $attribute): string
  1015|     {
  1016|         if ($attribute == 'form') {
  1017|             $form = $this->getForm();
  1018|             return $form->title ?? '';
  1019|         } 
  1020|         if ($attribute == 'userId') {
  1021|             $user = $this->getUser();
  1022|             return $user ? Cp::elementChipHtml($user) : '';
  1023|         }
  1024|         if ($attribute == 'status') {
  1025|             $status = $this->getStatusModel(true);
  1026|             return Html::tag('span', Html::tag('span', '', [


# ====================================================================
# FILE: src/elements/conditions/SubmissionCondition.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-63 ---
     1| <?php
     2| namespace verbb\formie\elements\conditions;
     3| use verbb\formie\Formie;
     4| use Craft;
     5| use craft\elements\conditions\ElementCondition;
     6| use craft\errors\InvalidTypeException;
     7| use craft\elements\conditions\DateCreatedConditionRule;
     8| use craft\elements\conditions\DateUpdatedConditionRule;
     9| use craft\elements\conditions\IdConditionRule;
    10| use craft\elements\conditions\StatusConditionRule;
    11| use craft\elements\conditions\TitleConditionRule;
    12| use verbb\formie\fields\conditions\FieldConditionRuleInterface;
    13| class SubmissionCondition extends ElementCondition
    14| {
    15|     private array $_fields = [];
    16|     public function getFields(): array
    17|     {
    18|         if ($this->_fields) {
    19|             return $this->_fields;
    20|         }
    21|         if ($this->sourceKey) {
    22|             if (preg_match('/^form:(\d+)$/', $this->sourceKey, $matches) && ($fields = Formie::$plugin->getFields()->getAllFieldsForForm($matches[1]))) {
    23|                 return $this->_fields = $fields;
    24|             }
    25|         }
    26|         return [];
    27|     }
    28|     protected function defineRules(): array
    29|     {
    30|         $rules = parent::defineRules();
    31|         $rules[] = [['elementType', 'sourceKey'], 'safe'];
    32|         return $rules;
    33|     }
    34|     protected function config(): array
    35|     {
    36|         return $this->toArray(['elementType', 'sourceKey']);
    37|     }
    38|     protected function selectableConditionRules(): array
    39|     {
    40|         $types = [
    41|             DateCreatedConditionRule::class,
    42|             DateUpdatedConditionRule::class,
    43|             IdConditionRule::class,
    44|             StatusConditionRule::class,
    45|             TitleConditionRule::class,
    46|         ];
    47|         foreach ($this->getFields() as $field) {
    48|             $type = $field->getElementConditionRuleType();
    49|             if ($type === null) {
    50|                 continue;
    51|             }
    52|             if (is_string($type)) {
    53|                 $type = ['class' => $type];
    54|             }
    55|             if (!is_subclass_of($type['class'], FieldConditionRuleInterface::class)) {
    56|                 throw new InvalidTypeException($type['class'], FieldConditionRuleInterface::class);
    57|             }
    58|             $type['fieldUid'] = $field->uid;
    59|             $types[] = $type;
    60|         }
    61|         return $types;
    62|     }
    63| }


# ====================================================================
# FILE: src/elements/db/SubmissionQuery.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-258 ---
     1| <?php
     2| namespace verbb\formie\elements\db;
     3| use craft\elements\User;
     4| use verbb\formie\Formie;
     5| use verbb\formie\behaviors\CustomFieldBehavior;
     6| use verbb\formie\elements\Form;
     7| use verbb\formie\helpers\Table;
     8| use verbb\formie\models\FieldLayout;
     9| use verbb\formie\models\Status;
    10| use verbb\formie\services\Fields;
    11| use Craft;
    12| use craft\base\ElementInterface;
    13| use craft\db\Query;
    14| use craft\db\QueryAbortedException;
    15| use craft\elements\db\ElementQuery;
    16| use craft\helpers\ArrayHelper;
    17| use craft\helpers\Db;
    18| use craft\helpers\Json;
    19| use yii\base\UnknownMethodException;
    20| use Throwable;
    21| class SubmissionQuery extends ElementQuery
    22| {
    23|     public mixed $id = null;
    24|     public mixed $siteId = '*';
    25|     public mixed $formId = null;
    26|     public mixed $statusId = null;
    27|     public mixed $userId = null;
    28|     public ?bool $isIncomplete = false;
    29|     public ?bool $isSpam = false;
    30|     public mixed $before = null;
    31|     public mixed $after = null;
    32|     protected array $defaultOrderBy = ['elements.dateCreated' => SORT_DESC];
    33|     public function behaviors(): array
    34|     {
    35|         $behaviors = parent::behaviors();
    36|         $behaviors['customFields'] = [
    37|             'class' => CustomFieldBehavior::class,
    38|             'hasMethods' => true,
    39|         ];
    40|         return $behaviors;
    41|     }
    42|     public function form(Form|array|string|null $value): static
    43|     {
    44|         if ($value instanceof Form) {
    45|             $this->formId = $value->id;
    46|         } else if ($value !== null) {
    47|             $this->formId = (new Query())
    48|                 ->select(['forms.id'])
    49|                 ->from(['forms' => Table::FORMIE_FORMS])
    50|                 ->where(Db::parseParam('handle', $value))
    51|                 ->leftJoin(['elements' => Table::ELEMENTS], '[[forms.id]] = [[elements.id]]')
    52|                 ->andWhere(['dateDeleted' => null])
    53|                 ->scalar();
    54|         } else {
    55|             $this->formId = null;
    56|         }
    57|         return $this;
    58|     }
    59|     public function formId($value): static
    60|     {
    61|         $this->formId = $value;
    62|         return $this;
    63|     }
    64|     public function status(array|string|null $value): static
    65|     {
    66|         if ($value instanceof Status) {
    67|             $this->statusId = $value->id;
    68|         } else if ($value !== null) {
    69|             $this->statusId = (new Query())
    70|                 ->select(['id'])
    71|                 ->from([Table::FORMIE_STATUSES])
    72|                 ->where(Db::parseParam('handle', $value))
    73|                 ->scalar();
    74|         } else {
    75|             $this->statusId = null;
    76|         }
    77|         return $this;
    78|     }
    79|     public function statusId($value): static
    80|     {
    81|         $this->statusId = $value;
    82|         return $this;
    83|     }
    84|     public function user(string|User|null $value): static
    85|     {
    86|         if ($value instanceof User) {
    87|             $this->userId = $value->id;
    88|         } else if ($value !== null) {
    89|             $user = Craft::$app->getUsers()->getUserByUsernameOrEmail($value);
    90|             $this->userId = $user ? $user->id : false;
    91|         } else {
    92|             $this->userId = null;
    93|         }
    94|         return $this;
    95|     }
    96|     public function userId($value): static
    97|     {
    98|         $this->userId = $value;
    99|         return $this;
   100|     }
   101|     public function isIncomplete(?bool $value): static
   102|     {
   103|         $this->isIncomplete = $value;
   104|         return $this;
   105|     }
   106|     public function isSpam(?bool $value): static
   107|     {
   108|         $this->isSpam = $value;
   109|         return $this;
   110|     }
   111|     public function anyStatus(): static
   112|     {
   113|         parent::status(null);
   114|         $this->isIncomplete = null;
   115|         $this->isSpam = null;
   116|         return $this;
   117|     }
   118|     public function before(mixed $value): self
   119|     {
   120|         $this->before = $value;
   121|         return $this;
   122|     }
   123|     public function after(mixed $value): self
   124|     {
   125|         $this->after = $value;
   126|         return $this;
   127|     }
   128|     protected function beforePrepare(): bool
   129|     {
   130|         $this->joinElementTable('formie_submissions');
   131|         $this->query->select([
   132|             'formie_submissions.id',
   133|             'formie_submissions.formId',
   134|             'formie_submissions.statusId',
   135|             'formie_submissions.userId',
   136|             'formie_submissions.isIncomplete',
   137|             'formie_submissions.isSpam',
   138|             'formie_submissions.spamReason',
   139|             'formie_submissions.spamClass',
   140|             'formie_submissions.snapshot',
   141|             'formie_submissions.ipAddress',
   142|             'formie_submissions.content as fieldContent',
   143|         ]);
   144|         if ($this->formId) {
   145|             $this->subQuery->andWhere(Db::parseParam('formie_submissions.formId', $this->formId));
   146|         }
   147|         if ($this->statusId) {
   148|             $this->subQuery->andWhere(Db::parseParam('formie_submissions.statusId', $this->statusId));
   149|         }
   150|         if ($this->userId !== null) {
   151|             $this->subQuery->andWhere(Db::parseNumericParam('formie_submissions.userId', $this->userId));
   152|         }
   153|         if ($this->isIncomplete !== null) {
   154|             $this->subQuery->andWhere(Db::parseParam('formie_submissions.isIncomplete', $this->isIncomplete));
   155|         }
   156|         if ($this->isSpam !== null) {
   157|             $this->subQuery->andWhere(Db::parseParam('formie_submissions.isSpam', $this->isSpam));
   158|         }
   159|         if ($this->before) {
   160|             $this->subQuery->andWhere(Db::parseDateParam('formie_submissions.dateCreated', $this->before, '<'));
   161|         }
   162|         if ($this->after) {
   163|             $this->subQuery->andWhere(Db::parseDateParam('formie_submissions.dateCreated', $this->after, '>='));
   164|         }
   165|         return parent::beforePrepare();
   166|     }
   167|     protected function afterPrepare(): bool
   168|     {
   169|         if (version_compare(Craft::$app->getInfo()->version, '5.6.0', '>=')) {
   170|             $this->_applyCustomFieldParams();
   171|         }
   172|         return parent::afterPrepare();
   173|     }
   174|     protected function statusCondition(string $status): mixed
   175|     {
   176|         $statusId = (new Query())
   177|             ->select(['id'])
   178|             ->from([Table::FORMIE_STATUSES])
   179|             ->where(Db::parseParam('handle', $status))
   180|             ->scalar();
   181|         if ($statusId) {
   182|             return ['formie_submissions.statusId' => $statusId];
   183|         }
   184|         return parent::statusCondition($status);
   185|     }
   186|     protected function customFields(): array
   187|     {
   188|         if (!$this->withCustomFields) {
   189|             return [];
   190|         }
   191|         if ($this->withProvisionalDrafts || $this->provisionalDrafts) {
   192|             return [];
   193|         }
   194|         if ($formIds = $this->_resolveFormIds()) {
   195|             $fields = [];
   196|             foreach ($formIds as $formId) {
   197|                 $fields[] = Formie::$plugin->getFields()->getAllFieldsForForm($formId);
   198|             }
   199|             return array_filter(array_merge(...$fields));
   200|         }
   201|         return Formie::$plugin->getFields()->getAllFields();
   202|     }
   203|     private function _applyCustomFieldParams(): void
   204|     {
   205|         if (is_array($this->customFields)) {
   206|             $fieldAttributes = $this->getBehavior('customFields');
   207|             $fieldsByHandle = [];
   208|             foreach ($this->customFields as $field) {
   209|                 $fieldsByHandle[$field->handle][$field->uid][] = $field;
   210|             }
   211|             foreach ($fieldsByHandle as $handle => $instancesByUid) {
   212|                 if ($handle === 'owner' || ($fieldAttributes->$handle ?? null) === null) {
   213|                     continue;
   214|                 }
   215|                 $conditions = [];
   216|                 $params = [];
   217|                 foreach ($instancesByUid as $instances) {
   218|                     $firstInstance = $instances[0];
   219|                     $condition = $firstInstance::queryCondition($instances, $fieldAttributes->$handle, $params);
   220|                     if ($condition === false) {
   221|                         throw new QueryAbortedException();
   222|                     }
   223|                     if ($condition !== null) {
   224|                         $conditions[] = $condition;
   225|                     }
   226|                 }
   227|                 if (!empty($conditions)) {
   228|                     if (count($conditions) === 1) {
   229|                         $this->subQuery->andWhere(reset($conditions), $params);
   230|                     } else {
   231|                         $this->subQuery->andWhere(['or', ...$conditions], $params);
   232|                     }
   233|                 }
   234|             }
   235|         }
   236|     }
   237|     private function _resolveFormIds(): array
   238|     {
   239|         if ($this->formId) {
   240|             return (array)$this->formId;
   241|         }
   242|         if ($this->id) {
   243|             return (new Query())
   244|                 ->select(['formId'])
   245|                 ->from(Table::FORMIE_SUBMISSIONS)
   246|                 ->where(['id' => (array)$this->id])
   247|                 ->column();
   248|         }
   249|         if ($this->uid) {
   250|             return (new Query())
   251|                 ->select(['formId'])
   252|                 ->from(Table::FORMIE_SUBMISSIONS)
   253|                 ->where(['uid' => (array)$this->uid])
   254|                 ->column();
   255|         }
   256|         return [];
   257|     }
   258| }


# ====================================================================
# FILE: src/fields/Agree.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-265 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\base\Field;
     4| use verbb\formie\base\Integration;
     5| use verbb\formie\base\IntegrationInterface;
     6| use verbb\formie\helpers\RichTextHelper;
     7| use verbb\formie\helpers\SchemaHelper;
     8| use verbb\formie\models\HtmlTag;
     9| use verbb\formie\models\IntegrationField;
    10| use verbb\formie\positions\Hidden as HiddenPosition;
    11| use Craft;
    12| use craft\base\ElementInterface;
    13| use craft\base\PreviewableFieldInterface;
    14| use craft\base\SortableFieldInterface;
    15| use craft\helpers\Template;
    16| use yii\db\Schema;
    17| use GraphQL\Type\Definition\Type;
    18| use Twig\Markup;
    19| class Agree extends Field implements PreviewableFieldInterface, SortableFieldInterface
    20| {
    21|     public static function displayName(): string
    22|     {
    23|         return Craft::t('formie', 'Agree');
    24|     }
    25|     public static function getSvgIconPath(): string
    26|     {
    27|         return 'formie/_formfields/agree/icon.svg';
    28|     }
    29|     public static function dbType(): string
    30|     {
    31|         return Schema::TYPE_BOOLEAN;
    32|     }
    33|     public ?array $description = null;
    34|     public ?string $checkedValue = null;
    35|     public ?string $uncheckedValue = null;
    36|     private ?string $_descriptionHtml = null;
    37|     public function __construct(array $config = [])
    38|     {
    39|         $config['defaultValue'] = $config['defaultValue'] ?? false;
    40|         $config['labelPosition'] = $config['labelPosition'] ?? HiddenPosition::class;
    41|         $config['checkedValue'] = $config['checkedValue'] ?? Craft::t('app', 'Yes');
    42|         $config['uncheckedValue'] = $config['uncheckedValue'] ?? Craft::t('app', 'No');
    43|         parent::__construct($config);
    44|     }
    45|     public function attributes(): array
    46|     {
    47|         $names = parent::attributes();
    48|         $names[] = 'descriptionHtml';
    49|         return $names;
    50|     }
    51|     public function hasEmailPlaceholder(): bool
    52|     {
    53|         return false;
    54|     }
    55|     public function isValueEmpty(mixed $value, ?ElementInterface $element): bool
    56|     {
    57|         return parent::isValueEmpty($value, $element) || $value === false;
    58|     }
    59|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
    60|     {
    61|         return ($value === null) ? null : (bool)$value;
    62|     }
    63|     public function getDescriptionHtml(): Markup
    64|     {
    65|         if (!$this->_descriptionHtml) {
    66|             $this->_descriptionHtml = $this->_getHtmlContent($this->description);
    67|         }
    68|         return Template::raw(Craft::t('formie', (string)$this->_descriptionHtml));
    69|     }
    70|     public function setDescriptionHtml($value): void
    71|     {
    72|         $this->_descriptionHtml = $value;
    73|     }
    74|     public function getDefaultState(): ?string
    75|     {
    76|         return $this->defaultValue;
    77|     }
    78|     public function getPreviewInputHtml(): string
    79|     {
    80|         return Craft::$app->getView()->renderTemplate('formie/_formfields/agree/preview', [
    81|             'field' => $this,
    82|         ]);
    83|     }
    84|     public function getSettingGqlTypes(): array
    85|     {
    86|         return array_merge(parent::getSettingGqlTypes(), [
    87|             'checkedValue' => [
    88|                 'name' => 'checkedValue',
    89|                 'type' => Type::string(),
    90|             ],
    91|             'uncheckedValue' => [
    92|                 'name' => 'uncheckedValue',
    93|                 'type' => Type::string(),
    94|             ],
    95|             'defaultValue' => [
    96|                 'name' => 'defaultValue',
    97|                 'type' => Type::string(),
    98|                 'resolve' => function($field) {
    99|                     return (string)$field->defaultValue;
   100|                 },
   101|             ],
   102|             'defaultState' => [
   103|                 'name' => 'defaultState',
   104|                 'type' => Type::boolean(),
   105|             ],
   106|             'descriptionHtml' => [
   107|                 'name' => 'descriptionHtml',
   108|                 'type' => Type::string(),
   109|             ],
   110|         ]);
   111|     }
   112|     public function defineGeneralSchema(): array
   113|     {
   114|         return [
   115|             SchemaHelper::labelField(),
   116|             SchemaHelper::richTextField(array_merge([
   117|                 'label' => Craft::t('formie', 'Description'),
   118|                 'help' => Craft::t('formie', 'The description for the field. This will be shown next to the checkbox.'),
   119|                 'name' => 'description',
   120|                 'validation' => 'requiredRichText',
   121|                 'required' => true,
   122|             ], RichTextHelper::getRichTextConfig('fields.agree'))),
   123|             SchemaHelper::textField([
   124|                 'label' => Craft::t('formie', 'Checked Value'),
   125|                 'help' => Craft::t('formie', 'The value of this field when it is checked.'),
   126|                 'name' => 'checkedValue',
   127|                 'validation' => 'required',
   128|                 'required' => true,
   129|             ]),
   130|             SchemaHelper::textField([
   131|                 'label' => Craft::t('formie', 'Unchecked Value'),
   132|                 'help' => Craft::t('formie', 'The value of this field when it is unchecked.'),
   133|                 'name' => 'uncheckedValue',
   134|                 'validation' => 'required',
   135|                 'required' => true,
   136|             ]),
   137|             SchemaHelper::lightswitchField([
   138|                 'label' => Craft::t('formie', 'Default Value'),
   139|                 'help' => Craft::t('formie', 'The default value for the field when it loads.'),
   140|                 'name' => 'defaultValue',
   141|             ]),
   142|         ];
   143|     }
   144|     public function defineSettingsSchema(): array
   145|     {
   146|         return [
   147|             SchemaHelper::lightswitchField([
   148|                 'label' => Craft::t('formie', 'Required Field'),
   149|                 'help' => Craft::t('formie', 'Whether this field should be required when filling out the form.'),
   150|                 'name' => 'required',
   151|             ]),
   152|             SchemaHelper::textField([
   153|                 'label' => Craft::t('formie', 'Error Message'),
   154|                 'help' => Craft::t('formie', 'When validating the form, show this message if an error occurs. Leave empty to retain the default message.'),
   155|                 'name' => 'errorMessage',
   156|                 'if' => '$get(required).value',
   157|             ]),
   158|             SchemaHelper::prePopulate(),
   159|             SchemaHelper::includeInEmailField(),
   160|         ];
   161|     }
   162|     public function defineAppearanceSchema(): array
   163|     {
   164|         return [
   165|             SchemaHelper::visibility(),
   166|             SchemaHelper::labelPosition($this),
   167|             SchemaHelper::instructions(),
   168|             SchemaHelper::instructionsPosition($this),
   169|         ];
   170|     }
   171|     public function defineAdvancedSchema(): array
   172|     {
   173|         return [
   174|             SchemaHelper::handleField(),
   175|             SchemaHelper::cssClasses(),
   176|             SchemaHelper::containerAttributesField(),
   177|             SchemaHelper::inputAttributesField(),
   178|         ];
   179|     }
   180|     public function defineConditionsSchema(): array
   181|     {
   182|         return [
   183|             SchemaHelper::enableConditionsField(),
   184|             SchemaHelper::conditionsField(),
   185|         ];
   186|     }
   187|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   188|     {
   189|         $form = $context['form'] ?? null;
   190|         $id = $this->getHtmlId($form);
   191|         if ($key === 'fieldContainer') {
   192|             return new HtmlTag('fieldset', [
   193|                 'class' => [
   194|                     'fui-fieldset',
   195|                 ],
   196|                 'aria-describedby' => $this->instructions ? "{$id}-instructions" : null,
   197|             ]);
   198|         }
   199|         if ($key === 'fieldLabel') {
   200|             $labelPosition = $context['labelPosition'] ?? null;
   201|             return new HtmlTag('legend', [
   202|                 'class' => [
   203|                     'fui-legend',
   204|                 ],
   205|                 'data' => [
   206|                     'field-label' => true,
   207|                     'fui-sr-only' => $labelPosition instanceof HiddenPosition ? true : false,
   208|                 ],
   209|             ]);
   210|         }
   211|         if ($key === 'fieldOption') {
   212|             return new HtmlTag('div', [
   213|                 'class' => 'fui-checkbox',
   214|             ]);
   215|         }
   216|         if ($key === 'fieldInput') {
   217|             return new HtmlTag('input', [
   218|                 'type' => 'checkbox',
   219|                 'id' => $id,
   220|                 'class' => 'fui-input fui-checkbox-input',
   221|                 'name' => $this->getHtmlName(),
   222|                 'required' => $this->required ? true : null,
   223|                 'data' => [
   224|                     'fui-id' => $this->getHtmlDataId($form),
   225|                     'fui-input-type' => 'agree',
   226|                     'required-message' => Craft::t('formie', $this->errorMessage) ?: null,
   227|                 ],
   228|             ], $this->getInputAttributes());
   229|         }
   230|         if ($key === 'fieldOptionLabel') {
   231|             return new HtmlTag('label', [
   232|                 'class' => 'fui-checkbox-label',
   233|                 'for' => $id,
   234|             ]);
   235|         }
   236|         return parent::defineHtmlTag($key, $context);
   237|     }
   238|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
   239|     {
   240|         return Craft::$app->getView()->renderTemplate('formie/_formfields/agree/input', [
   241|             'name' => $this->handle,
   242|             'value' => $value,
   243|             'field' => $this,
   244|         ]);
   245|     }
   246|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
   247|     {
   248|         return ($value) ? $this->checkedValue : $this->uncheckedValue;
   249|     }
   250|     protected function defineValueForIntegration(mixed $value, IntegrationField $integrationField, IntegrationInterface $integration, ElementInterface $element = null, string $fieldKey = ''): mixed
   251|     {
   252|         if ($integrationField->getType() === IntegrationField::TYPE_BOOLEAN) {
   253|             return (bool)$value;
   254|         }
   255|         return parent::defineValueForIntegration($value, $integrationField, $integration, $element);
   256|     }
   257|     private function _getHtmlContent($content): ?string
   258|     {
   259|         $nodeType = $content[0]['type'] ?? null;
   260|         if (!$nodeType) {
   261|             return null;
   262|         }
   263|         return RichTextHelper::getHtmlContent($content);
   264|     }
   265| }


# ====================================================================
# FILE: src/fields/Date.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-1257 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\base\FieldInterface;
     6| use verbb\formie\base\Integration;
     7| use verbb\formie\base\IntegrationInterface;
     8| use verbb\formie\base\SubFieldInterface;
     9| use verbb\formie\base\SubField;
    10| use verbb\formie\elements\Submission;
    11| use verbb\formie\events\ModifyDateTimeFormatEvent;
    12| use verbb\formie\events\RegisterDateTimeFormatOpionsEvent;
    13| use verbb\formie\events\ModifyFrontEndSubFieldsEvent;
    14| use verbb\formie\fields\subfields\DateYear;
    15| use verbb\formie\gql\types\generators\FieldAttributeGenerator;
    16| use verbb\formie\helpers\ArrayHelper;
    17| use verbb\formie\helpers\SchemaHelper;
    18| use verbb\formie\helpers\StringHelper;
    19| use verbb\formie\models\FieldLayout;
    20| use verbb\formie\models\HtmlTag;
    21| use verbb\formie\models\IntegrationField;
    22| use verbb\formie\models\Notification;
    23| use verbb\formie\models\Settings;
    24| use verbb\formie\positions\Hidden as HiddenPosition;
    25| use Craft;
    26| use craft\base\Element;
    27| use craft\base\ElementInterface;
    28| use craft\base\PreviewableFieldInterface;
    29| use craft\base\SortableFieldInterface;
    30| use craft\gql\types\DateTime as DateTimeType;
    31| use craft\helpers\Component;
    32| use craft\helpers\DateTimeHelper;
    33| use craft\helpers\Db;
    34| use craft\helpers\Json;
    35| use craft\i18n\Locale;
    36| use Faker\Generator as FakerFactory;
    37| use GraphQL\Type\Definition\Type;
    38| use yii\base\Event;
    39| use yii\db\Schema;
    40| use yii\validators\RequiredValidator;
    41| use yii\validators\Validator;
    42| use DateTime;
    43| use DateTimeZone;
    44| class Date extends SubField implements PreviewableFieldInterface, SortableFieldInterface
    45| {
    46|     public const EVENT_MODIFY_DATE_FORMAT = 'modifyDateFormat';
    47|     public const EVENT_MODIFY_TIME_FORMAT = 'modifyTimeFormat';
    48|     public const EVENT_REGISTER_DATE_FORMAT_OPTIONS = 'registerDateFormatOptions';
    49|     public const EVENT_REGISTER_TIME_FORMAT_OPTIONS = 'registerTimeFormatOptions';
    50|     public static function displayName(): string
    51|     {
    52|         return Craft::t('formie', 'Date/Time');
    53|     }
    54|     public static function getSvgIconPath(): string
    55|     {
    56|         return 'formie/_formfields/date/icon.svg';
    57|     }
    58|     public static function toDateTime($value): DateTime|bool
    59|     {
    60|         return DateTimeHelper::toDateTime($value, false, false);
    61|     }
    62|     public static function dbType(): string
    63|     {
    64|         return Schema::TYPE_DATETIME;
    65|     }
    66|     public string $dateFormat = 'Y-m-d';
    67|     public string $timeFormat = 'H:i';
    68|     public string $displayType = 'calendar';
    69|     public ?string $defaultOption = null;
    70|     public array $datePickerOptions = [];
    71|     public string $minDateOption = '';
    72|     public DateTime|string|null $minDate = null;
    73|     public string $minDateOffset = 'add';
    74|     public int $minDateOffsetNumber = 0;
    75|     public string $minDateOffsetType = 'days';
    76|     public string $maxDateOption = '';
    77|     public DateTime|string|null $maxDate = null;
    78|     public string $maxDateOffset = 'add';
    79|     public int $maxDateOffsetNumber = 0;
    80|     public string $maxDateOffsetType = 'days';
    81|     public mixed $availableDaysOfWeek = '*';
    82|     public function __construct($config = [])
    83|     {
    84|         if (array_key_exists('layouts', $config)) {
    85|             unset($config['layouts']);
    86|         }
    87|         if (isset($config['minDate'])) {
    88|             if (!($config['minDate'] instanceof DateTime)) {
    89|                 $config['minDate'] = DateTimeHelper::toDateTime($config['minDate'], false, false) ?: null;
    90|             }
    91|         }
    92|         if (isset($config['maxDate'])) {
    93|             if (!($config['maxDate'] instanceof DateTime)) {
    94|                 $config['maxDate'] = DateTimeHelper::toDateTime($config['maxDate'], false, false) ?: null;
    95|             }
    96|         }
    97|         if (isset($config['defaultOption'])) {
    98|             if (isset($config['defaultValue']) && $config['defaultOption'] === 'date') {
    99|                 if (!($config['defaultValue'] instanceof DateTime)) {
   100|                     $config['defaultValue'] = DateTimeHelper::toDateTime($config['defaultValue'], false, false) ?: null;
   101|                 }
   102|             } else if ($config['defaultOption'] === 'today') {
   103|                 $config['defaultValue'] = DateTimeHelper::toDateTime(new DateTime('today'), false, false);
   104|             } else {
   105|                 $config['defaultValue'] = null;
   106|             }
   107|         } else {
   108|             $config['defaultValue'] = null;
   109|         }
   110|         if (array_key_exists('useDatePicker', $config) && $config['useDatePicker']) {
   111|             $config['displayType'] = 'datePicker';
   112|         }
   113|         unset(
   114|             $config['dayLabel'],
   115|             $config['dayPlaceholder'],
   116|             $config['monthLabel'],
   117|             $config['monthPlaceholder'],
   118|             $config['yearLabel'],
   119|             $config['yearPlaceholder'],
   120|             $config['hourLabel'],
   121|             $config['hourPlaceholder'],
   122|             $config['minuteLabel'],
   123|             $config['minutePlaceholder'],
   124|             $config['secondLabel'],
   125|             $config['secondPlaceholder'],
   126|             $config['ampmLabel'],
   127|             $config['ampmPlaceholder'],
   128|             $config['minYearRange'],
   129|             $config['maxYearRange'],
   130|             $config['timeLabel'],
   131|             $config['includeDate'],
   132|             $config['includeTime'],
   133|             $config['useDatePicker'],
   134|         );
   135|         /* @var Settings $settings */
   136|         $settings = Formie::$plugin->getSettings();
   137|         if (!isset($config['displayType'])) {
   138|             $config['displayType'] = $settings->defaultDateDisplayType ?: 'calendar';
   139|         }
   140|         if (!isset($config['defaultOption'])) {
   141|             $config['defaultOption'] = $settings->defaultDateValueOption ?: '';
   142|         }
   143|         if (!isset($config['defaultValue'])) {
   144|             $config['defaultValue'] = $settings->getDefaultDateTimeValue();
   145|         }
   146|         $config['required'] = false;
   147|         parent::__construct($config);
   148|     }
   149|     public function getIsRequired(): ?bool
   150|     {
   151|         if (in_array($this->displayType, ['calendar', 'datePicker'])) {
   152|             foreach ($this->getFields() as $field) {
   153|                 if ($field->getIsRequired()) {
   154|                     return true;
   155|                 }
   156|             }
   157|         }
   158|         return parent::getIsRequired();
   159|     }
   160|     public function getFormBuilderSettings(): array
   161|     {
   162|         $settings = parent::getFormBuilderSettings();
   163|         if ($this->displayType === 'dropdowns') {
   164|             $settings['layouts']['dropdowns'] = $settings['rows'];
   165|         } else {
   166|             $fieldLayout = new FieldLayout();
   167|             $fieldLayout->setPages([['rows' => $this->getDropdownSubFields()]]);
   168|             $settings['layouts']['dropdowns'] = $fieldLayout->getFormBuilderConfig()[0]['rows'] ?? [];
   169|         }
   170|         if ($this->displayType === 'inputs') {
   171|             $settings['layouts']['inputs'] = $settings['rows'];
   172|         } else {
   173|             $fieldLayout = new FieldLayout();
   174|             $fieldLayout->setPages([['rows' => $this->getInputSubFields()]]);
   175|             $settings['layouts']['inputs'] = $fieldLayout->getFormBuilderConfig()[0]['rows'] ?? [];
   176|         }
   177|         if ($this->displayType === 'calendar' || $this->displayType === 'datePicker') {
   178|             $settings['layouts']['calendar'] = $settings['rows'];
   179|         } else {
   180|             $fieldLayout = new FieldLayout();
   181|             $fieldLayout->setPages([['rows' => $this->getCalendarSubFields()]]);
   182|             $settings['layouts']['calendar'] = $fieldLayout->getFormBuilderConfig()[0]['rows'] ?? [];
   183|         }
   184|         return $settings;
   185|     }
   186|     public function getDateFormat(): ?string
   187|     {
   188|         $event = new ModifyDateTimeFormatEvent([
   189|             'field' => $this,
   190|             'dateFormat' => $this->dateFormat,
   191|         ]);
   192|         Event::trigger(static::class, self::EVENT_MODIFY_DATE_FORMAT, $event);
   193|         return $event->dateFormat;
   194|     }
   195|     public function getTimeFormat(): ?string
   196|     {
   197|         $event = new ModifyDateTimeFormatEvent([
   198|             'field' => $this,
   199|             'timeFormat' => $this->timeFormat,
   200|         ]);
   201|         Event::trigger(static::class, self::EVENT_MODIFY_TIME_FORMAT, $event);
   202|         return $event->timeFormat;
   203|     }
   204|     public function getPreviewHtml(mixed $value, ElementInterface $element): string
   205|     {
   206|         $html = '';
   207|         $timeZone = Craft::$app->getFormatter()->timeZone;
   208|         Craft::$app->getFormatter()->timeZone = 'UTC';
   209|         if ($value) {
   210|             if ($this->getIsDateTime()) {
   211|                 $html = Craft::$app->getFormatter()->asDatetime($value, Locale::LENGTH_SHORT);
   212|             } else if ($this->getIsTime()) {
   213|                 $html = Craft::$app->getFormatter()->asTime($value, Locale::LENGTH_SHORT);
   214|             } else if ($this->getIsDate()) {
   215|                 $html = Craft::$app->getFormatter()->asDate($value, Locale::LENGTH_SHORT);
   216|             }
   217|         }
   218|         Craft::$app->getFormatter()->timeZone = $timeZone;
   219|         return $html;
   220|     }
   221|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
   222|     {
   223|         if (!$value || $value instanceof DateTime) {
   224|             return $value;
   225|         }
   226|         if ($this->displayType === 'dropdowns' || $this->displayType === 'inputs') {
   227|             if (is_array($value)) {
   228|                 $value = array_filter($value);
   229|                 $year = isset($value['year']) ? intval($value['year']) : null;
   230|                 $month = isset($value['month']) ? intval($value['month']) : null;
   231|                 $day = isset($value['day']) ? intval($value['day']) : null;
   232|                 $hour = isset($value['hour']) ? intval($value['hour']) : null;
   233|                 $minute = isset($value['minute']) ? intval($value['minute']) : null;
   234|                 $second = isset($value['second']) ? intval($value['second']) : null;
   235|                 if ($year === null || $month === null || $day === null) {
   236|                     $value = null;
   237|                 } else {
   238|                     $value = sprintf("%04d-%02d-%02d %02d:%02d:%02d", $year, $month, $day, $hour, $minute, $second);
   239|                 }
   240|             }
   241|         } else if ($this->displayType === 'calendar') {
   242|             if (is_array($value)) {
   243|                 $value = array_filter($value);
   244|             }
   245|         } else if ($this->displayType === 'datePicker') {
   246|             if (is_array($value)) {
   247|                 $value['datetime'] = ArrayHelper::remove($value, 'date') ?? ArrayHelper::remove($value, 'time');
   248|             }
   249|         }
   250|         if (($date = self::toDateTime($value)) !== false) {
   251|             return $date;
   252|         }
   253|         return null;
   254|     }
   255|     public function serializeValue(mixed $value, ?ElementInterface $element): mixed
   256|     {
   257|         if ($value instanceof DateTime || DateTimeHelper::isIso8601($value)) {
   258|             return Db::prepareDateForDb($value);
   259|         }
   260|         return $value;
   261|     }
   262|     public function getMinDate()
   263|     {
   264|         if ($this->minDateOption === 'today') {
   265|             $operator = $this->minDateOffset === 'add' ? '+' : '-';
   266|             $interval = "{$operator}{$this->minDateOffsetNumber} {$this->minDateOffsetType}";
   267|             return self::toDateTime(DateTimeHelper::now())->modify($interval)->setTime(0, 0, 0);
   268|         }
   269|         if ($this->minDateOption === 'date' && $this->minDate) {
   270|             return $this->minDate->setTime(0, 0, 0);
   271|         }
   272|         return null;
   273|     }
   274|     public function getMaxDate()
   275|     {
   276|         if ($this->maxDateOption === 'today') {
   277|             $operator = $this->maxDateOffset === 'add' ? '+' : '-';
   278|             $interval = "{$operator}{$this->maxDateOffsetNumber} {$this->maxDateOffsetType}";
   279|             return self::toDateTime(DateTimeHelper::now())->modify($interval)->setTime(23, 59, 59);
   280|         }
   281|         if ($this->maxDateOption === 'date' && $this->maxDate) {
   282|             return $this->maxDate->setTime(23, 59, 59);
   283|         }
   284|         return null;
   285|     }
   286|     public function getElementValidationRules(): array
   287|     {
   288|         $rules = parent::getElementValidationRules();
   289|         $rules[] = [$this->handle, 'validateDateValues'];
   290|         return $rules;
   291|     }
   292|     public function validateBlocks(ElementInterface $element): void
   293|     {
   294|         $value = $element->getFieldValue($this->fieldKey);
   295|         $scenario = $element->getScenario();
   296|         foreach ($this->getFields() as $field) {
   297|             if ($field->isConditionallyHidden($element) || $field->getIsDisabled()) {
   298|                 continue;
   299|             }
   300|             $attribute = 'field:' . $field->getErrorKey();
   301|             $isEmpty = fn() => $field->isValueEmpty($value, $element);
   302|             if ($this->displayType === 'calendar' || $this->displayType === 'datePicker') {
   303|                 $attribute = preg_replace('/(\.date|\.time)$/', '', $attribute);
   304|             }
   305|             if ($scenario === Element::SCENARIO_LIVE && $field->required) {
   306|                 (new RequiredValidator(['isEmpty' => $isEmpty]))->validateAttribute($element, $attribute);
   307|             }
   308|             foreach ($field->getElementValidationRules() as $rule) {
   309|                 $validator = $this->normalizeFieldValidator($attribute, $rule, $field, $element, $isEmpty);
   310|                 if (in_array($scenario, $validator->on) || (empty($validator->on) && !in_array($scenario, $validator->except))) {
   311|                     $validator->validateAttributes($element);
   312|                 }
   313|             }
   314|         }
   315|     }
   316|     public function validateDateValues(ElementInterface $element): void
   317|     {
   318|         $value = $element->getFieldValue($this->fieldKey);
   319|         if (!$value instanceof DateTime) {
   320|             $value = DateTimeHelper::toDateTime($value);
   321|         }
   322|         if (!$value) {
   323|             return;
   324|         }
   325|         if ($min = $this->getMinDate()) {
   326|             if ($value < $min) {
   327|                 $element->addError($this->fieldKey, Craft::t('formie', 'Value must be no earlier than {min}.', [
   328|                     'min' => Craft::$app->getFormatter()->asDate($min, Locale::LENGTH_SHORT),
   329|                 ]));
   330|             }
   331|         }
   332|         if ($max = $this->getMaxDate()) {
   333|             if ($value > $max) {
   334|                 $element->addError($this->fieldKey, Craft::t('formie', 'Value must be no later than {max}.', [
   335|                     'max' => Craft::$app->getFormatter()->asDate($max, Locale::LENGTH_SHORT),
   336|                 ]));
   337|             }
   338|         }
   339|     }
   340|     public function getIsDate(): bool
   341|     {
   342|         if ($this->displayType === 'calendar' || $this->displayType === 'datePicker') {
   343|             if ($this->getFieldByHandle('date')?->enabled && !$this->getFieldByHandle('time')?->enabled) {
   344|                 return true;
   345|             }
   346|         }
   347|         if ($this->displayType === 'inputs' || $this->displayType === 'dropdowns') {
   348|             if (
   349|                 $this->getFieldByHandle('year')?->enabled &&
   350|                 $this->getFieldByHandle('month')?->enabled &&
   351|                 $this->getFieldByHandle('day')?->enabled &&
   352|                 !$this->getFieldByHandle('hour')?->enabled &&
   353|                 !$this->getFieldByHandle('minute')?->enabled
   354|             ) {
   355|                 return true;
   356|             }
   357|         }
   358|         return false;
   359|     }
   360|     public function getIsTime(): bool
   361|     {
   362|         if ($this->displayType === 'calendar' || $this->displayType === 'datePicker') {
   363|             if (!$this->getFieldByHandle('date')?->enabled && $this->getFieldByHandle('time')?->enabled) {
   364|                 return true;
   365|             }
   366|         }
   367|         if ($this->displayType === 'inputs' || $this->displayType === 'dropdowns') {
   368|             if (
   369|                 !$this->getFieldByHandle('year')?->enabled &&
   370|                 !$this->getFieldByHandle('month')?->enabled &&
   371|                 !$this->getFieldByHandle('day')?->enabled &&
   372|                 $this->getFieldByHandle('hour')?->enabled &&
   373|                 $this->getFieldByHandle('minute')?->enabled
   374|             ) {
   375|                 return true;
   376|             }
   377|         }
   378|         return false;
   379|     }
   380|     public function getIsDateTime(): bool
   381|     {
   382|         if ($this->displayType === 'calendar' || $this->displayType === 'datePicker') {
   383|             if ($this->getFieldByHandle('date')?->enabled && $this->getFieldByHandle('time')?->enabled) {
   384|                 return true;
   385|             }
   386|         }
   387|         if ($this->displayType === 'inputs' || $this->displayType === 'dropdowns') {
   388|             if (
   389|                 $this->getFieldByHandle('year')?->enabled &&
   390|                 $this->getFieldByHandle('month')?->enabled &&
   391|                 $this->getFieldByHandle('day')?->enabled &&
   392|                 $this->getFieldByHandle('hour')?->enabled &&
   393|                 $this->getFieldByHandle('minute')?->enabled
   394|             ) {
   395|                 return true;
   396|             }
   397|         }
   398|         return false;
   399|     }
   400|     public function getPreviewInputHtml(): string
   401|     {
   402|         return Craft::$app->getView()->renderTemplate('formie/_formfields/date/preview', [
   403|             'field' => $this,
   404|         ]);
   405|     }
   406|     public function getDefaultDate(): ?string
   407|     {
   408|         if ($this->defaultValue instanceof DateTime) {
   409|             return $this->defaultValue->format('Y-m-d\TH:i:s');
   410|         }
   411|         return $this->defaultValue;
   412|     }
   413|     public function getFormattingChar(string $name): ?string
   414|     {
   415|         $formattingMap = [
   416|             'year' => 'Y',
   417|             'month' => 'm',
   418|             'day' => 'd',
   419|             'hour' => 'H',
   420|             'minute' => 'i',
   421|             'second' => 's',
   422|             'ampm' => 'A',
   423|         ];
   424|         return $formattingMap[$name] ?? null;
   425|     }
   426|     public function getFrontEndJsModules(): ?array
   427|     {
   428|         if ($this->displayType === 'datePicker') {
   429|             $locale = Craft::$app->getLocale()->id;
   430|             if (preg_match('/^([a-z]{2})-/', $locale, $matches)) {
   431|                 $locale = $matches[1];
   432|             }
   433|             $supportedLocales = ['ar', 'at', 'az', 'be', 'bg', 'bn', 'cat', 'cs', 'cy', 'da', 'de', 'eo', 'es', 'et', 'fa', 'fi', 'fo', 'fr', 'gr', 'he', 'hi', 'hr', 'hu', 'id', 'is', 'it', 'ja', 'km', 'ko', 'kz', 'lt', 'lv', 'mk', 'mn', 'ms', 'my', 'nl', 'no', 'pa', 'pl', 'pt', 'ro', 'ru', 'si', 'sk', 'sl', 'sq', 'sr-cyr', 'sr', 'sv', 'th', 'tr', 'uk', 'vn', 'zh-tw', 'zh'];
   434|             if (in_array(strtolower($locale), $supportedLocales, true)) {
   435|                 $locale = strtolower($locale);
   436|             }
   437|             $minDate = $this->getMinDate();
   438|             $maxDate = $this->getMaxDate();
   439|             if ($minDate) {
   440|                 $minDate = $minDate->format('Y-m-d H:i:s');
   441|             }
   442|             if ($maxDate) {
   443|                 $maxDate = $maxDate->format('Y-m-d H:i:s');
   444|             }
   445|             $datePickerOptions = $this->datePickerOptions ?? [];
   446|             foreach ($datePickerOptions as $key => $option) {
   447|                 $datePickerOptions[$key]['value'] = Json::decodeIfJson($option['value']);
   448|             }
   449|             return [
   450|                 'src' => Craft::$app->getAssetManager()->getPublishedUrl('@verbb/formie/web/assets/frontend/dist/', true, 'js/fields/date-picker.js'),
   451|                 'module' => 'FormieDatePicker',
   452|                 'settings' => [
   453|                     'datePickerOptions' => $datePickerOptions,
   454|                     'dateFormat' => $this->getDateFormat(),
   455|                     'timeFormat' => $this->getTimeFormat(),
   456|                     'getIsDate' => $this->getIsDate(),
   457|                     'getIsTime' => $this->getIsTime(),
   458|                     'getIsDateTime' => $this->getIsDateTime(),
   459|                     'locale' => $locale,
   460|                     'minDate' => $minDate,
   461|                     'maxDate' => $maxDate,
   462|                     'availableDaysOfWeek' => $this->availableDaysOfWeek,
   463|                 ],
   464|             ];
   465|         }
   466|         return null;
   467|     }
   468|     public function getWeekDayNamesOptions(): array
   469|     {
   470|         $options = [['label' => Craft::t('formie', 'All'), 'value' => '*']];
   471|         foreach (Craft::$app->getLocale()->getWeekDayNames(Locale::LENGTH_FULL) as $key => $value) {
   472|             $options[] = ['label' => $value, 'value' => $key];
   473|         }
   474|         return $options;
   475|     }
   476|     public function beforeSave(bool $isNew): bool
   477|     {
   478|         if ($this->defaultValue instanceof DateTime) {
   479|             $this->defaultValue = Db::prepareDateForDb($this->defaultValue);
   480|         }
   481|         if ($this->minDate instanceof DateTime) {
   482|             $this->minDate = Db::prepareDateForDb($this->minDate);
   483|         }
   484|         if ($this->maxDate instanceof DateTime) {
   485|             $this->maxDate = Db::prepareDateForDb($this->maxDate);
   486|         }
   487|         return parent::beforeSave($isNew);
   488|     }
   489|     public function defineGeneralSchema(): array
   490|     {
   491|         return [
   492|             SchemaHelper::labelField(),
   493|             SchemaHelper::selectField([
   494|                 'label' => Craft::t('formie', 'Default Value'),
   495|                 'help' => Craft::t('formie', 'Select a default value for this field.'),
   496|                 'name' => 'defaultOption',
   497|                 'options' => [
   498|                     ['label' => Craft::t('formie', 'None'), 'value' => ''],
   499|                     ['label' => Craft::t('formie', 'Today‘s Date/Time'), 'value' => 'today'],
   500|                     ['label' => Craft::t('formie', 'Specific Date/Time'), 'value' => 'date'],
   501|                 ],
   502|             ]),
   503|             SchemaHelper::dateField([
   504|                 'label' => Craft::t('formie', 'Default Date/Time'),
   505|                 'help' => Craft::t('formie', 'Set a default value for the field when it doesn’t have a value.'),
   506|                 'name' => 'defaultValue',
   507|                 'if' => '$get(defaultOption).value == date',
   508|                 'validation' => 'requiredDate',
   509|                 'required' => true,
   510|             ]),
   511|             SchemaHelper::selectField([
   512|                 'label' => Craft::t('formie', 'Display Type'),
   513|                 'help' => Craft::t('formie', 'Set different display layouts for this field.'),
   514|                 'name' => 'displayType',
   515|                 'options' => [
   516|                     ['label' => Craft::t('formie', 'Calendar (Simple)'), 'value' => 'calendar'],
   517|                     ['label' => Craft::t('formie', 'Calendar (Advanced)'), 'value' => 'datePicker'],
   518|                     ['label' => Craft::t('formie', 'Dropdowns'), 'value' => 'dropdowns'],
   519|                     ['label' => Craft::t('formie', 'Text Inputs'), 'value' => 'inputs'],
   520|                 ],
   521|             ]),
   522|             SchemaHelper::subFieldsConfigurationField([
   523|                 'children' => [
   524|                     [
   525|                         '$cmp' => 'SubFields',
   526|                         'if' => '$get(displayType).value == dropdowns',
   527|                         'props' => [
   528|                             'context' => '$node.context',
   529|                             'type' => static::class,
   530|                             'layoutKey' => 'layouts.dropdowns',
   531|                         ],
   532|                     ],
   533|                     [
   534|                         '$cmp' => 'SubFields',
   535|                         'if' => '$get(displayType).value == inputs',
   536|                         'props' => [
   537|                             'context' => '$node.context',
   538|                             'type' => static::class,
   539|                             'layoutKey' => 'layouts.inputs',
   540|                         ],
   541|                     ],
   542|                     [
   543|                         '$cmp' => 'SubFields',
   544|                         'if' => '$get(displayType).value == calendar || $get(displayType).value == datePicker',
   545|                         'props' => [
   546|                             'context' => '$node.context',
   547|                             'type' => static::class,
   548|                             'layoutKey' => 'layouts.calendar',
   549|                         ],
   550|                     ],
   551|                 ],
   552|             ]),
   553|         ];
   554|     }
   555|     public function defineSettingsSchema(): array
   556|     {
   557|         return [
   558|             SchemaHelper::prePopulate(),
   559|             SchemaHelper::includeInEmailField(),
   560|             SchemaHelper::selectField([
   561|                 'label' => Craft::t('formie', 'Min Date'),
   562|                 'help' => Craft::t('formie', 'Set a minimum date for dates to be picked from.'),
   563|                 'name' => 'minDateOption',
   564|                 'if' => '$get(displayType).value == calendar || $get(displayType).value == datePicker',
   565|                 'options' => [
   566|                     ['label' => Craft::t('formie', 'None'), 'value' => ''],
   567|                     ['label' => Craft::t('formie', 'Today‘s Date/Time'), 'value' => 'today'],
   568|                     ['label' => Craft::t('formie', 'Specific Date/Time'), 'value' => 'date'],
   569|                 ],
   570|             ]),
   571|             SchemaHelper::dateField([
   572|                 'label' => Craft::t('formie', 'Min Date'),
   573|                 'help' => Craft::t('formie', 'Set a minimum date for dates to be picked from.'),
   574|                 'name' => 'minDate',
   575|                 'if' => '$get(minDateOption).value == date',
   576|             ]),
   577|             [
   578|                 '$formkit' => 'fieldWrap',
   579|                 'label' => Craft::t('formie', 'Offset'),
   580|                 'help' => Craft::t('formie', 'Enter an optional offset for today‘s date.'),
   581|                 'if' => '$get(minDateOption).value == today',
   582|                 'children' => [
   583|                     [
   584|                         '$el' => 'div',
   585|                         'attrs' => [
   586|                             'class' => 'flex',
   587|                         ],
   588|                         'children' => [
   589|                             SchemaHelper::selectField([
   590|                                 'name' => 'minDateOffset',
   591|                                 'options' => [
   592|                                     ['label' => Craft::t('formie', 'Add'), 'value' => 'add'],
   593|                                     ['label' => Craft::t('formie', 'Subtract'), 'value' => 'subtract'],
   594|                                 ],
   595|                             ]),
   596|                             SchemaHelper::numberField([
   597|                                 'name' => 'minDateOffsetNumber',
   598|                                 'inputClass' => 'text flex-grow',
   599|                             ]),
   600|                             SchemaHelper::selectField([
   601|                                 'name' => 'minDateOffsetType',
   602|                                 'options' => [
   603|                                     ['label' => Craft::t('formie', 'Days'), 'value' => 'days'],
   604|                                     ['label' => Craft::t('formie', 'Weeks'), 'value' => 'weeks'],
   605|                                     ['label' => Craft::t('formie', 'Months'), 'value' => 'months'],
   606|                                     ['label' => Craft::t('formie', 'Years'), 'value' => 'years'],
   607|                                 ],
   608|                             ]),
   609|                         ],
   610|                     ],
   611|                 ],
   612|             ],
   613|             SchemaHelper::selectField([
   614|                 'label' => Craft::t('formie', 'Max Date'),
   615|                 'help' => Craft::t('formie', 'Set a maximum date for dates to be picked up to.'),
   616|                 'name' => 'maxDateOption',
   617|                 'if' => '$get(displayType).value == calendar || $get(displayType).value == datePicker',
   618|                 'options' => [
   619|                     ['label' => Craft::t('formie', 'None'), 'value' => ''],
   620|                     ['label' => Craft::t('formie', 'Today‘s Date/Time'), 'value' => 'today'],
   621|                     ['label' => Craft::t('formie', 'Specific Date/Time'), 'value' => 'date'],
   622|                 ],
   623|             ]),
   624|             SchemaHelper::dateField([
   625|                 'label' => Craft::t('formie', 'Max Date'),
   626|                 'help' => Craft::t('formie', 'Set a maximum date for dates to be picked up to.'),
   627|                 'name' => 'maxDate',
   628|                 'if' => '$get(maxDateOption).value == date',
   629|             ]),
   630|             [
   631|                 '$formkit' => 'fieldWrap',
   632|                 'label' => Craft::t('formie', 'Offset'),
   633|                 'help' => Craft::t('formie', 'Enter an optional offset for today‘s date.'),
   634|                 'if' => '$get(maxDateOption).value == today',
   635|                 'children' => [
   636|                     [
   637|                         '$el' => 'div',
   638|                         'attrs' => [
   639|                             'class' => 'flex',
   640|                         ],
   641|                         'children' => [
   642|                             SchemaHelper::selectField([
   643|                                 'name' => 'maxDateOffset',
   644|                                 'options' => [
   645|                                     ['label' => Craft::t('formie', 'Add'), 'value' => 'add'],
   646|                                     ['label' => Craft::t('formie', 'Subtract'), 'value' => 'subtract'],
   647|                                 ],
   648|                             ]),
   649|                             SchemaHelper::numberField([
   650|                                 'name' => 'maxDateOffsetNumber',
   651|                                 'inputClass' => 'text flex-grow',
   652|                             ]),
   653|                             SchemaHelper::selectField([
   654|                                 'name' => 'maxDateOffsetType',
   655|                                 'options' => [
   656|                                     ['label' => Craft::t('formie', 'Days'), 'value' => 'days'],
   657|                                     ['label' => Craft::t('formie', 'Weeks'), 'value' => 'weeks'],
   658|                                     ['label' => Craft::t('formie', 'Months'), 'value' => 'months'],
   659|                                     ['label' => Craft::t('formie', 'Years'), 'value' => 'years'],
   660|                                 ],
   661|                             ]),
   662|                         ],
   663|                     ],
   664|                 ],
   665|             ],
   666|             SchemaHelper::checkboxSelectField([
   667|                 'label' => Craft::t('formie', 'Available Days'),
   668|                 'help' => Craft::t('formie', 'Choose which days of the week should be available.'),
   669|                 'name' => 'availableDaysOfWeek',
   670|                 'if' => '$get(displayType).value == datePicker',
   671|                 'options' => $this->getWeekDayNamesOptions(),
   672|                 'showAllOption' => true,
   673|             ]),
   674|             SchemaHelper::tableField([
   675|                 'label' => Craft::t('formie', 'Date Picker Options'),
   676|                 'help' => Craft::t('formie', 'Add any additional options for the date picker to use. For available options, refer to the [Flatpickr.js docs](https://flatpickr.js.org/options/).'),
   677|                 'name' => 'datePickerOptions',
   678|                 'generateValue' => false,
   679|                 'validation' => 'min:0',
   680|                 'if' => '$get(displayType).value == datePicker',
   681|                 'newRowDefaults' => [
   682|                     'label' => '',
   683|                     'value' => '',
   684|                 ],
   685|                 'columns' => [
   686|                     [
   687|                         'type' => 'label',
   688|                         'label' => Craft::t('formie', 'Option'),
   689|                         'class' => 'singleline-cell textual',
   690|                     ],
   691|                     [
   692|                         'type' => 'value',
   693|                         'label' => Craft::t('formie', 'Value'),
   694|                         'class' => 'code singleline-cell textual',
   695|                     ],
   696|                 ],
   697|             ]),
   698|         ];
   699|     }
   700|     public function defineAppearanceSchema(): array
   701|     {
   702|         return [
   703|             SchemaHelper::visibility(),
   704|             SchemaHelper::labelPosition($this),
   705|             SchemaHelper::subFieldLabelPosition([
   706|                 'if' => '$get(displayType).value != calendar && $get(displayType).value != datePicker',
   707|             ]),
   708|             SchemaHelper::selectField([
   709|                 'label' => Craft::t('formie', 'Date Format'),
   710|                 'help' => Craft::t('formie', 'Select what format to present dates as.'),
   711|                 'name' => 'dateFormat',
   712|                 'options' => $this->_getDateFormatOptions(),
   713|             ]),
   714|             SchemaHelper::selectField([
   715|                 'label' => Craft::t('formie', 'Time Format'),
   716|                 'help' => Craft::t('formie', 'Select what format to present dates as.'),
   717|                 'name' => 'timeFormat',
   718|                 'options' => $this->_getTimeFormatOptions(),
   719|             ]),
   720|             SchemaHelper::instructions(),
   721|             SchemaHelper::instructionsPosition($this),
   722|         ];
   723|     }
   724|     public function defineAdvancedSchema(): array
   725|     {
   726|         return [
   727|             SchemaHelper::handleField(),
   728|             SchemaHelper::cssClasses(),
   729|             SchemaHelper::containerAttributesField(),
   730|             SchemaHelper::inputAttributesField([
   731|                 'if' => '$get(displayType).value == calendar || $get(displayType).value == datePicker',
   732|             ]),
   733|         ];
   734|     }
   735|     public function defineConditionsSchema(): array
   736|     {
   737|         return [
   738|             SchemaHelper::enableConditionsField(),
   739|             SchemaHelper::conditionsField(),
   740|         ];
   741|     }
   742|     public function getContentGqlType(): array|Type
   743|     {
   744|         return DateTimeType::getType();
   745|     }
   746|     public function getContentGqlMutationArgumentType(): Type|array
   747|     {
   748|         return [
   749|             'name' => $this->handle,
   750|             'type' => DateTimeType::getType(),
   751|             'description' => $this->instructions,
   752|         ];
   753|     }
   754|     public function getSettingGqlTypes(): array
   755|     {
   756|         return array_merge(parent::getSettingGqlTypes(), [
   757|             'defaultValue' => [
   758|                 'name' => 'defaultValue',
   759|                 'type' => Type::string(),
   760|                 'resolve' => function($field) {
   761|                     if ($field->defaultValue instanceof DateTime) {
   762|                         return $field->defaultValue->format('Y-m-d\TH:i:s');
   763|                     }
   764|                     return $field->defaultValue;
   765|                 },
   766|             ],
   767|             'displayType' => [
   768|                 'name' => 'displayType',
   769|                 'type' => Type::string(),
   770|             ],
   771|             'defaultDate' => [
   772|                 'name' => 'defaultDate',
   773|                 'type' => DateTimeType::getType(),
   774|             ],
   775|             'minDate' => [
   776|                 'name' => 'minDate',
   777|                 'type' => DateTimeType::getType(),
   778|                 'resolve' => function($field) {
   779|                     if ($field->minDate instanceof DateTime) {
   780|                         return $field->minDate->format('Y-m-d\TH:i:s');
   781|                     }
   782|                     return $field->minDate;
   783|                 },
   784|             ],
   785|             'maxDate' => [
   786|                 'name' => 'maxDate',
   787|                 'type' => DateTimeType::getType(),
   788|                 'resolve' => function($field) {
   789|                     if ($field->maxDate instanceof DateTime) {
   790|                         return $field->maxDate->format('Y-m-d\TH:i:s');
   791|                     }
   792|                     return $field->maxDate;
   793|                 },
   794|             ],
   795|             'datePickerOptions' => [
   796|                 'name' => 'datePickerOptions',
   797|                 'type' => Type::listOf(FieldAttributeGenerator::generateType()),
   798|             ],
   799|             'availableDaysOfWeek' => [
   800|                 'name' => 'availableDaysOfWeek',
   801|                 'type' => Type::listOf(Type::string()),
   802|                 'resolve' => function($field) {
   803|                     $values = [];
   804|                     $options = ArrayHelper::index($field->getWeekDayNamesOptions(), 'value');
   805|                     if (is_array($field->availableDaysOfWeek)) {
   806|                         foreach ($field->availableDaysOfWeek as $number) {
   807|                             $values[] = $options[$number]['label'] ?? null;
   808|                         }
   809|                     }
   810|                     if ($field->availableDaysOfWeek === '*') {
   811|                         foreach ($options as $option) {
   812|                             if ($option['value'] != '*') {
   813|                                 $values[] = $option['label'];
   814|                             }
   815|                         }
   816|                     }
   817|                     return $values;
   818|                 },
   819|             ],
   820|         ]);
   821|     }
   822|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   823|     {
   824|         $form = $context['form'] ?? null;
   825|         $errors = $context['errors'] ?? null;
   826|         $id = $this->getHtmlId($form);
   827|         $dataId = $this->getHtmlDataId($form);
   828|         if ($this->displayType !== 'datePicker') {
   829|             if ($key === 'fieldContainer') {
   830|                 return new HtmlTag('fieldset', [
   831|                     'class' => 'fui-fieldset fui-subfield-fieldset',
   832|                 ]);
   833|             }
   834|             if ($key === 'fieldLabel') {
   835|                 $labelPosition = $context['labelPosition'] ?? null;
   836|                 return new HtmlTag('legend', [
   837|                     'class' => [
   838|                         'fui-legend',
   839|                     ],
   840|                     'data' => [
   841|                         'field-label' => true,
   842|                         'fui-sr-only' => $labelPosition instanceof HiddenPosition ? true : false,
   843|                     ],
   844|                 ]);
   845|             }
   846|         }
   847|         if ($key === 'fieldInput' && $this->displayType === 'datePicker') {
   848|             return new HtmlTag('input', [
   849|                 'type' => 'text',
   850|                 'id' => $id,
   851|                 'class' => [
   852|                     'fui-input',
   853|                     $errors ? 'fui-error' : false,
   854|                 ],
   855|                 'name' => $this->getHtmlName('datetime'),
   856|                 'placeholder' => Craft::t('formie', $this->placeholder) ?: null,
   857|                 'required' => $this->required ? true : null,
   858|                 'autocomplete' => 'off',
   859|                 'data' => [
   860|                     'fui-id' => $dataId,
   861|                     'required-message' => Craft::t('formie', $this->errorMessage) ?: null,
   862|                 ],
   863|                 'aria-describedby' => $this->instructions ? "{$id}-instructions" : null,
   864|             ], $this->getInputAttributes());
   865|         }
   866|         return parent::defineHtmlTag($key, $context);
   867|     }
   868|     protected function defineSubFields(): array
   869|     {
   870|         $fields = [];
   871|         if ($this->displayType == 'datePicker') {
   872|             return $this->getCalendarSubFields();
   873|         }
   874|         if ($this->displayType == 'calendar') {
   875|             return $this->getCalendarSubFields();
   876|         }
   877|         if ($this->displayType == 'dropdowns') {
   878|             return $this->getDropdownSubFields();
   879|         }
   880|         if ($this->displayType == 'inputs') {
   881|             return $this->getInputSubFields();
   882|         }
   883|         return $fields;
   884|     }
   885|     protected function getCalendarSubFields(): array
   886|     {
   887|         $fields = [];
   888|         $fields[0]['fields'][] = [
   889|             'type' => SingleLineText::class,
   890|             'label' => Craft::t('formie', 'Date'),
   891|             'handle' => 'date',
   892|             'required' => $this->required,
   893|             'placeholder' => $this->placeholder,
   894|             'errorMessage' => $this->errorMessage,
   895|             'defaultValue' => $this->defaultValue,
   896|             'labelPosition' => HiddenPosition::class,
   897|             'inputAttributes' => array_merge(($this->inputAttributes ?? []), [
   898|                 [
   899|                     'label' => 'type',
   900|                     'value' => 'date',
   901|                 ],
   902|                 [
   903|                     'label' => 'autocomplete',
   904|                     'value' => 'off',
   905|                 ],
   906|             ]),
   907|         ];
   908|         $fields[0]['fields'][] = [
   909|             'type' => SingleLineText::class,
   910|             'label' => Craft::t('formie', 'Time'),
   911|             'handle' => 'time',
   912|             'required' => $this->required,
   913|             'placeholder' => $this->placeholder,
   914|             'errorMessage' => $this->errorMessage,
   915|             'defaultValue' => $this->defaultValue,
   916|             'labelPosition' => HiddenPosition::class,
   917|             'inputAttributes' => [
   918|                 [
   919|                     'label' => 'type',
   920|                     'value' => 'time',
   921|                 ],
   922|                 [
   923|                     'label' => 'autocomplete',
   924|                     'value' => 'off',
   925|                 ],
   926|             ],
   927|         ];
   928|         return $fields;
   929|     }
   930|     protected function getInputSubFields(): array
   931|     {
   932|         $fields = [];
   933|         $format = ($this->getIsDate() ? $this->getDateFormat() : '') . ($this->getIsTime() ? $this->getTimeFormat() : '');
   934|         $format = !$format ? ($this->getDateFormat() . $this->getTimeFormat()) : $format;
   935|         $format = preg_replace('/[.\-:\/ ]/', '', $format);
   936|         $formattingMap = str_split($format);
   937|         if (!$this->defaultValue instanceof DateTime) {
   938|             $this->defaultValue = DateTimeHelper::toDateTime($this->defaultValue, false, false) ?: null;
   939|         }
   940|         $date = $this->defaultValue ?: new DateTime();
   941|         $year = (int)$date->format('Y');
   942|         $minYear = $year - 100;
   943|         $maxYear = $year + 100;
   944|         $fields[0]['fields'] = [
   945|             [
   946|                 'type' => subfields\DateYearNumber::class,
   947|                 'label' => Craft::t('formie', 'Year'),
   948|                 'handle' => 'year',
   949|                 'enabled' => in_array('Y', $formattingMap),
   950|                 'labelPosition' => $this->subFieldLabelPosition,
   951|                 'limit' => true,
   952|                 'min' => $minYear,
   953|                 'max' => $maxYear,
   954|             ],
   955|             [
   956|                 'type' => subfields\DateMonthNumber::class,
   957|                 'label' => Craft::t('formie', 'Month'),
   958|                 'handle' => 'month',
   959|                 'enabled' => in_array('m', $formattingMap),
   960|                 'labelPosition' => $this->subFieldLabelPosition,
   961|                 'limit' => true,
   962|                 'min' => 1,
   963|                 'max' => 12,
   964|             ],
   965|             [
   966|                 'type' => subfields\DateDayNumber::class,
   967|                 'label' => Craft::t('formie', 'Day'),
   968|                 'handle' => 'day',
   969|                 'enabled' => in_array('d', $formattingMap),
   970|                 'labelPosition' => $this->subFieldLabelPosition,
   971|                 'limit' => true,
   972|                 'min' => 1,
   973|                 'max' => 31,
   974|             ],
   975|             [
   976|                 'type' => subfields\DateHourNumber::class,
   977|                 'label' => Craft::t('formie', 'Hour'),
   978|                 'handle' => 'hour',
   979|                 'enabled' => in_array('H', $formattingMap) || in_array('h', $formattingMap),
   980|                 'labelPosition' => $this->subFieldLabelPosition,
   981|                 'limit' => true,
   982|                 'min' => 0,
   983|                 'max' => 23,
   984|             ],
   985|             [
   986|                 'type' => subfields\DateMinuteNumber::class,
   987|                 'label' => Craft::t('formie', 'Minute'),
   988|                 'handle' => 'minute',
   989|                 'enabled' => in_array('i', $formattingMap),
   990|                 'labelPosition' => $this->subFieldLabelPosition,
   991|                 'limit' => true,
   992|                 'min' => 0,
   993|                 'max' => 59,
   994|             ],
   995|             [
   996|                 'type' => subfields\DateSecondNumber::class,
   997|                 'label' => Craft::t('formie', 'Second'),
   998|                 'handle' => 'second',
   999|                 'enabled' => in_array('s', $formattingMap),
  1000|                 'labelPosition' => $this->subFieldLabelPosition,
  1001|                 'limit' => true,
  1002|                 'min' => 0,
  1003|                 'max' => 59,
  1004|             ],
  1005|             [
  1006|                 'type' => subfields\DateAmPmDropdown::class,
  1007|                 'label' => Craft::t('formie', 'AM/PM'),
  1008|                 'handle' => 'ampm',
  1009|                 'enabled' => in_array('A', $formattingMap),
  1010|                 'labelPosition' => $this->subFieldLabelPosition,
  1011|                 'options' => [
  1012|                     ['value' => 'AM', 'label' => Craft::t('formie', 'AM')],
  1013|                     ['value' => 'PM', 'label' => Craft::t('formie', 'PM')],
  1014|                 ],
  1015|             ],
  1016|         ];
  1017|         return $fields;
  1018|     }
  1019|     protected function getDropdownSubFields(): array
  1020|     {
  1021|         $fields = [];
  1022|         $format = ($this->getIsDate() ? $this->getDateFormat() : '') . ($this->getIsTime() ? $this->getTimeFormat() : '');
  1023|         $format = !$format ? ($this->getDateFormat() . $this->getTimeFormat()) : $format;
  1024|         $format = preg_replace('/[.\-:\/ ]/', '', $format);
  1025|         $formattingMap = str_split($format);
  1026|         $fields[0]['fields'] = [
  1027|             [
  1028|                 'type' => subfields\DateYearDropdown::class,
  1029|                 'label' => Craft::t('formie', 'Year'),
  1030|                 'handle' => 'year',
  1031|                 'enabled' => in_array('Y', $formattingMap),
  1032|                 'labelPosition' => $this->subFieldLabelPosition,
  1033|                 'options' => [],
  1034|             ],
  1035|             [
  1036|                 'type' => subfields\DateMonthDropdown::class,
  1037|                 'label' => Craft::t('formie', 'Month'),
  1038|                 'handle' => 'month',
  1039|                 'enabled' => in_array('m', $formattingMap),
  1040|                 'labelPosition' => $this->subFieldLabelPosition,
  1041|                 'options' => $this->_getMonthOptions(),
  1042|             ],
  1043|             [
  1044|                 'type' => subfields\DateDayDropdown::class,
  1045|                 'label' => Craft::t('formie', 'Day'),
  1046|                 'handle' => 'day',
  1047|                 'enabled' => in_array('d', $formattingMap),
  1048|                 'labelPosition' => $this->subFieldLabelPosition,
  1049|                 'options' => $this->_generateOptions(1, 31),
  1050|             ],
  1051|             [
  1052|                 'type' => subfields\DateHourDropdown::class,
  1053|                 'label' => Craft::t('formie', 'Hour'),
  1054|                 'handle' => 'hour',
  1055|                 'enabled' => in_array('H', $formattingMap) || in_array('h', $formattingMap),
  1056|                 'labelPosition' => $this->subFieldLabelPosition,
  1057|                 'options' => $this->_generateOptions(0, 23),
  1058|             ],
  1059|             [
  1060|                 'type' => subfields\DateMinuteDropdown::class,
  1061|                 'label' => Craft::t('formie', 'Minute'),
  1062|                 'handle' => 'minute',
  1063|                 'enabled' => in_array('i', $formattingMap),
  1064|                 'labelPosition' => $this->subFieldLabelPosition,
  1065|                 'options' => $this->_generateOptions(0, 59),
  1066|             ],
  1067|             [
  1068|                 'type' => subfields\DateSecondDropdown::class,
  1069|                 'label' => Craft::t('formie', 'Second'),
  1070|                 'handle' => 'second',
  1071|                 'enabled' => in_array('s', $formattingMap),
  1072|                 'labelPosition' => $this->subFieldLabelPosition,
  1073|                 'options' => $this->_generateOptions(0, 59),
  1074|             ],
  1075|             [
  1076|                 'type' => subfields\DateAmPmDropdown::class,
  1077|                 'label' => Craft::t('formie', 'AM/PM'),
  1078|                 'handle' => 'ampm',
  1079|                 'enabled' => in_array('A', $formattingMap),
  1080|                 'labelPosition' => $this->subFieldLabelPosition,
  1081|                 'options' => [
  1082|                     ['value' => 'AM', 'label' => Craft::t('formie', 'AM')],
  1083|                     ['value' => 'PM', 'label' => Craft::t('formie', 'PM')],
  1084|                 ],
  1085|             ],
  1086|         ];
  1087|         return $fields;
  1088|     }
  1089|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
  1090|     {
  1091|         return Craft::$app->getView()->renderTemplate('formie/_formfields/date/input', [
  1092|             'name' => $this->handle,
  1093|             'value' => $value,
  1094|             'field' => $this,
  1095|             'element' => $element,
  1096|         ]);
  1097|     }
  1098|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
  1099|     {
  1100|         if ($value instanceof DateTime) {
  1101|             $format = null;
  1102|             if ($this->getIsDateTime()) {
  1103|                 $format = $this->getDateFormat() . ' ' . $this->getTimeFormat();
  1104|             }
  1105|             if ($this->getIsTime()) {
  1106|                 $format = $this->getTimeFormat();
  1107|             }
  1108|             if ($this->getIsDate()) {
  1109|                 $format = $this->getDateFormat();
  1110|             }
  1111|             return $value->format($format);
  1112|         }
  1113|         return '';
  1114|     }
  1115|     protected function defineValueAsJson(mixed $value, ElementInterface $element = null): mixed
  1116|     {
  1117|         return $this->getValueAsString($value, $element);
  1118|     }
  1119|     protected function defineValueForExport(mixed $value, ElementInterface $element = null): mixed
  1120|     {
  1121|         return $this->getValueAsString($value, $element);
  1122|     }
  1123|     protected function defineValueForSummary(mixed $value, ElementInterface $element = null): string
  1124|     {
  1125|         return $this->getValueAsString($value, $element);
  1126|     }
  1127|     protected function defineValueForIntegration(mixed $value, IntegrationField $integrationField, IntegrationInterface $integration, ElementInterface $element = null, string $fieldKey = ''): mixed
  1128|     {
  1129|         if ($integrationField->getType() === IntegrationField::TYPE_STRING) {
  1130|             $format = 'c';
  1131|             if ($fieldKey === 'year') {
  1132|                 $format = 'Y';
  1133|             } else if ($fieldKey === 'month') {
  1134|                 $format = 'm';
  1135|             } else if ($fieldKey === 'day') {
  1136|                 $format = 'd';
  1137|             } else if ($fieldKey === 'hour') {
  1138|                 $format = 'H';
  1139|             } else if ($fieldKey === 'minute') {
  1140|                 $format = 'i';
  1141|             } else if ($fieldKey === 'second') {
  1142|                 $format = 's';
  1143|             } else if ($fieldKey === 'ampm') {
  1144|                 $format = 'A';
  1145|             }
  1146|             if (!$this->getIsTime()) {
  1147|                 if ($value instanceof DateTime) {
  1148|                     return $value->format($format);
  1149|                 }
  1150|                 return $value;
  1151|             }
  1152|         }
  1153|         if ($integrationField->getType() === IntegrationField::TYPE_DATE) {
  1154|             if ($date = DateTimeHelper::toDateTime($value)) {
  1155|                 return $date->format('Y-m-d');
  1156|             }
  1157|         }
  1158|         if ($integrationField->getType() === IntegrationField::TYPE_DATETIME) {
  1159|             if ($date = DateTimeHelper::toDateTime($value)) {
  1160|                 return $date->format('Y-m-d H:i:s');
  1161|             }
  1162|         }
  1163|         if ($integrationField->getType() === IntegrationField::TYPE_DATECLASS) {
  1164|             if ($date = DateTimeHelper::toDateTime($value)) {
  1165|                 return $date;
  1166|             }
  1167|         }
  1168|         return parent::defineValueForIntegration($value, $integrationField, $integration, $element);
  1169|     }
  1170|     protected function defineValueForEmailPreview(FakerFactory $faker): mixed
  1171|     {
  1172|         return $faker->dateTime();
  1173|     }
  1174|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
  1175|     {
  1176|         $props = [
  1177|             'year' => 'Y',
  1178|             'month' => 'm',
  1179|             'day' => 'd',
  1180|             'hour' => 'H',
  1181|             'minute' => 'i',
  1182|             'second' => 's',
  1183|             'ampm' => 'a',
  1184|         ];
  1185|         $values = [];
  1186|         if ($value) {
  1187|             if ($this->displayType === 'inputs' || $this->displayType === 'dropdowns') {
  1188|                 foreach ($props as $k => $format) {
  1189|                     $formattedValue = '';
  1190|                     if ($value && $value instanceof DateTime) {
  1191|                         $formattedValue = $value->format($format);
  1192|                     }
  1193|                     $values[$k] = $formattedValue;
  1194|                 }
  1195|             } else {
  1196|                 $values = [
  1197|                     '__toString' => $this->defineValueAsString($value),
  1198|                     'date' => $value->format($this->getDateFormat()),
  1199|                     'time' => $value->format($this->getTimeFormat()),
  1200|                 ];
  1201|             }
  1202|         }
  1203|         return $values;
  1204|     }
  1205|     private function _generateOptions(int $start, int $end, ?string $placeholder = null): array
  1206|     {
  1207|         $options = [['value' => '', 'label' => $placeholder, 'disabled' => true]];
  1208|         for ($i = $start; $i <= $end; $i++) {
  1209|             $options[] = ['label' => $i, 'value' => $i];
  1210|         }
  1211|         return $options;
  1212|     }
  1213|     private function _getMonthOptions(?string $placeholder = null): array
  1214|     {
  1215|         $options = [['value' => '', 'label' => $placeholder, 'disabled' => true]];
  1216|         foreach (Craft::$app->getLocale()->getMonthNames() as $index => $monthName) {
  1217|             $options[] = ['value' => $index + 1, 'label' => $monthName];
  1218|         }
  1219|         return $options;
  1220|     }
  1221|     private function _getDateFormatOptions(): array
  1222|     {
  1223|         $options = [
  1224|             ['label' => 'YYYY-MM-DD', 'value' => 'Y-m-d'],
  1225|             ['label' => 'MM-DD-YYYY', 'value' => 'm-d-Y'],
  1226|             ['label' => 'DD-MM-YYYY', 'value' => 'd-m-Y'],
  1227|             ['label' => 'YYYY/MM/DD', 'value' => 'Y/m/d'],
  1228|             ['label' => 'MM/DD/YYYY', 'value' => 'm/d/Y'],
  1229|             ['label' => 'DD/MM/YYYY', 'value' => 'd/m/Y'],
  1230|             ['label' => 'YYYY.MM.DD', 'value' => 'Y.m.d'],
  1231|             ['label' => 'MM.DD.YYYY', 'value' => 'm.d.Y'],
  1232|             ['label' => 'DD.MM.YYYY', 'value' => 'd.m.Y'],
  1233|         ];
  1234|         $event = new RegisterDateTimeFormatOpionsEvent([
  1235|             'field' => $this,
  1236|             'options' => $options,
  1237|         ]);
  1238|         $this->trigger(self::EVENT_REGISTER_DATE_FORMAT_OPTIONS, $event);
  1239|         return $event->options;
  1240|     }
  1241|     private function _getTimeFormatOptions(): array
  1242|     {
  1243|         $options = [
  1244|             ['label' => '23:59:59 (HH:MM:SS)', 'value' => 'H:i:s'],
  1245|             ['label' => '03:59:59 PM (H:MM:SS AM/PM)', 'value' => 'h:i:s A'],
  1246|             ['label' => '23:59 (HH:MM)', 'value' => 'H:i'],
  1247|             ['label' => '03:59 PM (H:MM AM/PM)', 'value' => 'h:i A'],
  1248|             ['label' => '59:59 (MM:SS)', 'value' => 'i:s'],
  1249|         ];
  1250|         $event = new RegisterDateTimeFormatOpionsEvent([
  1251|             'field' => $this,
  1252|             'options' => $options,
  1253|         ]);
  1254|         $this->trigger(self::EVENT_REGISTER_TIME_FORMAT_OPTIONS, $event);
  1255|         return $event->options;
  1256|     }
  1257| }


# ====================================================================
# FILE: src/fields/Group.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-161 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\base\Integration;
     6| use verbb\formie\base\IntegrationInterface;
     7| use verbb\formie\base\SingleNestedField;
     8| use verbb\formie\base\SingleNestedFieldInterface;
     9| use verbb\formie\elements\Submission;
    10| use verbb\formie\gql\resolvers\elements\NestedFieldRowResolver;
    11| use verbb\formie\gql\types\generators\NestedFieldGenerator;
    12| use verbb\formie\gql\types\input\GroupInputType;
    13| use verbb\formie\helpers\ArrayHelper;
    14| use verbb\formie\helpers\SchemaHelper;
    15| use verbb\formie\helpers\Variables;
    16| use verbb\formie\models\DynamicModel;
    17| use verbb\formie\models\HtmlTag;
    18| use verbb\formie\models\IntegrationField;
    19| use verbb\formie\models\Notification;
    20| use verbb\formie\positions\Hidden as HiddenPosition;
    21| use Craft;
    22| use craft\base\EagerLoadingFieldInterface;
    23| use craft\base\Element;
    24| use craft\base\ElementInterface;
    25| use craft\gql\GqlEntityRegistry;
    26| use craft\helpers\Gql;
    27| use craft\helpers\Template;
    28| use Faker\Generator as FakerFactory;
    29| use GraphQL\Type\Definition\ObjectType;
    30| use GraphQL\Type\Definition\Type;
    31| use yii\validators\Validator;
    32| class Group extends SingleNestedField
    33| {
    34|     public static function displayName(): string
    35|     {
    36|         return Craft::t('formie', 'Group');
    37|     }
    38|     public static function getSvgIconPath(): string
    39|     {
    40|         return 'formie/_formfields/group/icon.svg';
    41|     }
    42|     public static function gqlTypeNameByContext(mixed $context): string
    43|     {
    44|         return ($context->getForm()->handle ?? '') . '_' . $context->handle . '_FormieGroupField';
    45|     }
    46|     public function getPreviewInputHtml(): string
    47|     {
    48|         return Craft::$app->getView()->renderTemplate('formie/_formfields/group/preview', [
    49|             'field' => $this,
    50|         ]);
    51|     }
    52|     public function getConfigJson(): ?string
    53|     {
    54|         return null;
    55|     }
    56|     public function defineGeneralSchema(): array
    57|     {
    58|         return [
    59|             SchemaHelper::labelField(),
    60|         ];
    61|     }
    62|     public function defineAppearanceSchema(): array
    63|     {
    64|         return [
    65|             SchemaHelper::visibility(),
    66|             SchemaHelper::labelPosition($this),
    67|             SchemaHelper::instructions(),
    68|             SchemaHelper::instructionsPosition($this),
    69|         ];
    70|     }
    71|     public function defineAdvancedSchema(): array
    72|     {
    73|         return [
    74|             SchemaHelper::handleField(),
    75|             SchemaHelper::cssClasses(),
    76|             SchemaHelper::containerAttributesField(),
    77|         ];
    78|     }
    79|     public function defineConditionsSchema(): array
    80|     {
    81|         return [
    82|             SchemaHelper::enableConditionsField(),
    83|             SchemaHelper::conditionsField(),
    84|         ];
    85|     }
    86|     public function getContentGqlMutationArgumentType(): Type|array
    87|     {
    88|         return GroupInputType::getType($this);
    89|     }
    90|     public function getContentGqlType(): array|Type
    91|     {
    92|         $typeArray = NestedFieldGenerator::generateTypes($this);
    93|         $typeName = self::gqlTypeNameByContext($this);
    94|         return [
    95|             'name' => $this->handle,
    96|             'type' => Gql::getUnionType($typeName, $typeArray),
    97|             'resolve' => function($submission) {
    98|                 $value = $submission->getFieldValue($this->fieldKey);
    99|                 return new DynamicModel($value);
   100|             },
   101|         ];
   102|     }
   103|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   104|     {
   105|         $form = $context['form'] ?? null;
   106|         $id = $this->getHtmlId($form);
   107|         if ($key === 'fieldContainer') {
   108|             return new HtmlTag('fieldset', [
   109|                 'class' => 'fui-fieldset',
   110|                 'aria-describedby' => $this->instructions ? "{$id}-instructions" : null,
   111|             ]);
   112|         }
   113|         if ($key === 'fieldLabel') {
   114|             $labelPosition = $context['labelPosition'] ?? null;
   115|             return new HtmlTag('legend', [
   116|                 'class' => [
   117|                     'fui-legend',
   118|                 ],
   119|                 'data' => [
   120|                     'field-label' => true,
   121|                     'fui-sr-only' => $labelPosition instanceof HiddenPosition ? true : false,
   122|                 ],
   123|             ]);
   124|         }
   125|         if ($key === 'nestedFieldContainer') {
   126|             return new HtmlTag('div', [
   127|                 'class' => 'fui-group',
   128|             ]);
   129|         }
   130|         return parent::defineHtmlTag($key, $context);
   131|     }
   132|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
   133|     {
   134|         return Craft::$app->getView()->renderTemplate('formie/_formfields/group/input', [
   135|             'element' => $element,
   136|             'name' => $this->handle,
   137|             'value' => $value,
   138|             'field' => $this,
   139|         ]);
   140|     }
   141|     protected function defineValueForEmailPreview(FakerFactory $faker): mixed
   142|     {
   143|         return Formie::$plugin->getSubmissions()->getFakeFieldContent($this->getFields());
   144|     }
   145|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
   146|     {
   147|         $values = [];
   148|         foreach ($this->getFields() as $nestedField) {
   149|             $value = $submission->getFieldValue($nestedField->fieldKey);
   150|             $fieldValues = Variables::getParsedFieldValue($nestedField, $value, $submission, $notification);
   151|             if (is_array($fieldValues)) {
   152|                 foreach ($fieldValues as $key => $fieldValue) {
   153|                     $values[$nestedField->handle][$key] = $fieldValue;
   154|                 }
   155|             } else {
   156|                 $values[$nestedField->handle] = $fieldValues;
   157|             }
   158|         }
   159|         return $values;
   160|     }
   161| }


# ====================================================================
# FILE: src/fields/Html.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-177 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\base\CosmeticField;
     4| use verbb\formie\elements\Submission;
     5| use verbb\formie\events\ModifyPurifierConfigEvent;
     6| use verbb\formie\helpers\SchemaHelper;
     7| use verbb\formie\helpers\StringHelper;
     8| use verbb\formie\models\HtmlTag;
     9| use verbb\formie\models\Notification;
    10| use verbb\formie\positions\Hidden as HiddenPosition;
    11| use Craft;
    12| use craft\base\ElementInterface;
    13| use craft\helpers\HTMLPurifier;
    14| use craft\helpers\Json;
    15| use yii\base\Exception;
    16| use GraphQL\Type\Definition\Type;
    17| use HTMLPurifier_Config;
    18| use HTMLPurifier_AttrDef_HTML_Bool;
    19| class Html extends CosmeticField
    20| {
    21|     public const EVENT_MODIFY_PURIFIER_CONFIG = 'modifyPurifierConfig';
    22|     public static function displayName(): string
    23|     {
    24|         return Craft::t('formie', 'HTML');
    25|     }
    26|     public static function getSvgIconPath(): string
    27|     {
    28|         return 'formie/_formfields/html/icon.svg';
    29|     }
    30|     public ?string $htmlContent = null;
    31|     public bool $purifyContent = true;
    32|     public function __construct(array $config = [])
    33|     {
    34|         $config['labelPosition'] = $config['labelPosition'] ?? HiddenPosition::class;
    35|         parent::__construct($config);
    36|     }
    37|     public function hasLabel(): bool
    38|     {
    39|         return true;
    40|     }
    41|     public function getRenderedHtmlContent(): string
    42|     {
    43|         $variables = $this->getRenderOptions();
    44|         $htmlContent = trim($this->htmlContent);
    45|         if ($htmlContent) {
    46|             $htmlContent = Craft::$app->getView()->renderString($this->htmlContent, $variables);
    47|         }
    48|         if ($this->purifyContent) {
    49|             return HTMLPurifier::process($htmlContent, $this->_getPurifierConfig());
    50|         }
    51|         return $htmlContent;
    52|     }
    53|     public function getPreviewInputHtml(): string
    54|     {
    55|         return Craft::$app->getView()->renderTemplate('formie/_formfields/html/preview', [
    56|             'field' => $this,
    57|         ]);
    58|     }
    59|     public function getEmailHtml(Submission $submission, Notification $notification, mixed $value, array $renderOptions = []): string|null|bool
    60|     {
    61|         return false;
    62|     }
    63|     public function getSettingGqlTypes(): array
    64|     {
    65|         return array_merge(parent::getSettingGqlTypes(), [
    66|             'htmlContent' => [
    67|                 'name' => 'htmlContent',
    68|                 'type' => Type::string(),
    69|             ],
    70|         ]);
    71|     }
    72|     public function defineGeneralSchema(): array
    73|     {
    74|         return [
    75|             SchemaHelper::labelField(),
    76|             SchemaHelper::textareaField([
    77|                 'label' => Craft::t('formie', 'HTML Content'),
    78|                 'help' => Craft::t('formie', 'Enter HTML or Twig content to be rendered for this field.'),
    79|                 'name' => 'htmlContent',
    80|                 'rows' => '10',
    81|             ]),
    82|             SchemaHelper::includeInEmailField(),
    83|         ];
    84|     }
    85|     public function defineAppearanceSchema(): array
    86|     {
    87|         return [
    88|             SchemaHelper::visibility(),
    89|             SchemaHelper::labelPosition($this),
    90|             SchemaHelper::instructions(),
    91|             SchemaHelper::instructionsPosition($this),
    92|         ];
    93|     }
    94|     public function defineAdvancedSchema(): array
    95|     {
    96|         return [
    97|             SchemaHelper::handleField(),
    98|             SchemaHelper::cssClasses(),
    99|             SchemaHelper::containerAttributesField(),
   100|             SchemaHelper::lightswitchField([
   101|                 'label' => Craft::t('formie', 'Purify Content'),
   102|                 'help' => Craft::t('formie', 'Whether to run [HTML Purifier](http://htmlpurifier.org) over the content to prevent malicious or invalid code being included.'),
   103|                 'name' => 'purifyContent',
   104|             ]),
   105|         ];
   106|     }
   107|     public function defineConditionsSchema(): array
   108|     {
   109|         return [
   110|             SchemaHelper::enableConditionsField(),
   111|             SchemaHelper::conditionsField(),
   112|         ];
   113|     }
   114|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   115|     {
   116|         if ($key === 'fieldLabel') {
   117|             $labelPosition = $context['labelPosition'] ?? null;
   118|             if ($labelPosition instanceof HiddenPosition) {
   119|                 return null;
   120|             }
   121|             return new HtmlTag('label', [
   122|                 'class' => [
   123|                     'fui-label'
   124|                 ],
   125|                 'data' => [
   126|                     'field-label' => true,
   127|                 ],
   128|             ]);
   129|         }
   130|         return parent::defineHtmlTag($key, $context);
   131|     }
   132|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
   133|     {
   134|         return Craft::$app->getView()->renderTemplate('formie/_formfields/html/input', [
   135|             'name' => $this->handle,
   136|             'value' => $value,
   137|             'field' => $this,
   138|         ]);
   139|     }
   140|     private function _getPurifierConfig(): HTMLPurifier_Config
   141|     {
   142|         $purifierConfig = HTMLPurifier_Config::createDefault();
   143|         $purifierConfig->autoFinalize = false;
   144|         $config = $this->_getConfig('htmlpurifier', 'Default.json') ?: [
   145|             'Attr.AllowedFrameTargets' => ['_blank'],
   146|             'Attr.EnableID' => true,
   147|             'HTML.AllowedComments' => ['pagebreak'],
   148|             'HTML.SafeIframe' => true,
   149|             'URI.SafeIframeRegexp' => '%^(https?:)?//(www.youtube.com/embed/|player.vimeo.com/video/)%',
   150|         ];
   151|         foreach ($config as $option => $value) {
   152|             $purifierConfig->set($option, $value);
   153|         }
   154|         $def = $purifierConfig->getHTMLDefinition(true);
   155|         $def->addElement('details', 'Block', 'Flow', 'Common', [ 'open' => new HTMLPurifier_AttrDef_HTML_Bool(true)]);
   156|         $def->addElement('summary', 'Inline', 'Inline', 'Common');
   157|         $event = new ModifyPurifierConfigEvent([
   158|             'config' => $purifierConfig,
   159|         ]);
   160|         $this->trigger(self::EVENT_MODIFY_PURIFIER_CONFIG, $event);
   161|         return $event->config;
   162|     }
   163|     private function _getConfig(string $dir, string $file = null): bool|array
   164|     {
   165|         if (!$file) {
   166|             $file = 'Default.json';
   167|         }
   168|         $path = Craft::$app->getPath()->getConfigPath() . DIRECTORY_SEPARATOR . $dir . DIRECTORY_SEPARATOR . $file;
   169|         if (!is_file($path)) {
   170|             if ($file !== 'Default.json') {
   171|                 return $this->_getConfig($dir);
   172|             }
   173|             return false;
   174|         }
   175|         return Json::decode(file_get_contents($path));
   176|     }
   177| }


# ====================================================================
# FILE: src/fields/MissingField.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-64 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\elements\Submission;
     6| use verbb\formie\models\Notification;
     7| use Craft;
     8| use craft\base\ElementInterface;
     9| use craft\base\MissingComponentTrait;
    10| use craft\base\MissingComponentInterface;
    11| use Throwable;
    12| class MissingField extends Field implements MissingComponentInterface
    13| {
    14|     use MissingComponentTrait;
    15|     public static function displayName(): string
    16|     {
    17|         return Craft::t('formie', 'Missing Field');
    18|     }
    19|     public static function getFrontEndInputTemplatePath(): string
    20|     {
    21|         return '';
    22|     }
    23|     public function getFormBuilderSettings(): array
    24|     {
    25|         $settings = [];
    26|         $settings['layoutId'] = $this->layoutId;
    27|         $settings['pageId'] = $this->pageId;
    28|         $settings['rowId'] = $this->rowId;
    29|         $settings['syncId'] = $this->syncId;
    30|         $settings['label'] = $this->label;
    31|         $settings['handle'] = $this->handle;
    32|         $settings['sortOrder'] = $this->sortOrder;
    33|         return $settings;
    34|     }
    35|     public function __set($name, $value)
    36|     {
    37|         try {
    38|             parent::__set($name, $value);
    39|         } catch (Throwable $e) {
    40|             Formie::info('{message} {file}:{line}', [
    41|                 'message' => $e->getMessage(),
    42|                 'file' => $e->getFile(),
    43|                 'line' => $e->getLine(),
    44|             ]);
    45|         }
    46|     }
    47|     public function getPreviewInputHtml(): string
    48|     {
    49|         return Craft::$app->getView()->renderTemplate('formie/_formfields/missing/preview', [
    50|             'field' => $this,
    51|         ]);
    52|     }
    53|     public function getEmailHtml(Submission $submission, Notification $notification, mixed $value, array $renderOptions = []): string|null|bool
    54|     {
    55|         return false;
    56|     }
    57|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
    58|     {
    59|         $error = $this->errorMessage ?? "Unable to find component class '{$this->expectedType}'.";
    60|         return Craft::$app->getView()->renderTemplate('formie/_formfields/missing/input', [
    61|             'error' => $error,
    62|         ]);
    63|     }
    64| }


# ====================================================================
# FILE: src/fields/MultiLineText.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-470 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\base\Field;
     4| use verbb\formie\elements\Submission;
     5| use verbb\formie\helpers\SchemaHelper;
     6| use verbb\formie\helpers\StringHelper;
     7| use verbb\formie\fields\conditions\TextFieldConditionRule;
     8| use verbb\formie\models\HtmlTag;
     9| use verbb\formie\models\Notification;
    10| use Craft;
    11| use craft\base\ElementInterface;
    12| use craft\base\PreviewableFieldInterface;
    13| use craft\base\SortableFieldInterface;
    14| use Faker\Generator as FakerFactory;
    15| use GraphQL\Type\Definition\Type;
    16| use yii\db\Schema;
    17| class MultiLineText extends Field implements PreviewableFieldInterface, SortableFieldInterface
    18| {
    19|     public const EVENT_MODIFY_UNIQUE_QUERY = 'modifyUniqueQuery';
    20|     public static function displayName(): string
    21|     {
    22|         return Craft::t('formie', 'Multi-line Text');
    23|     }
    24|     public static function getSvgIconPath(): string
    25|     {
    26|         return 'formie/_formfields/multi-line-text/icon.svg';
    27|     }
    28|     public static function dbType(): string
    29|     {
    30|         return Schema::TYPE_TEXT;
    31|     }
    32|     public bool $limit = false;
    33|     public ?int $min = null;
    34|     public ?string $minType = 'characters';
    35|     public ?int $max = null;
    36|     public ?string $maxType = 'characters';
    37|     public bool $useRichText = false;
    38|     public ?array $richTextButtons = ['bold', 'italic'];
    39|     public bool $uniqueValue = false;
    40|     public function __construct(array $config = [])
    41|     {
    42|         if (array_key_exists('limitType', $config)) {
    43|             $config['maxType'] = $config['limitType'];
    44|             unset($config['limitType']);
    45|         }
    46|         if (array_key_exists('limitAmount', $config)) {
    47|             $config['max'] = $config['limitAmount'];
    48|             unset($config['limitAmount']);
    49|         }
    50|         parent::__construct($config);
    51|     }
    52|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
    53|     {
    54|         $value = $value !== '' ? $value : null;
    55|         return parent::normalizeValue($value, $element);
    56|     }
    57|     public function getElementConditionRuleType(): ?string
    58|     {
    59|         return TextFieldConditionRule::class;
    60|     }
    61|     public function getElementValidationRules(): array
    62|     {
    63|         $rules = parent::getElementValidationRules();
    64|         if ($this->limit) {
    65|             if ($this->minType === 'characters') {
    66|                 $rules[] = [$this->handle, 'validateMinCharacters', 'skipOnEmpty' => false];
    67|             }
    68|             if ($this->maxType === 'characters') {
    69|                 $rules[] = 'validateMaxCharacters';
    70|             }
    71|             if ($this->minType === 'words') {
    72|                 $rules[] = [$this->handle, 'validateMinWords', 'skipOnEmpty' => false];
    73|             }
    74|             if ($this->maxType === 'words') {
    75|                 $rules[] = 'validateMaxWords';
    76|             }
    77|         }
    78|         if ($this->uniqueValue) {
    79|             $rules[] = 'validateUniqueValue';
    80|         }
    81|         return $rules;
    82|     }
    83|     public function validateMinCharacters(ElementInterface $element): void
    84|     {
    85|         $min = $this->min ?? 0;
    86|         if (!$min) {
    87|             return;
    88|         }
    89|         $value = (string)$element->getFieldValue($this->fieldKey);
    90|         $string = preg_replace('/[\t\n\r\s]+/', ' ', $value);
    91|         $count = StringHelper::count($string);
    92|         if ($count < $min) {
    93|             $element->addError($this->fieldKey, Craft::t('formie', 'You must enter at least {limit} characters.', [
    94|                 'limit' => $min,
    95|             ]));
    96|         }
    97|     }
    98|     public function validateMaxCharacters(ElementInterface $element): void
    99|     {
   100|         $max = $this->max ?? 0;
   101|         if (!$max) {
   102|             return;
   103|         }
   104|         $value = (string)$element->getFieldValue($this->fieldKey);
   105|         $string = preg_replace('/[\t\n\r\s]+/', ' ', $value);
   106|         $count = StringHelper::count($string);
   107|         if ($count > $max) {
   108|             $element->addError($this->fieldKey, Craft::t('formie', 'Limited to {limit} characters.', [
   109|                 'limit' => $max,
   110|             ]));
   111|         }
   112|     }
   113|     public function validateMinWords(ElementInterface $element): void
   114|     {
   115|         $min = $this->min ?? 0;
   116|         if (!$min) {
   117|             return;
   118|         }
   119|         $value = $element->getFieldValue($this->fieldKey);
   120|         $count = count(explode(' ', $value));
   121|         if ($count < $min) {
   122|             $element->addError($this->fieldKey, Craft::t('formie', 'You must enter at least {limit} words.', [
   123|                 'limit' => $min,
   124|             ]));
   125|         }
   126|     }
   127|     public function validateMaxWords(ElementInterface $element): void
   128|     {
   129|         $max = $this->max ?? 0;
   130|         if (!$max) {
   131|             return;
   132|         }
   133|         $value = $element->getFieldValue($this->fieldKey);
   134|         $count = count(explode(' ', $value));
   135|         if ($count > $max) {
   136|             $element->addError($this->fieldKey, Craft::t('formie', 'Limited to {limit} words.', [
   137|                 'limit' => $max,
   138|             ]));
   139|         }
   140|     }
   141|     public function getPreviewInputHtml(): string
   142|     {
   143|         return Craft::$app->getView()->renderTemplate('formie/_formfields/multi-line-text/preview', [
   144|             'field' => $this,
   145|         ]);
   146|     }
   147|     public function getFrontEndJsModules(): ?array
   148|     {
   149|         $modules = [];
   150|         if ($this->limit) {
   151|             $modules[] = [
   152|                 'src' => Craft::$app->getAssetManager()->getPublishedUrl('@verbb/formie/web/assets/frontend/dist/', true, 'js/fields/text-limit.js'),
   153|                 'module' => 'FormieTextLimit',
   154|             ];
   155|         }
   156|         if ($this->useRichText) {
   157|             $modules[] = [
   158|                 'src' => Craft::$app->getAssetManager()->getPublishedUrl('@verbb/formie/web/assets/frontend/dist/', true, 'js/fields/rich-text.js'),
   159|                 'module' => 'FormieRichText',
   160|                 'settings' => [
   161|                     'buttons' => $this->getRichTextButtons(),
   162|                 ],
   163|             ];
   164|         }
   165|         return $modules;
   166|     }
   167|     public function getRichTextButtons(): ?array
   168|     {
   169|         $order = array_map(function($item) {
   170|             return $item['value'];
   171|         }, $this->getButtonOptions());
   172|         if ($this->richTextButtons) {
   173|             usort($this->richTextButtons, function ($a, $b) use ($order) {
   174|                 $pos_a = array_search($a, $order);
   175|                 $pos_b = array_search($b, $order);
   176|                 return $pos_a - $pos_b;
   177|             });
   178|         }
   179|         return $this->richTextButtons;
   180|     }
   181|     public function getButtonOptions(): array
   182|     {
   183|         return [
   184|             ['label' => Craft::t('formie', 'Bold'), 'value' => 'bold'],
   185|             ['label' => Craft::t('formie', 'Italic'), 'value' => 'italic'],
   186|             ['label' => Craft::t('formie', 'Underline'), 'value' => 'underline'],
   187|             ['label' => Craft::t('formie', 'Strike-through'), 'value' => 'strikethrough'],
   188|             ['label' => Craft::t('formie', 'Heading 1'), 'value' => 'heading1'],
   189|             ['label' => Craft::t('formie', 'Heading 2'), 'value' => 'heading2'],
   190|             ['label' => Craft::t('formie', 'Paragraph'), 'value' => 'paragraph'],
   191|             ['label' => Craft::t('formie', 'Quote'), 'value' => 'quote'],
   192|             ['label' => Craft::t('formie', 'Ordered List'), 'value' => 'olist'],
   193|             ['label' => Craft::t('formie', 'Unordered List'), 'value' => 'ulist'],
   194|             ['label' => Craft::t('formie', 'Code'), 'value' => 'code'],
   195|             ['label' => Craft::t('formie', 'Horizontal Rule'), 'value' => 'line'],
   196|             ['label' => Craft::t('formie', 'Link'), 'value' => 'link'],
   197|             ['label' => Craft::t('formie', 'Image'), 'value' => 'image'],
   198|             ['label' => Craft::t('formie', 'Align Left'), 'value' => 'alignleft'],
   199|             ['label' => Craft::t('formie', 'Align Center'), 'value' => 'aligncenter'],
   200|             ['label' => Craft::t('formie', 'Align Right'), 'value' => 'alignright'],
   201|             ['label' => Craft::t('formie', 'Clear Formatting'), 'value' => 'clear'],
   202|         ];
   203|     }
   204|     public function getSettingGqlTypes(): array
   205|     {
   206|         return array_merge(parent::getSettingGqlTypes(), [
   207|             'limit' => [
   208|                 'name' => 'limit',
   209|                 'type' => Type::boolean(),
   210|             ],
   211|             'min' => [
   212|                 'name' => 'min',
   213|                 'type' => Type::int(),
   214|             ],
   215|             'minType' => [
   216|                 'name' => 'minType',
   217|                 'type' => Type::string(),
   218|             ],
   219|             'max' => [
   220|                 'name' => 'max',
   221|                 'type' => Type::int(),
   222|             ],
   223|             'maxType' => [
   224|                 'name' => 'maxType',
   225|                 'type' => Type::string(),
   226|             ],
   227|             'useRichText' => [
   228|                 'name' => 'useRichText',
   229|                 'type' => Type::boolean(),
   230|             ],
   231|             'richTextButtons' => [
   232|                 'name' => 'richTextButtons',
   233|                 'type' => Type::listOf(Type::string()),
   234|             ],
   235|             'uniqueValue' => [
   236|                 'name' => 'uniqueValue',
   237|                 'type' => Type::boolean(),
   238|             ],
   239|         ]);
   240|     }
   241|     public function defineGeneralSchema(): array
   242|     {
   243|         return [
   244|             SchemaHelper::labelField(),
   245|             SchemaHelper::textField([
   246|                 'label' => Craft::t('formie', 'Placeholder'),
   247|                 'help' => Craft::t('formie', 'The text that will be shown if the field doesn’t have a value.'),
   248|                 'name' => 'placeholder',
   249|             ]),
   250|             SchemaHelper::textareaField([
   251|                 'label' => Craft::t('formie', 'Default Value'),
   252|                 'help' => Craft::t('formie', 'Set a default value for the field when it doesn’t have a value.'),
   253|                 'name' => 'defaultValue',
   254|                 'rows' => '3',
   255|             ]),
   256|         ];
   257|     }
   258|     public function defineSettingsSchema(): array
   259|     {
   260|         return [
   261|             SchemaHelper::lightswitchField([
   262|                 'label' => Craft::t('formie', 'Required Field'),
   263|                 'help' => Craft::t('formie', 'Whether this field should be required when filling out the form.'),
   264|                 'name' => 'required',
   265|             ]),
   266|             SchemaHelper::textField([
   267|                 'label' => Craft::t('formie', 'Error Message'),
   268|                 'help' => Craft::t('formie', 'When validating the form, show this message if an error occurs. Leave empty to retain the default message.'),
   269|                 'name' => 'errorMessage',
   270|                 'if' => '$get(required).value',
   271|             ]),
   272|             SchemaHelper::lightswitchField([
   273|                 'label' => Craft::t('formie', 'Limit Value'),
   274|                 'help' => Craft::t('formie', 'Whether to limit the value of this field.'),
   275|                 'name' => 'limit',
   276|             ]),
   277|             [
   278|                 '$el' => 'div',
   279|                 'attrs' => [
   280|                     'class' => 'fui-row',
   281|                 ],
   282|                 'if' => '$get(limit).value',
   283|                 'children' => [
   284|                     [
   285|                         '$el' => 'div',
   286|                         'attrs' => [
   287|                             'class' => 'fui-col-6',
   288|                         ],
   289|                         'children' => [
   290|                             [
   291|                                 '$formkit' => 'fieldWrap',
   292|                                 'label' => Craft::t('formie', 'Min Value'),
   293|                                 'help' => Craft::t('formie', 'Set a minimum value that users must enter.'),
   294|                                 'children' => [
   295|                                     [
   296|                                         '$el' => 'div',
   297|                                         'attrs' => [
   298|                                             'class' => 'flex',
   299|                                         ],
   300|                                         'children' => [
   301|                                             SchemaHelper::numberField([
   302|                                                 'name' => 'min',
   303|                                                 'inputClass' => 'text flex-grow',
   304|                                             ]),
   305|                                             SchemaHelper::selectField([
   306|                                                 'name' => 'minType',
   307|                                                 'options' => [
   308|                                                     ['label' => Craft::t('formie', 'Characters'), 'value' => 'characters'],
   309|                                                     ['label' => Craft::t('formie', 'Words'), 'value' => 'words'],
   310|                                                 ],
   311|                                             ]),
   312|                                         ],
   313|                                     ],
   314|                                 ],
   315|                             ],
   316|                         ],
   317|                     ],
   318|                     [
   319|                         '$el' => 'div',
   320|                         'attrs' => [
   321|                             'class' => 'fui-col-6',
   322|                         ],
   323|                         'children' => [
   324|                             [
   325|                                 '$formkit' => 'fieldWrap',
   326|                                 'label' => Craft::t('formie', 'Max Value'),
   327|                                 'help' => Craft::t('formie', 'Set a maximum value that users must enter.'),
   328|                                 'children' => [
   329|                                     [
   330|                                         '$el' => 'div',
   331|                                         'attrs' => [
   332|                                             'class' => 'flex',
   333|                                         ],
   334|                                         'children' => [
   335|                                             SchemaHelper::numberField([
   336|                                                 'name' => 'max',
   337|                                                 'inputClass' => 'text flex-grow',
   338|                                             ]),
   339|                                             SchemaHelper::selectField([
   340|                                                 'name' => 'maxType',
   341|                                                 'options' => [
   342|                                                     ['label' => Craft::t('formie', 'Characters'), 'value' => 'characters'],
   343|                                                     ['label' => Craft::t('formie', 'Words'), 'value' => 'words'],
   344|                                                 ],
   345|                                             ]),
   346|                                         ],
   347|                                     ],
   348|                                 ],
   349|                             ],
   350|                         ],
   351|                     ],
   352|                 ],
   353|             ],
   354|             SchemaHelper::matchField([
   355|                 'fieldTypes' => [self::class],
   356|             ]),
   357|             SchemaHelper::prePopulate(),
   358|             SchemaHelper::includeInEmailField(),
   359|             SchemaHelper::lightswitchField([
   360|                 'label' => Craft::t('formie', 'Unique Value'),
   361|                 'help' => Craft::t('formie', 'Whether to limit user input to unique values only. This will require that a value entered in this field does not already exist in a submission for this field and form.'),
   362|                 'name' => 'uniqueValue',
   363|             ]),
   364|         ];
   365|     }
   366|     public function defineAppearanceSchema(): array
   367|     {
   368|         return [
   369|             SchemaHelper::visibility(),
   370|             SchemaHelper::lightswitchField([
   371|                 'label' => Craft::t('formie', 'Use Rich Text Field'),
   372|                 'help' => Craft::t('formie', 'Whether to display this field with a rich text editor for users to enter values with.'),
   373|                 'name' => 'useRichText',
   374|             ]),
   375|             SchemaHelper::checkboxSelectField([
   376|                 'label' => Craft::t('formie', 'Rich Text Buttons'),
   377|                 'help' => Craft::t('formie', 'Select which formatting buttons available for users to use.'),
   378|                 'name' => 'richTextButtons',
   379|                 'showAllOption' => false,
   380|                 'if' => '$get(useRichText).value',
   381|                 'options' => $this->getButtonOptions(),
   382|             ]),
   383|             SchemaHelper::labelPosition($this),
   384|             SchemaHelper::instructions(),
   385|             SchemaHelper::instructionsPosition($this),
   386|         ];
   387|     }
   388|     public function defineAdvancedSchema(): array
   389|     {
   390|         return [
   391|             SchemaHelper::handleField(),
   392|             SchemaHelper::cssClasses(),
   393|             SchemaHelper::containerAttributesField(),
   394|             SchemaHelper::inputAttributesField(),
   395|             SchemaHelper::enableContentEncryptionField(),
   396|         ];
   397|     }
   398|     public function defineConditionsSchema(): array
   399|     {
   400|         return [
   401|             SchemaHelper::enableConditionsField(),
   402|             SchemaHelper::conditionsField(),
   403|         ];
   404|     }
   405|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   406|     {
   407|         $form = $context['form'] ?? null;
   408|         $errors = $context['errors'] ?? null;
   409|         $id = $this->getHtmlId($form);
   410|         $dataId = $this->getHtmlDataId($form);
   411|         if ($key === 'fieldInput') {
   412|             return new HtmlTag('textarea', [
   413|                 'id' => $id,
   414|                 'class' => [
   415|                     'fui-input',
   416|                     $errors ? 'fui-error' : false,
   417|                 ],
   418|                 'name' => $this->getHtmlName(),
   419|                 'placeholder' => Craft::t('formie', $this->placeholder) ?: null,
   420|                 'required' => $this->required ? true : null,
   421|                 'data' => [
   422|                     'fui-id' => $dataId,
   423|                     'required-message' => Craft::t('formie', $this->errorMessage) ?: null,
   424|                     'min-chars' => ($this->limit && $this->minType === 'characters' && $this->min) ? $this->min : null,
   425|                     'max-chars' => ($this->limit && $this->maxType === 'characters' && $this->max) ? $this->max : null,
   426|                     'min-words' => ($this->limit && $this->minType === 'words' && $this->min) ? $this->min : null,
   427|                     'max-words' => ($this->limit && $this->maxType === 'words' && $this->max) ? $this->max : null,
   428|                 ],
   429|                 'aria-describedby' => $this->instructions ? "{$id}-instructions" : null,
   430|             ], $this->getInputAttributes());
   431|         }
   432|         if ($key === 'fieldLimit') {
   433|             return new HtmlTag('div', [
   434|                 'class' => 'fui-limit-text',
   435|                 'data-limit' => true,
   436|             ]);
   437|         }
   438|         if ($key === 'fieldRichText') {
   439|             return new HtmlTag('div', [
   440|                 'class' => 'fui-rich-text',
   441|                 'data-rich-text' => true,
   442|             ]);
   443|         }
   444|         return parent::defineHtmlTag($key, $context);
   445|     }
   446|     protected function defineRules(): array
   447|     {
   448|         $rules = parent::defineRules();
   449|         $rules[] = [['min', 'max'], 'number', 'integerOnly' => true];
   450|         $rules[] = [['minType', 'maxType'], 'in', 'range' => ['characters', 'words']];
   451|         return $rules;
   452|     }
   453|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
   454|     {
   455|         $form = null;
   456|         if ($element instanceof Submission) {
   457|             $form = $element->getForm();
   458|         }
   459|         return Craft::$app->getView()->renderTemplate('formie/_formfields/multi-line-text/input', [
   460|             'name' => $this->handle,
   461|             'value' => $value,
   462|             'field' => $this,
   463|             'form' => $form,
   464|         ]);
   465|     }
   466|     protected function defineValueForEmailPreview(FakerFactory $faker): mixed
   467|     {
   468|         return $faker->realText;
   469|     }
   470| }


# ====================================================================
# FILE: src/fields/Name.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-395 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\base\FieldInterface;
     6| use verbb\formie\base\Integration;
     7| use verbb\formie\base\IntegrationInterface;
     8| use verbb\formie\base\SubFieldInterface;
     9| use verbb\formie\base\SubField;
    10| use verbb\formie\elements\Submission;
    11| use verbb\formie\events\ModifyFrontEndSubFieldsEvent;
    12| use verbb\formie\gql\types\NameType;
    13| use verbb\formie\gql\types\generators\FieldAttributeGenerator;
    14| use verbb\formie\gql\types\input\NameInputType;
    15| use verbb\formie\helpers\ArrayHelper;
    16| use verbb\formie\helpers\SchemaHelper;
    17| use verbb\formie\models\FieldLayout;
    18| use verbb\formie\models\HtmlTag;
    19| use verbb\formie\models\IntegrationField;
    20| use verbb\formie\models\Name as NameModel;
    21| use verbb\formie\models\Notification;
    22| use verbb\formie\positions\AboveInput;
    23| use verbb\formie\positions\Hidden as HiddenPosition;
    24| use Craft;
    25| use craft\base\ElementInterface;
    26| use craft\base\PreviewableFieldInterface;
    27| use craft\helpers\Component;
    28| use craft\helpers\Html;
    29| use craft\helpers\Json;
    30| use Faker\Generator as FakerFactory;
    31| use GraphQL\Type\Definition\Type;
    32| use yii\base\Event;
    33| use yii\db\Schema;
    34| class Name extends SubField implements PreviewableFieldInterface
    35| {
    36|     public static function displayName(): string
    37|     {
    38|         return Craft::t('formie', 'Name');
    39|     }
    40|     public static function getSvgIconPath(): string
    41|     {
    42|         return 'formie/_formfields/name/icon.svg';
    43|     }
    44|     public static function dbType(): string
    45|     {
    46|         return Schema::TYPE_JSON;
    47|     }
    48|     public bool $useMultipleFields = false;
    49|     public function __construct(array $config = [])
    50|     {
    51|         unset(
    52|             $config['prefixEnabled'],
    53|             $config['prefixCollapsed'],
    54|             $config['prefixEnabled'],
    55|             $config['prefixCollapsed'],
    56|             $config['prefixLabel'],
    57|             $config['prefixPlaceholder'],
    58|             $config['prefixDefaultValue'],
    59|             $config['prefixPrePopulate'],
    60|             $config['prefixRequired'],
    61|             $config['prefixErrorMessage'],
    62|             $config['firstNameEnabled'],
    63|             $config['firstNameCollapsed'],
    64|             $config['firstNameLabel'],
    65|             $config['firstNamePlaceholder'],
    66|             $config['firstNameDefaultValue'],
    67|             $config['firstNamePrePopulate'],
    68|             $config['firstNameRequired'],
    69|             $config['firstNameErrorMessage'],
    70|             $config['middleNameEnabled'],
    71|             $config['middleNameCollapsed'],
    72|             $config['middleNameLabel'],
    73|             $config['middleNamePlaceholder'],
    74|             $config['middleNameDefaultValue'],
    75|             $config['middleNamePrePopulate'],
    76|             $config['middleNameRequired'],
    77|             $config['middleNameErrorMessage'],
    78|             $config['lastNameEnabled'],
    79|             $config['lastNameCollapsed'],
    80|             $config['lastNameLabel'],
    81|             $config['lastNamePlaceholder'],
    82|             $config['lastNameDefaultValue'],
    83|             $config['lastNamePrePopulate'],
    84|             $config['lastNameRequired'],
    85|             $config['lastNameErrorMessage'],
    86|         );
    87|         $config['instructionsPosition'] = $config['instructionsPosition'] ?? AboveInput::class;
    88|         parent::__construct($config);
    89|     }
    90|     public function hasSubFields(): bool
    91|     {
    92|         if ($this->useMultipleFields) {
    93|             return true;
    94|         }
    95|         return false;
    96|     }
    97|     public function getIsRequired(): ?bool
    98|     {
    99|         if (!$this->useMultipleFields) {
   100|             return $this->required;
   101|         }
   102|         return parent::getIsRequired();
   103|     }
   104|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
   105|     {
   106|         if (!$this->useMultipleFields) {
   107|             return $value;
   108|         }
   109|         $value = parent::normalizeValue($value, $element);
   110|         $value = Json::decodeIfJson($value);
   111|         if (is_array($value)) {
   112|             $name = new NameModel($value);
   113|             $name->isMultiple = true;
   114|             if ($name->prefix === '') {
   115|                 $name->prefix = null;
   116|             }
   117|             foreach ($this->getFields() as $field) {
   118|                 if ($field->getIsDisabled() && property_exists($name, $field->handle)) {
   119|                     $name->{$field->handle} = null;
   120|                 }
   121|             }
   122|             return $name;
   123|         }
   124|         return $value;
   125|     }
   126|     public function serializeValue(mixed $value, ?ElementInterface $element): mixed
   127|     {
   128|         if ($this->useMultipleFields) {
   129|             return parent::serializeValue($value, $element);
   130|         }
   131|         return $value;
   132|     }
   133|     public function getPreviewInputHtml(): string
   134|     {
   135|         return Craft::$app->getView()->renderTemplate('formie/_formfields/name/preview', [
   136|             'field' => $this,
   137|         ]);
   138|     }
   139|     public function getSettingGqlTypes(): array
   140|     {
   141|         return array_merge(parent::getSettingGqlTypes(), [
   142|             'useMultipleFields' => [
   143|                 'name' => 'useMultipleFields',
   144|                 'type' => Type::boolean(),
   145|             ],
   146|         ]);
   147|     }
   148|     public function getContentGqlType(): Type|array
   149|     {
   150|         return $this->useMultipleFields ? NameType::getType() : Type::string();
   151|     }
   152|     public function defineGeneralSchema(): array
   153|     {
   154|         return [
   155|             SchemaHelper::labelField(),
   156|             SchemaHelper::lightswitchField([
   157|                 'label' => Craft::t('formie', 'Use Multiple Name Fields'),
   158|                 'help' => Craft::t('formie', 'Whether this field should use multiple fields for users to enter their details.'),
   159|                 'name' => 'useMultipleFields',
   160|             ]),
   161|             SchemaHelper::subFieldsConfigurationField([
   162|                 'if' => '$get(useMultipleFields).value',
   163|             ], [
   164|                 'type' => static::class,
   165|             ]),
   166|             SchemaHelper::textField([
   167|                 'label' => Craft::t('formie', 'Placeholder'),
   168|                 'help' => Craft::t('formie', 'The text that will be shown if the field doesn’t have a value.'),
   169|                 'name' => 'placeholder',
   170|                 'if' => '$get(useMultipleFields).value != true',
   171|             ]),
   172|             SchemaHelper::variableTextField([
   173|                 'label' => Craft::t('formie', 'Default Value'),
   174|                 'help' => Craft::t('formie', 'Set a default value for the field when it doesn’t have a value.'),
   175|                 'name' => 'defaultValue',
   176|                 'variables' => 'userVariables',
   177|                 'if' => '$get(useMultipleFields).value != true',
   178|             ]),
   179|         ];
   180|     }
   181|     public function defineSettingsSchema(): array
   182|     {
   183|         return [
   184|             SchemaHelper::lightswitchField([
   185|                 'label' => Craft::t('formie', 'Required Field'),
   186|                 'help' => Craft::t('formie', 'Whether this field should be required when filling out the form.'),
   187|                 'name' => 'required',
   188|                 'if' => '$get(useMultipleFields).value != true',
   189|             ]),
   190|             SchemaHelper::textField([
   191|                 'label' => Craft::t('formie', 'Error Message'),
   192|                 'help' => Craft::t('formie', 'When validating the form, show this message if an error occurs. Leave empty to retain the default message.'),
   193|                 'name' => 'errorMessage',
   194|                 'if' => '$get(required).value && $get(useMultipleFields).value != true',
   195|             ]),
   196|             SchemaHelper::prePopulate([
   197|                 'if' => '$get(useMultipleFields).value != true',
   198|             ]),
   199|             SchemaHelper::includeInEmailField(),
   200|         ];
   201|     }
   202|     public function defineAppearanceSchema(): array
   203|     {
   204|         return [
   205|             SchemaHelper::visibility(),
   206|             SchemaHelper::labelPosition($this),
   207|             SchemaHelper::subFieldLabelPosition([
   208|                 'if' => '$get(useMultipleFields).value',
   209|             ]),
   210|             SchemaHelper::instructions(),
   211|             SchemaHelper::instructionsPosition($this),
   212|         ];
   213|     }
   214|     public function defineAdvancedSchema(): array
   215|     {
   216|         return [
   217|             SchemaHelper::handleField(),
   218|             SchemaHelper::cssClasses(),
   219|             SchemaHelper::containerAttributesField(),
   220|             SchemaHelper::enableContentEncryptionField(),
   221|         ];
   222|     }
   223|     public function defineConditionsSchema(): array
   224|     {
   225|         return [
   226|             SchemaHelper::enableConditionsField(),
   227|             SchemaHelper::conditionsField(),
   228|         ];
   229|     }
   230|     public function getContentGqlMutationArgumentType(): Type|array
   231|     {
   232|         if ($this->useMultipleFields) {
   233|             return NameInputType::getType($this);
   234|         }
   235|         return Type::string();
   236|     }
   237|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   238|     {
   239|         $form = $context['form'] ?? null;
   240|         $errors = $context['errors'] ?? null;
   241|         $id = $this->getHtmlId($form);
   242|         $dataId = $this->getHtmlDataId($form);
   243|         if ($this->useMultipleFields) {
   244|             if ($key === 'fieldContainer') {
   245|                 return new HtmlTag('fieldset', [
   246|                     'class' => 'fui-fieldset fui-subfield-fieldset',
   247|                 ]);
   248|             }
   249|             if ($key === 'fieldLabel') {
   250|                 $labelPosition = $context['labelPosition'] ?? null;
   251|                 return new HtmlTag('legend', [
   252|                     'class' => [
   253|                         'fui-legend',
   254|                     ],
   255|                     'data' => [
   256|                         'field-label' => true,
   257|                         'fui-sr-only' => $labelPosition instanceof HiddenPosition ? true : false,
   258|                     ],
   259|                 ]);
   260|             }
   261|         }
   262|         if ($key === 'fieldInput') {
   263|             return new HtmlTag('input', [
   264|                 'type' => 'text',
   265|                 'id' => $id,
   266|                 'class' => [
   267|                     'fui-input',
   268|                     $errors ? 'fui-error' : false,
   269|                 ],
   270|                 'name' => $this->getHtmlName(),
   271|                 'placeholder' => Craft::t('formie', $this->placeholder) ?: null,
   272|                 'autocomplete' => 'name',
   273|                 'required' => $this->required ? true : null,
   274|                 'data' => [
   275|                     'fui-id' => $dataId,
   276|                     'required-message' => Craft::t('formie', $this->errorMessage) ?: null,
   277|                 ],
   278|                 'aria-describedby' => $this->instructions ? "{$id}-instructions" : null,
   279|             ], $this->getInputAttributes());
   280|         }
   281|         return parent::defineHtmlTag($key, $context);
   282|     }
   283|     protected function defineSubFields(): array
   284|     {
   285|         return [
   286|             [
   287|                 'fields' => [
   288|                     [
   289|                         'type' => subfields\NamePrefix::class,
   290|                         'label' => Craft::t('formie', 'Prefix'),
   291|                         'handle' => 'prefix',
   292|                         'enabled' => false,
   293|                         'labelPosition' => $this->subFieldLabelPosition,
   294|                         'inputAttributes' => [
   295|                             [
   296|                                 'label' => 'autocomplete',
   297|                                 'value' => 'honorific-prefix',
   298|                             ],
   299|                         ],
   300|                     ],
   301|                     [
   302|                         'type' => subfields\NameFirst::class,
   303|                         'label' => Craft::t('formie', 'First Name'),
   304|                         'handle' => 'firstName',
   305|                         'enabled' => true,
   306|                         'labelPosition' => $this->subFieldLabelPosition,
   307|                         'inputAttributes' => [
   308|                             [
   309|                                 'label' => 'autocomplete',
   310|                                 'value' => 'given-name',
   311|                             ],
   312|                         ],
   313|                     ],
   314|                     [
   315|                         'type' => subfields\NameMiddle::class,
   316|                         'label' => Craft::t('formie', 'Middle Name'),
   317|                         'handle' => 'middleName',
   318|                         'enabled' => false,
   319|                         'labelPosition' => $this->subFieldLabelPosition,
   320|                         'inputAttributes' => [
   321|                             [
   322|                                 'label' => 'autocomplete',
   323|                                 'value' => 'additional-name',
   324|                             ],
   325|                         ],
   326|                     ],
   327|                     [
   328|                         'type' => subfields\NameLast::class,
   329|                         'label' => Craft::t('formie', 'Last Name'),
   330|                         'handle' => 'lastName',
   331|                         'enabled' => true,
   332|                         'labelPosition' => $this->subFieldLabelPosition,
   333|                         'inputAttributes' => [
   334|                             [
   335|                                 'label' => 'autocomplete',
   336|                                 'value' => 'family-name',
   337|                             ],
   338|                         ],
   339|                     ],
   340|                 ],
   341|             ],
   342|         ];
   343|     }
   344|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
   345|     {
   346|         return Craft::$app->getView()->renderTemplate('formie/_formfields/name/input', [
   347|             'name' => $this->handle,
   348|             'value' => $value,
   349|             'field' => $this,
   350|             'element' => $element,
   351|         ]);
   352|     }
   353|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
   354|     {
   355|         return (string)$value;
   356|     }
   357|     protected function defineValueAsJson(mixed $value, ElementInterface $element = null): mixed
   358|     {
   359|         if ($this->useMultipleFields) {
   360|             return parent::defineValueAsJson($value, $element);
   361|         }
   362|         return $value;
   363|     }
   364|     protected function defineValueForExport(mixed $value, ElementInterface $element = null): mixed
   365|     {
   366|         if ($this->useMultipleFields) {
   367|             return parent::defineValueForExport($value, $element);
   368|         }
   369|         return $value;
   370|     }
   371|     protected function defineValueForSummary(mixed $value, ElementInterface $element = null): string
   372|     {
   373|         return (string)$value;
   374|     }
   375|     protected function defineValueForEmailPreview(FakerFactory $faker): mixed
   376|     {
   377|         if ($this->useMultipleFields) {
   378|             return new NameModel([
   379|                 'isMultiple' => true,
   380|                 'prefix' => strtolower(str_replace(['.', ','], '', $faker->title)),
   381|                 'firstName' => $faker->firstName,
   382|                 'middleName' => $faker->firstName,
   383|                 'lastName' => $faker->lastName,
   384|             ]);
   385|         }
   386|         return $faker->name;
   387|     }
   388|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
   389|     {
   390|         if ($this->useMultipleFields) {
   391|             return parent::defineValueForVariable($value, $submission, $notification);
   392|         }
   393|         return Field::defineValueForVariable($value, $submission, $notification);
   394|     }
   395| }


# ====================================================================
# FILE: src/fields/Recipients.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-485 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\base\Field;
     4| use verbb\formie\base\FieldInterface;
     5| use verbb\formie\base\Integration;
     6| use verbb\formie\base\IntegrationInterface;
     7| use verbb\formie\elements\Form;
     8| use verbb\formie\elements\Submission;
     9| use verbb\formie\fields\data\MultiOptionsFieldData;
    10| use verbb\formie\fields\data\OptionData;
    11| use verbb\formie\fields\data\SingleOptionFieldData;
    12| use verbb\formie\fields\Hidden as HiddenField;
    13| use verbb\formie\gql\types\generators\FieldOptionGenerator;
    14| use verbb\formie\helpers\SchemaHelper;
    15| use verbb\formie\helpers\StringHelper;
    16| use verbb\formie\models\IntegrationField;
    17| use verbb\formie\models\HtmlTag;
    18| use verbb\formie\models\Notification;
    19| use verbb\formie\positions\Hidden as HiddenPosition;
    20| use Craft;
    21| use craft\base\ElementInterface;
    22| use craft\base\PreviewableFieldInterface;
    23| use craft\helpers\Component;
    24| use craft\helpers\Json;
    25| use Faker\Generator as FakerFactory;
    26| use GraphQL\Type\Definition\Type;
    27| use ReflectionClass;
    28| use ReflectionProperty;
    29| class Recipients extends Field implements PreviewableFieldInterface
    30| {
    31|     public static function displayName(): string
    32|     {
    33|         return Craft::t('formie', 'Recipients');
    34|     }
    35|     public static function getSvgIconPath(): string
    36|     {
    37|         return 'formie/_formfields/recipients/icon.svg';
    38|     }
    39|     public string $displayType = 'hidden';
    40|     public array $options = [];
    41|     public ?bool $multiple = null;
    42|     public function __construct(array $config = [])
    43|     {
    44|         $config['labelPosition'] = $config['labelPosition'] ?? HiddenPosition::class;
    45|         parent::__construct($config);
    46|     }
    47|     public function getIsHidden(): bool
    48|     {
    49|         return $this->displayType === 'hidden';
    50|     }
    51|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
    52|     {
    53|         $value = parent::normalizeValue($value, $element);
    54|         if ($value instanceof MultiOptionsFieldData || $value instanceof SingleOptionFieldData) {
    55|             return $value;
    56|         }
    57|         if (is_string($value) && ($value === '' || Json::isJsonObject($value))) {
    58|             $value = Json::decodeIfJson($value);
    59|         }
    60|         $value = $this->getRealValue($value);
    61|         if ($this->displayType !== 'hidden') {
    62|             $selectedValues = [];
    63|             foreach ((array)$value as $val) {
    64|                 if (is_array($val) && isset($val['value'])) {
    65|                     $selectedValues[] = $val['value'];
    66|                 } else {
    67|                     $selectedValues[] = (string)$val;
    68|                 }
    69|             }
    70|             $options = [];
    71|             $optionValues = [];
    72|             $optionLabels = [];
    73|             foreach ($this->options() as $option) {
    74|                 $selected = in_array($option['value'], $selectedValues, true);
    75|                 $options[] = new OptionData($option['label'], $option['value'], $selected, true);
    76|                 $optionValues[] = (string)$option['value'];
    77|                 $optionLabels[] = (string)$option['label'];
    78|             }
    79|             if (in_array($this->displayType, ['dropdown', 'radio'])) {
    80|                 $selectedValue = reset($selectedValues);
    81|                 $index = array_search($selectedValue, $optionValues, true);
    82|                 $valid = $index !== false;
    83|                 $label = $valid ? $optionLabels[$index] : null;
    84|                 $value = new SingleOptionFieldData($label, $selectedValue, true, $valid);
    85|             } else if ($this->displayType === 'checkboxes') {
    86|                 $selectedOptions = [];
    87|                 foreach ($selectedValues as $selectedValue) {
    88|                     $index = array_search($selectedValue, $optionValues, true);
    89|                     $valid = $index !== false;
    90|                     $label = $valid ? $optionLabels[$index] : null;
    91|                     $selectedOptions[] = new OptionData($label, $selectedValue, true, $valid);
    92|                 }
    93|                 $value = new MultiOptionsFieldData($selectedOptions);
    94|             }
    95|             $value->setOptions($options);
    96|         }
    97|         return $value;
    98|     }
    99|     public function serializeValue(mixed $value, ?ElementInterface $element): mixed
   100|     {
   101|         if ($value instanceof SingleOptionFieldData) {
   102|             $value = (string)$value;
   103|         }
   104|         if ($value instanceof MultiOptionsFieldData) {
   105|             $value = array_map(function($item) {
   106|                 return (string)$item;
   107|             }, (array)$value);
   108|         }
   109|         return parent::serializeValue($value, $element);
   110|     }
   111|     public function getValueForCondition(mixed $value, Submission $submission): mixed
   112|     {
   113|         return $this->getValueAsString($this->getFakeValue($value), $submission);
   114|     }
   115|     public function getPreviewInputHtml(): string
   116|     {
   117|         return Craft::$app->getView()->renderTemplate('formie/_formfields/recipients/preview', [
   118|             'field' => $this,
   119|         ]);
   120|     }
   121|     public function options(): array
   122|     {
   123|         return $this->options;
   124|     }
   125|     public function getFieldOptions(): array
   126|     {
   127|         $options = [];
   128|         foreach ($this->options() as $key => $value) {
   129|             $options[$key] = $value;
   130|             if ($options[$key]['value']) {
   131|                 $options[$key]['value'] = 'id:' . $key;
   132|             }
   133|         }
   134|         return $options;
   135|     }
   136|     public function getFrontEndInputOptions(Form $form, mixed $value, array $renderOptions = []): array
   137|     {
   138|         $inputOptions = parent::getFrontEndInputOptions($form, $value, $renderOptions);
   139|         $inputOptions['value'] = $this->getFakeValue($value);
   140|         return $inputOptions;
   141|     }
   142|     public function getDisplayTypeField(): ?FieldInterface
   143|     {
   144|         $class = new ReflectionClass($this);
   145|         $config = [
   146|             'options' => $this->getFieldOptions(),
   147|         ];
   148|         if ($this->getParentField()) {
   149|             $config['parentField'] = $this->getParentField();
   150|         }
   151|         $config['namespace'] = $this->getNamespace();
   152|         foreach ($class->getProperties(ReflectionProperty::IS_PUBLIC) as $property) {
   153|             if (!$property->isStatic() && $property->getDeclaringClass()->isAbstract()) {
   154|                 $config[$property->getName()] = $this->{$property->getName()};
   155|             }
   156|         }
   157|         if ($this->displayType === 'hidden') {
   158|             unset($config['options']);
   159|             return new HiddenField($config);
   160|         }
   161|         if ($this->displayType === 'dropdown') {
   162|             return new Dropdown($config);
   163|         }
   164|         if ($this->displayType === 'radio') {
   165|             return new Radio($config);
   166|         }
   167|         if ($this->displayType === 'checkboxes') {
   168|             return new Checkboxes($config);
   169|         }
   170|         return null;
   171|     }
   172|     public function getDefaultValue(): mixed
   173|     {
   174|         $value = parent::getDefaultValue() ?? $this->defaultValue;
   175|         if (!$this->getIsHidden() && $value === '') {
   176|             $value = [];
   177|             foreach ($this->options() as $option) {
   178|                 if (!empty($option['isDefault'])) {
   179|                     $value[] = $option['value'];
   180|                 }
   181|             }
   182|             if ($this->displayType !== 'checkboxes') {
   183|                 $value = $value[0] ?? '';
   184|             }
   185|         }
   186|         return $value;
   187|     }
   188|     public function getRealValue($value)
   189|     {
   190|         if (is_array($value)) {
   191|             return array_map(function($item) {
   192|                 return $this->getRealValue($item);
   193|             }, $value);
   194|         }
   195|         if (str_contains($value, 'id:')) {
   196|             $value = preg_replace_callback('/id:(\d+)/m', function(array $match) use ($value): string {
   197|                 $index = $match[1] ?? 0;
   198|                 return $this->options()[$index]['value'] ?? $value;
   199|             }, $value);
   200|         }
   201|         if (str_contains($value, 'base64:')) {
   202|             $value = StringHelper::decdec($value);
   203|             if (is_string($value) && Json::isJsonObject($value)) {
   204|                 $value = implode(',', array_filter(Json::decode($value)));
   205|             }
   206|         }
   207|         return $value;
   208|     }
   209|     public function getFakeValue($value)
   210|     {
   211|         if (in_array($this->displayType, ['dropdown', 'radio'])) {
   212|             foreach ($this->options() as $key => $option) {
   213|                 $id = 'id:' . $key;
   214|                 if ((string)$option['value'] === (string)$value) {
   215|                     $value = new SingleOptionFieldData($option['label'], $id, true);
   216|                     break;
   217|                 }
   218|             }
   219|         } else if ($this->displayType === 'checkboxes') {
   220|             $selectedValues = [];
   221|             foreach ((array)$value as $val) {
   222|                 $selectedValues[] = (string)$val;
   223|             }
   224|             $options = [];
   225|             foreach ($this->options() as $key => $option) {
   226|                 $id = 'id:' . $key;
   227|                 if (in_array((string)$option['value'], $selectedValues, true)) {
   228|                     $options[] = new OptionData($option['label'], $id, true);
   229|                 }
   230|             }
   231|             $value = new MultiOptionsFieldData($options);
   232|         } else if ($this->displayType === 'hidden') {
   233|             if (is_array($value)) {
   234|                 $value = Json::encode($value);
   235|             }
   236|             $value = StringHelper::encenc((string)$value);
   237|         }
   238|         return $value;
   239|     }
   240|     public function getPreviewHtml(mixed $value, ElementInterface $element): string
   241|     {
   242|         if (in_array($this->displayType, ['dropdown', 'radio'])) {
   243|             return $value->value ? Craft::t('site', (string)$value->label) : '';
   244|         } else if ($this->displayType === 'checkboxes') {
   245|             $labels = [];
   246|             foreach ($value as $option) {
   247|                 if ($option->value) {
   248|                     $labels[] = Craft::t('site', $option->label);
   249|                 }
   250|             }
   251|             return implode(', ', $labels);
   252|         }
   253|         return parent::getPreviewHtml($value, $element);
   254|     }
   255|     public function getSettingGqlTypes(): array
   256|     {
   257|         return array_merge(parent::getSettingGqlTypes(), [
   258|             'displayType' => [
   259|                 'name' => 'displayType',
   260|                 'type' => Type::string(),
   261|             ],
   262|             'multiple' => [
   263|                 'name' => 'multiple',
   264|                 'type' => Type::boolean(),
   265|             ],
   266|             'options' => [
   267|                 'name' => 'options',
   268|                 'type' => Type::listOf(FieldOptionGenerator::generateType()),
   269|             ],
   270|         ]);
   271|     }
   272|     public function getContentGqlMutationArgumentType(): Type|array
   273|     {
   274|         if ($this->displayType === 'checkboxes') {
   275|             return Type::listOf(Type::string());
   276|         }
   277|         return Type::string();
   278|     }
   279|     public function defineGeneralSchema(): array
   280|     {
   281|         return [
   282|             SchemaHelper::labelField(),
   283|             SchemaHelper::selectField([
   284|                 'label' => Craft::t('formie', 'Display Type'),
   285|                 'help' => Craft::t('formie', 'Set different display layouts for this field.'),
   286|                 'name' => 'displayType',
   287|                 'options' => [
   288|                     ['label' => Craft::t('formie', 'Hidden'), 'value' => 'hidden'],
   289|                     ['label' => Craft::t('formie', 'Dropdown'), 'value' => 'dropdown'],
   290|                     ['label' => Craft::t('formie', 'Checkboxes'), 'value' => 'checkboxes'],
   291|                     ['label' => Craft::t('formie', 'Radio Buttons'), 'value' => 'radio'],
   292|                 ],
   293|             ]),
   294|             SchemaHelper::tableField([
   295|                 'label' => Craft::t('formie', 'Options'),
   296|                 'help' => Craft::t('formie', 'Define the available options for users to select from.'),
   297|                 'name' => 'options',
   298|                 'validation' => 'required|uniqueTableCellLabel|requiredTableCellLabel',
   299|                 'if' => '$get(displayType).value != hidden',
   300|                 'newRowDefaults' => [
   301|                     'label' => '',
   302|                     'value' => '',
   303|                     'isDefault' => false,
   304|                 ],
   305|                 'columns' => [
   306|                     [
   307|                         'type' => 'label',
   308|                         'label' => Craft::t('formie', 'Option Label'),
   309|                         'class' => 'singleline-cell textual',
   310|                     ],
   311|                     [
   312|                         'type' => 'value',
   313|                         'label' => Craft::t('formie', 'Email'),
   314|                         'class' => 'singleline-cell textual',
   315|                     ],
   316|                     [
   317|                         'type' => 'default',
   318|                         'label' => Craft::t('formie', 'Default'),
   319|                         'class' => 'thin checkbox-cell',
   320|                     ],
   321|                 ],
   322|             ]),
   323|         ];
   324|     }
   325|     public function defineSettingsSchema(): array
   326|     {
   327|         return [
   328|             SchemaHelper::lightswitchField([
   329|                 'label' => Craft::t('formie', 'Required Field'),
   330|                 'help' => Craft::t('formie', 'Whether this field should be required when filling out the form.'),
   331|                 'name' => 'required',
   332|             ]),
   333|             SchemaHelper::textField([
   334|                 'label' => Craft::t('formie', 'Error Message'),
   335|                 'help' => Craft::t('formie', 'When validating the form, show this message if an error occurs. Leave empty to retain the default message.'),
   336|                 'name' => 'errorMessage',
   337|                 'if' => '$get(required).value',
   338|             ]),
   339|             SchemaHelper::prePopulate(),
   340|             SchemaHelper::includeInEmailField(),
   341|             SchemaHelper::emailNotificationValue([
   342|                 'if' => '$get(displayType).value != hidden',
   343|                 'options' => [
   344|                     ['label' => Craft::t('formie', 'Label'), 'value' => 'label'],
   345|                     ['label' => Craft::t('formie', 'Value'), 'value' => 'value'],
   346|                 ],
   347|             ]),
   348|         ];
   349|     }
   350|     public function defineAppearanceSchema(): array
   351|     {
   352|         return [
   353|             SchemaHelper::visibility(),
   354|             SchemaHelper::labelPosition($this),
   355|             SchemaHelper::instructions(),
   356|             SchemaHelper::instructionsPosition($this),
   357|         ];
   358|     }
   359|     public function defineAdvancedSchema(): array
   360|     {
   361|         return [
   362|             SchemaHelper::handleField(),
   363|             SchemaHelper::cssClasses(),
   364|             SchemaHelper::containerAttributesField(),
   365|             SchemaHelper::inputAttributesField(),
   366|             SchemaHelper::enableContentEncryptionField(),
   367|         ];
   368|     }
   369|     public function defineConditionsSchema(): array
   370|     {
   371|         return [
   372|             SchemaHelper::enableConditionsField(),
   373|             SchemaHelper::conditionsField(),
   374|         ];
   375|     }
   376|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   377|     {
   378|         $form = $context['form'] ?? null;
   379|         $id = $this->getHtmlId($form);
   380|         if (in_array($this->displayType, ['checkboxes', 'radio'])) {
   381|             if ($key === 'fieldContainer') {
   382|                 return new HtmlTag('fieldset', [
   383|                     'class' => 'fui-fieldset',
   384|                     'aria-describedby' => $this->instructions ? "{$id}-instructions" : null,
   385|                 ]);
   386|             }
   387|             if ($key === 'fieldLabel') {
   388|                 $labelPosition = $context['labelPosition'] ?? null;
   389|                 return new HtmlTag('legend', [
   390|                     'class' => [
   391|                         'fui-legend',
   392|                     ],
   393|                     'data' => [
   394|                         'field-label' => true,
   395|                         'fui-sr-only' => $labelPosition instanceof HiddenPosition ? true : false,
   396|                     ],
   397|                 ]);
   398|             }
   399|         }
   400|         return parent::defineHtmlTag($key, $context);
   401|     }
   402|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
   403|     {
   404|         return Craft::$app->getView()->renderTemplate('formie/_formfields/recipients/input', [
   405|             'name' => $this->handle,
   406|             'value' => $value,
   407|             'field' => $this,
   408|             'options' => $this->options(),
   409|         ]);
   410|     }
   411|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
   412|     {
   413|         if ($value instanceof MultiOptionsFieldData) {
   414|             return implode(', ', array_map(function($item) {
   415|                 return $item->value;
   416|             }, (array)$value));
   417|         }
   418|         if (is_array($value)) {
   419|             return implode(', ', $value);
   420|         }
   421|         if (is_string($value)) {
   422|             return $value;
   423|         }
   424|         return $value->value ?? '';
   425|     }
   426|     protected function defineValueForIntegration(mixed $value, IntegrationField $integrationField, IntegrationInterface $integration, ElementInterface $element = null, string $fieldKey = ''): mixed
   427|     {
   428|         if ($integrationField->getType() === IntegrationField::TYPE_ARRAY) {
   429|             if ($value instanceof MultiOptionsFieldData) {
   430|                 return array_map(function($item) {
   431|                     return $item->value;
   432|                 }, (array)$value);
   433|             }
   434|             if (is_array($value)) {
   435|                 return $value;
   436|             }
   437|             if (is_string($value)) {
   438|                 return [$value];
   439|             }
   440|             return [$value->value];
   441|         }
   442|         return parent::defineValueForIntegration($value, $integrationField, $integration, $element);
   443|     }
   444|     protected function defineValueForSummary(mixed $value, ElementInterface $element = null): string
   445|     {
   446|         if ($value instanceof MultiOptionsFieldData) {
   447|             return implode(', ', array_map(function($item) {
   448|                 return $item->label;
   449|             }, (array)$value));
   450|         }
   451|         if (is_array($value)) {
   452|             return implode(', ', $value);
   453|         }
   454|         return $value->label ?? '';
   455|     }
   456|     protected function defineValueForEmailPreview(FakerFactory $faker): mixed
   457|     {
   458|         if ($this->displayType === 'checkboxes') {
   459|             $values = $faker->randomElement($this->options)['value'] ?? '';
   460|             return [$values];
   461|         } else if ($this->displayType === 'dropdown' || $this->displayType === 'radio') {
   462|             return $faker->randomElement($this->options)['value'] ?? '';
   463|         } else if ($this->displayType === 'hidden') {
   464|             return $faker->email;
   465|         }
   466|     }
   467|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
   468|     {
   469|         if ($value instanceof SingleOptionFieldData) {
   470|             return $this->emailValue === 'label' ? $value->label : $value->value;
   471|         }
   472|         return parent::defineValueForVariable($value, $submission, $notification);
   473|     }
   474|     protected function setPrePopulatedValue(mixed $value): mixed
   475|     {
   476|         if (is_string($value)) {
   477|             foreach ($this->options() as $key => $option) {
   478|                 if ((string)$option['label'] === (string)$value) {
   479|                     $value = $option['value'];
   480|                 }
   481|             }
   482|         }
   483|         return parent::setPrePopulatedValue($value);
   484|     }
   485| }


# ====================================================================
# FILE: src/fields/SingleLineText.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-380 ---
     1| <?php
     2| namespace verbb\formie\fields;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\helpers\SchemaHelper;
     6| use verbb\formie\helpers\StringHelper;
     7| use verbb\formie\fields\conditions\TextFieldConditionRule;
     8| use verbb\formie\models\HtmlTag;
     9| use Craft;
    10| use craft\base\ElementInterface;
    11| use craft\base\PreviewableFieldInterface;
    12| use craft\base\SortableFieldInterface;
    13| use craft\errors\InvalidFieldException;
    14| use GraphQL\Type\Definition\Type;
    15| class SingleLineText extends Field implements PreviewableFieldInterface, SortableFieldInterface
    16| {
    17|     public const EVENT_MODIFY_UNIQUE_QUERY = 'modifyUniqueQuery';
    18|     public static function displayName(): string
    19|     {
    20|         return Craft::t('formie', 'Single-line Text');
    21|     }
    22|     public static function getSvgIconPath(): string
    23|     {
    24|         return 'formie/_formfields/single-line-text/icon.svg';
    25|     }
    26|     public bool $limit = false;
    27|     public ?int $min = null;
    28|     public ?string $minType = 'characters';
    29|     public ?int $max = null;
    30|     public ?string $maxType = 'characters';
    31|     public bool $uniqueValue = false;
    32|     public function __construct(array $config = [])
    33|     {
    34|         if (array_key_exists('limitType', $config)) {
    35|             $config['maxType'] = $config['limitType'];
    36|             unset($config['limitType']);
    37|         }
    38|         if (array_key_exists('limitAmount', $config)) {
    39|             $config['max'] = $config['limitAmount'];
    40|             unset($config['limitAmount']);
    41|         }
    42|         parent::__construct($config);
    43|     }
    44|     public function normalizeValue(mixed $value, ?ElementInterface $element): mixed
    45|     {
    46|         $value = $value !== '' ? $value : null;
    47|         return parent::normalizeValue($value, $element);
    48|     }
    49|     public function getElementConditionRuleType(): ?string
    50|     {
    51|         return TextFieldConditionRule::class;
    52|     }
    53|     public function getElementValidationRules(): array
    54|     {
    55|         $rules = parent::getElementValidationRules();
    56|         if ($this->limit) {
    57|             if ($this->minType === 'characters') {
    58|                 $rules[] = [$this->handle, 'validateMinCharacters', 'skipOnEmpty' => false];
    59|             }
    60|             if ($this->maxType === 'characters') {
    61|                 $rules[] = 'validateMaxCharacters';
    62|             }
    63|             if ($this->minType === 'words') {
    64|                 $rules[] = [$this->handle, 'validateMinWords', 'skipOnEmpty' => false];
    65|             }
    66|             if ($this->maxType === 'words') {
    67|                 $rules[] = 'validateMaxWords';
    68|             }
    69|         }
    70|         if ($this->uniqueValue) {
    71|             $rules[] = 'validateUniqueValue';
    72|         }
    73|         return $rules;
    74|     }
    75|     public function validateMinCharacters(ElementInterface $element): void
    76|     {
    77|         $min = $this->min ?? 0;
    78|         if (!$min) {
    79|             return;
    80|         }
    81|         $value = (string)$element->getFieldValue($this->fieldKey);
    82|         $string = preg_replace('/[\t\n\r\s]+/', ' ', $value);
    83|         $count = StringHelper::count($string);
    84|         if ($count < $min) {
    85|             $element->addError($this->fieldKey, Craft::t('formie', 'You must enter at least {limit} characters.', [
    86|                 'limit' => $min,
    87|             ]));
    88|         }
    89|     }
    90|     public function validateMaxCharacters(ElementInterface $element): void
    91|     {
    92|         $max = $this->max ?? 0;
    93|         if (!$max) {
    94|             return;
    95|         }
    96|         $value = (string)$element->getFieldValue($this->fieldKey);
    97|         $string = preg_replace('/[\t\n\r\s]+/', ' ', $value);
    98|         $count = StringHelper::count($string);
    99|         if ($count > $max) {
   100|             $element->addError($this->fieldKey, Craft::t('formie', 'Limited to {limit} characters.', [
   101|                 'limit' => $max,
   102|             ]));
   103|         }
   104|     }
   105|     public function validateMinWords(ElementInterface $element): void
   106|     {
   107|         $min = $this->min ?? 0;
   108|         if (!$min) {
   109|             return;
   110|         }
   111|         $value = $element->getFieldValue($this->fieldKey);
   112|         $count = count(explode(' ', $value));
   113|         if ($count < $min) {
   114|             $element->addError($this->fieldKey, Craft::t('formie', 'You must enter at least {limit} words.', [
   115|                 'limit' => $min,
   116|             ]));
   117|         }
   118|     }
   119|     public function validateMaxWords(ElementInterface $element): void
   120|     {
   121|         $max = $this->max ?? 0;
   122|         if (!$max) {
   123|             return;
   124|         }
   125|         $value = $element->getFieldValue($this->fieldKey);
   126|         $count = count(explode(' ', $value));
   127|         if ($count > $max) {
   128|             $element->addError($this->fieldKey, Craft::t('formie', 'Limited to {limit} words.', [
   129|                 'limit' => $max,
   130|             ]));
   131|         }
   132|     }
   133|     public function getPreviewInputHtml(): string
   134|     {
   135|         return Craft::$app->getView()->renderTemplate('formie/_formfields/single-line-text/preview', [
   136|             'field' => $this,
   137|         ]);
   138|     }
   139|     public function getFrontEndJsModules(): ?array
   140|     {
   141|         if ($this->limit) {
   142|             return [
   143|                 'src' => Craft::$app->getAssetManager()->getPublishedUrl('@verbb/formie/web/assets/frontend/dist/', true, 'js/fields/text-limit.js'),
   144|                 'module' => 'FormieTextLimit',
   145|             ];
   146|         }
   147|         return null;
   148|     }
   149|     public function getSettingGqlTypes(): array
   150|     {
   151|         return array_merge(parent::getSettingGqlTypes(), [
   152|             'limit' => [
   153|                 'name' => 'limit',
   154|                 'type' => Type::boolean(),
   155|             ],
   156|             'min' => [
   157|                 'name' => 'min',
   158|                 'type' => Type::int(),
   159|             ],
   160|             'minType' => [
   161|                 'name' => 'minType',
   162|                 'type' => Type::string(),
   163|             ],
   164|             'max' => [
   165|                 'name' => 'max',
   166|                 'type' => Type::int(),
   167|             ],
   168|             'maxType' => [
   169|                 'name' => 'maxType',
   170|                 'type' => Type::string(),
   171|             ],
   172|             'uniqueValue' => [
   173|                 'name' => 'uniqueValue',
   174|                 'type' => Type::boolean(),
   175|             ],
   176|         ]);
   177|     }
   178|     public function defineGeneralSchema(): array
   179|     {
   180|         return [
   181|             SchemaHelper::labelField(),
   182|             SchemaHelper::textField([
   183|                 'label' => Craft::t('formie', 'Placeholder'),
   184|                 'help' => Craft::t('formie', 'The text that will be shown if the field doesn’t have a value.'),
   185|                 'name' => 'placeholder',
   186|             ]),
   187|             SchemaHelper::variableTextField([
   188|                 'label' => Craft::t('formie', 'Default Value'),
   189|                 'help' => Craft::t('formie', 'Set a default value for the field when it doesn’t have a value.'),
   190|                 'name' => 'defaultValue',
   191|                 'variables' => 'userVariables',
   192|             ]),
   193|         ];
   194|     }
   195|     public function defineSettingsSchema(): array
   196|     {
   197|         return [
   198|             SchemaHelper::lightswitchField([
   199|                 'label' => Craft::t('formie', 'Required Field'),
   200|                 'help' => Craft::t('formie', 'Whether this field should be required when filling out the form.'),
   201|                 'name' => 'required',
   202|             ]),
   203|             SchemaHelper::textField([
   204|                 'label' => Craft::t('formie', 'Error Message'),
   205|                 'help' => Craft::t('formie', 'When validating the form, show this message if an error occurs. Leave empty to retain the default message.'),
   206|                 'name' => 'errorMessage',
   207|                 'if' => '$get(required).value',
   208|             ]),
   209|             SchemaHelper::lightswitchField([
   210|                 'label' => Craft::t('formie', 'Limit Value'),
   211|                 'help' => Craft::t('formie', 'Whether to limit the value of this field.'),
   212|                 'name' => 'limit',
   213|             ]),
   214|             [
   215|                 '$el' => 'div',
   216|                 'attrs' => [
   217|                     'class' => 'fui-row',
   218|                 ],
   219|                 'if' => '$get(limit).value',
   220|                 'children' => [
   221|                     [
   222|                         '$el' => 'div',
   223|                         'attrs' => [
   224|                             'class' => 'fui-col-6',
   225|                         ],
   226|                         'children' => [
   227|                             [
   228|                                 '$formkit' => 'fieldWrap',
   229|                                 'label' => Craft::t('formie', 'Min Value'),
   230|                                 'help' => Craft::t('formie', 'Set a minimum value that users must enter.'),
   231|                                 'children' => [
   232|                                     [
   233|                                         '$el' => 'div',
   234|                                         'attrs' => [
   235|                                             'class' => 'flex',
   236|                                         ],
   237|                                         'children' => [
   238|                                             SchemaHelper::numberField([
   239|                                                 'name' => 'min',
   240|                                                 'inputClass' => 'text flex-grow',
   241|                                             ]),
   242|                                             SchemaHelper::selectField([
   243|                                                 'name' => 'minType',
   244|                                                 'options' => [
   245|                                                     ['label' => Craft::t('formie', 'Characters'), 'value' => 'characters'],
   246|                                                     ['label' => Craft::t('formie', 'Words'), 'value' => 'words'],
   247|                                                 ],
   248|                                             ]),
   249|                                         ],
   250|                                     ],
   251|                                 ],
   252|                             ],
   253|                         ],
   254|                     ],
   255|                     [
   256|                         '$el' => 'div',
   257|                         'attrs' => [
   258|                             'class' => 'fui-col-6',
   259|                         ],
   260|                         'children' => [
   261|                             [
   262|                                 '$formkit' => 'fieldWrap',
   263|                                 'label' => Craft::t('formie', 'Max Value'),
   264|                                 'help' => Craft::t('formie', 'Set a maximum value that users must enter.'),
   265|                                 'children' => [
   266|                                     [
   267|                                         '$el' => 'div',
   268|                                         'attrs' => [
   269|                                             'class' => 'flex',
   270|                                         ],
   271|                                         'children' => [
   272|                                             SchemaHelper::numberField([
   273|                                                 'name' => 'max',
   274|                                                 'inputClass' => 'text flex-grow',
   275|                                             ]),
   276|                                             SchemaHelper::selectField([
   277|                                                 'name' => 'maxType',
   278|                                                 'options' => [
   279|                                                     ['label' => Craft::t('formie', 'Characters'), 'value' => 'characters'],
   280|                                                     ['label' => Craft::t('formie', 'Words'), 'value' => 'words'],
   281|                                                 ],
   282|                                             ]),
   283|                                         ],
   284|                                     ],
   285|                                 ],
   286|                             ],
   287|                         ],
   288|                     ],
   289|                 ],
   290|             ],
   291|             SchemaHelper::matchField([
   292|                 'fieldTypes' => [self::class],
   293|             ]),
   294|             SchemaHelper::prePopulate(),
   295|             SchemaHelper::includeInEmailField(),
   296|             SchemaHelper::lightswitchField([
   297|                 'label' => Craft::t('formie', 'Unique Value'),
   298|                 'help' => Craft::t('formie', 'Whether to limit user input to unique values only. This will require that a value entered in this field does not already exist in a submission for this field and form.'),
   299|                 'name' => 'uniqueValue',
   300|             ]),
   301|         ];
   302|     }
   303|     public function defineAppearanceSchema(): array
   304|     {
   305|         return [
   306|             SchemaHelper::visibility(),
   307|             SchemaHelper::labelPosition($this),
   308|             SchemaHelper::instructions(),
   309|             SchemaHelper::instructionsPosition($this),
   310|         ];
   311|     }
   312|     public function defineAdvancedSchema(): array
   313|     {
   314|         return [
   315|             SchemaHelper::handleField(),
   316|             SchemaHelper::cssClasses(),
   317|             SchemaHelper::containerAttributesField(),
   318|             SchemaHelper::inputAttributesField(),
   319|             SchemaHelper::enableContentEncryptionField(),
   320|         ];
   321|     }
   322|     public function defineConditionsSchema(): array
   323|     {
   324|         return [
   325|             SchemaHelper::enableConditionsField(),
   326|             SchemaHelper::conditionsField(),
   327|         ];
   328|     }
   329|     public function defineHtmlTag(string $key, array $context = []): ?HtmlTag
   330|     {
   331|         $form = $context['form'] ?? null;
   332|         $errors = $context['errors'] ?? null;
   333|         $id = $this->getHtmlId($form);
   334|         $dataId = $this->getHtmlDataId($form);
   335|         if ($key === 'fieldInput') {
   336|             return new HtmlTag('input', [
   337|                 'type' => 'text',
   338|                 'id' => $id,
   339|                 'class' => [
   340|                     'fui-input',
   341|                     $errors ? 'fui-error' : false,
   342|                 ],
   343|                 'name' => $this->getHtmlName(),
   344|                 'placeholder' => Craft::t('formie', $this->placeholder) ?: null,
   345|                 'required' => $this->required ? true : null,
   346|                 'data' => [
   347|                     'fui-id' => $dataId,
   348|                     'required-message' => Craft::t('formie', $this->errorMessage) ?: null,
   349|                     'min-chars' => ($this->limit && $this->minType === 'characters' && $this->min) ? $this->min : null,
   350|                     'max-chars' => ($this->limit && $this->maxType === 'characters' && $this->max) ? $this->max : null,
   351|                     'min-words' => ($this->limit && $this->minType === 'words' && $this->min) ? $this->min : null,
   352|                     'max-words' => ($this->limit && $this->maxType === 'words' && $this->max) ? $this->max : null,
   353|                 ],
   354|                 'aria-describedby' => $this->instructions ? "{$id}-instructions" : null,
   355|             ], $this->getInputAttributes());
   356|         }
   357|         if ($key === 'fieldLimit') {
   358|             return new HtmlTag('div', [
   359|                 'class' => 'fui-limit-text',
   360|                 'data-limit' => true,
   361|             ]);
   362|         }
   363|         return parent::defineHtmlTag($key, $context);
   364|     }
   365|     protected function defineRules(): array
   366|     {
   367|         $rules = parent::defineRules();
   368|         $rules[] = [['min', 'max'], 'number', 'integerOnly' => true];
   369|         $rules[] = [['minType', 'maxType'], 'in', 'range' => ['characters', 'words']];
   370|         return $rules;
   371|     }
   372|     protected function cpInputHtml(mixed $value, ?ElementInterface $element, bool $inline): string
   373|     {
   374|         return Craft::$app->getView()->renderTemplate('formie/_formfields/single-line-text/input', [
   375|             'name' => $this->handle,
   376|             'value' => $value,
   377|             'field' => $this,
   378|         ]);
   379|     }
   380| }


# ====================================================================
# FILE: src/fields/conditions/ElementFieldConditionRule.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-86 ---
     1| <?php
     2| namespace verbb\formie\fields\conditions;
     3| use verbb\formie\base\ElementFieldInterface;
     4| use Craft;
     5| use craft\base\conditions\BaseElementSelectConditionRule;
     6| use craft\base\ElementInterface;
     7| use craft\elements\conditions\ElementConditionInterface;
     8| use craft\elements\db\ElementQueryInterface;
     9| use craft\elements\ElementCollection;
    10| use craft\helpers\Json;
    11| use yii\base\InvalidConfigException;
    12| use yii\db\Expression;
    13| use yii\db\QueryInterface;
    14| class ElementFieldConditionRule extends BaseElementSelectConditionRule implements FieldConditionRuleInterface
    15| {
    16|     use FieldConditionRuleTrait;
    17|     public string $operator = self::OPERATOR_NOT_EMPTY;
    18|     protected bool $reloadOnOperatorChange = true;
    19|     public function modifyQuery(QueryInterface $query): void
    20|     {
    21|         $field = $this->field();
    22|         $values = $this->elementQueryParam();
    23|         if ($values !== null) {
    24|             $jsonPath = [$field->uid];
    25|             $db = Craft::$app->getDb();
    26|             $qb = $db->getQueryBuilder();
    27|             $column = $qb->jsonExtract('formie_submissions.content', $jsonPath);
    28|             foreach ($values as $i => $value) {
    29|                 $query->andWhere(new Expression("JSON_CONTAINS($column, :val$i, '$')", [":val$i" => Json::encode($value)]));
    30|             }
    31|         }
    32|     }
    33|     protected function elementType(): string
    34|     {
    35|         $field = $this->field();
    36|         return $field::elementType();
    37|     }
    38|     protected function sources(): ?array
    39|     {
    40|         $field = $this->field();
    41|         return (array)$field->getInputSources();
    42|     }
    43|     protected function selectionCondition(): ?ElementConditionInterface
    44|     {
    45|         $field = $this->field();
    46|         return $field->getSelectionCondition();
    47|     }
    48|     protected function criteria(): ?array
    49|     {
    50|         $field = $this->field();
    51|         return $field->getInputSelectionCriteria();
    52|     }
    53|     protected function allowMultiple(): bool
    54|     {
    55|         return true;
    56|     }
    57|     protected function operators(): array
    58|     {
    59|         return array_filter([
    60|             self::OPERATOR_NOT_EMPTY,
    61|             self::OPERATOR_EMPTY,
    62|         ]);
    63|     }
    64|     protected function elementQueryParam(): array|null
    65|     {
    66|         return $this->getElementIds();
    67|     }
    68|     protected function matchFieldValue($value): bool
    69|     {
    70|         if (!$this->field() instanceof ElementFieldInterface) {
    71|             return true;
    72|         }
    73|         if ($value instanceof ElementQueryInterface) {
    74|             $value = (clone $value)->site('*')->unique()->status(null);
    75|         }
    76|         if ($value instanceof ElementQueryInterface) {
    77|             $isEmpty = !$value->exists();
    78|         } else {
    79|             $isEmpty = $value->isEmpty();
    80|         }
    81|         if ($this->operator === self::OPERATOR_EMPTY) {
    82|             return $isEmpty;
    83|         }
    84|         return !$isEmpty;
    85|     }
    86| }


# ====================================================================
# FILE: src/fields/conditions/FieldConditionRuleInterface.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| <?php
     2| namespace verbb\formie\fields\conditions;
     3| use craft\elements\conditions\ElementConditionRuleInterface;
     4| interface FieldConditionRuleInterface extends ElementConditionRuleInterface
     5| {
     6|     public function setFieldUid(string $uid): void;
     7| }


# ====================================================================
# FILE: src/fields/conditions/FieldConditionRuleTrait.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-97 ---
     1| <?php
     2| namespace verbb\formie\fields\conditions;
     3| use verbb\formie\base\FieldInterface;
     4| use Craft;
     5| use craft\base\ElementInterface;
     6| use craft\errors\InvalidFieldException;
     7| use yii\base\InvalidConfigException;
     8| use yii\db\QueryInterface;
     9| trait FieldConditionRuleTrait
    10| {
    11|     private string $_fieldUid = '';
    12|     public function getGroupLabel(): ?string
    13|     {
    14|         return Craft::t('app', 'Fields');
    15|     }
    16|     public function setFieldUid(string $uid): void
    17|     {
    18|         $this->_fieldUid = $uid;
    19|     }
    20|     public function fields(): array
    21|     {
    22|         return $this->getCondition()->getFields();
    23|     }
    24|     public function field(): ?FieldInterface
    25|     {
    26|         foreach ($this->fields() as $field) {
    27|             if ($field->uid === $this->_fieldUid) {
    28|                 return $field;
    29|             }
    30|         }
    31|         return null;
    32|     }
    33|     public function getConfig(): array
    34|     {
    35|         return array_merge(parent::getConfig(), array_filter([
    36|             'fieldUid' => $this->_fieldUid,
    37|         ]));
    38|     }
    39|     public function getLabel(): string
    40|     {
    41|         return $this->field()->label;
    42|     }
    43|     public function getLabelHint(): ?string
    44|     {
    45|         static $showHandles = null;
    46|         $showHandles ??= Craft::$app->getUser()->getIdentity()?->getPreference('showFieldHandles') ?? false;
    47|         return $showHandles ? $this->field()->handle : null;
    48|     }
    49|     public function getExclusiveQueryParams(): array
    50|     {
    51|         try {
    52|             $field = $this->field();
    53|         } catch (InvalidConfigException) {
    54|             return [];
    55|         }
    56|         return [$field->handle];
    57|     }
    58|     public function modifyQuery(QueryInterface $query): void
    59|     {
    60|         $value = $this->elementQueryParam();
    61|         if ($value !== null) {
    62|             $fields = $this->fields();
    63|             $field = $fields[0];
    64|             $params = [];
    65|             $condition = $field::queryCondition($fields, $value, $params);
    66|             if ($condition === false) {
    67|                 /** @phpstan-ignore-next-line */
    68|                 $query->andWhere('0=1');
    69|             } elseif ($condition !== null) {
    70|                 /** @phpstan-ignore-next-line */
    71|                 $query->andWhere($condition, $params);
    72|             }
    73|         }
    74|     }
    75|     public function matchElement(ElementInterface $element): bool
    76|     {
    77|         try {
    78|             $field = $this->field();
    79|         } catch (InvalidConfigException) {
    80|             return true;
    81|         }
    82|         try {
    83|             $value = $element->getFieldValue($field->handle);
    84|         } catch (InvalidFieldException) {
    85|             return false;
    86|         }
    87|         return $this->matchFieldValue($value);
    88|     }
    89|     abstract protected function elementQueryParam(): mixed;
    90|     abstract protected function matchFieldValue($value): bool;
    91|     protected function defineRules(): array
    92|     {
    93|         return array_merge(parent::defineRules(), [
    94|             [['fieldUid'], 'safe'],
    95|         ]);
    96|     }
    97| }


# ====================================================================
# FILE: src/fields/conditions/OptionsFieldConditionRule.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-55 ---
     1| <?php
     2| namespace verbb\formie\fields\conditions;
     3| use verbb\formie\base\OptionsFieldInterface;
     4| use verbb\formie\fields\data\MultiOptionsFieldData;
     5| use verbb\formie\fields\data\OptionData;
     6| use verbb\formie\fields\data\SingleOptionFieldData;
     7| use craft\base\conditions\BaseMultiSelectConditionRule;
     8| use yii\base\InvalidConfigException;
     9| use Illuminate\Support\Collection;
    10| class OptionsFieldConditionRule extends BaseMultiSelectConditionRule implements FieldConditionRuleInterface
    11| {
    12|     use FieldConditionRuleTrait;
    13|     protected function options(): array
    14|     {
    15|         $field = $this->field();
    16|         return Collection::make($field->options)
    17|             ->filter(fn(array $option) => (array_key_exists('value', $option) &&
    18|                 $option['value'] !== null &&
    19|                 $option['value'] !== '' &&
    20|                 $option['label'] !== null &&
    21|                 $option['label'] !== ''
    22|             ))
    23|             ->map(fn(array $option) => [
    24|                 'value' => $option['value'],
    25|                 'label' => $option['label'],
    26|             ])
    27|             ->all();
    28|     }
    29|     protected function inputHtml(): string
    30|     {
    31|         if (!$this->field() instanceof OptionsFieldInterface) {
    32|             throw new InvalidConfigException();
    33|         }
    34|         return parent::inputHtml();
    35|     }
    36|     protected function elementQueryParam(): ?array
    37|     {
    38|         if (!$this->field() instanceof OptionsFieldInterface) {
    39|             return null;
    40|         }
    41|         return $this->paramValue();
    42|     }
    43|     protected function matchFieldValue($value): bool
    44|     {
    45|         if (!$this->field() instanceof OptionsFieldInterface) {
    46|             return true;
    47|         }
    48|         if ($value instanceof MultiOptionsFieldData) {
    49|             $value = array_map(fn(OptionData $option) => $option->value, (array)$value);
    50|         } else if ($value instanceof SingleOptionFieldData) {
    51|             $value = $value->value;
    52|         }
    53|         return $this->matchValue($value);
    54|     }
    55| }


# ====================================================================
# FILE: src/fields/conditions/TextFieldConditionRule.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-15 ---
     1| <?php
     2| namespace verbb\formie\fields\conditions;
     3| use craft\base\conditions\BaseTextConditionRule;
     4| class TextFieldConditionRule extends BaseTextConditionRule implements FieldConditionRuleInterface
     5| {
     6|     use FieldConditionRuleTrait;
     7|     protected function elementQueryParam(): ?string
     8|     {
     9|         return $this->paramValue();
    10|     }
    11|     protected function matchFieldValue($value): bool
    12|     {
    13|         return $this->matchValue($value);
    14|     }
    15| }


# ====================================================================
# FILE: src/fields/subfields/AddressCountry.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-115 ---
     1| <?php
     2| namespace verbb\formie\fields\subfields;
     3| use verbb\formie\base\SubFieldInnerFieldInterface;
     4| use verbb\formie\elements\Submission;
     5| use verbb\formie\fields\Dropdown;
     6| use verbb\formie\helpers\ArrayHelper;
     7| use verbb\formie\helpers\SchemaHelper;
     8| use verbb\formie\models\Notification;
     9| use Craft;
    10| use craft\base\ElementInterface;
    11| use CommerceGuys\Addressing\Country\CountryRepository;
    12| class AddressCountry extends Dropdown implements SubFieldInnerFieldInterface
    13| {
    14|     public static function displayName(): string
    15|     {
    16|         return Craft::t('formie', 'Address - Country');
    17|     }
    18|     public static function getFrontEndInputTemplatePath(): string
    19|     {
    20|         return 'fields/dropdown';
    21|     }
    22|     public static function getEmailTemplatePath(): string
    23|     {
    24|         return 'fields/dropdown';
    25|     }
    26|     public static function getCountryOptions(): array
    27|     {
    28|         $locale = Craft::$app->getLocale()->getLanguageID();
    29|         $repo = new CountryRepository($locale);
    30|         $countries = [];
    31|         foreach ($repo->getList() as $value => $label) {
    32|             $countries[] = compact('value', 'label');
    33|         }
    34|         return $countries;
    35|     }
    36|     public ?string $optionLabel = 'full';
    37|     public ?string $optionValue = 'short';
    38|     public function getFormBuilderSettings(): array
    39|     {
    40|         $settings = parent::getFormBuilderSettings();
    41|         $settings['options'] = $this->options();
    42|         return $settings;
    43|     }
    44|     public function options(): array
    45|     {
    46|         foreach (static::getCountryOptions() as $country) {
    47|             $label = ($this->optionLabel === 'short') ? $country['value'] : $country['label'];
    48|             $value = ($this->optionValue === 'short') ? $country['value'] : $country['label'];
    49|             $options[] = ['label' => $label, 'value' => $value];
    50|         }
    51|         return $options;
    52|     }
    53|     public function defineGeneralSchema(): array
    54|     {
    55|         return [
    56|             SchemaHelper::labelField(),
    57|             SchemaHelper::selectField([
    58|                 'label' => Craft::t('formie', 'Default Value'),
    59|                 'help' => Craft::t('formie', 'Set a default value for the field when it doesn’t have a value.'),
    60|                 'name' => 'defaultValue',
    61|                 'options' => array_merge(
    62|                     [['label' => Craft::t('formie', 'Select an option'), 'value' => '']],
    63|                     static::getCountryOptions()
    64|                 ),
    65|             ]),
    66|             SchemaHelper::selectField([
    67|                 'label' => Craft::t('formie', 'Option Label'),
    68|                 'help' => Craft::t('formie', 'Select the format for the dropdown option label.'),
    69|                 'name' => 'optionLabel',
    70|                 'options' => [
    71|                     ['label' => Craft::t('formie', 'Full Country Name (e.g. United States)'), 'value' => 'full'],
    72|                     ['label' => Craft::t('formie', 'Abbreviated Country Name (e.g. US)'), 'value' => 'short'],
    73|                 ],
    74|             ]),
    75|             SchemaHelper::selectField([
    76|                 'label' => Craft::t('formie', 'Option Value'),
    77|                 'help' => Craft::t('formie', 'Select the format for the dropdown option value.'),
    78|                 'name' => 'optionValue',
    79|                 'options' => [
    80|                     ['label' => Craft::t('formie', 'Full Country Name (e.g. United States)'), 'value' => 'full'],
    81|                     ['label' => Craft::t('formie', 'Abbreviated Country Name (e.g. US)'), 'value' => 'short'],
    82|                 ],
    83|             ]),
    84|         ];
    85|     }
    86|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
    87|     {
    88|         return $this->_getValueLabel($value);
    89|     }
    90|     protected function defineValueAsJson(mixed $value, ElementInterface $element = null): string
    91|     {
    92|         return $this->_getValueLabel($value);
    93|     }
    94|     protected function defineValueForExport(mixed $value, ElementInterface $element = null): mixed
    95|     {
    96|         return $this->_getValueLabel($value);
    97|     }
    98|     protected function defineValueForSummary(mixed $value, ElementInterface $element = null): string
    99|     {
   100|         return $this->_getValueLabel($value);
   101|     }
   102|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
   103|     {
   104|         return $this->_getValueLabel($value);
   105|     }
   106|     private function _getValueLabel(mixed $value): string
   107|     {
   108|         if ($value) {
   109|             if ($countryOption = ArrayHelper::firstWhere($this->getCountryOptions(), 'value', $value)) {
   110|                 return $countryOption['label'] ?? '';
   111|             }
   112|         }
   113|         return '';
   114|     }
   115| }


# ====================================================================
# FILE: src/fields/subfields/NamePrefix.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-117 ---
     1| <?php
     2| namespace verbb\formie\fields\subfields;
     3| use verbb\formie\base\SubFieldInnerFieldInterface;
     4| use verbb\formie\elements\Submission;
     5| use verbb\formie\events\ModifyNamePrefixOptionsEvent;
     6| use verbb\formie\fields\Dropdown;
     7| use verbb\formie\helpers\ArrayHelper;
     8| use verbb\formie\helpers\SchemaHelper;
     9| use verbb\formie\models\Notification;
    10| use Craft;
    11| use craft\base\ElementInterface;
    12| use yii\base\Event;
    13| class NamePrefix extends Dropdown implements SubFieldInnerFieldInterface
    14| {
    15|     public const EVENT_MODIFY_PREFIX_OPTIONS = 'modifyPrefixOptions';
    16|     public static function displayName(): string
    17|     {
    18|         return Craft::t('formie', 'Name - Prefix');
    19|     }
    20|     public static function getFrontEndInputTemplatePath(): string
    21|     {
    22|         return 'fields/dropdown';
    23|     }
    24|     public static function getEmailTemplatePath(): string
    25|     {
    26|         return 'fields/dropdown';
    27|     }
    28|     public function allowDuplicateLabels(): bool
    29|     {
    30|         return true;
    31|     }
    32|     public function getDefaultOptions(): array
    33|     {
    34|         $options = [
    35|             ['label' => Craft::t('formie', 'Select an option'), 'value' => ''],
    36|             ['label' => Craft::t('formie', 'Mr.'), 'value' => 'mr'],
    37|             ['label' => Craft::t('formie', 'Mrs.'), 'value' => 'mrs'],
    38|             ['label' => Craft::t('formie', 'Ms.'), 'value' => 'ms'],
    39|             ['label' => Craft::t('formie', 'Miss.'), 'value' => 'miss'],
    40|             ['label' => Craft::t('formie', 'Mx.'), 'value' => 'mx'],
    41|             ['label' => Craft::t('formie', 'Dr.'), 'value' => 'dr'],
    42|             ['label' => Craft::t('formie', 'Prof.'), 'value' => 'prof'],
    43|         ];
    44|         $event = new ModifyNamePrefixOptionsEvent([
    45|             'options' => $options,
    46|         ]);
    47|         Event::trigger(static::class, self::EVENT_MODIFY_PREFIX_OPTIONS, $event);
    48|         return $event->options;
    49|     }
    50|     public function defineGeneralSchema(): array
    51|     {
    52|         return [
    53|             SchemaHelper::labelField(),
    54|             SchemaHelper::tableField([
    55|                 'label' => Craft::t('formie', 'Options'),
    56|                 'help' => Craft::t('formie', 'Define the available options for users to select from.'),
    57|                 'name' => 'options',
    58|                 'validation' => '+min:1|uniqueTableCellValue',
    59|                 'allowMultipleDefault' => false,
    60|                 'enableBulkOptions' => true,
    61|                 'predefinedOptions' => $this->getPredefinedOptions(),
    62|                 'newRowDefaults' => [
    63|                     'label' => '',
    64|                     'value' => '',
    65|                     'isOptgroup' => false,
    66|                     'isDefault' => false,
    67|                 ],
    68|                 'columns' => [
    69|                     [
    70|                         'type' => 'label',
    71|                         'label' => Craft::t('formie', 'Option Label'),
    72|                         'class' => 'singleline-cell textual',
    73|                     ],
    74|                     [
    75|                         'type' => 'value',
    76|                         'label' => Craft::t('formie', 'Value'),
    77|                         'class' => 'code singleline-cell textual',
    78|                     ],
    79|                     [
    80|                         'type' => 'default',
    81|                         'label' => Craft::t('formie', 'Default'),
    82|                         'class' => 'thin checkbox-cell',
    83|                     ],
    84|                 ],
    85|             ]),
    86|         ];
    87|     }
    88|     protected function defineValueAsString(mixed $value, ElementInterface $element = null): string
    89|     {
    90|         return $this->_getValueLabel($value);
    91|     }
    92|     protected function defineValueAsJson(mixed $value, ElementInterface $element = null): string
    93|     {
    94|         return $this->_getValueLabel($value);
    95|     }
    96|     protected function defineValueForExport(mixed $value, ElementInterface $element = null): mixed
    97|     {
    98|         return $this->_getValueLabel($value);
    99|     }
   100|     protected function defineValueForSummary(mixed $value, ElementInterface $element = null): string
   101|     {
   102|         return $this->_getValueLabel($value);
   103|     }
   104|     protected function defineValueForVariable(mixed $value, Submission $submission, Notification $notification): mixed
   105|     {
   106|         return $this->_getValueLabel($value);
   107|     }
   108|     private function _getValueLabel(mixed $value): string
   109|     {
   110|         if ($value) {
   111|             if ($prefixOption = ArrayHelper::firstWhere($this->options(), 'value', $value)) {
   112|                 return $prefixOption['label'] ?? '';
   113|             }
   114|         }
   115|         return '';
   116|     }
   117| }


# ====================================================================
# FILE: src/gql/arguments/SubmissionArguments.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-53 ---
     1| <?php
     2| namespace verbb\formie\gql\arguments;
     3| use verbb\formie\Formie;
     4| use verbb\formie\elements\Submission;
     5| use Craft;
     6| use craft\gql\base\ElementArguments;
     7| use GraphQL\Type\Definition\Type;
     8| class SubmissionArguments extends ElementArguments
     9| {
    10|     public static function getArguments(): array
    11|     {
    12|         return array_merge(parent::getArguments(), self::getContentArguments(), [
    13|             'form' => [
    14|                 'name' => 'form',
    15|                 'type' => Type::listOf(Type::string()),
    16|                 'description' => 'Narrows the query results based on the submission’s form handle.',
    17|             ],
    18|             'status' => [
    19|                 'name' => 'status',
    20|                 'type' => Type::string(),
    21|                 'description' => 'Narrows the query results based on the submission’s status.',
    22|             ],
    23|             'statusId' => [
    24|                 'name' => 'statusId',
    25|                 'type' => Type::int(),
    26|                 'description' => 'Narrows the query results based on the submission’s status ID.',
    27|             ],
    28|             'siteId' => [
    29|                 'name' => 'siteId',
    30|                 'type' => Type::int(),
    31|                 'description' => 'Narrows the query results based on the submission’s site ID.',
    32|             ],
    33|             'isIncomplete' => [
    34|                 'name' => 'isIncomplete',
    35|                 'type' => Type::boolean(),
    36|                 'description' => 'Narrows the query results based on the submission’s incomplete state.',
    37|             ],
    38|             'isSpam' => [
    39|                 'name' => 'isSpam',
    40|                 'type' => Type::boolean(),
    41|                 'description' => 'Narrows the query results based on the submission’s spam state.',
    42|             ],
    43|         ]);
    44|     }
    45|     public static function getContentArguments(): array
    46|     {
    47|         $arguments = [];
    48|         foreach (Formie::$plugin->getFields()->getAllFields() as $field) {
    49|             $arguments[$field->handle] = $field->getContentGqlQueryArgumentType();
    50|         }
    51|         return array_merge(parent::getContentArguments(), $arguments);
    52|     }
    53| }


# ====================================================================
# FILE: src/gql/interfaces/FormInterface.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-210 ---
     1| <?php
     2| namespace verbb\formie\gql\interfaces;
     3| use verbb\formie\Formie;
     4| use verbb\formie\elements\Form;
     5| use verbb\formie\elements\Submission;
     6| use verbb\formie\gql\types\CaptchaValueType;
     7| use verbb\formie\gql\types\CsrfTokenType;
     8| use verbb\formie\gql\types\FormSettingsType;
     9| use verbb\formie\gql\types\generators\FormGenerator;
    10| use Craft;
    11| use craft\gql\interfaces\Element;
    12| use craft\gql\GqlEntityRegistry;
    13| use craft\helpers\Json;
    14| use craft\helpers\UrlHelper;
    15| use GraphQL\Type\Definition\InterfaceType;
    16| use GraphQL\Type\Definition\Type;
    17| class FormInterface extends Element
    18| {
    19|     public static function getTypeGenerator(): string
    20|     {
    21|         return FormGenerator::class;
    22|     }
    23|     public static function getType($fields = null): Type
    24|     {
    25|         if ($type = GqlEntityRegistry::getEntity(self::getName())) {
    26|             return $type;
    27|         }
    28|         $type = GqlEntityRegistry::createEntity(self::getName(), new InterfaceType([
    29|             'name' => static::getName(),
    30|             'fields' => self::class . '::getFieldDefinitions',
    31|             'description' => 'This is the interface implemented by all forms.',
    32|             'resolveType' => function(Form $value) {
    33|                 return $value->getGqlTypeName();
    34|             },
    35|         ]));
    36|         FormGenerator::generateTypes();
    37|         return $type;
    38|     }
    39|     public static function getName(): string
    40|     {
    41|         return 'FormInterface';
    42|     }
    43|     public static function getFieldDefinitions(): array
    44|     {
    45|         return Craft::$app->getGql()->prepareFieldDefinitions(array_merge(parent::getFieldDefinitions(), [
    46|             'handle' => [
    47|                 'name' => 'handle',
    48|                 'type' => Type::string(),
    49|                 'description' => 'The form’s handle.',
    50|             ],
    51|             'pages' => [
    52|                 'name' => 'pages',
    53|                 'type' => Type::listOf(PageInterface::getType()),
    54|                 'description' => 'The form’s pages.',
    55|             ],
    56|             'rows' => [
    57|                 'name' => 'rows',
    58|                 'type' => Type::listOf(RowInterface::getType()),
    59|                 'description' => 'The form’s rows.',
    60|                 'args' => [
    61|                     'includeDisabled' => [
    62|                         'name' => 'includeDisabled',
    63|                         'description' => 'Whether to include fields with visibility "disabled".',
    64|                         'type' => Type::boolean(),
    65|                     ],
    66|                 ],
    67|                 'resolve' => function($source, $arguments) {
    68|                     $includeDisabled = $arguments['includeDisabled'] ?? false;
    69|                     return $source->getRows($includeDisabled);
    70|                 },
    71|             ],
    72|             'formFields' => [
    73|                 'name' => 'formFields',
    74|                 'type' => Type::listOf(FieldInterface::getType()),
    75|                 'description' => 'The form’s fields.',
    76|                 'args' => [
    77|                     'includeDisabled' => [
    78|                         'name' => 'includeDisabled',
    79|                         'description' => 'Whether to include fields with visibility "disabled".',
    80|                         'type' => Type::boolean(),
    81|                     ],
    82|                 ],
    83|                 'resolve' => function($source, $arguments) {
    84|                     $includeDisabled = $arguments['includeDisabled'] ?? false;
    85|                     return $source->getFields($includeDisabled);
    86|                 },
    87|             ],
    88|             'settings' => [
    89|                 'name' => 'settings',
    90|                 'type' => FormSettingsType::getType(),
    91|                 'description' => 'The form’s settings.',
    92|             ],
    93|             'configJson' => [
    94|                 'name' => 'configJson',
    95|                 'type' => Type::string(),
    96|                 'description' => 'The form’s config as JSON.',
    97|             ],
    98|             'templateHtml' => [
    99|                 'name' => 'templateHtml',
   100|                 'type' => Type::string(),
   101|                 'description' => 'The form’s rendered HTML.',
   102|                 'args' => [
   103|                     'options' => [
   104|                         'name' => 'options',
   105|                         'description' => 'The form template HTML will be rendered with these JSON serialized options.',
   106|                         'type' => Type::string(),
   107|                     ],
   108|                     'populateFormValues' => [
   109|                         'name' => 'populateFormValues',
   110|                         'description' => 'The form field values will be populated with these JSON serialized options.',
   111|                         'type' => Type::string(),
   112|                     ],
   113|                 ],
   114|                 'resolve' => function($source, $arguments) {
   115|                     $options = Json::decodeIfJson($arguments['options'] ?? []);
   116|                     $populateFormValues = Json::decodeIfJson($arguments['populateFormValues'] ?? []);
   117|                     if ($populateFormValues) {
   118|                         Formie::$plugin->getRendering()->populateFormValues($source, $populateFormValues);
   119|                     }
   120|                     return Formie::$plugin->getRendering()->renderForm($source, $options);
   121|                 },
   122|             ],
   123|             'templateCss' => [
   124|                 'name' => 'templateCss',
   125|                 'type' => Type::string(),
   126|                 'description' => 'The form’s CSS for rendering.',
   127|                 'resolve' => function($source, $arguments) {
   128|                     return Formie::$plugin->getRendering()->renderCss(true);
   129|                 },
   130|             ],
   131|             'templateJs' => [
   132|                 'name' => 'templateJs',
   133|                 'type' => Type::string(),
   134|                 'description' => 'The form’s JS for rendering and functionality.',
   135|                 'args' => [
   136|                     'useObserver' => [
   137|                         'name' => 'useObserver',
   138|                         'description' => 'Whether to automatically initialize the form’s JS when visible.',
   139|                         'type' => Type::boolean(),
   140|                     ],
   141|                     'initJs' => [
   142|                         'name' => 'initJs',
   143|                         'description' => 'Whether to automatically initialize the form’s JS.',
   144|                         'type' => Type::boolean(),
   145|                     ],
   146|                 ],
   147|                 'resolve' => function($source, $arguments) {
   148|                     return Formie::$plugin->getRendering()->renderJs(true, $arguments);
   149|                 },
   150|             ],
   151|             'csrfToken' => [
   152|                 'name' => 'csrfToken',
   153|                 'type' => CsrfTokenType::getType(),
   154|                 'description' => 'A CSRF token (name and value).',
   155|                 'resolve' => function() {
   156|                     if (!Craft::$app->getConfig()->getGeneral()->enableCsrfProtection) {
   157|                         return null;
   158|                     }
   159|                     return [
   160|                         'name' => Craft::$app->getRequest()->csrfParam,
   161|                         'value' => Craft::$app->getRequest()->getCsrfToken(),
   162|                     ];
   163|                 },
   164|             ],
   165|             'captchas' => [
   166|                 'name' => 'captchas',
   167|                 'type' => Type::listOf(CaptchaValueType::getType()),
   168|                 'description' => 'A list of captcha values (name and value) to assist with spam protection.',
   169|                 'resolve' => function ($source, $arguments) {
   170|                     $values = [];
   171|                     $captchas = Formie::$plugin->getIntegrations()->getAllEnabledCaptchasForForm($source);
   172|                     foreach ($captchas as $captcha) {
   173|                         if ($jsVariables = $captcha->getGqlVariables($source)) {
   174|                             $values[] = [
   175|                                 'handle' => $captcha->getGqlHandle(),
   176|                                 'name' => $jsVariables['sessionKey'] ?? '',
   177|                                 'value' => $jsVariables['value'] ?? '',
   178|                             ];
   179|                         }
   180|                     }
   181|                     return $values;
   182|                 },
   183|             ],
   184|             'submissionMutationName' => [
   185|                 'name' => 'submissionMutationName',
   186|                 'type' => Type::string(),
   187|                 'description' => 'The form’s GQL mutation name for submissions to use.',
   188|                 'resolve' => function ($source) {
   189|                     return Submission::gqlMutationNameByContext($source);
   190|                 },
   191|             ],
   192|             'submissionEndpoint' => [
   193|                 'name' => 'submissionEndpoint',
   194|                 'type' => Type::string(),
   195|                 'description' => 'The form’s endpoint for sending submissions to, if using POST requests.',
   196|                 'resolve' => function ($source) {
   197|                     return UrlHelper::actionUrl('formie/submissions/submit');
   198|                 },
   199|             ],
   200|             'isAvailable' => [
   201|                 'name' => 'isAvailable',
   202|                 'type' => Type::boolean(),
   203|                 'description' => 'Whether the form is considered available according to user checks, scheduling and more.',
   204|                 'resolve' => function ($source) {
   205|                     return $source->isAvailable();
   206|                 },
   207|             ],
   208|         ]), self::getName());
   209|     }
   210| }


# ====================================================================
# FILE: src/helpers/ImportExportHelper.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-302 ---
     1| <?php
     2| namespace verbb\formie\helpers;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\NestedFieldInterface;
     5| use verbb\formie\elements\Form;
     6| use verbb\formie\fields;
     7| use verbb\formie\helpers\ArrayHelper;
     8| use verbb\formie\helpers\Plugin;
     9| use verbb\formie\models\EmailTemplate;
    10| use verbb\formie\models\FieldLayout;
    11| use verbb\formie\models\FormSettings;
    12| use verbb\formie\models\FormTemplate;
    13| use verbb\formie\models\Notification;
    14| use verbb\formie\models\PdfTemplate;
    15| use verbb\formie\records\EmailTemplate as EmailTemplateRecord;
    16| use verbb\formie\records\Form as FormRecord;
    17| use verbb\formie\records\FormTemplate as FormTemplateRecord;
    18| use verbb\formie\records\Notification as NotificationRecord;
    19| use verbb\formie\records\PdfTemplate as PdfTemplateRecord;
    20| use Craft;
    21| use craft\elements\Entry;
    22| use craft\helpers\Json;
    23| use craft\db\Query;
    24| use yii\base\Exception;
    25| class ImportExportHelper
    26| {
    27|     public static function generateFormExport(Form $formElement): array
    28|     {
    29|         $formId = $formElement->id;
    30|         $data = FormRecord::find()
    31|             ->select(['*'])
    32|             ->where(['id' => $formId])
    33|             ->asArray()
    34|             ->one();
    35|         foreach (['id', 'formFieldLayout', 'layoutId', 'dateCreated', 'dateUpdated', 'uid'] as $key) {
    36|             ArrayHelper::remove($data, $key);
    37|         }
    38|         $data['title'] = $formElement->title;
    39|         $formTemplateId = ArrayHelper::remove($data, 'templateId');
    40|         if ($formTemplateId) {
    41|             $data['formTemplate'] = FormTemplateRecord::find()
    42|                 ->select(['*'])
    43|                 ->where(['id' => $formTemplateId])
    44|                 ->asArray()
    45|                 ->one();
    46|             foreach (['id', 'dateDeleted', 'dateCreated', 'dateUpdated', 'uid'] as $key) {
    47|                 ArrayHelper::remove($data['formTemplate'], $key);
    48|             }
    49|         }
    50|         $data['notifications'] = NotificationRecord::find()
    51|             ->select(['*'])
    52|             ->where(['formId' => $formId])
    53|             ->asArray()
    54|             ->all();
    55|         foreach ($data['notifications'] as $i => $notification) {
    56|             foreach (['id', 'formId', 'dateCreated', 'dateUpdated'] as $key) {
    57|                 ArrayHelper::remove($notification, $key);
    58|             }
    59|             $emailTemplateId = ArrayHelper::remove($notification, 'templateId');
    60|             $pdfTemplateId = ArrayHelper::remove($notification, 'pdfTemplateId');
    61|             if ($emailTemplateId) {
    62|                 $notification['emailTemplate'] = EmailTemplateRecord::find()
    63|                     ->select(['*'])
    64|                     ->where(['id' => $emailTemplateId])
    65|                     ->asArray()
    66|                     ->one();
    67|                 foreach (['id', 'dateDeleted', 'dateCreated', 'dateUpdated'] as $key) {
    68|                     ArrayHelper::remove($notification['emailTemplate'], $key);
    69|                 }
    70|             }
    71|             if ($pdfTemplateId) {
    72|                 $notification['pdfTemplate'] = PdfTemplateRecord::find()
    73|                     ->select(['*'])
    74|                     ->where(['id' => $pdfTemplateId])
    75|                     ->asArray()
    76|                     ->one();
    77|                 foreach (['id', 'dateDeleted', 'dateCreated', 'dateUpdated'] as $key) {
    78|                     ArrayHelper::remove($notification['pdfTemplate'], $key);
    79|                 }
    80|             }
    81|             $data['notifications'][$i] = $notification;
    82|         }
    83|         $pages = [];
    84|         foreach ($formElement->getPages() as $page) {
    85|             $pageData = $page->toArray();
    86|             $pageData['settings'] = $page->getSettings();
    87|             foreach (['id', 'formId', 'layoutId', 'sortOrder', 'dateCreated', 'dateUpdated', 'uid'] as $key) {
    88|                 ArrayHelper::remove($pageData, $key);
    89|             }
    90|             self::getFieldInfoForExport($page->getRows(), $pageData);
    91|             $pages[] = $pageData;
    92|         }
    93|         $data['pages'] = $pages;
    94|         if ($fieldLayout = $formElement->getFieldLayout()) {
    95|             foreach ($fieldLayout->getCustomFields() as $customField) {
    96|                 $fieldValue = $formElement->getFieldValue($customField->handle);
    97|                 $data['customFields'][$customField->handle] = $customField->serializeValue($fieldValue, $formElement);
    98|             }
    99|         }
   100|         $data['exportVersion'] = 'v3';
   101|         return $data;
   102|     }
   103|     public static function createFormFromImport(array $data, ?Form $form = null): Form
   104|     {
   105|         $existingForm = $form;
   106|         $existingFields = [];
   107|         if ($existingForm) {
   108|             $existingFields = self::buildFieldMap($existingForm->getFields());
   109|             $form->setFormLayout(new FieldLayout());
   110|         }
   111|         if (!$form) {
   112|             $form = new Form();
   113|         }
   114|         $exportVersion = ArrayHelper::remove($data, 'exportVersion');
   115|         $settings = Json::decodeIfJson(ArrayHelper::remove($data, 'settings'));
   116|         $pages = ArrayHelper::remove($data, 'pages');
   117|         $formTemplate = ArrayHelper::remove($data, 'formTemplate');
   118|         $notifications = ArrayHelper::remove($data, 'notifications');
   119|         unset($data['fieldLayoutId']);
   120|         $form->setAttributes($data, false);
   121|         $customFields = $data['customFields'] ?? [];
   122|         $customFields = array_filter($customFields, function($value, $key) {
   123|             return Craft::$app->getFields()->getFieldByHandle($key);
   124|         }, ARRAY_FILTER_USE_BOTH);
   125|         $form->setFieldValues($customFields);
   126|         $form->settings = new FormSettings();
   127|         $form->settings->setAttributes($settings, false);
   128|         if ($form->submitActionEntryId) {
   129|             $entry = Entry::find()->id($form->submitActionEntryId)->one();
   130|             if (!$entry) {
   131|                 $form->submitActionEntryId = null;
   132|             }
   133|         }
   134|         if ($form->defaultStatusId) {
   135|             $status = Formie::$plugin->getStatuses()->getStatusById($form->defaultStatusId);
   136|             if (!$status) {
   137|                 $form->defaultStatusId = Formie::$plugin->getStatuses()->getDefaultStatus()->id;
   138|             }
   139|         }
   140|         foreach ($pages as &$page) {
   141|             self::updateFieldIdsInImport($page, $existingFields);
   142|         }
   143|         self::prepFieldsForImport($pages);
   144|         $form->getFormLayout()->setPages($pages);
   145|         if ($formTemplate) {
   146|             $template = Formie::$plugin->getFormTemplates()->getTemplateByHandle($formTemplate['handle']);
   147|             if (!$template) {
   148|                 $template = new FormTemplate();
   149|                 $template->setAttributes($formTemplate, false);
   150|             }
   151|             $form->setTemplate($template);
   152|         }
   153|         if ($notifications) {
   154|             $allNotifications = [];
   155|             foreach ($notifications as $notificationData) {
   156|                 $emailTemplate = ArrayHelper::remove($notificationData, 'emailTemplate');
   157|                 $pdfTemplate = ArrayHelper::remove($notificationData, 'pdfTemplate');
   158|                 $notification = new Notification();
   159|                 $notification->setAttributes($notificationData, false);
   160|                 if ($emailTemplate) {
   161|                     $template = Formie::$plugin->getEmailTemplates()->getTemplateByHandle($emailTemplate['handle']);
   162|                     if (!$template) {
   163|                         $template = new EmailTemplate();
   164|                         $template->setAttributes($emailTemplate, false);
   165|                     }
   166|                     $notification->setTemplate($template);
   167|                 }
   168|                 if ($pdfTemplate) {
   169|                     $template = Formie::$plugin->getPdfTemplates()->getTemplateByHandle($pdfTemplate['handle']);
   170|                     if (!$template) {
   171|                         $template = new PdfTemplate();
   172|                         $template->setAttributes($pdfTemplate, false);
   173|                     }
   174|                     $notification->setPdfTemplate($template);
   175|                 }
   176|                 $allNotifications[] = $notification;
   177|             }
   178|             $form->setNotifications($allNotifications);
   179|         }
   180|         return $form;
   181|     }
   182|     public static function importFormFromJson($json, $formAction = "update"): Form
   183|     {
   184|         if (isset($json[0])) {
   185|             $json = $json[0];
   186|         }
   187|         $existingForm = null;
   188|         $formHandle = $json['handle'] ?? null;
   189|         if ($formHandle) {
   190|             $existingForm = Formie::$plugin->getForms()->getFormByHandle($formHandle);
   191|         }
   192|         if ($formAction === 'create') {
   193|             $formHandles = (new Query())
   194|                 ->select(['handle'])
   195|                 ->from(Table::FORMIE_FORMS)
   196|                 ->column();
   197|             $json['handle'] = HandleHelper::getUniqueHandle($formHandles, $json['handle']);
   198|         }
   199|         if ($formAction === 'update') {
   200|             $form = self::createFormFromImport($json, $existingForm);
   201|         } else {
   202|             $form = self::createFormFromImport($json);
   203|         }
   204|         if ($formAction === 'create') {
   205|             $existingForm = Formie::$plugin->getForms()->getFormByHandle($form->handle);
   206|             if ($existingForm) {
   207|                 $form->uid = StringHelper::UUID();
   208|             }
   209|         }
   210|          Craft::$app->getElements()->saveElement($form);
   211|          return $form;
   212|     }
   213|     private static function getFieldInfoForExport(array $rows, array &$pageData): void
   214|     {
   215|         foreach ($rows as $rowId => $row) {
   216|             foreach ($row['fields'] as $fieldId => $field) {
   217|                 $settings = array_merge([
   218|                     'label' => $field->label,
   219|                     'handle' => $field->handle,
   220|                     'instructions' => $field->instructions,
   221|                     'required' => $field->required,
   222|                 ], $field->settings);
   223|                 ArrayHelper::remove($settings, 'formId');
   224|                 ArrayHelper::remove($settings, 'nestedLayoutId');
   225|                 $pageData['rows'][$rowId]['fields'][$fieldId] = [
   226|                     'type' => get_class($field),
   227|                     'settings' => $settings,
   228|                 ];
   229|                 if ($field instanceof NestedFieldInterface) {
   230|                     self::getFieldInfoForExport($field->getRows(), $pageData['rows'][$rowId]['fields'][$fieldId]['settings']);
   231|                 }
   232|             }
   233|         }
   234|     }
   235|     private static function prepFieldsForImport(array &$pages): void
   236|     {
   237|         foreach ($pages as $pageKey => &$page) {
   238|             unset($page['userCondition'], $page['elementCondition']);
   239|             if (isset($page['rows'])) {
   240|                 foreach ($page['rows'] as $rowKey => &$row) {
   241|                     if (isset($row['fields'])) {
   242|                         foreach ($row['fields'] as $fieldKey => &$field) {
   243|                             $type = $field['type'] ?? '';
   244|                             unset($field['settings']['isNested']);
   245|                             if (isset($field['label'])) {
   246|                                 $field['settings']['label'] = $field['label'];
   247|                             }
   248|                             if (isset($field['handle'])) {
   249|                                 $field['settings']['handle'] = $field['handle'];
   250|                             }
   251|                             if (in_array($type, [fields\Products::class, fields\Variants::class]) && !Plugin::isPluginInstalledAndEnabled('commerce')) {
   252|                                 unset($row['fields'][$fieldKey]);
   253|                             } else if (!class_exists($type)) {
   254|                                 unset($row['fields'][$fieldKey]);
   255|                             }
   256|                             $nestedRows = $field['rows'] ?? $field['settings']['rows'] ?? [];
   257|                             if ($nestedRows) {
   258|                                 $nestedPages = [['rows' => $nestedRows]];
   259|                                 self::prepFieldsForImport($nestedPages);
   260|                                 $field['settings']['rows'] = $nestedPages[0]['rows'];
   261|                             }
   262|                         }
   263|                     }
   264|                 }
   265|                 $page['rows'] = array_filter($page['rows']);
   266|             }
   267|         }
   268|     }
   269|     private static function buildFieldMap(array $fields, string $prefix = ''): array
   270|     {
   271|         $fieldMap = [];
   272|         foreach ($fields as $field) {
   273|             $key = $prefix ? "$prefix.{$field->handle}" : $field->handle;
   274|             $fieldMap[$key] = $field;
   275|             if ($field instanceof NestedFieldInterface) {
   276|                 $nestedFields = $field->getFields();
   277|                 $fieldMap = array_merge($fieldMap, self::buildFieldMap($nestedFields, $key));
   278|             }
   279|         }
   280|         return $fieldMap;
   281|     }
   282|     private static function updateFieldIdsInImport(array &$data, array $existingFields, string $prefix = ''): void
   283|     {
   284|         if (isset($data['rows'])) {
   285|             foreach ($data['rows'] as &$row) {
   286|                 if (isset($row['fields'])) {
   287|                     foreach ($row['fields'] as &$field) {
   288|                         $handle = $field['handle'] ?? $field['settings']['handle'] ?? null;
   289|                         $rows = $field['rows'] ?? $field['settings']['rows'] ?? null;
   290|                         $key = $prefix ? "$prefix.{$handle}" : $handle;
   291|                         if (isset($existingFields[$key])) {
   292|                             $field['id'] = $existingFields[$key]->id;
   293|                         }
   294|                         if ($rows && is_array($rows)) {
   295|                             self::updateFieldIdsInImport($field['settings'], $existingFields, $key);
   296|                         }
   297|                     }
   298|                 }
   299|             }
   300|         }
   301|     }
   302| }


# ====================================================================
# FILE: src/integrations/crm/Pardot.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-493 ---
     1| <?php
     2| namespace verbb\formie\integrations\crm;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Crm;
     5| use verbb\formie\base\Integration;
     6| use verbb\formie\elements\Submission;
     7| use verbb\formie\events\ModifyPayloadEvent;
     8| use verbb\formie\helpers\ArrayHelper;
     9| use verbb\formie\models\IntegrationField;
    10| use verbb\formie\models\IntegrationFormSettings;
    11| use Craft;
    12| use craft\helpers\App;
    13| use craft\helpers\Json;
    14| use Throwable;
    15| use verbb\auth\base\OAuthProviderInterface;
    16| use verbb\auth\models\Token;
    17| use verbb\auth\providers\Salesforce as SalesforceProvider;
    18| class Pardot extends Crm implements OAuthProviderInterface
    19| {
    20|     public const EVENT_MODIFY_FORM_HANDLER_PAYLOAD = 'modifyFormHandlerPayload';
    21|     public static function supportsOAuthConnection(): bool
    22|     {
    23|         return true;
    24|     }
    25|     public static function getOAuthProviderClass(): string
    26|     {
    27|         return SalesforceProvider::class;
    28|     }
    29|     public static function displayName(): string
    30|     {
    31|         return Craft::t('formie', 'Pardot');
    32|     }
    33|     public ?string $businessUnitId = null;
    34|     public bool|string $useSandbox = false;
    35|     public bool $mapToProspect = false;
    36|     public bool $mapToOpportunity = false;
    37|     public bool $enableFormHandler = false;
    38|     public ?array $prospectFieldMapping = null;
    39|     public ?array $opportunityFieldMapping = null;
    40|     public ?string $endpointUrl = null;
    41|     public function getUseSandbox(): string
    42|     {
    43|         return App::parseBooleanEnv($this->useSandbox);
    44|     }
    45|     public function getBusinessUnitId(): string
    46|     {
    47|         return App::parseEnv($this->businessUnitId);
    48|     }
    49|     public function getApiDomain(): string
    50|     {
    51|         $prefix = $this->getUseSandbox() ? 'pi.demo' : 'pi';
    52|         return "https://{$prefix}.pardot.com/api";
    53|     }
    54|     public function getDescription(): string
    55|     {
    56|         return Craft::t('formie', 'Manage your {name} customers by providing important information on their conversion on your site.', ['name' => static::displayName()]);
    57|     }
    58|     public function getAuthorizationUrlOptions(): array
    59|     {
    60|         $options = parent::getAuthorizationUrlOptions();
    61|         $options['scope'] = [
    62|             'api',
    63|             'pardot_api',
    64|             'refresh_token',
    65|         ];
    66|         return $options;
    67|     }
    68|     public function request(string $method, string $uri, array $options = []): mixed
    69|     {
    70|         $options['headers']['Pardot-Business-Unit-Id'] = $this->getBusinessUnitId();
    71|         return parent::request($method, $uri, $options);
    72|     }
    73|     public function fetchFormSettings(): IntegrationFormSettings
    74|     {
    75|         $settings = [];
    76|         try {
    77|             if ($this->mapToProspect) {
    78|                 $response = $this->request('GET', 'customField/version/4/do/query');
    79|                 $fields = $response['result']['customField'] ?? [];
    80|                 $booleanOptions = [
    81|                     [
    82|                         'label' => Craft::t('formie', 'Yes'),
    83|                         'value' => true,
    84|                     ],
    85|                     [
    86|                         'label' => Craft::t('formie', 'No'),
    87|                         'value' => false,
    88|                     ],
    89|                 ];
    90|                 $settings['prospect'] = array_merge([
    91|                     new IntegrationField([
    92|                         'handle' => 'list_id',
    93|                         'name' => Craft::t('formie', 'Segmentation List'),
    94|                         'options' => [
    95|                             'label' => Craft::t('formie', 'Lists'),
    96|                             'options' => array_map(function($list) {
    97|                                 return [
    98|                                     'label' => $list['name'],
    99|                                     'value' => $list['id'],
   100|                                 ];
   101|                             }, $this->request('GET', 'list/version/4/do/query')['result']['list'] ?? []),
   102|                         ],
   103|                     ]),
   104|                     new IntegrationField([
   105|                         'handle' => 'salutation',
   106|                         'name' => Craft::t('formie', 'Salutation'),
   107|                     ]),
   108|                     new IntegrationField([
   109|                         'handle' => 'first_name',
   110|                         'name' => Craft::t('formie', 'First Name'),
   111|                     ]),
   112|                     new IntegrationField([
   113|                         'handle' => 'last_name',
   114|                         'name' => Craft::t('formie', 'Last Name'),
   115|                     ]),
   116|                     new IntegrationField([
   117|                         'handle' => 'email',
   118|                         'name' => Craft::t('formie', 'Email'),
   119|                         'required' => true,
   120|                     ]),
   121|                     new IntegrationField([
   122|                         'handle' => 'password',
   123|                         'name' => Craft::t('formie', 'Password'),
   124|                     ]),
   125|                     new IntegrationField([
   126|                         'handle' => 'company',
   127|                         'name' => Craft::t('formie', 'Company'),
   128|                     ]),
   129|                     new IntegrationField([
   130|                         'handle' => 'prospect_account_id',
   131|                         'name' => Craft::t('formie', 'Prospect Account Id'),
   132|                         'type' => IntegrationField::TYPE_NUMBER,
   133|                         'options' => [
   134|                             'label' => Craft::t('formie', 'Prospect Accounts'),
   135|                             'options' => array_map(function($prospectAccount) {
   136|                                 return [
   137|                                     'label' => $prospectAccount['name'],
   138|                                     'value' => $prospectAccount['id'],
   139|                                 ];
   140|                             }, $this->request('GET', 'prospectAccount/version/4/do/query')['result']['prospectAccount'] ?? []),
   141|                         ],
   142|                     ]),
   143|                     new IntegrationField([
   144|                         'handle' => 'website',
   145|                         'name' => Craft::t('formie', 'Website'),
   146|                     ]),
   147|                     new IntegrationField([
   148|                         'handle' => 'job_title',
   149|                         'name' => Craft::t('formie', 'Job Title'),
   150|                     ]),
   151|                     new IntegrationField([
   152|                         'handle' => 'department',
   153|                         'name' => Craft::t('formie', 'Department'),
   154|                     ]),
   155|                     new IntegrationField([
   156|                         'handle' => 'country',
   157|                         'name' => Craft::t('formie', 'Country'),
   158|                     ]),
   159|                     new IntegrationField([
   160|                         'handle' => 'address_one',
   161|                         'name' => Craft::t('formie', 'Address Line 1'),
   162|                     ]),
   163|                     new IntegrationField([
   164|                         'handle' => 'address_two',
   165|                         'name' => Craft::t('formie', 'Address Line 2'),
   166|                     ]),
   167|                     new IntegrationField([
   168|                         'handle' => 'city',
   169|                         'name' => Craft::t('formie', 'City'),
   170|                     ]),
   171|                     new IntegrationField([
   172|                         'handle' => 'state',
   173|                         'name' => Craft::t('formie', 'State'),
   174|                     ]),
   175|                     new IntegrationField([
   176|                         'handle' => 'territory',
   177|                         'name' => Craft::t('formie', 'Territory'),
   178|                     ]),
   179|                     new IntegrationField([
   180|                         'handle' => 'zip',
   181|                         'name' => Craft::t('formie', 'Zip'),
   182|                     ]),
   183|                     new IntegrationField([
   184|                         'handle' => 'phone',
   185|                         'name' => Craft::t('formie', 'Phone'),
   186|                     ]),
   187|                     new IntegrationField([
   188|                         'handle' => 'fax',
   189|                         'name' => Craft::t('formie', 'Fax'),
   190|                     ]),
   191|                     new IntegrationField([
   192|                         'handle' => 'source',
   193|                         'name' => Craft::t('formie', 'Source'),
   194|                     ]),
   195|                     new IntegrationField([
   196|                         'handle' => 'annual_revenue',
   197|                         'name' => Craft::t('formie', 'Annual Revenue'),
   198|                     ]),
   199|                     new IntegrationField([
   200|                         'handle' => 'employees',
   201|                         'name' => Craft::t('formie', 'Employees'),
   202|                     ]),
   203|                     new IntegrationField([
   204|                         'handle' => 'industry',
   205|                         'name' => Craft::t('formie', 'Industry'),
   206|                     ]),
   207|                     new IntegrationField([
   208|                         'handle' => 'years_in_business',
   209|                         'name' => Craft::t('formie', 'Years in Business'),
   210|                     ]),
   211|                     new IntegrationField([
   212|                         'handle' => 'comments',
   213|                         'name' => Craft::t('formie', 'Comments'),
   214|                     ]),
   215|                     new IntegrationField([
   216|                         'handle' => 'notes',
   217|                         'name' => Craft::t('formie', 'Notes'),
   218|                     ]),
   219|                     new IntegrationField([
   220|                         'handle' => 'score',
   221|                         'name' => Craft::t('formie', 'Score'),
   222|                         'type' => IntegrationField::TYPE_NUMBER,
   223|                     ]),
   224|                     new IntegrationField([
   225|                         'handle' => 'is_do_not_email',
   226|                         'name' => Craft::t('formie', 'Do Not Email'),
   227|                         'type' => IntegrationField::TYPE_BOOLEAN,
   228|                         'options' => [
   229|                             'label' => Craft::t('formie', 'Do Not Email'),
   230|                             'options' => $booleanOptions,
   231|                         ],
   232|                     ]),
   233|                     new IntegrationField([
   234|                         'handle' => 'is_do_not_call',
   235|                         'name' => Craft::t('formie', 'Do Not Call'),
   236|                         'type' => IntegrationField::TYPE_BOOLEAN,
   237|                         'options' => [
   238|                             'label' => Craft::t('formie', 'Do Not Call'),
   239|                             'options' => $booleanOptions,
   240|                         ],
   241|                     ]),
   242|                     new IntegrationField([
   243|                         'handle' => 'is_reviewed',
   244|                         'name' => Craft::t('formie', 'Reviewed'),
   245|                         'type' => IntegrationField::TYPE_BOOLEAN,
   246|                         'options' => [
   247|                             'label' => Craft::t('formie', 'Reviewed'),
   248|                             'options' => $booleanOptions,
   249|                         ],
   250|                     ]),
   251|                     new IntegrationField([
   252|                         'handle' => 'is_archived',
   253|                         'name' => Craft::t('formie', 'Archived'),
   254|                         'type' => IntegrationField::TYPE_BOOLEAN,
   255|                         'options' => [
   256|                             'label' => Craft::t('formie', 'Archived'),
   257|                             'options' => $booleanOptions,
   258|                         ],
   259|                     ]),
   260|                     new IntegrationField([
   261|                         'handle' => 'is_starred',
   262|                         'name' => Craft::t('formie', 'Starred'),
   263|                         'type' => IntegrationField::TYPE_BOOLEAN,
   264|                         'options' => [
   265|                             'label' => Craft::t('formie', 'Starred'),
   266|                             'options' => $booleanOptions,
   267|                         ],
   268|                     ]),
   269|                     new IntegrationField([
   270|                         'handle' => 'campaign_id',
   271|                         'name' => Craft::t('formie', 'Campaign ID'),
   272|                         'type' => IntegrationField::TYPE_NUMBER,
   273|                         'options' => [
   274|                             'label' => Craft::t('formie', 'Campaigns'),
   275|                             'options' => array_map(function($campaign) {
   276|                                 return [
   277|                                     'label' => $campaign['name'],
   278|                                     'value' => $campaign['id'],
   279|                                 ];
   280|                             }, $this->request('GET', 'campaign/version/4/do/query')['result']['campaign'] ?? []),
   281|                         ],
   282|                     ]),
   283|                     new IntegrationField([
   284|                         'handle' => 'profile',
   285|                         'name' => Craft::t('formie', 'Profile'),
   286|                     ]),
   287|                     new IntegrationField([
   288|                         'handle' => 'assign_to',
   289|                         'name' => Craft::t('formie', 'Assign To'),
   290|                     ]),
   291|                 ], $this->_getCustomFields($fields));
   292|             }
   293|             if ($this->mapToOpportunity) {
   294|                 $settings['opportunity'] = [
   295|                     new IntegrationField([
   296|                         'handle' => 'name',
   297|                         'name' => Craft::t('formie', 'Name'),
   298|                     ]),
   299|                     new IntegrationField([
   300|                         'handle' => 'value',
   301|                         'name' => Craft::t('formie', 'Value'),
   302|                         'type' => IntegrationField::TYPE_NUMBER,
   303|                     ]),
   304|                     new IntegrationField([
   305|                         'handle' => 'probability',
   306|                         'name' => Craft::t('formie', 'Probability'),
   307|                         'type' => IntegrationField::TYPE_NUMBER,
   308|                     ]),
   309|                     new IntegrationField([
   310|                         'handle' => 'prospect_email',
   311|                         'name' => Craft::t('formie', 'Prospect Email'),
   312|                     ]),
   313|                 ];
   314|             }
   315|         } catch (Throwable $e) {
   316|             Integration::apiError($this, $e);
   317|         }
   318|         return new IntegrationFormSettings($settings);
   319|     }
   320|     public function sendPayload(Submission $submission): bool
   321|     {
   322|         try {
   323|             $prospectValues = $this->getFieldMappingValues($submission, $this->prospectFieldMapping, 'prospect');
   324|             $opportunityValues = $this->getFieldMappingValues($submission, $this->opportunityFieldMapping, 'opportunity');
   325|             if ($this->mapToProspect) {
   326|                 $listId = ArrayHelper::remove($prospectValues, 'list_id');
   327|                 $prospectPayload = $this->_prepPayload($prospectValues);
   328|                 try {
   329|                     $response = $this->request('GET', "prospect/version/4/do/read/email/{$prospectPayload['email']}");
   330|                     $prospectId = $response['prospect']['id'] ?? $response['prospect'][0]['id'] ?? '';
   331|                     if ($prospectId) {
   332|                         $response = $this->deliverPayload($submission, "prospect/version/4/do/update/id/{$prospectId}", $prospectPayload, 'POST', 'form_params');
   333|                     } else {
   334|                         $response = $this->deliverPayload($submission, "prospect/version/4/do/create/{$prospectPayload['email']}", $prospectPayload, 'POST', 'form_params');
   335|                     }
   336|                 } catch (Throwable $e) {
   337|                     $response = $this->deliverPayload($submission, "prospect/version/4/do/create/{$prospectPayload['email']}", $prospectPayload, 'POST', 'form_params');
   338|                 }
   339|                 if ($response === false) {
   340|                     return true;
   341|                 }
   342|                 $prospectId = $response['prospect']['id'] ?? '';
   343|                 if (!$prospectId) {
   344|                     Integration::error($this, Craft::t('formie', 'Missing return “prospectId” {response}. Sent payload {payload}', [
   345|                         'response' => Json::encode($response),
   346|                         'payload' => Json::encode($prospectPayload),
   347|                     ]), true);
   348|                     return false;
   349|                 }
   350|                 if ($listId) {
   351|                     try {
   352|                         $this->deliverPayload($submission, "listMembership/version/4/do/create/list_id/{$listId}/{$prospectId}", [
   353|                             'list_id' => $listId,
   354|                             'prospect_id' => $prospectId,
   355|                         ], 'POST', 'form_params');
   356|                     } catch (Throwable $e) {
   357|                     }
   358|                 }
   359|             }
   360|             if ($this->mapToOpportunity) {
   361|                 $opportunityPayload = $this->_prepPayload($opportunityValues);
   362|                 $response = $this->deliverPayload($submission, 'opportunity/version/4/do/create', $opportunityPayload, 'POST', 'form_params');
   363|                 if ($response === false) {
   364|                     return true;
   365|                 }
   366|                 $opportunityId = $response['opportunity']['id'] ?? '';
   367|                 if (!$opportunityId) {
   368|                     Integration::error($this, Craft::t('formie', 'Missing return “opportunityId” {response}. Sent payload {payload}', [
   369|                         'response' => Json::encode($response),
   370|                         'payload' => Json::encode($opportunityPayload),
   371|                     ]), true);
   372|                     return false;
   373|                 }
   374|             }
   375|             if ($this->enableFormHandler) {
   376|                 $payload = $this->generatePayloadValues($submission);
   377|                 $client = Craft::createGuzzleClient();
   378|                 $request = $client->request('POST', $this->endpointUrl, [
   379|                     'form_params' => $payload,
   380|                 ]);
   381|                 $response = (string)$request->getBody();
   382|                 if (str_contains($response, 'Please correct the following errors')) {
   383|                     Integration::error($this, Craft::t('formie', 'Error in form handler response {response}. Sent payload {payload}', [
   384|                         'response' => $response,
   385|                         'payload' => Json::encode($payload),
   386|                     ]), true);
   387|                     return false;
   388|                 }
   389|             }
   390|         } catch (Throwable $e) {
   391|             Integration::apiError($this, $e);
   392|             return false;
   393|         }
   394|         return true;
   395|     }
   396|     public function getMappedFieldValue(string $mappedFieldValue, Submission $submission, IntegrationField $integrationField): mixed
   397|     {
   398|         $value = parent::getMappedFieldValue($mappedFieldValue, $submission, $integrationField);
   399|         if ($integrationField->getType() === IntegrationField::TYPE_ARRAY) {
   400|             $value = is_array($value) ? implode(';', $value) : $value;
   401|         }
   402|         return $value;
   403|     }
   404|     public function populateContext(): void
   405|     {
   406|         parent::populateContext();
   407|         $trackingData = [];
   408|         $pattern = '/^visitor_id[0-9]+(-hash)?$/';
   409|         foreach ($_COOKIE as $key => $value) {
   410|             if (preg_match($pattern, $key)) {
   411|                 $trackingData[$key] = $value;
   412|             }
   413|         }
   414|         $this->context['pardot_tracking'] = $trackingData;
   415|     }
   416|     protected function defineRules(): array
   417|     {
   418|         $rules = parent::defineRules();
   419|         $rules[] = [['businessUnitId'], 'required'];
   420|         $prospect = $this->getFormSettingValue('prospect');
   421|         $opportunity = $this->getFormSettingValue('opportunity');
   422|         $rules[] = [
   423|             ['prospectFieldMapping'], 'validateFieldMapping', 'params' => $prospect, 'when' => function($model) {
   424|                 return $model->enabled && $model->mapToProspect;
   425|             }, 'on' => [Integration::SCENARIO_FORM],
   426|         ];
   427|         $rules[] = [
   428|             ['opportunityFieldMapping'], 'validateFieldMapping', 'params' => $opportunity, 'when' => function($model) {
   429|                 return $model->enabled && $model->mapToOpportunity;
   430|             }, 'on' => [Integration::SCENARIO_FORM],
   431|         ];
   432|         $rules[] = [
   433|             ['endpointUrl'], 'required', 'when' => function($model) {
   434|                 return $model->enabled && $model->enableFormHandler;
   435|             }, 'on' => [Integration::SCENARIO_FORM],
   436|         ];
   437|         return $rules;
   438|     }
   439|     protected function generatePayloadValues(Submission $submission): array
   440|     {
   441|         $payloadData = $this->generateSubmissionPayloadValues($submission);
   442|         $payload = $payloadData['submission'] ?? [];
   443|         $payload = ArrayHelper::flatten($payload);
   444|         $trackingData = $this->context['pardot_tracking'] ?? [];
   445|         $payload = array_merge($payload, $trackingData);
   446|         $event = new ModifyPayloadEvent([
   447|             'submission' => $submission,
   448|             'payload' => $payload,
   449|         ]);
   450|         $this->trigger(self::EVENT_MODIFY_FORM_HANDLER_PAYLOAD, $event);
   451|         return $event->payload;
   452|     }
   453|     private function _prepPayload($fields)
   454|     {
   455|         $payload = $fields;
   456|         $ownerId = $payload['OwnerId'] ?? '';
   457|         if ($ownerId && str_contains($ownerId, '@')) {
   458|             $ownerId = ArrayHelper::remove($payload, 'OwnerId');
   459|             $payload['Owner'] = [
   460|                 'attributes' => ['type' => 'User'],
   461|                 'Email' => $ownerId,
   462|             ];
   463|         }
   464|         return $payload;
   465|     }
   466|     private function _convertFieldType(string $fieldType): string
   467|     {
   468|         $fieldTypes = [
   469|             'Checkbox' => IntegrationField::TYPE_ARRAY,
   470|             'Multi-Select' => IntegrationField::TYPE_ARRAY,
   471|             'Number' => IntegrationField::TYPE_NUMBER,
   472|             'Date' => IntegrationField::TYPE_DATE,
   473|         ];
   474|         return $fieldTypes[$fieldType] ?? IntegrationField::TYPE_STRING;
   475|     }
   476|     private function _getCustomFields(array $fields, array $excludeNames = []): array
   477|     {
   478|         $customFields = [];
   479|         foreach ($fields as $key => $field) {
   480|             $type = $field['type'] ?? null;
   481|             if (!$type) {
   482|                 continue;
   483|             }
   484|             $customFields[] = new IntegrationField([
   485|                 'handle' => $field['field_id'],
   486|                 'name' => $field['name'],
   487|                 'type' => $this->_convertFieldType($type),
   488|                 'sourceType' => $type,
   489|             ]);
   490|         }
   491|         return $customFields;
   492|     }
   493| }


# ====================================================================
# FILE: src/integrations/crm/Salesforce.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-638 ---
     1| <?php
     2| namespace verbb\formie\integrations\crm;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Crm;
     5| use verbb\formie\base\Integration;
     6| use verbb\formie\elements\Submission;
     7| use verbb\formie\events\ModifyFieldIntegrationValueEvent;
     8| use verbb\formie\fields\FileUpload;
     9| use verbb\formie\helpers\Assets;
    10| use verbb\formie\helpers\ArrayHelper;
    11| use verbb\formie\models\IntegrationField;
    12| use verbb\formie\models\IntegrationFormSettings;
    13| use Craft;
    14| use craft\base\LocalFsInterface;
    15| use craft\elements\db\AssetQuery;
    16| use craft\helpers\App;
    17| use craft\helpers\DateTimeHelper;
    18| use craft\helpers\FileHelper;
    19| use craft\helpers\Json;
    20| use yii\base\Event;
    21| use GuzzleHttp\Exception\RequestException;
    22| use DateTime;
    23| use Throwable;
    24| use Exception;
    25| use verbb\auth\base\OAuthProviderInterface;
    26| use verbb\auth\models\Token;
    27| use verbb\auth\providers\Salesforce as SalesforceProvider;
    28| use League\OAuth1\Client\Credentials\TokenCredentials as OAuth1Token;
    29| use League\OAuth2\Client\Token\AccessToken as OAuth2Token;
    30| class Salesforce extends Crm implements OAuthProviderInterface
    31| {
    32|     public static function supportsOAuthConnection(): bool
    33|     {
    34|         return true;
    35|     }
    36|     public static function getOAuthProviderClass(): string
    37|     {
    38|         return SalesforceProvider::class;
    39|     }
    40|     public static function displayName(): string
    41|     {
    42|         return Craft::t('formie', 'Salesforce');
    43|     }
    44|     public ?string $apiDomain = null;
    45|     public ?string $matchLead = null;
    46|     public bool|string $useSandbox = false;
    47|     public bool|string $useCredentials = false;
    48|     public ?string $username = null;
    49|     public ?string $password = null;
    50|     public bool $mapToContact = false;
    51|     public bool $mapToLead = false;
    52|     public bool $mapToOpportunity = false;
    53|     public bool $mapToAccount = false;
    54|     public bool $mapToCase = false;
    55|     public bool $mapToCampaignMember = false;
    56|     public ?array $contactFieldMapping = null;
    57|     public ?array $leadFieldMapping = null;
    58|     public ?array $opportunityFieldMapping = null;
    59|     public ?array $accountFieldMapping = null;
    60|     public ?array $caseFieldMapping = null;
    61|     public ?array $campaignMemberFieldMapping = null;
    62|     public bool $duplicateLeadTask = false;
    63|     public string $duplicateLeadTaskSubject = 'Task';
    64|     public bool $mapToContactAttachments = false;
    65|     public bool $mapToLeadAttachments = false;
    66|     public bool $mapToOpportunityAttachments = false;
    67|     public bool $mapToAccountAttachments = false;
    68|     public bool $mapToCaseAttachments = false;
    69|     private array $users = [];
    70|     public function init(): void
    71|     {
    72|         parent::init();
    73|         Event::on(self::class, self::EVENT_MODIFY_FIELD_MAPPING_VALUE, function(ModifyFieldIntegrationValueEvent $event) {
    74|             if ($event->integrationField->getType() === IntegrationField::TYPE_DATETIME) {
    75|                 if ($event->rawValue instanceof DateTime) {
    76|                     $date = clone $event->rawValue;
    77|                     $event->value = $date->format('Y-m-d\TH:i:s');
    78|                 }
    79|             }
    80|         });
    81|     }
    82|     public function getUseSandbox(): string
    83|     {
    84|         return App::parseBooleanEnv($this->useSandbox);
    85|     }
    86|     public function getUseCredentials(): string
    87|     {
    88|         return App::parseBooleanEnv($this->useCredentials);
    89|     }
    90|     public function getUsername(): string
    91|     {
    92|         return App::parseEnv($this->username);
    93|     }
    94|     public function getPassword(): string
    95|     {
    96|         return App::parseEnv($this->password);
    97|     }
    98|     public function getApiDomain(): string
    99|     {
   100|         $prefix = $this->getUseSandbox() ? 'test' : 'login';
   101|         return "https://{$prefix}.salesforce.com";
   102|     }
   103|     public function getBaseApiUrl(?Token $token): ?string
   104|     {
   105|         if (!$token) {
   106|             return null;
   107|         }
   108|         $url = $token->values['instance_url'] ?? '';
   109|         return "$url/services/data/v49.0/";
   110|     }
   111|     public function getOAuthProviderConfig(): array
   112|     {
   113|         $config = parent::getOAuthProviderConfig();
   114|         $config['baseApiUrl'] = fn(?Token $token) => $this->getBaseApiUrl($token);
   115|         $config['domain'] = $this->getApiDomain();
   116|         return $config;
   117|     }
   118|     public function getAuthorizationUrlOptions(): array
   119|     {
   120|         $options = parent::getAuthorizationUrlOptions();
   121|         $options['scope'] = [
   122|             'api',
   123|             'openid',
   124|             'refresh_token',
   125|             'offline_access',
   126|         ];
   127|         return $options;
   128|     }
   129|     public function getAccessToken(): OAuth1Token|OAuth2Token|null
   130|     {
   131|         if ($this->getUseCredentials()) {
   132|             $oauthProvider = $this->getOAuthProvider();
   133|             $token = $oauthProvider->getAccessToken('password', [
   134|                 'client_id' => $this->getClientId(),
   135|                 'client_secret' => $this->getClientSecret(),
   136|                 'username' => $this->getUsername(),
   137|                 'password' => $this->getPassword(),
   138|             ]);
   139|             return $token;
   140|         }
   141|         return parent::getAccessToken();
   142|     }
   143|     public function getDescription(): string
   144|     {
   145|         return Craft::t('formie', 'Manage your {name} customers by providing important information on their conversion on your site.', ['name' => static::displayName()]);
   146|     }
   147|     public function fetchFormSettings(): IntegrationFormSettings
   148|     {
   149|         $settings = [];
   150|         try {
   151|             $response = $this->request('GET', 'query', [
   152|                 'query' => ['q' => 'SELECT ID,Name FROM User LIMIT 20'],
   153|             ]);
   154|             $users = $response['records'] ?? [];
   155|             foreach ($users as $user) {
   156|                 $this->users[] = [
   157|                     'label' => $user['Name'],
   158|                     'value' => $user['Id'],
   159|                 ];
   160|             }
   161|             if ($this->mapToContact) {
   162|                 $response = $this->request('GET', 'sobjects/Contact/describe');
   163|                 $fields = $response['fields'] ?? [];
   164|                 $settings['contact'] = $this->_getCustomFields($fields);
   165|             }
   166|             if ($this->mapToLead) {
   167|                 $response = $this->request('GET', 'sobjects/Lead/describe');
   168|                 $fields = $response['fields'] ?? [];
   169|                 $settings['lead'] = $this->_getCustomFields($fields);
   170|             }
   171|             if ($this->mapToOpportunity) {
   172|                 $response = $this->request('GET', 'sobjects/Opportunity/describe');
   173|                 $fields = $response['fields'] ?? [];
   174|                 $settings['opportunity'] = $this->_getCustomFields($fields);
   175|             }
   176|             if ($this->mapToAccount) {
   177|                 $response = $this->request('GET', 'sobjects/Account/describe');
   178|                 $fields = $response['fields'] ?? [];
   179|                 $settings['account'] = $this->_getCustomFields($fields);
   180|             }
   181|             if ($this->mapToCase) {
   182|                 $response = $this->request('GET', 'sobjects/Case/describe');
   183|                 Formie::info(Json::encode($response));
   184|                 $fields = $response['fields'] ?? [];
   185|                 $settings['case'] = $this->_getCustomFields($fields, ['IsClosedOnCreate']);
   186|             }
   187|             if ($this->mapToCampaignMember) {
   188|                 $response = $this->request('GET', 'sobjects/CampaignMember/describe');
   189|                 $fields = $response['fields'] ?? [];
   190|                 $response = $this->request('GET', 'query', [
   191|                     'query' => ['q' => 'SELECT ID,Name FROM Campaign'],
   192|                 ]);
   193|                 $campaignOptions = [];
   194|                 $campaigns = $response['records'] ?? [];
   195|                 foreach ($campaigns as $campaign) {
   196|                     $campaignOptions[] = [
   197|                         'label' => $campaign['Name'],
   198|                         'value' => $campaign['Id'],
   199|                     ];
   200|                 }
   201|                 $settings['campaignMember'] = array_merge([
   202|                     new IntegrationField([
   203|                         'handle' => 'CampaignId',
   204|                         'name' => Craft::t('formie', 'Campaign ID'),
   205|                         'required' => true,
   206|                         'options' => [
   207|                             'label' => Craft::t('formie', 'Campaign'),
   208|                             'options' => $campaignOptions,
   209|                         ],
   210|                     ])
   211|                 ], $this->_getCustomFields($fields));
   212|             }
   213|         } catch (Throwable $e) {
   214|             Integration::apiError($this, $e);
   215|         }
   216|         return new IntegrationFormSettings($settings);
   217|     }
   218|     public function getMappedFieldValue(string $mappedFieldValue, Submission $submission, IntegrationField $integrationField): mixed
   219|     {
   220|         $value = parent::getMappedFieldValue($mappedFieldValue, $submission, $integrationField);
   221|         if ($integrationField->getType() === IntegrationField::TYPE_ARRAY) {
   222|             $value = is_array($value) ? implode(';', $value) : $value;
   223|         }
   224|         return $value;
   225|     }
   226|     public function sendPayload(Submission $submission): bool
   227|     {
   228|         try {
   229|             $contactValues = $this->getFieldMappingValues($submission, $this->contactFieldMapping, 'contact');
   230|             $leadValues = $this->getFieldMappingValues($submission, $this->leadFieldMapping, 'lead');
   231|             $opportunityValues = $this->getFieldMappingValues($submission, $this->opportunityFieldMapping, 'opportunity');
   232|             $accountValues = $this->getFieldMappingValues($submission, $this->accountFieldMapping, 'account');
   233|             $caseValues = $this->getFieldMappingValues($submission, $this->caseFieldMapping, 'case');
   234|             $campaignMemberValues = $this->getFieldMappingValues($submission, $this->campaignMemberFieldMapping, 'campaignMember');
   235|             $accountId = null;
   236|             $accountOwnerId = null;
   237|             if ($this->mapToAccount) {
   238|                 $accountPayload = $this->_prepPayload($accountValues);
   239|                 $response = $this->deliverPayload($submission, 'sobjects/Account', $accountPayload);
   240|                 if ($response === false) {
   241|                     return true;
   242|                 }
   243|                 $accountId = $response['id'] ?? '';
   244|                 if (!$accountId) {
   245|                     Integration::error($this, Craft::t('formie', 'Missing return “accountId” {response}. Sent payload {payload}', [
   246|                         'response' => Json::encode($response),
   247|                         'payload' => Json::encode($accountPayload),
   248|                     ]), true);
   249|                     return false;
   250|                 }
   251|                 if ($this->mapToAccountAttachments) {
   252|                     $this->processAttachments($submission, [
   253|                         'FirstPublishLocationId' => $accountId,
   254|                     ]);
   255|                 }
   256|             }
   257|             $contactId = null;
   258|             $contactOwnerId = null;
   259|             if ($this->mapToContact) {
   260|                 $contactPayload = $this->_prepPayload($contactValues);
   261|                 if (isset($contactPayload['Email'])) {
   262|                     $response = $this->request('GET', 'query', [
   263|                         'query' => ['q' => "SELECT ID,OwnerId FROM Contact WHERE Email = '{$contactPayload['Email']}' LIMIT 1"],
   264|                     ]);
   265|                 }
   266|                 $contactId = $response['records'][0]['Id'] ?? '';
   267|                 $contactOwnerId = $response['records'][0]['OwnerId'] ?? '';
   268|                 if ($accountId) {
   269|                     $contactPayload['AccountId'] = $accountId;
   270|                 }
   271|                 if ($contactId) {
   272|                     $response = $this->deliverPayload($submission, "sobjects/Contact/$contactId", $contactPayload, 'PATCH');
   273|                     if ($response === false) {
   274|                         return true;
   275|                     }
   276|                 } else {
   277|                     $response = $this->deliverPayload($submission, 'sobjects/Contact', $contactPayload);
   278|                     if ($response === false) {
   279|                         return true;
   280|                     }
   281|                     $contactId = $response['id'] ?? '';
   282|                     if (!$contactId) {
   283|                         Integration::error($this, Craft::t('formie', 'Missing return “contactId” {response}. Sent payload {payload}', [
   284|                             'response' => Json::encode($response),
   285|                             'payload' => Json::encode($contactPayload),
   286|                         ]), true);
   287|                         return false;
   288|                     }
   289|                     $response = $this->request('GET', 'query', [
   290|                         'query' => ['q' => "SELECT ID,OwnerId FROM Contact WHERE Id = '{$contactId}' LIMIT 1"],
   291|                     ]);
   292|                     $contactId = $response['records'][0]['Id'] ?? '';
   293|                     $contactOwnerId = $response['records'][0]['OwnerId'] ?? '';
   294|                 }
   295|                 if ($this->mapToContactAttachments) {
   296|                     $this->processAttachments($submission, [
   297|                         'FirstPublishLocationId' => $contactId,
   298|                     ]);
   299|                 }
   300|             }
   301|             if ($this->mapToLead) {
   302|                 $leadPayload = $this->_prepPayload($leadValues);
   303|                 if ($contactOwnerId && !isset($leadPayload['OwnerId'])) {
   304|                     $leadPayload['OwnerId'] = $contactOwnerId;
   305|                 }
   306|                 if (isset($leadPayload['IsUnreadByOwner'])) {
   307|                     $leadPayload['IsUnreadByOwner'] = (bool)$leadPayload['IsUnreadByOwner'];
   308|                 } else {
   309|                     $leadPayload['IsUnreadByOwner'] = true;
   310|                 }
   311|                 try {
   312|                     $response = $this->deliverPayload($submission, 'sobjects/Lead', $leadPayload);
   313|                     if ($response === false) {
   314|                         return true;
   315|                     }
   316|                     $leadId = $response['id'] ?? '';
   317|                     if (!$leadId) {
   318|                         Integration::error($this, Craft::t('formie', 'Missing return “leadId” {response}. Sent payload {payload}', [
   319|                             'response' => Json::encode($response),
   320|                             'payload' => Json::encode($leadPayload),
   321|                         ]), true);
   322|                         return false;
   323|                     }
   324|                     if ($this->mapToLeadAttachments) {
   325|                         $this->processAttachments($submission, [
   326|                             'FirstPublishLocationId' => $leadId,
   327|                         ]);
   328|                     }
   329|                 } catch (Throwable $e) {
   330|                     Integration::apiError($this, $e, false);
   331|                     $taskCreated = false;
   332|                     if ($e instanceof RequestException && $e->getResponse()) {
   333|                         $response = Json::decode((string)$e->getResponse()->getBody());
   334|                         $responseCode = $response[0]['errorCode'] ?? '';
   335|                         if ($responseCode === 'DUPLICATES_DETECTED') {
   336|                             Integration::info($this, 'Duplicate lead found.', false);
   337|                             if ($this->duplicateLeadTask) {
   338|                                 Integration::info($this, 'Attempting to create task for duplicate lead.', false);
   339|                                 $taskPayload = [
   340|                                     'Subject' => $this->duplicateLeadTaskSubject,
   341|                                     'WhoId' => $contactId,
   342|                                     'Description' => '',
   343|                                 ];
   344|                                 foreach ($leadPayload as $key => $item) {
   345|                                     $taskPayload['Description'] .= $key . ': ' . $item . "\n";
   346|                                 }
   347|                                 try {
   348|                                     $response = $this->deliverPayload($submission, 'sobjects/Task', $taskPayload);
   349|                                     if ($response === false) {
   350|                                         return true;
   351|                                     }
   352|                                     $taskCreated = true;
   353|                                     Integration::info($this, Craft::t('formie', 'Response from task-creation {response}. Sent payload {payload}', [
   354|                                         'response' => Json::encode($response),
   355|                                         'payload' => Json::encode($taskPayload),
   356|                                     ]));
   357|                                 } catch (Throwable $e) {
   358|                                     Integration::apiError($this, $e);
   359|                                     return false;
   360|                                 }
   361|                             }
   362|                         }
   363|                     }
   364|                     if (!$taskCreated) {
   365|                         return false;
   366|                     }
   367|                 }
   368|             }
   369|             if ($this->mapToOpportunity) {
   370|                 $opportunityPayload = $this->_prepPayload($opportunityValues);
   371|                 if ($contactOwnerId && !isset($opportunityPayload['OwnerId'])) {
   372|                     $opportunityPayload['OwnerId'] = $contactOwnerId;
   373|                 }
   374|                 if (isset($opportunityPayload['IsPrivate'])) {
   375|                     $opportunityPayload['IsPrivate'] = (bool)$opportunityPayload['IsPrivate'];
   376|                 } else {
   377|                     $opportunityPayload['IsPrivate'] = false;
   378|                 }
   379|                 if (isset($opportunityPayload['CloseDate'])) {
   380|                     $opportunityPayload['CloseDate'] = DateTimeHelper::toDateTime($opportunityPayload['CloseDate'])->format('Y-m-d');
   381|                 } else {
   382|                     $opportunityPayload['CloseDate'] = (new DateTime())->format('Y-m-d');
   383|                 }
   384|                 if ($accountId) {
   385|                     $opportunityPayload['AccountId'] = $accountId;
   386|                 }
   387|                 $response = $this->deliverPayload($submission, 'sobjects/Opportunity', $opportunityPayload);
   388|                 if ($response === false) {
   389|                     return true;
   390|                 }
   391|                 $opportunityId = $response['id'] ?? '';
   392|                 if (!$opportunityId) {
   393|                     Integration::error($this, Craft::t('formie', 'Missing return “opportunityId” {response}. Sent payload {payload}', [
   394|                         'response' => Json::encode($response),
   395|                         'payload' => Json::encode($opportunityPayload),
   396|                     ]), true);
   397|                     return false;
   398|                 }
   399|                 if ($this->mapToOpportunityAttachments) {
   400|                     $this->processAttachments($submission, [
   401|                         'FirstPublishLocationId' => $opportunityId,
   402|                     ]);
   403|                 }
   404|             }
   405|             if ($this->mapToCase) {
   406|                 $casePayload = $this->_prepPayload($caseValues);
   407|                 if ($contactId) {
   408|                     $casePayload['ContactId'] = $contactId;
   409|                 }
   410|                 if ($accountId) {
   411|                     $casePayload['AccountId'] = $accountId;
   412|                 }
   413|                 $response = $this->deliverPayload($submission, 'sobjects/Case', $casePayload);
   414|                 if ($response === false) {
   415|                     return true;
   416|                 }
   417|                 $caseId = $response['id'] ?? '';
   418|                 if (!$caseId) {
   419|                     Integration::error($this, Craft::t('formie', 'Missing return “caseId” {response}. Sent payload {payload}', [
   420|                         'response' => Json::encode($response),
   421|                         'payload' => Json::encode($casePayload),
   422|                     ]), true);
   423|                     return false;
   424|                 }
   425|                 if ($this->mapToCaseAttachments) {
   426|                     $this->processAttachments($submission, [
   427|                         'FirstPublishLocationId' => $caseId,
   428|                     ]);
   429|                 }
   430|             }
   431|             if ($this->mapToCampaignMember) {
   432|                 $campaignMemberPayload = $this->_prepPayload($campaignMemberValues);
   433|                 if ($contactId) {
   434|                     $campaignMemberPayload['ContactId'] = $contactId;
   435|                 }
   436|                 if ($accountId) {
   437|                     $campaignMemberPayload['AccountId'] = $accountId;
   438|                 }
   439|                 if ($leadId) {
   440|                     $campaignMemberPayload['LeadId'] = $leadId;
   441|                 }
   442|                 $response = $this->deliverPayload($submission, 'sobjects/CampaignMember', $campaignMemberPayload);
   443|                 if ($response === false) {
   444|                     return true;
   445|                 }
   446|                 $campaignMemberId = $response['id'] ?? '';
   447|                 if (!$campaignMemberId) {
   448|                     Integration::error($this, Craft::t('formie', 'Missing return “campaignMemberId” {response}. Sent payload {payload}', [
   449|                         'response' => Json::encode($response),
   450|                         'payload' => Json::encode($campaignMemberPayload),
   451|                     ]), true);
   452|                     return false;
   453|                 }
   454|             }
   455|         } catch (Throwable $e) {
   456|             Integration::apiError($this, $e);
   457|             return false;
   458|         }
   459|         return true;
   460|     }
   461|     protected function defineRules(): array
   462|     {
   463|         $rules = parent::defineRules();
   464|         $contact = $this->getFormSettingValue('contact');
   465|         $lead = $this->getFormSettingValue('lead');
   466|         $opportunity = $this->getFormSettingValue('opportunity');
   467|         $account = $this->getFormSettingValue('account');
   468|         $case = $this->getFormSettingValue('case');
   469|         $rules[] = [
   470|             ['contactFieldMapping'], 'validateFieldMapping', 'params' => $contact, 'when' => function($model) {
   471|                 return $model->enabled && $model->mapToContact;
   472|             }, 'on' => [Integration::SCENARIO_FORM],
   473|         ];
   474|         $rules[] = [
   475|             ['leadFieldMapping'], 'validateFieldMapping', 'params' => $lead, 'when' => function($model) {
   476|                 return $model->enabled && $model->mapToLead;
   477|             }, 'on' => [Integration::SCENARIO_FORM],
   478|         ];
   479|         $rules[] = [
   480|             ['opportunityFieldMapping'], 'validateFieldMapping', 'params' => $opportunity, 'when' => function($model) {
   481|                 return $model->enabled && $model->mapToOpportunity;
   482|             }, 'on' => [Integration::SCENARIO_FORM],
   483|         ];
   484|         $rules[] = [
   485|             ['accountFieldMapping'], 'validateFieldMapping', 'params' => $account, 'when' => function($model) {
   486|                 return $model->enabled && $model->mapToAccount;
   487|             }, 'on' => [Integration::SCENARIO_FORM],
   488|         ];
   489|         $rules[] = [
   490|             ['caseFieldMapping'], 'validateFieldMapping', 'params' => $case, 'when' => function($model) {
   491|                 return $model->enabled && $model->mapToCase;
   492|             }, 'on' => [Integration::SCENARIO_FORM],
   493|         ];
   494|         $rules[] = [
   495|             ['campaignMemberFieldMapping'], 'validateFieldMapping', 'params' => $case, 'when' => function($model) {
   496|                 return $model->enabled && $model->mapToCampaignMember;
   497|             }, 'on' => [Integration::SCENARIO_FORM],
   498|         ];
   499|         return $rules;
   500|     }
   501|     protected function processAttachments(Submission $submission, array $payload): void
   502|     {
   503|         $localAttachments = [];
   504|         if ($assets = $this->_getAssetsForSubmission($submission)) {
   505|             foreach ($assets as $asset) {
   506|                 $path = Assets::getFullAssetFilePath($asset);
   507|                 if (!($asset->getVolume()->getFs() instanceof LocalFsInterface)) {
   508|                     $localAttachments[] = $path;
   509|                 }
   510|                 $fileContent = base64_encode(file_get_contents($path));
   511|                 $fileName = basename($path);
   512|                 $attachmentPayload = array_merge($payload, [
   513|                     'Title' => $fileName,
   514|                     'PathOnClient' => $fileName,
   515|                     'VersionData' => $fileContent,
   516|                 ]);
   517|                 $response = $this->deliverPayload($submission, 'sobjects/ContentVersion', $attachmentPayload);
   518|             }
   519|         }
   520|         foreach ($localAttachments as $path) {
   521|             if (file_exists($path)) {
   522|                 unlink($path);
   523|             }
   524|         }
   525|     }
   526|     private function _convertFieldType(string $fieldType): string
   527|     {
   528|         $fieldTypes = [
   529|             'boolean' => IntegrationField::TYPE_BOOLEAN,
   530|             'multipicklist' => IntegrationField::TYPE_ARRAY,
   531|             'int' => IntegrationField::TYPE_NUMBER,
   532|             'number' => IntegrationField::TYPE_FLOAT,
   533|             'currency' => IntegrationField::TYPE_FLOAT,
   534|             'double' => IntegrationField::TYPE_FLOAT,
   535|             'date' => IntegrationField::TYPE_DATE,
   536|             'datetime' => IntegrationField::TYPE_DATETIME,
   537|         ];
   538|         return $fieldTypes[$fieldType] ?? IntegrationField::TYPE_STRING;
   539|     }
   540|     private function _getCustomFields(array $fields, array $excludeNames = []): array
   541|     {
   542|         $customFields = [];
   543|         $supportedFields = [
   544|             'string',
   545|             'textarea',
   546|             'email',
   547|             'url',
   548|             'address',
   549|             'picklist',
   550|             'phone',
   551|             'reference',
   552|             'boolean',
   553|             'multipicklist',
   554|             'int',
   555|             'number',
   556|             'currency',
   557|             'double',
   558|             'date',
   559|             'datetime',
   560|         ];
   561|         foreach ($fields as $key => $field) {
   562|             if (!$field['updateable']) {
   563|                 continue;
   564|             }
   565|             if (!in_array($field['type'], $supportedFields)) {
   566|                 continue;
   567|             }
   568|             if (in_array($field['name'], $excludeNames)) {
   569|                 continue;
   570|             }
   571|             $options = [];
   572|             if (($field['name'] === 'OwnerId') && $this->users) {
   573|                 $options = array_merge($options, $this->users);
   574|             }
   575|             $pickListValues = $field['picklistValues'] ?? [];
   576|             foreach ($pickListValues as $pickListValue) {
   577|                 $options[] = [
   578|                     'label' => $pickListValue['label'],
   579|                     'value' => $pickListValue['value'],
   580|                 ];
   581|             }
   582|             if ($field['type'] === 'boolean') {
   583|                 $options[] = [
   584|                     'label' => Craft::t('formie', 'True'),
   585|                     'value' => 'true',
   586|                 ];
   587|                 $options[] = [
   588|                     'label' => Craft::t('formie', 'False'),
   589|                     'value' => 'false',
   590|                 ];
   591|             }
   592|             if ($options) {
   593|                 $options = [
   594|                     'label' => $field['label'],
   595|                     'options' => $options,
   596|                 ];
   597|             }
   598|             $required = false;
   599|             $isCreateable = $field['createable'] ?? null;
   600|             $isNillable = $field['nillable'] ?? null;
   601|             if ($isCreateable === true && $isNillable === false && $field['type'] !== 'boolean') {
   602|                 $required = true;
   603|             }
   604|             $customFields[] = new IntegrationField([
   605|                 'handle' => $field['name'],
   606|                 'name' => $field['label'],
   607|                 'type' => $this->_convertFieldType($field['type']),
   608|                 'sourceType' => $field['type'],
   609|                 'required' => $required,
   610|                 'options' => $options,
   611|             ]);
   612|         }
   613|         return $customFields;
   614|     }
   615|     private function _prepPayload(array $fields): array
   616|     {
   617|         $payload = $fields;
   618|         $ownerId = $payload['OwnerId'] ?? '';
   619|         if ($ownerId && str_contains($ownerId, '@')) {
   620|             $ownerId = ArrayHelper::remove($payload, 'OwnerId');
   621|             $payload['Owner'] = [
   622|                 'attributes' => ['type' => 'User'],
   623|                 'Email' => $ownerId,
   624|             ];
   625|         }
   626|         return $payload;
   627|     }
   628|     private function _getAssetsForSubmission(Submission $submission): array
   629|     {
   630|         $assets = [];
   631|         foreach ($submission->getFieldValuesForField(FileUpload::class) as $value) {
   632|             if ($value instanceof AssetQuery) {
   633|                 $assets[] = $value->all();
   634|             }
   635|         }
   636|         return array_merge(...$assets);
   637|     }
   638| }


# ====================================================================
# FILE: src/integrations/payments/Opayo.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-667 ---
     1| <?php
     2| namespace verbb\formie\integrations\payments;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\base\FieldInterface;
     6| use verbb\formie\base\Integration;
     7| use verbb\formie\base\Payment;
     8| use verbb\formie\elements\Submission;
     9| use verbb\formie\events\ModifyPaymentCurrencyOptionsEvent;
    10| use verbb\formie\events\ModifyPaymentPayloadEvent;
    11| use verbb\formie\events\PaymentReceiveWebhookEvent;
    12| use verbb\formie\fields;
    13| use verbb\formie\fields\SingleLineText;
    14| use verbb\formie\helpers\ArrayHelper;
    15| use verbb\formie\helpers\SchemaHelper;
    16| use verbb\formie\helpers\StringHelper;
    17| use verbb\formie\helpers\Variables;
    18| use verbb\formie\models\IntegrationField;
    19| use verbb\formie\models\Payment as PaymentModel;
    20| use verbb\formie\models\Plan;
    21| use Craft;
    22| use craft\helpers\App;
    23| use craft\helpers\Component;
    24| use craft\helpers\DateTimeHelper;
    25| use craft\helpers\Json;
    26| use craft\helpers\UrlHelper;
    27| use craft\web\Response;
    28| use yii\base\Event;
    29| use GuzzleHttp\Client;
    30| use GuzzleHttp\Exception\RequestException;
    31| use Throwable;
    32| use Exception;
    33| use CommerceGuys\Addressing\Country\CountryRepository;
    34| use CommerceGuys\Addressing\Subdivision\SubdivisionRepository;
    35| class Opayo extends Payment
    36| {
    37|     public const EVENT_MODIFY_PAYLOAD = 'modifyPayload';
    38|     private const ZERO_DECIMAL_CURRENCIES = ['BIF','CLP','DJF','GNF','JPY','KMF','KRW','MGA','PYG','RWF','UGX','VND','VUV','XAF','XOF','XPF'];
    39|     public static function displayName(): string
    40|     {
    41|         return Craft::t('formie', 'Opayo');
    42|     }
    43|     public function supportsCallbacks(): bool
    44|     {
    45|         return true;
    46|     }
    47|     public static function toOpayoAmount(float $amount, string $currency): float
    48|     {
    49|         if (in_array(strtoupper($currency), self::ZERO_DECIMAL_CURRENCIES)) {
    50|             return $amount;
    51|         }
    52|         return ceil($amount * 100);
    53|     }
    54|     public static function fromOpayoAmount(float $amount, string $currency): float
    55|     {
    56|         if (in_array(strtoupper($currency), self::ZERO_DECIMAL_CURRENCIES)) {
    57|             return $amount;
    58|         }
    59|         return $amount * 0.01;
    60|     }
    61|     public ?string $vendorName = null;
    62|     public ?string $integrationKey = null;
    63|     public ?string $integrationPassword = null;
    64|     public bool|string $useSandbox = false;
    65|     public function getDescription(): string
    66|     {
    67|         return Craft::t('formie', 'Provide payment capabilities for your forms with {name}.', ['name' => static::displayName()]);
    68|     }
    69|     public function hasValidSettings(): bool
    70|     {
    71|         return App::parseEnv($this->vendorName) && App::parseEnv($this->integrationKey) && App::parseEnv($this->integrationPassword);
    72|     }
    73|     public function getReturnUrl(): string
    74|     {
    75|         if (Craft::$app->getConfig()->getGeneral()->headlessMode) {
    76|             return UrlHelper::actionUrl('formie/payment-webhooks/process-callback', ['handle' => $this->handle]);
    77|         }
    78|         return UrlHelper::siteUrl('formie/payment-webhooks/process-callback', ['handle' => $this->handle]);
    79|     }
    80|     public function getFrontEndJsVariables(FieldInterface $field = null): ?array
    81|     {
    82|         if (!$this->hasValidSettings()) {
    83|             return null;
    84|         }
    85|         $this->setField($field);
    86|         $settings = [
    87|             'handle' => $this->handle,
    88|             'useSandbox' => App::parseBooleanEnv($this->useSandbox),
    89|             'currency' => $this->getFieldSetting('currency'),
    90|             'amountType' => $this->getFieldSetting('amountType'),
    91|             'amountFixed' => $this->getFieldSetting('amountFixed'),
    92|             'amountVariable' => $this->getFieldSetting('amountVariable'),
    93|         ];
    94|         return [
    95|             'src' => Craft::$app->getAssetManager()->getPublishedUrl('@verbb/formie/web/assets/frontend/dist/', true, 'js/payments/opayo.js'),
    96|             'module' => 'FormieOpayo',
    97|             'settings' => $settings,
    98|         ];
    99|     }
   100|     public function getAmount(Submission $submission): float
   101|     {
   102|         return self::toOpayoAmount(parent::getAmount($submission), $this->getCurrency($submission));
   103|     }
   104|     public function getCurrency(Submission $submission): ?string
   105|     {
   106|         return (string)$this->getFieldSetting('currency');
   107|     }
   108|     public function processPayment(Submission $submission): bool
   109|     {
   110|         $payload = [];
   111|         $response = null;
   112|         $result = false;
   113|         if (!$this->beforeProcessPayment($submission)) {
   114|             return true;
   115|         }        
   116|         $amount = $this->getAmount($submission);
   117|         $currency = $this->getCurrency($submission);
   118|         try {
   119|             $field = $this->getField();
   120|             $fieldValue = $this->getPaymentFieldValue($submission);
   121|             $opayoTokenId = $fieldValue['opayoTokenId'] ?? null;
   122|             $opayoSessionKey = $fieldValue['opayoSessionKey'] ?? null;
   123|             $opayo3DSComplete = $fieldValue['opayo3DSComplete'] ?? null;
   124|             if ($opayo3DSComplete) {
   125|                 if (Formie::$plugin->getPayments()->getPaymentByReference($opayo3DSComplete)) {
   126|                     return true;
   127|                 } else {
   128|                     throw new Exception('Unable to find payment by "' . $opayo3DSComplete . '".');
   129|                 }
   130|             }
   131|             if (!$opayoTokenId || !is_string($opayoTokenId)) {
   132|                 throw new Exception("Missing `opayoTokenId` from payload: {$opayoTokenId}.");
   133|             }
   134|             if (!$opayoSessionKey || !is_string($opayoSessionKey)) {
   135|                 throw new Exception("Missing `opayoSessionKey` from payload: {$opayoSessionKey}.");
   136|             }
   137|             if (!$amount) {
   138|                 throw new Exception("Missing `amount` from payload: {$amount}.");
   139|             }
   140|             if (!$currency) {
   141|                 throw new Exception("Missing `currency` from payload: {$currency}.");
   142|             }
   143|             $payload = $this->_getPayload($opayoSessionKey, $opayoTokenId, $submission, $amount, $currency);
   144|             $event = new ModifyPaymentPayloadEvent([
   145|                 'integration' => $this,
   146|                 'submission' => $submission,
   147|                 'payload' => $payload,
   148|             ]);
   149|             $this->trigger(self::EVENT_MODIFY_PAYLOAD, $event);
   150|             $payload = $event->payload;
   151|             $response = $this->request('POST', 'transactions', ['json' => $payload]);
   152|             $status = $response['status'] ?? null;
   153|             $statusDetail = $response['statusDetail'] ?? null;
   154|             $acsUrl = $response['acsUrl'] ?? null;
   155|             if ($acsUrl) {
   156|                 $payment = new PaymentModel();
   157|                 $payment->integrationId = $this->id;
   158|                 $payment->submissionId = $submission->id;
   159|                 $payment->fieldId = $field->id;
   160|                 $payment->amount = self::fromOpayoAmount($amount, $currency);
   161|                 $payment->currency = $currency;
   162|                 $payment->reference = $response['transactionId'] ?? '';
   163|                 $payment->response = $response;
   164|                 $payment->status = PaymentModel::STATUS_PENDING;
   165|                 Formie::$plugin->getPayments()->savePayment($payment);
   166|                 $threeDSSessionData = [
   167|                     'submissionId' => $submission->id,
   168|                     'fieldId' => $field->id,
   169|                     'amount' => $amount,
   170|                     'currency' => $currency,
   171|                     'reference' => $response['transactionId'] ?? '',
   172|                 ];
   173|                 $submission->getForm()->addFrontEndJsEvents([
   174|                     'event' => 'FormiePaymentOpayo3DS',
   175|                     'data' => [
   176|                         'acsUrl' => $acsUrl,
   177|                         'creq' => $response['cReq'] ?? '',
   178|                         'returnUrl' => $this->getReturnUrl(),
   179|                         'threeDSSessionData' => base64_encode(Json::encode($threeDSSessionData)),
   180|                     ],
   181|                 ]);
   182|                 $this->addFieldError($submission, Craft::t('formie', 'This payment requires 3D Secure authentication. Please follow the instructions on-screen to continue.'));
   183|                 return false;
   184|             }
   185|             if ($status !== 'Ok') {
   186|                 throw new Exception(StringHelper::titleize($status) . ': ' . $statusDetail);
   187|             }
   188|             $payment = new PaymentModel();
   189|             $payment->integrationId = $this->id;
   190|             $payment->submissionId = $submission->id;
   191|             $payment->fieldId = $field->id;
   192|             $payment->amount = self::fromOpayoAmount($amount, $currency);
   193|             $payment->currency = $currency;
   194|             $payment->reference = $response['transactionId'] ?? '';
   195|             $payment->response = $response;
   196|             $payment->status = PaymentModel::STATUS_SUCCESS;
   197|             Formie::$plugin->getPayments()->savePayment($payment);
   198|             $result = true;
   199|         } catch (Throwable $e) {
   200|             Integration::error($this, Craft::t('formie', 'Payment error: “{message}” {file}:{line}. Response: “{response}”. Payload: “{payload}”', [
   201|                 'message' => $e->getMessage(),
   202|                 'file' => $e->getFile(),
   203|                 'line' => $e->getLine(),
   204|                 'response' => Json::encode($response),
   205|                 'payload' => Json::encode($payload),
   206|             ]));
   207|             Integration::apiError($this, $e, $this->throwApiError);
   208|             $message = (strlen($e->getMessage()) > 30) ? substr($e->getMessage(), 0, 30) . '...' : '';
   209|             $this->addFieldError($submission, Craft::t('formie', 'A payment error has occurred “{message}”.', ['message' => $message]));
   210|             $payment = new PaymentModel();
   211|             $payment->integrationId = $this->id;
   212|             $payment->submissionId = $submission->id;
   213|             $payment->fieldId = $field->id;
   214|             $payment->amount = self::fromOpayoAmount($amount, $currency);
   215|             $payment->currency = $currency;
   216|             $payment->status = PaymentModel::STATUS_FAILED;
   217|             $payment->reference = null;
   218|             $payment->response = ['message' => $e->getMessage()];
   219|             Formie::$plugin->getPayments()->savePayment($payment);
   220|             return false;
   221|         }
   222|         if (!$this->afterProcessPayment($submission, $result)) {
   223|             return true;
   224|         }
   225|         return $result;
   226|     }
   227|     public function processCallback(): Response
   228|     {
   229|         $request = Craft::$app->getRequest();
   230|         $callbackResponse = Craft::$app->getResponse();
   231|         $callbackResponse->format = Response::FORMAT_RAW;
   232|         if ($request->getParam('merchantSessionKey')) {
   233|             $callbackResponse->format = Response::FORMAT_JSON;
   234|             try {
   235|                 $response = $this->request('POST', 'merchant-session-keys', [
   236|                     'json' => ['vendorName' => App::parseEnv($this->vendorName)],
   237|                 ]);
   238|                 $callbackResponse->data = [
   239|                     'merchantSessionKey' => $response['merchantSessionKey'] ?? null,
   240|                 ];
   241|             } catch (Throwable $e) {
   242|                 $callbackResponse->data = [
   243|                     'error' => $e->getMessage(),
   244|                 ];
   245|             }
   246|             return $callbackResponse;
   247|         }
   248|         $response = [];
   249|         $responseData = [];
   250|         $cres = $request->getParam('cres');
   251|         $data = $request->getParam('threeDSSessionData');
   252|         if (!$cres || !$data) {
   253|             Integration::error($this, 'Callback not signed or signing secret not set.');
   254|             $callbackResponse->data = 'ok';
   255|             return $callbackResponse;
   256|         }
   257|         $data = Json::decode(base64_decode($data));
   258|         $submissionId = $data['submissionId'] ?? null;
   259|         $fieldId = $data['fieldId'] ?? null;
   260|         $amount = $data['amount'] ?? null;
   261|         $currency = $data['currency'] ?? null;
   262|         $transactionId = $data['reference'] ?? null;
   263|         try {
   264|             $response = $this->request('POST', "transactions/$transactionId/3d-secure-challenge", [
   265|                 'json' => [
   266|                     'threeDSSessionData' => $transactionId,
   267|                     'cRes' => $cres,
   268|                 ],
   269|             ]);
   270|             $status = $response['status'] ?? null;
   271|             $statusDetail = $response['statusDetail'] ?? null;
   272|             if ($status !== 'Ok') {
   273|                 throw new Exception(StringHelper::titleize($status) . ': ' . $statusDetail);
   274|             }
   275|             $payment = Formie::$plugin->getPayments()->getPaymentByReference($transactionId);
   276|             if ($payment) {
   277|                 $payment->status = PaymentModel::STATUS_SUCCESS;
   278|                 $payment->reference = $transactionId;
   279|                 $payment->response = $response;
   280|                 Formie::$plugin->getPayments()->savePayment($payment);
   281|             } else {
   282|                 throw new Exception('Unable to find payment by "' . $transactionId . '".');
   283|             }
   284|             $responseData['success'] = true;
   285|             $responseData['transactionId'] = $transactionId;
   286|         } catch (Throwable $e) {
   287|             Integration::error($this, Craft::t('formie', 'Payment error: “{message}” {file}:{line}. Response: “{response}. Payload: “{payload}”', [
   288|                 'message' => $e->getMessage(),
   289|                 'file' => $e->getFile(),
   290|                 'line' => $e->getLine(),
   291|                 'response' => Json::encode($response),
   292|                 'payload' => Json::encode($data ?? []),
   293|             ]));
   294|             $shouldShowError = true;
   295|             if ($e instanceof RequestException && $e->getResponse()) {
   296|                 $rawResponse = $e->getResponse();
   297|                 $messageText = (string)$rawResponse->getBody()->getContents();
   298|                 $response = Json::decode($messageText);
   299|                 $code = $response['code'] ?? null;
   300|                 if ($code == '1017') {
   301|                     $shouldShowError = false;
   302|                     $payment = Formie::$plugin->getPayments()->getPaymentByReference($transactionId);
   303|                     if ($payment) {
   304|                         $payment->status = PaymentModel::STATUS_SUCCESS;
   305|                         $payment->reference = $transactionId;
   306|                         $payment->response = $response;
   307|                         Formie::$plugin->getPayments()->savePayment($payment);
   308|                     }
   309|                     $responseData['success'] = true;
   310|                     $responseData['transactionId'] = $transactionId;
   311|                 }
   312|             }
   313|             if ($shouldShowError) {
   314|                 Integration::apiError($this, $e, $this->throwApiError);
   315|                 $error = ['message' => $e->getMessage()];
   316|                 $payment = new PaymentModel();
   317|                 $payment->response = $error;
   318|                 if ($transactionId) {
   319|                     if ($payment = Formie::$plugin->getPayments()->getPaymentByReference($transactionId)) {
   320|                         if (is_array($payment->response)) {
   321|                             $payment->response['message'] = $e->getMessage();
   322|                         }
   323|                     }
   324|                 }
   325|                 $payment->integrationId = $this->id;
   326|                 $payment->submissionId = $submissionId;
   327|                 $payment->fieldId = $fieldId;
   328|                 $payment->amount = self::fromOpayoAmount($amount, $currency);
   329|                 $payment->currency = $currency;
   330|                 $payment->status = PaymentModel::STATUS_FAILED;
   331|                 $payment->reference = $transactionId;
   332|                 Formie::$plugin->getPayments()->savePayment($payment);
   333|                 $responseData['error'] = $error;
   334|             }
   335|         }
   336|         $callbackResponse->data = '<script>window.parent.postMessage({ message: "FormiePaymentOpayo3DSResponse", value: ' . Json::encode($responseData) . ' }, "*");</script>';
   337|         return $callbackResponse;
   338|     }
   339|     public function fetchConnection(): bool
   340|     {
   341|         try {
   342|             $response = $this->request('POST', 'merchant-session-keys', [
   343|                 'json' => ['vendorName' => App::parseEnv($this->vendorName)],
   344|             ]);
   345|         } catch (Throwable $e) {
   346|             Integration::apiError($this, $e);
   347|             return false;
   348|         }
   349|         return true;
   350|     }
   351|     public function getClient(): Client
   352|     {
   353|         if ($this->_client) {
   354|             return $this->_client;
   355|         }
   356|         $useSandbox = App::parseBooleanEnv($this->useSandbox);
   357|         $url = $useSandbox ? 'https://pi-test.sagepay.com/' : 'https://pi-live.sagepay.com/';
   358|         return $this->_client = Craft::createGuzzleClient([
   359|             'base_uri' => $url . 'api/v1/',
   360|             'auth' => [App::parseEnv($this->integrationKey), App::parseEnv($this->integrationPassword)],
   361|         ]);
   362|     }
   363|     public function defineGeneralSchema(): array
   364|     {
   365|         return [
   366|             SchemaHelper::selectField([
   367|                 'label' => Craft::t('formie', 'Payment Currency'),
   368|                 'help' => Craft::t('formie', 'Provide the currency to be used for the transaction.'),
   369|                 'name' => 'currency',
   370|                 'required' => true,
   371|                 'validation' => 'required',
   372|                 'options' => array_merge(
   373|                     [['label' => Craft::t('formie', 'Select an option'), 'value' => '']],
   374|                     static::getCurrencyOptions()
   375|                 ),
   376|             ]),
   377|             [
   378|                 '$formkit' => 'fieldWrap',
   379|                 'label' => Craft::t('formie', 'Payment Amount'),
   380|                 'help' => Craft::t('formie', 'Provide an amount for the transaction. This can be either a fixed value, or derived from a field.'),
   381|                 'children' => [
   382|                     [
   383|                         '$el' => 'div',
   384|                         'attrs' => [
   385|                             'class' => 'flex',
   386|                         ],
   387|                         'children' => [
   388|                             SchemaHelper::selectField([
   389|                                 'name' => 'amountType',
   390|                                 'options' => [
   391|                                     ['label' => Craft::t('formie', 'Fixed Value'), 'value' => Payment::VALUE_TYPE_FIXED],
   392|                                     ['label' => Craft::t('formie', 'Dynamic Value'), 'value' => Payment::VALUE_TYPE_DYNAMIC],
   393|                                 ],
   394|                             ]),
   395|                             SchemaHelper::numberField([
   396|                                 'name' => 'amountFixed',
   397|                                 'size' => 6,
   398|                                 'if' => '$get(amountType).value == ' . Payment::VALUE_TYPE_FIXED,
   399|                             ]),
   400|                             SchemaHelper::fieldSelectField([
   401|                                 'name' => 'amountVariable',
   402|                                 'fieldTypes' => [
   403|                                     fields\Calculations::class,
   404|                                     fields\Dropdown::class,
   405|                                     fields\Hidden::class,
   406|                                     fields\Number::class,
   407|                                     fields\Radio::class,
   408|                                     fields\SingleLineText::class,
   409|                                 ],
   410|                                 'if' => '$get(amountType).value == ' . Payment::VALUE_TYPE_DYNAMIC,
   411|                             ]),
   412|                         ],
   413|                     ],
   414|                 ],
   415|             ],
   416|         ];
   417|     }
   418|     public function defineSettingsSchema(): array
   419|     {
   420|         return [
   421|             [
   422|                 '$formkit' => 'staticTable',
   423|                 'label' => Craft::t('formie', 'Billing Details'),
   424|                 'help' => Craft::t('formie', 'Whether to send billing details alongside the payment.'),
   425|                 'name' => 'billingDetails',
   426|                 'columns' => [
   427|                     'heading' => [
   428|                         'type' => 'heading',
   429|                         'heading' => Craft::t('formie', 'Billing Info'),
   430|                         'class' => 'heading-cell thin',
   431|                     ],
   432|                     'value' => [
   433|                         'type' => 'fieldSelect',
   434|                         'label' => Craft::t('formie', 'Field'),
   435|                         'class' => 'select-cell',
   436|                     ],
   437|                 ],
   438|                 'rows' => [
   439|                     'billingName' => [
   440|                         'heading' => Craft::t('formie', 'Billing Name'),
   441|                         'value' => '',
   442|                     ],
   443|                     'billingEmail' => [
   444|                         'heading' => Craft::t('formie', 'Billing Email'),
   445|                         'value' => '',
   446|                     ],
   447|                     'billingAddress' => [
   448|                         'heading' => Craft::t('formie', 'Billing Address'),
   449|                         'value' => '',
   450|                     ],
   451|                 ],
   452|             ],
   453|         ];
   454|     }
   455|     public function getFrontEndSubFields($field, $context): array
   456|     {
   457|         $subFields = [];
   458|         $rowConfigs = [
   459|             [
   460|                 [
   461|                     'type' => SingleLineText::class,
   462|                     'label' => Craft::t('formie', 'Cardholder Name'),
   463|                     'handle' => 'cardName',
   464|                     'required' => true,
   465|                     'inputAttributes' => [
   466|                         [
   467|                             'label' => 'data-opayo-card',
   468|                             'value' => 'cardholder-name',
   469|                         ],
   470|                         [
   471|                             'label' => 'name',
   472|                             'value' => false,
   473|                         ],
   474|                         [
   475|                             'label' => 'autocomplete',
   476|                             'value' => 'cc-name',
   477|                         ],
   478|                     ],
   479|                 ],
   480|             ],
   481|             [
   482|                 [
   483|                     'type' => SingleLineText::class,
   484|                     'label' => Craft::t('formie', 'Card Number'),
   485|                     'handle' => 'cardNumber',
   486|                     'required' => true,
   487|                     'placeholder' => '•••• •••• •••• ••••',
   488|                     'inputAttributes' => [
   489|                         [
   490|                             'label' => 'data-opayo-card',
   491|                             'value' => 'card-number',
   492|                         ],
   493|                         [
   494|                             'label' => 'name',
   495|                             'value' => false,
   496|                         ],
   497|                         [
   498|                             'label' => 'autocomplete',
   499|                             'value' => 'cc-number',
   500|                         ],
   501|                     ],
   502|                 ],
   503|                 [
   504|                     'type' => SingleLineText::class,
   505|                     'label' => Craft::t('formie', 'Expiry'),
   506|                     'handle' => 'cardExpiry',
   507|                     'required' => true,
   508|                     'placeholder' => 'MMYY',
   509|                     'inputAttributes' => [
   510|                         [
   511|                             'label' => 'data-opayo-card',
   512|                             'value' => 'expiry-date',
   513|                         ],
   514|                         [
   515|                             'label' => 'name',
   516|                             'value' => false,
   517|                         ],
   518|                         [
   519|                             'label' => 'autocomplete',
   520|                             'value' => 'cc-exp',
   521|                         ],
   522|                     ],
   523|                 ],
   524|                 [
   525|                     'type' => SingleLineText::class,
   526|                     'label' => Craft::t('formie', 'CVC'),
   527|                     'handle' => 'cardCvc',
   528|                     'required' => true,
   529|                     'placeholder' => '•••',
   530|                     'inputAttributes' => [
   531|                         [
   532|                             'label' => 'data-opayo-card',
   533|                             'value' => 'security-code',
   534|                         ],
   535|                         [
   536|                             'label' => 'name',
   537|                             'value' => false,
   538|                         ],
   539|                         [
   540|                             'label' => 'autocomplete',
   541|                             'value' => 'cc-csc',
   542|                         ],
   543|                     ],
   544|                 ],
   545|             ],
   546|         ];
   547|         foreach ($rowConfigs as $key => $rowConfig) {
   548|             foreach ($rowConfig as $config) {
   549|                 $subField = Component::createComponent($config, FieldInterface::class);
   550|                 $subField->setParentField($field);
   551|                 $subFields[$key][] = $subField;
   552|             }
   553|         }
   554|         return $subFields;
   555|     }
   556|     protected function defineRules(): array
   557|     {
   558|         $rules = parent::defineRules();
   559|         $rules[] = [['vendorName', 'integrationKey', 'integrationPassword'], 'required', 'on' => [Integration::SCENARIO_FORM]];
   560|         return $rules;
   561|     }
   562|     private function _getPayload(string $opayoSessionKey, string $opayoTokenId, Submission $submission, int $amount, string $currency): array
   563|     {
   564|         $payload = [
   565|             'transactionType' => 'Payment',
   566|             'paymentMethod' => [
   567|                 'card' => [
   568|                     'merchantSessionKey' => $opayoSessionKey,
   569|                     'cardIdentifier' => $opayoTokenId,
   570|                 ],
   571|             ],
   572|             'vendorTxCode' => App::parseEnv($this->vendorName) . '-' . $submission->id . '-' . StringHelper::randomString(12),
   573|             'amount' => $amount,
   574|             'currency' => $currency,
   575|             'description' => $submission->id,
   576|             'apply3DSecure' => 'UseMSPSetting',
   577|             'strongCustomerAuthentication' => $this->_getRequestDetail(),
   578|         ];
   579|         $billingName = $this->getFieldSetting('billingDetails.billingName');
   580|         $billingAddress = $this->getFieldSetting('billingDetails.billingAddress');
   581|         $billingEmail = $this->getFieldSetting('billingDetails.billingEmail');
   582|         if ($billingEmail) {
   583|             $integrationField = new IntegrationField();
   584|             $integrationField->type = IntegrationField::TYPE_STRING;
   585|             $email = $this->getMappedFieldValue($billingEmail, $submission, $integrationField);
   586|             if (filter_var($email, FILTER_VALIDATE_EMAIL)) {
   587|                 $payload['customerEMail'] = $email;
   588|             } else {
   589|                 $payload['customerEMail'] = 'customer@example.com';
   590|             }
   591|         } else {
   592|             $payload['customerEMail'] = 'customer@example.com';
   593|         }
   594|         if ($billingName) {
   595|             $integrationField = new IntegrationField();
   596|             $integrationField->type = IntegrationField::TYPE_ARRAY;
   597|             $fullName = $this->getMappedFieldValue($billingName, $submission, $integrationField);
   598|         } else {
   599|             $fullName = ['firstName' => 'Customer', 'lastName' => 'Name'];
   600|         }
   601|         $payload['customerFirstName'] = ArrayHelper::remove($fullName, 'firstName');
   602|         $payload['customerLastName'] = ArrayHelper::remove($fullName, 'lastName');
   603|         if ($billingAddress) {
   604|             $integrationField = new IntegrationField();
   605|             $integrationField->type = IntegrationField::TYPE_ARRAY;
   606|             $address = $this->getMappedFieldValue($billingAddress, $submission, $integrationField);
   607|         } else {
   608|             $address = [
   609|                 'address1' => '407 St. John Street',
   610|                 'city' => 'London',
   611|                 'zip' => 'EC1V 4AB',
   612|                 'country' => 'GB',
   613|             ];
   614|         }
   615|         $payload['billingAddress']['address1'] = ArrayHelper::remove($address, 'address1');
   616|         $payload['billingAddress']['city'] = ArrayHelper::remove($address, 'city');
   617|         $payload['billingAddress']['postalCode'] = ArrayHelper::remove($address, 'zip');
   618|         $payload['billingAddress']['state'] = ArrayHelper::remove($address, 'state');
   619|         $payload['billingAddress']['country'] = ArrayHelper::remove($address, 'country');
   620|         $payload['billingAddress']['address1'] = substr($payload['billingAddress']['address1'], 0, 20);
   621|         $payload['billingAddress']['city'] = substr($payload['billingAddress']['city'], 0, 20);
   622|         $payload['billingAddress']['postalCode'] = substr($payload['billingAddress']['postalCode'], 0, 8);
   623|         if ($payload['billingAddress']['country'] && strlen($payload['billingAddress']['country']) > 3) {
   624|             $countryRepository = new CountryRepository();
   625|             foreach ($countryRepository->getAll() as $country) {
   626|                 if ($country->getName() === $payload['billingAddress']['country']) {
   627|                     $payload['billingAddress']['country'] = $country->getCountryCode();
   628|                 }
   629|             }
   630|         }
   631|         if ($payload['billingAddress']['state'] && strlen($payload['billingAddress']['state']) > 3) {
   632|             $subdivisionRepository = new SubdivisionRepository();
   633|             $states = $subdivisionRepository->getAll([$payload['billingAddress']['country']]);
   634|             foreach ($states as $state) {
   635|                 if ($state->getName() === $payload['billingAddress']['state']) {
   636|                     $payload['billingAddress']['state'] = $state->getCode();
   637|                 }
   638|             }
   639|         }
   640|         if ($payload['billingAddress']['country'] !== 'US') {
   641|             unset($payload['billingAddress']['state']);
   642|         }
   643|         return $payload;
   644|     }
   645|     private function _getRequestDetail(): array
   646|     {
   647|         return [
   648|             'website' => Craft::$app->getRequest()->getOrigin(),
   649|             'notificationURL' => $this->getReturnUrl(),
   650|             'browserIP' => Craft::$app->getRequest()->getUserIP(),
   651|             'browserAcceptHeader' => Craft::$app->getRequest()->getHeaders()->get('accept'),
   652|             'browserJavascriptEnabled' => false,
   653|             'browserJavaEnabled' => false,
   654|             'browserLanguage' => Craft::$app->language,
   655|             'browserColorDepth' => '16',
   656|             'browserScreenHeight' => '768',
   657|             'browserScreenWidth' => '1200',
   658|             'browserTZ' => '+300',
   659|             'browserUserAgent' => Craft::$app->getRequest()->getUserAgent(),
   660|             'challengeWindowSize' => 'Small',
   661|             'threeDSRequestorChallengeInd' => '02',
   662|             'requestSCAExemption' => false,
   663|             'transType' => 'GoodsAndServicePurchase',
   664|             'threeDSRequestorDecReqInd' => 'N',
   665|         ];
   666|     }
   667| }


# ====================================================================
# FILE: src/jobs/ImportForm.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-31 ---
     1| <?php
     2| namespace verbb\formie\jobs;
     3| use craft\queue\BaseJob;
     4| use craft\helpers\Json;
     5| use verbb\formie\helpers\ImportExportHelper;
     6| use Exception;
     7| class ImportForm extends BaseJob
     8| {
     9|     public ?string $fileLocation = null;
    10|     public ?string $formAction = 'update';
    11|     public function execute($queue): void
    12|     {
    13|         $this->setProgress($queue, 0.33);
    14|         if (!$this->fileLocation) {
    15|             throw new Exception("No file provided.");
    16|         }
    17|         $json = Json::decode(file_get_contents($this->fileLocation));
    18|         $form = ImportExportHelper::importFormFromJson($json, $this->formAction);
    19|         $this->setProgress($queue, 0.66);
    20|         if ($form->getConsolidatedErrors()) {
    21|             $errors = Json::encode($form->getConsolidatedErrors());
    22|             throw new Exception("Unable to import form {$this->fileLocation}" . PHP_EOL . "Errors: {$errors}.");
    23|         }
    24|         $this->setProgress($queue, 1);
    25|     }
    26|     protected function defaultDescription(): string
    27|     {
    28|         $fileName = basename($this->fileLocation);
    29|         return "Import of JSON '$fileName'.";
    30|     }
    31| }


# ====================================================================
# FILE: src/migrations/Install.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-549 ---
     1| <?php
     2| namespace verbb\formie\migrations;
     3| use verbb\formie\Formie;
     4| use verbb\formie\elements\Form;
     5| use verbb\formie\elements\Submission;
     6| use verbb\formie\elements\SentNotification;
     7| use verbb\formie\helpers\Table;
     8| use verbb\formie\models\Status;
     9| use verbb\formie\models\Stencil;
    10| use verbb\formie\models\StencilData;
    11| use verbb\formie\services\Statuses;
    12| use verbb\formie\services\Stencils;
    13| use Craft;
    14| use craft\db\Migration;
    15| use craft\helpers\Json;
    16| use craft\helpers\MigrationHelper;
    17| use verbb\auth\Auth;
    18| class Install extends Migration
    19| {
    20|     public function safeUp(): bool
    21|     {
    22|         Auth::getInstance()->migrator->up();
    23|         $this->createTables();
    24|         $this->createIndexes();
    25|         $this->addForeignKeys();
    26|         $this->insertDefaultData();
    27|         return true;
    28|     }
    29|     public function safeDown(): bool
    30|     {
    31|         $this->dropProjectConfig();
    32|         $this->dropForeignKeys();
    33|         $this->removeTables();
    34|         $this->removeContent();
    35|         Auth::getInstance()->getTokens()->deleteTokensByOwner('formie');
    36|         return true;
    37|     }
    38|     public function createTables(): void
    39|     {
    40|         $this->archiveTableIfExists(Table::FORMIE_EMAIL_TEMPLATES);
    41|         $this->createTable(Table::FORMIE_EMAIL_TEMPLATES, [
    42|             'id' => $this->primaryKey(),
    43|             'name' => $this->string()->notNull(),
    44|             'handle' => $this->string(64)->notNull(),
    45|             'template' => $this->string()->notNull(),
    46|             'sortOrder' => $this->smallInteger()->unsigned(),
    47|             'dateDeleted' => $this->dateTime(),
    48|             'dateCreated' => $this->dateTime()->notNull(),
    49|             'dateUpdated' => $this->dateTime()->notNull(),
    50|             'uid' => $this->uid(),
    51|         ]);
    52|         $this->archiveTableIfExists(Table::FORMIE_FIELD_LAYOUT_PAGES);
    53|         $this->createTable(Table::FORMIE_FIELD_LAYOUT_PAGES, [
    54|             'id' => $this->primaryKey(),
    55|             'layoutId' => $this->integer()->notNull(),
    56|             'label' => $this->text()->notNull(),
    57|             'sortOrder' => $this->smallInteger()->unsigned(),
    58|             'settings' => $this->text(),
    59|             'dateCreated' => $this->dateTime()->notNull(),
    60|             'dateUpdated' => $this->dateTime()->notNull(),
    61|             'uid' => $this->uid(),
    62|         ]);
    63|         $this->archiveTableIfExists(Table::FORMIE_FIELD_LAYOUT_ROWS);
    64|         $this->createTable(Table::FORMIE_FIELD_LAYOUT_ROWS, [
    65|             'id' => $this->primaryKey(),
    66|             'layoutId' => $this->integer()->notNull(),
    67|             'pageId' => $this->integer()->notNull(),
    68|             'sortOrder' => $this->smallInteger()->unsigned(),
    69|             'dateCreated' => $this->dateTime()->notNull(),
    70|             'dateUpdated' => $this->dateTime()->notNull(),
    71|             'uid' => $this->uid(),
    72|         ]);
    73|         $this->archiveTableIfExists(Table::FORMIE_FIELD_LAYOUTS);
    74|         $this->createTable(Table::FORMIE_FIELD_LAYOUTS, [
    75|             'id' => $this->primaryKey(),
    76|             'dateCreated' => $this->dateTime()->notNull(),
    77|             'dateUpdated' => $this->dateTime()->notNull(),
    78|             'uid' => $this->uid(),
    79|         ]);
    80|         $this->archiveTableIfExists(Table::FORMIE_FIELDS);
    81|         $this->createTable(Table::FORMIE_FIELDS, [
    82|             'id' => $this->primaryKey(),
    83|             'layoutId' => $this->integer()->notNull(),
    84|             'pageId' => $this->integer()->notNull(),
    85|             'rowId' => $this->integer()->notNull(),
    86|             'syncId' => $this->integer(),
    87|             'label' => $this->text()->notNull(),
    88|             'handle' => $this->string(64)->notNull(),
    89|             'type' => $this->string()->notNull(),
    90|             'sortOrder' => $this->smallInteger()->unsigned(),
    91|             'settings' => $this->mediumText(),
    92|             'dateCreated' => $this->dateTime()->notNull(),
    93|             'dateUpdated' => $this->dateTime()->notNull(),
    94|             'uid' => $this->uid(),
    95|         ]);
    96|         $this->archiveTableIfExists(Table::FORMIE_FORMS);
    97|         $this->createTable(Table::FORMIE_FORMS, [
    98|             'id' => $this->primaryKey(),
    99|             'handle' => $this->string(64)->notNull(),
   100|             'settings' => $this->mediumText(),
   101|             'layoutId' => $this->integer(),
   102|             'templateId' => $this->integer(),
   103|             'submitActionEntryId' => $this->integer(),
   104|             'submitActionEntrySiteId' => $this->integer(),
   105|             'defaultStatusId' => $this->integer(),
   106|             'dataRetention' => $this->enum('dataRetention', ['forever', 'minutes', 'hours', 'days', 'weeks', 'months', 'years'])
   107|                 ->defaultValue('forever')
   108|                 ->notNull(),
   109|             'dataRetentionValue' => $this->integer(),
   110|             'userDeletedAction' => $this->enum('userDeletedAction', ['retain', 'delete'])
   111|                 ->defaultValue('retain')
   112|                 ->notNull(),
   113|             'fileUploadsAction' => $this->enum('fileUploadsAction', ['retain', 'delete'])
   114|                 ->defaultValue('retain')
   115|                 ->notNull(),
   116|             'dateCreated' => $this->dateTime()->notNull(),
   117|             'dateUpdated' => $this->dateTime()->notNull(),
   118|             'uid' => $this->uid(),
   119|         ]);
   120|         $this->archiveTableIfExists(Table::FORMIE_FORM_TEMPLATES);
   121|         $this->createTable(Table::FORMIE_FORM_TEMPLATES, [
   122|             'id' => $this->primaryKey(),
   123|             'name' => $this->string()->notNull(),
   124|             'handle' => $this->string(64)->notNull(),
   125|             'template' => $this->string(),
   126|             'useCustomTemplates' => $this->boolean()->defaultValue(true),
   127|             'outputCssLayout' => $this->boolean()->defaultValue(true),
   128|             'outputCssTheme' => $this->boolean()->defaultValue(true),
   129|             'outputJsBase' => $this->boolean()->defaultValue(true),
   130|             'outputJsTheme' => $this->boolean()->defaultValue(true),
   131|             'outputCssLocation' => $this->string(),
   132|             'outputJsLocation' => $this->string(),
   133|             'sortOrder' => $this->smallInteger()->unsigned(),
   134|             'fieldLayoutId' => $this->integer(),
   135|             'dateDeleted' => $this->dateTime(),
   136|             'dateCreated' => $this->dateTime()->notNull(),
   137|             'dateUpdated' => $this->dateTime()->notNull(),
   138|             'uid' => $this->uid(),
   139|         ]);
   140|         $this->archiveTableIfExists(Table::FORMIE_INTEGRATIONS);
   141|         $this->createTable(Table::FORMIE_INTEGRATIONS, [
   142|             'id' => $this->primaryKey(),
   143|             'name' => $this->string()->notNull(),
   144|             'handle' => $this->string(64)->notNull(),
   145|             'type' => $this->string()->notNull(),
   146|             'sortOrder' => $this->smallInteger()->unsigned(),
   147|             'enabled' => $this->string()->notNull()->defaultValue('true'),
   148|             'settings' => $this->mediumText(),
   149|             'cache' => $this->longText(),
   150|             'dateDeleted' => $this->dateTime(),
   151|             'dateCreated' => $this->dateTime()->notNull(),
   152|             'dateUpdated' => $this->dateTime()->notNull(),
   153|             'uid' => $this->uid(),
   154|         ]);
   155|         $this->archiveTableIfExists(Table::FORMIE_NOTIFICATIONS);
   156|         $this->createTable(Table::FORMIE_NOTIFICATIONS, [
   157|             'id' => $this->primaryKey(),
   158|             'formId' => $this->integer()->notNull(),
   159|             'templateId' => $this->integer(),
   160|             'pdfTemplateId' => $this->integer(),
   161|             'name' => $this->text()->notNull(),
   162|             'handle' => $this->string(64)->notNull(),
   163|             'enabled' => $this->boolean()->defaultValue(true),
   164|             'subject' => $this->text(),
   165|             'recipients' => $this->enum('recipients', ['email', 'conditions'])
   166|                 ->defaultValue('email')
   167|                 ->notNull(),
   168|             'to' => $this->text(),
   169|             'toConditions' => $this->text(),
   170|             'cc' => $this->text(),
   171|             'bcc' => $this->text(),
   172|             'replyTo' => $this->text(),
   173|             'replyToName' => $this->text(),
   174|             'from' => $this->text(),
   175|             'fromName' => $this->text(),
   176|             'sender' => $this->text(),
   177|             'content' => $this->text(),
   178|             'attachFiles' => $this->boolean()->defaultValue(true),
   179|             'attachPdf' => $this->boolean()->defaultValue(false),
   180|             'attachAssets' => $this->text(),
   181|             'enableConditions' => $this->boolean()->defaultValue(false),
   182|             'conditions' => $this->text(),
   183|             'customSettings' => $this->text(),
   184|             'dateCreated' => $this->dateTime()->notNull(),
   185|             'dateUpdated' => $this->dateTime()->notNull(),
   186|             'uid' => $this->uid(),
   187|         ]);
   188|         $this->archiveTableIfExists(Table::FORMIE_PAYMENTS);
   189|         $this->createTable(Table::FORMIE_PAYMENTS, [
   190|             'id' => $this->primaryKey(),
   191|             'integrationId' => $this->integer()->notNull(),
   192|             'submissionId' => $this->integer()->notNull(),
   193|             'fieldId' => $this->integer()->notNull(),
   194|             'subscriptionId' => $this->integer(),
   195|             'amount' => $this->decimal(14, 4),
   196|             'currency' => $this->string(),
   197|             'status' => $this->enum('status', ['pending', 'redirect', 'success', 'failed', 'processing'])->notNull(),
   198|             'reference' => $this->string(),
   199|             'code' => $this->string(),
   200|             'message' => $this->text(),
   201|             'note' => $this->mediumText(),
   202|             'response' => $this->text(),
   203|             'dateCreated' => $this->dateTime()->notNull(),
   204|             'dateUpdated' => $this->dateTime()->notNull(),
   205|             'uid' => $this->uid(),
   206|         ]);
   207|         $this->archiveTableIfExists(Table::FORMIE_PAYMENT_PLANS);
   208|         $this->createTable(Table::FORMIE_PAYMENT_PLANS, [
   209|             'id' => $this->primaryKey(),
   210|             'integrationId' => $this->integer()->notNull(),
   211|             'name' => $this->string(),
   212|             'handle' => $this->string(),
   213|             'reference' => $this->string()->notNull(),
   214|             'enabled' => $this->boolean()->notNull(),
   215|             'planData' => $this->text(),
   216|             'isArchived' => $this->boolean()->notNull(),
   217|             'dateArchived' => $this->dateTime(),
   218|             'sortOrder' => $this->integer(),
   219|             'dateCreated' => $this->dateTime()->notNull(),
   220|             'dateUpdated' => $this->dateTime()->notNull(),
   221|             'uid' => $this->uid(),
   222|         ]);
   223|         $this->archiveTableIfExists(Table::FORMIE_SUBSCRIPTIONS);
   224|         $this->createTable(Table::FORMIE_SUBSCRIPTIONS, [
   225|             'id' => $this->primaryKey(),
   226|             'integrationId' => $this->integer(),
   227|             'submissionId' => $this->integer(),
   228|             'fieldId' => $this->integer(),
   229|             'planId' => $this->integer(),
   230|             'reference' => $this->string()->notNull(),
   231|             'subscriptionData' => $this->text(),
   232|             'trialDays' => $this->integer()->notNull(),
   233|             'nextPaymentDate' => $this->dateTime(),
   234|             'hasStarted' => $this->boolean()->notNull()->defaultValue(true),
   235|             'isSuspended' => $this->boolean()->notNull()->defaultValue(false),
   236|             'dateSuspended' => $this->dateTime(),
   237|             'isCanceled' => $this->boolean()->notNull(),
   238|             'dateCanceled' => $this->dateTime(),
   239|             'isExpired' => $this->boolean()->notNull(),
   240|             'dateExpired' => $this->dateTime(),
   241|             'dateCreated' => $this->dateTime()->notNull(),
   242|             'dateUpdated' => $this->dateTime()->notNull(),
   243|             'uid' => $this->uid(),
   244|         ]);
   245|         $this->archiveTableIfExists(Table::FORMIE_PDF_TEMPLATES);
   246|         $this->createTable(Table::FORMIE_PDF_TEMPLATES, [
   247|             'id' => $this->primaryKey(),
   248|             'name' => $this->string()->notNull(),
   249|             'handle' => $this->string(64)->notNull(),
   250|             'template' => $this->string()->notNull(),
   251|             'filenameFormat' => $this->string()->notNull(),
   252|             'sortOrder' => $this->smallInteger()->unsigned(),
   253|             'dateDeleted' => $this->dateTime(),
   254|             'dateCreated' => $this->dateTime()->notNull(),
   255|             'dateUpdated' => $this->dateTime()->notNull(),
   256|             'uid' => $this->uid(),
   257|         ]);
   258|         $this->archiveTableIfExists(Table::FORMIE_RELATIONS);
   259|         $this->createTable(Table::FORMIE_RELATIONS, [
   260|             'id' => $this->primaryKey(),
   261|             'type' => $this->string(255)->notNull(),
   262|             'sourceId' => $this->integer()->notNull(),
   263|             'sourceSiteId' => $this->integer(),
   264|             'targetId' => $this->integer()->notNull(),
   265|             'dateCreated' => $this->dateTime()->notNull(),
   266|             'dateUpdated' => $this->dateTime()->notNull(),
   267|             'uid' => $this->uid(),
   268|         ]);
   269|         $this->archiveTableIfExists(Table::FORMIE_SENT_NOTIFICATIONS);
   270|         $this->createTable(Table::FORMIE_SENT_NOTIFICATIONS, [
   271|             'id' => $this->primaryKey(),
   272|             'title' => $this->string(),
   273|             'formId' => $this->integer(),
   274|             'submissionId' => $this->integer(),
   275|             'notificationId' => $this->integer(),
   276|             'subject' => $this->text(),
   277|             'to' => $this->text(),
   278|             'cc' => $this->text(),
   279|             'bcc' => $this->text(),
   280|             'replyTo' => $this->text(),
   281|             'replyToName' => $this->text(),
   282|             'from' => $this->text(),
   283|             'fromName' => $this->text(),
   284|             'sender' => $this->text(),
   285|             'body' => $this->mediumText(),
   286|             'htmlBody' => $this->mediumText(),
   287|             'info' => $this->text(),
   288|             'success' => $this->boolean(),
   289|             'message' => $this->text(),
   290|             'dateCreated' => $this->dateTime(),
   291|             'dateUpdated' => $this->dateTime(),
   292|             'uid' => $this->uid(),
   293|         ]);
   294|         $this->archiveTableIfExists(Table::FORMIE_STATUSES);
   295|         $this->createTable(Table::FORMIE_STATUSES, [
   296|             'id' => $this->primaryKey(),
   297|             'name' => $this->string()->notNull(),
   298|             'handle' => $this->string(64)->notNull(),
   299|             'color' => $this->enum('color', ['green', 'orange', 'red', 'blue', 'yellow', 'pink', 'purple', 'turquoise', 'light', 'grey', 'black'])
   300|                 ->defaultValue('green')
   301|                 ->notNull(),
   302|             'description' => $this->string(),
   303|             'sortOrder' => $this->smallInteger()->unsigned(),
   304|             'isDefault' => $this->boolean(),
   305|             'dateDeleted' => $this->dateTime(),
   306|             'dateCreated' => $this->dateTime()->notNull(),
   307|             'dateUpdated' => $this->dateTime()->notNull(),
   308|             'uid' => $this->uid(),
   309|         ]);
   310|         $this->archiveTableIfExists(Table::FORMIE_STENCILS);
   311|         $this->createTable(Table::FORMIE_STENCILS, [
   312|             'id' => $this->primaryKey(),
   313|             'name' => $this->string()->notNull(),
   314|             'handle' => $this->string(64)->notNull(),
   315|             'data' => $this->mediumText(),
   316|             'templateId' => $this->integer(),
   317|             'submitActionEntryId' => $this->integer(),
   318|             'submitActionEntrySiteId' => $this->integer(),
   319|             'defaultStatusId' => $this->integer(),
   320|             'dateDeleted' => $this->dateTime(),
   321|             'dateCreated' => $this->dateTime()->notNull(),
   322|             'dateUpdated' => $this->dateTime()->notNull(),
   323|             'uid' => $this->uid(),
   324|         ]);
   325|         $this->archiveTableIfExists(Table::FORMIE_SUBMISSIONS);
   326|         $this->createTable(Table::FORMIE_SUBMISSIONS, [
   327|             'id' => $this->primaryKey(),
   328|             'content' => $this->json(),
   329|             'formId' => $this->integer()->notNull(),
   330|             'statusId' => $this->integer(),
   331|             'userId' => $this->integer(),
   332|             'isIncomplete' => $this->boolean()->defaultValue(false),
   333|             'isSpam' => $this->boolean()->defaultValue(false),
   334|             'spamReason' => $this->text(),
   335|             'spamClass' => $this->string(),
   336|             'snapshot' => $this->text(),
   337|             'ipAddress' => $this->string(),
   338|             'dateCreated' => $this->dateTime()->notNull(),
   339|             'dateUpdated' => $this->dateTime()->notNull(),
   340|             'uid' => $this->uid(),
   341|         ]);
   342|     }
   343|     public function createIndexes(): void
   344|     {
   345|         $this->createIndex(null, Table::FORMIE_FIELD_LAYOUT_PAGES, 'layoutId', false);
   346|         $this->createIndex(null, Table::FORMIE_FIELD_LAYOUT_ROWS, 'layoutId', false);
   347|         $this->createIndex(null, Table::FORMIE_FIELD_LAYOUT_ROWS, 'pageId', false);
   348|         $this->createIndex(null, Table::FORMIE_FIELDS, 'layoutId', false);
   349|         $this->createIndex(null, Table::FORMIE_FIELDS, 'pageId', false);
   350|         $this->createIndex(null, Table::FORMIE_FIELDS, 'rowId', false);
   351|         $this->createIndex(null, Table::FORMIE_FIELDS, 'syncId', false);
   352|         $this->createIndex(null, Table::FORMIE_FIELDS, 'handle', false);
   353|         $this->createIndex(null, Table::FORMIE_FORMS, 'layoutId', false);
   354|         $this->createIndex(null, Table::FORMIE_FORMS, 'templateId', false);
   355|         $this->createIndex(null, Table::FORMIE_FORMS, 'defaultStatusId', false);
   356|         $this->createIndex(null, Table::FORMIE_FORMS, 'submitActionEntryId', false);
   357|         $this->createIndex(null, Table::FORMIE_FORMS, 'submitActionEntrySiteId', false);
   358|         $this->createIndex(null, Table::FORMIE_FORM_TEMPLATES, 'fieldLayoutId', false);
   359|         $this->createIndex(null, Table::FORMIE_NOTIFICATIONS, 'formId', false);
   360|         $this->createIndex(null, Table::FORMIE_NOTIFICATIONS, 'templateId', false);
   361|         $this->createIndex(null, Table::FORMIE_PAYMENTS, 'integrationId', false);
   362|         $this->createIndex(null, Table::FORMIE_PAYMENTS, 'fieldId', false);
   363|         $this->createIndex(null, Table::FORMIE_PAYMENTS, 'reference', false);
   364|         $this->createIndex(null, Table::FORMIE_PAYMENT_PLANS, 'integrationId', false);
   365|         $this->createIndex(null, Table::FORMIE_PAYMENT_PLANS, 'handle', true);
   366|         $this->createIndex(null, Table::FORMIE_PAYMENT_PLANS, 'reference', false);
   367|         $this->createIndex(null, Table::FORMIE_SUBSCRIPTIONS, 'integrationId', false);
   368|         $this->createIndex(null, Table::FORMIE_SUBSCRIPTIONS, 'submissionId', false);
   369|         $this->createIndex(null, Table::FORMIE_SUBSCRIPTIONS, 'fieldId', false);
   370|         $this->createIndex(null, Table::FORMIE_SUBSCRIPTIONS, 'planId', false);
   371|         $this->createIndex(null, Table::FORMIE_SUBSCRIPTIONS, 'reference', false);
   372|         $this->createIndex(null, Table::FORMIE_SUBSCRIPTIONS, 'nextPaymentDate', false);
   373|         $this->createIndex(null, Table::FORMIE_SUBSCRIPTIONS, 'dateExpired', false);
   374|         $this->createIndex(null, Table::FORMIE_SUBSCRIPTIONS, 'dateExpired', false);
   375|         $this->createIndex(null, Table::FORMIE_RELATIONS, ['sourceId', 'sourceSiteId', 'targetId'], true);
   376|         $this->createIndex(null, Table::FORMIE_RELATIONS, ['sourceId'], false);
   377|         $this->createIndex(null, Table::FORMIE_RELATIONS, ['targetId'], false);
   378|         $this->createIndex(null, Table::FORMIE_RELATIONS, ['sourceSiteId'], false);
   379|         $this->createIndex(null, Table::FORMIE_STENCILS, 'templateId', false);
   380|         $this->createIndex(null, Table::FORMIE_STENCILS, 'defaultStatusId', false);
   381|         $this->createIndex(null, Table::FORMIE_SUBMISSIONS, 'formId', false);
   382|         $this->createIndex(null, Table::FORMIE_SUBMISSIONS, 'statusId', false);
   383|         $this->createIndex(null, Table::FORMIE_SUBMISSIONS, 'userId', false);
   384|     }
   385|     public function addForeignKeys(): void
   386|     {
   387|         $this->addForeignKey(null, Table::FORMIE_FIELD_LAYOUT_PAGES, ['layoutId'], Table::FORMIE_FIELD_LAYOUTS, ['id'], 'CASCADE', null);
   388|         $this->addForeignKey(null, Table::FORMIE_FIELD_LAYOUT_ROWS, ['layoutId'], Table::FORMIE_FIELD_LAYOUTS, ['id'], 'CASCADE', null);
   389|         $this->addForeignKey(null, Table::FORMIE_FIELD_LAYOUT_ROWS, ['pageId'], Table::FORMIE_FIELD_LAYOUT_PAGES, ['id'], 'CASCADE', null);
   390|         $this->addForeignKey(null, Table::FORMIE_FIELDS, ['layoutId'], Table::FORMIE_FIELD_LAYOUTS, ['id'], 'CASCADE', null);
   391|         $this->addForeignKey(null, Table::FORMIE_FIELDS, ['pageId'], Table::FORMIE_FIELD_LAYOUT_PAGES, ['id'], 'CASCADE', null);
   392|         $this->addForeignKey(null, Table::FORMIE_FIELDS, ['rowId'], Table::FORMIE_FIELD_LAYOUT_ROWS, ['id'], 'CASCADE', null);
   393|         $this->addForeignKey(null, Table::FORMIE_FIELDS, ['syncId'], Table::FORMIE_FIELDS, ['id'], 'SET NULL', null);
   394|         $this->addForeignKey(null, Table::FORMIE_FORMS, ['id'], '{{%elements}}', ['id'], 'CASCADE', null);
   395|         $this->addForeignKey(null, Table::FORMIE_FORMS, ['layoutId'], Table::FORMIE_FIELD_LAYOUTS, ['id'], 'SET NULL', null);
   396|         $this->addForeignKey(null, Table::FORMIE_FORMS, ['templateId'], Table::FORMIE_FORM_TEMPLATES, ['id'], 'SET NULL', null);
   397|         $this->addForeignKey(null, Table::FORMIE_FORMS, ['defaultStatusId'], Table::FORMIE_STATUSES, ['id'], 'SET NULL', null);
   398|         $this->addForeignKey(null, Table::FORMIE_FORMS, ['submitActionEntryId'], '{{%entries}}', ['id'], 'SET NULL', null);
   399|         $this->addForeignKey(null, Table::FORMIE_FORM_TEMPLATES, ['fieldLayoutId'], '{{%fieldlayouts}}', ['id'], 'CASCADE', null);
   400|         $this->addForeignKey(null, Table::FORMIE_NOTIFICATIONS, ['formId'], Table::FORMIE_FORMS, ['id'], 'CASCADE', null);
   401|         $this->addForeignKey(null, Table::FORMIE_NOTIFICATIONS, ['templateId'], Table::FORMIE_EMAIL_TEMPLATES, ['id'], 'SET NULL', null);
   402|         $this->addForeignKey(null, Table::FORMIE_NOTIFICATIONS, ['pdfTemplateId'], Table::FORMIE_PDF_TEMPLATES, ['id'], 'SET NULL', null);
   403|         $this->addForeignKey(null, Table::FORMIE_PAYMENTS, ['submissionId'], Table::FORMIE_SUBMISSIONS, ['id'], 'CASCADE', null);
   404|         $this->addForeignKey(null, Table::FORMIE_PAYMENTS, ['subscriptionId'], Table::FORMIE_SUBSCRIPTIONS, ['id'], 'CASCADE', null);
   405|         $this->addForeignKey(null, Table::FORMIE_PAYMENTS, ['fieldId'], Table::FORMIE_FIELDS, ['id'], 'CASCADE', null);
   406|         $this->addForeignKey(null, Table::FORMIE_PAYMENTS, ['integrationId'], Table::FORMIE_INTEGRATIONS, ['id'], 'CASCADE', null);
   407|         $this->addForeignKey(null, Table::FORMIE_PAYMENT_PLANS, ['integrationId'], Table::FORMIE_INTEGRATIONS, ['id'], 'CASCADE', null);
   408|         $this->addForeignKey(null, Table::FORMIE_SUBSCRIPTIONS, ['integrationId'], Table::FORMIE_INTEGRATIONS, ['id'], 'RESTRICT', null);
   409|         $this->addForeignKey(null, Table::FORMIE_SUBSCRIPTIONS, ['submissionId'], Table::FORMIE_SUBMISSIONS, ['id'], 'RESTRICT', null);
   410|         $this->addForeignKey(null, Table::FORMIE_SUBSCRIPTIONS, ['fieldId'], Table::FORMIE_FIELDS, ['id'], 'RESTRICT', null);
   411|         $this->addForeignKey(null, Table::FORMIE_SUBSCRIPTIONS, ['planId'], Table::FORMIE_PAYMENT_PLANS, ['id'], 'RESTRICT', null);
   412|         $this->addForeignKey(null, Table::FORMIE_RELATIONS, ['sourceId'], '{{%elements}}', ['id'], 'CASCADE', null);
   413|         $this->addForeignKey(null, Table::FORMIE_RELATIONS, ['sourceSiteId'], '{{%sites}}', ['id'], 'CASCADE', 'CASCADE');
   414|         $this->addForeignKey(null, Table::FORMIE_RELATIONS, ['targetId'], '{{%elements}}', ['id'], 'CASCADE', null);
   415|         $this->addForeignKey(null, Table::FORMIE_SENT_NOTIFICATIONS, ['id'], '{{%elements}}', ['id'], 'CASCADE', null);
   416|         $this->addForeignKey(null, Table::FORMIE_SENT_NOTIFICATIONS, ['formId'], Table::FORMIE_FORMS, ['id'], 'SET NULL', null);
   417|         $this->addForeignKey(null, Table::FORMIE_SENT_NOTIFICATIONS, ['submissionId'], Table::FORMIE_SUBMISSIONS, ['id'], 'SET NULL', null);
   418|         $this->addForeignKey(null, Table::FORMIE_SENT_NOTIFICATIONS, ['notificationId'], Table::FORMIE_NOTIFICATIONS, ['id'], 'SET NULL', null);
   419|         $this->addForeignKey(null, Table::FORMIE_STENCILS, ['templateId'], Table::FORMIE_FORM_TEMPLATES, ['id'], 'SET NULL', null);
   420|         $this->addForeignKey(null, Table::FORMIE_STENCILS, ['defaultStatusId'], Table::FORMIE_STATUSES, ['id'], 'SET NULL', null);
   421|         $this->addForeignKey(null, Table::FORMIE_SUBMISSIONS, ['id'], '{{%elements}}', ['id'], 'CASCADE', null);
   422|         $this->addForeignKey(null, Table::FORMIE_SUBMISSIONS, ['formId'], Table::FORMIE_FORMS, ['id'], 'CASCADE', null);
   423|         $this->addForeignKey(null, Table::FORMIE_SUBMISSIONS, ['statusId'], Table::FORMIE_STATUSES, ['id'], 'SET NULL', null);
   424|         $this->addForeignKey(null, Table::FORMIE_SUBMISSIONS, ['userId'], '{{%users}}', ['id'], 'SET NULL', null);
   425|     }
   426|     public function removeTables(): void
   427|     {
   428|         $tables = [
   429|             'formie_emailtemplates',
   430|             'formie_fieldlayout_pages',
   431|             'formie_fieldlayout_rows',
   432|             'formie_fieldlayouts',
   433|             'formie_fields',
   434|             'formie_forms',
   435|             'formie_formtemplates',
   436|             'formie_integrations',
   437|             'formie_notifications',
   438|             'formie_payments',
   439|             'formie_payments_plans',
   440|             'formie_payments_subscriptions',
   441|             'formie_pdftemplates',
   442|             'formie_relations',
   443|             'formie_sentnotifications',
   444|             'formie_statuses',
   445|             'formie_stencils',
   446|             'formie_submissions',
   447|         ];
   448|         foreach ($tables as $table) {
   449|             $this->dropTableIfExists('{{%' . $table . '}}');
   450|         }
   451|     }
   452|     public function removeContent(): void
   453|     {
   454|         $this->delete(Table::ELEMENTS, ['type' => SentNotification::class]);
   455|         $this->delete(Table::ELEMENTS, ['type' => Submission::class]);
   456|         $this->delete(Table::ELEMENTS, ['type' => Form::class]);
   457|     }
   458|     public function dropProjectConfig(): void
   459|     {
   460|         Craft::$app->getProjectConfig()->remove('formie');
   461|     }
   462|     public function insertDefaultData(): void
   463|     {
   464|         $projectConfig = Craft::$app->getProjectConfig();
   465|         $installed = ($projectConfig->get('plugins.formie', true) !== null);
   466|         $configExists = ($projectConfig->get('formie', true) !== null);
   467|         if (!$installed && !$configExists) {
   468|             $this->_defaultStatuses();
   469|             $this->_defaultStencils();
   470|         }
   471|         if (!$installed && $configExists) {
   472|             $allowAdminChanges = Craft::$app->getConfig()->getGeneral()->allowAdminChanges;
   473|             if (!$allowAdminChanges) {
   474|                 return;
   475|             }
   476|             $statuses = $projectConfig->get(Statuses::CONFIG_STATUSES_KEY, true) ?? [];
   477|             foreach ($statuses as $statusUid => $statusData) {
   478|                 $projectConfig->processConfigChanges(Statuses::CONFIG_STATUSES_KEY . '.' . $statusUid, true);
   479|             }
   480|             $stencils = $projectConfig->get(Stencils::CONFIG_STENCILS_KEY, true) ?? [];
   481|             foreach ($stencils as $stencilUid => $stencilData) {
   482|                 $projectConfig->processConfigChanges(Stencils::CONFIG_STENCILS_KEY . '.' . $stencilUid, true);
   483|             }
   484|         }
   485|     }
   486|     protected function dropForeignKeys(): void
   487|     {
   488|         $tables = [
   489|             'formie_emailtemplates',
   490|             'formie_fieldlayout_pages',
   491|             'formie_fieldlayout_rows',
   492|             'formie_fieldlayouts',
   493|             'formie_fields',
   494|             'formie_forms',
   495|             'formie_formtemplates',
   496|             'formie_integrations',
   497|             'formie_notifications',
   498|             'formie_payments',
   499|             'formie_payments_plans',
   500|             'formie_payments_subscriptions',
   501|             'formie_pdftemplates',
   502|             'formie_relations',
   503|             'formie_sentnotifications',
   504|             'formie_statuses',
   505|             'formie_stencils',
   506|             'formie_submissions',
   507|         ];
   508|         foreach ($tables as $table) {
   509|             if ($this->db->tableExists('{{%' . $table . '}}')) {
   510|                 MigrationHelper::dropAllForeignKeysOnTable('{{%' . $table . '}}', $this);
   511|                 MigrationHelper::dropAllForeignKeysToTable('{{%' . $table . '}}', $this);
   512|             }
   513|         }
   514|     }
   515|     private function _defaultStatuses(): void
   516|     {
   517|         $statuses = [
   518|             [
   519|                 'name' => 'New',
   520|                 'handle' => 'new',
   521|                 'color' => 'green',
   522|                 'sortOrder' => 1,
   523|                 'isDefault' => 1,
   524|             ],
   525|         ];
   526|         foreach ($statuses as $status) {
   527|             $orderStatus = new Status($status);
   528|             Formie::$plugin->getStatuses()->saveStatus($orderStatus);
   529|         }
   530|     }
   531|     private function _defaultStencils(): void
   532|     {
   533|         $stencils = [
   534|             [
   535|                 'name' => Craft::t('formie', 'Contact Form'),
   536|                 'handle' => 'contactForm',
   537|                 'file' => Craft::getAlias('@verbb/formie/migrations/stencils/contact-form.json'),
   538|             ],
   539|         ];
   540|         foreach ($stencils as $stencilInfo) {
   541|             $data = Json::decode(file_get_contents($stencilInfo['file']));
   542|             $stencil = new Stencil();
   543|             $stencil->name = $stencilInfo['name'];
   544|             $stencil->handle = $stencilInfo['handle'];
   545|             Formie::$plugin->getStencils()->saveStencil($stencil);
   546|             $this->update(Table::FORMIE_STENCILS, ['data' => Json::encode($data)], ['handle' => $stencilInfo['handle']]);
   547|         }
   548|     }
   549| }


# ====================================================================
# FILE: src/migrations/m231125_000000_craft5.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-1125 ---
     1| <?php
     2| namespace verbb\formie\migrations;
     3| use verbb\formie\Formie;
     4| use verbb\formie\fields;
     5| use verbb\formie\fields\Group;
     6| use verbb\formie\fields\Repeater;
     7| use verbb\formie\fields\subfields;
     8| use verbb\formie\helpers\StringHelper;
     9| use verbb\formie\helpers\Table;
    10| use verbb\formie\models\FieldLayout;
    11| use verbb\formie\positions\Hidden as HiddenPosition;
    12| use Craft;
    13| use craft\db\Migration;
    14| use craft\db\Query;
    15| use craft\helpers\App;
    16| use craft\helpers\ArrayHelper;
    17| use craft\helpers\Db;
    18| use craft\helpers\Json;
    19| use craft\helpers\MigrationHelper;
    20| use craft\migrations\BaseContentRefactorMigration;
    21| use Exception;
    22| use Throwable;
    23| class m231125_000000_craft5 extends BaseContentRefactorMigration
    24| {
    25|     protected bool $preserveOldData = true;
    26|     public function safeUp(): bool
    27|     {
    28|         App::maxPowerCaptain();
    29|         $this->_addNewLayoutTables();
    30|         $this->_updateFormTitles();
    31|         $this->_updateSubmissionTitles();
    32|         if (!$this->_addPopulateLayouts()) {
    33|             return false;
    34|         }
    35|         $this->_migrateTemplateFieldLayout();
    36|         $this->_migrateSubmissionContent();
    37|         $this->_migrateNestedContent();
    38|         $this->_migrateRelationFields();
    39|         $this->_migratePaymentFields();
    40|         $this->_updateSyncFields();
    41|         $this->_cleanupOldTables();
    42|         return true;
    43|     }
    44|     public function safeDown(): bool
    45|     {
    46|         echo "m231125_000000_craft5 cannot be reverted.\n";
    47|         return false;
    48|     }
    49|     private function _addNewLayoutTables(): void
    50|     {
    51|         if (!$this->db->tableExists(Table::FORMIE_FIELD_LAYOUTS)) {
    52|             $this->createTable(Table::FORMIE_FIELD_LAYOUTS, [
    53|                 'id' => $this->primaryKey(),
    54|                 'dateCreated' => $this->dateTime()->notNull(),
    55|                 'dateUpdated' => $this->dateTime()->notNull(),
    56|                 'uid' => $this->uid(),
    57|             ]);
    58|         }
    59|         if (!$this->db->tableExists(Table::FORMIE_FIELD_LAYOUT_PAGES)) {
    60|             $this->createTable(Table::FORMIE_FIELD_LAYOUT_PAGES, [
    61|                 'id' => $this->primaryKey(),
    62|                 'layoutId' => $this->integer()->notNull(),
    63|                 'label' => $this->text()->notNull(),
    64|                 'sortOrder' => $this->smallInteger()->unsigned(),
    65|                 'settings' => $this->text(),
    66|                 'dateCreated' => $this->dateTime()->notNull(),
    67|                 'dateUpdated' => $this->dateTime()->notNull(),
    68|                 'uid' => $this->uid(),
    69|             ]);
    70|         }
    71|         if (!$this->db->tableExists(Table::FORMIE_FIELD_LAYOUT_ROWS)) {
    72|             $this->createTable(Table::FORMIE_FIELD_LAYOUT_ROWS, [
    73|                 'id' => $this->primaryKey(),
    74|                 'layoutId' => $this->integer()->notNull(),
    75|                 'pageId' => $this->integer(),
    76|                 'sortOrder' => $this->smallInteger()->unsigned(),
    77|                 'dateCreated' => $this->dateTime()->notNull(),
    78|                 'dateUpdated' => $this->dateTime()->notNull(),
    79|                 'uid' => $this->uid(),
    80|             ]);
    81|         }
    82|         if (!$this->db->tableExists(Table::FORMIE_FIELDS)) {
    83|             $this->createTable(Table::FORMIE_FIELDS, [
    84|                 'id' => $this->primaryKey(),
    85|                 'layoutId' => $this->integer()->notNull(),
    86|                 'pageId' => $this->integer(),
    87|                 'rowId' => $this->integer()->notNull(),
    88|                 'syncId' => $this->integer(),
    89|                 'label' => $this->text()->notNull(),
    90|                 'handle' => $this->string(64)->notNull(),
    91|                 'type' => $this->string()->notNull(),
    92|                 'sortOrder' => $this->smallInteger()->unsigned(),
    93|                 'settings' => $this->mediumText(),
    94|                 'dateCreated' => $this->dateTime()->notNull(),
    95|                 'dateUpdated' => $this->dateTime()->notNull(),
    96|                 'uid' => $this->uid(),
    97|             ]);
    98|         }
    99|         if (!$this->db->columnExists(Table::FORMIE_FORMS, 'layoutId')) {
   100|             $this->addColumn(Table::FORMIE_FORMS, 'layoutId', $this->integer()->after('settings'));
   101|         }
   102|         if (!$this->db->columnExists(Table::FORMIE_SUBMISSIONS, 'content')) {
   103|             $this->addColumn(Table::FORMIE_SUBMISSIONS, 'content', $this->json()->after('id'));
   104|         }
   105|         MigrationHelper::dropAllForeignKeysOnTable(Table::FORMIE_FIELD_LAYOUT_PAGES, $this);
   106|         MigrationHelper::dropAllForeignKeysOnTable(Table::FORMIE_FIELD_LAYOUT_ROWS, $this);
   107|         MigrationHelper::dropAllForeignKeysOnTable(Table::FORMIE_FIELDS, $this);
   108|         MigrationHelper::dropAllIndexesOnTable(Table::FORMIE_FIELD_LAYOUT_PAGES, $this);
   109|         MigrationHelper::dropAllIndexesOnTable(Table::FORMIE_FIELD_LAYOUT_ROWS, $this);
   110|         MigrationHelper::dropAllIndexesOnTable(Table::FORMIE_FIELDS, $this);
   111|         $this->dropForeignKeyIfExists(Table::FORMIE_FORMS, ['layoutId']);
   112|         $this->dropIndexIfExists(Table::FORMIE_FORMS, ['layoutId']);
   113|         $this->createIndex(null, Table::FORMIE_FIELD_LAYOUT_PAGES, 'layoutId', false);
   114|         $this->createIndex(null, Table::FORMIE_FIELD_LAYOUT_ROWS, 'layoutId', false);
   115|         $this->createIndex(null, Table::FORMIE_FIELD_LAYOUT_ROWS, 'pageId', false);
   116|         $this->createIndex(null, Table::FORMIE_FIELDS, 'layoutId', false);
   117|         $this->createIndex(null, Table::FORMIE_FIELDS, 'pageId', false);
   118|         $this->createIndex(null, Table::FORMIE_FIELDS, 'rowId', false);
   119|         $this->createIndex(null, Table::FORMIE_FIELDS, 'handle', false);
   120|         $this->createIndex(null, Table::FORMIE_FIELDS, 'syncId', false);
   121|         $this->addForeignKey(null, Table::FORMIE_FIELD_LAYOUT_PAGES, ['layoutId'], Table::FORMIE_FIELD_LAYOUTS, ['id'], 'CASCADE', null);
   122|         $this->addForeignKey(null, Table::FORMIE_FIELD_LAYOUT_ROWS, ['layoutId'], Table::FORMIE_FIELD_LAYOUTS, ['id'], 'CASCADE', null);
   123|         $this->addForeignKey(null, Table::FORMIE_FIELD_LAYOUT_ROWS, ['pageId'], Table::FORMIE_FIELD_LAYOUT_PAGES, ['id'], 'CASCADE', null);
   124|         $this->addForeignKey(null, Table::FORMIE_FIELDS, ['layoutId'], Table::FORMIE_FIELD_LAYOUTS, ['id'], 'CASCADE', null);
   125|         $this->addForeignKey(null, Table::FORMIE_FIELDS, ['pageId'], Table::FORMIE_FIELD_LAYOUT_PAGES, ['id'], 'CASCADE', null);
   126|         $this->addForeignKey(null, Table::FORMIE_FIELDS, ['rowId'], Table::FORMIE_FIELD_LAYOUT_ROWS, ['id'], 'CASCADE', null);
   127|         $this->addForeignKey(null, Table::FORMIE_FIELDS, ['syncId'], Table::FORMIE_FIELDS, ['id'], 'SET NULL', null);
   128|         $this->createIndex(null, Table::FORMIE_FORMS, 'layoutId', false);
   129|         $this->addForeignKey(null, Table::FORMIE_FORMS, ['layoutId'], Table::FORMIE_FIELD_LAYOUTS, ['id'], 'SET NULL', null);
   130|         $this->dropForeignKeyIfExists(Table::FORMIE_FORMS, ['fieldLayoutId']);
   131|         $this->dropIndexIfExists(Table::FORMIE_FORMS, ['fieldLayoutId']);
   132|     }
   133|     private function _addPopulateLayouts(): bool
   134|     {
   135|         $forms = (new Query())->from(Table::FORMIE_FORMS)->all();
   136|         echo '    > Updating all forms with new field layout.' . PHP_EOL;
   137|         foreach ($forms as $form) {
   138|             $layoutConfig = (new Query())->select('layoutConfig')->from('{{%formie_newlayout}}')->where(['formId' => $form['id']])->scalar();
   139|             if (!$layoutConfig) {
   140|                 echo '    > ' . $form['handle'] . ': Unable to find field layout data.' . PHP_EOL;
   141|                 continue;
   142|             }
   143|             $layoutConfig = Json::decode($layoutConfig);
   144|             $layoutConfig = $this->_processLegacyLayout($layoutConfig);
   145|             $layoutConfig = $this->_processLayoutSubFields($layoutConfig);
   146|             $layoutConfig = $this->_processLayoutFields($layoutConfig);
   147|             $formLayout = new FieldLayout($layoutConfig);
   148|             if (!Formie::$plugin->getFields()->saveLayout($formLayout)) {
   149|                 echo '    > ' . $form['handle'] . ': Unable to save field layout - ' . Json::encode($formLayout->getErrorsTree()) . PHP_EOL;
   150|                 return false;
   151|             }
   152|             Db::update(Table::FORMIE_FORMS, ['layoutId' => $formLayout->id], ['id' => $form['id']]);
   153|             echo '    > Updated Form ' . $form['handle'] . ' field layout.' . PHP_EOL;
   154|         }
   155|         return true;
   156|     }
   157|     private function _migrateTemplateFieldLayout(): void
   158|     {
   159|         $forms = (new Query())->from(Table::FORMIE_FORMS)->all();
   160|         echo '    > Updating all forms with new template field layout.' . PHP_EOL;
   161|         foreach ($forms as $form) {
   162|             $fieldLayout = null;
   163|             $templateId = $form['templateId'] ?? null;
   164|             if ($templateId) {
   165|                 $template = (new Query())->from(Table::FORMIE_FORM_TEMPLATES)->where(['id' => $templateId])->one();
   166|                 $fieldLayoutId = $template['fieldLayoutId'] ?? null;
   167|                 if ($template && $fieldLayoutId) {
   168|                     $fieldLayout = Craft::$app->getFields()->getLayoutById($fieldLayoutId);
   169|                     $this->updateElements([$form['id']], $fieldLayout);
   170|                 }
   171|             }
   172|         }
   173|     }
   174|     private function _migrateSubmissionContent(): void
   175|     {
   176|         $forms = (new Query())->from(Table::FORMIE_FORMS)->all();
   177|         echo '    > Updating Submission content to JSON.' . PHP_EOL;
   178|         foreach ($forms as $form) {
   179|             if (!$form['fieldContentTable']) {
   180|                 echo '    > ' . $form['handle'] . ': missing `fieldContentTable`.' . PHP_EOL;
   181|                 continue;
   182|             }
   183|             if (!$form['layoutId']) {
   184|                 echo '    > ' . $form['handle'] . ': missing `layoutId`.' . PHP_EOL;
   185|                 continue;
   186|             }
   187|             $submissions = (new Query())->from(Table::FORMIE_SUBMISSIONS)->where(['formId' => $form['id']])->all();
   188|             $layout = Formie::$plugin->getFields()->getLayoutById($form['layoutId']);
   189|             foreach ($submissions as $submission) {
   190|                 $content = $this->_createContentJson($form['fieldContentTable'], $submission['id'], 'formie:' . $form['uid'], $layout);
   191|                 Db::update(Table::FORMIE_SUBMISSIONS, ['content' => $content], ['id' => $submission['id']]);
   192|                 echo '    > Updated Submission #' . $submission['id'] . ' content.' . PHP_EOL;
   193|             }
   194|         }
   195|     }
   196|     private function _migrateNestedContent(): void
   197|     {
   198|         $applyNestedFieldContentMigration = function($fields) {
   199|             foreach ($fields as $field) {
   200|                 $oldFieldSettings = Json::decode($field['settings']);
   201|                 $contentTable = $this->_getNestedContentTableName($field);
   202|                 if (!$contentTable) {
   203|                     echo '    > ' . $field['handle'] . ': missing `contentTable`.' . PHP_EOL;
   204|                     continue;
   205|                 }
   206|                 $formUid = str_replace('formie:', '', $field['context']);
   207|                 $form = (new Query())->from(Table::FORMIE_FORMS)->where(['uid' => $formUid])->one();
   208|                 if (!$form) {
   209|                     echo '    > ' . $field['handle'] . ': unable to find owner form.' . PHP_EOL;
   210|                     continue;
   211|                 }
   212|                 $newField = (new Query())->from(Table::FORMIE_FIELDS)->where(['layoutId' => $form['layoutId'], 'handle' => $field['handle']])->one();
   213|                 if (!$newField) {
   214|                     echo '    > ' . $field['handle'] . ': unable to find new field.' . PHP_EOL;
   215|                     continue;
   216|                 }
   217|                 $newFieldSettings = Json::decode($newField['settings']);
   218|                 $nestedLayoutId = $newFieldSettings['nestedLayoutId'] ?? null;
   219|                 if (!$nestedLayoutId) {
   220|                     echo '    > ' . $field['handle'] . ': missing `nestedLayoutId`.' . PHP_EOL;
   221|                     continue;
   222|                 }
   223|                 $nestedRows = (new Query())->from('{{%formie_nestedfieldrows}}')->where(['fieldId' => $field['id']])->all();
   224|                 $layout = Formie::$plugin->getFields()->getLayoutById($nestedLayoutId);
   225|                 $submissionContent = [];
   226|                 foreach ($nestedRows as $nestedRowKey => $nestedRow) {
   227|                     $rowId = $nestedRow['id'];
   228|                     $submissionId = $nestedRow['ownerId'];
   229|                     $content = $this->_createContentJson($contentTable, $rowId, 'formieField:' . $field['uid'], $layout);
   230|                     if ($content) {
   231|                         if (strstr($field['type'], 'Repeater')) {
   232|                             $submissionContent[$submissionId][$newField['uid']][($nestedRow['sortOrder'] - 1)] = $content;
   233|                         } else {
   234|                             $submissionContent[$submissionId][$newField['uid']] = $content;
   235|                         }
   236|                     }
   237|                 }
   238|                 foreach ($submissionContent as $submissionId => $fieldContent) {
   239|                     $newContent = (new Query())->select('content')->from(Table::FORMIE_SUBMISSIONS)->where(['id' => $submissionId])->scalar();
   240|                     if (Json::isJsonObject($newContent)) {
   241|                         $newContent = Json::decode($newContent);
   242|                         $newContent = array_merge($newContent, $fieldContent);
   243|                         Db::update(Table::FORMIE_SUBMISSIONS, ['content' => $newContent], ['id' => $submissionId]);
   244|                         echo '    > Updated Submission ' . $submissionId . ' content for nested content.' . PHP_EOL;
   245|                     } else {
   246|                         echo '    > Skipping Submission ' . $submissionId . ' content for nested content, invalid data ' . Json::encode($newContent) . PHP_EOL;
   247|                     }
   248|                 }
   249|             }
   250|         };
   251|         $groupFields = (new Query())->from('{{%fields}}')->where(['type' => 'verbb\formie\fields\formfields\Group'])->all();
   252|         $repeaterFields = (new Query())->from('{{%fields}}')->where(['type' => 'verbb\formie\fields\formfields\Repeater'])->all();
   253|         echo '    > Updating Group fields content to JSON.' . PHP_EOL;
   254|         $applyNestedFieldContentMigration($groupFields);
   255|         echo '    > Updating Repeater fields content to JSON.' . PHP_EOL;
   256|         $applyNestedFieldContentMigration($repeaterFields);
   257|     }
   258|     private function _createContentJson(string $contentTable, int $id, string $context, FieldLayout $layout): array
   259|     {
   260|         $newContent = [];
   261|         if (!Craft::$app->getDb()->tableExists($contentTable)) {
   262|             echo '    > Unable to find missing content table ' . $contentTable . '.' . PHP_EOL;
   263|             return [];
   264|         }
   265|         $contentRow = (new Query())->from($contentTable)->where(['elementId' => $id])->one();
   266|         if ($contentRow) {
   267|             $uidMap = [];
   268|             foreach ($layout->getFields() as $field) {
   269|                 $uidMap[$field->handle] = $field->uid;
   270|             }
   271|             foreach ($contentRow as $column => $value) {
   272|                 if (!str_starts_with($column, 'field_')) {
   273|                     continue;
   274|                 }
   275|                 if ($value === null) {
   276|                     continue;
   277|                 }
   278|                 $handle = str_replace('field_', '', $column);
   279|                 $field = (new Query())->from('{{%fields}}')->where(['context' => $context])->one();
   280|                 if (!$field) {
   281|                     echo '    > Unable to find field for content matching UID for field ' . $handle . ' in ' . $contentTable . '.' . PHP_EOL;
   282|                     continue;
   283|                 }
   284|                 if ($field['columnSuffix']) {
   285|                     $handle = str_replace('_' . $field['columnSuffix'], '', $handle);
   286|                 }
   287|                 if (str_contains($handle, '_')) {
   288|                     $handle = preg_match('/^(.+)_([a-z]{8})$/', $handle, $matches) ? $matches[1] : $handle;
   289|                 }
   290|                 $uid = $uidMap[$handle] ?? null;
   291|                 if (!$uid) {
   292|                     echo '    > Unable to find matching UID for field ' . $handle . ' in ' . $contentTable . '.' . PHP_EOL;
   293|                     continue;
   294|                 }
   295|                 if ($value && Json::isJsonObject($value)) {
   296|                     try {
   297|                         $newContent[$uid] = Json::decode($value);
   298|                     } catch (Throwable $e) {
   299|                         $newContent[$uid] = $value;
   300|                     }
   301|                 } else {
   302|                     $newContent[$uid] = $value;
   303|                 }
   304|             }
   305|         } else {
   306|             echo '    > Unable to find content for element #' . $id . ' in ' . $contentTable . '.' . PHP_EOL;
   307|         }
   308|         return $newContent;
   309|     }
   310|     private function _processLegacyLayout(array $layoutConfig): array
   311|     {
   312|         foreach (($layoutConfig['pages'] ?? []) as $pageKey => $page) {
   313|             foreach (($page['rows'] ?? []) as $rowKey => $row) {
   314|                 foreach (($row['fields'] ?? []) as $fieldKey => $field) {
   315|                     $fieldUid = $field['fieldUid'] ?? null;
   316|                     $required = $field['required'] ?? null;
   317|                     if (!$fieldUid) {
   318|                         continue;
   319|                     }
   320|                     $oldField = (new Query())->from('{{%fields}}')->where(['uid' => $fieldUid])->one();
   321|                     if (!$oldField) {
   322|                         throw new Exception('Unable to find legacy field for UID: ' . $fieldUid);
   323|                     }
   324|                     $newFieldConfig = Json::decode($oldField['settings']);
   325|                     $newFieldConfig['type'] = $oldField['type'];
   326|                     $newFieldConfig['label'] = $oldField['name'];
   327|                     $newFieldConfig['handle'] = $oldField['handle'];
   328|                     $newFieldConfig['required'] = $required;
   329|                     $newFieldConfig['instructions'] = $oldField['instructions'];
   330|                     $layoutConfig['pages'][$pageKey]['rows'][$rowKey]['fields'][$fieldKey] = $newFieldConfig;
   331|                 }
   332|             }
   333|         }
   334|         return $layoutConfig;
   335|     }
   336|     private function _processLayoutSubFields(array $layoutConfig): array
   337|     {
   338|         foreach (($layoutConfig['pages'] ?? []) as $pageKey => $page) {
   339|             foreach (($page['rows'] ?? []) as $rowKey => $row) {
   340|                 foreach (($row['fields'] ?? []) as $fieldKey => $field) {
   341|                     $updatedConfig = false;
   342|                     $type = $field['type'] ?? null;
   343|                     if (!$type) {
   344|                         continue;
   345|                     }
   346|                     if ($field['type'] === 'verbb\formie\fields\formfields\Address') {
   347|                         $field['rows'] = $this->_getAddressConfig($field);
   348|                         $updatedConfig = true;
   349|                     }
   350|                     if ($field['type'] === 'verbb\formie\fields\formfields\Date') {
   351|                         $displayType = $field['displayType'] ?? 'calendar';
   352|                         if ($displayType == 'calendar' || $displayType == 'datePicker') {
   353|                             $field['rows'] = $this->_getDateCalendarConfig($field);
   354|                             $updatedConfig = true;
   355|                         }
   356|                         if ($displayType == 'dropdowns') {
   357|                             $field['rows'] = $this->_getDateDropdownsConfig($field);
   358|                             $updatedConfig = true;
   359|                         }
   360|                         if ($displayType == 'inputs') {
   361|                             $field['rows'] = $this->_getDateInputsConfig($field);
   362|                             $updatedConfig = true;
   363|                         }
   364|                     }
   365|                     if ($field['type'] === 'verbb\formie\fields\formfields\Name') {
   366|                         $useMultipleFields = $field['useMultipleFields'] ?? false;
   367|                         if ($useMultipleFields) {
   368|                             $field['rows'] = $this->_getNameConfig($field);
   369|                             $updatedConfig = true;
   370|                         }
   371|                     }
   372|                     if ($updatedConfig) {
   373|                         $layoutConfig['pages'][$pageKey]['rows'][$rowKey]['fields'][$fieldKey] = $field;
   374|                     }
   375|                 }
   376|             }
   377|         }
   378|         return $layoutConfig;
   379|     }
   380|     private function _processLayoutFields(array $layoutConfig): array
   381|     {
   382|         foreach (($layoutConfig['pages'] ?? []) as $pageKey => $page) {
   383|             foreach (($page['rows'] ?? []) as $rowKey => $row) {
   384|                 foreach (($row['fields'] ?? []) as $fieldKey => $field) {
   385|                     $updatedConfig = false;
   386|                     $type = $field['type'] ?? null;
   387|                     if (!$type) {
   388|                         continue;
   389|                     }
   390|                     if ($field['type'] === 'verbb\formie\fields\formfields\Section') {
   391|                         $field['label'] = $field['label'] ?? StringHelper::appendUniqueIdentifier(Craft::t('formie', 'Section Label '));
   392|                         $field['handle'] = $field['handle'] ?? StringHelper::appendUniqueIdentifier('sectionHandle');
   393|                         $updatedConfig = true;
   394|                     }
   395|                     if ($field['type'] === 'verbb\formie\fields\formfields\Summary') {
   396|                         $field['label'] = $field['label'] ?? StringHelper::appendUniqueIdentifier(Craft::t('formie', 'Summary '));
   397|                         $field['handle'] = $field['handle'] ?? StringHelper::appendUniqueIdentifier('summaryHandle');
   398|                         $updatedConfig = true;
   399|                     }
   400|                     if ($updatedConfig) {
   401|                         $layoutConfig['pages'][$pageKey]['rows'][$rowKey]['fields'][$fieldKey] = $field;
   402|                     }
   403|                 }
   404|             }
   405|         }
   406|         return $layoutConfig;
   407|     }
   408|     private function _getNestedContentTableName(array $field): string
   409|     {
   410|         $settings = Json::decode($field['settings']);
   411|         $contentTable = $settings['contentTable'] ?? null;
   412|         if ($contentTable) {
   413|             return $contentTable;
   414|         }
   415|         $suffix = strtolower(substr($field['handle'], 0, 51));
   416|         foreach (Craft::$app->getDb()->schema->getTableNames() as $tableName) {
   417|             $guessedTable = preg_match('/^fmc_\d+_(' . preg_quote($suffix) . ')$/', $tableName, $matches) ? $matches[1] : false;
   418|             if ($guessedTable) {
   419|                 return $guessedTable;
   420|             }
   421|         }
   422|         return '';
   423|     }
   424|     private function _updateFormTitles(): void
   425|     {
   426|         $forms = (new Query())->select('id')->from(Table::FORMIE_FORMS)->all();
   427|         foreach ($forms as $form) {
   428|             $elementId = $form['id'];
   429|             $title = (new Query())->select('title')->from('{{%content}}')->where(['elementId' => $elementId])->scalar();
   430|             if ($title) {
   431|                 $this->update(Table::ELEMENTS_SITES, ['title' => $title], ['elementId' => $elementId]);
   432|                 $this->update('{{%content}}', ['title' => null], ['elementId' => $elementId]);
   433|                 echo '    > Updated form #' . $elementId . ' title to ' . $title . '.' . PHP_EOL;
   434|             }
   435|         }
   436|     }
   437|     private function _updateSubmissionTitles(): void
   438|     {
   439|         $submissions = (new Query())->select(['id', 'title'])->from(Table::FORMIE_SUBMISSIONS)->all();
   440|         foreach ($submissions as $submission) {
   441|             $elementId = $submission['id'];
   442|             $title = $submission['title'];
   443|             if ($title) {
   444|                 $this->update(Table::ELEMENTS_SITES, ['title' => $title], ['elementId' => $elementId]);
   445|                 echo '    > Updated submission #' . $elementId . ' title to ' . $title . '.' . PHP_EOL;
   446|             }
   447|         }
   448|     }
   449|     private function _updateSyncFields(): void
   450|     {
   451|         $syncs = (new Query())->from('{{%formie_syncs}}')->all();
   452|         foreach ($syncs as $sync) {
   453|             $syncIds = [];
   454|             $syncFields = (new Query())->from('{{%formie_syncfields}}')->where(['syncId' => $sync['id']])->all();
   455|             foreach ($syncFields as $syncField) {
   456|                 $oldField = (new Query())->from('{{%fields}}')->where(['id' => $syncField['fieldId']])->one();
   457|                 if ($oldField) {
   458|                     $formUid = str_replace('formie:', '', $oldField['context']);
   459|                     $form = (new Query())->from(Table::FORMIE_FORMS)->where(['uid' => $formUid])->one();
   460|                     if ($form) {
   461|                         $newField = (new Query())->from(Table::FORMIE_FIELDS)->where(['layoutId' => $form['layoutId'], 'handle' => $oldField['handle']])->one();
   462|                         if ($newField) {
   463|                             $syncIds[] = $newField['id'];
   464|                         }
   465|                     }
   466|                 }
   467|             }
   468|             if ($syncIds) {
   469|                 $primarySyncId = $syncIds[0];
   470|                 foreach ($syncIds as $syncId) {
   471|                     $this->update(Table::FORMIE_FIELDS, ['syncId' => $primarySyncId], ['id' => $syncId]);
   472|                 }
   473|             }
   474|         }
   475|     }
   476|     private function _migrateRelationFields(): void
   477|     {
   478|         $fields = (new Query())->from('{{%fields}}')->all();
   479|         $elementRelations = [];
   480|         foreach ($fields as $field) {
   481|             if (str_contains($field['context'], 'formie:')) {
   482|                 $relations = (new Query())->from('{{%relations}}')->where(['fieldId' => $field['id']])->orderBy('sortOrder')->all();
   483|                 foreach ($relations as $relation) {
   484|                     $formId = $field['context'];
   485|                     $submissionId = $relation['sourceId'];
   486|                     $fieldId = $field['handle'];
   487|                     $elementId = $relation['targetId'];
   488|                     $elementRelations[$formId][$submissionId][$fieldId][] = $elementId;
   489|                 }
   490|             }
   491|             if (str_contains($field['context'], 'formieField:')) {
   492|                 $nestedFieldUid = str_replace('formieField:', '', $field['context']);
   493|                 $nestedField = (new Query())->from('{{%fields}}')->where(['uid' => $nestedFieldUid])->one();
   494|                 if ($nestedField) {
   495|                     $nestedRows = (new Query())->from('{{%formie_nestedfieldrows}}')->where(['fieldId' => $nestedField['id']])->orderBy('sortOrder')->all();
   496|                     foreach ($nestedRows as $key => $nestedRow) {
   497|                         $relations = (new Query())->from('{{%relations}}')->where(['sourceId' => $nestedRow['id'], 'fieldId' => $field['id']])->orderBy('sortOrder')->all();
   498|                         foreach ($relations as $relation) {
   499|                             $formId = $nestedField['context'];
   500|                             $nestedFieldId = $nestedField['handle'];
   501|                             $submissionId = $nestedRow['ownerId'];
   502|                             $fieldId = $field['handle'];
   503|                             $elementId = $relation['targetId'];
   504|                             $rowId = (string)($nestedRow['sortOrder'] - 1);
   505|                             if (str_contains($nestedField['type'], 'Repeater')) {
   506|                                 $elementRelations[$formId][$submissionId][$nestedFieldId][$rowId][$fieldId][] = $elementId;
   507|                             } else {
   508|                                 $elementRelations[$formId][$submissionId][$nestedFieldId][$fieldId][] = $elementId;
   509|                             }
   510|                         }
   511|                     }
   512|                 }
   513|             }
   514|         }
   515|         foreach ($elementRelations as $formContext => $elementRelation) {
   516|             $formUid = str_replace('formie:', '', $formContext);
   517|             $form = (new Query())->from(Table::FORMIE_FORMS)->where(['uid' => $formUid])->one();
   518|             if ($form) {
   519|                 $fieldUidMap = [];
   520|                 $fields = (new Query())->from(Table::FORMIE_FIELDS)->where(['layoutId' => $form['layoutId']])->all();
   521|                 foreach ($fields as $field) {
   522|                     $fieldUidMap[$field['handle']] = $field['uid'];
   523|                     if (str_contains($field['type'], 'Repeater') || str_contains($field['type'], 'Group')) {
   524|                         $nestedFieldSettings = Json::decode($field['settings']);
   525|                         $nestedFieldLayoutId = $nestedFieldSettings['nestedLayoutId'] ?? null;
   526|                         if ($nestedFieldLayoutId) {
   527|                             $nestedFields = (new Query())->from(Table::FORMIE_FIELDS)->where(['layoutId' => $nestedFieldLayoutId])->all();
   528|                             foreach ($nestedFields as $nestedField) {
   529|                                 $fieldUidMap[$field['handle'] . ':' . $nestedField['handle']] = $nestedField['uid'];
   530|                             }
   531|                         }
   532|                     }
   533|                 }
   534|                 foreach ($elementRelation as $submissionId => $fieldsContent) {
   535|                     $submission = (new Query())->from(Table::FORMIE_SUBMISSIONS)->where(['id' => $submissionId])->one();
   536|                     if ($submission) {
   537|                         $content = Json::decode($submission['content']) ?? [];
   538|                         $preppedContent = [];
   539|                         foreach ($fieldsContent as $fieldHandle => $fieldValues) {
   540|                             $uid = $fieldUidMap[$fieldHandle] ?? null;
   541|                             if ($uid) {
   542|                                 $preppedContent[$uid] = $fieldValues;
   543|                             }
   544|                         }
   545|                         $submissionContent = array_replace_recursive($content, $preppedContent);
   546|                         Db::update(Table::FORMIE_SUBMISSIONS, ['content' => $submissionContent], ['id' => $submissionId]);
   547|                         echo '    > Updated Submission ' . $submissionId . ' content for related content.' . PHP_EOL;
   548|                     }
   549|                 }
   550|             }
   551|         }
   552|     }
   553|     private function _migratePaymentFields(): void
   554|     {
   555|         $this->dropForeignKeyIfExists(Table::FORMIE_PAYMENTS, ['fieldId']);
   556|         $this->dropForeignKeyIfExists(Table::FORMIE_SUBSCRIPTIONS, ['fieldId']);
   557|         $oldFields = (new Query())->from('{{%fields}}')->where(['type' => 'verbb\\formie\\fields\\formfields\\Payment'])->all();
   558|         $fieldMap = [];
   559|         foreach ($oldFields as $oldField) {
   560|             if (str_contains($oldField['context'], 'formie:')) {
   561|                 $formUid = str_replace('formie:', '', $oldField['context']);
   562|                 $form = (new Query())->from(Table::FORMIE_FORMS)->where(['uid' => $formUid])->one();
   563|                 if ($form) {
   564|                     $newField = (new Query())->from(Table::FORMIE_FIELDS)->where(['layoutId' => $form['layoutId'], 'handle' => $oldField['handle']])->one();
   565|                     if ($newField) {
   566|                         $fieldMap[$oldField['id']] = $newField['id'];
   567|                     }
   568|                 }
   569|             }
   570|             if (str_contains($oldField['context'], 'formieField:')) {
   571|                 $oldNestedFieldUid = str_replace('formieField:', '', $oldField['context']);
   572|                 $oldNestedField = (new Query())->from('{{%fields}}')->where(['uid' => $oldNestedFieldUid])->one();
   573|                 if ($oldNestedField) {
   574|                     $formUid = str_replace('formie:', '', $oldNestedField['context']);
   575|                     $form = (new Query())->from(Table::FORMIE_FORMS)->where(['uid' => $formUid])->one();
   576|                     if ($form) {
   577|                         $newNestedField = (new Query())->from(Table::FORMIE_FIELDS)->where(['layoutId' => $form['layoutId'], 'handle' => $oldNestedField['handle']])->one();
   578|                         if ($newNestedField) {
   579|                             $nestedFieldSettings = Json::decode($newNestedField['settings']);
   580|                             $nestedLayoutId = $nestedFieldSettings['nestedLayoutId'] ?? null;
   581|                             if ($nestedLayoutId) {
   582|                                 $newField = (new Query())->from(Table::FORMIE_FIELDS)->where(['layoutId' => $nestedLayoutId, 'handle' => $oldField['handle']])->one();
   583|                                 if ($newField) {
   584|                                     $fieldMap[$oldField['id']] = $newField['id'];
   585|                                 }
   586|                             }
   587|                         }
   588|                     }
   589|                 }
   590|             }
   591|         }
   592|         $payments = (new Query())->from(Table::FORMIE_PAYMENTS)->all();
   593|         foreach ($payments as $payment) {
   594|             $oldFieldId = $payment['fieldId'];
   595|             $newFieldId = $fieldMap[$oldFieldId] ?? null;
   596|             $this->update(Table::FORMIE_PAYMENTS, ['fieldId' => $newFieldId], ['id' => $payment['id']]);
   597|         }
   598|         $subscriptions = (new Query())->from(Table::FORMIE_SUBSCRIPTIONS)->all();
   599|         foreach ($subscriptions as $subscription) {
   600|             $oldFieldId = $subscription['fieldId'];
   601|             $newFieldId = $fieldMap[$oldFieldId] ?? null;
   602|             $this->update(Table::FORMIE_SUBSCRIPTIONS, ['fieldId' => $newFieldId], ['id' => $subscription['id']]);
   603|         }
   604|         $this->addForeignKey(null, Table::FORMIE_PAYMENTS, ['fieldId'], Table::FORMIE_FIELDS, ['id'], 'CASCADE', null);
   605|         $this->addForeignKey(null, Table::FORMIE_SUBSCRIPTIONS, ['fieldId'], Table::FORMIE_FIELDS, ['id'], 'RESTRICT', null);
   606|     }
   607|     private function _getAddressConfig(array $settings): array
   608|     {
   609|         return [
   610|             [
   611|                 'fields' => [
   612|                     [
   613|                         'type' => subfields\Address1::class,
   614|                         'label' => trim($settings['address1Label'] ?? '') ?: Craft::t('formie', 'Address 1'),
   615|                         'handle' => 'address1',
   616|                         'enabled' => $settings['address1Enabled'] ?? true,
   617|                         'required' => $settings['address1Required'] ?? false,
   618|                         'errorMessage' => $settings['address1ErrorMessage'] ?? null,
   619|                         'placeholder' => $settings['address1Placeholder'] ?? null,
   620|                         'defaultValue' => $settings['address1DefaultValue'] ?? null,
   621|                         'prePopulate' => $settings['address1PrePopulate'] ?? null,
   622|                         'inputAttributes' => [
   623|                             [
   624|                                 'label' => 'autocomplete',
   625|                                 'value' => 'address-line1',
   626|                             ],
   627|                             [
   628|                                 'label' => 'data-address1',
   629|                                 'value' => true,
   630|                             ],
   631|                         ],
   632|                     ],
   633|                 ],
   634|             ],
   635|             [
   636|                 'fields' => [
   637|                     [
   638|                         'type' => subfields\Address2::class,
   639|                         'label' => trim($settings['address2Label'] ?? '') ?: Craft::t('formie', 'Address 2'),
   640|                         'handle' => 'address2',
   641|                         'enabled' => $settings['address2Enabled'] ?? false,
   642|                         'required' => $settings['address2Required'] ?? false,
   643|                         'errorMessage' => $settings['address2ErrorMessage'] ?? null,
   644|                         'placeholder' => $settings['address2Placeholder'] ?? null,
   645|                         'defaultValue' => $settings['address2DefaultValue'] ?? null,
   646|                         'prePopulate' => $settings['address2PrePopulate'] ?? null,
   647|                         'inputAttributes' => [
   648|                             [
   649|                                 'label' => 'autocomplete',
   650|                                 'value' => 'address-line2',
   651|                             ],
   652|                             [
   653|                                 'label' => 'data-address2',
   654|                                 'value' => true,
   655|                             ],
   656|                         ],
   657|                     ],
   658|                 ],
   659|             ],
   660|             [
   661|                 'fields' => [
   662|                     [
   663|                         'type' => subfields\Address3::class,
   664|                         'label' => trim($settings['address3Label'] ?? '') ?: Craft::t('formie', 'Address 3'),
   665|                         'handle' => 'address3',
   666|                         'enabled' => $settings['address3Enabled'] ?? false,
   667|                         'required' => $settings['address3Required'] ?? false,
   668|                         'errorMessage' => $settings['address3ErrorMessage'] ?? null,
   669|                         'placeholder' => $settings['address3Placeholder'] ?? null,
   670|                         'defaultValue' => $settings['address3DefaultValue'] ?? null,
   671|                         'prePopulate' => $settings['address3PrePopulate'] ?? null,
   672|                         'inputAttributes' => [
   673|                             [
   674|                                 'label' => 'autocomplete',
   675|                                 'value' => 'address-line3',
   676|                             ],
   677|                             [
   678|                                 'label' => 'data-address3',
   679|                                 'value' => true,
   680|                             ],
   681|                         ],
   682|                     ],
   683|                 ],
   684|             ],
   685|             [
   686|                 'fields' => [
   687|                     [
   688|                         'type' => subfields\AddressCity::class,
   689|                         'label' =>  trim($settings['cityLabel'] ?? '') ?: Craft::t('formie', 'City'),
   690|                         'handle' => 'city',
   691|                         'enabled' => $settings['cityEnabled'] ?? true,
   692|                         'required' => $settings['cityRequired'] ?? false,
   693|                         'errorMessage' => $settings['cityErrorMessage'] ?? null,
   694|                         'placeholder' => $settings['cityPlaceholder'] ?? null,
   695|                         'defaultValue' => $settings['cityDefaultValue'] ?? null,
   696|                         'prePopulate' => $settings['cityPrePopulate'] ?? null,
   697|                         'inputAttributes' => [
   698|                             [
   699|                                 'label' => 'autocomplete',
   700|                                 'value' => 'address-level2',
   701|                             ],
   702|                             [
   703|                                 'label' => 'data-city',
   704|                                 'value' => true,
   705|                             ],
   706|                         ],
   707|                     ],
   708|                     [
   709|                         'type' => subfields\AddressZip::class,
   710|                         'label' => trim($settings['zipLabel'] ?? '') ?: Craft::t('formie', 'ZIP / Postal Code'),
   711|                         'handle' => 'zip',
   712|                         'enabled' => $settings['zipEnabled'] ?? true,
   713|                         'required' => $settings['zipRequired'] ?? false,
   714|                         'errorMessage' => $settings['zipErrorMessage'] ?? null,
   715|                         'placeholder' => $settings['zipPlaceholder'] ?? null,
   716|                         'defaultValue' => $settings['zipDefaultValue'] ?? null,
   717|                         'prePopulate' => $settings['zipPrePopulate'] ?? null,
   718|                         'inputAttributes' => [
   719|                             [
   720|                                 'label' => 'autocomplete',
   721|                                 'value' => 'postal-code',
   722|                             ],
   723|                             [
   724|                                 'label' => 'data-zip',
   725|                                 'value' => true,
   726|                             ],
   727|                         ],
   728|                     ],
   729|                 ],
   730|             ],
   731|             [
   732|                 'fields' => [
   733|                     [
   734|                         'type' => subfields\AddressState::class,
   735|                         'label' => trim($settings['stateLabel'] ?? '') ?: Craft::t('formie', 'State / Province'),
   736|                         'handle' => 'state',
   737|                         'enabled' => $settings['stateEnabled'] ?? true,
   738|                         'required' => $settings['stateRequired'] ?? false,
   739|                         'errorMessage' => $settings['stateErrorMessage'] ?? null,
   740|                         'placeholder' => $settings['statePlaceholder'] ?? null,
   741|                         'defaultValue' => $settings['stateDefaultValue'] ?? null,
   742|                         'prePopulate' => $settings['statePrePopulate'] ?? null,
   743|                         'inputAttributes' => [
   744|                             [
   745|                                 'label' => 'autocomplete',
   746|                                 'value' => 'address-level1',
   747|                             ],
   748|                             [
   749|                                 'label' => 'data-state',
   750|                                 'value' => true,
   751|                             ],
   752|                         ],
   753|                     ],
   754|                     [
   755|                         'type' => subfields\AddressCountry::class,
   756|                         'label' => trim($settings['countryLabel'] ?? '') ?: Craft::t('formie', 'Country'),
   757|                         'handle' => 'country',
   758|                         'enabled' => $settings['countryEnabled'] ?? true,
   759|                         'required' => $settings['countryRequired'] ?? false,
   760|                         'errorMessage' => $settings['countryErrorMessage'] ?? null,
   761|                         'placeholder' => $settings['countryPlaceholder'] ?? null,
   762|                         'defaultValue' => $settings['countryDefaultValue'] ?? null,
   763|                         'prePopulate' => $settings['countryPrePopulate'] ?? null,
   764|                         'optionLabel' => $settings['countryOptionLabel'] ?? 'full',
   765|                         'optionValue' => $settings['countryOptionValue'] ?? 'short',
   766|                         'inputAttributes' => [
   767|                             [
   768|                                 'label' => 'autocomplete',
   769|                                 'value' => 'country',
   770|                             ],
   771|                             [
   772|                                 'label' => 'data-country',
   773|                                 'value' => true,
   774|                             ],
   775|                         ],
   776|                     ],
   777|                 ],
   778|             ],
   779|         ];
   780|     }
   781|     private function _getDateCalendarConfig(array $settings): array
   782|     {
   783|         return [
   784|             [
   785|                 'fields' => [
   786|                     [
   787|                         'type' => fields\SingleLineText::class,
   788|                         'label' => trim($settings['dateLabel'] ?? '') ?: Craft::t('formie', 'Date'),
   789|                         'handle' => 'date',
   790|                         'enabled' => $settings['includeDate'] ?? true,
   791|                         'required' => $settings['required'] ?? false,
   792|                         'placeholder' => $settings['placeholder'] ?? null,
   793|                         'errorMessage' => $settings['errorMessage'] ?? null,
   794|                         'defaultValue' => $settings['defaultValue'] ?? null,
   795|                         'labelPosition' => HiddenPosition::class,
   796|                         'inputAttributes' => [
   797|                             [
   798|                                 'label' => 'type',
   799|                                 'value' => 'date',
   800|                             ],
   801|                             [
   802|                                 'label' => 'autocomplete',
   803|                                 'value' => 'off',
   804|                             ],
   805|                         ],
   806|                     ],
   807|                     [
   808|                         'type' => fields\SingleLineText::class,
   809|                         'label' => trim($settings['timeLabel'] ?? '') ?: Craft::t('formie', 'Time'),
   810|                         'handle' => 'time',
   811|                         'enabled' => $settings['includeTime'] ?? true,
   812|                         'required' => $settings['required'] ?? false,
   813|                         'placeholder' => $settings['placeholder'] ?? null,
   814|                         'errorMessage' => $settings['errorMessage'] ?? null,
   815|                         'defaultValue' => $settings['defaultValue'] ?? null,
   816|                         'labelPosition' => HiddenPosition::class,
   817|                         'inputAttributes' => [
   818|                             [
   819|                                 'label' => 'type',
   820|                                 'value' => 'time',
   821|                             ],
   822|                             [
   823|                                 'label' => 'autocomplete',
   824|                                 'value' => 'off',
   825|                             ],
   826|                         ],
   827|                     ],
   828|                 ],
   829|             ],
   830|         ];
   831|     }
   832|     private function _getDateDropdownsConfig(array $settings): array
   833|     {
   834|         return [
   835|             [
   836|                 'fields' => [
   837|                     [
   838|                         'type' => subfields\DateYearDropdown::class,
   839|                         'label' => trim($settings['yearLabel'] ?? '') ?: Craft::t('formie', 'Year'),
   840|                         'handle' => 'year',
   841|                         'enabled' => true,
   842|                         'placeholder' => $settings['yearPlaceholder'] ?? null,
   843|                         'options' => [],
   844|                     ],
   845|                     [
   846|                         'type' => subfields\DateMonthDropdown::class,
   847|                         'label' => trim($settings['monthLabel'] ?? '') ?: Craft::t('formie', 'Month'),
   848|                         'handle' => 'month',
   849|                         'enabled' => true,
   850|                         'placeholder' => $settings['monthPlaceholder'] ?? null,
   851|                         'options' => $this->_getMonthOptions(),
   852|                     ],
   853|                     [
   854|                         'type' => subfields\DateDayDropdown::class,
   855|                         'label' => Craft::t('formie', 'Day'),
   856|                         'handle' => 'day',
   857|                         'enabled' => true,
   858|                         'placeholder' => $settings['dayPlaceholder'] ?? null,
   859|                         'options' => $this->_generateOptions(1, 31),
   860|                     ],
   861|                     [
   862|                         'type' => subfields\DateHourDropdown::class,
   863|                         'label' => trim($settings['hourLabel'] ?? '') ?: Craft::t('formie', 'Hour'),
   864|                         'handle' => 'hour',
   865|                         'enabled' => true,
   866|                         'placeholder' => $settings['hourPlaceholder'] ?? null,
   867|                         'options' => $this->_generateOptions(0, 23),
   868|                     ],
   869|                     [
   870|                         'type' => subfields\DateMinuteDropdown::class,
   871|                         'label' => trim($settings['minueLabel'] ?? '') ?: Craft::t('formie', 'Minute'),
   872|                         'handle' => 'minute',
   873|                         'enabled' => true,
   874|                         'placeholder' => $settings['minutePlaceholder'] ?? null,
   875|                         'options' => $this->_generateOptions(0, 59),
   876|                     ],
   877|                     [
   878|                         'type' => subfields\DateSecondDropdown::class,
   879|                         'label' => trim($settings['secondLabel'] ?? '') ?: Craft::t('formie', 'Second'),
   880|                         'handle' => 'second',
   881|                         'enabled' => false,
   882|                         'placeholder' => $settings['secondPlaceholder'] ?? null,
   883|                         'options' => $this->_generateOptions(0, 59),
   884|                     ],
   885|                     [
   886|                         'type' => subfields\DateAmPmDropdown::class,
   887|                         'label' => trim($settings['ampmLabel'] ?? '') ?: Craft::t('formie', 'AM/PM'),
   888|                         'handle' => 'ampm',
   889|                         'enabled' => false,
   890|                         'placeholder' => $settings['ampmPlaceholder'] ?? null,
   891|                         'options' => [
   892|                             ['value' => 'AM', 'label' => Craft::t('formie', 'AM')],
   893|                             ['value' => 'PM', 'label' => Craft::t('formie', 'PM')],
   894|                         ],
   895|                     ],
   896|                 ],
   897|             ],
   898|         ];
   899|     }
   900|     private function _getDateInputsConfig(array $settings): array
   901|     {
   902|         return [
   903|             [
   904|                 'fields' => [
   905|                     [
   906|                         'type' => subfields\DateYearNumber::class,
   907|                         'label' => trim($settings['yearLabel'] ?? '') ?: Craft::t('formie', 'Year'),
   908|                         'handle' => 'year',
   909|                         'enabled' => true,
   910|                         'placeholder' => $settings['yearPlaceholder'] ?? null,
   911|                         'limit' => true,
   912|                         'min' => 1924,
   913|                         'max' => 2124,
   914|                     ],
   915|                     [
   916|                         'type' => subfields\DateMonthNumber::class,
   917|                         'label' => trim($settings['monthLabel'] ?? '') ?: Craft::t('formie', 'Month'),
   918|                         'handle' => 'month',
   919|                         'enabled' => true,
   920|                         'placeholder' => $settings['monthPlaceholder'] ?? null,
   921|                         'limit' => true,
   922|                         'min' => 1,
   923|                         'max' => 12,
   924|                     ],
   925|                     [
   926|                         'type' => subfields\DateDayNumber::class,
   927|                         'label' => Craft::t('formie', 'Day'),
   928|                         'handle' => 'day',
   929|                         'enabled' => true,
   930|                         'placeholder' => $settings['dayPlaceholder'] ?? null,
   931|                         'limit' => true,
   932|                         'min' => 1,
   933|                         'max' => 31,
   934|                     ],
   935|                     [
   936|                         'type' => subfields\DateHourNumber::class,
   937|                         'label' => trim($settings['hourLabel'] ?? '') ?: Craft::t('formie', 'Hour'),
   938|                         'handle' => 'hour',
   939|                         'enabled' => true,
   940|                         'placeholder' => $settings['hourPlaceholder'] ?? null,
   941|                         'limit' => true,
   942|                         'min' => 0,
   943|                         'max' => 23,
   944|                     ],
   945|                     [
   946|                         'type' => subfields\DateMinuteNumber::class,
   947|                         'label' => trim($settings['minueLabel'] ?? '') ?: Craft::t('formie', 'Minute'),
   948|                         'handle' => 'minute',
   949|                         'enabled' => true,
   950|                         'placeholder' => $settings['minutePlaceholder'] ?? null,
   951|                         'limit' => true,
   952|                         'min' => 0,
   953|                         'max' => 59,
   954|                     ],
   955|                     [
   956|                         'type' => subfields\DateSecondNumber::class,
   957|                         'label' => trim($settings['secondLabel'] ?? '') ?: Craft::t('formie', 'Second'),
   958|                         'handle' => 'second',
   959|                         'enabled' => false,
   960|                         'placeholder' => $settings['secondPlaceholder'] ?? null,
   961|                         'limit' => true,
   962|                         'min' => 0,
   963|                         'max' => 59,
   964|                     ],
   965|                     [
   966|                         'type' => subfields\DateAmPmDropdown::class,
   967|                         'label' => trim($settings['ampmLabel'] ?? '') ?: Craft::t('formie', 'AM/PM'),
   968|                         'handle' => 'ampm',
   969|                         'enabled' => false,
   970|                         'placeholder' => $settings['ampmPlaceholder'] ?? null,
   971|                         'options' => [
   972|                             ['value' => 'AM', 'label' => Craft::t('formie', 'AM')],
   973|                             ['value' => 'PM', 'label' => Craft::t('formie', 'PM')],
   974|                         ],
   975|                     ],
   976|                 ],
   977|             ],
   978|         ];
   979|     }
   980|     private function _getNameConfig(array $settings): array
   981|     {
   982|         return [
   983|             [
   984|                 'fields' => [
   985|                     [
   986|                         'type' => subfields\NamePrefix::class,
   987|                         'label' => trim($settings['prefixLabel'] ?? '') ?: Craft::t('formie', 'Prefix'),
   988|                         'handle' => 'prefix',
   989|                         'enabled' => $settings['prefixEnabled'] ?? false,
   990|                         'required' => $settings['prefixRequired'] ?? false,
   991|                         'errorMessage' => $settings['prefixErrorMessage'] ?? null,
   992|                         'placeholder' => $settings['prefixPlaceholder'] ?? null,
   993|                         'defaultValue' => $settings['prefixDefaultValue'] ?? null,
   994|                         'prePopulate' => $settings['prefixPrePopulate'] ?? null,
   995|                         'inputAttributes' => [
   996|                             [
   997|                                 'label' => 'autocomplete',
   998|                                 'value' => 'honorific-prefix',
   999|                             ],
  1000|                         ],
  1001|                     ],
  1002|                     [
  1003|                         'type' => subfields\NameFirst::class,
  1004|                         'label' => trim($settings['firstNameLabel'] ?? '') ?: Craft::t('formie', 'First Name'),
  1005|                         'handle' => 'firstName',
  1006|                         'enabled' => $settings['firstNameEnabled'] ?? true,
  1007|                         'required' => $settings['firstNameRequired'] ?? false,
  1008|                         'errorMessage' => $settings['firstNameErrorMessage'] ?? null,
  1009|                         'placeholder' => $settings['firstNamePlaceholder'] ?? null,
  1010|                         'defaultValue' => $settings['firstNameDefaultValue'] ?? null,
  1011|                         'prePopulate' => $settings['firstNamePrePopulate'] ?? null,
  1012|                         'inputAttributes' => [
  1013|                             [
  1014|                                 'label' => 'autocomplete',
  1015|                                 'value' => 'given-name',
  1016|                             ],
  1017|                         ],
  1018|                     ],
  1019|                     [
  1020|                         'type' => subfields\NameMiddle::class,
  1021|                         'label' => trim($settings['middleNameLabel'] ?? '') ?: Craft::t('formie', 'Middle Name'),
  1022|                         'handle' => 'middleName',
  1023|                         'enabled' => $settings['middleNameEnabled'] ?? false,
  1024|                         'required' => $settings['middleNameRequired'] ?? false,
  1025|                         'errorMessage' => $settings['middleNameErrorMessage'] ?? null,
  1026|                         'placeholder' => $settings['middleNamePlaceholder'] ?? null,
  1027|                         'defaultValue' => $settings['middleNameDefaultValue'] ?? null,
  1028|                         'prePopulate' => $settings['middleNamePrePopulate'] ?? null,
  1029|                         'inputAttributes' => [
  1030|                             [
  1031|                                 'label' => 'autocomplete',
  1032|                                 'value' => 'additional-name',
  1033|                             ],
  1034|                         ],
  1035|                     ],
  1036|                     [
  1037|                         'type' => subfields\NameLast::class,
  1038|                         'label' => trim($settings['lastNameLabel'] ?? '') ?: Craft::t('formie', 'Last Name'),
  1039|                         'handle' => 'lastName',
  1040|                         'enabled' => $settings['lastNameEnabled'] ?? true,
  1041|                         'required' => $settings['lastNameRequired'] ?? false,
  1042|                         'errorMessage' => $settings['lastNameErrorMessage'] ?? null,
  1043|                         'placeholder' => $settings['lastNamePlaceholder'] ?? null,
  1044|                         'defaultValue' => $settings['lastNameDefaultValue'] ?? null,
  1045|                         'prePopulate' => $settings['lastNamePrePopulate'] ?? null,
  1046|                         'inputAttributes' => [
  1047|                             [
  1048|                                 'label' => 'autocomplete',
  1049|                                 'value' => 'family-name',
  1050|                             ],
  1051|                         ],
  1052|                     ],
  1053|                 ],
  1054|             ],
  1055|         ];
  1056|     }
  1057|     private function _generateOptions(int $start, int $end, ?string $placeholder = null): array
  1058|     {
  1059|         $options = [['value' => '', 'label' => $placeholder, 'disabled' => true]];
  1060|         for ($i = $start; $i <= $end; $i++) {
  1061|             $options[] = ['label' => $i, 'value' => $i];
  1062|         }
  1063|         return $options;
  1064|     }
  1065|     private function _getMonthOptions(?string $placeholder = null): array
  1066|     {
  1067|         $options = [['value' => '', 'label' => $placeholder, 'disabled' => true]];
  1068|         foreach (Craft::$app->getLocale()->getMonthNames() as $index => $monthName) {
  1069|             $options[] = ['value' => $index + 1, 'label' => $monthName];
  1070|         }
  1071|         return $options;
  1072|     }
  1073|     private function _cleanupOldTables(): void
  1074|     {
  1075|         $fields = (new Query())->from('{{%fields}}')->all();
  1076|         foreach ($fields as $field) {
  1077|             if (str_contains($field['context'], 'formie:') || str_contains($field['context'], 'formieField:')) {
  1078|                 $this->delete('{{%fields}}', ['id' => $field['id']]);
  1079|             }
  1080|         }
  1081|         $tables = [
  1082|             'formie_nested',
  1083|             'formie_nestedfieldrows',
  1084|             'formie_newlayout',
  1085|             'formie_newnestedlayout',
  1086|             'formie_pagesettings',
  1087|             'formie_rows',
  1088|             'formie_syncfields',
  1089|             'formie_syncs',
  1090|         ];
  1091|         foreach ($tables as $table) {
  1092|             $this->dropTableIfExists('{{%' . $table . '}}');
  1093|         }
  1094|         $fieldlayouts = (new Query())->from('{{%fieldlayouts}}')->all();
  1095|         $formTemplateLayoutIds = array_values(array_filter((new Query())->select('fieldLayoutId')->from(Table::FORMIE_FORM_TEMPLATES)->column()));
  1096|         foreach ($fieldlayouts as $fieldlayout) {
  1097|             if ($fieldlayout['type'] === 'verbb\formie\fields\formfields\Group') {
  1098|                 $this->delete('{{%fieldlayouts}}', ['id' => $fieldlayout['id']]);
  1099|             }
  1100|             if ($fieldlayout['type'] === 'verbb\formie\fields\formfields\Repeater') {
  1101|                 $this->delete('{{%fieldlayouts}}', ['id' => $fieldlayout['id']]);
  1102|             }
  1103|             if ($fieldlayout['type'] === 'verbb\formie\elements\Form') {
  1104|                 if (!in_array($fieldlayout['id'], $formTemplateLayoutIds)) {
  1105|                     $this->delete('{{%fieldlayouts}}', ['id' => $fieldlayout['id']]);
  1106|                 }
  1107|             }
  1108|         }
  1109|         foreach (Craft::$app->getDb()->schema->getTableNames() as $tableName) {
  1110|             if (str_starts_with($tableName, 'fmc_') || str_starts_with($tableName, 'fmcd_')) {
  1111|                 MigrationHelper::dropAllForeignKeysOnTable($tableName, $this);
  1112|                 $this->dropTableIfExists($tableName);
  1113|             }
  1114|         }
  1115|         if ($this->db->columnExists(Table::FORMIE_FORMS, 'fieldLayoutId')) {
  1116|             $this->dropColumn(Table::FORMIE_FORMS, 'fieldLayoutId');
  1117|         }
  1118|         if ($this->db->columnExists(Table::FORMIE_FORMS, 'fieldContentTable')) {
  1119|             $this->dropColumn(Table::FORMIE_FORMS, 'fieldContentTable');
  1120|         }
  1121|         if ($this->db->columnExists(Table::FORMIE_SUBMISSIONS, 'title')) {
  1122|             $this->dropColumn(Table::FORMIE_SUBMISSIONS, 'title');
  1123|         }
  1124|     }
  1125| }


# ====================================================================
# FILE: src/models/FieldLayout.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-181 ---
     1| <?php
     2| namespace verbb\formie\models;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\base\FieldInterface;
     6| use verbb\formie\base\NestedField;
     7| use verbb\formie\elements\Form;
     8| use verbb\formie\elements\Submission;
     9| use verbb\formie\helpers\ArrayHelper;
    10| use Craft;
    11| use craft\base\ElementInterface;
    12| use craft\base\FieldLayoutElement;
    13| use craft\base\SavableComponent;
    14| use craft\fieldlayoutelements\CustomField;
    15| use craft\helpers\Json;
    16| use craft\models\FieldLayout as CraftFieldLayout;
    17| use craft\models\FieldLayoutTab;
    18| use DateTime;
    19| class FieldLayout extends SavableComponent
    20| {
    21|     public ?string $uid = null;
    22|     public ?string $type = null;
    23|     private array $_deletedItems = [];
    24|     private array $_pages = [];
    25|     public function __construct(mixed $config = [])
    26|     {
    27|         if (!isset($config['pages'])) {
    28|             $config['pages'] = [
    29|                 [
    30|                     'label' => Craft::t('formie', 'Page 1'),
    31|                     'settings' => [],
    32|                     'rows' => [],
    33|                 ],
    34|             ];
    35|         }
    36|         parent::__construct($config);
    37|     }
    38|     public function getForm(): ?Form
    39|     {
    40|         if ($this->_form || !$this->layoutId) {
    41|             return $this->_form;
    42|         }
    43|         return $this->_form = Formie::$plugin->getForms()->getFormByLayoutId($this->layoutId);
    44|     }
    45|     public function getPages(): array
    46|     {
    47|         return $this->_pages;
    48|     }
    49|     public function setPages(array $pages): void
    50|     {
    51|         $this->_pages = [];
    52|         foreach ($pages as $page) {
    53|             $this->_pages[] = (!($page instanceof FieldLayoutPage)) ? new FieldLayoutPage($page) : $page;
    54|         }
    55|     }
    56|     public function getRows(bool $includeDisabled = true): array
    57|     {
    58|         $rows = [];
    59|         foreach ($this->getPages() as $page) {
    60|             foreach ($page->getRows($includeDisabled) as $row) {
    61|                 $rows[] = $row;
    62|             }
    63|         }
    64|         return $rows;
    65|     }
    66|     public function getFields(bool $includeDisabled = true): array
    67|     {
    68|         $fields = [];
    69|         foreach ($this->getPages() as $page) {
    70|             foreach ($page->getRows($includeDisabled) as $row) {
    71|                 foreach ($row->getFields($includeDisabled) as $field) {
    72|                     $fields[] = $field;
    73|                 }
    74|             }
    75|         }
    76|         return $fields;
    77|     }
    78|     public function getFieldByHandle(string $handle): ?FieldInterface
    79|     {
    80|         $foundField = null;
    81|         foreach ($this->getFields() as $field) {
    82|             if ($field->handle === $handle) {
    83|                 $foundField = $field;
    84|             }
    85|         }
    86|         return $foundField;
    87|     }
    88|     public function getCustomFields(): array
    89|     {
    90|         Craft::$app->getDeprecator()->log(__METHOD__, 'Layout’s `getCustomFields()` method has been deprecated. Use `getFields()` instead.');
    91|         return $this->getFields();
    92|     }
    93|     public function getDeletedItems(): array
    94|     {
    95|         return $this->_deletedItems;
    96|     }
    97|     public function setDeletedItems(array $deletedItems): void
    98|     {
    99|         $this->_deletedItems = $deletedItems;
   100|     }
   101|     public function getFieldLayout(): CraftFieldLayout
   102|     {
   103|         $config = ['type' => Submission::class];
   104|         foreach ($this->getPages() as $page) {
   105|             $tab = [
   106|                 'name' => $page->label,
   107|             ];
   108|             foreach ($page->getFields() as $field) {
   109|                 $tab['elements'][] = [
   110|                     'label' => $field->label,
   111|                     'attribute' => $field->handle,
   112|                     'type' => "craft\\fieldlayoutelements\\TextField",
   113|                 ];
   114|             }
   115|             $config['tabs'][] = $tab;
   116|         }
   117|         return CraftFieldLayout::createFromConfig($config);
   118|     }
   119|     public function getFormBuilderConfig(): array
   120|     {
   121|         return array_map(function($page) {
   122|             return $page->getFormBuilderConfig();
   123|         }, $this->getPages());
   124|     }
   125|     public function validatePages(): void
   126|     {
   127|         foreach ($this->getPages() as $page) {
   128|             if (!$page->validate()) {
   129|                 $this->addError('pages', $page->getErrors());
   130|             }
   131|         }
   132|     }
   133|     public function getVisiblePageFields(ElementInterface $element): array
   134|     {
   135|         $currentPageFields = $element->getForm()?->getCurrentPage()?->getFields() ?? [];
   136|         $currentPageFieldHandles = ArrayHelper::getColumn($currentPageFields, 'handle');
   137|         return array_filter($this->getFields(), function($field) use ($element, $currentPageFieldHandles) {
   138|             if ($element instanceof Submission && $element->validateCurrentPageOnly) {
   139|                 if (!in_array($field->handle, $currentPageFieldHandles)) {
   140|                     return false;
   141|                 }
   142|             }
   143|             if ($field->isConditionallyHidden($element)) {
   144|                 return false;
   145|             }
   146|             return true;
   147|         });
   148|     }
   149|     public function getErrorsTree(): array
   150|     {
   151|         $errors = [];
   152|         foreach ($this->getPages() as $page) {
   153|             foreach ($page->getFields() as $field) {
   154|                 $this->_collectErrorsRecursive($field, $page->handle, $errors);
   155|             }
   156|         }
   157|         return $errors;
   158|     }
   159|     protected function defineRules(): array
   160|     {
   161|         $rules = parent::defineRules();
   162|         $rules[] = [['pages'], 'validatePages'];
   163|         return $rules;
   164|     }
   165|     private function _collectErrorsRecursive($field, string $prefix, array &$errors): void
   166|     {
   167|         if ($fieldErrors = $field->getErrors()) {
   168|             foreach ($fieldErrors as $errorKey => $error) {
   169|                 if (str_contains($errorKey, 'pages.')) {
   170|                     continue;
   171|                 }
   172|                 $errors[$prefix . '.' . $field->handle . '.' . $errorKey] = $error;
   173|             }
   174|         }
   175|         if ($field instanceof NestedField) {
   176|             foreach ($field->getFields() as $childField) {
   177|                 $this->_collectErrorsRecursive($childField, $prefix . '.' . $field->handle, $errors);
   178|             }
   179|         }
   180|     }
   181| }


# ====================================================================
# FILE: src/models/Settings.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-151 ---
     1| <?php
     2| namespace verbb\formie\models;
     3| use verbb\formie\Formie;
     4| use verbb\formie\elements\Submission;
     5| use verbb\formie\positions\AboveInput;
     6| use Craft;
     7| use craft\base\Model;
     8| use craft\helpers\App;
     9| use craft\helpers\DateTimeHelper;
    10| use craft\helpers\FileHelper;
    11| use yii\validators\EmailValidator;
    12| use DateTime;
    13| class Settings extends Model
    14| {
    15|     public const SPAM_BEHAVIOUR_SUCCESS = 'showSuccess';
    16|     public const SPAM_BEHAVIOUR_MESSAGE = 'showMessage';
    17|     public string $pluginName = 'Formie';
    18|     public string $defaultPage = 'forms';
    19|     public bool $validateCustomTemplates = true; // Allow power users to handle form template path checks on their own
    20|     public string $defaultFormTemplate = '';
    21|     public string $defaultEmailTemplate = '';
    22|     public bool $enableUnloadWarning = true;
    23|     public bool $enableBackSubmission = true;
    24|     public int $ajaxTimeout = 10;
    25|     public bool $filterIntegrationMapping = true;
    26|     public bool $includeDraftElementUsage = false;
    27|     public bool $includeRevisionElementUsage = false;
    28|     public array $disabledFields = [];
    29|     public string $defaultLabelPosition = AboveInput::class;
    30|     public string $defaultInstructionsPosition = AboveInput::class;
    31|     public string $defaultFileUploadVolume = '';
    32|     public string $defaultDateDisplayType = 'calendar';
    33|     public string $defaultDateValueOption = '';
    34|     public ?DateTime $defaultDateTime = null;
    35|     public bool $enableLargeFieldStorage = false;
    36|     public int $maxIncompleteSubmissionAge = 30;
    37|     public bool $enableCsrfValidationForGuests = true;
    38|     public bool $useQueueForNotifications = true;
    39|     public bool $useQueueForIntegrations = true;
    40|     public ?int $queuePriority = null;
    41|     public bool $setOnlyCurrentPagePayload = false;
    42|     public string $submissionsBehaviour = 'all';
    43|     public bool $sentNotifications = true;
    44|     public int $maxSentNotificationsAge = 30;
    45|     public bool $saveSpam = true;
    46|     public int $spamLimit = 500;
    47|     public bool $spamEmailNotifications = false;
    48|     public string $spamBehaviour = self::SPAM_BEHAVIOUR_SUCCESS;
    49|     public string $spamKeywords = '';
    50|     public string $spamBehaviourMessage = '';
    51|     public bool $sendEmailAlerts = false;
    52|     public ?array $alertEmails = null;
    53|     public string $emptyValuePlaceholder = 'No response.';
    54|     public string $pdfPaperSize = 'letter';
    55|     public string $pdfPaperOrientation = 'portrait';
    56|     public array $themeConfig = [];
    57|     public bool $useCssLayers = false;
    58|     public array $captchas = [];
    59|     public string $defaultExportFolder = '@storage/formie-export';
    60|     public function __construct($config = [])
    61|     {
    62|         unset($config['enableGatsbyCompatibility']);
    63|         if (isset($config['submissionsBehaviour']) && is_array($config['submissionsBehaviour'])) {
    64|             $config['submissionsBehaviour'] = 'all';
    65|         }
    66|         parent::__construct($config);
    67|     }
    68|     public function setAttributes($values, $safeOnly = true): void
    69|     {
    70|         if (isset($values['submissionsBehaviour']) && is_array($values['submissionsBehaviour'])) {
    71|             $values['submissionsBehaviour'] = 'all';
    72|         }
    73|         parent::setAttributes($values, $safeOnly);
    74|     }
    75|     public function validateAlertEmails($attribute): void
    76|     {
    77|         if ($this->sendEmailAlerts) {
    78|             if (empty($this->alertEmails)) {
    79|                 $this->addError($attribute, Craft::t('formie', 'You must enter at least one name and email.'));
    80|                 return;
    81|             }
    82|             foreach ($this->alertEmails as $fromNameEmail) {
    83|                 if ($fromNameEmail[0] === '' || $fromNameEmail[1] === '') {
    84|                     $this->addError($attribute, Craft::t('formie', 'The name and email cannot be blank.'));
    85|                     return;
    86|                 }
    87|                 $emailValidator = new EmailValidator();
    88|                 if (!$emailValidator->validate($fromNameEmail[1])) {
    89|                     $this->addError($attribute, Craft::t('formie', 'An invalid email was entered.'));
    90|                     return;
    91|                 }
    92|             }
    93|         }
    94|     }
    95|     public function getDefaultFormTemplateId(): ?int
    96|     {
    97|         if ($template = Formie::$plugin->getFormTemplates()->getTemplateByHandle($this->defaultFormTemplate)) {
    98|             return $template->id;
    99|         }
   100|         return null;
   101|     }
   102|     public function getDefaultEmailTemplateId(): ?int
   103|     {
   104|         if ($template = Formie::$plugin->getEmailTemplates()->getTemplateByHandle($this->defaultEmailTemplate)) {
   105|             return $template->id;
   106|         }
   107|         return null;
   108|     }
   109|     public function getDefaultDateTimeValue(): ?DateTime
   110|     {
   111|         if ($defaultDateTime = DateTimeHelper::toDateTime($this->defaultDateTime)) {
   112|             return $this->defaultDateTime = $defaultDateTime;
   113|         }
   114|         return null;
   115|     }
   116|     public function shouldSaveSpam(Submission $submission): bool
   117|     {
   118|         if ($this->saveSpam) {
   119|             if ($captcha = $submission->getSpamCaptcha()) {
   120|                 if ($captcha->saveSpam === false) {
   121|                     return false;
   122|                 }
   123|             }
   124|             return true;
   125|         }
   126|         return false;
   127|     }
   128|     public function getSecurityKey(): string
   129|     {
   130|         if ($securityKey = App::env('FORMIE_SECURITY_KEY')) {
   131|             return $securityKey;
   132|         }
   133|         return Craft::$app->getConfig()->getGeneral()->securityKey;
   134|     }
   135|     protected function defineRules(): array
   136|     {
   137|         $rules = parent::defineRules();
   138|         $rules[] = [['pluginName', 'defaultPage', 'maxIncompleteSubmissionAge', 'maxSentNotificationsAge'], 'required'];
   139|         $rules[] = [['pluginName'], 'string', 'max' => 52];
   140|         $rules[] = [['maxIncompleteSubmissionAge', 'maxSentNotificationsAge'], 'number', 'integerOnly' => true];
   141|         $rules[] = [['alertEmails'], 'validateAlertEmails'];
   142|         return $rules;
   143|     }
   144|     public function getAbsoluteDefaultExportFolder(): ?string
   145|     {
   146|         $path = Craft::getAlias( $this->defaultExportFolder );
   147|         $exportFolder = FileHelper::normalizePath($path);
   148|         FileHelper::createDirectory($exportFolder);
   149|         return $exportFolder;
   150|     }
   151| }


# ====================================================================
# FILE: src/services/Fields.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-1044 ---
     1| <?php
     2| namespace verbb\formie\services;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Field;
     5| use verbb\formie\base\FieldInterface;
     6| use verbb\formie\base\NestedFieldInterface;
     7| use verbb\formie\base\SubFieldInterface;
     8| use verbb\formie\base\SubFieldInnerFieldInterface;
     9| use verbb\formie\elements\Form;
    10| use verbb\formie\events\ModifyExistingFieldsEvent;
    11| use verbb\formie\events\ModifyFieldConfigEvent;
    12| use verbb\formie\events\ModifyFieldRowConfigEvent;
    13| use verbb\formie\events\RegisterFieldsEvent;
    14| use verbb\formie\events\RegisterFieldOptionsEvent;
    15| use verbb\formie\fields as formiefields;
    16| use verbb\formie\helpers\ArrayHelper;
    17| use verbb\formie\helpers\Plugin;
    18| use verbb\formie\helpers\Table;
    19| use verbb\formie\integrations\feedme\elementfields as FeedMeElementField;
    20| use verbb\formie\integrations\feedme\fields as FeedMeField;
    21| use verbb\formie\models\FieldLayout;
    22| use verbb\formie\models\FieldLayoutPage;
    23| use verbb\formie\models\FieldLayoutRow;
    24| use verbb\formie\positions\AboveInput;
    25| use verbb\formie\positions\BelowInput;
    26| use verbb\formie\positions\LeftInput;
    27| use verbb\formie\positions\RightInput;
    28| use verbb\formie\positions\Hidden as HiddenPosition;
    29| use verbb\formie\records\FieldLayout as FieldLayoutRecord;
    30| use verbb\formie\records\FieldLayoutPage as FieldLayoutPageRecord;
    31| use verbb\formie\records\FieldLayoutRow as FieldLayoutRowRecord;
    32| use verbb\formie\records\Field as FieldRecord;
    33| use Craft;
    34| use craft\base\Component;
    35| use craft\base\Field as CraftField;
    36| use craft\base\FieldInterface as CraftFieldInterface;
    37| use craft\db\Query;
    38| use craft\errors\MissingComponentException;
    39| use craft\fields\BaseRelationField;
    40| use craft\fields\PlainText;
    41| use craft\helpers\Component as ComponentHelper;
    42| use craft\helpers\Db;
    43| use craft\validators\HandleValidator;
    44| use Exception;
    45| use ReflectionClass;
    46| use ReflectionException;
    47| use Throwable;
    48| use yii\base\InvalidConfigException;
    49| class Fields extends Component
    50| {
    51|     public static function getFieldHandles(): array
    52|     {
    53|         return Craft::$app->getCache()->getOrSet('formie:fieldHandles', function() {
    54|             return (new Query())->select(['handle', 'uid'])->from(Table::FORMIE_FIELDS)->indexBy('uid')->column();
    55|         });
    56|     }
    57|     public static function resetFieldHandles(): void
    58|     {
    59|         Craft::$app->getCache()->delete('formie:fieldHandles');
    60|     }
    61|     public const EVENT_MODIFY_EXISTING_FIELDS = 'modifyExistingFields';
    62|     public const EVENT_BEFORE_SAVE_FIELD_ROW = 'beforeSaveFieldRow';
    63|     public const EVENT_AFTER_SAVE_FIELD_ROW = 'afterSaveFieldRow';
    64|     public const EVENT_BEFORE_SAVE_FIELD_PAGE = 'beforeSaveFieldPage';
    65|     public const EVENT_AFTER_SAVE_FIELD_PAGE = 'afterSaveFieldPage';
    66|     public const EVENT_REGISTER_FIELDS = 'registerFields';
    67|     public const EVENT_REGISTER_LABEL_POSITIONS = 'registerLabelPositions';
    68|     public const EVENT_REGISTER_INSTRUCTIONS_POSITIONS = 'registerInstructionsPositions';
    69|     private array $_layouts = [];
    70|     private array $_fields = [];
    71|     private array $_fieldsForForm = [];
    72|     private array $_registeredFields = [];
    73|     private array $_existingFields = [];
    74|     public function getRegisteredFields(bool $excludeDisabled = true): array
    75|     {
    76|         if (count($this->_registeredFields)) {
    77|             return $this->_registeredFields;
    78|         }
    79|         $settings = Formie::$plugin->getSettings();
    80|         $disabledFields = $settings->disabledFields;
    81|         $fields = [
    82|             formiefields\Address::class,
    83|             formiefields\Agree::class,
    84|             formiefields\Calculations::class,
    85|             formiefields\Categories::class,
    86|             formiefields\Checkboxes::class,
    87|             formiefields\Date::class,
    88|             formiefields\Dropdown::class,
    89|             formiefields\Email::class,
    90|             formiefields\Entries::class,
    91|             formiefields\FileUpload::class,
    92|             formiefields\Group::class,
    93|             formiefields\Heading::class,
    94|             formiefields\Hidden::class,
    95|             formiefields\Html::class,
    96|             formiefields\MissingField::class,
    97|             formiefields\MultiLineText::class,
    98|             formiefields\Name::class,
    99|             formiefields\Number::class,
   100|             formiefields\Payment::class,
   101|             formiefields\Password::class,
   102|             formiefields\Phone::class,
   103|             formiefields\Radio::class,
   104|             formiefields\Recipients::class,
   105|             formiefields\Repeater::class,
   106|             formiefields\Section::class,
   107|             formiefields\Signature::class,
   108|             formiefields\SingleLineText::class,
   109|             formiefields\Summary::class,
   110|             formiefields\Table::class,
   111|             formiefields\Tags::class,
   112|             formiefields\subfields\AddressAutoComplete::class,
   113|             formiefields\subfields\Address1::class,
   114|             formiefields\subfields\Address2::class,
   115|             formiefields\subfields\Address3::class,
   116|             formiefields\subfields\AddressCity::class,
   117|             formiefields\subfields\AddressZip::class,
   118|             formiefields\subfields\AddressState::class,
   119|             formiefields\subfields\AddressCountry::class,
   120|             formiefields\subfields\DateYearDropdown::class,
   121|             formiefields\subfields\DateMonthDropdown::class,
   122|             formiefields\subfields\DateDayDropdown::class,
   123|             formiefields\subfields\DateHourDropdown::class,
   124|             formiefields\subfields\DateMinuteDropdown::class,
   125|             formiefields\subfields\DateSecondDropdown::class,
   126|             formiefields\subfields\DateAmPmDropdown::class,
   127|             formiefields\subfields\DateYearNumber::class,
   128|             formiefields\subfields\DateMonthNumber::class,
   129|             formiefields\subfields\DateDayNumber::class,
   130|             formiefields\subfields\DateHourNumber::class,
   131|             formiefields\subfields\DateMinuteNumber::class,
   132|             formiefields\subfields\DateSecondNumber::class,
   133|             formiefields\subfields\DateAmPmNumber::class,
   134|             formiefields\subfields\NamePrefix::class,
   135|             formiefields\subfields\NameFirst::class,
   136|             formiefields\subfields\NameMiddle::class,
   137|             formiefields\subfields\NameLast::class,
   138|         ];
   139|         if (Craft::$app->getEdition() !== Craft::Solo) {
   140|             $fields = array_merge($fields, [
   141|                 formiefields\Users::class,
   142|             ]);
   143|         }
   144|         if (Plugin::isPluginInstalledAndEnabled('commerce')) {
   145|             $fields = array_merge($fields, [
   146|                 formiefields\Products::class,
   147|                 formiefields\Variants::class,
   148|             ]);
   149|         }
   150|         $event = new RegisterFieldsEvent([
   151|             'fields' => $fields,
   152|         ]);
   153|         $this->trigger(self::EVENT_REGISTER_FIELDS, $event);
   154|         $event->fields[] = formiefields\MissingField::class;
   155|         $event->fields = array_unique($event->fields);
   156|         foreach ($event->fields as $class) {
   157|             if ($excludeDisabled && in_array($class, $disabledFields)) {
   158|                 continue;
   159|             }
   160|             $this->_registeredFields[$class] = new $class;
   161|         }
   162|         return $this->_registeredFields;
   163|     }
   164|     public function getFormBuilderFieldTypes(): array
   165|     {
   166|         $registeredFields = $this->getRegisteredFields();
   167|         $internalFields = array_filter([
   168|             ArrayHelper::remove($registeredFields, formiefields\MissingField::class),
   169|         ]);
   170|         $commonFields = array_filter([
   171|             ArrayHelper::remove($registeredFields, formiefields\SingleLineText::class),
   172|             ArrayHelper::remove($registeredFields, formiefields\MultiLineText::class),
   173|             ArrayHelper::remove($registeredFields, formiefields\Radio::class),
   174|             ArrayHelper::remove($registeredFields, formiefields\Checkboxes::class),
   175|             ArrayHelper::remove($registeredFields, formiefields\Dropdown::class),
   176|             ArrayHelper::remove($registeredFields, formiefields\Number::class),
   177|             ArrayHelper::remove($registeredFields, formiefields\Name::class),
   178|             ArrayHelper::remove($registeredFields, formiefields\Email::class),
   179|             ArrayHelper::remove($registeredFields, formiefields\Phone::class),
   180|             ArrayHelper::remove($registeredFields, formiefields\Agree::class),
   181|         ]);
   182|         $advancedFields = array_filter([
   183|             ArrayHelper::remove($registeredFields, formiefields\Date::class),
   184|             ArrayHelper::remove($registeredFields, formiefields\Address::class),
   185|             ArrayHelper::remove($registeredFields, formiefields\FileUpload::class),
   186|             ArrayHelper::remove($registeredFields, formiefields\Recipients::class),
   187|             ArrayHelper::remove($registeredFields, formiefields\Hidden::class),
   188|             ArrayHelper::remove($registeredFields, formiefields\Repeater::class),
   189|             ArrayHelper::remove($registeredFields, formiefields\Table::class),
   190|             ArrayHelper::remove($registeredFields, formiefields\Group::class),
   191|             ArrayHelper::remove($registeredFields, formiefields\Heading::class),
   192|             ArrayHelper::remove($registeredFields, formiefields\Section::class),
   193|             ArrayHelper::remove($registeredFields, formiefields\Html::class),
   194|             ArrayHelper::remove($registeredFields, formiefields\Summary::class),
   195|             ArrayHelper::remove($registeredFields, formiefields\Password::class),
   196|             ArrayHelper::remove($registeredFields, formiefields\Signature::class),
   197|             ArrayHelper::remove($registeredFields, formiefields\Calculations::class),
   198|             ArrayHelper::remove($registeredFields, formiefields\Payment::class),
   199|         ]);
   200|         $elementFields = array_filter([
   201|             ArrayHelper::remove($registeredFields, formiefields\Entries::class),
   202|             ArrayHelper::remove($registeredFields, formiefields\Categories::class),
   203|             ArrayHelper::remove($registeredFields, formiefields\Tags::class),
   204|         ]);
   205|         if (Craft::$app->getEdition() !== Craft::Solo) {
   206|             $elementFields = array_merge($elementFields, array_filter([
   207|                 ArrayHelper::remove($registeredFields, formiefields\Users::class),
   208|             ]));
   209|         }
   210|         if (Plugin::isPluginInstalledAndEnabled('commerce')) {
   211|             $elementFields = array_merge($elementFields, array_filter([
   212|                 ArrayHelper::remove($registeredFields, formiefields\Products::class),
   213|                 ArrayHelper::remove($registeredFields, formiefields\Variants::class),
   214|             ]));
   215|         }
   216|         $groupedFields = [];
   217|         if ($internalFields) {
   218|             $groupedFields[] = [
   219|                 'label' => Craft::t('formie', 'Internal'),
   220|                 'handle' => 'internal',
   221|                 'fields' => array_values($internalFields),
   222|             ];
   223|         }
   224|         if ($commonFields) {
   225|             $groupedFields[] = [
   226|                 'label' => Craft::t('formie', 'Common Fields'),
   227|                 'handle' => 'common',
   228|                 'fields' => array_values($commonFields),
   229|             ];
   230|         }
   231|         if ($advancedFields) {
   232|             $groupedFields[] = [
   233|                 'label' => Craft::t('formie', 'Advanced Fields'),
   234|                 'handle' => 'advanced',
   235|                 'fields' => array_values($advancedFields),
   236|             ];
   237|         }
   238|         if ($elementFields) {
   239|             $groupedFields[] = [
   240|                 'label' => Craft::t('formie', 'Element Fields'),
   241|                 'handle' => 'element',
   242|                 'fields' => array_values($elementFields),
   243|             ];
   244|         }
   245|         if ($registeredFields) {
   246|             $groupedFields[] = [
   247|                 'label' => Craft::t('formie', 'Custom Fields'),
   248|                 'handle' => 'custom',
   249|                 'fields' => array_values($registeredFields),
   250|             ];
   251|         }
   252|         foreach ($groupedFields as $groupKey => $group) {
   253|             foreach ($group['fields'] as $fieldKey => $class) {
   254|                 $groupedFields[$groupKey]['fields'][$fieldKey] = $class->getFieldTypeConfig();
   255|             }
   256|         }
   257|         return $groupedFields;
   258|     }
   259|     public function getRegisteredFormieFields(): array
   260|     {
   261|         $fields = [];
   262|         $fields[] = FeedMeField\Address::class;
   263|         $fields[] = FeedMeField\Agree::class;
   264|         $fields[] = FeedMeField\Categories::class;
   265|         $fields[] = FeedMeField\Checkboxes::class;
   266|         $fields[] = FeedMeField\Date::class;
   267|         $fields[] = FeedMeField\Dropdown::class;
   268|         $fields[] = FeedMeField\Email::class;
   269|         $fields[] = FeedMeField\Entries::class;
   270|         $fields[] = FeedMeField\FileUpload::class;
   271|         $fields[] = FeedMeField\Group::class;
   272|         $fields[] = FeedMeField\Hidden::class;
   273|         $fields[] = FeedMeField\MultiLineText::class;
   274|         $fields[] = FeedMeField\Name::class;
   275|         $fields[] = FeedMeField\Number::class;
   276|         $fields[] = FeedMeField\Password::class;
   277|         $fields[] = FeedMeField\Phone::class;
   278|         $fields[] = FeedMeField\Radio::class;
   279|         $fields[] = FeedMeField\Repeater::class;
   280|         $fields[] = FeedMeField\SingleLineText::class;
   281|         $fields[] = FeedMeField\Table::class;
   282|         $fields[] = FeedMeField\Tags::class;
   283|         if (Craft::$app->getEdition() !== Craft::Solo) {
   284|             $fields[] = FeedMeField\Users::class;
   285|         }
   286|         if (Plugin::isPluginInstalledAndEnabled('commerce')) {
   287|             $fields[] = FeedMeField\Products::class;
   288|             $fields[] = FeedMeField\Variants::class;
   289|         }
   290|         $fields[] = FeedMeElementField\Forms::class;
   291|         return $fields;
   292|     }
   293|     public function getExistingFields(Form $excludeForm = null): array
   294|     {
   295|         if ($this->_existingFields) {
   296|             return $this->_existingFields;
   297|         }
   298|         $query = Form::find()->orderBy('title ASC');
   299|         if ($excludeForm) {
   300|             $query = $query->id("not {$excludeForm->id}");
   301|         }
   302|         /* @var Form[] $forms */
   303|         $forms = $query->all();
   304|         $allFields = [];
   305|         $existingFields = [];
   306|         foreach ($forms as $form) {
   307|             $formPages = [];
   308|             foreach ($form->getPages() as $page) {
   309|                 $pageFields = [];
   310|                 $fields = $page->getFields();
   311|                 ArrayHelper::multisort($fields, 'label', SORT_ASC, SORT_STRING);
   312|                 foreach ($fields as $field) {
   313|                     if ($field->isSynced && ArrayHelper::contains($allFields, 'id', $field->id)) {
   314|                         continue;
   315|                     }
   316|                     $pageFields[] = $allFields[] = $field->getFormBuilderConfig();
   317|                 }
   318|                 $formPages[] = [
   319|                     'label' => $page->label,
   320|                     'fields' => $pageFields,
   321|                 ];
   322|             }
   323|             $existingFields[] = [
   324|                 'key' => $form->handle,
   325|                 'label' => $form->title,
   326|                 'pages' => $formPages,
   327|             ];
   328|         }
   329|         ArrayHelper::multisort($allFields, 'label', SORT_ASC, SORT_STRING);
   330|         array_unshift($existingFields, [
   331|             'key' => '*',
   332|             'label' => Craft::t('formie', 'All forms'),
   333|             'pages' => [
   334|                 [
   335|                     'label' => Craft::t('formie', 'All fields'),
   336|                     'fields' => $allFields,
   337|                 ],
   338|             ],
   339|         ]);
   340|         $event = new ModifyExistingFieldsEvent([
   341|             'fields' => $existingFields,
   342|         ]);
   343|         $this->trigger(self::EVENT_MODIFY_EXISTING_FIELDS, $event);
   344|         return $this->_existingFields = $event->fields;
   345|     }
   346|     public function createField(array $config = []): FieldInterface
   347|     {
   348|         if (is_string($config)) {
   349|             $config = ['type' => $config];
   350|         }
   351|         if ($config['type'] === formiefields\MissingField::class) {
   352|             $config = [
   353|                 'type' => $config['settings']['expectedType'],
   354|                 'settings' => $config['settings']['settings'] ?? [],
   355|             ];
   356|         }
   357|         try {
   358|             $field = ComponentHelper::createComponent($config, FieldInterface::class);
   359|         } catch (MissingComponentException $e) {
   360|             $config['errorMessage'] = $e->getMessage();
   361|             $config['expectedType'] = $config['type'];
   362|             unset($config['type']);
   363|             $field = new formiefields\MissingField($config);
   364|         }
   365|         $field->afterCreateField($config);
   366|         return $field;
   367|     }
   368|     public function getAllLayouts(): array
   369|     {
   370|         if ($this->_layouts) {
   371|             return $this->_layouts;
   372|         }
   373|         $layouts = [];
   374|         $layoutIds = (new Query())
   375|             ->select(['id'])
   376|             ->from(Table::FORMIE_FIELD_LAYOUTS)
   377|             ->column();
   378|         foreach ($layoutIds as $layoutId) {
   379|             $layouts[] = $this->getLayoutById($layoutId);
   380|         }
   381|         return $this->_layouts = $layouts;
   382|     }
   383|     public function getAllFields(): array
   384|     {
   385|         if ($this->_fields) {
   386|             return $this->_fields;
   387|         }
   388|         $fields = [];
   389|         $fieldRecords = (new Query())->from(Table::FORMIE_FIELDS)->all();
   390|         foreach ($fieldRecords as $fieldRecord) {
   391|             $fields[] = Formie::$plugin->getFields()->createField($fieldRecord);
   392|         }
   393|         return $this->_fields = $fields;
   394|     }
   395|     public function getAllFieldsForForm(int $formId): array
   396|     {
   397|         if (isset($this->_fieldsForForm[$formId])) {
   398|             return $this->_fieldsForForm[$formId];
   399|         }
   400|         $fields = [];
   401|         $fieldRecords = (new Query())
   402|             ->select(['f.*'])
   403|             ->from(['f' => Table::FORMIE_FIELDS])
   404|             ->innerJoin(['ff' => Table::FORMIE_FORMS], '[[f.layoutId]] = [[ff.layoutId]]')
   405|             ->where(['ff.id' => $formId])
   406|             ->all();
   407|         foreach ($fieldRecords as $fieldRecord) {
   408|             $fields[] = Formie::$plugin->getFields()->createField($fieldRecord);
   409|         }
   410|         return $this->_fieldsForForm[$formId] = $fields;
   411|     }
   412|     public function getLayoutById(int $id): ?FieldLayout
   413|     {
   414|         return $this->_getLayout(['l.id' => $id]);
   415|     }
   416|     public function getPageById(int $id): ?FieldLayoutPage
   417|     {
   418|         return $this->_getPage(['p.id' => $id]);
   419|     }
   420|     public function getRowById(int $id): ?FieldLayoutRow
   421|     {
   422|         return $this->_getRow(['r.id' => $id]);
   423|     }
   424|     public function getFieldById(int $id): ?FieldInterface
   425|     {
   426|         $fieldRecord = FieldRecord::findOne(['id' => $id])?->attributes ?? [];
   427|         return $fieldRecord ? $this->createField($fieldRecord) : null;
   428|     }
   429|     public function getFieldByHandle(string $handle): ?FieldInterface
   430|     {
   431|         $fieldRecord = FieldRecord::findOne(['handle' => $handle])?->attributes ?? [];
   432|         return $fieldRecord ? $this->createField($fieldRecord) : null;
   433|     }
   434|     public function saveLayout(FieldLayout $layout): bool
   435|     {
   436|         $isNewLayout = !$layout->id;
   437|         if (!$layout->beforeSave($isNewLayout)) {
   438|             return false;
   439|         }
   440|         if (!$layout->validate()) {
   441|             return false;
   442|         }
   443|         if (!$isNewLayout) {
   444|             $layoutRecord = FieldLayoutRecord::find()
   445|                 ->andWhere(['id' => $layout->id])
   446|                 ->one();
   447|             if (!$layoutRecord) {
   448|                 throw new Exception('Invalid field layout ID: ' . $layout->id);
   449|             }
   450|         } else {
   451|             $layoutRecord = new FieldLayoutRecord();
   452|         }
   453|         $layoutRecord->id = $layout->id;
   454|         $layoutRecord->save(false);
   455|         $layout->id = $layoutRecord->id;
   456|         $layout->afterSave($isNewLayout);
   457|         $transaction = Craft::$app->getDb()->beginTransaction();
   458|         $previousPages = unserialize(serialize($layout->getPages()));
   459|         foreach ($layout->getPages() as $pageKey => $page) {
   460|             $page->layoutId = $layout->id;
   461|             $page->sortOrder = $pageKey;
   462|             if (!$this->savePage($page)) {
   463|                 $transaction->rollBack();
   464|                 foreach ($previousPages as $pageKey => $page) {
   465|                     $currentPage = $layout->getPages()[$pageKey] ?? null;
   466|                     $currentPageErrors = $currentPage->errors ?? [];
   467|                     if ($currentPageErrors) {
   468|                         $page->addErrors($currentPageErrors);
   469|                     }
   470|                     foreach ($page->getRows() as $rowKey => $row) {
   471|                         $currentRow = $currentPage->getRows()[$rowKey] ?? null;
   472|                         $currentRowErrors = $currentRow->errors ?? [];
   473|                         if ($currentPageErrors) {
   474|                             $row->addErrors($currentRowErrors);
   475|                             $page->addError('rows', $currentRowErrors);
   476|                         }
   477|                         foreach ($row->getFields() as $fieldKey => $field) {
   478|                             $currentField = $currentRow->getFields()[$fieldKey] ?? null;
   479|                             $currentFieldErrors = $currentField->errors ?? [];
   480|                             if ($currentFieldErrors) {
   481|                                 $field->addErrors($currentFieldErrors);
   482|                                 $row->addError('fields', $currentFieldErrors);
   483|                                 $page->addError('rows', $currentFieldErrors);
   484|                             }
   485|                         }
   486|                     }
   487|                 }
   488|                 $layout->setPages($previousPages);
   489|                 return false;
   490|             }
   491|             $newPageIds[] = $page->id;
   492|         }
   493|         $transaction->commit();
   494|         if ($deletedItems = $layout->getDeletedItems()) {
   495|             foreach (($deletedItems['fields'] ?? []) as $id) {
   496|                 $this->deleteFieldById($id);
   497|             }
   498|             foreach (($deletedItems['rows'] ?? []) as $id) {
   499|                 $this->deleteRowById($id);
   500|             }
   501|             foreach (($deletedItems['pages'] ?? []) as $id) {
   502|                 $this->deletePageById($id);
   503|             }
   504|         }
   505|         return true;
   506|     }
   507|     public function deleteLayoutById(int $id): bool
   508|     {
   509|         $layout = $this->getLayoutById($id);
   510|         if (!$layout) {
   511|             return false;
   512|         }
   513|         return $this->deleteLayout($layout);
   514|     }
   515|     public function deleteLayout(FieldLayout $layout): bool
   516|     {
   517|         if (!$layout->beforeDelete()) {
   518|             return false;
   519|         }
   520|         Db::delete(Table::FORMIE_FIELD_LAYOUTS, ['id' => $layout->id]);
   521|         $layout->afterDelete();
   522|         return true;
   523|     }
   524|     public function savePage(FieldLayoutPage $page): bool
   525|     {
   526|         $isNewPage = !$page->id;
   527|         if (!$page->beforeSave($isNewPage)) {
   528|             return false;
   529|         }
   530|         if (!$page->validate()) {
   531|             return false;
   532|         }
   533|         if (!$isNewPage) {
   534|             $pageRecord = FieldLayoutPageRecord::find()
   535|                 ->andWhere(['id' => $page->id])
   536|                 ->one();
   537|             if (!$pageRecord) {
   538|                 throw new Exception('Invalid field page ID: ' . $page->id);
   539|             }
   540|         } else {
   541|             $pageRecord = new FieldLayoutPageRecord();
   542|         }
   543|         $pageRecord->id = $page->id;
   544|         $pageRecord->layoutId = $page->layoutId;
   545|         $pageRecord->label = $page->label;
   546|         $pageRecord->sortOrder = $page->sortOrder;
   547|         $pageRecord->settings = $page->getSettings();
   548|         $pageRecord->save(false);
   549|         $page->id = $pageRecord->id;
   550|         $page->afterSave($isNewPage);
   551|         foreach ($page->getRows() as $rowKey => $row) {
   552|             $row->layoutId = $page->layoutId;
   553|             $row->pageId = $page->id;
   554|             $row->sortOrder = $rowKey;
   555|             if (!$this->saveRow($row)) {
   556|                 return false;
   557|             }
   558|         }
   559|         return true;
   560|     }
   561|     public function deletePageById(int $id): bool
   562|     {
   563|         $page = $this->getPageById($id);
   564|         if (!$page) {
   565|             return false;
   566|         }
   567|         return $this->deletePage($page);
   568|     }
   569|     public function deletePage(FieldLayoutPage $page): bool
   570|     {
   571|         if (!$page->beforeDelete()) {
   572|             return false;
   573|         }
   574|         Db::delete(Table::FORMIE_FIELD_LAYOUT_PAGES, ['id' => $page->id]);
   575|         $page->afterDelete();
   576|         return true;
   577|     }
   578|     public function saveRow(FieldLayoutRow $row): bool
   579|     {
   580|         $isNewRow = !$row->id;
   581|         if (!$row->beforeSave($isNewRow)) {
   582|             return false;
   583|         }
   584|         if (!$row->validate()) {
   585|             return false;
   586|         }
   587|         if (!$isNewRow) {
   588|             $rowRecord = FieldLayoutRowRecord::find()
   589|                 ->andWhere(['id' => $row->id])
   590|                 ->one();
   591|             if (!$rowRecord) {
   592|                 throw new Exception('Invalid field row ID: ' . $row->id);
   593|             }
   594|         } else {
   595|             $rowRecord = new FieldLayoutRowRecord();
   596|         }
   597|         $rowRecord->id = $row->id;
   598|         $rowRecord->layoutId = $row->layoutId;
   599|         $rowRecord->pageId = $row->pageId;
   600|         $rowRecord->sortOrder = $row->sortOrder;
   601|         $rowRecord->save(false);
   602|         $row->id = $rowRecord->id;
   603|         $row->afterSave($isNewRow);
   604|         foreach ($row->getFields() as $fieldKey => $field) {
   605|             $field->layoutId = $row->layoutId;
   606|             $field->pageId = $row->pageId;
   607|             $field->rowId = $row->id;
   608|             $field->sortOrder = $fieldKey;
   609|             if (!$this->saveField($field)) {
   610|                 return false;
   611|             }
   612|         }
   613|         return true;
   614|     }
   615|     public function deleteRowById(int $id): bool
   616|     {
   617|         $row = $this->getRowById($id);
   618|         if (!$row) {
   619|             return false;
   620|         }
   621|         return $this->deleteRow($row);
   622|     }
   623|     public function deleteRow(FieldLayoutRow $row): bool
   624|     {
   625|         if (!$row->beforeDelete()) {
   626|             return false;
   627|         }
   628|         Db::delete(Table::FORMIE_FIELD_LAYOUT_ROWS, ['id' => $row->id]);
   629|         $row->afterDelete();
   630|         return true;
   631|     }
   632|     public function saveField(Field $field, bool $updateSyncedFields = true): bool
   633|     {
   634|         $isNewField = !$field->id;
   635|         if (!$field->beforeSave($isNewField)) {
   636|             return false;
   637|         }
   638|         if (!$field->validate()) {
   639|             return false;
   640|         }
   641|         if (!$isNewField) {
   642|             $fieldRecord = FieldRecord::find()
   643|                 ->andWhere(['id' => $field->id])
   644|                 ->one();
   645|             if (!$fieldRecord) {
   646|                 throw new Exception('Invalid field ID: ' . $field->id);
   647|             }
   648|         } else {
   649|             $fieldRecord = new FieldRecord();
   650|         }
   651|         $fieldRecord->id = $field->id;
   652|         $fieldRecord->layoutId = $field->layoutId;
   653|         $fieldRecord->pageId = $field->pageId;
   654|         $fieldRecord->rowId = $field->rowId;
   655|         $fieldRecord->syncId = $field->syncId;
   656|         $fieldRecord->label = $field->label;
   657|         $fieldRecord->handle = $field->handle;
   658|         $fieldRecord->type = $field->type;
   659|         $fieldRecord->sortOrder = $field->sortOrder;
   660|         $fieldRecord->settings = $field->settings;
   661|         if ($field instanceof formiefields\MissingField) {
   662|             $fieldRecord->type = $field->expectedType;
   663|         }
   664|         $fieldRecord->save(false);
   665|         $field->id = $fieldRecord->id;
   666|         $field->uid = $fieldRecord->uid;
   667|         $field->afterSave($isNewField);
   668|         if ($updateSyncedFields && $field->getIsSynced()) {
   669|             $this->updateSyncedFields($field);
   670|         }
   671|         Fields::resetFieldHandles();
   672|         return true;
   673|     }
   674|     public function deleteFieldById(int $id): bool
   675|     {
   676|         $field = $this->getFieldById($id);
   677|         if (!$field) {
   678|             return false;
   679|         }
   680|         return $this->deleteField($field);
   681|     }
   682|     public function deleteField(Field $field): bool
   683|     {
   684|         if (!$field->beforeDelete()) {
   685|             return false;
   686|         }
   687|         Db::delete(Table::FORMIE_FIELDS, ['id' => $field->id]);
   688|         $field->afterDelete();
   689|         return true;
   690|     }
   691|     public function updateSyncedFields(Field $field): bool
   692|     {
   693|         Db::update(Table::FORMIE_FIELDS, ['syncId' => $field->syncId], ['id' => $field->syncId]);
   694|         $fieldIds = (new Query())
   695|             ->select('id')
   696|             ->from(Table::FORMIE_FIELDS)
   697|             ->where(['syncId' => $field->syncId])
   698|             ->column();
   699|         unset($fieldIds[array_search($field->id, $fieldIds)]);
   700|         foreach ($fieldIds as $fieldId) {
   701|             $syncedField = $this->getFieldById($fieldId);
   702|             if ($syncedField) {
   703|                 $settings = [
   704|                     'label' => $field->label,
   705|                     'handle' => $field->handle,
   706|                     ...$field->getSettings(),
   707|                 ];
   708|                 $syncedField->setAttributes($settings, false);
   709|                 $this->saveField($syncedField, false);
   710|             }
   711|         }
   712|         return true;
   713|     }
   714|     public function checkRequiredPlugin(FieldInterface $field): bool
   715|     {
   716|         if (!method_exists($field, 'getRequiredPlugins')) {
   717|             throw new MissingComponentException();
   718|         }
   719|         foreach ($field::getRequiredPlugins() as $requiredPlugin) {
   720|             $version = $requiredPlugin['version'] ?? 0;
   721|             $handle = $requiredPlugin['handle'] ?? '';
   722|             if ($handle) {
   723|                 if (!Plugin::isPluginInstalledAndEnabled($handle)) {
   724|                     throw new MissingComponentException();
   725|                 }
   726|                 $plugin = Craft::$app->getPlugins()->getPlugin($handle);
   727|                 if (version_compare($plugin->getVersion(), $version, '<')) {
   728|                     throw new MissingComponentException();
   729|                 }
   730|             }
   731|         }
   732|         return true;
   733|     }
   734|     public function getFieldOptions(FieldInterface $field, array $options = null): array
   735|     {
   736|         if (empty($options)) {
   737|             return [];
   738|         }
   739|         /* @var Field $field */
   740|         $allFieldOptions = $options['fields'] ?? [];
   741|         $fieldOptions = $allFieldOptions[$field->handle] ?? [];
   742|         if (isset($allFieldOptions['*'])) {
   743|             $fieldOptions = ArrayHelper::merge($allFieldOptions['*'], $fieldOptions);
   744|         }
   745|         return $fieldOptions;
   746|     }
   747|     public function getLabelPositions(FieldInterface $field = null): array
   748|     {
   749|         $labelPositions = [
   750|             AboveInput::class,
   751|             BelowInput::class,
   752|             LeftInput::class,
   753|             RightInput::class,
   754|             HiddenPosition::class,
   755|         ];
   756|         $event = new RegisterFieldOptionsEvent([
   757|             'field' => $field,
   758|             'options' => $labelPositions,
   759|         ]);
   760|         $this->trigger(self::EVENT_REGISTER_LABEL_POSITIONS, $event);
   761|         if ($field) {
   762|             $supportedPositions = [];
   763|             foreach ($event->options as $class) {
   764|                 if ($class::supports($field)) {
   765|                     $supportedPositions[] = $class;
   766|                 }
   767|             }
   768|             return $supportedPositions;
   769|         }
   770|         return $event->options;
   771|     }
   772|     public function getLabelPositionsOptions(FieldInterface $field = null): array
   773|     {
   774|         return array_map(function($class) {
   775|             return [
   776|                 'label' => $class::displayName(),
   777|                 'value' => $class,
   778|             ];
   779|         }, $this->getLabelPositions($field));
   780|     }
   781|     public function getInstructionsPositions(FieldInterface $field = null): array
   782|     {
   783|         $instructionsPositions = [
   784|             AboveInput::class,
   785|             BelowInput::class,
   786|         ];
   787|         $event = new RegisterFieldOptionsEvent([
   788|             'field' => $field,
   789|             'options' => $instructionsPositions,
   790|         ]);
   791|         $this->trigger(self::EVENT_REGISTER_INSTRUCTIONS_POSITIONS, $event);
   792|         if ($field) {
   793|             $supportedPositions = [];
   794|             foreach ($event->options as $class) {
   795|                 if ($class::supports($field)) {
   796|                     $supportedPositions[] = $class;
   797|                 }
   798|             }
   799|             return $supportedPositions;
   800|         }
   801|         return $event->options;
   802|     }
   803|     public function getInstructionsPositionsOptions(FieldInterface $field = null): array
   804|     {
   805|         return array_map(function($class) {
   806|             return [
   807|                 'label' => $class::displayName(),
   808|                 'value' => $class,
   809|             ];
   810|         }, $this->getInstructionsPositions($field));
   811|     }
   812|     public function getReservedHandles(): array
   813|     {
   814|         return (new formiefields\SingleLineText())->getReservedHandles();
   815|     }
   816|     private function _getLayoutQuerySelect(): array
   817|     {
   818|         return [
   819|             'l.id as layoutId',
   820|             'l.dateCreated as layoutDateCreated',
   821|             'l.dateUpdated as layoutDateUpdated',
   822|             'l.uid as layoutUid',
   823|         ];
   824|     }
   825|     private function _getPageQuerySelect(): array
   826|     {
   827|         return [
   828|             'p.id as pageId',
   829|             'p.layoutId as pageLayoutId',
   830|             'p.label as pageLabel',
   831|             'p.sortOrder as pageSortOrder',
   832|             'p.settings as pageSettings',
   833|             'p.dateCreated as pageDateCreated',
   834|             'p.dateUpdated as pageDateUpdated',
   835|             'p.uid as pageUid',
   836|         ];
   837|     }
   838|     private function _getRowQuerySelect(): array
   839|     {
   840|         return [
   841|             'r.id as rowId',
   842|             'r.layoutId as rowLayoutId',
   843|             'r.pageId as rowPageId',
   844|             'r.sortOrder as rowSortOrder',
   845|             'r.dateCreated as rowDateCreated',
   846|             'r.dateUpdated as rowDateUpdated',
   847|             'r.uid as rowUid',
   848|         ];
   849|     }
   850|     private function _getFieldQuerySelect(): array
   851|     {
   852|         return [
   853|             'f.id as fieldId',
   854|             'f.layoutId as fieldLayoutId',
   855|             'f.pageId as fieldPageId',
   856|             'f.rowId as fieldRowId',
   857|             'f.syncId as fieldSyncId',
   858|             'f.label as fieldLabel',
   859|             'f.handle as fieldHandle',
   860|             'f.type as fieldType',
   861|             'f.sortOrder as fieldSortOrder',
   862|             'f.settings as fieldSettings',
   863|             'f.dateCreated as fieldDateCreated',
   864|             'f.dateUpdated as fieldDateUpdated',
   865|             'f.uid as fieldUid',
   866|         ];
   867|     }
   868|     private function _getPopulatedPage(array $item): array
   869|     {
   870|         return [
   871|             'id' => $item['pageId'],
   872|             'layoutId' => $item['pageLayoutId'],
   873|             'label' => $item['pageLabel'],
   874|             'settings' => $item['pageSettings'],
   875|             'sortOrder' => $item['pageSortOrder'],
   876|             'dateCreated' => $item['pageDateCreated'],
   877|             'dateUpdated' => $item['pageDateUpdated'],
   878|             'uid' => $item['pageUid'],
   879|             'rows' => [],
   880|         ];
   881|     }
   882|     private function _getPopulatedRow(array $item): array
   883|     {
   884|         return [
   885|             'id' => $item['rowId'],
   886|             'layoutId' => $item['rowLayoutId'],
   887|             'pageId' => $item['rowPageId'],
   888|             'sortOrder' => $item['rowSortOrder'],
   889|             'dateCreated' => $item['rowDateCreated'],
   890|             'dateUpdated' => $item['rowDateUpdated'],
   891|             'uid' => $item['rowUid'],
   892|             'fields' => [],
   893|         ];
   894|     }
   895|     private function _getPopulatedField(array $item): array
   896|     {
   897|         return [
   898|             'id' => $item['fieldId'],
   899|             'layoutId' => $item['fieldLayoutId'],
   900|             'pageId' => $item['fieldPageId'],
   901|             'rowId' => $item['fieldRowId'],
   902|             'syncId' => $item['fieldSyncId'],
   903|             'label' => $item['fieldLabel'],
   904|             'handle' => $item['fieldHandle'],
   905|             'type' => $item['fieldType'],
   906|             'settings' => $item['fieldSettings'],
   907|             'sortOrder' => $item['fieldSortOrder'],
   908|             'dateCreated' => $item['fieldDateCreated'],
   909|             'dateUpdated' => $item['fieldDateUpdated'],
   910|             'uid' => $item['fieldUid'],
   911|         ];
   912|     }
   913|     private function _getLayout(array $params): ?FieldLayout
   914|     {
   915|         $layoutData = [];
   916|         $dataItems = (new Query())
   917|             ->select([
   918|                 ...$this->_getLayoutQuerySelect(),
   919|                 ...$this->_getPageQuerySelect(),
   920|                 ...$this->_getRowQuerySelect(),
   921|                 ...$this->_getFieldQuerySelect(),
   922|             ])
   923|             ->from(['l' => Table::FORMIE_FIELD_LAYOUTS])
   924|             ->leftJoin(['p' => Table::FORMIE_FIELD_LAYOUT_PAGES], '[[p.layoutId]] = [[l.id]]')
   925|             ->leftJoin(['r' => Table::FORMIE_FIELD_LAYOUT_ROWS], '[[r.pageId]] = [[p.id]]')
   926|             ->leftJoin(['f' => Table::FORMIE_FIELDS], '[[f.rowId]] = [[r.id]]')
   927|             ->where($params)
   928|             ->orderBy([
   929|                 'p.sortOrder' => SORT_ASC,
   930|                 'r.sortOrder' => SORT_ASC,
   931|                 'f.sortOrder' => SORT_ASC,
   932|             ])
   933|             ->all();
   934|         $pages = [];
   935|         $rows = [];
   936|         $fields = [];
   937|         if ($dataItems) {
   938|             foreach ($dataItems as $item) {
   939|                 $layoutData['id'] = $item['layoutId'];
   940|                 $layoutData['dateCreated'] = $item['layoutDateCreated'];
   941|                 $layoutData['dateUpdated'] = $item['layoutDateUpdated'];
   942|                 $layoutData['uid'] = $item['layoutUid'];
   943|                 $pageId = $item['pageId'];
   944|                 $rowId = $item['rowId'];
   945|                 $fieldId = $item['fieldId'];
   946|                 if ($pageId && !isset($pages[$pageId])) {
   947|                     $pages[$pageId] = $this->_getPopulatedPage($item);
   948|                 }
   949|                 if ($rowId && !isset($rows[$rowId])) {
   950|                     $rows[$rowId] = $this->_getPopulatedRow($item);
   951|                 }
   952|                 if ($fieldId && !isset($fields[$fieldId])) {
   953|                     $fields[$fieldId] = $this->_getPopulatedField($item);
   954|                 }
   955|             }
   956|         }
   957|         foreach ($fields as $field) {
   958|             $rowId = $field['rowId'];
   959|             if (isset($rows[$rowId])) {
   960|                 $rows[$rowId]['fields'][] = $field;
   961|             }
   962|         }
   963|         foreach ($rows as $row) {
   964|             $pageId = $row['pageId'];
   965|             if (isset($pages[$pageId])) {
   966|                 $pages[$pageId]['rows'][] = $row;
   967|             }
   968|         }
   969|         $layoutData['pages'] = array_values($pages);
   970|         return $layoutData ? new FieldLayout($layoutData) : null;
   971|     }
   972|     private function _getPage(array $params): ?FieldLayoutPage
   973|     {
   974|         $layoutData = [];
   975|         $dataItems = (new Query())
   976|             ->select([
   977|                 ...$this->_getPageQuerySelect(),
   978|                 ...$this->_getRowQuerySelect(),
   979|                 ...$this->_getFieldQuerySelect(),
   980|             ])
   981|             ->from(['p' => Table::FORMIE_FIELD_LAYOUT_PAGES])
   982|             ->leftJoin(['r' => Table::FORMIE_FIELD_LAYOUT_ROWS], '[[r.pageId]] = [[p.id]]')
   983|             ->leftJoin(['f' => Table::FORMIE_FIELDS], '[[f.rowId]] = [[r.id]]')
   984|             ->where($params)
   985|             ->orderBy([
   986|                 'p.sortOrder' => SORT_ASC,
   987|                 'r.sortOrder' => SORT_ASC,
   988|                 'f.sortOrder' => SORT_ASC,
   989|             ])
   990|             ->all();
   991|         $rows = [];
   992|         $fields = [];
   993|         if ($dataItems) {
   994|             foreach ($dataItems as $item) {
   995|                 $layoutData = $this->_getPopulatedPage($item);
   996|                 $rowId = $item['rowId'];
   997|                 $fieldId = $item['fieldId'];
   998|                 if ($rowId && !isset($rows[$rowId])) {
   999|                     $rows[$rowId] = $this->_getPopulatedRow($item);
  1000|                 }
  1001|                 if ($fieldId && !isset($fields[$fieldId])) {
  1002|                     $fields[$fieldId] = $this->_getPopulatedField($item);
  1003|                 }
  1004|             }
  1005|         }
  1006|         foreach ($fields as $field) {
  1007|             $rowId = $field['rowId'];
  1008|             if (isset($rows[$rowId])) {
  1009|                 $rows[$rowId]['fields'][] = $field;
  1010|             }
  1011|         }
  1012|         $layoutData['rows'] = array_values($rows);
  1013|         return $layoutData ? new FieldLayoutPage($layoutData) : null;
  1014|     }
  1015|     private function _getRow(array $params): ?FieldLayoutRow
  1016|     {
  1017|         $layoutData = [];
  1018|         $dataItems = (new Query())
  1019|             ->select([
  1020|                 ...$this->_getRowQuerySelect(),
  1021|                 ...$this->_getFieldQuerySelect(),
  1022|             ])
  1023|             ->from(['r' => Table::FORMIE_FIELD_LAYOUT_ROWS])
  1024|             ->leftJoin(['f' => Table::FORMIE_FIELDS], '[[f.rowId]] = [[r.id]]')
  1025|             ->where($params)
  1026|             ->orderBy([
  1027|                 'r.sortOrder' => SORT_ASC,
  1028|                 'f.sortOrder' => SORT_ASC,
  1029|             ])
  1030|             ->all();
  1031|         $fields = [];
  1032|         if ($dataItems) {
  1033|             foreach ($dataItems as $item) {
  1034|                 $layoutData = $this->_getPopulatedRow($item);
  1035|                 $fieldId = $item['fieldId'];
  1036|                 if ($fieldId && !isset($fields[$fieldId])) {
  1037|                     $fields[$fieldId] = $this->_getPopulatedField($item);
  1038|                 }
  1039|             }
  1040|         }
  1041|         $layoutData['fields'] = array_values($fields);
  1042|         return $layoutData ? new FieldLayoutRow($layoutData) : null;
  1043|     }
  1044| }


# ====================================================================
# FILE: src/services/Submissions.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-493 ---
     1| <?php
     2| namespace verbb\formie\services;
     3| use verbb\formie\Formie;
     4| use verbb\formie\base\Integration;
     5| use verbb\formie\base\SingleNestedFieldInterface;
     6| use verbb\formie\base\SubFieldInterface;
     7| use verbb\formie\controllers\SubmissionsController;
     8| use verbb\formie\elements\Form;
     9| use verbb\formie\elements\Submission;
    10| use verbb\formie\events\PruneSubmissionEvent;
    11| use verbb\formie\events\SendNotificationEvent;
    12| use verbb\formie\events\SubmissionEvent;
    13| use verbb\formie\events\SubmissionSpamCheckEvent;
    14| use verbb\formie\events\TriggerIntegrationEvent;
    15| use verbb\formie\fields\data\MultiOptionsFieldData;
    16| use verbb\formie\fields as formiefields;
    17| use verbb\formie\helpers\ArrayHelper;
    18| use verbb\formie\helpers\StringHelper;
    19| use verbb\formie\helpers\Table;
    20| use verbb\formie\helpers\Variables;
    21| use verbb\formie\jobs\SendNotification;
    22| use verbb\formie\jobs\TriggerIntegration;
    23| use verbb\formie\jobs\UpdateSubmissionContent;
    24| use verbb\formie\models\Address;
    25| use verbb\formie\models\IntegrationResponse;
    26| use verbb\formie\models\Name;
    27| use verbb\formie\models\Notification;
    28| use verbb\formie\models\Settings;
    29| use Craft;
    30| use craft\base\PreviewableFieldInterface;
    31| use craft\base\SortableFieldInterface;
    32| use craft\db\Query;
    33| use craft\elements\db\ElementQuery;
    34| use craft\elements\Asset;
    35| use craft\elements\User;
    36| use craft\events\DefineSourceSortOptionsEvent;
    37| use craft\events\DefineSourceTableAttributesEvent;
    38| use craft\events\DefineUserContentSummaryEvent;
    39| use craft\helpers\Console;
    40| use craft\helpers\Db;
    41| use craft\helpers\Json;
    42| use craft\helpers\Queue;
    43| use yii\base\Event;
    44| use yii\base\Component;
    45| use DateInterval;
    46| use DateTime;
    47| use Throwable;
    48| use Exception;
    49| use Faker;
    50| use libphonenumber\PhoneNumberUtil;
    51| class Submissions extends Component
    52| {
    53|     public const EVENT_BEFORE_SUBMISSION = 'beforeSubmission';
    54|     public const EVENT_BEFORE_INCOMPLETE_SUBMISSION = 'beforeIncompleteSubmission';
    55|     public const EVENT_AFTER_SUBMISSION = 'afterSubmission';
    56|     public const EVENT_AFTER_INCOMPLETE_SUBMISSION = 'afterIncompleteSubmission';
    57|     public const EVENT_BEFORE_SPAM_CHECK = 'beforeSpamCheck';
    58|     public const EVENT_AFTER_SPAM_CHECK = 'afterSpamCheck';
    59|     public const EVENT_BEFORE_SEND_NOTIFICATION = 'beforeSendNotification';
    60|     public const EVENT_BEFORE_TRIGGER_INTEGRATION = 'beforeTriggerIntegration';
    61|     public const EVENT_AFTER_PRUNE_SUBMISSION = 'afterPruneSubmission';
    62|     public function getSubmissionById(int $id, ?string $siteId = '*'): ?Submission
    63|     {
    64|         return Craft::$app->getElements()->getElementById($id, Submission::class, $siteId);
    65|     }
    66|     public function defineSourceTableAttributes(DefineSourceTableAttributesEvent $event): void
    67|     {
    68|         if ($event->elementType !== Submission::class) {
    69|             return;
    70|         }
    71|         if (preg_match('/^form:(\d+)$/', $event->source, $matches) && ($fields = Formie::$plugin->getFields()->getAllFieldsForForm($matches[1]))) {
    72|             foreach ($fields as $field) {
    73|                 if ($field instanceof PreviewableFieldInterface) {
    74|                     $event->attributes["field:{$field->handle}"] = ['label' => $field->label];
    75|                 }
    76|             }
    77|         }
    78|     }
    79|     public function defineSourceSortOptions(DefineSourceSortOptionsEvent $event): void
    80|     {
    81|         if ($event->elementType !== Submission::class) {
    82|             return;
    83|         }
    84|         if (preg_match('/^form:(\d+)$/', $event->source, $matches) && ($fields = Formie::$plugin->getFields()->getAllFieldsForForm($matches[1]))) {
    85|             foreach ($fields as $field) {
    86|                 if ($field instanceof SortableFieldInterface) {
    87|                     $event->sortOptions["field:{$field->handle}"] = $field->getSortOption();
    88|                 }
    89|             }
    90|         }
    91|     }
    92|     public function onBeforeSubmission(Submission $submission, string $submitAction = 'submit'): void
    93|     {
    94|         $event = new SubmissionEvent([
    95|             'submission' => $submission,
    96|             'submitAction' => $submitAction,
    97|         ]);
    98|         if ($submission->isIncomplete) {
    99|             $this->trigger(self::EVENT_BEFORE_INCOMPLETE_SUBMISSION, $event);
   100|             return;
   101|         }
   102|         $this->trigger(self::EVENT_BEFORE_SUBMISSION, $event);
   103|     }
   104|     public function onAfterSubmission(bool $success, Submission $submission, string $submitAction = 'submit'): void
   105|     {
   106|         /* @var Settings $settings */
   107|         $settings = Formie::$plugin->getSettings();
   108|         if ($submission->isIncomplete) {
   109|             $event = new SubmissionEvent([
   110|                 'submission' => $submission,
   111|                 'submitAction' => $submitAction,
   112|                 'success' => $success,
   113|             ]);
   114|             $event->handled = true;
   115|             $this->trigger(self::EVENT_AFTER_INCOMPLETE_SUBMISSION, $event);
   116|             if ($event->handled) {
   117|                 return;
   118|             }
   119|         }
   120|         if ($submission->isSpam) {
   121|             $success = false;
   122|         }
   123|         if ($success && !$this->processPayments($submission)) {
   124|             $success = false;
   125|         }
   126|         $event = new SubmissionEvent([
   127|             'submission' => $submission,
   128|             'submitAction' => $submitAction,
   129|             'success' => $success,
   130|         ]);
   131|         $this->trigger(self::EVENT_AFTER_SUBMISSION, $event);
   132|         if (!$submission->isIncomplete) {
   133|             if ($event->success) {
   134|                 $this->sendNotifications($event->submission);
   135|                 $this->triggerIntegrations($event->submission);
   136|             } else if ($submission->isSpam && $settings->spamEmailNotifications) {
   137|                 $this->sendNotifications($event->submission);
   138|             }
   139|         }
   140|     }
   141|     public function sendNotifications(Submission $submission): void
   142|     {
   143|         $form = $submission->getForm();
   144|         $notifications = $form->getEnabledNotifications();
   145|         foreach ($notifications as $notification) {
   146|             $this->sendNotification($notification, $submission);
   147|         }
   148|     }
   149|     public function sendNotification(Notification $notification, Submission $submission): void
   150|     {
   151|         /* @var Settings $settings */
   152|         $settings = Formie::$plugin->getSettings();
   153|         if (!Formie::$plugin->getNotifications()->evaluateConditions($notification, $submission)) {
   154|             return;
   155|         }
   156|         if ($settings->useQueueForNotifications) {
   157|             Queue::push(new SendNotification([
   158|                 'submissionId' => $submission->id,
   159|                 'notificationId' => $notification->id,
   160|             ]), $settings->queuePriority);
   161|         } else {
   162|             $this->sendNotificationEmail($notification, $submission);
   163|         }
   164|     }
   165|     public function sendNotificationEmail(Notification $notification, Submission $submission, $queueJob = null): array|bool
   166|     {
   167|         $event = new SendNotificationEvent([
   168|             'submission' => $submission,
   169|             'notification' => $notification,
   170|         ]);
   171|         $this->trigger(self::EVENT_BEFORE_SEND_NOTIFICATION, $event);
   172|         if (!$event->isValid) {
   173|             return true;
   174|         }
   175|         return Formie::$plugin->getEmails()->sendEmail($event->notification, $event->submission, $queueJob);
   176|     }
   177|     public function triggerIntegrations(Submission $submission): void
   178|     {
   179|         /* @var Settings $settings */
   180|         $settings = Formie::$plugin->getSettings();
   181|         $form = $submission->getForm();
   182|         $integrations = Formie::$plugin->getIntegrations()->getAllEnabledIntegrationsForForm($form);
   183|         foreach ($integrations as $integration) {
   184|             if (!$integration->supportsPayloadSending()) {
   185|                 continue;
   186|             }
   187|             $integration->populateContext();
   188|             if ($settings->useQueueForIntegrations) {
   189|                 Queue::push(new TriggerIntegration([
   190|                     'submissionId' => $submission->id,
   191|                     'integration' => $integration,
   192|                 ]), $settings->queuePriority);
   193|             } else {
   194|                 $this->sendIntegrationPayload($integration, $submission);
   195|             }
   196|         }
   197|     }
   198|     public function sendIntegrationPayload(Integration $integration, Submission $submission): bool|IntegrationResponse
   199|     {
   200|         $event = new TriggerIntegrationEvent([
   201|             'submission' => $submission,
   202|             'type' => get_class($integration),
   203|             'integration' => $integration,
   204|         ]);
   205|         $this->trigger(self::EVENT_BEFORE_TRIGGER_INTEGRATION, $event);
   206|         if (!$event->isValid) {
   207|             return true;
   208|         }
   209|         return $integration->sendPayLoad($event->submission);
   210|     }
   211|     public function processPayments(Submission $submission): bool
   212|     {
   213|         foreach ($submission->getFields() as $field) {
   214|             if ($field instanceof formiefields\Payment) {
   215|                 if ($field->isConditionallyHidden($submission) || $field->getIsDisabled()) {
   216|                     continue;
   217|                 }
   218|                 if ($paymentIntegration = $field->getPaymentIntegration()) {
   219|                     $paymentIntegration->setField($field);
   220|                     if (!$paymentIntegration->processPayment($submission)) {
   221|                         $submission->isIncomplete = true;
   222|                         Craft::$app->getElements()->saveElement($submission, false);
   223|                         return false;
   224|                     }
   225|                 }
   226|             }
   227|         }
   228|         return true;
   229|     }
   230|     public function pruneIncompleteSubmissions($consoleInstance = null): void
   231|     {
   232|         /* @var Settings $settings */
   233|         $settings = Formie::$plugin->getSettings();
   234|         if ($settings->maxIncompleteSubmissionAge <= 0) {
   235|             return;
   236|         }
   237|         $interval = new DateInterval("P{$settings->maxIncompleteSubmissionAge}D");
   238|         $date = new DateTime();
   239|         $date->sub($interval);
   240|         $submissions = Submission::find()
   241|             ->isIncomplete(true)
   242|             ->dateUpdated('< ' . $date->format('Y-m-d H:i:s'))
   243|             ->all();
   244|         foreach ($submissions as $submission) {
   245|             try {
   246|                 Craft::$app->getElements()->deleteElement($submission, true);
   247|             } catch (Throwable $e) {
   248|                 Formie::error("Failed to prune submission with ID: #{$submission->id}." . $e->getMessage());
   249|             }
   250|         }
   251|         if ($settings->saveSpam) {
   252|             if ($settings->spamLimit <= 0) {
   253|                 return;
   254|             }
   255|             $submissions = Submission::find()
   256|                 ->limit(null)
   257|                 ->offset($settings->spamLimit)
   258|                 ->isSpam(true)
   259|                 ->orderBy(['dateCreated' => SORT_DESC])
   260|                 ->all();
   261|             if ($submissions && $consoleInstance) {
   262|                 $consoleInstance->stdout('Preparing to prune ' . count($submissions) . ' submissions.' . PHP_EOL, Console::FG_YELLOW);
   263|             }
   264|             foreach ($submissions as $submission) {
   265|                 try {
   266|                     Craft::$app->getElements()->deleteElement($submission, true);
   267|                     if ($consoleInstance) {
   268|                         $consoleInstance->stdout("Pruned spam submission with ID: #{$submission->id}." . PHP_EOL, Console::FG_GREEN);
   269|                     }
   270|                 } catch (Throwable $e) {
   271|                     Formie::error("Failed to prune spam submission with ID: #{$submission->id}." . $e->getMessage());
   272|                     if ($consoleInstance) {
   273|                         $consoleInstance->stdout("Failed to prune spam submission with ID: #{$submission->id}. " . $e->getMessage() . PHP_EOL, Console::FG_RED);
   274|                     }
   275|                 }
   276|             }
   277|         }
   278|     }
   279|     public function pruneDataRetentionSubmissions($consoleInstance = null): void
   280|     {
   281|         $forms = (new Query())
   282|             ->select(['id', 'handle', 'dataRetention', 'dataRetentionValue'])
   283|             ->from([Table::FORMIE_FORMS])
   284|             ->where(['not', ['dataRetention' => 'forever']])
   285|             ->all();
   286|         foreach ($forms as $form) {
   287|             $dataRetention = $form['dataRetention'] ?? '';
   288|             $dataRetentionValue = (int)$form['dataRetentionValue'];
   289|             if ($consoleInstance) {
   290|                 $consoleInstance->stdout(Craft::t('formie', 'Starting data retention checks for form “{f}”: {d} {c}.', [
   291|                         'f' => $form['handle'],
   292|                         'c' => $dataRetention,
   293|                         'd' => $dataRetentionValue,
   294|                     ]) . PHP_EOL, Console::FG_YELLOW);
   295|             }
   296|             $intervalLookup = ['minutes' => 'MIN', 'hours' => 'H', 'days' => 'D', 'weeks' => 'W', 'months' => 'M', 'years' => 'Y'];
   297|             $intervalValue = $intervalLookup[$dataRetention] ?? '';
   298|             if (!$intervalValue || !$dataRetentionValue) {
   299|                 continue;
   300|             }
   301|             if ($intervalValue === 'W') {
   302|                 $intervalValue = 'D';
   303|                 $dataRetentionValue *= 7;
   304|             }
   305|             $period = ($intervalValue === 'H' || $intervalValue === 'MIN') ? 'PT' : 'P';
   306|             if ($intervalValue === 'MIN') {
   307|                 $intervalValue = 'M';
   308|             }
   309|             $interval = new DateInterval("{$period}{$dataRetentionValue}{$intervalValue}");
   310|             $date = new DateTime();
   311|             $date->sub($interval);
   312|             $submissions = Submission::find()
   313|                 ->dateCreated('< ' . $date->format('Y-m-d H:i:s'))
   314|                 ->formId($form['id'])
   315|                 ->all();
   316|             if ($consoleInstance) {
   317|                 if ($submissions) {
   318|                     $consoleInstance->stdout(Craft::t('formie', 'Preparing to prune {c} submissions older than {d}.', [
   319|                             'c' => count($submissions),
   320|                             'd' => Db::prepareDateForDb($date),
   321|                         ]) . PHP_EOL, Console::FG_YELLOW);
   322|                 } else {
   323|                     $consoleInstance->stdout(Craft::t('formie', 'No submissions found to prune older than {d}.', [
   324|                             'd' => Db::prepareDateForDb($date),
   325|                         ]) . PHP_EOL, Console::FG_GREEN);
   326|                 }
   327|             }
   328|             foreach ($submissions as $submission) {
   329|                 try {
   330|                     Craft::$app->getElements()->deleteElement($submission, true);
   331|                     $event = new PruneSubmissionEvent([
   332|                         'submission' => $submission,
   333|                     ]);
   334|                     $this->trigger(self::EVENT_AFTER_PRUNE_SUBMISSION, $event);
   335|                     if ($consoleInstance) {
   336|                         $consoleInstance->stdout("Pruned submission with ID: #{$submission->id}." . PHP_EOL, Console::FG_GREEN);
   337|                     }
   338|                 } catch (Throwable $e) {
   339|                     Formie::error("Failed to prune submission with ID: #{$submission->id}." . $e->getMessage());
   340|                     if ($consoleInstance) {
   341|                         $consoleInstance->stdout("Failed to prune submission with ID: #{$submission->id}. " . $e->getMessage() . PHP_EOL, Console::FG_RED);
   342|                     }
   343|                 }
   344|             }
   345|         }
   346|     }
   347|     public function defineUserSubmissions(DefineUserContentSummaryEvent $event): void
   348|     {
   349|         $userIds = Craft::$app->getRequest()->getRequiredBodyParam('userId');
   350|         $submissionCount = Submission::find()
   351|             ->userId($userIds)
   352|             ->siteId('*')
   353|             ->unique()
   354|             ->status(null)
   355|             ->count();
   356|         if ($submissionCount) {
   357|             $event->contentSummary[] = $submissionCount == 1 ? Craft::t('formie', '1 form submission') : Craft::t('formie', '{num} form submissions', ['num' => $submissionCount]);
   358|         }
   359|     }
   360|     public function deleteUserSubmissions(Event $event): void
   361|     {
   362|         /** @var User $user */
   363|         $user = $event->sender;
   364|         $submissions = Submission::find()
   365|             ->userId($user->id)
   366|             ->siteId('*')
   367|             ->unique()
   368|             ->status(null)
   369|             ->all();
   370|         if (!$submissions) {
   371|             return;
   372|         }
   373|         $inheritorOnDelete = $user->inheritorOnDelete ?? null;
   374|         if ($inheritorOnDelete) {
   375|             Db::update(Table::FORMIE_SUBMISSIONS, ['userId' => $inheritorOnDelete->id], ['userId' => $user->id]);
   376|         } else {
   377|             foreach ($submissions as $submission) {
   378|                 try {
   379|                     Craft::$app->getElements()->deleteElement($submission);
   380|                 } catch (Throwable $e) {
   381|                     Formie::error("Failed to delete user submission with ID: #{$submission->id}." . $e->getMessage());
   382|                 }
   383|             }
   384|         }
   385|     }
   386|     public function restoreUserSubmissions(Event $event): void
   387|     {
   388|         /** @var User $user */
   389|         $user = $event->sender;
   390|         $submissions = Submission::find()
   391|             ->userId($user->id)
   392|             ->siteId('*')
   393|             ->unique()
   394|             ->status(null)
   395|             ->trashed(true)
   396|             ->all();
   397|         foreach ($submissions as $submission) {
   398|             try {
   399|                 Craft::$app->getElements()->restoreElement($submission);
   400|             } catch (Throwable $e) {
   401|                 Formie::error("Failed to restore user submission with ID: #{$submission->id}." . $e->getMessage());
   402|             }
   403|         }
   404|     }
   405|     public function spamChecks(Submission $submission): void
   406|     {
   407|         /* @var Settings $settings */
   408|         $settings = Formie::$plugin->getSettings();
   409|         $event = new SubmissionSpamCheckEvent([
   410|             'submission' => $submission,
   411|         ]);
   412|         $this->trigger(self::EVENT_BEFORE_SPAM_CHECK, $event);
   413|         if (!$submission->isSpam) {
   414|             $excludes = $this->_getArrayFromMultiline($settings->spamKeywords);
   415|             $extraExcludes = [];
   416|             foreach ($excludes as $key => $exclude) {
   417|                 if (str_contains($exclude, '{')) {
   418|                     unset($excludes[$key]);
   419|                     $parsedString = $this->_getArrayFromMultiline(Variables::getParsedValue($exclude));
   420|                     $extraExcludes[] = $parsedString;
   421|                 }
   422|             }
   423|             $excludes = array_merge($excludes, ...$extraExcludes);
   424|             $fieldValues = implode(' ', $submission->getValuesAsString());
   425|             foreach ($excludes as $exclude) {
   426|                 if (strtolower($exclude) && str_contains(strtolower($fieldValues), strtolower($exclude))) {
   427|                     $submission->isSpam = true;
   428|                     $submission->spamReason = Craft::t('formie', 'Contains banned keyword: “{c}”', ['c' => $exclude]);
   429|                     break;
   430|                 }
   431|                 if ($submission->ipAddress && $submission->ipAddress === $exclude) {
   432|                     $submission->isSpam = true;
   433|                     $submission->spamReason = Craft::t('formie', 'Contains banned IP: “{c}”', ['c' => $exclude]);
   434|                     break;
   435|                 }
   436|             }
   437|         }
   438|         $event = new SubmissionSpamCheckEvent([
   439|             'submission' => $submission,
   440|         ]);
   441|         $this->trigger(self::EVENT_AFTER_SPAM_CHECK, $event);
   442|     }
   443|     public function logSpam(Submission $submission): void
   444|     {
   445|         $fieldValues = $submission->getSerializedFieldValues();
   446|         $fieldValues = array_filter($fieldValues);
   447|         $error = Craft::t('formie', 'Submission marked as spam - “{r}” - {j}.', [
   448|             'r' => $submission->spamReason,
   449|             'j' => Json::encode($fieldValues),
   450|         ]);
   451|         Formie::info($error);
   452|     }
   453|     public function populateFakeSubmission(Submission $submission): void
   454|     {
   455|         $fields = $submission->getFields();
   456|         $fieldContent = $this->getFakeFieldContent($fields);
   457|         $submission->setFieldValues($fieldContent);
   458|         $submission->id = '1234';
   459|         $submission->uid = StringHelper::UUID();
   460|         $submission->dateCreated = new DateTime();
   461|         $submission->setUser(User::find()->one());
   462|     }
   463|     public function updateSubmissionContent(Form $form): void
   464|     {
   465|         /* @var Settings $settings */
   466|         $settings = Formie::$plugin->getSettings();
   467|         $hasGroupField = array_filter($form->getFields(), function($field) {
   468|             return $field instanceof formiefields\Group;
   469|         });
   470|         if ($hasGroupField) {
   471|             Queue::push(new UpdateSubmissionContent([
   472|                 'formId' => $form->id,
   473|             ]), $settings->queuePriority);
   474|         }
   475|     }
   476|     public function getFakeFieldContent(array $fields): array
   477|     {
   478|         $fieldContent = [];
   479|         $faker = Faker\Factory::create();
   480|         foreach ($fields as $key => $field) {
   481|             $fieldContent[$field->handle] = $field->getValueForEmailPreview($faker);
   482|         }
   483|         return $fieldContent;
   484|     }
   485|     private function _getArrayFromMultiline(?string $string): array
   486|     {
   487|         $array = [];
   488|         if ($string) {
   489|             $array = array_map('trim', explode(PHP_EOL, $string));
   490|         }
   491|         return array_filter($array);
   492|     }
   493| }


# ====================================================================
# FILE: src/translations/it/formie.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-2589 ---
     1| <?php
     2| return [
     3|   'formie_failed_notification_heading' => 'Quando una notifica email non viene inviata:',
     4|   'formie_failed_notification_subject' => 'Notifica email non inviata per il modulo "{{ form.title }}" su {{ siteName }}.',
     5|   'formie_failed_notification_body' => "L'invio di una notifica email per il modulo \"{{ form.title }}\" è fallito.\n\n" .
     6|     "La risposta di errore è stata registrata: {{ emailResponse | json_encode }}.\n\n" .
     7|     "Per rivederla, accedi al tuo pannello di controllo.\n\n" .
     8|     "{{ submission.cpEditUrl }}",
     9|   '"{label}" should contain at most {max, number} {max, plural, one{character} other{characters}}.' => 'Il campo "{label}" può contenere al massimo {max, number} {max, plural, one{carattere} other{caratteri}}.',
    10|   '(GDPR) {text}' => '(GDPR) {text}',
    11|   '(optional)' => '(facoltativo)',
    12|   ' (Trashed)' => ' (Eliminato)',
    13|   '*' => '*',
    14|   '+1 day' => '+1 giorno',
    15|   '+1 hour' => '+1 ora',
    16|   '+2 hours' => '+2 ore',
    17|   '+4 hours' => '+4 ore',
    18|   '+6 hours' => '+6 ore',
    19|   '+12 hours' => '+12 ore',
    20|   '1 form submission' => '1 invio del modulo',
    21|   '1-3 years' => '1-3 anni',
    22|   '1-6 months' => '1-6 mesi',
    23|   '1CRM' => '1CRM',
    24|   '2 to 3 times a month' => '2 o 3 volte al mese',
    25|   '2 to 3 times a week' => '2 o 3 volte alla settimana',
    26|   '2-Letter Code' => 'Codice a 2 lettere',
    27|   '3-Letter Code' => 'Codice a 3 lettere',
    28|   '18-24' => '18-24',
    29|   '25-34' => '25-34',
    30|   '35-44' => '35-44',
    31|   '45-54' => '45-54',
    32|   '55-64' => '55-64',
    33|   '65 or above' => '65 o più',
    34|   'Abandoned' => 'Abbandonato',
    35|   'Abbreviated Country Name (e.g. US)' => 'Nome paese abbreviato (es. US)',
    36|   'Abkhazian' => 'Abkhazo',
    37|   'ABN' => 'ABN',
    38|   'About' => 'Informazioni',
    39|   'About the Same' => 'Circa lo stesso',
    40|   'Above Input' => 'Sopra l\'input',
    41|   'Acceptability' => 'Accettabilità',
    42|   'Acceptable' => 'Accettabile',
    43|   'Access forms' => 'Accedi ai moduli',
    44|   'Access sent notifications' => 'Accedi alle notifiche inviate',
    45|   'Access submissions' => 'Accedi agli invii',
    46|   'Access Token' => 'Token di accesso',
    47|   'Account Field Mapping' => 'Mappatura del campo dell\'account',
    48|   'Account ID' => 'ID account',
    49|   'Account IDs' => 'ID account',
    50|   'Accounting/Finance' => 'Contabilità/Finanza',
    51|   'Account Position' => 'Posizione dell\'account',
    52|   'ACN' => 'ACN',
    53|   'Action' => 'Azione',
    54|   'Action on Submit' => 'Azione all\'invio',
    55|   'Activate User' => 'Attiva utente',
    56|   'ActiveCampaign' => 'ActiveCampaign',
    57|   'Add' => 'Aggiungi',
    58|   'Add a border to this section.' => 'Aggiungi un bordo a questa sezione.',
    59|   'Add a form' => 'Aggiungi un modulo',
    60|   'Add a name and email' => 'Aggiungi nome e email',
    61|   'Add an asset' => 'Aggiungi una risorsa',
    62|   'Add an option' => 'Aggiungi un\'opzione',
    63|   'Add another row' => 'Aggiungi un\'altra riga',
    64|   'Add any additional metadata to store against a transaction.' => 'Aggiungi eventuali metadati aggiuntivi da conservare contro una transazione.',
    65|   'Add any additional options for the date picker to use. For available options, refer to the [Flatpickr.js docs](https://flatpickr.js.org/options/).' => 'Aggiungi eventuali opzioni aggiuntive per l\'uso del selettore di date. Per le opzioni disponibili, consulta la [documentazione Flatpickr.js](https://flatpickr.js.org/options/).',
    66|   'Add any attachments such as screenshots that would be helpful for support.' => 'Aggiungi allegati come screenshot utili per il supporto.',
    67|   'Add a prefix to the number.' => 'Aggiungi un prefisso al numero.',
    68|   'Add a row' => 'Aggiungi una riga',
    69|   'Add as new field' => 'Aggiungi come nuovo campo',
    70|   'Add as synced field' => 'Aggiungi come campo sincronizzato',
    71|   'Add a submission' => 'Aggiungi un invio',
    72|   'Add a suffix to the number.' => 'Aggiungi un suffisso al numero.',
    73|   'Add attributes to be output on the form buttons container.' => 'Aggiungi attributi da visualizzare nel contenitore dei pulsanti del modulo.',
    74|   'Add attributes to be output on the form buttons `input` elements.' => 'Aggiungi attributi da visualizzare sugli elementi di input dei pulsanti del modulo.',
    75|   'Add attributes to be outputted on this field’s container.' => 'Aggiungi attributi da visualizzare nel contenitore di questo campo.',
    76|   'Add attributes to be outputted on this field’s input.' => 'Aggiungi attributi da visualizzare nell\'input di questo campo.',
    77|   'Add attributes to be outputted on this field’s input. Note that these attributes will be added to every checkbox option.' => 'Aggiungi attributi da visualizzare sull\'input di questo campo. Nota che questi attributi saranno aggiunti a ogni opzione checkbox.',
    78|   'Add attributes to be outputted on this field’s input. Note that these attributes will be added to every radio option.' => 'Aggiungi attributi da visualizzare sull\'input di questo campo. Nota che questi attributi saranno aggiunti a ogni opzione radio.',
    79|   'Add classes that will be output on the form buttons container.' => 'Aggiungi classi da visualizzare nel contenitore dei pulsanti del modulo.',
    80|   'Add classes to be outputted on this field’s container.' => 'Aggiungi classi da visualizzare nel contenitore di questo campo.',
    81|   'Add Column After' => 'Aggiungi colonna dopo',
    82|   'Add Column Before' => 'Aggiungi colonna prima',
    83|   'Add event data to be sent to Google Tag Manager.' => 'Aggiungi i dati dell\'evento da inviare a Google Tag Manager.',
    84|   'Add Existing Field' => 'Aggiungi campo esistente',
    85|   'Add existing fields' => 'Aggiungi campi esistenti',
    86|   'Add Existing Notification' => 'Aggiungi notifica esistente',
    87|   'Add Label' => 'Aggiungi etichetta',
    88|   'Add notification' => 'Aggiungi notifica',
    89|   'Address' => 'Indirizzo',
    90|   'Address - Auto-Complete' => 'Indirizzo - Autocompletamento',
    91|   'Address - City' => 'Indirizzo - Città',
    92|   'Address - Country' => 'Indirizzo - Paese',
    93|   'Address - State / Province' => 'Indirizzo - Stato / Provincia',
    94|   'Address - ZIP / Postal Code' => 'Indirizzo - CAP / Codice postale',
    95|   'Address 1' => 'Indirizzo 1',
    96|   'Address 2' => 'Indirizzo 2',
    97|   'Address 3' => 'Indirizzo 3',
    98|   'Address Book' => 'Rubrica',
    99|   'Address City' => 'Città dell\'indirizzo',
   100|   'Address Country' => 'Paese dell\'indirizzo',
   101|   'Address Country Code' => 'Codice paese dell\'indirizzo',
   102|   'Address Display' => 'Visualizzazione indirizzo',
   103|   'Address Finder' => 'Trova indirizzo',
   104|   'Address Line 1' => 'Indirizzo riga 1',
   105|   'Address Line 2' => 'Indirizzo riga 2',
   106|   'Address Postal Code' => 'CAP indirizzo',
   107|   'Address Postcode' => 'CAP indirizzo',
   108|   'Address Providers' => 'Fornitori di indirizzi',
   109|   'Address Region' => 'Regione dell\'indirizzo',
   110|   'Address State' => 'Stato dell\'indirizzo',
   111|   'Address Street' => 'Via dell\'indirizzo',
   112|   'Address Street 2' => 'Via dell\'indirizzo 2',
   113|   'Address Zipcode' => 'CAP indirizzo',
   114|   'Address Zip Code' => 'CAP indirizzo',
   115|   'Add Row After' => 'Aggiungi riga dopo',
   116|   'Add Row Before' => 'Aggiungi riga prima',
   117|   'Add Row Label' => 'Aggiungi etichetta riga',
   118|   'Add rule' => 'Aggiungi regola',
   119|   'Add Toggle Checkbox' => 'Aggiungi casella di selezione',
   120|   'Add {num} as new field' => 'Aggiungi {num} come nuovo campo',
   121|   'Add {num} as new fields' => 'Aggiungi {num} come nuovi campi',
   122|   'Add {num} as synced field' => 'Aggiungi {num} come campo sincronizzato',
   123|   'Add {num} as synced fields' => 'Aggiungi {num} come campi sincronizzati',
   124|   'Add {num} notification' => 'Aggiungi {num} notifica',
   125|   'Add {num} notifications' => 'Aggiungi {num} notifiche',
   126|   'A description for the status, only visible in the control panel.' => 'Una descrizione per lo stato, visibile solo nel pannello di controllo.',
   127|   'Adestra' => 'Adestra',
   128|   'Advanced' => 'Avanzato',
   129|   'Advanced Fields' => 'Campi avanzati',
   130|   'Advertising/Public Relations' => 'Pubblicità/Relazioni pubbliche',
   131|   'Aerospace/Aviation' => 'Aerospaziale/Aviazione',
   132|   'Afar' => 'Afar',
   133|   'Afghani' => 'Afghano',
   134|   'Africa' => 'Africa',
   135|   'Afrikaans' => 'Afrikaans',
   136|   'After this duration has been met, submissions will be deleted.' => 'Dopo che questa durata è stata raggiunta, gli invii saranno eliminati.',
   137|   'Age' => 'Età',
   138|   'Agent' => 'Agente',
   139|   'Agent Name' => 'Nome agente',
   140|   'Agile CRM' => 'Agile CRM',
   141|   'Agree' => 'Accetto',
   142|   'Agreement' => 'Accordo',
   143|   'Ajax (Client-side)' => 'Ajax (Lato client)',
   144|   'Ajax Submission Timeout' => 'Timeout invio Ajax',
   145|   'Akan' => 'Akan',
   146|   'Albanian' => 'Albanese',
   147|   'Alert Emails' => 'Email di avviso',
   148|   'Algerian Dinar' => 'Dinaro algerino',
   149|   'Algolia Places' => 'Algolia Places',
   150|   'Align Center' => 'Allinea al centro',
   151|   'Align Justify' => 'Giustifica',
   152|   'Align Left' => 'Allinea a sinistra',
   153|   'Align Right' => 'Allinea a destra',
   154|   'All' => 'Tutti',
   155|   'All fields' => 'Tutti i campi',
   156|   'All Form Fields' => 'Tutti i campi del modulo',
   157|   'All forms' => 'Tutti i moduli',
   158|   'All Non Empty Fields' => 'Tutti i campi non vuoti',
   159|   'All notifications' => 'Tutte le notifiche',
   160|   'Allowed Countries' => 'Paesi consentiti',
   161|   'Allow Multiple' => 'Consenti multipli',
   162|   'All Visible Fields' => 'Tutti i campi visibili',
   163|   'All {name} must be unique.' => 'Tutti i {name} devono essere unici.',
   164|   'Always' => 'Sempre',
   165|   'Always Opt-in' => 'Sempre opt-in',
   166|   'AM' => 'AM',
   167|   'AM/PM' => 'AM/PM',
   168|   'Amharic' => 'Amarico',
   169|   'Amount' => 'Importo',
   170|   'An error occurred.' => 'Si è verificato un errore.',
   171|   'An error occurred while generating this PDF.' => 'Si è verificato un errore durante la generazione di questo PDF.',
   172|   'A new handle will be generated for you.' => 'Un nuovo handle sarà generato per te.',
   173|   'An existing form was found with the “{handle}” handle. Choose how you‘d like to handle importing.' => 'È stato trovato un modulo esistente con l\'handle "{handle}". Scegli come desideri gestire l\'importazione.',
   174|   'An ID must be provided' => 'È necessario fornire un ID',
   175|   'An invalid email was entered.' => 'È stata inserita un\'email non valida.',
   176|   'Anniversary' => 'Anniversario',
   177|   'Annual Revenue' => 'Entrate annuali',
   178|   'Annual Salary' => 'Stipendio annuale',
   179|   'Antarctica' => 'Antartide',
   180|   'Any' => 'Qualsiasi',
   181|   'A payment error has occurred “{message}”.' => 'Si è verificato un errore di pagamento "{message}".',
   182|   'API App ID' => 'ID App API',
   183|   'API Email' => 'Email API',
   184|   'API Endpoint' => 'Endpoint API',
   185|   'API error: “{message}” {file}:{line}' => 'Errore API: “{message}” {file}:{line}',
   186|   'API error: “{message}” {file}:{line}. Payload: “{payload}”. Response: “{response}”' => 'Errore API: “{message}” {file}:{line}. Payload: “{payload}”. Risposta: “{response}”',
   187|   'API error: “{response}”. Sent payload {payload}' => 'Errore API: “{response}”. Payload inviato {payload}',
   188|   'API Key' => 'Chiave API',
   189|   'API Password' => 'Password API',
   190|   'API Secret' => 'Secret API',
   191|   'API Service URL' => 'URL servizio API',
   192|   'API Space ID' => 'ID spazio API',
   193|   'API Token' => 'Token API',
   194|   'API URL' => 'URL API',
   195|   'API version' => 'Versione API',
   196|   'Appearance' => 'Aspetto',
   197|   'Append Tags' => 'Aggiungi tag',
   198|   'App ID' => 'ID app',
   199|   'App Key' => 'Chiave app',
   200|   'Application ID' => 'ID applicazione',
   201|   'Apply for Recruitee job offers.' => 'Candidati per le offerte di lavoro su Recruitee.',
   202|   'Arabic' => 'Arabo',
   203|   'Aragonese' => 'Aragonese',
   204|   'Archived' => 'Archiviato',
   205|   'Are you sure you want to cancel this subscription?' => 'Sei sicuro di voler annullare questo abbonamento?',
   206|   'Are you sure you want to delete the selected forms?' => 'Sei sicuro di voler eliminare i moduli selezionati?',
   207|   'Are you sure you want to delete the selected sent notification?' => 'Sei sicuro di voler eliminare la notifica inviata selezionata?',
   208|   'Are you sure you want to delete the selected submissions?' => 'Sei sicuro di voler eliminare le invii selezionate?',
   209|   'Are you sure you want to delete this form?' => 'Sei sicuro di voler eliminare questo modulo?',
   210|   'Are you sure you want to delete this integration?' => 'Sei sicuro di voler eliminare questa integrazione?',
   211|   'Are you sure you want to delete this sent notification?' => 'Sei sicuro di voler eliminare questa notifica inviata?',
   212|   'Are you sure you want to delete this submission?' => 'Sei sicuro di voler eliminare questo invio?',
   213|   'Are you sure you want to delete “{name}”?' => 'Sei sicuro di voler eliminare "{name}"?',
   214|   'Are you sure you want to delete “{name}”? This will also delete all fields for this page, and cannot be undone.' => 'Sei sicuro di voler eliminare "{name}"? Questo eliminerà anche tutti i campi di questa pagina e non potrà essere annullato.',
   215|   'Are you sure you want to leave?' => 'Sei sicuro di voler uscire?',
   216|   'Argentine Peso' => 'Peso argentino',
   217|   'Armenian' => 'Armeno',
   218|   'Armenian Dram' => 'Dram armeno',
   219|   'Arts/Entertainment/Publishing' => 'Arti/Intrattenimento/Editoria',
   220|   'Aruban Florin' => 'Fiorino arubano',
   221|   'Asia' => 'Asia',
   222|   'Assamese' => 'Assamese',
   223|   'Assignee' => 'Assegnatario',
   224|   'Assign To' => 'Assegna a',
   225|   'Associate Degree' => 'Laurea di primo livello',
   226|   'Asterisk for required fields' => 'Asterisco per i campi obbligatori',
   227|   'A summary of your field content will be displayed here.' => 'Un riepilogo del contenuto del tuo campo sarà visualizzato qui.',
   228|   'Async' => 'Asincrono',
   229|   'Async & Defer' => 'Asincrono e Defer',
   230|   'At least one field is required.' => 'È richiesto almeno un campo.',
   231|   'Attach Assets' => 'Allega risorse',
   232|   'Attach File Uploads' => 'Allega file caricati',
   233|   'Attachments' => 'Allegati',
   234|   'Attach PDF Template' => 'Allega modello PDF',
   235|   'AU' => 'AU',
   236|   'Australia' => 'Australia',
   237|   'Australian Dollar' => 'Dollaro australiano',
   238|   'Auth ID' => 'ID Autenticazione',
   239|   'Auth Secret' => 'Secret Autenticazione',
   240|   'Auto' => 'Automatico',
   241|   'Auto-Complete' => 'Completamento automatico',
   242|   'Auto-Complete Integration' => 'Integrazione completamento automatico',
   243|   'Automatic' => 'Automatico',
   244|   'Automotive' => 'Automobilistico',
   245|   'Autopilot' => 'Autopilota',
   246|   'Available Days' => 'Giorni disponibili',
   247|   'Avaric' => 'Avaro',
   248|   'Avestan' => 'Avestico',
   249|   'Avochato' => 'Avochato',
   250|   'AWeber' => 'AWeber',
   251|   'Aymara' => 'Aymara',
   252|   'Azerbaijani' => 'Azerbaigiano',
   253|   'Azerbaijan Manat' => 'Manat azero',
   254|   'A “Hidden” field will be hidden from view, but still rendered. A “Disabled” field will not be rendered on the page at all.' => 'Un campo "Nascosto" sarà nascosto alla vista, ma comunque renderizzato. Un campo "Disabilitato" non sarà affatto renderizzato sulla pagina.',
   255|   'Bachelor‘s Degree' => 'Laurea triennale',
   256|   'Back' => 'Indietro',
   257|   'Back Button Label' => 'Etichetta pulsante Indietro',
   258|   'Background Color' => 'Colore di sfondo',
   259|   'Badge Type' => 'Tipo di badge',
   260|   'Bahamian Dollar' => 'Dollaro bahamense',
   261|   'Bahraini Dinar' => 'Dinaro del Bahrein',
   262|   'Baht' => 'Baht',
   263|   'Balboa,US Dollar' => 'Balboa, Dollaro USA',
   264|   'Bambara' => 'Bambara',
   265|   'Banking/Mortgage' => 'Banca/Mutui',
   266|   'Barbados Dollar' => 'Dollaro di Barbados',
   267|   'Bashkir' => 'Bashkir',
   268|   'Basque' => 'Basco',
   269|   'BCC' => 'BCC',
   270|   'Bcc:' => 'Bcc:',
   271|   'Before you get started, you’ll need a name for your form.' => 'Prima di iniziare, hai bisogno di un nome per il tuo modulo.',
   272|   'Before you get started, you’ll need a name for your stencil.' => 'Prima di iniziare, hai bisogno di un nome per il tuo stencil.',
   273|   'Behavior' => 'Comportamento',
   274|   'Behaviour' => 'Comportamento',
   275|   'Belarusian' => 'Bielorusso',
   276|   'Belarusian Ruble' => 'Rublo bielorusso',
   277|   'Belize Dollar' => 'Dollaro del Belize',
   278|   'Below Input' => 'Sotto l\'input',
   279|   'Benchmark' => 'Benchmark',
   280|   'Bengali' => 'Bengalese',
   281|   'Bermudian Dollar' => 'Dollaro delle Bermuda',
   282|   'Bihari languages' => 'Lingue bihari',
   283|   'Bill every' => 'Fattura ogni',
   284|   'Billing Address' => 'Indirizzo di fatturazione',
   285|   'Billing Details' => 'Dettagli di fatturazione',
   286|   'Billing Email' => 'Email di fatturazione',
   287|   'Billing Info' => 'Informazioni di fatturazione',
   288|   'Billing Name' => 'Nome per la fatturazione',
   289|   'Birthday' => 'Compleanno',
   290|   'Bislama' => 'Bislama',
   291|   'Black' => 'Nero',
   292|   'Blank Form' => 'Modulo vuoto',
   293|   'Blocked Domains' => 'Domini bloccati',
   294|   'Blockquote' => 'Citazione',
   295|   'Blue' => 'Blu',
   296|   'Board' => 'Consiglio',
   297|   'Bokmål, Norwegian; Norwegian Bokmål' => 'Bokmål norvegese; Norvegese Bokmål',
   298|   'Bold' => 'Grassetto',
   299|   'Boliviano' => 'Boliviano',
   300|   'Bolívar' => 'Bolívar',
   301|   'Border' => 'Bordo',
   302|   'Border Color' => 'Colore del bordo',
   303|   'Border Width' => 'Larghezza del bordo',
   304|   'Bosnian' => 'Bosniaco',
   305|   'Bottom-left' => 'In basso a sinistra',
   306|   'Bottom-right' => 'In basso a destra',
   307|   'Bottom of Form' => 'Fondo del modulo',
   308|   'Bottom of List' => 'Fondo dell\'elenco',
   309|   'Brazilian Real' => 'Real brasiliano',
   310|   'Breton' => 'Bretone',
   311|   'Brevo' => 'Brevo',
   312|   'Brunei Dollar' => 'Dollaro del Brunei',
   313|   'Bulgarian' => 'Bulgaro',
   314|   'Bulgarian Lev' => 'Lev bulgaro',
   315|   'Bulk add options' => 'Aggiunta massiva di opzioni',
   316|   'Bulk Add Options' => 'Aggiungi opzioni in blocco',
   317|   'Bulk Resend' => 'Invio massivo',
   318|   'Bulk Resend Email Notification' => 'Reinvia notifiche email in blocco',
   319|   'Bullet List' => 'Elenco puntato',
   320|   'Burmese' => 'Birmano',
   321|   'Burundi Franc' => 'Franco del Burundi',
   322|   'Business Development' => 'Sviluppo aziendale',
   323|   'Business Opportunity' => 'Opportunità di business',
   324|   'Business Phone' => 'Telefono aziendale',
   325|   'Business Phone Number' => 'Numero di telefono aziendale',
   326|   'Business Type ID' => 'ID tipo di attività',
   327|   'Business Unit ID' => 'ID unità aziendale',
   328|   'Button' => 'Pulsante',
   329|   'Button Color' => 'Colore del pulsante',
   330|   'Button Height' => 'Altezza del pulsante',
   331|   'Button Label' => 'Etichetta del pulsante',
   332|   'Button Layout' => 'Layout del pulsante',
   333|   'Button Shape' => 'Forma del pulsante',
   334|   'Button Tagline' => 'Tagline del pulsante',
   335|   'Button Width' => 'Larghezza del pulsante',
   336|   'CA' => 'CA',
   337|   'Cabo Verde Escudo' => 'Escudo di Capo Verde',
   338|   'Calculations' => 'Calcoli',
   339|   'Calculations Formula' => 'Formula dei calcoli',
   340|   'Calendar (Advanced)' => 'Calendario (Avanzato)',
   341|   'Calendar (Simple)' => 'Calendario (Semplice)',
   342|   'Calendar Event' => 'Evento calendario',
   343|   'Calender' => 'Calendario',
   344|   'Call' => 'Chiamata',
   345|   'Campaign ID' => 'ID campagna',
   346|   'Campaign IDs' => 'ID campagne',
   347|   'Campaign Monitor' => 'Campaign Monitor',
   348|   'Campaigns' => 'Campagne',
   349|   'Canadian Dollar' => 'Dollaro canadese',
   350|   'Cancel' => 'Annulla',
   351|   'Candidate Field Mapping' => 'Mappatura dei campi del candidato',
   352|   'Capsule' => 'Capsule',
   353|   'Captchas' => 'Captchas',
   354|   'Card Description' => 'Descrizione della carta',
   355|   'Cardholder Name' => 'Nome del titolare della carta',
   356|   'Card Name' => 'Nome della carta',
   357|   'Card Number' => 'Numero della carta',
   358|   'Card number' => 'Numero della carta',
   359|   'Case Field Mapping' => 'Mappatura dei campi del caso',
   360|   'Catalan; Valencian' => 'Catalano; Valenciano',
   361|   'Categories' => 'Categorie',
   362|   'Cayman Islands Dollar' => 'Dollaro delle Isole Cayman',
   363|   'CC' => 'CC',
   364|   'Cc:' => 'Cc:',
   365|   'CC Emails' => 'Email CC',
   366|   'Center' => 'Centro',
   367|   'Center (Save on Left)' => 'Centro (Salva a sinistra)',
   368|   'Center (Save on Right)' => 'Centro (Salva a destra)',
   369|   'Central Khmer' => 'Khmer centrale',
   370|   'CFA Franc BCEAO' => 'Franco CFA BCEAO',
   371|   'CFA Franc BEAC' => 'Franco CFA BEAC',
   372|   'CFP Franc' => 'Franco CFP',
   373|   'Challenge - Checkbox (v2)' => 'Sfida - Casella di controllo (v2)',
   374|   'Challenge - Invisible (v2)' => 'Sfida - Invisibile (v2)',
   375|   'Chamorro' => 'Chamorro',
   376|   'Changing this may result in data loss.' => 'Modificare questo potrebbe causare la perdita di dati.',
   377|   'Changing this may result in your field not working as expected.' => 'Modificare questo potrebbe far sì che il campo non funzioni come previsto.',
   378|   'Changing this may result in your form not working as expected.' => 'Modificare questo potrebbe far sì che il modulo non funzioni come previsto.',
   379|   'Changing this may result in your notification not working as expected.' => 'Modificare questo potrebbe far sì che la notifica non funzioni come previsto.',
   380|   'Channel' => 'Canale',
   381|   'Channel Type' => 'Tipo di canale',
   382|   'Characters' => 'Caratteri',
   383|   'Chat' => 'Chat',
   384|   'Chechen' => 'Ceceno',
   385|   'Checkbox' => 'Casella di controllo',
   386|   'Checkboxes' => 'Caselle di controllo',
   387|   'Checked Value' => 'Valore selezionato',
   388|   'Check for bots that auto-fill forms, by providing an additional hidden field that should be left blank.' => 'Controlla i bot che riempiono automaticamente i moduli, fornendo un campo nascosto aggiuntivo che dovrebbe essere lasciato vuoto.',
   389|   'Check for duplicate submissions, where bots might be submitting multiple times.' => 'Controlla per invii duplicati, in cui i bot potrebbero inviare più volte.',
   390|   'Check if the user has Javascript enabled, and flag as spam if they do not.' => 'Controlla se l\'utente ha abilitato Javascript, e segnalalo come spam se non lo è.',
   391|   'Chichewa; Chewa; Nyanja' => 'Chichewa; Chewa; Nyanja',
   392|   'Chilean Peso' => 'Peso cileno',
   393|   'Chinese' => 'Cinese',
   394|   'Choose' => 'Scegli',
   395|   'Choose a color for the PayPal button.' => 'Scegli un colore per il pulsante PayPal.',
   396|   'Choose a color to represent the order’s status.' => 'Scegli un colore per rappresentare lo stato dell\'ordine.',
   397|   'Choose a field to opt-in to {name}. For example, you might only wish to record user data if they provide a value for a field of your choice - commonly, an Agree field.' => 'Scegli un campo per aderire a {name}. Ad esempio, potresti voler registrare i dati dell\'utente solo se forniscono un valore per un campo di tua scelta, comunemente un campo "Accetto".',
   398|   'Choose a field to opt-in to {name}. For example, you might only wish to subscribe users if they provide a value for a field of your choice - commonly, an Agree field.' => 'Scegli un campo per aderire a {name}. Ad esempio, potresti voler iscrivere gli utenti solo se forniscono un valore per un campo di tua scelta, comunemente un campo "Accetto".',
   399|   'Choose a label for the PayPal button.' => 'Scegli un\'etichetta per il pulsante PayPal.',
   400|   'Choose an email campaign to send to a contact. Optionally you can set the send date to be in the future.' => 'Scegli una campagna email da inviare a un contatto. Facoltativamente, puoi impostare una data di invio futura.',
   401|   'Choose a specific language for countries to be translated with. Choose "Auto" for Formie to automatically match your site’s language.' => 'Scegli una lingua specifica per tradurre i paesi. Scegli "Auto" per far sì che Formie corrisponda automaticamente alla lingua del tuo sito.',
   402|   'Choose a User' => 'Scegli un utente',
   403|   'Choose how to handle the duplicate form.' => 'Scegli come gestire il modulo duplicato.',
   404|   'Choose how your form fields should map to your {label} attributes.' => 'Scegli come mappare i campi del modulo ai tuoi attributi {label}.',
   405|   'Choose how your form fields should map to your {label} fields.' => 'Scegli come mappare i campi del modulo ai tuoi campi {label}.',
   406|   'Choose how your form fields should map to your {name} columns.' => 'Scegli come mappare i campi del modulo alle tue colonne {name}.',
   407|   'Choose how your form fields should map to your {name} fields.' => 'Scegli come mappare i campi del modulo ai tuoi campi {name}.',
   408|   'Choose how your form fields should map to your {name} {label} fields.' => 'Scegli come mappare i campi del modulo ai tuoi campi {label} {name}.',
   409|   'Choose the form you‘re having issues with.' => 'Scegli il modulo con cui stai riscontrando problemi.',
   410|   'Choose the layout of the PayPal button.' => 'Scegli il layout del pulsante PayPal.',
   411|   'Choose the shape of the PayPal button.' => 'Scegli la forma del pulsante PayPal.',
   412|   'Choose the size for the heading.' => 'Scegli la dimensione dell\'intestazione.',
   413|   'Choose up to {files} files.' => 'Scegli fino a {files} file.',
   414|   'Choose which days of the week should be available.' => 'Scegli quali giorni della settimana dovrebbero essere disponibili.',
   415|   'Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic' => 'Slavo ecclesiastico; Antico slavo ecclesiastico; Bulgaro antico; Antico slavo ecclesiastico',
   416|   'Chuvash' => 'Ciuvasso',
   417|   'City' => 'Città',
   418|   'Clear' => 'Cancella',
   419|   'Clear Format' => 'Cancella formattazione',
   420|   'Clear Formatting' => 'Cancella formattazione',
   421|   'Clerical/Administrative' => 'Clericale/Amministrativo',
   422|   'Client Field Mapping' => 'Mappatura dei campi del cliente',
   423|   'Client Folder ID' => 'ID cartella cliente',
   424|   'Client ID' => 'ID cliente',
   425|   'Client Profile ID' => 'ID profilo cliente',
   426|   'Client Secret' => 'Segreto cliente',
   427|   'Closed' => 'Chiuso',
   428|   'Close Date' => 'Data di chiusura',
   429|   'Closed Date' => 'Data di chiusura',
   430|   'Closed On' => 'Chiuso il',
   431|   'Cloudflare Turnstile' => 'Cloudflare Turnstile',
   432|   'CN' => 'CN',
   433|   'Code' => 'Codice',
   434|   'Code Block' => 'Blocco di codice',
   435|   'Collect IP Addresses' => 'Raccogli indirizzi IP',
   436|   'Collect User' => 'Raccogli utente',
   437|   'Colombian Peso' => 'Peso colombiano',
   438|   'Color' => 'Colore',
   439|   'Column handles can’t be in the format “{format}”.' => 'Le maniglie delle colonne non possono essere nel formato “{format}”.',
   440|   'Column Heading' => 'Intestazione colonna',
   441|   'Column Type' => 'Tipo di colonna',
   442|   'Comments' => 'Commenti',
   443|   'Common Fields' => 'Campi comuni',
   444|   'Comorian Franc' => 'Franco comoriano',
   445|   'Compact' => 'Compatto',
   446|   'Company' => 'Azienda',
   447|   'Company Field Mapping' => 'Mappatura dei campi dell\'azienda',
   448|   'Company ID' => 'ID azienda',
   449|   'Company Name' => 'Nome azienda',
   450|   'Comparison' => 'Confronto',
   451|   'Complete' => 'Completa',
   452|   'Completed' => 'Completato',
   453|   'Condition' => 'Condizione',
   454|   'Conditions' => 'Condizioni',
   455|   'Configure the sub-fields for this field. Move to rearrange columns and rows, and click to edit sub-field settings.' => 'Configura i sotto-campi per questo campo. Sposta per riorganizzare colonne e righe e fai clic per modificare le impostazioni del sotto-campo.',
   456|   'Confirmed Settlement Date' => 'Data di regolamento confermata',
   457|   'Congolese Franc' => 'Franco congolese',
   458|   'Connect' => 'Connetti',
   459|   'Connected' => 'Connesso',
   460|   'Consent To Send SMS' => 'Consenso all\'invio di SMS',
   461|   'Consent To Track' => 'Consenso al tracciamento',
   462|   'Constant Contact' => 'Constant Contact',
   463|   'Construction/Facilities' => 'Costruzione/Impianti',
   464|   'Consumer Goods' => 'Beni di consumo',
   465|   'Consumer Key' => 'Chiave del consumatore',
   466|   'Consumer Secret' => 'Segreto del consumatore',
   467|   'Contact Company ID' => 'ID azienda contatto',
   468|   'Contacted' => 'Contattato',
   469|   'Contact Field Mapping' => 'Mappatura dei campi di contatto',
   470|   'Contact Form' => 'Modulo di contatto',
   471|   'Contact ID' => 'ID contatto',
   472|   'Contact Type' => 'Tipo di contatto',
   473|   'Contact Type ID' => 'ID tipo di contatto',
   474|   'contact_type' => 'tipo_di_contatto',
   475|   'Container Attributes' => 'Attributi del contenitore',
   476|   'contains' => 'contiene',
   477|   'Contains banned IP: “{c}”' => 'Contiene IP bloccato: “{c}”',
   478|   'Contains banned keyword: “{c}”' => 'Contiene parola chiave bloccata: “{c}”',
   479|   'Continents' => 'Continenti',
   480|   'Control Panel URL' => 'URL del pannello di controllo',
   481|   'Convertible Mark' => 'Marco convertibile',
   482|   'ConvertKit' => 'ConvertKit',
   483|   'Cookie Name' => 'Nome del cookie',
   484|   'Cookie Value' => 'Valore del cookie',
   485|   'Copper' => 'Rame',
   486|   'Copy Templates' => 'Copia modelli',
   487|   'Cordoba Oro' => 'Cordoba Oro',
   488|   'Core Table ID' => 'ID tabella principale',
   489|   'Cornish' => 'Cornico',
   490|   'Corsican' => 'Corso',
   491|   'Costa Rican Colon' => 'Colon costaricano',
   492|   'Couldn’t archive status.' => 'Impossibile archiviare lo stato.',
   493|   'Couldn’t archive stencil.' => 'Impossibile archiviare lo stencil.',
   494|   'Couldn’t archive template.' => 'Impossibile archiviare il modello.',
   495|   'Couldn’t duplicate form.' => 'Impossibile duplicare il modulo.',
   496|   'Couldn’t reorder statuses.' => 'Impossibile riordinare gli stati.',
   497|   'Couldn’t reorder templates.' => 'Impossibile riordinare i modelli.',
   498|   'Couldn’t save form.' => 'Impossibile salvare il modulo.',
   499|   'Couldn’t save integration.' => 'Impossibile salvare l\'integrazione.',
   500|   'Couldn’t save integration settings.' => 'Impossibile salvare le impostazioni dell\'integrazione.',
   501|   'Couldn’t save settings.' => 'Impossibile salvare le impostazioni.',
   502|   'Couldn’t save status.' => 'Impossibile salvare lo stato.',
   503|   'Couldn’t save stencil.' => 'Impossibile salvare lo stencil.',
   504|   'Couldn’t save submission.' => 'Impossibile salvare l\'invio.',
   505|   'Couldn’t save submission due to errors.' => 'Impossibile salvare l\'invio a causa di errori.',
   506|   'Couldn’t save template.' => 'Impossibile salvare il modello.',
   507|   'Countries' => 'Paesi',
   508|   'Country' => 'Paese',
   509|   'Country (Full)' => 'Paese (completo)',
   510|   'Country (ISO)' => 'Paese (ISO)',
   511|   'Country Code' => 'Codice paese',
   512|   'Country Default Value' => 'Valore predefinito del paese',
   513|   'Country Enabled' => 'Paese abilitato',
   514|   'Cover Letter' => 'Lettera di presentazione',
   515|   'Craft Team and Formie requires the “Manage all forms” user permission.<br>Visit the {link} settings to enable this permission.' => 'Il Team Craft e Formie richiedono il permesso utente "Gestisci tutti i moduli".<br>Visita le impostazioni {link} per abilitare questo permesso.',
   516|   'Create a New Draft' => 'Crea una nuova bozza',
   517|   'Create a new form' => 'Crea un nuovo modulo',
   518|   'Create a new integration' => 'Crea una nuova integrazione',
   519|   'Create a new status' => 'Crea un nuovo stato',
   520|   'Create a new stencil' => 'Crea un nuovo stencil',
   521|   'Create a new submission' => 'Crea un nuovo invio',
   522|   'Create a new template' => 'Crea un nuovo modello',
   523|   'Created By' => 'Creato da',
   524|   'Create forms' => 'Crea moduli',
   525|   'Create submissions' => 'Crea invii',
   526|   'Create Task for Duplicates' => 'Crea attività per i duplicati',
   527|   'Create your form' => 'Crea il tuo modulo',
   528|   'Create your stencil' => 'Crea il tuo stencil',
   529|   'Cree' => 'Cree',
   530|   'CRM' => 'CRM',
   531|   'Croatian' => 'Croato',
   532|   'CSS Classes' => 'Classi CSS',
   533|   'CSS Options' => 'Opzioni CSS',
   534|   'CSS Render Location' => 'Posizione di rendering CSS',
   535|   'Cuban Peso,Peso Convertible' => 'Peso cubano, Peso convertibile',
   536|   'Currencies' => 'Valute',
   537|   'Currency' => 'Valuta',
   538|   'Current URL' => 'URL corrente',
   539|   'Current URL (without Query String)' => 'URL corrente (senza query string)',
   540|   'Customer Service' => 'Servizio clienti',
   541|   'Customer Source' => 'Fonte cliente',
   542|   'Custom Fields' => 'Campi personalizzati',
   543|   'Custom Recipients' => 'Destinatari personalizzati',
   544|   'Custom Value' => 'Valore personalizzato',
   545|   'CV' => 'CV',
   546|   'CVC' => 'CVC',
   547|   'Czech' => 'Ceco',
   548|   'Czech Koruna' => 'Corona ceca',
   549|   'Dalasi' => 'Dalasi',
   550|   'Danish' => 'Danese',
   551|   'Danish Krone' => 'Corona danese',
   552|   'Dark' => 'Scuro',
   553|   'Dashed' => 'Tratteggiato',
   554|   'Database ID' => 'ID database',
   555|   'Data Center' => 'Data center',
   556|   'Data Retention' => 'Conservazione dei dati',
   557|   'Data Retention Duration' => 'Durata conservazione dati',
   558|   'Date' => 'Data',
   559|   'Date (dd/mm/yyyy)' => 'Data (gg/mm/aaaa)',
   560|   'Date (mm/dd/yyyy)' => 'Data (mm/gg/aaaa)',
   561|   'Date - AM/PM' => 'Data - AM/PM',
   562|   'Date - Day' => 'Data - Giorno',
   563|   'Date - Hour' => 'Data - Ora',
   564|   'Date - Minute' => 'Data - Minuto',
   565|   'Date - Month' => 'Data - Mese',
   566|   'Date - Second' => 'Data - Secondo',
   567|   'Date - Year' => 'Data - Anno',
   568|   'Date/Time' => 'Data/Ora',
   569|   'Date/Time Fields' => 'Campi Data/Ora',
   570|   'Date Closed' => 'Data di Chiusura',
   571|   'Date Format' => 'Formato Data',
   572|   'Date of Birth' => 'Data di Nascita',
   573|   'Date Picker Options' => 'Opzioni Selettore di Data',
   574|   'Date Sent' => 'Data Inviata',
   575|   'Day' => 'Giorno',
   576|   'Days' => 'Giorni',
   577|   'Days of the Week' => 'Giorni della Settimana',
   578|   'Deal Field Mapping' => 'Mappatura Campi Offerta',
   579|   'Deal Name' => 'Nome Offerta',
   580|   'Deal Payment Status ID' => 'ID Stato Pagamento Offerta',
   581|   'Deal Pipeline' => 'Pipeline Offerta',
   582|   'Deal Product ID' => 'ID Prodotto Offerta',
   583|   'Deal Reason ID' => 'ID Motivo Offerta',
   584|   'Deal Stage' => 'Fase dell\'Offerta',
   585|   'Deal Stage ID' => 'ID Fase dell\'Offerta',
   586|   'Deal Type ID' => 'ID Tipo di Offerta',
   587|   'Decimal Points' => 'Punti Decimali',
   588|   'Decimal Rounding' => 'Arrotondamento Decimale',
   589|   'Default' => 'Predefinito',
   590|   'Default Date/Time' => 'Data/Ora Predefinita',
   591|   'Default Date Display Type' => 'Tipo di Visualizzazione Data Predefinito',
   592|   'Default Date Value' => 'Valore Data Predefinito',
   593|   'Default Display Type' => 'Tipo di Visualizzazione Predefinito',
   594|   'Default Email Template' => 'Modello Email Predefinito',
   595|   'Default Entry Author' => 'Autore Inserimento Predefinito',
   596|   'Default Event Author' => 'Autore Evento Predefinito',
   597|   'Default File Upload Volume' => 'Volume di Caricamento File Predefinito',
   598|   'Default Formie Template' => 'Modello Formie Predefinito',
   599|   'Default Form Template' => 'Modello Modulo Predefinito',
   600|   'Default Instructions Position' => 'Posizione Istruzioni Predefinita',
   601|   'Default Label Position' => 'Posizione Etichetta Predefinita',
   602|   'Default options' => 'Opzioni Predefinite',
   603|   'Default Page' => 'Pagina Predefinita',
   604|   'Default Status' => 'Stato Predefinito',
   605|   'Default Submissions State' => 'Stato predefinito degli invii',
   606|   'Default Value' => 'Valore Predefinito',
   607|   'Default Values' => 'Valori Predefiniti',
   608|   'Default Volume' => 'Volume Predefinito',
   609|   'Defer' => 'Posticipa',
   610|   'Define a list of domain names to block. Users entering email addresses containing these domains will be blocked from using them.' => 'Definisci un elenco di nomi di dominio da bloccare. Gli utenti che inseriscono indirizzi email contenenti questi domini saranno bloccati dall\'utilizzarli.',
   611|   'Define the available options.' => 'Definisci le opzioni disponibili.',
   612|   'Define the available options for users to select from.' => 'Definisci le opzioni disponibili che gli utenti possono selezionare.',
   613|   'Define the columns your table should have.' => 'Definisci le colonne della tua tabella.',
   614|   'Define the default values for the field.' => 'Definisci i valori predefiniti per il campo.',
   615|   'Define who should receive this email notification. Define either specific emails, or emails based on conditions.' => 'Definisci chi deve ricevere questa notifica email. Definisci email specifiche o email basate su condizioni.',
   616|   'Definitely' => 'Sicuramente',
   617|   'Definitely Not' => 'Assolutamente no',
   618|   'Delete' => 'Elimina',
   619|   'Delete Column' => 'Elimina Colonna',
   620|   'Deleted' => 'Eliminato',
   621|   'Delete files' => 'Elimina file',
   622|   'Delete forms' => 'Elimina moduli',
   623|   'Delete integration' => 'Elimina integrazione',
   624|   'Delete Row' => 'Elimina Riga',
   625|   'Delete sent notifications' => 'Elimina notifiche inviate',
   626|   'Delete submissions' => 'Elimina invii',
   627|   'Delete Table' => 'Elimina Tabella',
   628|   'Denar' => 'Denaro',
   629|   'Department' => 'Dipartimento',
   630|   'Describe the issue you‘re having.' => 'Descrivi il problema che stai riscontrando.',
   631|   'Description' => 'Descrizione',
   632|   'Detail' => 'Dettaglio',
   633|   'Details' => 'Dettagli',
   634|   'Determine where to render the CSS output for the form.' => 'Determina dove rendere l\'output CSS per il modulo.',
   635|   'Determine where to render the JavaScript output for the form.' => 'Determina dove rendere l\'output JavaScript per il modulo.',
   636|   'Difficult' => 'Difficile',
   637|   'Difficulty' => 'Difficoltà',
   638|   'Directories' => 'Directory',
   639|   'Directory structure example.' => 'Esempio di struttura della directory.',
   640|   'Disabled' => 'Disabilitato',
   641|   'Disabled Field Types' => 'Tipi di Campo Disabilitati',
   642|   'Disagree' => 'Non sono d\'accordo',
   643|   'Disconnect' => 'Disconnetti',
   644|   'Discount' => 'Sconto',
   645|   'Discount Type' => 'Tipo di Sconto',
   646|   'Display a message' => 'Visualizza un messaggio',
   647|   'Display Current Page Title' => 'Mostra Titolo della Pagina Corrente',
   648|   'Display Form Title' => 'Mostra Titolo Modulo',
   649|   'Display Page Progress' => 'Mostra Progresso della Pagina',
   650|   'Display Page Tabs' => 'Mostra Schede della Pagina',
   651|   'Display Type' => 'Tipo di Visualizzazione',
   652|   'Divehi; Dhivehi; Maldivian' => 'Divehi; Dhivehi; Maldiviano',
   653|   'Divorced' => 'Divorziato',
   654|   'Djibouti Franc' => 'Franco Gibutiano',
   655|   'Dobra' => 'Dobra',
   656|   'Domain' => 'Dominio',
   657|   'Dominican Peso' => 'Peso Dominicano',
   658|   'Done' => 'Fatto',
   659|   'Dong' => 'Dong',
   660|   'Do Not Call' => 'Non Chiamare',
   661|   'Do Not Email' => 'Non Inviare Email',
   662|   'Do not use the same email for "From" and "Reply-To". Read [our guide](https://verbb.io/craft-plugins/formie/user-guides/how-to-keep-email-notifications-out-of-your-junk-emails) for tips.' => 'Non utilizzare la stessa email per "Da" e "Rispondi a". Leggi [la nostra guida](https://verbb.io/craft-plugins/formie/user-guides/how-to-keep-email-notifications-out-of-your-junk-emails) per consigli.',
   663|   'Don’t Include' => 'Non Includere',
   664|   'Dotdigital' => 'Dotdigital',
   665|   'Double' => 'Doppio',
   666|   'Dr.' => 'Dott.',
   667|   'Drag and drop a field here' => 'Trascina e rilascia un campo qui',
   668|   'Drip' => 'Drip',
   669|   'Drivers Licence Expiry' => 'Scadenza Patente di Guida',
   670|   'Drivers Licence Number' => 'Numero Patente di Guida',
   671|   'Drivers Licence State' => 'Stato della Patente di Guida',
   672|   'Dropdown' => 'Menu a discesa',
   673|   'Dropdown Options' => 'Opzioni Menu a discesa',
   674|   'Dropdowns' => 'Menu a discesa',
   675|   'Due' => 'Scadenza',
   676|   'Due By' => 'Scadenza entro',
   677|   'Due Date' => 'Data di scadenza',
   678|   'Due On' => 'Scade il',
   679|   'Due Time' => 'Ora di scadenza',
   680|   'Duplicate' => 'Duplica',
   681|   'Duration' => 'Durata',
   682|   'Duration Basis' => 'Base della durata',
   683|   'Dutch; Flemish' => 'Olandese; Fiammingo',
   684|   'Dynamic Value' => 'Valore Dinamico',
   685|   'Dzongkha' => 'Dzongkha',
   686|   'East Caribbean Dollar' => 'Dollaro Caraibico Orientale',
   687|   'Easy' => 'Facile',
   688|   'Edit' => 'Modifica',
   689|   'Edit all submissions' => 'Modifica tutti gli invii',
   690|   'Edit Field' => 'Modifica Campo',
   691|   'Edit Link' => 'Modifica Link',
   692|   'Edit Notification' => 'Modifica Notifica',
   693|   'Edit Pages' => 'Modifica Pagine',
   694|   'Edit submissions for form “{form}”' => 'Modifica invii per il modulo “{form}”',
   695|   'Education' => 'Istruzione',
   696|   'Education/Training' => 'Istruzione/Formazione',
   697|   'Egyptian Pound' => 'Sterlina Egiziana',
   698|   'Element' => 'Elemento',
   699|   'Element Fields' => 'Campi Elemento',
   700|   'Element integration failed for submission “{submission}”. Error: {error} {file}:{line}' => 'Integrazione elemento non riuscita per l\'invio “{submission}”. Errore: {error} {file}:{line}',
   701|   'Elements' => 'Elementi',
   702|   'El Salvador Colon,US Dollar' => 'Colon Salvadoreno, Dollaro Statunitense',
   703|   'Email' => 'Email',
   704|   'Email Address' => 'Indirizzo Email',
   705|   'Email Addresses' => 'Indirizzi Email',
   706|   'Email addresses who receive this email notification. Separate multiple emails with a comma.' => 'Indirizzi email che ricevono questa notifica email. Separare più indirizzi con una virgola.',
   707|   'Email addresses who will receive a BCC of the notification email. Separate multiple emails with a comma.' => 'Indirizzi email che riceveranno una copia nascosta della notifica email. Separare più indirizzi con una virgola.',
   708|   'Email addresses who will receive a CC of the notification email. Separate multiple emails with a comma.' => 'Indirizzi email che riceveranno una copia della notifica email. Separare più indirizzi con una virgola.',
   709|   'Email Campaign' => 'Campagna Email',
   710|   'Email Campaign Mapping' => 'Mappatura Campagna Email',
   711|   'Email Campaign Send Date' => 'Data di Invio Campagna Email',
   712|   'Email Config ID' => 'ID Configurazione Email',
   713|   'Email Content' => 'Contenuto Email',
   714|   'Email Marketing' => 'Email Marketing',
   715|   'Email Notification' => 'Notifica Email',
   716|   'Email Notifications' => 'Notifiche Email',
   717|   'Email Notification Value' => 'Valore Notifica Email',
   718|   'Email Notification was sent successfully.' => 'La notifica email è stata inviata con successo.',
   719|   'EmailOctopus' => 'EmailOctopus',
   720|   'Email Preview' => 'Anteprima Email',
   721|   'Email sent successfully. Please check your email.' => 'Email inviata con successo. Controlla la tua email.',
   722|   'Email Template' => 'Modello Email',
   723|   'Email Templates' => 'Modelli Email',
   724|   'Email Type' => 'Tipo di Email',
   725|   'Employee Count' => 'Numero di Dipendenti',
   726|   'Employees' => 'Dipendenti',
   727|   'Employer' => 'Datore di Lavoro',
   728|   'Employment' => 'Occupazione',
   729|   'Employment Commenced' => 'Occupazione Iniziata',
   730|   'Employment Status' => 'Stato Occupazionale',
   731|   'Empty Value Placeholder' => 'Segnaposto Valore Vuoto',
   732|   'Enable Back Submission' => 'Abilita Invio Retroattivo',
   733|   'Enable Conditions' => 'Abilita Condizioni',
   734|   'Enable Content Encryption' => 'Abilita Cifratura del Contenuto',
   735|   'Enable CSRF Validation for Guests' => 'Abilita Validazione CSRF per Ospiti',
   736|   'Enabled' => 'Abilitato',
   737|   'Enable Form Handler' => 'Abilita Gestore di Moduli',
   738|   'Enable JavaScript Events' => 'Abilita Eventi JavaScript',
   739|   'Enable Sent Notifications' => 'Abilita Notifiche Inviate',
   740|   'Enable this option send nominated email addresses an alert email when an email notification cannot be delivered.' => 'Abilita questa opzione per inviare email di avviso agli indirizzi nominati quando una notifica email non può essere consegnata.',
   741|   'Enable this option to automatically copy template files into the template directory.' => 'Abilita questa opzione per copiare automaticamente i file modello nella directory dei modelli.',
   742|   'Enable this option to output basic layout CSS for row and column support when rendering forms using this template.' => 'Abilita questa opzione per generare CSS di base per il layout di righe e colonne durante il rendering di moduli utilizzando questo modello.',
   743|   'Enable this option to output the base Formie JavaScript when rendering forms using this template. This provides event listeners for forms, ensuring captcha integrations work. Read the [docs](https://verbb.io/craft-plugins/formie/docs/developers/front-end-js) for more information.' => 'Abilita questa opzione per generare il JavaScript di base di Formie durante il rendering dei moduli utilizzando questo modello. Questo fornisce listener per gli eventi dei moduli, garantendo il funzionamento delle integrazioni captcha. Leggi la [documentazione](https://verbb.io/craft-plugins/formie/docs/developers/front-end-js) per ulteriori informazioni.',
   744|   'Enable this option to output the default Formie CSS theme when rendering forms using this template.' => 'Abilita questa opzione per generare il tema CSS predefinito di Formie durante il rendering dei moduli utilizzando questo modello.',
   745|   'Enable this option to output the themed JavaScript when rendering forms using this template. This provides client-side validation, multi-page support, and lots more. Read the [docs](https://verbb.io/craft-plugins/formie/docs/developers/front-end-js) for more information.' => 'Abilita questa opzione per generare il JavaScript tematico durante il rendering dei moduli utilizzando questo modello. Fornisce la validazione lato client, il supporto per moduli multipagina e molto altro. Leggi la [documentazione](https://verbb.io/craft-plugins/formie/docs/developers/front-end-js) per ulteriori informazioni.',
   746|   'Enable this option to use your own template files to render the form.' => 'Abilita questa opzione per utilizzare i tuoi file modello per il rendering del modulo.',
   747|   'Enable this setting to impersonate the user for created records to be set as.' => 'Abilita questa impostazione per impersonare l\'utente per i record creati da impostare.',
   748|   'Enable Unload Warning' => 'Abilita Avviso di Scaricamento',
   749|   'End' => 'Fine',
   750|   'End of form' => 'Fine del modulo',
   751|   'Endpoint' => 'Endpoint',
   752|   'Endpoint required' => 'Endpoint richiesto',
   753|   'Endpoint URL' => 'URL Endpoint',
   754|   'ends with' => 'termina con',
   755|   'Energy/Utilities' => 'Energia/Servizi',
   756|   'Engineering' => 'Ingegneria',
   757|   'English' => 'Inglese',
   758|   'Ensure you have Azure administrator access or an Azure administrator is able to grant permissions to the application. This is required to approve the application in {name}.' => 'Assicurati di avere accesso come amministratore di Azure o che un amministratore di Azure sia in grado di concedere i permessi all\'applicazione. Questo è necessario per approvare l\'applicazione in {name}.',
   759|   'Ensure you understand the implications of disabling Formie‘s JavaScript. Read the [docs](https://verbb.io/craft-plugins/formie/docs/developers/front-end-js) for more information.' => 'Assicurati di comprendere le implicazioni della disabilitazione del JavaScript di Formie. Leggi la [documentazione](https://verbb.io/craft-plugins/formie/docs/developers/front-end-js) per ulteriori informazioni.',
   760|   'Enter a description for the subscription. This will only be shown in Stripe.' => 'Inserisci una descrizione per l\'abbonamento. Verrà mostrata solo in Stripe.',
   761|   'Enter a description for this payment, to appear against the transaction in your Stripe account, and on the payment receipt sent to the customer.' => 'Inserisci una descrizione per questo pagamento, che apparirà nella transazione nel tuo account Stripe e sulla ricevuta di pagamento inviata al cliente.',
   762|   'Enter an optional offset for today‘s date.' => 'Inserisci un offset opzionale per la data di oggi.',
   763|   'Enter a subject to use for the created task.' => 'Inserisci un oggetto da utilizzare per l\'attività creata.',
   764|   'Enter HTML or Twig content to be rendered for this field.' => 'Inserisci contenuto HTML o Twig da rendere per questo campo.',
   765|   'Entering the query parameter to populate the value of the field when it loads.' => 'Inserisci il parametro di query per popolare il valore del campo quando viene caricato.',
   766|   'Enter the email the payment receipt should be delivered to.' => 'Inserisci l\'email a cui deve essere consegnata la ricevuta di pagamento.',
   767|   'Enter the format for uploaded files to be renamed as. Do not include the extension.' => 'Inserisci il formato con cui rinominare i file caricati. Non includere l\'estensione.',
   768|   'Enter the format of the auto-generated submission titles. If left blank, the date/time of submission will be used.' => 'Inserisci il formato dei titoli degli invii generati automaticamente. Se lasciato vuoto, verrà utilizzata la data/ora di invio.',
   769|   'Enter the GUID of a valid systemuser to impersonate.' => 'Inserisci il GUID di un utente di sistema valido da impersonare.',
   770|   'Enter the label for the toggle checkbox field.' => 'Inserisci l\'etichetta per il campo casella di controllo a interruttore.',
   771|   'Enter the minimum score needed to pass the hCaptcha test.' => 'Inserisci il punteggio minimo necessario per superare il test hCaptcha.',
   772|   'Enter the minimum score needed to pass the reCAPTCHA test.' => 'Inserisci il punteggio minimo necessario per superare il test reCAPTCHA.',
   773|   'Enter the name of the cookie to use as the value of this field.' => 'Inserisci il nome del cookie da utilizzare come valore per questo campo.',
   774|   'Enter the {name} Endpoint URL that will be triggered when a submission is made.' => 'Inserisci l\'URL dell\'endpoint {name} che verrà attivato quando viene effettuato un invio.',
   775|   'Enter the {name} Tenant.' => 'Inserisci il tenant {name}.',
   776|   'Enter the {name} webhook URL that will be triggered.' => 'Inserisci l\'URL del webhook {name} che verrà attivato.',
   777|   'Enter the {name} webhook URL that will be triggered when a submission is made.' => 'Inserisci l\'URL del webhook {name} che verrà attivato quando viene effettuato un invio.',
   778|   'Enter title' => 'Inserisci titolo',
   779|   'Enter your email so we can get in touch.' => 'Inserisci la tua email per permetterci di contattarti.',
   780|   'Enter your {name} API password here. This is not your {name} account password.' => 'Inserisci qui la tua password API {name}. Questa non è la password del tuo account {name}.',
   781|   'Enter your {name} Form Base URL here if you wish to map to a {name} form.' => 'Inserisci qui l\'URL di base del modulo {name} se desideri mappare un modulo {name}.',
   782|   'Enter your {name} {label} here, if different to your API Key.' => 'Inserisci qui il tuo {name} {label}, se diverso dalla tua chiave API.',
   783|   'Enter your {name} {label} here.' => 'Inserisci qui il tuo {name} {label}.',
   784|   'Enter your {name} {label} here. e.g. `{link}`' => 'Inserisci qui il tuo {name} {label}. Ad esempio `{link}`',
   785|   'Entries' => 'Voci',
   786|   'Entry' => 'Voce',
   787|   'Entry Attribute Mapping' => 'Mappatura Attributo Voce',
   788|   'Entry Field Mapping' => 'Mappatura Campo Voce',
   789|   'Entry Type' => 'Tipo di Voce',
   790|   'Error in form handler response {response}. Sent payload {payload}' => 'Errore nella risposta del gestore del modulo {response}. Payload inviato {payload}',
   791|   'Error Message' => 'Messaggio di Errore',
   792|   'Error Message Position' => 'Posizione Messaggio di Errore',
   793|   'Error sending test email.' => 'Errore durante l\'invio dell\'email di prova.',
   794|   'Esperanto' => 'Esperanto',
   795|   'Estonian' => 'Estone',
   796|   'Ethiopian Birr' => 'Birr Etiope',
   797|   'EU' => 'UE',
   798|   'Euro' => 'Euro',
   799|   'Europe' => 'Europa',
   800|   'Event Attribute Mapping' => 'Mappatura attributo evento',
   801|   'Event Field Mapping' => 'Mappatura campo evento',
   802|   'Every day' => 'Ogni giorno',
   803|   'every {num, number} {num, plural, =1{day} other{days}}' => 'ogni {num, number} {num, plural, =1{giorno} other{giorni}}',
   804|   'every {num, number} {num, plural, =1{month} other{months}}' => 'ogni {num, number} {num, plural, =1{mese} other{mesi}}',
   805|   'every {num, number} {num, plural, =1{week} other{weeks}}' => 'ogni {num, number} {num, plural, =1{settimana} other{settimane}}',
   806|   'every {num, number} {num, plural, =1{year} other{years}}' => 'ogni {num, number} {num, plural, =1{anno} other{anni}}',
   807|   'Ewe' => 'Ewe',
   808|   'Exception while processing webhook: “{message}” {file}:{line}. Trace: “{trace}”.' => 'Eccezione durante l\'elaborazione del webhook: “{message}” {file}:{line}. Traccia: “{trace}”.',
   809|   'Execute' => 'Esegui',
   810|   'Existing Amount' => 'Importo esistente',
   811|   'Existing fields' => 'Campi esistenti',
   812|   'Expected Close' => 'Chiusura prevista',
   813|   'Expected Close On' => 'Chiusura prevista il',
   814|   'Expected Settlement Date' => 'Data di regolamento prevista',
   815|   'Expected Value' => 'Valore previsto',
   816|   'Expired Message' => 'Messaggio scaduto',
   817|   'Expiry' => 'Scadenza',
   818|   'Export' => 'Esporta',
   819|   'Extra Extra Large' => 'Extra Extra Large',
   820|   'Extra Extra Small' => 'Extra Extra Small',
   821|   'Extra Large' => 'Extra Large',
   822|   'Extra Small' => 'Extra Small',
   823|   'Facebook' => 'Facebook',
   824|   'Fail alert not configured to send.' => 'Avviso di fallimento non configurato per l\'invio.',
   825|   'Fail alert settings are invalid: “{errors}”.' => 'Le impostazioni dell\'avviso di fallimento non sono valide: “{errors}”.',
   826|   'Failed' => 'Fallito',
   827|   'Failed Captcha “{c}”: “{m}”' => 'Captcha fallito “{c}”: “{m}”',
   828|   'Failure alert email could not be sent for submission “{submission}”. Error: {error} {file}:{line}' => 'L\'email di avviso di fallimento non può essere inviata per l\'invio “{submission}”. Errore: {error} {file}:{line}',
   829|   'False' => 'Falso',
   830|   'Faroese' => 'Faroese',
   831|   'Fax' => 'Fax',
   832|   'Feedback Widget' => 'Widget di feedback',
   833|   'Female' => 'Femminile',
   834|   'Field' => 'Campo',
   835|   'Field Mapping' => 'Mappatura campo',
   836|   'Field missing' => 'Campo mancante',
   837|   'Fields' => 'Campi',
   838|   'Fields will by default have their instructions position set to this option.' => 'I campi avranno per impostazione predefinita la posizione delle istruzioni impostata su questa opzione.',
   839|   'Fields will by default have their label position set to this option.' => 'I campi avranno per impostazione predefinita la posizione dell\'etichetta impostata su questa opzione.',
   840|   'Fijian' => 'Fijiano',
   841|   'Fiji Dollar' => 'Dollaro delle Figi',
   842|   'File must be larger than {filesize} MB.' => 'Il file deve essere più grande di {filesize} MB.',
   843|   'File must be smaller than {filesize} MB.' => 'Il file deve essere più piccolo di {filesize} MB.',
   844|   'Filename Format' => 'Formato del nome del file',
   845|   'File Upload' => 'Caricamento file',
   846|   'File Upload Fields' => 'Campi di caricamento file',
   847|   'File Uploads' => 'Caricamenti file',
   848|   'Finance Date' => 'Data finanziaria',
   849|   'Finnish' => 'Finlandese',
   850|   'First Name' => 'Nome',
   851|   'First Response Due By' => 'Prima risposta entro il',
   852|   'Fitle' => 'Titolo',
   853|   'Fixed' => 'Fisso',
   854|   'Fixed Value' => 'Valore fisso',
   855|   'Focus' => 'Focus',
   856|   'Follow Up' => 'Follow-up',
   857|   'Force a specific language when displaying Friendly Captcha. Choose "Auto" for Formie to automatically match your site’s language.' => 'Forza una lingua specifica quando visualizzi Friendly Captcha. Scegli "Auto" per far corrispondere automaticamente la lingua del tuo sito.',
   858|   'Force a specific language when displaying hCaptcha. Choose "Auto" for Formie to automatically match your site’s language.' => 'Forza una lingua specifica quando visualizzi hCaptcha. Scegli "Auto" per far corrispondere automaticamente la lingua del tuo sito.',
   859|   'Force a specific language when displaying reCAPTCHA. Choose "Auto" for Formie to automatically match your site’s language.' => 'Forza una lingua specifica quando visualizzi reCAPTCHA. Scegli "Auto" per far corrispondere automaticamente la lingua del tuo sito.',
   860|   'Forever' => 'Per sempre',
   861|   'Forint' => 'Fiorino',
   862|   'Form' => 'Modulo',
   863|   'Form Appearance' => 'Aspetto del modulo',
   864|   'Formatting' => 'Formattazione',
   865|   'Form Base URL' => 'URL base del modulo',
   866|   'Form Buttons Position' => 'Posizione dei pulsanti del modulo',
   867|   'Form Default' => 'Modulo predefinito',
   868|   'Form Field' => 'Campo del modulo',
   869|   'Form Field Mapping' => 'Mappatura campo modulo',
   870|   'Form Fields' => 'Campi del modulo',
   871|   'Formie' => 'Formie',
   872|   'Formie Form' => 'Modulo Formie',
   873|   'Form imported.' => 'Modulo importato.',
   874|   'Form Name' => 'Nome del modulo',
   875|   'Forms' => 'Moduli',
   876|   'Forms (Formie)' => 'Moduli (Formie)',
   877|   'Form saved.' => 'Modulo salvato.',
   878|   'Forms deleted.' => 'Moduli eliminati.',
   879|   'Form Settings' => 'Impostazioni del modulo',
   880|   'Forms migrated.' => 'Moduli migrati.',
   881|   'Forms not restored.' => 'Moduli non ripristinati.',
   882|   'Forms restored.' => 'Moduli ripristinati.',
   883|   'Form Submission' => 'Invio modulo',
   884|   'Form Templates' => 'Modelli di modulo',
   885|   'For multi-page forms, choose whether to show the captcha on all pages of the form, or only on the final page of the form.' => 'Per moduli multi-pagina, scegli se mostrare il captcha su tutte le pagine del modulo o solo sull\'ultima pagina.',
   886|   'Form Usage' => 'Utilizzo del modulo',
   887|   'Found {num} error' => 'Trovato {num} errore',
   888|   'Found {num} errors' => 'Trovati {num} errori',
   889|   'Freeform' => 'Freeform',
   890|   'French' => 'Francese',
   891|   'Frequency' => 'Frequenza',
   892|   'Freshdesk' => 'Freshdesk',
   893|   'Freshsales' => 'Freshsales',
   894|   'Friendly Captcha' => 'Friendly Captcha',
   895|   'Friendly Captcha employs a fundamentally new approach to securely defend your websites and online services from spam and bots. Find out more via [Cloudflare Turnstile](https://blog.cloudflare.com/turnstile-private-captcha-alternative/).' => 'Friendly Captcha adotta un approccio fondamentalmente nuovo per difendere in modo sicuro i tuoi siti web e servizi online da spam e bot. Scopri di più tramite [Cloudflare Turnstile](https://blog.cloudflare.com/turnstile-private-captcha-alternative/).',
   896|   'Friendly Captcha employs a fundamentally new approach to securely defend your websites and online services from spam and bots. Find out more via [Friendly Captcha](https://friendlycaptcha.com/).' => 'Friendly Captcha adotta un approccio fondamentalmente nuovo per difendere in modo sicuro i tuoi siti web e servizi online da spam e bot. Scopri di più tramite [Friendly Captcha](https://friendlycaptcha.com/).',
   897|   'From:' => 'Da:',
   898|   'From Email' => 'Email mittente',
   899|   'From Name' => 'Nome mittente',
   900|   'Fulah' => 'Fulah',
   901|   'Full-Time' => 'Tempo pieno',
   902|   'Full Country Name (e.g. United States)' => 'Nome completo del paese (es. Stati Uniti)',
   903|   'Gaelic; Scottish Gaelic' => 'Gaelico; Gaelico scozzese',
   904|   'Galician' => 'Galiziano',
   905|   'Ganda' => 'Ganda',
   906|   'Gender' => 'Genere',
   907|   'General' => 'Generale',
   908|   'General Fields' => 'Campi generali',
   909|   'General Settings' => 'Impostazioni generali',
   910|   'Geocoding API Key' => 'Chiave API di geocodifica',
   911|   'Georgian' => 'Georgiano',
   912|   'German' => 'Tedesco',
   913|   'GetResponse' => 'GetResponse',
   914|   'Get Support' => 'Ottieni supporto',
   915|   'Ghana Cedi' => 'Cedi del Ghana',
   916|   'Gibraltar Pound' => 'Sterlina di Gibilterra',
   917|   'Gold' => 'Oro',
   918|   'Google Console API Key' => 'Chiave API di Google Console',
   919|   'Google Places' => 'Google Places',
   920|   'Google Sheets' => 'Google Sheets',
   921|   'Google Tag Manager Event Data' => 'Dati evento di Google Tag Manager',
   922|   'Gourde,US Dollar' => 'Gourde,Dollaro USA',
   923|   'Government/Military' => 'Governo/Militare',
   924|   'Graduate or Professional Degree' => 'Laurea o titolo professionale',
   925|   'greater than' => 'maggiore di',
   926|   'Greek, Modern (1453-)' => 'Greco, moderno (dal 1453)',
   927|   'Green' => 'Verde',
   928|   'Group' => 'Gruppo',
   929|   'Group ID' => 'ID gruppo',
   930|   'Guarani' => 'Guaranì',
   931|   'Guinean Franc' => 'Franco della Guinea',
   932|   'Gujarati' => 'Gujarati',
   933|   'Guyana Dollar' => 'Dollaro della Guyana',
   934|   'H2' => 'H2',
   935|   'H3' => 'H3',
   936|   'H4' => 'H4',
   937|   'H5' => 'H5',
   938|   'H6' => 'H6',
   939|   'Haitian; Haitian Creole' => 'Haitiano; Creolo haitiano',
   940|   'Handle' => 'Handle',
   941|   'Handle must be unique.' => 'L\'handle deve essere univoco.',
   942|   'Hausa' => 'Hausa',
   943|   'Having issues using {name}? Enter your details below, so we can assist.' => 'Hai problemi ad usare {name}? Inserisci i tuoi dettagli qui sotto, così possiamo aiutarti.',
   944|   'hCaptcha' => 'hCaptcha',
   945|   'hCaptcha is an anti-bot solution that protects user privacy and rewards websites. It is the most popular reCAPTCHA alternative. Find out more via [hCaptcha](https://www.hcaptcha.com/).' => 'hCaptcha è una soluzione anti-bot che protegge la privacy degli utenti e premia i siti web. È l\'alternativa più popolare a reCAPTCHA. Scopri di più tramite [hCaptcha](https://www.hcaptcha.com/).',
   946|   'hCaptcha Site Key' => 'Chiave sito hCaptcha',
   947|   'Heading' => 'Intestazione',
   948|   'Heading 1' => 'Intestazione 1',
   949|   'Heading 2' => 'Intestazione 2',
   950|   'Heading 3' => 'Intestazione 3',
   951|   'Heading 4' => 'Intestazione 4',
   952|   'Heading 5' => 'Intestazione 5',
   953|   'Heading 6' => 'Intestazione 6',
   954|   'Heading Size' => 'Dimensione dell\'intestazione',
   955|   'Heading Text' => 'Testo dell\'intestazione',
   956|   'Healthcare' => 'Sanità',
   957|   'Hebrew' => 'Ebraico',
   958|   'Herero' => 'Herero',
   959|   'Hidden' => 'Nascosto',
   960|   'Hidden Field' => 'Campo nascosto',
   961|   'Hide' => 'Nascondi',
   962|   'Hide Form' => 'Nascondi modulo',
   963|   'Hide Icon' => 'Nascondi icona',
   964|   'Hide ZIP / Postal Code' => 'Nascondi CAP',
   965|   'High' => 'Alto',
   966|   'Highlight' => 'Evidenzia',
   967|   'High School' => 'Scuola superiore',
   968|   'Hindi' => 'Hindi',
   969|   'Hiri Motu' => 'Hiri Motu',
   970|   'Homemaker' => 'Casalinga',
   971|   'Home Phone' => 'Telefono di casa',
   972|   'Home Phone Number' => 'Numero di telefono di casa',
   973|   'Home Suburb' => 'Sobborgo di casa',
   974|   'Honeypot' => 'Honeypot',
   975|   'Honeypot input has value: {v}.' => 'Il campo honeypot ha un valore: {v}.',
   976|   'Honeypot param missing: {v}.' => 'Parametro honeypot mancante: {v}.',
   977|   'Hong Kong Dollar' => 'Dollaro di Hong Kong',
   978|   'Horizontal' => 'Orizzontale',
   979|   'Horizontal Rule' => 'Regola orizzontale',
   980|   'Hospitality/Travel' => 'Ospitalità/Viaggi',
   981|   'Hour' => 'Ora',
   982|   'How Long' => 'Quanto a lungo',
   983|   'How long to retain form submission data for.' => 'Quanto a lungo conservare i dati di invio del modulo.',
   984|   'How many decimals to round the number to.' => 'A quanti decimali arrotondare il numero.',
   985|   'How Often' => 'Quanto spesso',
   986|   'How the form buttons should be positioned.' => 'Come dovrebbero essere posizionati i pulsanti del modulo.',
   987|   'How the instructions for the field should be positioned.' => 'Come dovrebbero essere posizionate le istruzioni per il campo.',
   988|   'How the label for the field should be positioned.' => 'Come dovrebbe essere posizionata l\'etichetta per il campo.',
   989|   'How the label for the subfields should be positioned.' => 'Come dovrebbe essere posizionata l\'etichetta per i sotto-campi.',
   990|   'How to redirect the user after submission, whether in the same tab, or a new tab.' => 'Come reindirizzare l\'utente dopo l\'invio, nella stessa scheda o in una nuova.',
   991|   'How you’ll refer to this field in your templates. Use the refresh icon to re-generate this from your field label.' => 'Come farai riferimento a questo campo nei tuoi modelli. Usa l\'icona di aggiornamento per rigenerarlo dalla tua etichetta del campo.',
   992|   'How you’ll refer to this form in the templates.' => 'Come farai riferimento a questo modulo nei modelli.',
   993|   'How you’ll refer to this form in your templates. Use the refresh icon to re-generate this from your form name.' => 'Come farai riferimento a questo modulo nei tuoi modelli. Usa l\'icona di aggiornamento per rigenerarlo dal nome del modulo.',
   994|   'How you’ll refer to this integration in the templates.' => 'Come farai riferimento a questa integrazione nei modelli.',
   995|   'How you’ll refer to this notification in your templates. Use the refresh icon to re-generate this from your notification name.' => 'Come farai riferimento a questa notifica nei tuoi modelli. Usa l\'icona di aggiornamento per rigenerarlo dal nome della notifica.',
   996|   'How you’ll refer to this status in the templates.' => 'Come farai riferimento a questo stato nei modelli.',
   997|   'How you’ll refer to this template in the templates.' => 'Come farai riferimento a questo modello nei modelli.',
   998|   'Hryvnia' => 'Hrivnia',
   999|   'Html' => 'Html',
  1000|   'HTML' => 'HTML',
  1001|   'HTML Content' => 'Contenuto HTML',
  1002|   'HTML Template' => 'Modello HTML',
  1003|   'HTTP Refer URL' => 'URL di riferimento HTTP',
  1004|   'HTTP User Agent' => 'User agent HTTP',
  1005|   'HubSpot' => 'HubSpot',
  1006|   'HubSpot (Legacy)' => 'HubSpot (Legacy)',
  1007|   'Human Resources' => 'Risorse umane',
  1008|   'Hungarian' => 'Ungherese',
  1009|   'Icelandic' => 'Islandese',
  1010|   'Iceland Krona' => 'Corona islandese',
  1011|   'iContact' => 'iContact',
  1012|   'ID' => 'ID',
  1013|   'ID Code' => 'Codice ID',
  1014|   'Ido' => 'Ido',
  1015|   'ID of the Double opt-in (DOI) template.' => 'ID del modello di doppio opt-in (DOI).',
  1016|   'If a Lead is detected as duplicate, a new {name} Task object will be created.' => 'Se viene rilevato un Lead duplicato, verrà creato un nuovo oggetto Task {name}.',
  1017|   'If a submission contains any of these words (in any field), it will be marked as spam. One word or IP address per line. It will also match words within other words (e.g. ’craft’ will match ’crafty’). Case insensitive.' => 'Se un invio contiene una qualsiasi di queste parole (in un qualsiasi campo), sarà contrassegnato come spam. Una parola o indirizzo IP per riga. Corrisponderà anche a parole all\'interno di altre parole (es. “craft” corrisponderà a “crafty”). Case insensitive.',
  1018|   'If not correctly configured, setting the "From" setting can lead to deliverability issues. Read [our guide](https://verbb.io/craft-plugins/formie/user-guides/how-to-keep-email-notifications-out-of-your-junk-emails) for tips.' => 'Se non configurato correttamente, l\'impostazione del campo "Da" può causare problemi di consegna. Leggi [la nostra guida](https://verbb.io/craft-plugins/formie/user-guides/how-to-keep-email-notifications-out-of-your-junk-emails) per suggerimenti.',
  1019|   'If you use custom templates, you will not receive template improvements and bug fixes. If possible, it is suggested to use the default template and create your own style.' => 'Se utilizzi modelli personalizzati, non riceverai miglioramenti e correzioni di bug. Se possibile, si suggerisce di usare il modello predefinito e creare il proprio stile.',
  1020|   'Igbo' => 'Igbo',
  1021|   'Image' => 'Immagine',
  1022|   'Image URL' => 'URL immagine',
  1023|   'Impersonate User' => 'Impersona utente',
  1024|   'Impersonate User ID' => 'Impersona ID utente',
  1025|   'Impersonation Header' => 'Intestazione di impersonificazione',
  1026|   'Import' => 'Importa',
  1027|   'Import/Export' => 'Importa/Esporta',
  1028|   'Importance' => 'Importanza',
  1029|   'Important' => 'Importante',
  1030|   'Import Completed' => 'Importazione completata',
  1031|   'Import File' => 'Importa file',
  1032|   'IN' => 'IN',
  1033|   'Incident Field Mapping' => 'Mappatura campo incidente',
  1034|   'Include Draft Elements' => 'Includi elementi bozza',
  1035|   'Include in Email Notifications' => 'Includi nelle notifiche email',
  1036|   'Include Revision Elements' => 'Includi elementi revisione',
  1037|   'Incomplete' => 'Incompleto',
  1038|   'Indian Rupee' => 'Rupia indiana',
  1039|   'Indian Rupee,Ngultrum' => 'Rupia indiana,Ngultrum',
  1040|   'Indonesian' => 'Indonesiano',
  1041|   'Industry' => 'Settore',
  1042|   'Industry Type ID' => 'ID tipo di settore',
  1043|   'Infusionsoft' => 'Infusionsoft',
  1044|   'Inline' => 'In linea',
  1045|   'Inline Code' => 'Codice in linea',
  1046|   'In Progress' => 'In corso',
  1047|   'Input Attributes' => 'Attributi di input',
  1048|   'Insert Link' => 'Inserisci link',
  1049|   'Insert Table' => 'Inserisci tabella',
  1050|   'Inside Form' => 'All\'interno del modulo',
  1051|   'Insightly' => 'Insightly',
  1052|   'Installation/Maintenance' => 'Installazione/Manutenzione',
  1053|   'Instructions' => 'Istruzioni',
  1054|   'Instructions Position' => 'Posizione delle istruzioni',
  1055|   'Instructions to guide the user when filling out this form.' => 'Istruzioni per guidare l\'utente nella compilazione di questo modulo.',
  1056|   'Insurance' => 'Assicurazione',
  1057|   'Integrate with the [Craft Campaign](https://plugins.craftcms.com/campaign) plugin.' => 'Integra con il plugin [Craft Campaign](https://plugins.craftcms.com/campaign).',
  1058|   'Integration deleted.' => 'Integrazione eliminata.',
  1059|   'Integration failed to run.' => 'Impossibile eseguire l\'integrazione.',
  1060|   'Integration Key' => 'Chiave di integrazione',
  1061|   'Integration not found.' => 'Integrazione non trovata.',
  1062|   'Integration Password' => 'Password di integrazione',
  1063|   'Integration Provider' => 'Provider di integrazione',
  1064|   'Integrations' => 'Integrazioni',
  1065|   'Integration saved.' => 'Integrazione salvata.',
  1066|   'Integration settings can only be editable on an environment with `allowAdminChanges` enabled.' => 'Le impostazioni dell\'integrazione possono essere modificate solo in un ambiente con `allowAdminChanges` abilitato.',
  1067|   'Integration settings saved.' => 'Impostazioni di integrazione salvate.',
  1068|   'Integration was run successfully.' => 'Integrazione eseguita con successo.',
  1069|   'Interaction Only' => 'Solo interazione',
  1070|   'Interest Categories' => 'Categorie di interesse',
  1071|   'Interlingua (International Auxiliary Language Association)' => 'Interlingua (Associazione Internazionale della Lingua Ausiliaria)',
  1072|   'Interlingue; Occidental' => 'Interlingue; Occidentale',
  1073|   'Internal' => 'Interno',
  1074|   'Internet' => 'Internet',
  1075|   'Inuktitut' => 'Inuktitut',
  1076|   'Inupiaq' => 'Inupiaq',
  1077|   'Invalid companyName' => 'Nome azienda non valido',
  1078|   'Invalid element #{element}' => 'Elemento non valido #{element}',
  1079|   'Invalid subscription status {response}. Sent payload {payload}' => 'Stato dell\'abbonamento non valido {response}. Payload inviato {payload}',
  1080|   'Invisible' => 'Invisibile',
  1081|   'Iranian Rial' => 'Rial iraniano',
  1082|   'Iraqi Dinar' => 'Dinaro iracheno',
  1083|   'Irish' => 'Irlandese',
  1084|   'is' => 'è',
  1085|   'Is Client' => 'È cliente',
  1086|   'Is Complete' => 'È completo',
  1087|   'is not' => 'non è',
  1088|   'Is Supplier' => 'È fornitore',
  1089|   'Is Unsubscribed' => 'È disiscritto',
  1090|   'Italian' => 'Italiano',
  1091|   'Italic' => 'Corsivo',
  1092|   'Iterable' => 'Iterabile',
  1093|   'I want to' => 'Voglio',
  1094|   'Jamaican Dollar' => 'Dollaro giamaicano',
  1095|   'Japanese' => 'Giapponese',
  1096|   'Javanese' => 'Giavanese',
  1097|   'Javascript' => 'Javascript',
  1098|   'JavaScript Options' => 'Opzioni JavaScript',
  1099|   'JavaScript Render Location' => 'Posizione di rendering JavaScript',
  1100|   'Job Search Aids' => 'Aiuti per la ricerca di lavoro',
  1101|   'Job Title' => 'Titolo di lavoro',
  1102|   'Jordanian Dinar' => 'Dinaro giordano',
  1103|   'JP' => 'JP',
  1104|   'Kalaallisut; Greenlandic' => 'Kalaallisut; Groenlandese',
  1105|   'Kannada' => 'Kannada',
  1106|   'Kanuri' => 'Kanuri',
  1107|   'Kashmiri' => 'Kashmiri',
  1108|   'Kazakh' => 'Kazako',
  1109|   'Kenyan Shilling' => 'Scellino keniota',
  1110|   'Keyword' => 'Parola chiave',
  1111|   'Kikuyu; Gikuyu' => 'Kikuyu; Gikuyu',
  1112|   'Kina' => 'Kina',
  1113|   'Kinyarwanda' => 'Kinyarwanda',
  1114|   'Kirghiz; Kyrgyz' => 'Chirghiso; Kirghiso',
  1115|   'Klaviyo' => 'Klaviyo',
  1116|   'Klaviyo (Legacy)' => 'Klaviyo (Legacy)',
  1117|   'Komi' => 'Komi',
  1118|   'Kongo' => 'Kongo',
  1119|   'Korean' => 'Coreano',
  1120|   'Kuanyama; Kwanyama' => 'Kuanyama; Kwanyama',
  1121|   'Kuna' => 'Kuna',
  1122|   'Kurdish' => 'Curdo',
  1123|   'Kuwaiti Dinar' => 'Dinaro kuwaitiano',
  1124|   'Kwanza' => 'Kwanza',
  1125|   'Kyat' => 'Kyat',
  1126|   'Label' => 'Etichetta',
  1127|   'Label Position' => 'Posizione etichetta',
  1128|   'Label Source' => 'Fonte etichetta',
  1129|   'Language' => 'Lingua',
  1130|   'Languages' => 'Lingue',
  1131|   'Lao' => 'Lao',
  1132|   'Lao Kip' => 'Kip laotiano',
  1133|   'Large' => 'Grande',
  1134|   'Lari' => 'Lari',
  1135|   'Last Name' => 'Cognome',
  1136|   'Latin' => 'Latino',
  1137|   'Latvian' => 'Lettone',
  1138|   'Law Enforcement/Security' => 'Forze dell\'ordine/Sicurezza',
  1139|   'Layout' => 'Layout',
  1140|   'Lead Field Mapping' => 'Mappatura campo lead',
  1141|   'Lead ID' => 'ID lead',
  1142|   'Lead Reason ID' => 'ID ragione del lead',
  1143|   'Lead Score' => 'Punteggio lead',
  1144|   'Lead Source' => 'Fonte lead',
  1145|   'Lead Source Display' => 'Visualizzazione fonte lead',
  1146|   'Lead Source ID' => 'ID fonte lead',
  1147|   'Lead Source Name' => 'Nome fonte lead',
  1148|   'Lead Stage ID' => 'ID fase lead',
  1149|   'Lead Status ID' => 'ID stato lead',
  1150|   'Leave this field blank' => 'Lascia questo campo vuoto',
  1151|   'Lebanese Pound' => 'Lira libanese',
  1152|   'Left' => 'Sinistra',
  1153|   'Left & Right' => 'Sinistra & Destra',
  1154|   'Left of Input' => 'A sinistra dell\'input',
  1155|   'Legal' => 'Legale',
  1156|   'Legal Consent Options' => 'Opzioni di consenso legale',
  1157|   'Lek' => 'Lek',
  1158|   'Lempira' => 'Lempira',
  1159|   'Lender' => 'Mutuante',
  1160|   'Lender Name Short' => 'Nome breve del mutuante',
  1161|   'Lender Reference' => 'Riferimento del mutuante',
  1162|   'Leone' => 'Leone',
  1163|   'less than' => 'meno di',
  1164|   'Less than a month' => 'Meno di un mese',
  1165|   'Less than once a month' => 'Meno di una volta al mese',
  1166|   'Liberian Dollar' => 'Dollaro liberiano',
  1167|   'Libyan Dinar' => 'Dinaro libico',
  1168|   'Light' => 'Leggero',
  1169|   'Lilangeni' => 'Lilangeni',
  1170|   'Limburgan; Limburger; Limburgish' => 'Limburghese',
  1171|   'Limit' => 'Limite',
  1172|   'Limited to {limit} characters.' => 'Limitato a {limit} caratteri.',
  1173|   'Limited to {limit} words.' => 'Limitato a {limit} parole.',
  1174|   'Limit Number of Files' => 'Limita il numero di file',
  1175|   'Limit Numbers' => 'Limita i numeri',
  1176|   'Limit Options' => 'Limita le opzioni',
  1177|   'Limit Submissions' => 'Limita gli invii',
  1178|   'Limit the number of available categories.' => 'Limita il numero di categorie disponibili.',
  1179|   'Limit the number of available entries.' => 'Limita il numero di voci disponibili.',
  1180|   'Limit the number of available products.' => 'Limita il numero di prodotti disponibili.',
  1181|   'Limit the number of available users.' => 'Limita il numero di utenti disponibili.',
  1182|   'Limit the number of available variants.' => 'Limita il numero di varianti disponibili.',
  1183|   'Limit the number of files a user can upload.' => 'Limita il numero di file che un utente può caricare.',
  1184|   'Limit the number of selectable products.' => 'Limita il numero di prodotti selezionabili.',
  1185|   'Limit the number of selectable users.' => 'Limita il numero di utenti selezionabili.',
  1186|   'Limit the number of selectable variants.' => 'Limita il numero di varianti selezionabili.',
  1187|   'Limit Value' => 'Valore limite',
  1188|   'Line Break' => 'Interruzione di linea',
  1189|   'Lingala' => 'Lingala',
  1190|   'Link' => 'Link',
  1191|   'LinkedIn' => 'LinkedIn',
  1192|   'Link to a category' => 'Collega a una categoria',
  1193|   'Link to an asset' => 'Collega a un asset',
  1194|   'Link to an entry' => 'Collega a una voce',
  1195|   'List' => 'Lista',
  1196|   'Lists' => 'Liste',
  1197|   'Lithuanian' => 'Lituano',
  1198|   'LMI' => 'LMI',
  1199|   'Loading Indicator' => 'Indicatore di caricamento',
  1200|   'Loading Indicator Text' => 'Testo dell\'indicatore di caricamento',
  1201|   'Loading payment options...' => 'Caricamento opzioni di pagamento...',
  1202|   'Loan Person Relationship' => 'Relazione con il prestito',
  1203|   'Looking for captchas? Find ReCAPTCHA and more under <a href="{href}">Integrations</a>.' => 'Cerchi captchas? Trova ReCAPTCHA e altro sotto <a href="{href}">Integrazioni</a>.',
  1204|   'Looking to hide the badge? Refer to the [reCAPTCHA FAQ](https://developers.google.com/recaptcha/docs/faq#id-like-to-hide-the-recaptcha-badge.-what-is-allowed) to achieve this.' => 'Vuoi nascondere il badge? Consulta le [FAQ di reCAPTCHA](https://developers.google.com/recaptcha/docs/faq#id-like-to-hide-the-recaptcha-badge.-what-is-allowed) per scoprire come farlo.',
  1205|   'Loqate' => 'Loqate',
  1206|   'Loss Reason' => 'Motivo della perdita',
  1207|   'Lost' => 'Perso',
  1208|   'lostReason' => 'Motivo della perdita',
  1209|   'Lost Reason' => 'Motivo della perdita',
  1210|   'Loti,Rand' => 'Loti,Rand',
  1211|   'Low' => 'Basso',
  1212|   'Luba-Katanga' => 'Luba-Katanga',
  1213|   'Luxembourgish; Letzeburgesch' => 'Lussemburghese',
  1214|   'Macedonian' => 'Macedone',
  1215|   'Mailchimp' => 'Mailchimp',
  1216|   'MailerLite' => 'MailerLite',
  1217|   'Mailing City' => 'Città di spedizione',
  1218|   'Mailing Postal Code' => 'Codice postale di spedizione',
  1219|   'Mailing Postal Country' => 'Paese di spedizione',
  1220|   'Mailing State' => 'Stato di spedizione',
  1221|   'Mailing Street' => 'Via di spedizione',
  1222|   'Mailjet' => 'Mailjet',
  1223|   'Malagasy' => 'Malagasy',
  1224|   'Malagasy Ariary' => 'Ariary malgascio',
  1225|   'Malawi Kwacha' => 'Kwacha malawiano',
  1226|   'Malay' => 'Malese',
  1227|   'Malayalam' => 'Malayalam',
  1228|   'Malaysian Ringgit' => 'Ringgit malese',
  1229|   'Male' => 'Maschio',
  1230|   'Maltese' => 'Maltese',
  1231|   'Manage all forms' => 'Gestisci tutti i moduli',
  1232|   'Management/Executive' => 'Gestione/Dirigenza',
  1233|   'Manager Email' => 'Email del responsabile',
  1234|   'Manager ID' => 'ID del responsabile',
  1235|   'Manage your {name} customers by providing important information on their conversion on your site.' => 'Gestisci i tuoi clienti {name} fornendo informazioni importanti sulla loro conversione sul tuo sito.',
  1236|   'Manage “{name}” form' => 'Gestisci il modulo “{name}”',
  1237|   'Manual' => 'Manuale',
  1238|   'Manufacturing/Operations' => 'Produzione/Operazioni',
  1239|   'Manx' => 'Manx',
  1240|   'Maori' => 'Maori',
  1241|   'Map content provided by form submissions to create {name} elements.' => 'Mappa i contenuti forniti dagli invii del modulo per creare elementi {name}.',
  1242|   'Map to Account' => 'Mappatura su Account',
  1243|   'Map to Candidate' => 'Mappatura su Candidato',
  1244|   'Map to Case' => 'Mappatura su Caso',
  1245|   'Map to Client' => 'Mappatura su Cliente',
  1246|   'Map to Company' => 'Mappatura su Azienda',
  1247|   'Map to Contact' => 'Mappatura su Contatto',
  1248|   'Map to Deal' => 'Mappatura su Trattativa',
  1249|   'Map to Form' => 'Mappatura su Modulo',
  1250|   'Map to Incident' => 'Mappatura su Incidente',
  1251|   'Map to Lead' => 'Mappatura su Lead',
  1252|   'Map to Note' => 'Mappatura su Nota',
  1253|   'Map to Opportunity' => 'Mappatura su Opportunità',
  1254|   'Map to Organization' => 'Mappatura su Organizzazione',
  1255|   'Map to People' => 'Mappatura su Persone',
  1256|   'Map to Person' => 'Mappatura su Persona',
  1257|   'Map to Profile' => 'Mappatura su Profilo',
  1258|   'Map to Prospect' => 'Mappatura su Potenziale cliente',
  1259|   'Map to Quote' => 'Mappatura su Preventivo',
  1260|   'Map to Task' => 'Mappatura su Compito',
  1261|   'Map to Ticket' => 'Mappatura su Ticket',
  1262|   'Map to User' => 'Mappatura su Utente',
  1263|   'Marathi' => 'Marathi',
  1264|   'Marital Status' => 'Stato civile',
  1265|   'Mark as spam' => 'Segna come spam',
  1266|   'Mark as Spam' => 'Segna come Spam',
  1267|   'Marketing' => 'Marketing',
  1268|   'Married' => 'Sposato',
  1269|   'Marshallese' => 'Marshallese',
  1270|   'Match Field' => 'Campo di corrispondenza',
  1271|   'Mauritius Rupee' => 'Rupia mauriziana',
  1272|   'Max Date' => 'Data massima',
  1273|   'Max File Size' => 'Dimensione massima del file',
  1274|   'Maximizer' => 'Maximizer',
  1275|   'Maximum allowed upload size is {size}.' => 'La dimensione massima consentita per il caricamento è {size}.',
  1276|   'Maximum Incomplete Submission Age' => 'Età massima della sottomissione incompleta',
  1277|   'Maximum instances' => 'Istanza massima',
  1278|   'Maximum Sent Notifications Age' => 'Età massima delle notifiche inviate',
  1279|   'Max Value' => 'Valore massimo',
  1280|   'MB' => 'MB',
  1281|   'Medium' => 'Medio',
  1282|   'mediumtext (~16MB)' => 'mediumtext (~16MB)',
  1283|   'Meeting' => 'Riunione',
  1284|   'Merchant ID' => 'ID commerciante',
  1285|   'Mercury' => 'Mercurio',
  1286|   'Merge Cells' => 'Unisci celle',
  1287|   'Merge User Groups' => 'Unisci gruppi di utenti',
  1288|   'Message' => 'Messaggio',
  1289|   'Metadata' => 'Metadati',
  1290|   'Mexican Peso' => 'Peso messicano',
  1291|   'Microsoft Dynamics 365' => 'Microsoft Dynamics 365',
  1292|   'Middle Name' => 'Secondo nome',
  1293|   'Migrate Forms' => 'Migra moduli',
  1294|   'Migrate Freeform' => 'Migra Freeform',
  1295|   'Migrate Sprout Forms' => 'Migra Sprout Forms',
  1296|   'Migrations' => 'Migrazioni',
  1297|   'Milestone' => 'Traguardo',
  1298|   'Milestones' => 'Traguardi',
  1299|   'Min Date' => 'Data minima',
  1300|   'Min File Size' => 'Dimensione minima del file',
  1301|   'Minimum instances' => 'Istanza minima',
  1302|   'Minimum Score' => 'Punteggio minimo',
  1303|   'Minimum Submit Time' => 'Tempo minimo di invio',
  1304|   'Minute' => 'Minuto',
  1305|   'Min Value' => 'Valore minimo',
  1306|   'Miscellaneous' => 'Varie',
  1307|   'Miss.' => 'Sig.na',
  1308|   'Missing Field' => 'Campo mancante',
  1309|   'Missing Integration' => 'Integrazione mancante',
  1310|   'Missing mapped “boardId” {id}' => 'Manca la mappatura “boardId” {id}',
  1311|   'Missing mapped “groupId” {id}' => 'Manca la mappatura “groupId” {id}',
  1312|   'Missing return accountid {response}. Sent payload {payload}' => 'Manca il ritorno accountid {response}. Payload inviato {payload}',
  1313|   'Missing return incidentid {response}. Sent payload {payload}' => 'Manca il ritorno incidentid {response}. Payload inviato {payload}',
  1314|   'Missing return leadid {response}. Sent payload {payload}' => 'Manca il ritorno leadid {response}. Payload inviato {payload}',
  1315|   'Missing return opportunityid {response}. Sent payload {payload}' => 'Manca il ritorno opportunityid {response}. Payload inviato {payload}',
  1316|   'Missing return “accountId” {response}. Sent payload {payload}' => 'Manca il ritorno “accountId” {response}. Payload inviato {payload}',
  1317|   'Missing return “candidateId” {response}. Sent payload {payload}' => 'Manca il ritorno “candidateId” {response}. Payload inviato {payload}',
  1318|   'Missing return “cardId” {response}' => 'Manca il ritorno “cardId” {response}',
  1319|   'Missing return “caseId” {response}. Sent payload {payload}' => 'Manca il ritorno “caseId” {response}. Payload inviato {payload}',
  1320|   'Missing return “clientId” {response}. Sent payload {payload}' => 'Manca il ritorno “clientId” {response}. Payload inviato {payload}',
  1321|   'Missing return “companyId” {response}. Sent payload {payload}' => 'Manca il ritorno “companyId” {response}. Payload inviato {payload}',
  1322|   'Missing return “contactId” {response}. Sent payload {payload}' => 'Manca il ritorno “contactId” {response}. Payload inviato {payload}',
  1323|   'Missing return “dealId” {response}. Sent payload {payload}' => 'Manca il ritorno “dealId” {response}. Payload inviato {payload}',
  1324|   'Missing return “emailSendCampaignId” {response}. Sent payload {payload}' => 'Manca il ritorno “emailSendCampaignId” {response}. Payload inviato {payload}',
  1325|   'Missing return “itemId” {response}' => 'Manca il ritorno “itemId” {response}',
  1326|   'Missing return “leadId” {response}. Sent payload {payload}' => 'Manca il ritorno “leadId” {response}. Payload inviato {payload}',
  1327|   'Missing return “noteId” {response}. Sent payload {payload}' => 'Manca il ritorno “noteId” {response}. Payload inviato {payload}',
  1328|   'Missing return “opportunityId” {response}. Sent payload {payload}' => 'Manca il ritorno “opportunityId” {response}. Payload inviato {payload}',
  1329|   'Missing return “organizationId” {response}. Sent payload {payload}' => 'Manca il ritorno “organizationId” {response}. Payload inviato {payload}',
  1330|   'Missing return “peopleId” {response}. Sent payload {payload}' => 'Manca il ritorno “peopleId” {response}. Payload inviato {payload}',
  1331|   'Missing return “personId” {response}. Sent payload {payload}' => 'Manca il ritorno “personId” {response}. Payload inviato {payload}',
  1332|   'Missing return “profileId” {response}. Sent payload {payload}' => 'Manca il ritorno “profileId” {response}. Payload inviato {payload}',
  1333|   'Missing return “prospectId” {response}. Sent payload {payload}' => 'Manca il ritorno “prospectId” {response}. Payload inviato {payload}',
  1334|   'Missing return “quoteId” {response}. Sent payload {payload}' => 'Manca il ritorno “quoteId” {response}. Payload inviato {payload}',
  1335|   'Missing return “success” {response}' => 'Manca il ritorno “success” {response}',
  1336|   'Missing return “taskId” {response}. Sent payload {payload}' => 'Manca il ritorno “taskId” {response}. Payload inviato {payload}',
  1337|   'Missing return “ticketId” {response}. Sent payload {payload}' => 'Manca il ritorno “ticketId” {response}. Payload inviato {payload}',
  1338|   'MM / YY CVC' => 'MM / AA CVC',
  1339|   'Mobile' => 'Mobile',
  1340|   'Mobile Number' => 'Numero di cellulare',
  1341|   'Mobile Phone' => 'Telefono cellulare',
  1342|   'Mobile Phone Number' => 'Numero di telefono cellulare',
  1343|   'Moldovan Leu' => 'Leu moldavo',
  1344|   'Monday' => 'Lunedì',
  1345|   'Monetary Value' => 'Valore monetario',
  1346|   'Mongolian' => 'Mongolo',
  1347|   'Month' => 'Mese',
  1348|   'Months' => 'Mesi',
  1349|   'Months of the Year' => 'Mesi dell\'anno',
  1350|   'Moosend' => 'Moosend',
  1351|   'more' => 'di più',
  1352|   'Moroccan Dirham' => 'Dirham marocchino',
  1353|   'Mozambique Metical' => 'Metical mozambicano',
  1354|   'Mr.' => 'Sig.',
  1355|   'Mrs.' => 'Sig.ra',
  1356|   'Ms.' => 'Sig.na',
  1357|   'Much Better' => 'Molto meglio',
  1358|   'Much Worse' => 'Molto peggio',
  1359|   'Multi-line Text' => 'Testo su più righe',
  1360|   'Mx.' => 'Mx.',
  1361|   'Naira' => 'Naira',
  1362|   'Nakfa' => 'Nakfa',
  1363|   'Name' => 'Nome',
  1364|   'Name - First Name' => 'Nome',
  1365|   'Name - Last Name' => 'Nome - Cognome',
  1366|   'Name - Middle Name' => 'Nome - Secondo nome',
  1367|   'Name - Prefix' => 'Nome - Prefisso',
  1368|   'Namibia Dollar,Rand' => 'Dollaro namibiano,Rand',
  1369|   'Nauru' => 'Nauru',
  1370|   'Navajo; Navaho' => 'Navajo; Navaho',
  1371|   'Ndebele, North; North Ndebele' => 'Ndebele del Nord',
  1372|   'Ndebele, South; South Ndebele' => 'Ndebele del Sud',
  1373|   'Ndonga' => 'Ndonga',
  1374|   'Neither' => 'Nessuno dei due',
  1375|   'Nepalese Rupee' => 'Rupia nepalese',
  1376|   'Nepali' => 'Nepalese',
  1377|   'Netherlands Antillean Guilder' => 'Fiorino delle Antille Olandesi',
  1378|   'Neutral' => 'Neutro',
  1379|   'Never used' => 'Mai utilizzato',
  1380|   'New' => 'Nuovo',
  1381|   'New Form' => 'Nuovo modulo',
  1382|   'New Integration' => 'Nuova integrazione',
  1383|   'New Israeli Sheqel' => 'Nuovo Shekel israeliano',
  1384|   'New Notification' => 'Nuova notifica',
  1385|   'New Page' => 'Nuova pagina',
  1386|   'New Status' => 'Nuovo stato',
  1387|   'New Stencil' => 'Nuovo stencil',
  1388|   'New submission' => 'Nuova sottomissione',
  1389|   'New Template' => 'Nuovo modello',
  1390|   'New Zealand' => 'Nuova Zelanda',
  1391|   'New Zealand Dollar' => 'Dollaro neozelandese',
  1392|   'New {form} submission' => 'Nuova sottomissione di {form}',
  1393|   'Next' => 'Successivo',
  1394|   'Next Gen ID' => 'ID Next Gen',
  1395|   'Next Payment' => 'Prossimo pagamento',
  1396|   'No' => 'No',
  1397|   'No asset volumes available. View [asset volume settings]({link}).' => 'Nessun volume di asset disponibile. Visualizza le [impostazioni dei volumi di asset]({link}).',
  1398|   'No category groups available. View [category settings]({link}).' => 'Nessun gruppo di categorie disponibile. Visualizza le [impostazioni delle categorie]({link}).',
  1399|   'No email content.' => 'Nessun contenuto email.',
  1400|   'No existing fields to select.' => 'Nessun campo esistente da selezionare.',
  1401|   'No existing notifications to select.' => 'Nessuna notifica esistente da selezionare.',
  1402|   'No fields available.' => 'Nessun campo disponibile.',
  1403|   'No fields found.' => 'Nessun campo trovato.',
  1404|   'No forms selected.' => 'Nessun modulo selezionato.',
  1405|   'No integrations available.' => 'Nessuna integrazione disponibile.',
  1406|   'Non-Profit/Volunteer' => 'Non profit/Volontario',
  1407|   'None' => 'Nessuno',
  1408|   'None provided' => 'Nessuno fornito',
  1409|   'No notifications created.' => 'Nessuna notifica creata.',
  1410|   'No notifications found.' => 'Nessuna notifica trovata.',
  1411|   'No Notifications selected.' => 'Nessuna notifica selezionata.',
  1412|   'No product types available. View [product type settings]({link}).' => 'Nessun tipo di prodotto disponibile. Visualizza le [impostazioni del tipo di prodotto]({link}).',
  1413|   'No recipients provided.' => 'Nessun destinatario fornito.',
  1414|   'No result' => 'Nessun risultato',
  1415|   'Normal' => 'Normale',
  1416|   'North America' => 'Nord America',
  1417|   'Northern Sami' => 'Sami del Nord',
  1418|   'North Korean Won' => 'Won nordcoreano',
  1419|   'Norwegian' => 'Norvegese',
  1420|   'Norwegian Krone' => 'Corona norvegese',
  1421|   'Norwegian Nynorsk; Nynorsk, Norwegian' => 'Norvegese Nynorsk',
  1422|   'No sections available. View [section settings]({link}).' => 'Nessuna sezione disponibile. Visualizza le [impostazioni delle sezioni]({link}).',
  1423|   'No submissions found to prune older than {d}.' => 'Nessuna sottomissione trovata da eliminare più vecchia di {d}.',
  1424|   'No tag groups available. View [tag settings]({link}).' => 'Nessun gruppo di tag disponibile. Visualizza le [impostazioni dei tag]({link}).',
  1425|   'Not applicable' => 'Non applicabile',
  1426|   'Not at all important' => 'Per nulla importante',
  1427|   'Not connected' => 'Non connesso',
  1428|   'Note' => 'Nota',
  1429|   'Note Field Mapping' => 'Mappatura campo nota',
  1430|   'Note Pad Text' => 'Testo del blocco note',
  1431|   'Notes' => 'Note',
  1432|   'Note that the subfolder path can contain variables like {myFieldHandle}.' => 'Nota che il percorso della sottocartella può contenere variabili come {myFieldHandle}.',
  1433|   'Notification' => 'Notifica',
  1434|   'Notification email could not be sent.' => 'Impossibile inviare l\'email di notifica.',
  1435|   'Notification email error. No recipient email address found.' => 'Errore nell\'email di notifica. Nessun indirizzo email del destinatario trovato.',
  1436|   'Notification email parse error for CC: {value}”. Template error: “{message}” {file}:{line}' => 'Errore di analisi dell\'email di notifica per CC: {value}”. Errore del modello: “{message}” {file}:{line}',
  1437|   'Notification email parse error for ReplyTo: {value}”. Template error: “{message}” {file}:{line}' => 'Errore di analisi dell\'email di notifica per ReplyTo: {value}”. Errore del modello: “{message}” {file}:{line}',
  1438|   'Notification email parse error for Subject: {value}”. Template error: “{message}” {file}:{line}' => 'Errore di analisi dell\'email di notifica per Oggetto: {value}”. Errore del modello: “{message}” {file}:{line}',
  1439|   'Notification email parse error for “BCC: {value}”. Template error: “{message}” {file}:{line}' => 'Errore di analisi dell\'email di notifica per “BCC: {value}”. Errore del modello: “{message}” {file}:{line}',
  1440|   'Notification email parse error for “Sender: {value}”. Template error: “{message}” {file}:{line}' => 'Errore di analisi dell\'email di notifica per “Mittente: {value}”. Errore del modello: “{message}” {file}:{line}',
  1441|   'Notification email parse error for “To: {value}”. Template error: “{message}” {file}:{line}' => 'Errore di analisi dell\'email di notifica per “A: {value}”. Errore del modello: “{message}” {file}:{line}',
  1442|   'Notification email template parse error for “{value}”. Template error: “{message}” {file}:{line}' => 'Errore di analisi del modello di email di notifica per “{value}”. Errore del modello: “{message}” {file}:{line}',
  1443|   'Notification email was resent successfully.' => 'Email di notifica reinviata con successo.',
  1444|   'Notification email {id} could not be sent.' => 'Impossibile inviare l\'email di notifica {id}.',
  1445|   'Notification email “{notification}” could not be sent for submission “{submission}”. Error: {error} {file}:{line}' => 'Impossibile inviare l\'email di notifica “{notification}” per la sottomissione “{submission}”. Errore: {error} {file}:{line}',
  1446|   'Notification email “{notification}” could not be sent for submission “{submission}”. The mailer service failed to send the notification: “{e}”.' => 'L\'email di notifica “{notification}” non è stata inviata per la sottomissione “{submission}”. Il servizio di invio email non è riuscito a inviare la notifica: “{e}”.',
  1447|   'Notification email “{notification}” for submission “{submission}” was cancelled by Formie.' => 'L\'email di notifica “{notification}” per la sottomissione “{submission}” è stata annullata da Formie.',
  1448|   'Notification not found.' => 'Notifica non trovata.',
  1449|   'Notifications' => 'Notifiche',
  1450|   'Not Send' => 'Non inviato',
  1451|   'No universal currency' => 'Nessuna valuta universale',
  1452|   'No user groups available. View [user group settings]({link}).' => 'Nessun gruppo di utenti disponibile. Visualizza le [impostazioni del gruppo utenti]({link}).',
  1453|   'Number' => 'Numero',
  1454|   'Number of days' => 'Numero di giorni',
  1455|   'Number of Employees' => 'Numero di dipendenti',
  1456|   'Number Of Employees' => 'Numero di Dipendenti',
  1457|   'Number of hours' => 'Numero di ore',
  1458|   'Number of minutes' => 'Numero di minuti',
  1459|   'Number of months' => 'Numero di mesi',
  1460|   'Number of Submissions' => 'Numero di sottomissioni',
  1461|   'Number of weeks' => 'Numero di settimane',
  1462|   'Number of years' => 'Numero di anni',
  1463|   'Occitan (post 1500)' => 'Occitano (post 1500)',
  1464|   'Occupation' => 'Occupazione',
  1465|   'Offer Slug' => 'Slug dell\'offerta',
  1466|   'Office Phone' => 'Telefono dell\'ufficio',
  1467|   'Offset' => 'Offset',
  1468|   'of the following rules match.' => 'delle seguenti regole corrispondono.',
  1469|   'Ojibwa' => 'Ojibwa',
  1470|   'Omnisend' => 'Omnisend',
  1471|   'Once-off' => 'Una tantum',
  1472|   'Once a month' => 'Una volta al mese',
  1473|   'Once a week' => 'Una volta a settimana',
  1474|   'Ontraport' => 'Ontraport',
  1475|   'Opayo' => 'Opayo',
  1476|   'Open' => 'Apri',
  1477|   'Open link in new tab' => 'Apri il link in una nuova scheda',
  1478|   'Opportunity Field Mapping' => 'Mappatura campi opportunità',
  1479|   'Opportunity Name' => 'Nome dell\'opportunità',
  1480|   'Opt-In Field' => 'Campo di consenso (Opt-In)',
  1481|   'Opt-in Reason' => 'Motivo dell\'adesione',
  1482|   'Opt-in Type' => 'Tipo di adesione',
  1483|   'Opted-Out' => 'Rinuncia',
  1484|   'Optgroup?' => 'Gruppo di opzioni?',
  1485|   'Opting-out. Field “{field}” has value “{value}”.' => 'Annullamento dell\'adesione. Il campo “{field}” ha il valore “{value}”.',
  1486|   'Option' => 'Opzione',
  1487|   'Optional indicator for non-required fields' => 'Indicatore opzionale per campi non obbligatori',
  1488|   'Option Label' => 'Etichetta dell\'opzione',
  1489|   'Options' => 'Opzioni',
  1490|   'Options Order' => 'Ordine delle opzioni',
  1491|   'Option Value' => 'Valore dell\'opzione',
  1492|   'Ordered List' => 'Elenco ordinato',
  1493|   'Organisation' => 'Organizzazione',
  1494|   'Organisation ID' => 'ID Organizzazione',
  1495|   'Organisation Name' => 'Nome dell\'Organizzazione',
  1496|   'Organization' => 'Organizzazione',
  1497|   'Organization Field Mapping' => 'Mappatura dei campi dell\'organizzazione',
  1498|   'Original Recipients' => 'Destinatari originali',
  1499|   'Oriya' => 'Oriya',
  1500|   'Oromo' => 'Oromo',
  1501|   'Ossetian; Ossetic' => 'Osseto',
  1502|   'Other' => 'Altro',
  1503|   'Other Phone' => 'Altro telefono',
  1504|   'Ouguiya' => 'Ouguiya',
  1505|   'Outbound Email' => 'Email in uscita',
  1506|   'Output Base JavaScript' => 'Output JavaScript di base',
  1507|   'Output CSS' => 'Output CSS',
  1508|   'Output Theme' => 'Tema di output',
  1509|   'Over 3 years' => 'Oltre 3 anni',
  1510|   'Overwrite Content' => 'Sovrascrivi contenuto',
  1511|   'Owner' => 'Proprietario',
  1512|   'Owner ID' => 'ID Proprietario',
  1513|   'Owner Name' => 'Nome del proprietario',
  1514|   'Owner User ID' => 'ID utente proprietario',
  1515|   'Page 1' => 'Pagina 1',
  1516|   'Page Count' => 'Conteggio delle pagine',
  1517|   'Page Footer' => 'Piè di pagina',
  1518|   'Page Header' => 'Intestazione della pagina',
  1519|   'Page Label' => 'Etichetta della pagina',
  1520|   'Page Name' => 'Nome della pagina',
  1521|   'Page Progress Position' => 'Posizione del progresso della pagina',
  1522|   'Page Reload (Server-side)' => 'Ricarica pagina (server-side)',
  1523|   'Page URI' => 'URI della pagina',
  1524|   'Pakistan Rupee' => 'Rupia pakistana',
  1525|   'Pali' => 'Pali',
  1526|   'Panjabi; Punjabi' => 'Panjabi; Punjabi',
  1527|   'Paragraph' => 'Paragrafo',
  1528|   'Pardot' => 'Pardot',
  1529|   'Parent ID' => 'ID Genitore',
  1530|   'Part-Time' => 'Part-time',
  1531|   'Partner Name' => 'Nome del partner',
  1532|   'Partner Reference' => 'Riferimento del partner',
  1533|   'Password' => 'Password',
  1534|   'Pataca' => 'Pataca',
  1535|   'Payment' => 'Pagamento',
  1536|   'Payment Amount' => 'Importo del pagamento',
  1537|   'Payment Currency' => 'Valuta del pagamento',
  1538|   'Payment Description' => 'Descrizione del pagamento',
  1539|   'Payment error: “{message}” {file}:{line}. Payload: “{payload}”. Response: “{response}”' => 'Errore di pagamento: “{message}” {file}:{line}. Payload: “{payload}”. Risposta: “{response}”',
  1540|   'Payment error: “{message}” {file}:{line}. Response: “{response}”' => 'Errore di pagamento: “{message}” {file}:{line}. Risposta: “{response}”',
  1541|   'Payment Provider' => 'Fornitore di pagamento',
  1542|   'Payment Receipt' => 'Ricevuta di pagamento',
  1543|   'Payments' => 'Pagamenti',
  1544|   'Payment Type' => 'Tipo di pagamento',
  1545|   'PayPal' => 'PayPal',
  1546|   'PayPal Buy Now' => 'Acquista ora con PayPal',
  1547|   'PayPal Checkout' => 'Checkout PayPal',
  1548|   'Pay with PayPal' => 'Paga con PayPal',
  1549|   'Pa’anga' => 'Pa’anga',
  1550|   'PDF Template' => 'Modello PDF',
  1551|   'PDF Templates' => 'Modelli PDF',
  1552|   'Pdf Templates' => 'Modelli PDF',
  1553|   'Pen Color' => 'Colore della penna',
  1554|   'Pending' => 'In attesa',
  1555|   'Pending Message' => 'Messaggio in attesa',
  1556|   'Pen Weight' => 'Spessore della penna',
  1557|   'People Field Mapping' => 'Mappatura campi persone',
  1558|   'Percent' => 'Percentuale',
  1559|   'per day' => 'al giorno',
  1560|   'per month' => 'al mese',
  1561|   'Persian' => 'Persiano',
  1562|   'Person' => 'Persona',
  1563|   'Person Acting' => 'Persona in azione',
  1564|   'Person Acting Name' => 'Nome della persona in azione',
  1565|   'Person Data Type' => 'Tipo di dati della persona',
  1566|   'Person Field Mapping' => 'Mappatura campi persona',
  1567|   'Person Responsible' => 'Persona responsabile',
  1568|   'Person Responsible Name' => 'Nome della persona responsabile',
  1569|   'per week' => 'a settimana',
  1570|   'per year' => 'all\'anno',
  1571|   'Peso Uruguayo' => 'Peso uruguaiano',
  1572|   'Pharmaceutical/Biotech' => 'Farmaceutico/Biotecnologico',
  1573|   'Philippine Peso' => 'Peso filippino',
  1574|   'Phone' => 'Telefono',
  1575|   'Phone (Home)' => 'Telefono (Casa)',
  1576|   'Phone (Mobile)' => 'Telefono (Cellulare)',
  1577|   'Phone (Other)' => 'Telefono (Altro)',
  1578|   'Phone 1' => 'Telefono 1',
  1579|   'Phone 2' => 'Telefono 2',
  1580|   'Phone Display Type 1' => 'Tipo di visualizzazione del telefono 1',
  1581|   'Phone Display Type 2' => 'Tipo di visualizzazione del telefono 2',
  1582|   'Phone Number' => 'Numero di telefono',
  1583|   'Phone Number Extension' => 'Estensione del numero di telefono',
  1584|   'Photo' => 'Foto',
  1585|   'Pill' => 'Pillola',
  1586|   'Pipedrive' => 'Pipedrive',
  1587|   'Pipeline (Group)' => 'Pipeline (Gruppo)',
  1588|   'Pipeline ID' => 'ID Pipeline',
  1589|   'Pipeliner' => 'Pipeliner',
  1590|   'Pipelines' => 'Pipeline',
  1591|   'Pipeline Stage' => 'Fase del pipeline',
  1592|   'pipeline_id' => 'pipeline_id',
  1593|   'Placeholder' => 'Segnaposto',
  1594|   'PlainText' => 'Testo normale',
  1595|   'Plan “{reference}” was archived because the corresponding plan was deleted on Stripe.' => 'Il piano “{reference}” è stato archiviato perché il piano corrispondente è stato eliminato su Stripe.',
  1596|   'Please describe the issue you‘re having in as much detail as possible.' => 'Descrivi il problema che stai riscontrando nel modo più dettagliato possibile.',
  1597|   'Please provide all the required fields.' => 'Si prega di fornire tutti i campi richiesti.',
  1598|   'Please provide the site and secret keys for Cloudflare Turnstile in [Settings]({link}).' => 'Si prega di fornire le chiavi sito e segrete per Cloudflare Turnstile nelle [Impostazioni]({link}).',
  1599|   'Please provide the site and secret keys for Friendly Captcha in [Settings]({link}).' => 'Si prega di fornire le chiavi sito e segrete per Friendly Captcha nelle [Impostazioni]({link}).',
  1600|   'Please provide the site and secret keys for hCaptcha in [Settings]({link}).' => 'Si prega di fornire le chiavi sito e segrete per hCaptcha nelle [Impostazioni]({link}).',
  1601|   'Please provide the site and secret keys for ReCAPTCHA in [Settings]({link}).' => 'Si prega di fornire le chiavi sito e segrete per ReCAPTCHA nelle [Impostazioni]({link}).',
  1602|   'Plugin Name' => 'Nome del plugin',
  1603|   'Plugin name for the end user.' => 'Nome del plugin per l’utente finale.',
  1604|   'PM' => 'PM',
  1605|   'Polish' => 'Polacco',
  1606|   'Portal' => 'Portale',
  1607|   'Portuguese' => 'Portoghese',
  1608|   'Position' => 'Posizione',
  1609|   'Postal Code' => 'CAP',
  1610|   'Postcode' => 'CAP',
  1611|   'Pound Sterling' => 'Sterlina britannica',
  1612|   'Pre-Populate Value' => 'Valore precompilato',
  1613|   'Predefined Options' => 'Opzioni predefinite',
  1614|   'Prefer not to answer' => 'Preferisco non rispondere',
  1615|   'Preferred Name' => 'Nome preferito',
  1616|   'Prefix' => 'Prefisso',
  1617|   'Preparing to prune {c} submissions older than {d}.' => 'Preparazione alla cancellazione di {c} sottomissioni più vecchie di {d}.',
  1618|   'Preview' => 'Anteprima',
  1619|   'Priority' => 'Priorità',
  1620|   'Priority Type' => 'Tipo di priorità',
  1621|   'Privacy' => 'Privacy',
  1622|   'Privacy & Data' => 'Privacy e Dati',
  1623|   'Private API Key' => 'Chiave API privata',
  1624|   'Probability' => 'Probabilità',
  1625|   'Probably' => 'Probabilmente',
  1626|   'Probably Not' => 'Probabilmente no',
  1627|   'Product ID' => 'ID prodotto',
  1628|   'Products' => 'Prodotti',
  1629|   'Prof.' => 'Prof.',
  1630|   'Professional Services' => 'Servizi professionali',
  1631|   'Profile' => 'Profilo',
  1632|   'Profile Field Mapping' => 'Mappatura dei campi del profilo',
  1633|   'Progress' => 'Progresso',
  1634|   'Project ID' => 'ID progetto',
  1635|   'Prospect Account Id' => 'ID Account Prospetto',
  1636|   'Prospect Accounts' => 'Account prospetto',
  1637|   'Prospect Email' => 'Email del prospetto',
  1638|   'Prospect Field Mapping' => 'Mappatura dei campi del prospetto',
  1639|   'Provide additional elements to be shown in tabs when building the form.' => 'Fornisci elementi aggiuntivi da mostrare nelle schede durante la creazione del modulo.',
  1640|   'Provide an amount for the transaction. This can be either a fixed value, or derived from a field.' => 'Fornisci un importo per la transazione. Questo può essere un valore fisso o derivato da un campo.',
  1641|   'Provide any additional options, as per the {link}.' => 'Fornisci eventuali opzioni aggiuntive, come indicato nel {link}.',
  1642|   'Provide payment capabilities for your forms with {name}.' => 'Fornisci capacità di pagamento per i tuoi moduli con {name}.',
  1643|   'Provider' => 'Fornitore',
  1644|   'Provide recipients for each email notification to be sent to. For multiple recipients, separate each with a comma.' => 'Fornisci destinatari per ogni email di notifica da inviare. Per più destinatari, separa ciascuno con una virgola.',
  1645|   'Provide recipients for this email notification to be sent to. For multiple recipients, separate each with a comma.' => 'Fornisci destinatari per questa notifica email da inviare. Per più destinatari, separa ciascuno con una virgola.',
  1646|   'Provide the currency to be used for the transaction.' => 'Fornisci la valuta da utilizzare per la transazione.',
  1647|   'Provide the currency to be used for the transaction. This can be either a fixed value, or derived from a field.' => 'Fornisci la valuta da utilizzare per la transazione. Può essere un valore fisso o derivato da un campo.',
  1648|   'Provide the formula used to calculate the result for this field. Use arithmetic operators (`+`, `-`, `*`, `/`, etc) and reference other fields.' => 'Fornisci la formula utilizzata per calcolare il risultato per questo campo. Usa operatori aritmetici (`+`, `-`, `*`, `/`, ecc.) e fai riferimento ad altri campi.',
  1649|   'Provide the number of seconds that users must wait in order to submit the form. If a user submits the form quicker than the provided value, it will be marked as spam. Using `0`, `false` or leaving empty will disable this setting.' => 'Fornisci il numero di secondi che gli utenti devono attendere per inviare il modulo. Se un utente invia il modulo più velocemente del valore fornito, sarà segnato come spam. Usare `0`, `false` o lasciare vuoto disabiliterà questa impostazione.',
  1650|   'Proxy Redirect URI' => 'URI di reindirizzamento del proxy',
  1651|   'Public API Key' => 'Chiave API pubblica',
  1652|   'Public URL' => 'URL pubblico',
  1653|   'Publishable Key' => 'Chiave pubblicabile',
  1654|   'Pula' => 'Pula',
  1655|   'Purify Content' => 'Purifica contenuto',
  1656|   'Pushto; Pashto' => 'Pushto; Pashto',
  1657|   'px' => 'px',
  1658|   'QA/Quality Control' => 'QA/Controllo Qualità',
  1659|   'Qatari Rial' => 'Rial qatariota',
  1660|   'Qualified' => 'Qualificato',
  1661|   'Quarter' => 'Trimestre',
  1662|   'Quechua' => 'Quechua',
  1663|   'Query Parameter' => 'Parametro di query',
  1664|   'Quetzal' => 'Quetzal',
  1665|   'Quick Account Name' => 'Nome account rapido',
  1666|   'Quote' => 'Preventivo',
  1667|   'Quote Field Mapping' => 'Mappatura campi preventivo',
  1668|   'Radio Buttons' => 'Pulsanti radio',
  1669|   'Rand' => 'Rand',
  1670|   'Ready to import.' => 'Pronto per l\'importazione.',
  1671|   'Real Estate' => 'Immobiliare',
  1672|   'Reason' => 'Motivo',
  1673|   'reCAPTCHA' => 'reCAPTCHA',
  1674|   'reCAPTCHA Enterprise' => 'reCAPTCHA Enterprise',
  1675|   'reCAPTCHA is a free service that protects your forms from spam and abuse. Find out more via [Google reCAPTCHA](https://www.google.com/recaptcha).' => 'reCAPTCHA è un servizio gratuito che protegge i tuoi moduli da spam e abusi. Scopri di più tramite [Google reCAPTCHA](https://www.google.com/recaptcha).',
  1676|   'reCAPTCHA Secret Key' => 'Chiave segreta reCAPTCHA',
  1677|   'reCAPTCHA Site Key' => 'Chiave sito reCAPTCHA',
  1678|   'reCAPTCHA Type' => 'Tipo di reCAPTCHA',
  1679|   'reCAPTCHA V2 - Checkbox' => 'reCAPTCHA V2 - Casella di controllo',
  1680|   'reCAPTCHA V2 - Invisible' => 'reCAPTCHA V2 - Invisibile',
  1681|   'reCAPTCHA V3' => 'reCAPTCHA V3',
  1682|   'Recent Form Submissions' => 'Sottomissioni recenti dei moduli',
  1683|   'Recipient' => 'Destinatario',
  1684|   'Recipient Conditions' => 'Condizioni del destinatario',
  1685|   'Recipient Emails' => 'Email del destinatario',
  1686|   'Recipients' => 'Destinatari',
  1687|   'Reconfigurable Options' => 'Opzioni riconfigurabili',
  1688|   'Recruitee' => 'Recruitee',
  1689|   'Rectangular' => 'Rettangolare',
  1690|   'Redirect Entry' => 'Reindirizza alla voce',
  1691|   'Redirection URL' => 'URL di reindirizzamento',
  1692|   'Redirect on a new tab' => 'Reindirizza su una nuova scheda',
  1693|   'Redirect on the same tab' => 'Reindirizza sulla stessa scheda',
  1694|   'Redirect Option' => 'Opzione di reindirizzamento',
  1695|   'Redirect to an entry' => 'Reindirizza a una voce',
  1696|   'Redirect to a URL' => 'Reindirizza a un URL',
  1697|   'Redirect URI' => 'URI di reindirizzamento',
  1698|   'Redirect URL' => 'URL di reindirizzamento',
  1699|   'Redo' => 'Ripeti',
  1700|   'Reference Number' => 'Numero di riferimento',
  1701|   'Referrer' => 'Referente',
  1702|   'Refresh' => 'Aggiorna',
  1703|   'Refresh Integration' => 'Aggiorna integrazione',
  1704|   'Region' => 'Regione',
  1705|   'Related Resource' => 'Risorsa correlata',
  1706|   'Relationship Manager' => 'Responsabile relazioni',
  1707|   'Reload the page' => 'Ricarica la pagina',
  1708|   'Reminder Date' => 'Data di promemoria',
  1709|   'Remove' => 'Rimuovi',
  1710|   'Repeater' => 'Ripetitore',
  1711|   'Reply-To Email' => 'Email di risposta',
  1712|   'Reply-To Name' => 'Nome del destinatario della risposta',
  1713|   'Reply To:' => 'Rispondi a:',
  1714|   'Required Field' => 'Campo obbligatorio',
  1715|   'Required Field Indicator' => 'Indicatore campo obbligatorio',
  1716|   'Require Logged-in User' => 'Richiede utente connesso',
  1717|   'Resend' => 'Rinvia',
  1718|   'Resend Email Notification' => 'Rinvia notifica email',
  1719|   'Resend Email Notifications' => 'Rinvia notifiche email',
  1720|   'Resend sent notifications' => 'Rinvia notifiche inviate',
  1721|   'Reset form values' => 'Reimposta i valori del modulo',
  1722|   'Resolved' => 'Risolto',
  1723|   'Responder ID' => 'ID del rispondente',
  1724|   'Response from task-creation {response}. Sent payload {payload}' => 'Risposta dalla creazione dell’attività {response}. Payload inviato {payload}',
  1725|   'Response returned “not ok” {response}' => 'Risposta ricevuta “non ok” {response}',
  1726|   'Restaurant/Food Service' => 'Ristorazione/Servizi Alimentari',
  1727|   'Restrict allowed file types?' => 'Limitare i tipi di file consentiti?',
  1728|   'Restrictions' => 'Restrizioni',
  1729|   'Retail' => 'Vendita al dettaglio',
  1730|   'Retain files' => 'Mantieni file',
  1731|   'Retired' => 'In pensione',
  1732|   'Reviewed' => 'Esaminato',
  1733|   'Review Import' => 'Rivedi importazione',
  1734|   'Rial Omani' => 'Rial omanita',
  1735|   'Rich Text Buttons' => 'Pulsanti di testo formattato',
  1736|   'Riel' => 'Riel',
  1737|   'Right' => 'Destra',
  1738|   'Right (Save on Left)' => 'Destra (Salva a sinistra)',
  1739|   'Right of Input' => 'Destra dell’input',
  1740|   'Romanian; Moldavian; Moldovan' => 'Rumeno; Moldavo',
  1741|   'Romanian Leu' => 'Leu rumeno',
  1742|   'Romansh' => 'Romancio',
  1743|   'Root Category' => 'Categoria principale',
  1744|   'Row #{row}' => 'Riga #{row}',
  1745|   'Rufiyaa' => 'Rufiyaa',
  1746|   'Rundi' => 'Rundi',
  1747|   'Rupiah' => 'Rupia indonesiana',
  1748|   'Russian' => 'Russo',
  1749|   'Russian Ruble' => 'Rublo russo',
  1750|   'Rwanda Franc' => 'Franco ruandese',
  1751|   'Saint Helena Pound' => 'Sterlina di Sant’Elena',
  1752|   'Sales' => 'Vendite',
  1753|   'Sales Account ID' => 'ID account vendite',
  1754|   'Salesflare' => 'Salesflare',
  1755|   'Salesforce' => 'Salesforce',
  1756|   'Salutation' => 'Saluto',
  1757|   'Samoan' => 'Samoano',
  1758|   'Sango' => 'Sango',
  1759|   'Sanskrit' => 'Sanscrito',
  1760|   'Sardinian' => 'Sardo',
  1761|   'Satisfaction' => 'Soddisfazione',
  1762|   'Satisfied' => 'Soddisfatto',
  1763|   'Saudi Riyal' => 'Riyal saudita',
  1764|   'Save' => 'Salva',
  1765|   'Save as a new form' => 'Salva come nuovo modulo',
  1766|   'Save as a new stencil' => 'Salva come nuovo modello',
  1767|   'Save Button Label' => 'Etichetta del pulsante Salva',
  1768|   'Save Button Style' => 'Stile del pulsante Salva',
  1769|   'Save on Left' => 'Salva a sinistra',
  1770|   'Save on Right' => 'Salva a destra',
  1771|   'Save Spam Submissions' => 'Salva le sottomissioni spam',
  1772|   'Save submissions' => 'Salva sottomissioni',
  1773|   'Save this form and reload the page to see your form template fields.' => 'Salva questo modulo e ricarica la pagina per vedere i campi del modello del modulo.',
  1774|   'Save this integration to connect.' => 'Salva questa integrazione per connetterti.',
  1775|   'Schedule End Date' => 'Data di fine pianificazione',
  1776|   'Schedule Form' => 'Pianifica modulo',
  1777|   'Schedule Start Date' => 'Data di inizio pianificazione',
  1778|   'Science/Research' => 'Scienza/Ricerca',
  1779|   'Score' => 'Punteggio',
  1780|   'Score Based (v3)' => 'Basato su punteggio (v3)',
  1781|   'Scoro' => 'Scoro',
  1782|   'Script Loading Method' => 'Metodo di caricamento dello script',
  1783|   'Scroll To Top' => 'Scorri in alto',
  1784|   'Second' => 'Secondo',
  1785|   'Secret Key' => 'Chiave segreta',
  1786|   'Section' => 'Sezione',
  1787|   'Section Label ' => 'Etichetta della sezione',
  1788|   'Security' => 'Sicurezza',
  1789|   'Segmentation List' => 'Lista di segmentazione',
  1790|   'Select a calendar to map content to. This will reflect the available fields to map to.' => 'Seleziona un calendario a cui mappare il contenuto. Questo rifletterà i campi disponibili da mappare.',
  1791|   'Select a category' => 'Seleziona una categoria',
  1792|   'Select a default category to be selected.' => 'Seleziona una categoria predefinita.',
  1793|   'Select a default entry to be selected.' => 'Seleziona una voce predefinita.',
  1794|   'Select a default product to be selected.' => 'Seleziona un prodotto predefinito.',
  1795|   'Select a default user to be selected.' => 'Seleziona un utente predefinito.',
  1796|   'Select a default value for all new date fields.' => 'Seleziona un valore predefinito per tutti i nuovi campi data.',
  1797|   'Select a default value for this field.' => 'Seleziona un valore predefinito per questo campo.',
  1798|   'Select a default variant to be selected.' => 'Seleziona una variante predefinita.',
  1799|   'Select a display type to be used as the default for all new date fields.' => 'Seleziona un tipo di visualizzazione da utilizzare come predefinito per tutti i nuovi campi data.',
  1800|   'Select a field of the same type where its value must match this field.' => 'Seleziona un campo dello stesso tipo il cui valore deve corrispondere a questo campo.',
  1801|   'Select a Form Template to be used as the default for all new forms.' => 'Seleziona un modello di modulo da utilizzare come predefinito per tutti i nuovi moduli.',
  1802|   'Select a form to export.' => 'Seleziona un modulo da esportare.',
  1803|   'Select a form to export as a JSON file. This will include all pages, settings, notifications and fields. You‘ll be able to import this file later on the same, or a different environment.' => 'Seleziona un modulo da esportare come file JSON. Includerà tutte le pagine, le impostazioni, le notifiche e i campi. Potrai importare questo file successivamente nello stesso ambiente o in uno diverso.',
  1804|   'Select a JSON file you‘ve exported from Formie to import. You‘ll be able to configure your import at the next step.' => 'Seleziona un file JSON che hai esportato da Formie per importarlo. Potrai configurare l’importazione al passaggio successivo.',
  1805|   'Select an Email Template to be used as the default for all new forms.' => 'Seleziona un modello email da utilizzare come predefinito per tutti i nuovi moduli.',
  1806|   'Select an entry' => 'Seleziona una voce',
  1807|   'Select an entry for the user to be redirected to.' => 'Seleziona una voce a cui reindirizzare l’utente.',
  1808|   'Select an entry type to map content to. This will reflect the available fields to map to.' => 'Seleziona un tipo di voce a cui mappare il contenuto. Questo rifletterà i campi disponibili da mappare.',
  1809|   'Select an option' => 'Seleziona un’opzione',
  1810|   'Select an option for the default value.' => 'Seleziona un’opzione per il valore predefinito.',
  1811|   'Select any field types to be unavailable to pick from when creating your forms.' => 'Seleziona i tipi di campo che non devono essere disponibili durante la creazione dei moduli.',
  1812|   'Select a product' => 'Seleziona un prodotto',
  1813|   'Select a root category to only output the direct children of the chosen category. Leave empty to use the top-level category.' => 'Seleziona una categoria principale per visualizzare solo i figli diretti della categoria scelta. Lascia vuoto per utilizzare la categoria di primo livello.',
  1814|   'Select assets to be attached to this email notification.' => 'Seleziona risorse da allegare a questa notifica email.',
  1815|   'Select a stencil to kick-start your form with fields and settings.' => 'Seleziona un modello per iniziare il modulo con campi e impostazioni.',
  1816|   'Select a tag' => 'Seleziona un tag',
  1817|   'Select a template to use for the Email, or leave empty to use Formie‘s default.' => 'Seleziona un modello da utilizzare per l’email, oppure lascia vuoto per utilizzare il modello predefinito di Formie.',
  1818|   'Select a template to use for the PDF, or leave empty to use Formie‘s default.' => 'Seleziona un modello da utilizzare per il PDF, oppure lascia vuoto per utilizzare il modello predefinito di Formie.',
  1819|   'Select a user' => 'Seleziona un utente',
  1820|   'Select a user to be the default author for the created entry. An entry must always have an author.' => 'Seleziona un utente come autore predefinito per la voce creata. Una voce deve sempre avere un autore.',
  1821|   'Select a user to be the default author for the created event. An event must always have an author.' => 'Seleziona un utente come autore predefinito per l’evento creato. Un evento deve sempre avere un autore.',
  1822|   'Select a variant' => 'Seleziona una variante',
  1823|   'Select a volume to be used as the default for all new file upload fields.' => 'Seleziona un volume da utilizzare come predefinito per tutti i nuovi campi di caricamento file.',
  1824|   'Select default tags to be selected.' => 'Seleziona i tag predefiniti da selezionare.',
  1825|   'Select existing notification' => 'Seleziona una notifica esistente',
  1826|   'Select from predefined options and customize or paste your own to bulk add options.' => 'Seleziona tra opzioni predefinite e personalizza o incolla le tue per aggiungere opzioni in blocco.',
  1827|   'Select from the available predefined options.' => 'Seleziona tra le opzioni predefinite disponibili.',
  1828|   'Select how often this subscription should be billed.' => 'Seleziona la frequenza di fatturazione per questo abbonamento.',
  1829|   'Select how to format the value calculated for this field.' => 'Seleziona come formattare il valore calcolato per questo campo.',
  1830|   'Select how to handle file uploads when a submission is deleted.' => 'Seleziona come gestire i caricamenti di file quando una sottomissione viene eliminata.',
  1831|   'Select how to show required fields.' => 'Seleziona come mostrare i campi obbligatori.',
  1832|   'Select Notification' => 'Seleziona notifica',
  1833|   'Select the appearance for Turnstile to use.' => 'Seleziona l’aspetto da utilizzare per Turnstile.',
  1834|   'Select the data to be used as the option label.' => 'Seleziona i dati da utilizzare come etichetta delle opzioni.',
  1835|   'Select the data to be used as the option value.' => 'Seleziona i dati da utilizzare come valore delle opzioni.',
  1836|   'Select the default sub-nav page to show when clicking on "Formie" in the main menu.' => 'Seleziona la pagina di sottomenu predefinita da mostrare quando si fa clic su "Formie" nel menu principale.',
  1837|   'Select the fields you want to use to check for existing elements. Formie will look for existing elements with the attributes chosen and the values provided in the submission.' => 'Seleziona i campi che desideri utilizzare per controllare gli elementi esistenti. Formie cercherà elementi esistenti con gli attributi scelti e i valori forniti nella sottomissione.',
  1838|   'Select the format for the dropdown option label.' => 'Seleziona il formato per l’etichetta dell’opzione a discesa.',
  1839|   'Select the format for the dropdown option value.' => 'Seleziona il formato per il valore dell’opzione a discesa.',
  1840|   'Select the forms you wish to migrate from Freeform. This will migrate all fields within the form, all settings (where applicable), notifications, and any submissions. Depending on how many entries the selected forms have, this could take some time.' => 'Seleziona i moduli che desideri migrare da Freeform. Verranno migrati tutti i campi del modulo, tutte le impostazioni (ove applicabili), le notifiche e tutte le sottomissioni. A seconda del numero di voci nei moduli selezionati, l’operazione potrebbe richiedere del tempo.',
  1841|   'Select the forms you wish to migrate from Sprout Forms. This will migrate all fields within the form, all settings (where applicable), notifications, and any Form Entries. Depending on how many entries the selected forms have, this could take some time.' => 'Seleziona i moduli che desideri migrare da Sprout Forms. Verranno migrati tutti i campi del modulo, tutte le impostazioni (ove applicabili), le notifiche e tutte le voci del modulo. A seconda del numero di voci nei moduli selezionati, l’operazione potrebbe richiedere del tempo.',
  1842|   'Select the notification you‘d like to send.' => 'Seleziona la notifica che desideri inviare.',
  1843|   'Select the position of the page progress indicator in the form.' => 'Seleziona la posizione dell’indicatore di avanzamento della pagina nel modulo.',
  1844|   'Select the provider you wish to use for this integration.' => 'Seleziona il provider che desideri utilizzare per questa integrazione.',
  1845|   'Select the size for Turnstile to use.' => 'Seleziona la dimensione da utilizzare per Turnstile.',
  1846|   'Select the size of hCaptcha to use.' => 'Seleziona la dimensione da utilizzare per hCaptcha.',
  1847|   'Select the size of reCAPTCHA to use.' => 'Seleziona la dimensione da utilizzare per reCAPTCHA.',
  1848|   'Select the style for the save button.' => 'Seleziona lo stile del pulsante di salvataggio.',
  1849|   'Select the templates this form should use.' => 'Seleziona i modelli che questo modulo dovrebbe utilizzare.',
  1850|   'Select the theme for hCaptcha to use.' => 'Seleziona il tema da utilizzare per hCaptcha.',
  1851|   'Select the theme for reCAPTCHA to use.' => 'Seleziona il tema da utilizzare per reCAPTCHA.',
  1852|   'Select the theme for Turnstile to use.' => 'Seleziona il tema da utilizzare per Turnstile.',
  1853|   'Select the type of badge to display.' => 'Seleziona il tipo di badge da visualizzare.',
  1854|   'Select the type of captcha to use.' => 'Seleziona il tipo di captcha da utilizzare.',
  1855|   'Select the type of payment to use.' => 'Seleziona il tipo di pagamento da utilizzare.',
  1856|   'Select the type of reCAPTCHA to use.' => 'Seleziona il tipo di reCAPTCHA da utilizzare.',
  1857|   'Select the `defer` and `async` attributes to use in the script tag when rendering.' => 'Seleziona gli attributi `defer` e `async` da utilizzare nel tag script durante il rendering.',
  1858|   'Select user groups to assign this new user to.' => 'Seleziona i gruppi di utenti a cui assegnare questo nuovo utente.',
  1859|   'Select what format to present dates as.' => 'Seleziona il formato con cui presentare le date.',
  1860|   'Select what order to show categories by.' => 'Seleziona l’ordine di visualizzazione delle categorie.',
  1861|   'Select what order to show entries by.' => 'Seleziona l’ordine di visualizzazione delle voci.',
  1862|   'Select what order to show products by.' => 'Seleziona l’ordine di visualizzazione dei prodotti.',
  1863|   'Select what order to show users by.' => 'Seleziona l’ordine di visualizzazione degli utenti.',
  1864|   'Select what order to show variants by.' => 'Seleziona l’ordine di visualizzazione delle varianti.',
  1865|   'Select what to use as the label for each category.' => 'Seleziona cosa utilizzare come etichetta per ciascuna categoria.',
  1866|   'Select what to use as the label for each entry.' => 'Seleziona cosa utilizzare come etichetta per ciascuna voce.',
  1867|   'Select what to use as the label for each product.' => 'Seleziona cosa utilizzare come etichetta per ciascun prodotto.',
  1868|   'Select what to use as the label for each user.' => 'Seleziona cosa utilizzare come etichetta per ciascun utente.',
  1869|   'Select what to use as the label for each variant.' => 'Seleziona cosa utilizzare come etichetta per ciascuna variante.',
  1870|   'Select what type of channel {name} will send the message to.' => 'Seleziona il tipo di canale a cui {name} invierà il messaggio.',
  1871|   'Select what value to use for email notifications.' => 'Seleziona il valore da utilizzare per le notifiche email.',
  1872|   'Select which address provider this field should use.' => 'Seleziona quale provider di indirizzo deve utilizzare questo campo.',
  1873|   'Select which countries should be available to pick from. By default, all countries are available.' => 'Seleziona quali paesi dovrebbero essere disponibili per la selezione. Per impostazione predefinita, tutti i paesi sono disponibili.',
  1874|   'Select which formatting buttons available for users to use.' => 'Seleziona quali pulsanti di formattazione sono disponibili per gli utenti.',
  1875|   'Select which layout to use for these fields.' => 'Seleziona quale layout utilizzare per questi campi.',
  1876|   'Select which payment provider this field should use.' => 'Seleziona quale provider di pagamento deve utilizzare questo campo.',
  1877|   'Select which {name} board to add a card to.' => 'Seleziona la board {name} a cui aggiungere una scheda.',
  1878|   'Select which {name} channel to post a message to.' => 'Seleziona il canale {name} su cui pubblicare un messaggio.',
  1879|   'Select which {name} list to add a card to.' => 'Seleziona la lista {name} a cui aggiungere una scheda.',
  1880|   'Select which {name} sheet to add rows to.' => 'Seleziona il foglio {name} a cui aggiungere righe.',
  1881|   'Select which {name} user to post a message to.' => 'Seleziona l’utente {name} a cui inviare un messaggio.',
  1882|   'Select your {name} board to manage content on.' => 'Seleziona la tua board {name} per gestire i contenuti.',
  1883|   'Select your {name} form to create submissions on.' => 'Seleziona il tuo modulo {name} per creare sottomissioni.',
  1884|   'Select your {name} list to create contacts on.' => 'Seleziona la tua lista {name} per creare contatti.',
  1885|   'Select your {name} {label} here.' => 'Seleziona qui il tuo {name} {label}.',
  1886|   'Self-Employed' => 'Lavoratore autonomo',
  1887|   'Send' => 'Invia',
  1888|   'Send Activation Email' => 'Invia email di attivazione',
  1889|   'Send a message to {name} support' => 'Invia un messaggio all’assistenza di {name}',
  1890|   'Send Email Alert for Failed Notification' => 'Invia avviso email per notifica fallita',
  1891|   'Send email campaign' => 'Invia campagna email',
  1892|   'Send Email Notification' => 'Invia notifica email',
  1893|   'Send Email Notifications' => 'Invia notifiche email',
  1894|   'Sender' => 'Mittente',
  1895|   'Sender:' => 'Mittente:',
  1896|   'Sender Email' => 'Email del mittente',
  1897|   'Sendinblue (Legacy)' => 'Sendinblue (Legacy)',
  1898|   'Sending form notification.' => 'Invio notifica del modulo.',
  1899|   'Send Notification' => 'Invia notifica',
  1900|   'Send Notifications' => 'Invia notifiche',
  1901|   'Send Support Request' => 'Invia richiesta di supporto',
  1902|   'Send Test Email' => 'Invia email di prova',
  1903|   'Send Test Payload' => 'Invia payload di prova',
  1904|   'Send your form content to any URL you provide.' => 'Invia il contenuto del tuo modulo a qualsiasi URL che fornisci.',
  1905|   'Send your form content to Google Sheets.' => 'Invia il contenuto del tuo modulo a Google Sheets.',
  1906|   'Send your form content to Monday.' => 'Invia il contenuto del tuo modulo a Monday.',
  1907|   'Send your form content to Slack.' => 'Invia il contenuto del tuo modulo a Slack.',
  1908|   'Send your form content to Trello.' => 'Invia il contenuto del tuo modulo a Trello.',
  1909|   'Send your form content to Zapier.' => 'Invia il contenuto del tuo modulo a Zapier.',
  1910|   'Sent Notification' => 'Notifica inviata',
  1911|   'Sent Notification deleted.' => 'Notifica inviata eliminata.',
  1912|   'Sent Notification not found.' => 'Notifica inviata non trovata.',
  1913|   'Sent Notification restored.' => 'Notifica inviata ripristinata.',
  1914|   'Sent Notifications' => 'Notifiche inviate',
  1915|   'Sent Notifications not restored.' => 'Notifiche inviate non ripristinate.',
  1916|   'Serbian' => 'Serbo',
  1917|   'Serbian Dinar' => 'Dinaro serbo',
  1918|   'Set a default value for the field when it doesn’t have a value.' => 'Imposta un valore predefinito per il campo quando non ha un valore.',
  1919|   'Set a height PayPal button in pixels, between 25px to 55px.' => 'Imposta un’altezza per il pulsante PayPal in pixel, tra 25px e 55px.',
  1920|   'Set a maximum date for dates to be picked up to.' => 'Imposta una data massima per le date da selezionare.',
  1921|   'Set a maximum value that users must enter.' => 'Imposta un valore massimo che gli utenti devono inserire.',
  1922|   'Set a minimum date for dates to be picked from.' => 'Imposta una data minima da cui selezionare le date.',
  1923|   'Set a minimum value that users must enter.' => 'Imposta un valore minimo che gli utenti devono inserire.',
  1924|   'Set a specific web API version to use with {name} Web API requests.' => 'Imposta una versione specifica dell’API web da utilizzare con le richieste Web API di {name}.',
  1925|   'Set a width PayPal button in pixels, between 150px and 750px.' => 'Imposta una larghezza per il pulsante PayPal in pixel, tra 150px e 750px.',
  1926|   'Set different display layouts for this field.' => 'Imposta diversi layout di visualizzazione per questo campo.',
  1927|   'Set spam' => 'Imposta come spam',
  1928|   'Set the background color.' => 'Imposta il colore di sfondo.',
  1929|   'Set the border color.' => 'Imposta il colore del bordo.',
  1930|   'Set the border width (in pixels).' => 'Imposta la larghezza del bordo (in pixel).',
  1931|   'Set the line thickness (weight) for the pen.' => 'Imposta lo spessore della linea (peso) per la penna.',
  1932|   'Set the maximum number of spam submissions to maintain. Older spam submissions will be deleted.' => 'Imposta il numero massimo di sottomissioni di spam da mantenere. Le sottomissioni di spam più vecchie verranno eliminate.',
  1933|   'Set the maximum options that users must select.' => 'Imposta il numero massimo di opzioni che gli utenti devono selezionare.',
  1934|   'Set the maximum size of the files a user can upload.' => 'Imposta la dimensione massima dei file che un utente può caricare.',
  1935|   'Set the minimum options that users must select.' => 'Imposta il numero minimo di opzioni che gli utenti devono selezionare.',
  1936|   'Set the minimum size of the files a user can upload.' => 'Imposta la dimensione minima dei file che un utente può caricare.',
  1937|   'Set the number of decimal points to format the field value.' => 'Imposta il numero di decimali per formattare il valore del campo.',
  1938|   'Set the number of seconds to set the timeout for Ajax-based forms. This should only be adjusted for forms where a large timeout is expected, such as heavy use of file upload fields. This is also only applicable when using the Theme JS. Default to 10 seconds.' => 'Imposta il numero di secondi per il timeout dei moduli basati su Ajax. Questo dovrebbe essere regolato solo per moduli in cui è previsto un timeout elevato, come l’uso massiccio di campi di caricamento file. Questo si applica solo quando si utilizza il Theme JS. Valore predefinito: 10 secondi.',
  1939|   'Set the pen color.' => 'Imposta il colore della penna.',
  1940|   'Set the range of years relative to this year that are available to select.' => 'Imposta l’intervallo di anni relativi a quest’anno che sono disponibili per la selezione.',
  1941|   'Set the value of the impersonate header to be used.' => 'Imposta il valore dell’intestazione di impersonificazione da utilizzare.',
  1942|   'Settings' => 'Impostazioni',
  1943|   'Settings saved.' => 'Impostazioni salvate.',
  1944|   'Settlement Date Confirmed' => 'Data di regolamento confermata',
  1945|   'Set what sorts of submissions should be shown by default when viewing submissions.' => 'Imposta quali tipi di invii devono essere mostrati per impostazione predefinita durante la visualizzazione degli invii.',
  1946|   'Set when the form should be available from.' => 'Imposta la data da cui il modulo deve essere disponibile.',
  1947|   'Set when the form should be available until.' => 'Imposta la data fino a cui il modulo deve essere disponibile.',
  1948|   'Sex' => 'Sesso',
  1949|   'Seychelles Rupee' => 'Rupia delle Seychelles',
  1950|   'SharpSpring' => 'SharpSpring',
  1951|   'Sheet' => 'Foglio',
  1952|   'Shona' => 'Shona',
  1953|   'Short Day' => 'Giorno breve',
  1954|   'Short Month' => 'Mese breve',
  1955|   'Short Name' => 'Nome breve',
  1956|   'Should any additional actions be performed?' => 'Devono essere eseguite azioni aggiuntive?',
  1957|   'Show' => 'Mostra',
  1958|   'Show Back Button' => 'Mostra pulsante Indietro',
  1959|   'Show Current Location Button' => 'Mostra pulsante Posizione attuale',
  1960|   'Show email notification advanced tab' => 'Mostra scheda avanzata delle notifiche email',
  1961|   'Show email notification templates tab' => 'Mostra scheda modelli di notifica email',
  1962|   'Show error message' => 'Mostra messaggio di errore',
  1963|   'Show form appearance tab' => 'Mostra scheda aspetto del modulo',
  1964|   'Show form behaviour tab' => 'Mostra scheda comportamento del modulo',
  1965|   'Show form email notifications tab' => 'Mostra scheda notifiche email del modulo',
  1966|   'Show form integrations tab' => 'Mostra scheda integrazioni del modulo',
  1967|   'Show form settings tab' => 'Mostra scheda impostazioni del modulo',
  1968|   'Show form usage tab' => 'Mostra scheda utilizzo del modulo',
  1969|   'Show on All Pages' => 'Mostra su tutte le pagine',
  1970|   'Show Save Button' => 'Mostra pulsante Salva',
  1971|   'Show Structure' => 'Mostra struttura',
  1972|   'Show success' => 'Mostra successo',
  1973|   'Sichuan Yi; Nuosu' => 'Yi del Sichuan; Nuosu',
  1974|   'Signature' => 'Firma',
  1975|   'Sign up users to your {name} lists to grow your audience for campaigns.' => 'Iscrivi gli utenti alle tue liste {name} per far crescere il tuo pubblico per le campagne.',
  1976|   'Silver' => 'Argento',
  1977|   'Sindhi' => 'Sindhi',
  1978|   'Singapore Dollar' => 'Dollaro di Singapore',
  1979|   'Single' => 'Singolo',
  1980|   'Single-line Text' => 'Testo su una riga',
  1981|   'Sinhala; Sinhalese' => 'Sinhala; Singalese',
  1982|   'Site Key' => 'Chiave del sito',
  1983|   'Site Name' => 'Nome del sito',
  1984|   'Size' => 'Dimensione',
  1985|   'Skilled Labor' => 'Manodopera qualificata',
  1986|   'Slack' => 'Slack',
  1987|   'Slovak' => 'Slovacco',
  1988|   'Slovenian' => 'Sloveno',
  1989|   'Small' => 'Piccolo',
  1990|   'Snaptcha' => 'Snaptcha',
  1991|   'Snaptcha is an invisible CAPTCHA that automatically validates forms and prevents spam bots from submitting to your Craft CMS site. Find out more via [Snaptcha Plugin](https://plugins.craftcms.com/snaptcha).' => 'Snaptcha è un CAPTCHA invisibile che convalida automaticamente i moduli e previene l\'invio da parte di bot spam sul tuo sito Craft CMS. Scopri di più tramite il [plugin Snaptcha](https://plugins.craftcms.com/snaptcha).',
  1992|   'Social' => 'Sociale',
  1993|   'Social (Facebook)' => 'Social (Facebook)',
  1994|   'Social (LinkedIn)' => 'Social (LinkedIn)',
  1995|   'Social (Twitter)' => 'Social (Twitter)',
  1996|   'Sol' => 'Sol',
  1997|   'Solid' => 'Solido',
  1998|   'Solomon Islands Dollar' => 'Dollaro delle Isole Salomone',
  1999|   'Som' => 'Som',
  2000|   'Somali' => 'Somalo',
  2001|   'Somali Shilling' => 'Scellino Somalo',
  2002|   'Some College' => 'Qualche università',
  2003|   'Some forms restored.' => 'Alcuni moduli ripristinati.',
  2004|   'Some Recipients are invalid.' => 'Alcuni destinatari non sono validi.',
  2005|   'Some Sent Notifications restored.' => 'Alcune notifiche inviate sono state ripristinate.',
  2006|   'Some submissions restored.' => 'Alcune sottomissioni ripristinate.',
  2007|   'Somewhat acceptable' => 'Abbastanza accettabile',
  2008|   'Somewhat Better' => 'Leggermente migliore',
  2009|   'Somewhat important' => 'Abbastanza importante',
  2010|   'Somewhat Worse' => 'Leggermente peggiore',
  2011|   'Somoni' => 'Somoni',
  2012|   'Sotho, Southern' => 'Sotho del sud',
  2013|   'Source' => 'Fonte',
  2014|   'Source Campaign' => 'Campagna di origine',
  2015|   'Source Channel' => 'Canale di origine',
  2016|   'Source Name' => 'Nome della fonte',
  2017|   'Sources' => 'Fonti',
  2018|   'Source Type' => 'Tipo di fonte',
  2019|   'Source URL' => 'URL della fonte',
  2020|   'South America' => 'Sud America',
  2021|   'South Sudanese Pound' => 'Sterlina del Sudan del Sud',
  2022|   'Spam' => 'Spam',
  2023|   'Spam Keywords' => 'Parole chiave di spam',
  2024|   'Spam Settings' => 'Impostazioni spam',
  2025|   'Spam Submission Behavior' => 'Comportamento delle sottomissioni spam',
  2026|   'Spam Submission Limit' => 'Limite di sottomissioni spam',
  2027|   'Spanish; Castilian' => 'Spagnolo; Castigliano',
  2028|   'Specific Date/Time' => 'Data/Ora specifica',
  2029|   'Specify a query parameter to pre-populate the value of this field.' => 'Specifica un parametro di query per pre-popolare il valore di questo campo.',
  2030|   'Specify when the captcha should start solving a puzzle. Refer to {link}.' => 'Specifica quando il captcha dovrebbe iniziare a risolvere un puzzle. Consulta {link}.',
  2031|   'Spinner' => 'Indicatore di caricamento',
  2032|   'Split Cells' => 'Dividi celle',
  2033|   'Spouse Name' => 'Nome del coniuge',
  2034|   'Spreadsheet ID' => 'ID del foglio di calcolo',
  2035|   'Sprout Forms' => 'Sprout Forms',
  2036|   'Sri Lanka Rupee' => 'Rupia dello Sri Lanka',
  2037|   'Staff ID' => 'ID del personale',
  2038|   'Stage' => 'Fase',
  2039|   'Stages' => 'Fasi',
  2040|   'Starred' => 'Con stella',
  2041|   'Start' => 'Inizia',
  2042|   'Starting data retention checks for form “{f}”: {d} {c}.' => 'Avvio dei controlli di conservazione dei dati per il modulo “{f}”: {d} {c}.',
  2043|   'Start Mode' => 'Modalità di avvio',
  2044|   'Start of form' => 'Inizio del modulo',
  2045|   'starts with' => 'inizia con',
  2046|   'Star Value' => 'Valore della stella',
  2047|   'State' => 'Stato',
  2048|   'State / Province' => 'Stato / Provincia',
  2049|   'State Province' => 'Stato Provincia',
  2050|   'States (Australia)' => 'Stati (Australia)',
  2051|   'States (Canada)' => 'Stati (Canada)',
  2052|   'States (USA)' => 'Stati (USA)',
  2053|   'Static' => 'Statico',
  2054|   'Status' => 'Stato',
  2055|   'Statuses' => 'Stati',
  2056|   'Status saved.' => 'Stato salvato.',
  2057|   'Stencil' => 'Stencil',
  2058|   'Stencils' => 'Stencils',
  2059|   'Stencil saved.' => 'Stencil salvato.',
  2060|   'Street' => 'Via',
  2061|   'Street 2' => 'Via 2',
  2062|   'Strike' => 'Barrato',
  2063|   'Strike-through' => 'Barrato',
  2064|   'Stripe' => 'Stripe',
  2065|   'Strongly agree' => 'Fortemente d’accordo',
  2066|   'Strongly disagree' => 'Fortemente in disaccordo',
  2067|   'Student' => 'Studente',
  2068|   'Sub-Field Configuration' => 'Configurazione del sotto-campo',
  2069|   'Subdomain' => 'Sottodominio',
  2070|   'Subfield Label Position' => 'Posizione dell’etichetta del sotto-campo',
  2071|   'Subject' => 'Oggetto',
  2072|   'Subject:' => 'Oggetto:',
  2073|   'Submission' => 'Sottomissione',
  2074|   'Submission CP URL' => 'URL CP della sottomissione',
  2075|   'Submission Date' => 'Data di sottomissione',
  2076|   'Submission ID' => 'ID della sottomissione',
  2077|   'Submission marked as spam - “{r}” - {j}.' => 'Sottomissione contrassegnata come spam - “{r}” - {j}.',
  2078|   'Submission Message' => 'Messaggio di sottomissione',
  2079|   'Submission Message Position' => 'Posizione del messaggio di sottomissione',
  2080|   'Submission Message Timeout' => 'Timeout del messaggio di sottomissione',
  2081|   'Submission Method' => 'Metodo di sottomissione',
  2082|   'Submission not found.' => 'Sottomissione non trovata.',
  2083|   'Submissions' => 'Sottomissioni',
  2084|   'Submissions (Formie)' => 'Sottomissioni (Formie)',
  2085|   'Submission saved.' => 'Sottomissione salvata.',
  2086|   'Submissions deleted.' => 'Sottomissioni eliminate.',
  2087|   'Submissions not restored.' => 'Sottomissioni non ripristinate.',
  2088|   'Submissions restored.' => 'Sottomissioni ripristinate.',
  2089|   'Submission Title Format' => 'Formato del titolo della sottomissione',
  2090|   'Submission UID' => 'UID della sottomissione',
  2091|   'Submit' => 'Invia',
  2092|   'Submitted in {s}s, below the {m}s setting.' => 'Inviato in {s}s, inferiore all’impostazione di {m}s.',
  2093|   'Subscribe' => 'Iscriviti',
  2094|   'Subscribe Status' => 'Stato di iscrizione',
  2095|   'Subscript' => 'Pedice',
  2096|   'Subscription' => 'Abbonamento',
  2097|   'Subscription cancelled.' => 'Abbonamento annullato.',
  2098|   'Subscription Description' => 'Descrizione dell’abbonamento',
  2099|   'Subscription error: “{message}” {file}:{line}. Payload: “{payload}”. Response: “{response}”' => 'Errore di abbonamento: “{message}” {file}:{line}. Payload: “{payload}”. Risposta: “{response}”',
  2100|   'Subscription Frequency' => 'Frequenza dell’abbonamento',
  2101|   'Subtract' => 'Sottrai',
  2102|   'Success' => 'Successo',
  2103|   'Success!' => 'Successo!',
  2104|   'Successfully synced with SharpSpring' => 'Sincronizzato con successo con SharpSpring',
  2105|   'Sudanese Pound' => 'Sterlina sudanese',
  2106|   'Suffix' => 'Suffisso',
  2107|   'SugarCRM' => 'SugarCRM',
  2108|   'Summary' => 'Riepilogo',
  2109|   'Summary ' => 'Riepilogo ',
  2110|   'Sundanese' => 'Sundanese',
  2111|   'Superscript' => 'Apice',
  2112|   'Support' => 'Supporto',
  2113|   'Support request error: “{message}” {file}:{line}' => 'Errore nella richiesta di supporto: “{message}” {file}:{line}',
  2114|   'Support request sent successfully.' => 'Richiesta di supporto inviata con successo.',
  2115|   'Surinam Dollar' => 'Dollaro del Suriname',
  2116|   'Swahili' => 'Swahili',
  2117|   'Swati' => 'Swati',
  2118|   'Swedish' => 'Svedese',
  2119|   'Swedish Krona' => 'Corona svedese',
  2120|   'Swiss Franc' => 'Franco svizzero',
  2121|   'Synced' => 'Sincronizzato',
  2122|   'Sync with Native Form' => 'Sincronizza con il modulo nativo',
  2123|   'Syrian Pound' => 'Sterlina siriana',
  2124|   'System Email' => 'Email di sistema',
  2125|   'System Name' => 'Nome del sistema',
  2126|   'System Reply-To' => 'Rispondi a sistema',
  2127|   'Table' => 'Tabella',
  2128|   'Table Columns' => 'Colonne della tabella',
  2129|   'Tagalog' => 'Tagalog',
  2130|   'Tags' => 'Tag',
  2131|   'Tahitian' => 'Tahitiano',
  2132|   'Tajik' => 'Tagico',
  2133|   'Taka' => 'Taka',
  2134|   'Tala' => 'Tala',
  2135|   'Tamil' => 'Tamil',
  2136|   'Tanzanian Shilling' => 'Scellino tanzaniano',
  2137|   'Task Field Mapping' => 'Mappatura dei campi del compito',
  2138|   'Task Subject' => 'Oggetto del compito',
  2139|   'Tatar' => 'Tataro',
  2140|   'Technology' => 'Tecnologia',
  2141|   'Telecommunications' => 'Telecomunicazioni',
  2142|   'Telugu' => 'Telugu',
  2143|   'Template Directory' => 'Directory del template',
  2144|   'Template ID' => 'ID del template',
  2145|   'Templates' => 'Template',
  2146|   'Template saved.' => 'Template salvato.',
  2147|   'Tenant' => 'Inquilino',
  2148|   'Tenge' => 'Tenge',
  2149|   'Territory' => 'Territorio',
  2150|   'Text' => 'Testo',
  2151|   'text (~64KB)' => 'testo (~64KB)',
  2152|   'Text Inputs' => 'Input di testo',
  2153|   'Text shown over the submit button, when in the loading state.' => 'Testo mostrato sopra il pulsante di invio, quando è in stato di caricamento.',
  2154|   'Thai' => 'Tailandese',
  2155|   'That handle is already in use' => 'Quel handle è già in uso',
  2156|   'The body content for this notification.' => 'Il contenuto del corpo per questa notifica.',
  2157|   'The default status to be assigned to new submissions.' => 'Lo stato predefinito da assegnare alle nuove sottomissioni.',
  2158|   'The default value for the field when it loads.' => 'Il valore predefinito per il campo quando viene caricato.',
  2159|   'The description for the field. This will be shown next to the checkbox.' => 'La descrizione del campo. Verrà mostrata accanto alla casella di controllo.',
  2160|   'The description text shown at the top of the field.' => 'Il testo della descrizione mostrato in cima al campo.',
  2161|   'The directory must be empty for files to be copied.' => 'La directory deve essere vuota affinché i file possano essere copiati.',
  2162|   'The email address for the notification email "sender" header, for advanced usage. Leave empty to use the "From Email".' => 'L\'indirizzo email per l\'intestazione del mittente dell\'email di notifica, per utilizzi avanzati. Lascia vuoto per usare l\'email "Da".',
  2163|   'The email address the notification email will be sent from. Leave empty to use the default email address for your site.' => 'L\'indirizzo email da cui sarà inviata l\'email di notifica. Lascia vuoto per utilizzare l\'indirizzo email predefinito del sito.',
  2164|   'The email address to be used as the reply to address for the notification email.' => 'L\'indirizzo email da utilizzare come indirizzo di risposta per l\'email di notifica.',
  2165|   'The example below shows a preview of this email notification.' => 'L\'esempio seguente mostra un\'anteprima di questa email di notifica.',
  2166|   'The filename for the PDF (excluding `.pdf`). You can include variables for submissions and notifications, such as `{submission.myField}` or `{notification.subject}`.' => 'Il nome del file per il PDF (escluso `.pdf`). Puoi includere variabili per le sottomissioni e le notifiche, come `{submission.myField}` o `{notification.subject}`.',
  2167|   'The full URL that the user to be redirected to.' => 'L\'URL completo a cui l\'utente verrà reindirizzato.',
  2168|   'The label for the back submit button.' => 'L\'etichetta per il pulsante di invio "indietro".',
  2169|   'The label for the button that adds another instance.' => 'L\'etichetta per il pulsante che aggiunge un\'altra istanza.',
  2170|   'The label for the button that adds another row.' => 'L\'etichetta per il pulsante che aggiunge un\'altra riga.',
  2171|   'The label for the save submit button.' => 'L\'etichetta per il pulsante di invio e salvataggio.',
  2172|   'The label for the submit button.' => 'L\'etichetta per il pulsante di invio.',
  2173|   'The label for this page.' => 'L\'etichetta per questa pagina.',
  2174|   'The label that describes this field.' => 'L\'etichetta che descrive questo campo.',
  2175|   'The maximum age of an incomplete submission in days before it is deleted in garbage collection. Set to 0 to disable automatic deletion.' => 'L\'età massima di una sottomissione incompleta in giorni prima che venga eliminata nella pulizia automatica. Imposta a 0 per disabilitare l\'eliminazione automatica.',
  2176|   'The maximum required number of instances of this repeater‘s fields that must be completed.' => 'Il numero massimo richiesto di istanze dei campi di questo ripetitore che devono essere completate.',
  2177|   'The maximum required number of rows in this table that must be completed.' => 'Il numero massimo richiesto di righe in questa tabella che devono essere completate.',
  2178|   'Theme' => 'Tema',
  2179|   'The message displayed to once the limit has been reached.' => 'Il messaggio mostrato quando il limite è stato raggiunto.',
  2180|   'The message displayed to users who are not logged in.' => 'Il messaggio mostrato agli utenti che non sono connessi.',
  2181|   'The message displayed when the current time is after the scheduled start date.' => 'Il messaggio mostrato quando l\'ora corrente è successiva alla data di inizio pianificata.',
  2182|   'The message displayed when the current time is before the scheduled start date.' => 'Il messaggio mostrato quando l\'ora corrente è precedente alla data di inizio pianificata.',
  2183|   'The minimum required number of instances of this repeater‘s fields that must be completed.' => 'Il numero minimo richiesto di istanze dei campi di questo ripetitore che devono essere completate.',
  2184|   'The minimum required number of rows in this table that must be completed.' => 'Il numero minimo richiesto di righe in questa tabella che devono essere completate.',
  2185|   'The name and email cannot be blank.' => 'Il nome e l\'email non possono essere vuoti.',
  2186|   'The name of this field displayed only to you' => 'Il nome di questo campo visualizzato solo per te.',
  2187|   'The names and email addresses that failed email notification alerts will be sent to.' => 'I nomi e gli indirizzi email a cui verranno inviate le notifiche di avviso per le email non riuscite.',
  2188|   'The name the notification email will be sent from.' => 'Il nome da cui verrà inviata l\'email di notifica.',
  2189|   'The name to be used as the reply to for the notification email.' => 'Il nome da utilizzare come risposta per l\'email di notifica.',
  2190|   'The number of days to keep sent notifications before they are deleted permanently. Set to 0 to disable automatic deletion.' => 'Il numero di giorni per mantenere le notifiche inviate prima che vengano eliminate definitivamente. Imposta a 0 per disabilitare l\'eliminazione automatica.',
  2191|   'The number of seconds to automatically hide the message. Leave empty to disable hiding.' => 'Il numero di secondi per nascondere automaticamente il messaggio. Lascia vuoto per disabilitare la funzione.',
  2192|   'The number of submissions to allow.' => 'Il numero di sottomissioni consentite.',
  2193|   'The option shown initially, when no option is selected.' => 'L\'opzione mostrata inizialmente, quando non viene selezionata alcuna opzione.',
  2194|   'The required attribute will not be synced across field instances.' => 'L\'attributo richiesto non verrà sincronizzato tra le istanze del campo.',
  2195|   'The subject of the email notification.' => 'L\'oggetto dell\'email di notifica.',
  2196|   'The template directory does not exist.' => 'La directory del template non esiste.',
  2197|   'The template directory that will be used to render the form.' => 'La directory del template che verrà utilizzata per il rendering del modulo.',
  2198|   'The template does not exist.' => 'Il template non esiste.',
  2199|   'The template that will be used to render the email.' => 'Il template che verrà utilizzato per il rendering dell\'email.',
  2200|   'The template that will be used to render the PDF.' => 'Il template che verrà utilizzato per il rendering del PDF.',
  2201|   'The text that will be shown if the field doesn’t have a value.' => 'Il testo che verrà mostrato se il campo non ha un valore.',
  2202|   'The text to be displayed in the heading.' => 'Il testo da visualizzare nell\'intestazione.',
  2203|   'The type of column this field should get in the database.' => 'Il tipo di colonna che questo campo dovrebbe avere nel database.',
  2204|   'The value of this field when it is checked.' => 'Il valore di questo campo quando è selezionato.',
  2205|   'The value of this field when it is unchecked.' => 'Il valore di questo campo quando non è selezionato.',
  2206|   'The visibility of the field on the front-end.' => 'La visibilità del campo sul front-end.',
  2207|   'This action will be permanent.' => 'Questa azione sarà permanente.',
  2208|   'This form has met the number of allowed submissions.' => 'Questo modulo ha raggiunto il numero di sottomissioni consentite.',
  2209|   'This form is not available.' => 'Questo modulo non è disponibile.',
  2210|   'this notification if' => 'questa notifica se',
  2211|   'This payment requires 3D Secure authentication. Please follow the instructions on-screen to continue.' => 'Questo pagamento richiede l\'autenticazione 3D Secure. Segui le istruzioni a schermo per continuare.',
  2212|   'This text will be sent to {name}.' => 'Questo testo verrà inviato a {name}.',
  2213|   'This text will be shown after submission, as a success message.' => 'Questo testo verrà mostrato dopo la sottomissione, come messaggio di successo.',
  2214|   'This text will be shown as an error after submission.' => 'Questo testo verrà mostrato come errore dopo la sottomissione.',
  2215|   'This text will be shown when an error on the submission occurs.' => 'Questo testo verrà mostrato quando si verifica un errore nella sottomissione.',
  2216|   'This will clear the form of values, and showing no success message.' => 'Questo cancellerà i valori del modulo, senza mostrare un messaggio di successo.',
  2217|   'This will reload the page, clearing the form of values, and showing no success message.' => 'Questo ricaricherà la pagina, cancellando i valori del modulo e non mostrerà alcun messaggio di successo.',
  2218|   'This will resend the below email to the recipients of your choosing.' => 'Questo reinvierà l\'email seguente ai destinatari di tua scelta.',
  2219|   'This will update the existing “{handle}” form and completely replace its settings, fields, layout, notifications and more with the data you‘re importing.' => 'Questo aggiornerà il modulo esistente “{handle}” e sostituirà completamente le sue impostazioni, campi, layout, notifiche e altro con i dati che stai importando.',
  2220|   'Tibetan' => 'Tibetano',
  2221|   'Ticket Field Mapping' => 'Mappatura campi del ticket',
  2222|   'Tigrinya' => 'Tigrino',
  2223|   'Time' => 'Ora',
  2224|   'Time (12h)' => 'Ora (12h)',
  2225|   'Time (24h)' => 'Ora (24h)',
  2226|   'Time Format' => 'Formato orario',
  2227|   'Timestamp' => 'Timestamp',
  2228|   'Timezone' => 'Fuso orario',
  2229|   'Title' => 'Titolo',
  2230|   'To:' => 'A:',
  2231|   'Today‘s Date/Time' => 'Data/Ora di oggi',
  2232|   'Toggle Checkbox Label' => 'Attiva/disattiva etichetta checkbox',
  2233|   'Toggle Header Cell' => 'Attiva/disattiva cella intestazione',
  2234|   'Toggle Header Column' => 'Attiva/disattiva colonna intestazione',
  2235|   'Toggle Header Row' => 'Attiva/disattiva riga intestazione',
  2236|   'Tonga (Tonga Islands)' => 'Tonga (Isole Tonga)',
  2237|   'Top of Form' => 'Inizio modulo',
  2238|   'Top of List' => 'Inizio elenco',
  2239|   'total' => 'totale',
  2240|   'Totally unacceptable' => 'Totalmente inaccettabile',
  2241|   'Tracking ID' => 'ID tracciamento',
  2242|   'Transaction Type' => 'Tipo di transazione',
  2243|   'Transportation/Logistics' => 'Trasporti/Logistica',
  2244|   'Trello' => 'Trello',
  2245|   'Triggering form “{handle}” integration.' => 'Integrazione del modulo “{handle}” in corso.',
  2246|   'Trigger Integrations' => 'Attiva integrazioni',
  2247|   'Trinidad and Tobago Dollar' => 'Dollaro di Trinidad e Tobago',
  2248|   'True' => 'Vero',
  2249|   'Tsonga' => 'Tsonga',
  2250|   'Tswana' => 'Tswana',
  2251|   'Tugrik' => 'Tugrik',
  2252|   'Tunisian Dinar' => 'Dinaro tunisino',
  2253|   'Turkish' => 'Turco',
  2254|   'Turkish Lira' => 'Lira turca',
  2255|   'Turkmen' => 'Turcomanno',
  2256|   'Turkmenistan New Manat' => 'Nuovo Manat turkmeno',
  2257|   'Tweet' => 'Tweet',
  2258|   'Twi' => 'Twi',
  2259|   'Twitter' => 'Twitter',
  2260|   'Twitter ID' => 'ID Twitter',
  2261|   'Type' => 'Tipo',
  2262|   'Types' => 'Tipi',
  2263|   'UAE Dirham' => 'Dirham degli Emirati Arabi Uniti',
  2264|   'UAT API Key' => 'Chiave API UAT',
  2265|   'UAT API Token' => 'Token API UAT',
  2266|   'Uganda Shilling' => 'Scellino ugandese',
  2267|   'Uighur; Uyghur' => 'Uiguro',
  2268|   'Ukrainian' => 'Ucraino',
  2269|   'Unable to authorize connect “{integration}”.' => 'Impossibile autorizzare la connessione “{integration}”.',
  2270|   'Unable to authorize connect “{integration}”: “{message}” {file}:{line}' => 'Impossibile autorizzare la connessione “{integration}”: “{message}” {file}:{line}',
  2271|   'Unable to fetch token.' => 'Impossibile recuperare il token.',
  2272|   'Unable to find field “{field}” for opt-in in submission.' => 'Impossibile trovare il campo “{field}” per l\'opt-in nella sottomissione.',
  2273|   'Unable to find integration.' => 'Impossibile trovare l\'integrazione.',
  2274|   'Unable to find integration “{integration}”.' => 'Impossibile trovare l\'integrazione “{integration}”.',
  2275|   'Unable to import form.' => 'Impossibile importare il modulo.',
  2276|   'Unable to process callback for “{integration}”: “{message}” {file}:{line}' => 'Impossibile elaborare il callback per “{integration}”: “{message}” {file}:{line}',
  2277|   'Unable to save contact: “{errors}”.' => 'Impossibile salvare il contatto: “{errors}”.',
  2278|   'Unable to save element integration. No `calendarId`.' => 'Impossibile salvare l\'integrazione dell\'elemento. Nessun `calendarId`.',
  2279|   'Unable to save element integration. No `entryTypeId`.' => 'Impossibile salvare l\'integrazione dell\'elemento. Nessun `entryTypeId`.',
  2280|   'Unable to save pending contact: “{errors}”.' => 'Impossibile salvare il contatto in sospeso: “{errors}”.',
  2281|   'Unable to save sent notification - {errors}.' => 'Impossibile salvare la notifica inviata - {errors}.',
  2282|   'Unable to save “{type}” draft element integration. Error: {error}.' => 'Impossibile salvare l\'integrazione dell\'elemento bozza “{type}”. Errore: {error}.',
  2283|   'Unable to save “{type}” element integration. Error: {error}.' => 'Impossibile salvare l\'integrazione dell\'elemento “{type}”. Errore: {error}.',
  2284|   'Unable to validate “{type}” element integration. Error: {error}.' => 'Impossibile convalidare l\'integrazione dell\'elemento “{type}”. Errore: {error}.',
  2285|   'Unacceptable' => 'Inaccettabile',
  2286|   'Unchecked Value' => 'Valore non selezionato',
  2287|   'Under 18' => 'Meno di 18',
  2288|   'Underline' => 'Sottolineato',
  2289|   'Undo' => 'Annulla',
  2290|   'Unique External ID' => 'ID esterno univoco',
  2291|   'Unique Value' => 'Valore univoco',
  2292|   'Unknown' => 'Sconosciuto',
  2293|   'Unknown field' => 'Campo sconosciuto',
  2294|   'Unknown integration: “{handle}”' => 'Integrazione sconosciuta: “{handle}”',
  2295|   'Unknown integration: “{id}”' => 'Integrazione sconosciuta: “{id}”',
  2296|   'Unlink' => 'Scollega',
  2297|   'Unmark as Spam' => 'Deseleziona come spam',
  2298|   'Unmark as spam' => 'Deseleziona come spam',
  2299|   'Unordered List' => 'Elenco non ordinato',
  2300|   'Unqualified' => 'Non qualificato',
  2301|   'Unsatisfied' => 'Insoddisfatto',
  2302|   'Unsaved' => 'Non salvato',
  2303|   'Unsubscribe' => 'Annulla iscrizione',
  2304|   'Unsubscribed' => 'Annullato iscrizione',
  2305|   'Update Element Mapping' => 'Aggiorna mappatura degli elementi',
  2306|   'Update Entries' => 'Aggiorna voci',
  2307|   'Update Events' => 'Aggiorna eventi',
  2308|   'Update Search Index' => 'Aggiorna indice di ricerca',
  2309|   'Update Users' => 'Aggiorna utenti',
  2310|   'Updating form submission content.' => 'Aggiornamento del contenuto della sottomissione del modulo.',
  2311|   'Upload Location' => 'Posizione di caricamento',
  2312|   'Upload the JSON file that‘s been exported from Formie.' => 'Carica il file JSON esportato da Formie.',
  2313|   'Urdu' => 'Urdu',
  2314|   'Urgent' => 'Urgente',
  2315|   'URL' => 'URL',
  2316|   'URL cannot be blank.' => 'L\'URL non può essere vuoto.',
  2317|   'URL of the web page that user will be redirected to after clicking on the double opt in URL.' => 'URL della pagina web a cui l\'utente verrà reindirizzato dopo aver cliccato sull\'URL di doppio opt-in.',
  2318|   'US' => 'Stati Uniti',
  2319|   'Usage' => 'Utilizzo',
  2320|   'Usage Count' => 'Conteggio utilizzo',
  2321|   'US Dollar' => 'Dollaro statunitense',
  2322|   'Use conditional logic to determine which email addresses receive this email notification.' => 'Usa la logica condizionale per determinare quali indirizzi email riceveranno questa notifica.',
  2323|   'Use Credentials' => 'Usa credenziali',
  2324|   'Use Custom Template' => 'Usa template personalizzato',
  2325|   'Use Developer API' => 'Usa API per sviluppatori',
  2326|   'Use Double Opt in' => 'Usa doppio opt-in',
  2327|   'Use Multiple Name Fields' => 'Usa campi nome multipli',
  2328|   'Use my location' => 'Usa la mia posizione',
  2329|   'Use Queue for Integrations' => 'Usa la coda per le integrazioni',
  2330|   'Use Queue for Notifications' => 'Usa la coda per le notifiche',
  2331|   'User' => 'Utente',
  2332|   'User Attribute Mapping' => 'Mappatura attributi utente',
  2333|   'User Email' => 'Email utente',
  2334|   'User Field Mapping' => 'Mappatura campi utente',
  2335|   'User First Name' => 'Nome utente',
  2336|   'User Full Name' => 'Nome completo utente',
  2337|   'User Group' => 'Gruppo utente',
  2338|   'Use Rich Text Field' => 'Usa campo di testo formattato',
  2339|   'User ID' => 'ID utente',
  2340|   'User IP Address' => 'Indirizzo IP utente',
  2341|   'User is not permitted to perform this action.' => 'L\'utente non è autorizzato a eseguire questa azione.',
  2342|   'User Last Name' => 'Cognome utente',
  2343|   'Username' => 'Nome utente',
  2344|   'Users' => 'Utenti',
  2345|   'Use Sandbox' => 'Usa sandbox',
  2346|   'Use the form below to send a test email to the nominated email address.' => 'Usa il modulo sottostante per inviare un\'email di prova all\'indirizzo email selezionato.',
  2347|   'Use this URI when setting up your {name} app.' => 'Usa questo URI quando configuri la tua app {name}.',
  2348|   'Use this URI when setting up your {name} webhook.' => 'Usa questo URI quando configuri il webhook {name}.',
  2349|   'Use UAT' => 'Usa UAT',
  2350|   'Use {link} to suggest addresses, for address fields.' => 'Usa {link} per suggerire indirizzi, per i campi degli indirizzi.',
  2351|   'Use {link} to suggest Australian and New Zealand addresses, for address fields.' => 'Usa {link} per suggerire indirizzi in Australia e Nuova Zelanda, per i campi degli indirizzi.',
  2352|   'Uzbek' => 'Uzbeco',
  2353|   'Uzbekistan Sum' => 'Som uzbeko',
  2354|   'Validate Domain (DNS)' => 'Convalida dominio (DNS)',
  2355|   'Validate Form on Submit' => 'Convalida il modulo al momento dell\'invio',
  2356|   'Validate When Typing' => 'Convalida durante la digitazione',
  2357|   'Validation' => 'Validazione',
  2358|   'Value' => 'Valore',
  2359|   'Value mismatch {a}:{b}.' => 'Il valore non corrisponde {a}:{b}.',
  2360|   'Value must be no earlier than {min}.' => 'Il valore non deve essere precedente a {min}.',
  2361|   'Value must be no later than {max}.' => 'Il valore non deve essere successivo a {max}.',
  2362|   'varchar (255B)' => 'varchar (255B)',
  2363|   'Variables' => 'Variabili',
  2364|   'Variants' => 'Varianti',
  2365|   'VAT Number' => 'Partita IVA',
  2366|   'Vatu' => 'Vatu',
  2367|   'vCita' => 'vCita',
  2368|   'Venda' => 'Venda',
  2369|   'Vendor ID' => 'ID venditore',
  2370|   'Vendor Name' => 'Nome venditore',
  2371|   'VerifiedDouble' => 'VerificatoDoppio',
  2372|   'Vertical' => 'Verticale',
  2373|   'Very difficult' => 'Molto difficile',
  2374|   'Very easy' => 'Molto facile',
  2375|   'Very important' => 'Molto importante',
  2376|   'Very satisfied' => 'Molto soddisfatto',
  2377|   'Very unsatisfied' => 'Molto insoddisfatto',
  2378|   'Vietnamese' => 'Vietnamita',
  2379|   'View all forms' => 'Visualizza tutti i moduli',
  2380|   'View all sent notifications' => 'Visualizza tutte le notifiche inviate',
  2381|   'View all submissions' => 'Visualizza tutte le sottomissioni',
  2382|   'View Submissions' => 'Visualizza sottomissioni',
  2383|   'View submissions for form “{form}”' => 'Visualizza le sottomissioni per il modulo “{form}”',
  2384|   'View “{form}” form' => 'Visualizza il modulo “{form}”',
  2385|   'View “{name}” sent notifications' => 'Visualizza le notifiche inviate “{name}”',
  2386|   'View “{name}” submissions' => 'Visualizza le sottomissioni “{name}”',
  2387|   'Visibility' => 'Visibilità',
  2388|   'Visible' => 'Visibile',
  2389|   'Volapük' => 'Volapük',
  2390|   'Walloon' => 'Vallone',
  2391|   'Warning: Currently editing synced field. Changes to this field will be applied to all instances of this field.' => 'Avviso: Attualmente stai modificando un campo sincronizzato. Le modifiche a questo campo verranno applicate a tutte le istanze di questo campo.',
  2392|   'Web Access URL' => 'URL di accesso web',
  2393|   'Webhook' => 'Webhook',
  2394|   'Webhooks' => 'Webhooks',
  2395|   'Webhook Signing Secret' => 'Segreto di firma Webhook',
  2396|   'Webhook URL' => 'URL Webhook',
  2397|   'Website' => 'Sito web',
  2398|   'Websites' => 'Siti web',
  2399|   'Week' => 'Settimana',
  2400|   'Weeks' => 'Settimane',
  2401|   'Welsh' => 'Gallese',
  2402|   'We only collect data specifically for your form, nothing else related to your install. We collect:' => 'Raccogliamo solo dati specifici per il tuo modulo, nient\'altro relativo alla tua installazione. Raccogliamo:',
  2403|   'Western Frisian' => 'Frisone occidentale',
  2404|   'Westpac PayWay' => 'Westpac PayWay',
  2405|   'We use Craft‘s [garbage collection](https://craftcms.com/docs/4.x/gc.html) mechanism to remove submissions, so this may not always be actioned immediately.' => 'Usiamo il meccanismo di [raccolta automatica](https://craftcms.com/docs/4.x/gc.html) di Craft per rimuovere le sottomissioni, quindi potrebbe non essere sempre eseguito immediatamente.',
  2406|   'What this form will be called in the control panel.' => 'Il nome di questo modulo nel pannello di controllo.',
  2407|   'What this integration will be called in the control panel.' => 'Il nome di questa integrazione nel pannello di controllo.',
  2408|   'What this notification will be called in the control panel.' => 'Il nome di questa notifica nel pannello di controllo.',
  2409|   'What this status will be called in the control panel.' => 'Il nome di questo stato nel pannello di controllo.',
  2410|   'What this stencil will be called in the control panel.' => 'Il nome di questo stencil nel pannello di controllo.',
  2411|   'What this template will be called in the control panel.' => 'Il nome di questo template nel pannello di controllo.',
  2412|   'When a field has no value and considered "empty", this text will be shown in email notifications.' => 'Quando un campo non ha valore ed è considerato "vuoto", questo testo verrà mostrato nelle notifiche via email.',
  2413|   'When a submission is marked as spam, select what behaviour to perform for users. It’s highly recommended to act as if the submission was successful to prevent parties from learning how to get around the spam protection.' => 'Quando una sottomissione è segnata come spam, seleziona quale comportamento adottare per gli utenti. Si consiglia vivamente di agire come se la sottomissione fosse riuscita per evitare che le parti capiscano come bypassare la protezione spam.',
  2414|   'When a user submits this form, I want to:' => 'Quando un utente invia questo modulo, voglio:',
  2415|   'When validating the form, show this message if an error occurs. Leave empty to retain the default message.' => 'Durante la validazione del modulo, mostra questo messaggio se si verifica un errore. Lascia vuoto per mantenere il messaggio predefinito.',
  2416|   'Where to position the error message in the form, when shown.' => 'Dove posizionare il messaggio di errore nel modulo, quando viene mostrato.',
  2417|   'Where to position the success message in the form, when shown.' => 'Dove posizionare il messaggio di successo nel modulo, quando viene mostrato.',
  2418|   'Whether any Email Notifications should be sent.' => 'Se devono essere inviate notifiche email.',
  2419|   'Whether any Integrations should be triggered.' => 'Se devono essere attivate integrazioni.',
  2420|   'Whether clicking the "Back" button on front-end forms should submit the current page content. Disabling this will show an "unload" warning and discard any un-saved content.' => 'Se il pulsante "Indietro" nei moduli del front-end dovrebbe inviare il contenuto della pagina corrente. Disabilitando questa opzione verrà mostrato un avviso di "scaricamento" e i contenuti non salvati verranno scartati.',
  2421|   'Whether existing user groups should be merged with any set above. Otherwise, any existing user groups will be overwritten.' => 'Se i gruppi di utenti esistenti devono essere uniti a quelli sopra indicati. Altrimenti, i gruppi di utenti esistenti verranno sovrascritti.',
  2422|   'Whether for multi-page forms, the page should automatically scroll to the top of the next page after submission.' => 'Se per i moduli multi-pagina, la pagina dovrebbe scorrere automaticamente in cima alla pagina successiva dopo l\'invio.',
  2423|   'Whether front-end forms should trigger an "unload" warning when a form‘s content has changed and the user tries to navigate away without submitting.' => 'Se i moduli front-end dovrebbero attivare un avviso di "scaricamento" quando il contenuto del modulo è stato modificato e l\'utente tenta di lasciare la pagina senza inviare.',
  2424|   'Whether Stripe should email a receipt to the customer on successful payment.' => 'Se Stripe dovrebbe inviare via email una ricevuta al cliente dopo un pagamento riuscito.',
  2425|   'Whether submissions for this form should be limited to a number.' => 'Se le sottomissioni per questo modulo dovrebbero essere limitate a un certo numero.',
  2426|   'Whether submissions marked as spam should still trigger email notifications.' => 'Se le sottomissioni contrassegnate come spam dovrebbero comunque attivare notifiche email.',
  2427|   'Whether tabs of all pages should be included on the page when rendering the form. This is only applicable for forms with more than one page.' => 'Se le schede di tutte le pagine dovrebbero essere incluse nella pagina durante il rendering del modulo. Questo è applicabile solo ai moduli con più di una pagina.',
  2428|   'Whether the "Usage" tab in the form builder should include draft elements.' => 'Se la scheda "Utilizzo" nel costruttore di moduli dovrebbe includere elementi di bozza.',
  2429|   'Whether the "Usage" tab in the form builder should include revision elements.' => 'Se la scheda "Utilizzo" nel costruttore di moduli dovrebbe includere elementi di revisione.',
  2430|   'Whether the title of the current page should be included when rendering the form.' => 'Se il titolo della pagina corrente dovrebbe essere incluso durante il rendering del modulo.',
  2431|   'Whether the title of this form should be included on the page when rendering the form.' => 'Se il titolo di questo modulo dovrebbe essere incluso nella pagina durante il rendering del modulo.',
  2432|   'Whether the value of this field should be included in email notifications.' => 'Se il valore di questo campo dovrebbe essere incluso nelle notifiche email.',
  2433|   'Whether this field should allow multiple options to be selected.' => 'Se questo campo dovrebbe consentire la selezione di più opzioni.',
  2434|   'Whether this field should be required when filling out the form.' => 'Se questo campo dovrebbe essere obbligatorio durante la compilazione del modulo.',
  2435|   'Whether this field should disallow adding more rows, showing only the default rows.' => 'Se questo campo dovrebbe vietare l\'aggiunta di ulteriori righe, mostrando solo le righe predefinite.',
  2436|   'Whether this field should show a "Use my location" button.' => 'Se questo campo dovrebbe mostrare un pulsante "Usa la mia posizione".',
  2437|   'Whether this field should use multiple fields for users to enter their details.' => 'Se questo campo dovrebbe utilizzare più campi per consentire agli utenti di inserire i propri dettagli.',
  2438|   'Whether this form can be viewed only by logged-in users.' => 'Se questo modulo può essere visualizzato solo dagli utenti autenticati.',
  2439|   'Whether this form should collect the users’ IP address.' => 'Se questo modulo dovrebbe raccogliere l\'indirizzo IP degli utenti.',
  2440|   'Whether this form should keep a record of the logged-in user.' => 'Se questo modulo dovrebbe conservare un registro dell\'utente autenticato.',
  2441|   'Whether this form should only be available on a schedule.' => 'Se questo modulo dovrebbe essere disponibile solo secondo un programma stabilito.',
  2442|   'Whether this integration should be enabled.' => 'Se questa integrazione dovrebbe essere abilitata.',
  2443|   'Whether this integration should update an existing entry if found, or always create a new entry. ' => 'Se questa integrazione dovrebbe aggiornare una voce esistente, se trovata, oppure creare sempre una nuova voce.',
  2444|   'Whether this integration should update an existing event if found, or always create a new event. ' => 'Se questa integrazione dovrebbe aggiornare un evento esistente, se trovato, oppure creare sempre un nuovo evento.',
  2445|   'Whether this integration should update an existing user if found, or always create a new user. ' => 'Se questa integrazione dovrebbe aggiornare un utente esistente, se trovato, oppure creare sempre un nuovo utente.',
  2446|   'Whether this integration should update the search indexes to include content for this element. ' => 'Se questa integrazione dovrebbe aggiornare gli indici di ricerca per includere i contenuti di questo elemento.',
  2447|   'Whether this notification is enabled to send.' => 'Se questa notifica è abilitata per l\'invio.',
  2448|   'Whether this status should be used as the default for new submissions.' => 'Se questo stato dovrebbe essere utilizzato come predefinito per le nuove sottomissioni.',
  2449|   'Whether to activate the user automatically.' => 'Se attivare automaticamente l\'utente.',
  2450|   'Whether to add an additional checkbox to toggle all checkboxes in this field by.' => 'Se aggiungere una casella di controllo aggiuntiva per alternare tutte le caselle di controllo in questo campo.',
  2451|   'Whether to append tags to the list of existing member tags.' => 'Se aggiungere tag all\'elenco dei tag dei membri esistenti.',
  2452|   'Whether to attach a PDF template to this email notification.' => 'Se allegare un modello PDF a questa notifica email.',
  2453|   'Whether to attach file uploads to this email notification.' => 'Se allegare file caricati a questa notifica email.',
  2454|   'Whether to create a new draft entry. If an existing entry is found, a new draft will be created on the original entry, instead of updating the existing entry. ' => 'Se creare una nuova bozza di voce. Se viene trovata una voce esistente, verrà creata una nuova bozza sulla voce originale, invece di aggiornare la voce esistente.',
  2455|   'Whether to display this field with a rich text editor for users to enter values with.' => 'Se visualizzare questo campo con un editor di testo avanzato per consentire agli utenti di inserire i valori.',
  2456|   'Whether to enable conditional logic to control how the next button is shown.' => 'Se abilitare la logica condizionale per controllare come viene mostrato il pulsante successivo.',
  2457|   'Whether to enable conditional logic to control how this email notification is sent.' => 'Se abilitare la logica condizionale per controllare come viene inviata questa notifica email.',
  2458|   'Whether to enable conditional logic to control how this field is shown.' => 'Se abilitare la logica condizionale per controllare come viene mostrato questo campo.',
  2459|   'Whether to enable conditional logic to control how this page is shown.' => 'Se abilitare la logica condizionale per controllare come viene mostrata questa pagina.',
  2460|   'Whether to enable Craft‘s CSRF validation checks for anonymous form submissions.' => 'Se abilitare i controlli di validazione CSRF di Craft per le sottomissioni di moduli anonimi.',
  2461|   'Whether to enable management of JavaScript events when this button is pressed.' => 'Se abilitare la gestione degli eventi JavaScript quando viene premuto questo pulsante.',
  2462|   'Whether to enable saving email notifications as sent notifications.' => 'Se abilitare il salvataggio delle notifiche email come notifiche inviate.',
  2463|   'Whether to enable this integration.' => 'Se abilitare questa integrazione.',
  2464|   'Whether to encrypt the value saved for this field for data-security purposes.' => 'Se crittografare il valore salvato per questo campo per motivi di sicurezza dei dati.',
  2465|   'Whether to hide the card icon, shown alongside credit card number fields.' => 'Se nascondere l\'icona della carta di credito, mostrata accanto ai campi del numero della carta di credito.',
  2466|   'Whether to hide the form and only show the success message.' => 'Se nascondere il modulo e mostrare solo il messaggio di successo.',
  2467|   'Whether to hide the zip/postal code field, shown alongside credit card number fields.' => 'Se nascondere il campo del CAP/codice postale, mostrato accanto ai campi del numero di carta di credito.',
  2468|   'Whether to limit the numbers for this field.' => 'Se limitare i numeri per questo campo.',
  2469|   'Whether to limit the options users can choose for this field.' => 'Se limitare le opzioni che gli utenti possono scegliere per questo campo.',
  2470|   'Whether to limit the value of this field.' => 'Se limitare il valore di questo campo.',
  2471|   'Whether to limit user input to unique values only. This will require that a value entered in this field does not already exist in a submission for this field and form.' => 'Se limitare l\'input dell\'utente solo a valori unici. Questo richiederà che un valore inserito in questo campo non esista già in una sottomissione per questo campo e modulo.',
  2472|   'Whether to map form data to {name} {label}.' => 'Se mappare i dati del modulo a {name} {label}.',
  2473|   'Whether to overwrite existing content, even if empty values are provided.' => 'Se sovrascrivere i contenuti esistenti, anche se vengono forniti valori vuoti.',
  2474|   'Whether to proxy the redirect URI through Verbb‘s servers. This should **only** be used for local testing. See {link} for more.' => 'Se usare i server di Verbb come proxy per l\'URI di reindirizzamento. Questo dovrebbe essere utilizzato **solo** per i test locali. Vedi {link} per maggiori dettagli.',
  2475|   'Whether to reload the page when this form is submitted, or use Ajax to send this form without reloading the page.' => 'Se ricaricare la pagina quando questo modulo viene inviato o utilizzare Ajax per inviare il modulo senza ricaricare la pagina.',
  2476|   'Whether to run [HTML Purifier](http://htmlpurifier.org) over the content to prevent malicious or invalid code being included.' => 'Se eseguire [HTML Purifier](http://htmlpurifier.org) sui contenuti per prevenire l\'inclusione di codice malevolo o non valido.',
  2477|   'Whether to save spam submissions, so they can be viewed in the control panel. Otherwise, spam submissions will be discarded.' => 'Se salvare le sottomissioni contrassegnate come spam, in modo che possano essere visualizzate nel pannello di controllo. In caso contrario, le sottomissioni di spam verranno scartate.',
  2478|   'Whether to send an email campaign to a contact' => 'Se inviare una campagna email a un contatto.',
  2479|   'Whether to send billing details alongside the payment.' => 'Se inviare i dettagli di fatturazione insieme al pagamento.',
  2480|   'Whether to send form data to a {name} Form Handler endpoint.' => 'Se inviare i dati del modulo a un endpoint {name} Form Handler.',
  2481|   'Whether to send the activation email for the user automatically.' => 'Se inviare automaticamente l\'email di attivazione per l\'utente.',
  2482|   'Whether to show a loading indicator when submitting the form. This will be shown on the submit button.' => 'Se mostrare un indicatore di caricamento durante l\'invio del modulo. Questo verrà visualizzato sul pulsante di invio.',
  2483|   'Whether to show a progress bar of the page completion. This is only applicable for forms with more than one page.' => 'Se mostrare una barra di progresso del completamento della pagina. Questo è applicabile solo per moduli con più di una pagina.',
  2484|   'Whether to show a tagline underneath buttons.' => 'Se mostrare un sottotitolo sotto i pulsanti.',
  2485|   'Whether to show the back button, to go back to a previous page.' => 'Se mostrare il pulsante "Indietro" per tornare a una pagina precedente.',
  2486|   'Whether to show the dial code on the country dropdown.' => 'Se mostrare il prefisso telefonico nel menu a discesa del paese.',
  2487|   'Whether to show the hierarchical structure of categories in the dropdown.' => 'Se mostrare la struttura gerarchica delle categorie nel menu a discesa.',
  2488|   'Whether to show the save button, allowing users to save progress on a submission to return later.' => 'Se mostrare il pulsante di salvataggio, consentendo agli utenti di salvare i progressi su una sottomissione per ritornare più tardi.',
  2489|   'Whether to use Craft‘s queue system to trigger emails. This is highly recommended to prevent slow submissions for your users.' => 'Se utilizzare il sistema di code di Craft per attivare le email. Questo è fortemente consigliato per prevenire sottomissioni lente per i tuoi utenti.',
  2490|   'Whether to use Craft‘s queue system to trigger integrations. This is highly recommended to prevent slow submissions for your users.' => 'Se utilizzare il sistema di code di Craft per attivare le integrazioni. Questo è fortemente consigliato per prevenire sottomissioni lente per i tuoi utenti.',
  2491|   'Whether to use double opt-in, which will send the user a confirmation email before they‘re added to the list.' => 'Se utilizzare il doppio opt-in, che invierà all\'utente un\'email di conferma prima di essere aggiunto alla lista.',
  2492|   'Whether to use the {name} developer API. Only use this for specific {name} developer accounts.' => 'Se utilizzare l\'API per sviluppatori di {name}. Usare solo per account sviluppatore specifici di {name}.',
  2493|   'Whether to use the {name} sandbox.' => 'Se utilizzare il sandbox di {name}.',
  2494|   'Whether to use the {name} UAT for testing.' => 'Se utilizzare l\'UAT di {name} per i test.',
  2495|   'Whether to use the {name} username/password credentials.' => 'Se utilizzare le credenziali username/password di {name}.',
  2496|   'Whether to validate each field as the user types, so that errors will appear immediately.' => 'Se convalidare ogni campo man mano che l\'utente digita, in modo che gli errori appaiano immediatamente.',
  2497|   'Whether to validate the domain name provided for the email via DNS record lookup. This can help ensure users enter valid email addresses.' => 'Se convalidare il nome di dominio fornito per l\'email tramite la ricerca del record DNS. Questo può aiutare a garantire che gli utenti inseriscano indirizzi email validi.',
  2498|   'Whether to validate the form client-side, when the user submits the form. This will show errors as soon as the submit button is pressed. Forms will also always be validated server-side.' => 'Se convalidare il modulo lato client, quando l\'utente invia il modulo. Verranno mostrati errori non appena il pulsante di invio viene premuto. I moduli saranno sempre convalidati anche lato server.',
  2499|   'Which source do you want to select categories from?' => 'Da quale fonte desideri selezionare le categorie?',
  2500|   'Which source do you want to select tags from?' => 'Da quale fonte desideri selezionare i tag?',
  2501|   'Which source do you want to select variants from?' => 'Da quale fonte desideri selezionare le varianti?',
  2502|   'Which sources do you want to select entries from?' => 'Da quali fonti desideri selezionare le voci?',
  2503|   'Which sources do you want to select products from?' => 'Da quali fonti desideri selezionare i prodotti?',
  2504|   'Which sources do you want to select users from?' => 'Da quali fonti desideri selezionare gli utenti?',
  2505|   'White' => 'Bianco',
  2506|   'Widget Options' => 'Opzioni del Widget',
  2507|   'Widowed' => 'Vedovo/a',
  2508|   'Width' => 'Larghezza',
  2509|   'Win Probability' => 'Probabilità di vincita',
  2510|   'Wolof' => 'Wolof',
  2511|   'Won' => 'Won',
  2512|   'Words' => 'Parole',
  2513|   'Work Number' => 'Numero di lavoro',
  2514|   'Workspace ID' => 'ID Spazio di lavoro',
  2515|   'Workspace Users' => 'Utenti dello spazio di lavoro',
  2516|   'Would You' => 'Vorresti',
  2517|   'Xhosa' => 'Xhosa',
  2518|   'Year' => 'Anno',
  2519|   'Year Range' => 'Intervallo di anni',
  2520|   'Years' => 'Anni',
  2521|   'Years in Business' => 'Anni di attività',
  2522|   'Yemeni Rial' => 'Rial yemenita',
  2523|   'Yen' => 'Yen',
  2524|   'Yes' => 'Sì',
  2525|   'Yet To Start' => 'Ancora da iniziare',
  2526|   'Yiddish' => 'Yiddish',
  2527|   'Yoruba' => 'Yoruba',
  2528|   'You are about to resend {desc}. You can resend each notification to their original recipients, or choose specific recipients.' => 'Stai per reinviare {desc}. Puoi reinviare ogni notifica ai destinatari originali o scegliere destinatari specifici.',
  2529|   'You must be logged in to submit this form.' => 'Devi essere autenticato per inviare questo modulo.',
  2530|   'You must enter at least one name and email.' => 'Devi inserire almeno un nome e un\'email.',
  2531|   'You must enter at least {limit} characters.' => 'Devi inserire almeno {limit} caratteri.',
  2532|   'You must enter at least {limit} words.' => 'Devi inserire almeno {limit} parole.',
  2533|   'You must save your form before sending a test payload.' => 'Devi salvare il tuo modulo prima di inviare un payload di test.',
  2534|   'You must select a form.' => 'Devi selezionare un modulo.',
  2535|   'You must upload a file.' => 'Devi caricare un file.',
  2536|   'You must use Ajax submissions when using some payment integrations in your form.' => 'Devi utilizzare le sottomissioni Ajax quando utilizzi alcune integrazioni di pagamento nel tuo modulo.',
  2537|   'Your browser does not support the Signature field' => 'Il tuo browser non supporta il campo Firma',
  2538|   'Your Craft version' => 'La tua versione di Craft',
  2539|   'Your custom form/email templates (if using any)' => 'I tuoi modelli personalizzati di modulo/email (se utilizzati)',
  2540|   'Your Email' => 'La tua Email',
  2541|   'Your Form' => 'Il tuo Modulo',
  2542|   'Your form (selected below) settings, fields, and notifications' => 'Le impostazioni, i campi e le notifiche del tuo modulo (selezionato qui sotto)',
  2543|   'Your form “{title}” has been imported. <a href="{cpEditUrl}">Edit Form</a>' => 'Il tuo modulo "{title}" è stato importato. <a href="{cpEditUrl}">Modifica modulo</a>',
  2544|   'Your Google Cloud project ID.' => 'Il tuo ID progetto di Google Cloud.',
  2545|   'Your original Freeform forms will remain un-touched.' => 'I tuoi moduli originali di Freeform rimarranno intatti.',
  2546|   'Your original Sprout Forms will remain un-touched.' => 'I tuoi moduli originali di Sprout Forms rimarranno intatti.',
  2547|   'Your `composer.json` and `composer.lock` files' => 'I tuoi file `composer.json` e `composer.lock`',
  2548|   'Your {name} log file(s)' => 'I tuoi file di log {name}',
  2549|   'Your {name} version and license' => 'La tua versione e licenza {name}',
  2550|   'Yuan Renminbi' => 'Yuan Renminbi',
  2551|   'Zambian Kwacha' => 'Kwacha zambiano',
  2552|   'Zapier' => 'Zapier',
  2553|   'Zhuang; Chuang' => 'Zhuang; Chuang',
  2554|   'Zimbabwe Dollar' => 'Dollaro dello Zimbabwe',
  2555|   'Zip' => 'CAP',
  2556|   'ZIP / Postal Code' => 'CAP / Codice Postale',
  2557|   'Zip Code' => 'Codice Postale',
  2558|   'Zipcode' => 'CAP',
  2559|   'Zloty' => 'Zloty',
  2560|   'Zoho' => 'Zoho',
  2561|   'Zulu' => 'Zulu',
  2562|   '{attribute} "{value}" has already been taken.' => '{attribute} "{value}" è già stato utilizzato.',
  2563|   '{attribute} is invalid.' => '{attribute} non è valido.',
  2564|   '{attribute} must be no greater than {max}.' => '{attribute} non deve essere maggiore di {max}.',
  2565|   '{attribute} must be no less than {min}.' => '{attribute} non deve essere inferiore a {min}.',
  2566|   '{count} notification emails resent successfully.' => '{count} email di notifica inviate con successo.',
  2567|   '{message} {response}. Sent payload {payload}' => '{message} {response}. Payload inviato {payload}',
  2568|   '{name} connected.' => '{name} connesso.',
  2569|   '{name} Copy' => 'Copia di {name}',
  2570|   '{name} disconnected.' => '{name} disconnesso.',
  2571|   '{name} Field' => 'Campo {name}',
  2572|   '{name} is required.' => '{name} è obbligatorio.',
  2573|   '{name} must be mapped.' => '{name} deve essere mappato.',
  2574|   '{name} must match {value}.' => '{name} deve corrispondere a {value}.',
  2575|   '{num} files uploaded.' => '{num} file caricati.',
  2576|   '{num} file uploaded.' => '{num} file caricato.',
  2577|   '{num} form submissions' => '{num} sottomissioni di moduli',
  2578|   '{startTag}{num}{endTag} characters left' => '{startTag}{num}{endTag} caratteri rimanenti',
  2579|   '{startTag}{num}{endTag} words left' => '{startTag}{num}{endTag} parole rimanenti',
  2580|   '{title} (Trashed)' => '{title} (Cestinato)',
  2581|   '{title} - {name}' => '{title} - {name}',
  2582|   '{title} Copy' => 'Copia di {title}',
  2583|   '“channel” not configured.' => '“channel” non configurato.',
  2584|   '“{domain}” is not allowed.' => '“{domain}” non è consentito.',
  2585|   '“{handle}” isn’t a valid handle.' => '“{handle}” non è un handle valido.',
  2586|   '“{id}” does not support connection.' => '“{id}” non supporta la connessione.',
  2587|   '“{name}” must be unique.' => '“{name}” deve essere univoco.',
  2588|   '{attribute} cannot be blank.' => '{attribute} non può essere vuoto.',
  2589| ];


# ====================================================================
# FILE: src/web/assets/frontend/dist/js/fields/phone-country.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-1 ---
     1| !function(){var d={1446:function(d){var t;t=()=>{var d=(()=>{var d=Object.defineProperty,t=Object.getOwnPropertyDescriptor,e=Object.getOwnPropertyNames,$=Object.prototype.hasOwnProperty,n={};((t,e)=>{for(var $ in e)d(t,$,{get:e[$],enumerable:!0})})(n,{default:()=>v});var i=[["af","93"],["ax","358",1],["al","355"],["dz","213"],["as","1",5,["684"]],["ad","376"],["ao","244"],["ai","1",6,["264"]],["ag","1",7,["268"]],["ar","54"],["am","374"],["aw","297"],["ac","247"],["au","61",0,null,"0"],["at","43"],["az","994"],["bs","1",8,["242"]],["bh","973"],["bd","880"],["bb","1",9,["246"]],["by","375"],["be","32"],["bz","501"],["bj","229"],["bm","1",10,["441"]],["bt","975"],["bo","591"],["ba","387"],["bw","267"],["br","55"],["io","246"],["vg","1",11,["284"]],["bn","673"],["bg","359"],["bf","226"],["bi","257"],["kh","855"],["cm","237"],["ca","1",1,["204","226","236","249","250","263","289","306","343","354","365","367","368","382","387","403","416","418","428","431","437","438","450","584","468","474","506","514","519","548","579","581","584","587","604","613","639","647","672","683","705","709","742","753","778","780","782","807","819","825","867","873","879","902","905"]],["cv","238"],["bq","599",1,["3","4","7"]],["ky","1",12,["345"]],["cf","236"],["td","235"],["cl","56"],["cn","86"],["cx","61",2,["89164"],"0"],["cc","61",1,["89162"],"0"],["co","57"],["km","269"],["cg","242"],["cd","243"],["ck","682"],["cr","506"],["ci","225"],["hr","385"],["cu","53"],["cw","599",0],["cy","357"],["cz","420"],["dk","45"],["dj","253"],["dm","1",13,["767"]],["do","1",2,["809","829","849"]],["ec","593"],["eg","20"],["sv","503"],["gq","240"],["er","291"],["ee","372"],["sz","268"],["et","251"],["fk","500"],["fo","298"],["fj","679"],["fi","358",0],["fr","33"],["gf","594"],["pf","689"],["ga","241"],["gm","220"],["ge","995"],["de","49"],["gh","233"],["gi","350"],["gr","30"],["gl","299"],["gd","1",14,["473"]],["gp","590",0],["gu","1",15,["671"]],["gt","502"],["gg","44",1,["1481","7781","7839","7911"],"0"],["gn","224"],["gw","245"],["gy","592"],["ht","509"],["hn","504"],["hk","852"],["hu","36"],["is","354"],["in","91"],["id","62"],["ir","98"],["iq","964"],["ie","353"],["im","44",2,["1624","74576","7524","7924","7624"],"0"],["il","972"],["it","39",0],["jm","1",4,["876","658"]],["jp","81"],["je","44",3,["1534","7509","7700","7797","7829","7937"],"0"],["jo","962"],["kz","7",1,["33","7"],"8"],["ke","254"],["ki","686"],["xk","383"],["kw","965"],["kg","996"],["la","856"],["lv","371"],["lb","961"],["ls","266"],["lr","231"],["ly","218"],["li","423"],["lt","370"],["lu","352"],["mo","853"],["mg","261"],["mw","265"],["my","60"],["mv","960"],["ml","223"],["mt","356"],["mh","692"],["mq","596"],["mr","222"],["mu","230"],["yt","262",1,["269","639"],"0"],["mx","52"],["fm","691"],["md","373"],["mc","377"],["mn","976"],["me","382"],["ms","1",16,["664"]],["ma","212",0,null,"0"],["mz","258"],["mm","95"],["na","264"],["nr","674"],["np","977"],["nl","31"],["nc","687"],["nz","64"],["ni","505"],["ne","227"],["ng","234"],["nu","683"],["nf","672"],["kp","850"],["mk","389"],["mp","1",17,["670"]],["no","47",0],["om","968"],["pk","92"],["pw","680"],["ps","970"],["pa","507"],["pg","675"],["py","595"],["pe","51"],["ph","63"],["pl","48"],["pt","351"],["pr","1",3,["787","939"]],["qa","974"],["re","262",0,null,"0"],["ro","40"],["ru","7",0,null,"8"],["rw","250"],["ws","685"],["sm","378"],["st","239"],["sa","966"],["sn","221"],["rs","381"],["sc","248"],["sl","232"],["sg","65"],["sx","1",21,["721"]],["sk","421"],["si","386"],["sb","677"],["so","252"],["za","27"],["kr","82"],["ss","211"],["es","34"],["lk","94"],["bl","590",1],["sh","290"],["kn","1",18,["869"]],["lc","1",19,["758"]],["mf","590",2],["pm","508"],["vc","1",20,["784"]],["sd","249"],["sr","597"],["sj","47",1,["79"]],["se","46"],["ch","41"],["sy","963"],["tw","886"],["tj","992"],["tz","255"],["th","66"],["tl","670"],["tg","228"],["tk","690"],["to","676"],["tt","1",22,["868"]],["tn","216"],["tr","90"],["tm","993"],["tc","1",23,["649"]],["tv","688"],["ug","256"],["ua","380"],["ae","971"],["gb","44",0,null,"0"],["us","1",0],["uy","598"],["vi","1",24,["340"]],["uz","998"],["vu","678"],["va","39",1,["06698"]],["ve","58"],["vn","84"],["wf","681"],["eh","212",1,["5288","5289"],"0"],["ye","967"],["zm","260"],["zw","263"]],r=[];for(let d=0;d<i.length;d++){const t=i[d];r[d]={name:"",iso2:t[0],dialCode:t[1],priority:t[2]||0,areaCodes:t[3]||null,nodeById:{},nationalPrefix:t[4]||null}}var o=r,s={ad:"Andorra",ae:"United Arab Emirates",af:"Afghanistan",ag:"Antigua & Barbuda",ai:"Anguilla",al:"Albania",am:"Armenia",ao:"Angola",ar:"Argentina",as:"American Samoa",at:"Austria",au:"Australia",aw:"Aruba",ax:"Åland Islands",az:"Azerbaijan",ba:"Bosnia & Herzegovina",bb:"Barbados",bd:"Bangladesh",be:"Belgium",bf:"Burkina Faso",bg:"Bulgaria",bh:"Bahrain",bi:"Burundi",bj:"Benin",bl:"St. Barthélemy",bm:"Bermuda",bn:"Brunei",bo:"Bolivia",bq:"Caribbean Netherlands",br:"Brazil",bs:"Bahamas",bt:"Bhutan",bw:"Botswana",by:"Belarus",bz:"Belize",ca:"Canada",cc:"Cocos (Keeling) Islands",cd:"Congo - Kinshasa",cf:"Central African Republic",cg:"Congo - Brazzaville",ch:"Switzerland",ci:"Côte d’Ivoire",ck:"Cook Islands",cl:"Chile",cm:"Cameroon",cn:"China",co:"Colombia",cr:"Costa Rica",cu:"Cuba",cv:"Cape Verde",cw:"Curaçao",cx:"Christmas Island",cy:"Cyprus",cz:"Czechia",de:"Germany",dj:"Djibouti",dk:"Denmark",dm:"Dominica",do:"Dominican Republic",dz:"Algeria",ec:"Ecuador",ee:"Estonia",eg:"Egypt",eh:"Western Sahara",er:"Eritrea",es:"Spain",et:"Ethiopia",fi:"Finland",fj:"Fiji",fk:"Falkland Islands",fm:"Micronesia",fo:"Faroe Islands",fr:"France",ga:"Gabon",gb:"United Kingdom",gd:"Grenada",ge:"Georgia",gf:"French Guiana",gg:"Guernsey",gh:"Ghana",gi:"Gibraltar",gl:"Greenland",gm:"Gambia",gn:"Guinea",gp:"Guadeloupe",gq:"Equatorial Guinea",gr:"Greece",gt:"Guatemala",gu:"Guam",gw:"Guinea-Bissau",gy:"Guyana",hk:"Hong Kong SAR China",hn:"Honduras",hr:"Croatia",ht:"Haiti",hu:"Hungary",id:"Indonesia",ie:"Ireland",il:"Israel",im:"Isle of Man",in:"India",io:"British Indian Ocean Territory",iq:"Iraq",ir:"Iran",is:"Iceland",it:"Italy",je:"Jersey",jm:"Jamaica",jo:"Jordan",jp:"Japan",ke:"Kenya",kg:"Kyrgyzstan",kh:"Cambodia",ki:"Kiribati",km:"Comoros",kn:"St. Kitts & Nevis",kp:"North Korea",kr:"South Korea",kw:"Kuwait",ky:"Cayman Islands",kz:"Kazakhstan",la:"Laos",lb:"Lebanon",lc:"St. Lucia",li:"Liechtenstein",lk:"Sri Lanka",lr:"Liberia",ls:"Lesotho",lt:"Lithuania",lu:"Luxembourg",lv:"Latvia",ly:"Libya",ma:"Morocco",mc:"Monaco",md:"Moldova",me:"Montenegro",mf:"St. Martin",mg:"Madagascar",mh:"Marshall Islands",mk:"North Macedonia",ml:"Mali",mm:"Myanmar (Burma)",mn:"Mongolia",mo:"Macao SAR China",mp:"Northern Mariana Islands",mq:"Martinique",mr:"Mauritania",ms:"Montserrat",mt:"Malta",mu:"Mauritius",mv:"Maldives",mw:"Malawi",mx:"Mexico",my:"Malaysia",mz:"Mozambique",na:"Namibia",nc:"New Caledonia",ne:"Niger",nf:"Norfolk Island",ng:"Nigeria",ni:"Nicaragua",nl:"Netherlands",no:"Norway",np:"Nepal",nr:"Nauru",nu:"Niue",nz:"New Zealand",om:"Oman",pa:"Panama",pe:"Peru",pf:"French Polynesia",pg:"Papua New Guinea",ph:"Philippines",pk:"Pakistan",pl:"Poland",pm:"St. Pierre & Miquelon",pr:"Puerto Rico",ps:"Palestinian Territories",pt:"Portugal",pw:"Palau",py:"Paraguay",qa:"Qatar",re:"Réunion",ro:"Romania",rs:"Serbia",ru:"Russia",rw:"Rwanda",sa:"Saudi Arabia",sb:"Solomon Islands",sc:"Seychelles",sd:"Sudan",se:"Sweden",sg:"Singapore",sh:"St. Helena",si:"Slovenia",sj:"Svalbard & Jan Mayen",sk:"Slovakia",sl:"Sierra Leone",sm:"San Marino",sn:"Senegal",so:"Somalia",sr:"Suriname",ss:"South Sudan",st:"São Tomé & Príncipe",sv:"El Salvador",sx:"Sint Maarten",sy:"Syria",sz:"Eswatini",tc:"Turks & Caicos Islands",td:"Chad",tg:"Togo",th:"Thailand",tj:"Tajikistan",tk:"Tokelau",tl:"Timor-Leste",tm:"Turkmenistan",tn:"Tunisia",to:"Tonga",tr:"Turkey",tt:"Trinidad & Tobago",tv:"Tuvalu",tw:"Taiwan",tz:"Tanzania",ua:"Ukraine",ug:"Uganda",us:"United States",uy:"Uruguay",uz:"Uzbekistan",va:"Vatican City",vc:"St. Vincent & Grenadines",ve:"Venezuela",vg:"British Virgin Islands",vi:"U.S. Virgin Islands",vn:"Vietnam",vu:"Vanuatu",wf:"Wallis & Futuna",ws:"Samoa",ye:"Yemen",yt:"Mayotte",za:"South Africa",zm:"Zambia",zw:"Zimbabwe",selectedCountryAriaLabel:"Selected country",noCountrySelected:"No country selected",countryListAriaLabel:"List of countries",searchPlaceholder:"Search",zeroSearchResults:"No results found",oneSearchResult:"1 result found",multipleSearchResults:"${count} results found",ac:"Ascension Island",xk:"Kosovo"};for(let d=0;d<o.length;d++)o[d].name=s[o[d].iso2];var a=0,l={allowDropdown:!0,autoPlaceholder:"polite",containerClass:"",countryOrder:null,countrySearch:!0,customPlaceholder:null,dropdownContainer:null,excludeCountries:[],fixDropdownWidth:!0,formatAsYouType:!0,formatOnDisplay:!0,geoIpLookup:null,hiddenInput:null,i18n:{},initialCountry:"",loadUtils:null,nationalMode:!0,onlyCountries:[],placeholderNumberType:"MOBILE",showFlags:!0,separateDialCode:!1,strictMode:!1,useFullscreenPopup:"undefined"!=typeof navigator&&"undefined"!=typeof window&&(/Android.+Mobile|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=500),validationNumberTypes:["MOBILE"]},u=["800","822","833","844","855","866","877","880","881","882","883","884","885","886","887","888","889"],h=d=>d.replace(/\D/g,""),c=(d="")=>d.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),p=d=>{const t=h(d);if("1"===t.charAt(0)){const d=t.substr(1,3);return u.includes(d)}return!1},g=(d,t,e)=>{const $=document.createElement(d);return t&&Object.entries(t).forEach((([d,t])=>$.setAttribute(d,t))),e&&e.appendChild($),$},C=(d,...t)=>{const{instances:e}=y;Object.values(e).forEach((e=>e[d](...t)))},m=class{constructor(d,t={}){this.id=a++,this.telInput=d,this.highlightedItem=null,this.options=Object.assign({},l,t),this.hadInitialPlaceholder=Boolean(d.getAttribute("placeholder"))}_init(){this.options.useFullscreenPopup&&(this.options.fixDropdownWidth=!1),1===this.options.onlyCountries.length&&(this.options.initialCountry=this.options.onlyCountries[0]),this.options.separateDialCode&&(this.options.nationalMode=!1),!this.options.allowDropdown||this.options.showFlags||this.options.separateDialCode||(this.options.nationalMode=!1),this.options.useFullscreenPopup&&!this.options.dropdownContainer&&(this.options.dropdownContainer=document.body),this.isAndroid="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),this.isRTL=!!this.telInput.closest("[dir=rtl]");const d=this.options.allowDropdown||this.options.separateDialCode;this.showSelectedCountryOnLeft=this.isRTL?!d:d,this.options.separateDialCode&&(this.isRTL?this.originalPaddingRight=this.telInput.style.paddingRight:this.originalPaddingLeft=this.telInput.style.paddingLeft),this.options.i18n={...s,...this.options.i18n};const t=new Promise(((d,t)=>{this.resolveAutoCountryPromise=d,this.rejectAutoCountryPromise=t})),e=new Promise(((d,t)=>{this.resolveUtilsScriptPromise=d,this.rejectUtilsScriptPromise=t}));this.promise=Promise.all([t,e]),this.selectedCountryData={},this._processCountryData(),this._generateMarkup(),this._setInitialState(),this._initListeners(),this._initRequests()}_processCountryData(){this._processAllCountries(),this._processDialCodes(),this._translateCountryNames(),this._sortCountries()}_sortCountries(){this.options.countryOrder&&(this.options.countryOrder=this.options.countryOrder.map((d=>d.toLowerCase()))),this.countries.sort(((d,t)=>{const{countryOrder:e}=this.options;if(e){const $=e.indexOf(d.iso2),n=e.indexOf(t.iso2),i=$>-1,r=n>-1;if(i||r)return i&&r?$-n:i?-1:1}return d.name.localeCompare(t.name)}))}_addToDialCodeMap(d,t,e){t.length>this.dialCodeMaxLen&&(this.dialCodeMaxLen=t.length),this.dialCodeToIso2Map.hasOwnProperty(t)||(this.dialCodeToIso2Map[t]=[]);for(let e=0;e<this.dialCodeToIso2Map[t].length;e++)if(this.dialCodeToIso2Map[t][e]===d)return;const $=void 0!==e?e:this.dialCodeToIso2Map[t].length;this.dialCodeToIso2Map[t][$]=d}_processAllCountries(){const{onlyCountries:d,excludeCountries:t}=this.options;if(d.length){const t=d.map((d=>d.toLowerCase()));this.countries=o.filter((d=>t.includes(d.iso2)))}else if(t.length){const d=t.map((d=>d.toLowerCase()));this.countries=o.filter((t=>!d.includes(t.iso2)))}else this.countries=o}_translateCountryNames(){for(let d=0;d<this.countries.length;d++){const t=this.countries[d].iso2.toLowerCase();this.options.i18n.hasOwnProperty(t)&&(this.countries[d].name=this.options.i18n[t])}}_processDialCodes(){this.dialCodes={},this.dialCodeMaxLen=0,this.dialCodeToIso2Map={};for(let d=0;d<this.countries.length;d++){const t=this.countries[d];this.dialCodes[t.dialCode]||(this.dialCodes[t.dialCode]=!0),this._addToDialCodeMap(t.iso2,t.dialCode,t.priority)}for(let d=0;d<this.countries.length;d++){const t=this.countries[d];if(t.areaCodes){const d=this.dialCodeToIso2Map[t.dialCode][0];for(let e=0;e<t.areaCodes.length;e++){const $=t.areaCodes[e];for(let e=1;e<$.length;e++){const n=$.substr(0,e),i=t.dialCode+n;this._addToDialCodeMap(d,i),this._addToDialCodeMap(t.iso2,i)}this._addToDialCodeMap(t.iso2,t.dialCode+$)}}}}_generateMarkup(){this.telInput.classList.add("iti__tel-input"),this.telInput.hasAttribute("autocomplete")||this.telInput.form&&this.telInput.form.hasAttribute("autocomplete")||this.telInput.setAttribute("autocomplete","off");const{allowDropdown:d,separateDialCode:t,showFlags:e,containerClass:$,hiddenInput:n,dropdownContainer:i,fixDropdownWidth:r,useFullscreenPopup:o,countrySearch:s,i18n:a}=this.options;let l="iti";d&&(l+=" iti--allow-dropdown"),e&&(l+=" iti--show-flags"),$&&(l+=` ${$}`),o||(l+=" iti--inline-dropdown");const u=g("div",{class:l});if(this.telInput.parentNode?.insertBefore(u,this.telInput),d||e||t){this.countryContainer=g("div",{class:"iti__country-container"},u),this.showSelectedCountryOnLeft?this.countryContainer.style.left="0px":this.countryContainer.style.right="0px",d?(this.selectedCountry=g("button",{type:"button",class:"iti__selected-country","aria-expanded":"false","aria-label":this.options.i18n.selectedCountryAriaLabel,"aria-haspopup":"true","aria-controls":`iti-${this.id}__dropdown-content`,role:"combobox"},this.countryContainer),this.telInput.disabled&&this.selectedCountry.setAttribute("disabled","true")):this.selectedCountry=g("div",{class:"iti__selected-country"},this.countryContainer);const e=g("div",{class:"iti__selected-country-primary"},this.selectedCountry);if(this.selectedCountryInner=g("div",{class:"iti__flag"},e),this.selectedCountryA11yText=g("span",{class:"iti__a11y-text"},this.selectedCountryInner),d&&(this.dropdownArrow=g("div",{class:"iti__arrow","aria-hidden":"true"},e)),t&&(this.selectedDialCode=g("div",{class:"iti__selected-dial-code"},this.selectedCountry)),d){const d=r?"":"iti--flexible-dropdown-width";if(this.dropdownContent=g("div",{id:`iti-${this.id}__dropdown-content`,class:`iti__dropdown-content iti__hide ${d}`}),s&&(this.searchInput=g("input",{type:"text",class:"iti__search-input",placeholder:a.searchPlaceholder,role:"combobox","aria-expanded":"true","aria-label":a.searchPlaceholder,"aria-controls":`iti-${this.id}__country-listbox`,"aria-autocomplete":"list",autocomplete:"off"},this.dropdownContent),this.searchResultsA11yText=g("span",{class:"iti__a11y-text"},this.dropdownContent)),this.countryList=g("ul",{class:"iti__country-list",id:`iti-${this.id}__country-listbox`,role:"listbox","aria-label":a.countryListAriaLabel},this.dropdownContent),this._appendListItems(),s&&this._updateSearchResultsText(),i){let d="iti iti--container";d+=o?" iti--fullscreen-popup":" iti--inline-dropdown",this.dropdown=g("div",{class:d}),this.dropdown.appendChild(this.dropdownContent)}else this.countryContainer.appendChild(this.dropdownContent)}}if(u.appendChild(this.telInput),this._updateInputPadding(),n){const d=n(this.telInput.getAttribute("name")||"");if(d.phone){const t=this.telInput.form?.querySelector(`input[name="${d.phone}"]`);t?this.hiddenInput=t:(this.hiddenInput=g("input",{type:"hidden",name:d.phone}),u.appendChild(this.hiddenInput))}if(d.country){const t=this.telInput.form?.querySelector(`input[name="${d.country}"]`);t?this.hiddenInputCountry=t:(this.hiddenInputCountry=g("input",{type:"hidden",name:d.country}),u.appendChild(this.hiddenInputCountry))}}}_appendListItems(){for(let d=0;d<this.countries.length;d++){const t=this.countries[d],e=0===d?"iti__highlight":"",$=g("li",{id:`iti-${this.id}__item-${t.iso2}`,class:`iti__country ${e}`,tabindex:"-1",role:"option","data-dial-code":t.dialCode,"data-country-code":t.iso2,"aria-selected":"false"},this.countryList);t.nodeById[this.id]=$;let n="";this.options.showFlags&&(n+=`<div class='iti__flag iti__${t.iso2}'></div>`),n+=`<span class='iti__country-name'>${t.name}</span>`,n+=`<span class='iti__dial-code'>+${t.dialCode}</span>`,$.insertAdjacentHTML("beforeend",n)}}_setInitialState(d=!1){const t=this.telInput.getAttribute("value"),e=this.telInput.value,$=!t||"+"!==t.charAt(0)||e&&"+"===e.charAt(0)?e:t,n=this._getDialCode($),i=p($),{initialCountry:r,geoIpLookup:o}=this.options,s="auto"===r&&o;if(n&&!i)this._updateCountryFromNumber($);else if(!s||d){const d=r?r.toLowerCase():"";d&&this._getCountryData(d,!0)?this._setCountry(d):n&&i?this._setCountry("us"):this._setCountry()}$&&this._updateValFromNumber($)}_initListeners(){this._initTelInputListeners(),this.options.allowDropdown&&this._initDropdownListeners(),(this.hiddenInput||this.hiddenInputCountry)&&this.telInput.form&&this._initHiddenInputListener()}_initHiddenInputListener(){this._handleHiddenInputSubmit=()=>{this.hiddenInput&&(this.hiddenInput.value=this.getNumber()),this.hiddenInputCountry&&(this.hiddenInputCountry.value=this.getSelectedCountryData().iso2||"")},this.telInput.form?.addEventListener("submit",this._handleHiddenInputSubmit)}_initDropdownListeners(){this._handleLabelClick=d=>{this.dropdownContent.classList.contains("iti__hide")?this.telInput.focus():d.preventDefault()};const d=this.telInput.closest("label");d&&d.addEventListener("click",this._handleLabelClick),this._handleClickSelectedCountry=()=>{!this.dropdownContent.classList.contains("iti__hide")||this.telInput.disabled||this.telInput.readOnly||this._openDropdown()},this.selectedCountry.addEventListener("click",this._handleClickSelectedCountry),this._handleCountryContainerKeydown=d=>{this.dropdownContent.classList.contains("iti__hide")&&["ArrowUp","ArrowDown"," ","Enter"].includes(d.key)&&(d.preventDefault(),d.stopPropagation(),this._openDropdown()),"Tab"===d.key&&this._closeDropdown()},this.countryContainer.addEventListener("keydown",this._handleCountryContainerKeydown)}_initRequests(){let{loadUtils:d,initialCountry:t,geoIpLookup:e}=this.options;d&&!y.utils?(this._handlePageLoad=()=>{window.removeEventListener("load",this._handlePageLoad),y.attachUtils(d)?.catch((()=>{}))},y.documentReady()?this._handlePageLoad():window.addEventListener("load",this._handlePageLoad)):this.resolveUtilsScriptPromise(),"auto"===t&&e&&!this.selectedCountryData.iso2?this._loadAutoCountry():this.resolveAutoCountryPromise()}_loadAutoCountry(){y.autoCountry?this.handleAutoCountry():y.startedLoadingAutoCountry||(y.startedLoadingAutoCountry=!0,"function"==typeof this.options.geoIpLookup&&this.options.geoIpLookup(((d="")=>{const t=d.toLowerCase();t&&this._getCountryData(t,!0)?(y.autoCountry=t,setTimeout((()=>C("handleAutoCountry")))):(this._setInitialState(!0),C("rejectAutoCountryPromise"))}),(()=>{this._setInitialState(!0),C("rejectAutoCountryPromise")})))}_openDropdownWithPlus(){this._openDropdown(),this.searchInput.value="+",this._filterCountries("",!0)}_initTelInputListeners(){const{strictMode:d,formatAsYouType:t,separateDialCode:e,formatOnDisplay:$,allowDropdown:n,countrySearch:i}=this.options;let r=!1;/\p{L}/u.test(this.telInput.value)&&(r=!0),this._handleInputEvent=o=>{if(this.isAndroid&&"+"===o?.data&&e&&n&&i){const d=this.telInput.selectionStart||0,t=this.telInput.value.substring(0,d-1),e=this.telInput.value.substring(d);return this.telInput.value=t+e,void this._openDropdownWithPlus()}this._updateCountryFromNumber(this.telInput.value)&&this._triggerCountryChange();const s=o?.data&&/[^+0-9]/.test(o.data),a="insertFromPaste"===o?.inputType&&this.telInput.value;s||a&&!d?r=!0:/[^+0-9]/.test(this.telInput.value)||(r=!1);const l=o?.detail&&o.detail.isSetNumber&&!$;if(t&&!r&&!l){const d=this.telInput.selectionStart||0,t=this.telInput.value.substring(0,d).replace(/[^+0-9]/g,"").length,e="deleteContentForward"===o?.inputType,$=this._formatNumberAsYouType(),n=((d,t,e,$)=>{if(0===e&&!$)return 0;let n=0;for(let e=0;e<t.length;e++){if(/[+0-9]/.test(t[e])&&n++,n===d&&!$)return e+1;if($&&n===d+1)return e}return t.length})(t,$,d,e);this.telInput.value=$,this.telInput.setSelectionRange(n,n)}},this.telInput.addEventListener("input",this._handleInputEvent),(d||e)&&(this._handleKeydownEvent=t=>{if(t.key&&1===t.key.length&&!t.altKey&&!t.ctrlKey&&!t.metaKey){if(e&&n&&i&&"+"===t.key)return t.preventDefault(),void this._openDropdownWithPlus();if(d){const d=this.telInput.value,$="+"===d.charAt(0),n=!$&&0===this.telInput.selectionStart&&"+"===t.key,i=/^[0-9]$/.test(t.key),r=e?i:n||i,o=d.slice(0,this.telInput.selectionStart)+t.key+d.slice(this.telInput.selectionEnd),s=this._getFullNumber(o),a=y.utils.getCoreNumber(s,this.selectedCountryData.iso2),l=this.maxCoreNumberLength&&a.length>this.maxCoreNumberLength;let u=!1;if($){const d=this.selectedCountryData.iso2;u=this._getCountryFromNumber(s)!==d}r&&(!l||u||n)||t.preventDefault()}}},this.telInput.addEventListener("keydown",this._handleKeydownEvent))}_cap(d){const t=parseInt(this.telInput.getAttribute("maxlength")||"",10);return t&&d.length>t?d.substr(0,t):d}_trigger(d,t={}){const e=new CustomEvent(d,{bubbles:!0,cancelable:!0,detail:t});this.telInput.dispatchEvent(e)}_openDropdown(){const{fixDropdownWidth:d,countrySearch:t}=this.options;if(d&&(this.dropdownContent.style.width=`${this.telInput.offsetWidth}px`),this.dropdownContent.classList.remove("iti__hide"),this.selectedCountry.setAttribute("aria-expanded","true"),this._setDropdownPosition(),t){const d=this.countryList.firstElementChild;d&&(this._highlightListItem(d,!1),this.countryList.scrollTop=0),this.searchInput.focus()}this._bindDropdownListeners(),this.dropdownArrow.classList.add("iti__arrow--up"),this._trigger("open:countrydropdown")}_setDropdownPosition(){if(this.options.dropdownContainer&&this.options.dropdownContainer.appendChild(this.dropdown),!this.options.useFullscreenPopup){const d=this.telInput.getBoundingClientRect(),t=this.telInput.offsetHeight;this.options.dropdownContainer&&(this.dropdown.style.top=`${d.top+t}px`,this.dropdown.style.left=`${d.left}px`,this._handleWindowScroll=()=>this._closeDropdown(),window.addEventListener("scroll",this._handleWindowScroll))}}_bindDropdownListeners(){this._handleMouseoverCountryList=d=>{const t=d.target?.closest(".iti__country");t&&this._highlightListItem(t,!1)},this.countryList.addEventListener("mouseover",this._handleMouseoverCountryList),this._handleClickCountryList=d=>{const t=d.target?.closest(".iti__country");t&&this._selectListItem(t)},this.countryList.addEventListener("click",this._handleClickCountryList);let d=!0;this._handleClickOffToClose=()=>{d||this._closeDropdown(),d=!1},document.documentElement.addEventListener("click",this._handleClickOffToClose);let t="",e=null;if(this._handleKeydownOnDropdown=d=>{["ArrowUp","ArrowDown","Enter","Escape"].includes(d.key)&&(d.preventDefault(),d.stopPropagation(),"ArrowUp"===d.key||"ArrowDown"===d.key?this._handleUpDownKey(d.key):"Enter"===d.key?this._handleEnterKey():"Escape"===d.key&&this._closeDropdown()),!this.options.countrySearch&&/^[a-zA-ZÀ-ÿа-яА-Я ]$/.test(d.key)&&(d.stopPropagation(),e&&clearTimeout(e),t+=d.key.toLowerCase(),this._searchForCountry(t),e=setTimeout((()=>{t=""}),1e3))},document.addEventListener("keydown",this._handleKeydownOnDropdown),this.options.countrySearch){const d=()=>{const d=this.searchInput.value.trim();d?this._filterCountries(d):this._filterCountries("",!0)};let t=null;this._handleSearchChange=()=>{t&&clearTimeout(t),t=setTimeout((()=>{d(),t=null}),100)},this.searchInput.addEventListener("input",this._handleSearchChange),this.searchInput.addEventListener("click",(d=>d.stopPropagation()))}}_searchForCountry(d){for(let t=0;t<this.countries.length;t++){const e=this.countries[t];if(e.name.substr(0,d.length).toLowerCase()===d){const d=e.nodeById[this.id];this._highlightListItem(d,!1),this._scrollTo(d);break}}}_filterCountries(d,t=!1){let e=!0;this.countryList.innerHTML="";const $=c(d);for(let d=0;d<this.countries.length;d++){const n=this.countries[d],i=c(n.name),r=n.name.split(/[^a-zA-ZÀ-ÿа-яА-Я]/).map((d=>d[0])).join("").toLowerCase(),o=`+${n.dialCode}`;if(t||i.includes($)||o.includes($)||n.iso2.includes($)||r.includes($)){const d=n.nodeById[this.id];d&&this.countryList.appendChild(d),e&&(this._highlightListItem(d,!1),e=!1)}}e&&this._highlightListItem(null,!1),this.countryList.scrollTop=0,this._updateSearchResultsText()}_updateSearchResultsText(){const{i18n:d}=this.options,t=this.countryList.childElementCount;let e;e=0===t?d.zeroSearchResults:1===t?d.oneSearchResult:d.multipleSearchResults.replace("${count}",t.toString()),this.searchResultsA11yText.textContent=e}_handleUpDownKey(d){let t="ArrowUp"===d?this.highlightedItem?.previousElementSibling:this.highlightedItem?.nextElementSibling;!t&&this.countryList.childElementCount>1&&(t="ArrowUp"===d?this.countryList.lastElementChild:this.countryList.firstElementChild),t&&(this._scrollTo(t),this._highlightListItem(t,!1))}_handleEnterKey(){this.highlightedItem&&this._selectListItem(this.highlightedItem)}_updateValFromNumber(d){let t=d;if(this.options.formatOnDisplay&&y.utils&&this.selectedCountryData){const d=this.options.nationalMode||"+"!==t.charAt(0)&&!this.options.separateDialCode,{NATIONAL:e,INTERNATIONAL:$}=y.utils.numberFormat,n=d?e:$;t=y.utils.formatNumber(t,this.selectedCountryData.iso2,n)}t=this._beforeSetNumber(t),this.telInput.value=t}_updateCountryFromNumber(d){const t=this._getCountryFromNumber(d);return null!==t&&this._setCountry(t)}_ensureHasDialCode(d){const{dialCode:t,nationalPrefix:e}=this.selectedCountryData;return"+"!==d.charAt(0)&&t?`+${t}${e&&d.charAt(0)===e&&!this.options.separateDialCode?d.substring(1):d}`:d}_getCountryFromNumber(d){const t=d.indexOf("+");let e=t?d.substring(t):d;const $=this.selectedCountryData.iso2,n=this.selectedCountryData.dialCode;e=this._ensureHasDialCode(e);const i=this._getDialCode(e,!0),r=h(e);if(i){const d=h(i),t=this.dialCodeToIso2Map[d];if(!$&&this.defaultCountry&&t.includes(this.defaultCountry))return this.defaultCountry;const e=$&&t.includes($)&&(r.length===d.length||!this.selectedCountryData.areaCodes);if(!("1"===n&&p(r)||e))for(let d=0;d<t.length;d++)if(t[d])return t[d]}else{if("+"===e.charAt(0)&&r.length)return"";if(!(e&&"+"!==e||this.selectedCountryData.iso2))return this.defaultCountry}return null}_highlightListItem(d,t){const e=this.highlightedItem;if(e&&(e.classList.remove("iti__highlight"),e.setAttribute("aria-selected","false")),this.highlightedItem=d,this.highlightedItem){this.highlightedItem.classList.add("iti__highlight"),this.highlightedItem.setAttribute("aria-selected","true");const d=this.highlightedItem.getAttribute("id")||"";this.selectedCountry.setAttribute("aria-activedescendant",d),this.options.countrySearch&&this.searchInput.setAttribute("aria-activedescendant",d)}t&&this.highlightedItem.focus()}_getCountryData(d,t){for(let t=0;t<this.countries.length;t++)if(this.countries[t].iso2===d)return this.countries[t];if(t)return null;throw new Error(`No country data for '${d}'`)}_setCountry(d){const{separateDialCode:t,showFlags:e,i18n:$}=this.options,n=this.selectedCountryData.iso2?this.selectedCountryData:{};if(this.selectedCountryData=d&&this._getCountryData(d,!1)||{},this.selectedCountryData.iso2&&(this.defaultCountry=this.selectedCountryData.iso2),this.selectedCountryInner){let t="",n="";d&&e?(t=`iti__flag iti__${d}`,n=`${this.selectedCountryData.name} +${this.selectedCountryData.dialCode}`):(t="iti__flag iti__globe",n=$.noCountrySelected),this.selectedCountryInner.className=t,this.selectedCountryA11yText.textContent=n}if(this._setSelectedCountryTitleAttribute(d,t),t){const d=this.selectedCountryData.dialCode?`+${this.selectedCountryData.dialCode}`:"";this.selectedDialCode.innerHTML=d,this._updateInputPadding()}return this._updatePlaceholder(),this._updateMaxLength(),n.iso2!==d}_updateInputPadding(){if(this.selectedCountry){const d=(this.selectedCountry.offsetWidth||this._getHiddenSelectedCountryWidth())+6;this.showSelectedCountryOnLeft?this.telInput.style.paddingLeft=`${d}px`:this.telInput.style.paddingRight=`${d}px`}}_updateMaxLength(){const{strictMode:d,placeholderNumberType:t,validationNumberTypes:e}=this.options,{iso2:$}=this.selectedCountryData;if(d&&y.utils)if($){const d=y.utils.numberType[t];let n=y.utils.getExampleNumber($,!1,d,!0),i=n;for(;y.utils.isPossibleNumber(n,$,e);)i=n,n+="0";const r=y.utils.getCoreNumber(i,$);this.maxCoreNumberLength=r.length,"by"===$&&(this.maxCoreNumberLength=r.length+1)}else this.maxCoreNumberLength=null}_setSelectedCountryTitleAttribute(d=null,t){if(!this.selectedCountry)return;let e;e=d&&!t?`${this.selectedCountryData.name}: +${this.selectedCountryData.dialCode}`:d?this.selectedCountryData.name:"Unknown",this.selectedCountry.setAttribute("title",e)}_getHiddenSelectedCountryWidth(){if(this.telInput.parentNode){const d=this.telInput.parentNode.cloneNode(!1);d.style.visibility="hidden",document.body.appendChild(d);const t=this.countryContainer.cloneNode();d.appendChild(t);const e=this.selectedCountry.cloneNode(!0);t.appendChild(e);const $=e.offsetWidth;return document.body.removeChild(d),$}return 0}_updatePlaceholder(){const{autoPlaceholder:d,placeholderNumberType:t,nationalMode:e,customPlaceholder:$}=this.options,n="aggressive"===d||!this.hadInitialPlaceholder&&"polite"===d;if(y.utils&&n){const d=y.utils.numberType[t];let n=this.selectedCountryData.iso2?y.utils.getExampleNumber(this.selectedCountryData.iso2,e,d):"";n=this._beforeSetNumber(n),"function"==typeof $&&(n=$(n,this.selectedCountryData)),this.telInput.setAttribute("placeholder",n)}}_selectListItem(d){const t=this._setCountry(d.getAttribute("data-country-code"));this._closeDropdown(),this._updateDialCode(d.getAttribute("data-dial-code")),this.telInput.focus(),t&&this._triggerCountryChange()}_closeDropdown(){this.dropdownContent.classList.add("iti__hide"),this.selectedCountry.setAttribute("aria-expanded","false"),this.selectedCountry.removeAttribute("aria-activedescendant"),this.highlightedItem&&this.highlightedItem.setAttribute("aria-selected","false"),this.options.countrySearch&&this.searchInput.removeAttribute("aria-activedescendant"),this.dropdownArrow.classList.remove("iti__arrow--up"),document.removeEventListener("keydown",this._handleKeydownOnDropdown),this.options.countrySearch&&this.searchInput.removeEventListener("input",this._handleSearchChange),document.documentElement.removeEventListener("click",this._handleClickOffToClose),this.countryList.removeEventListener("mouseover",this._handleMouseoverCountryList),this.countryList.removeEventListener("click",this._handleClickCountryList),this.options.dropdownContainer&&(this.options.useFullscreenPopup||window.removeEventListener("scroll",this._handleWindowScroll),this.dropdown.parentNode&&this.dropdown.parentNode.removeChild(this.dropdown)),this._handlePageLoad&&window.removeEventListener("load",this._handlePageLoad),this._trigger("close:countrydropdown")}_scrollTo(d){const t=this.countryList,e=document.documentElement.scrollTop,$=t.offsetHeight,n=t.getBoundingClientRect().top+e,i=n+$,r=d.offsetHeight,o=d.getBoundingClientRect().top+e,s=o+r,a=o-n+t.scrollTop;if(o<n)t.scrollTop=a;else if(s>i){const d=$-r;t.scrollTop=a-d}}_updateDialCode(d){const t=this.telInput.value,e=`+${d}`;let $;if("+"===t.charAt(0)){const d=this._getDialCode(t);$=d?t.replace(d,e):e,this.telInput.value=$}}_getDialCode(d,t){let e="";if("+"===d.charAt(0)){let $="";for(let n=0;n<d.length;n++){const i=d.charAt(n);if(!isNaN(parseInt(i,10))){if($+=i,t)this.dialCodeToIso2Map[$]&&(e=d.substr(0,n+1));else if(this.dialCodes[$]){e=d.substr(0,n+1);break}if($.length===this.dialCodeMaxLen)break}}}return e}_getFullNumber(d){const t=d||this.telInput.value.trim(),{dialCode:e}=this.selectedCountryData;let $;const n=h(t);return $=this.options.separateDialCode&&"+"!==t.charAt(0)&&e&&n?`+${e}`:"",$+t}_beforeSetNumber(d){let t=d;if(this.options.separateDialCode){let d=this._getDialCode(t);if(d){d=`+${this.selectedCountryData.dialCode}`;const e=" "===t[d.length]||"-"===t[d.length]?d.length+1:d.length;t=t.substr(e)}}return this._cap(t)}_triggerCountryChange(){this._trigger("countrychange")}_formatNumberAsYouType(){const d=this._getFullNumber(),t=y.utils?y.utils.formatNumberAsYouType(d,this.selectedCountryData.iso2):d,{dialCode:e}=this.selectedCountryData;return this.options.separateDialCode&&"+"!==this.telInput.value.charAt(0)&&t.includes(`+${e}`)?(t.split(`+${e}`)[1]||"").trim():t}handleAutoCountry(){"auto"===this.options.initialCountry&&y.autoCountry&&(this.defaultCountry=y.autoCountry,this.selectedCountryData.iso2||this.selectedCountryInner.classList.contains("iti__globe")||this.setCountry(this.defaultCountry),this.resolveAutoCountryPromise())}handleUtils(){y.utils&&(this.telInput.value&&this._updateValFromNumber(this.telInput.value),this.selectedCountryData.iso2&&(this._updatePlaceholder(),this._updateMaxLength())),this.resolveUtilsScriptPromise()}destroy(){const{allowDropdown:d,separateDialCode:t}=this.options;if(d){this._closeDropdown(),this.selectedCountry.removeEventListener("click",this._handleClickSelectedCountry),this.countryContainer.removeEventListener("keydown",this._handleCountryContainerKeydown);const d=this.telInput.closest("label");d&&d.removeEventListener("click",this._handleLabelClick)}const{form:e}=this.telInput;this._handleHiddenInputSubmit&&e&&e.removeEventListener("submit",this._handleHiddenInputSubmit),this.telInput.removeEventListener("input",this._handleInputEvent),this._handleKeydownEvent&&this.telInput.removeEventListener("keydown",this._handleKeydownEvent),this.telInput.removeAttribute("data-intl-tel-input-id"),t&&(this.isRTL?this.telInput.style.paddingRight=this.originalPaddingRight:this.telInput.style.paddingLeft=this.originalPaddingLeft);const $=this.telInput.parentNode;$?.parentNode?.insertBefore(this.telInput,$),$?.parentNode?.removeChild($),delete y.instances[this.id]}getExtension(){return y.utils?y.utils.getExtension(this._getFullNumber(),this.selectedCountryData.iso2):""}getNumber(d){if(y.utils){const{iso2:t}=this.selectedCountryData;return y.utils.formatNumber(this._getFullNumber(),t,d)}return""}getNumberType(){return y.utils?y.utils.getNumberType(this._getFullNumber(),this.selectedCountryData.iso2):-99}getSelectedCountryData(){return this.selectedCountryData}getValidationError(){if(y.utils){const{iso2:d}=this.selectedCountryData;return y.utils.getValidationError(this._getFullNumber(),d)}return-99}isValidNumber(){if(!this.selectedCountryData.iso2)return!1;const d=this._getFullNumber(),t=d.search(/\p{L}/u);if(t>-1){const e=d.substring(0,t),$=this._utilsIsPossibleNumber(e),n=this._utilsIsPossibleNumber(d);return $&&n}return this._utilsIsPossibleNumber(d)}_utilsIsPossibleNumber(d){return y.utils?y.utils.isPossibleNumber(d,this.selectedCountryData.iso2,this.options.validationNumberTypes):null}isValidNumberPrecise(){if(!this.selectedCountryData.iso2)return!1;const d=this._getFullNumber(),t=d.search(/\p{L}/u);if(t>-1){const e=d.substring(0,t),$=this._utilsIsValidNumber(e),n=this._utilsIsValidNumber(d);return $&&n}return this._utilsIsValidNumber(d)}_utilsIsValidNumber(d){return y.utils?y.utils.isValidNumber(d,this.selectedCountryData.iso2,this.options.validationNumberTypes):null}setCountry(d){const t=d?.toLowerCase(),e=this.selectedCountryData.iso2;(d&&t!==e||!d&&e)&&(this._setCountry(t),this._updateDialCode(this.selectedCountryData.dialCode),this._triggerCountryChange())}setNumber(d){const t=this._updateCountryFromNumber(d);this._updateValFromNumber(d),t&&this._triggerCountryChange(),this._trigger("input",{isSetNumber:!0})}setPlaceholderNumberType(d){this.options.placeholderNumberType=d,this._updatePlaceholder()}setDisabled(d){this.telInput.disabled=d,d?this.selectedCountry.setAttribute("disabled","true"):this.selectedCountry.removeAttribute("disabled")}},y=Object.assign(((d,t)=>{const e=new m(d,t);return e._init(),d.setAttribute("data-intl-tel-input-id",e.id.toString()),y.instances[e.id]=e,e}),{defaults:l,documentReady:()=>"complete"===document.readyState,getCountryData:()=>o,getInstance:d=>{const t=d.getAttribute("data-intl-tel-input-id");return t?y.instances[t]:null},instances:{},attachUtils:d=>{if(!y.utils&&!y.startedLoadingUtilsScript){let t;if("function"!=typeof d)return Promise.reject(new TypeError("The argument passed to attachUtils must be a function that returns a promise for the utilities module, not "+typeof d));try{t=Promise.resolve(d())}catch(d){return Promise.reject(d)}return y.startedLoadingUtilsScript=!0,t.then((d=>{const t=d?.default;if(!t||"object"!=typeof t)throw new TypeError("The loader function passed to attachUtils did not resolve to a module object with utils as its default export.");return y.utils=t,C("handleUtils"),!0})).catch((d=>{throw C("rejectUtilsScriptPromise",d),d}))}return null},startedLoadingUtilsScript:!1,startedLoadingAutoCountry:!1,version:"25.2.1"}),f=y;!function(){var d=this||self;function t(t,e){t=t.split(".");var $,n=d;t[0]in n||void 0===n.execScript||n.execScript("var "+t[0]);for(;t.length&&($=t.shift());)t.length||void 0===e?n=n[$]&&n[$]!==Object.prototype[$]?n[$]:n[$]={}:n[$]=e}function e(d,t){function e(){}e.prototype=t.prototype,d.ma=t.prototype,d.prototype=new e,d.prototype.constructor=d,d.sa=function(d,e,$){for(var n=Array(arguments.length-2),i=2;i<arguments.length;i++)n[i-2]=arguments[i];return t.prototype[e].apply(d,n)}}var $=class{constructor(d){if(n!=n)throw Error("SafeUrl is not meant to be built directly");this.g=d}toString(){return this.g.toString()}},n={};function i(d,t){switch(this.g=d,this.l=!!t.aa,this.h=t.i,this.s=t.type,this.o=!1,this.h){case s:case a:case l:case u:case h:case o:case r:this.o=!0}this.j=t.defaultValue}new $("about:invalid#zClosurez"),new $("about:blank"),new class{constructor(){}toString(){return"".toString()}},new class{constructor(){}toString(){return"".toString()}},new class{constructor(){var t=d.trustedTypes&&d.trustedTypes.emptyHTML||"";this.g=t}toString(){return this.g.toString()}};var r=1,o=2,s=3,a=4,l=6,u=16,h=18;function c(d,t){for(this.h=d,this.g={},d=0;d<t.length;d++){var e=t[d];this.g[e.g]=e}}function p(){this.h={},this.j=this.m().g,this.g=this.l=null}function g(d,t){for(var e=function(d){return(d=function(d){const t=[];let e=0;for(const $ in d)t[e++]=d[$];return t}(d.g)).sort((function(d,t){return d.g-t.g})),d}(d.m()),$=0;$<e.length;$++){var n=e[$],i=n.g;if(C(t,i)){d.g&&delete d.g[n.g];var r=11==n.h||10==n.h;if(n.l){n=b(t,i);for(var o=0;o<n.length;o++)v(d,i,r?n[o].clone():n[o])}else n=m(t,i),r?(r=m(d,i))?g(r,n):I(d,i,n.clone()):I(d,i,n)}}}function C(d,t){return null!=d.h[t]}function m(d,t){var e=d.h[t];if(null==e)return null;if(d.l){if(!(t in d.g)){var $=d.l,n=d.j[t];if(null!=e)if(n.l){for(var i=[],r=0;r<e.length;r++)i[r]=$.h(n,e[r]);e=i}else e=$.h(n,e);return d.g[t]=e}return d.g[t]}return e}function y(d,t,e){var $=m(d,t);return d.j[t].l?$[e||0]:$}function f(d,t){if(C(d,t))d=y(d,t);else d:{if(void 0===(d=d.j[t]).j)if((t=d.s)===Boolean)d.j=!1;else if(t===Number)d.j=0;else{if(t!==String){d=new t;break d}d.j=d.o?"0":""}d=d.j}return d}function b(d,t){return m(d,t)||[]}function _(d,t){return d.j[t].l?C(d,t)?d.h[t].length:0:C(d,t)?1:0}function I(d,t,e){d.h[t]=e,d.g&&(d.g[t]=e)}function v(d,t,e){d.h[t]||(d.h[t]=[]),d.h[t].push(e),d.g&&delete d.g[t]}function w(d,t){var e,$=[];for(e in t)0!=e&&$.push(new i(e,t[e]));return new c(d,$)}function S(){}p.prototype.has=function(d){return C(this,d.g)},p.prototype.get=function(d,t){return y(this,d.g,t)},p.prototype.set=function(d,t){I(this,d.g,t)},p.prototype.add=function(d,t){v(this,d.g,t)},p.prototype.clone=function(){var d=new this.constructor;return d!=this&&(d.h={},d.g&&(d.g={}),g(d,this)),d},S.prototype.g=function(d){throw new d.h,Error("Unimplemented")},S.prototype.h=function(d,t){if(11==d.h||10==d.h)return t instanceof p?t:this.g(d.s.prototype.m(),t);if(14==d.h)return"string"==typeof t&&L.test(t)&&0<(d=Number(t))?d:t;if(!d.o)return t;if((d=d.s)===String){if("number"==typeof t)return String(t)}else if(d===Number&&"string"==typeof t&&("Infinity"===t||"-Infinity"===t||"NaN"===t||L.test(t)))return Number(t);return t};var L=/^-?[0-9]+$/;function A(){}function T(){}function N(d,t){null!=d&&this.g.apply(this,arguments)}function E(d){d.h=""}function D(){p.call(this)}e(A,S),A.prototype.g=function(d,t){return(d=new d.h).l=this,d.h=t,d.g={},d},e(T,A),T.prototype.h=function(d,t){return 8==d.h?!!t:S.prototype.h.apply(this,arguments)},T.prototype.g=function(d,t){return T.ma.g.call(this,d,t)},N.prototype.h="",N.prototype.set=function(d){this.h=""+d},N.prototype.g=function(d,t,e){if(this.h+=String(d),null!=t)for(let d=1;d<arguments.length;d++)this.h+=arguments[d];return this},N.prototype.toString=function(){return this.h},e(D,p);var M=null;function P(){p.call(this)}e(P,p);var x=null;function R(){p.call(this)}e(R,p);var B=null;function O(){p.call(this)}D.prototype.m=function(){var d=M;return d||(M=d=w(D,{0:{name:"NumberFormat",ia:"i18n.phonenumbers.NumberFormat"},1:{name:"pattern",required:!0,i:9,type:String},2:{name:"format",required:!0,i:9,type:String},3:{name:"leading_digits_pattern",aa:!0,i:9,type:String},4:{name:"national_prefix_formatting_rule",i:9,type:String},6:{name:"national_prefix_optional_when_formatting",i:8,defaultValue:!1,type:Boolean},5:{name:"domestic_carrier_code_formatting_rule",i:9,type:String}})),d},D.m=D.prototype.m,P.prototype.m=function(){var d=x;return d||(x=d=w(P,{0:{name:"PhoneNumberDesc",ia:"i18n.phonenumbers.PhoneNumberDesc"},2:{name:"national_number_pattern",i:9,type:String},9:{name:"possible_length",aa:!0,i:5,type:Number},10:{name:"possible_length_local_only",aa:!0,i:5,type:Number},6:{name:"example_number",i:9,type:String}})),d},P.m=P.prototype.m,R.prototype.m=function(){var d=B;return d||(B=d=w(R,{0:{name:"PhoneMetadata",ia:"i18n.phonenumbers.PhoneMetadata"},1:{name:"general_desc",i:11,type:P},2:{name:"fixed_line",i:11,type:P},3:{name:"mobile",i:11,type:P},4:{name:"toll_free",i:11,type:P},5:{name:"premium_rate",i:11,type:P},6:{name:"shared_cost",i:11,type:P},7:{name:"personal_number",i:11,type:P},8:{name:"voip",i:11,type:P},21:{name:"pager",i:11,type:P},25:{name:"uan",i:11,type:P},27:{name:"emergency",i:11,type:P},28:{name:"voicemail",i:11,type:P},29:{name:"short_code",i:11,type:P},30:{name:"standard_rate",i:11,type:P},31:{name:"carrier_specific",i:11,type:P},33:{name:"sms_services",i:11,type:P},24:{name:"no_international_dialling",i:11,type:P},9:{name:"id",required:!0,i:9,type:String},10:{name:"country_code",i:5,type:Number},11:{name:"international_prefix",i:9,type:String},17:{name:"preferred_international_prefix",i:9,type:String},12:{name:"national_prefix",i:9,type:String},13:{name:"preferred_extn_prefix",i:9,type:String},15:{name:"national_prefix_for_parsing",i:9,type:String},16:{name:"national_prefix_transform_rule",i:9,type:String},18:{name:"same_mobile_and_fixed_line_pattern",i:8,defaultValue:!1,type:Boolean},19:{name:"number_format",aa:!0,i:11,type:D},20:{name:"intl_number_format",aa:!0,i:11,type:D},22:{name:"main_country_for_code",i:8,defaultValue:!1,type:Boolean},23:{name:"leading_digits",i:9,type:String}})),d},R.m=R.prototype.m,e(O,p);var k=null,G={ra:0,qa:1,pa:5,oa:10,na:20};O.prototype.m=function(){var d=k;return d||(k=d=w(O,{0:{name:"PhoneNumber",ia:"i18n.phonenumbers.PhoneNumber"},1:{name:"country_code",required:!0,i:5,type:Number},2:{name:"national_number",required:!0,i:4,type:Number},3:{name:"extension",i:9,type:String},4:{name:"italian_leading_zero",i:8,type:Boolean},8:{name:"number_of_leading_zeros",i:5,defaultValue:1,type:Number},5:{name:"raw_input",i:9,type:String},6:{name:"country_code_source",i:14,defaultValue:0,type:G},7:{name:"preferred_domestic_carrier_code",i:9,type:String}})),d},O.ctor=O,O.ctor.m=O.prototype.m;var F={1:"US AG AI AS BB BM BS CA DM DO GD GU JM KN KY LC MP MS PR SX TC TT VC VG VI".split(" "),7:["RU","KZ"],20:["EG"],27:["ZA"],30:["GR"],31:["NL"],32:["BE"],33:["FR"],34:["ES"],36:["HU"],39:["IT","VA"],40:["RO"],41:["CH"],43:["AT"],44:["GB","GG","IM","JE"],45:["DK"],46:["SE"],47:["NO","SJ"],48:["PL"],49:["DE"],51:["PE"],52:["MX"],53:["CU"],54:["AR"],55:["BR"],56:["CL"],57:["CO"],58:["VE"],60:["MY"],61:["AU","CC","CX"],62:["ID"],63:["PH"],64:["NZ"],65:["SG"],66:["TH"],81:["JP"],82:["KR"],84:["VN"],86:["CN"],90:["TR"],91:["IN"],92:["PK"],93:["AF"],94:["LK"],95:["MM"],98:["IR"],211:["SS"],212:["MA","EH"],213:["DZ"],216:["TN"],218:["LY"],220:["GM"],221:["SN"],222:["MR"],223:["ML"],224:["GN"],225:["CI"],226:["BF"],227:["NE"],228:["TG"],229:["BJ"],230:["MU"],231:["LR"],232:["SL"],233:["GH"],234:["NG"],235:["TD"],236:["CF"],237:["CM"],238:["CV"],239:["ST"],240:["GQ"],241:["GA"],242:["CG"],243:["CD"],244:["AO"],245:["GW"],246:["IO"],247:["AC"],248:["SC"],249:["SD"],250:["RW"],251:["ET"],252:["SO"],253:["DJ"],254:["KE"],255:["TZ"],256:["UG"],257:["BI"],258:["MZ"],260:["ZM"],261:["MG"],262:["RE","YT"],263:["ZW"],264:["NA"],265:["MW"],266:["LS"],267:["BW"],268:["SZ"],269:["KM"],290:["SH","TA"],291:["ER"],297:["AW"],298:["FO"],299:["GL"],350:["GI"],351:["PT"],352:["LU"],353:["IE"],354:["IS"],355:["AL"],356:["MT"],357:["CY"],358:["FI","AX"],359:["BG"],370:["LT"],371:["LV"],372:["EE"],373:["MD"],374:["AM"],375:["BY"],376:["AD"],377:["MC"],378:["SM"],380:["UA"],381:["RS"],382:["ME"],383:["XK"],385:["HR"],386:["SI"],387:["BA"],389:["MK"],420:["CZ"],421:["SK"],423:["LI"],500:["FK"],501:["BZ"],502:["GT"],503:["SV"],504:["HN"],505:["NI"],506:["CR"],507:["PA"],508:["PM"],509:["HT"],590:["GP","BL","MF"],591:["BO"],592:["GY"],593:["EC"],594:["GF"],595:["PY"],596:["MQ"],597:["SR"],598:["UY"],599:["CW","BQ"],670:["TL"],672:["NF"],673:["BN"],674:["NR"],675:["PG"],676:["TO"],677:["SB"],678:["VU"],679:["FJ"],680:["PW"],681:["WF"],682:["CK"],683:["NU"],685:["WS"],686:["KI"],687:["NC"],688:["TV"],689:["PF"],690:["TK"],691:["FM"],692:["MH"],800:["001"],808:["001"],850:["KP"],852:["HK"],853:["MO"],855:["KH"],856:["LA"],870:["001"],878:["001"],880:["BD"],881:["001"],882:["001"],883:["001"],886:["TW"],888:["001"],960:["MV"],961:["LB"],962:["JO"],963:["SY"],964:["IQ"],965:["KW"],966:["SA"],967:["YE"],968:["OM"],970:["PS"],971:["AE"],972:["IL"],973:["BH"],974:["QA"],975:["BT"],976:["MN"],977:["NP"],979:["001"],992:["TJ"],993:["TM"],994:["AZ"],995:["GE"],996:["KG"],998:["UZ"]},U={AC:[,[,,"(?:[01589]\\d|[46])\\d{4}",,,,,,,[5,6]],[,,"6[2-467]\\d{3}",,,,"62889",,,[5]],[,,"4\\d{4}",,,,"40123",,,[5]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"AC",247,"00",,,,,,,,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"(?:0[1-9]|[1589]\\d)\\d{4}",,,,"542011",,,[6]],,,[,,,,,,,,,[-1]]],AD:[,[,,"(?:1|6\\d)\\d{7}|[135-9]\\d{5}",,,,,,,[6,8,9]],[,,"[78]\\d{5}",,,,"712345",,,[6]],[,,"690\\d{6}|[356]\\d{5}",,,,"312345",,,[6,9]],[,,"180[02]\\d{4}",,,,"18001234",,,[8]],[,,"[19]\\d{5}",,,,"912345",,,[6]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"AD",376,"00",,,,,,,,[[,"(\\d{3})(\\d{3})","$1 $2",["[135-9]"]],[,"(\\d{4})(\\d{4})","$1 $2",["1"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"]]],,[,,,,,,,,,[-1]],,,[,,"1800\\d{4}",,,,,,,[8]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AE:[,[,,"(?:[4-7]\\d|9[0-689])\\d{7}|800\\d{2,9}|[2-4679]\\d{7}",,,,,,,[5,6,7,8,9,10,11,12]],[,,"[2-4679][2-8]\\d{6}",,,,"22345678",,,[8],[7]],[,,"5[024-68]\\d{7}",,,,"501234567",,,[9]],[,,"400\\d{6}|800\\d{2,9}",,,,"800123456"],[,,"900[02]\\d{5}",,,,"900234567",,,[9]],[,,"700[05]\\d{5}",,,,"700012345",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"AE",971,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2,9})","$1 $2",["60|8"]],[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[236]|[479][2-8]"],"0$1"],[,"(\\d{3})(\\d)(\\d{5})","$1 $2 $3",["[479]"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["5"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"600[25]\\d{5}",,,,"600212345",,,[9]],,,[,,,,,,,,,[-1]]],AF:[,[,,"[2-7]\\d{8}",,,,,,,[9],[7]],[,,"(?:[25][0-8]|[34][0-4]|6[0-5])[2-9]\\d{6}",,,,"234567890",,,,[7]],[,,"7\\d{8}",,,,"701234567",,,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"AF",93,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[1-9]"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[2-7]"],"0$1"]],[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[2-7]"],"0$1"]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AG:[,[,,"(?:268|[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"268(?:4(?:6[0-38]|84)|56[0-2])\\d{4}",,,,"2684601234",,,,[7]],[,,"268(?:464|7(?:1[3-9]|[28]\\d|3[0246]|64|7[0-689]))\\d{4}",,,,"2684641234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,"26848[01]\\d{4}",,,,"2684801234",,,,[7]],"AG",1,"011","1",,,"([457]\\d{6})$|1","268$1",,,,,[,,"26840[69]\\d{4}",,,,"2684061234",,,,[7]],,"268",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AI:[,[,,"(?:264|[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"264(?:292|4(?:6[12]|9[78]))\\d{4}",,,,"2644612345",,,,[7]],[,,"264(?:235|4(?:69|76)|5(?:3[6-9]|8[1-4])|7(?:29|72))\\d{4}",,,,"2642351234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"AI",1,"011","1",,,"([2457]\\d{6})$|1","264$1",,,,,[,,"264724\\d{4}",,,,"2647241234",,,,[7]],,"264",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AL:[,[,,"(?:700\\d\\d|900)\\d{3}|8\\d{5,7}|(?:[2-5]|6\\d)\\d{7}",,,,,,,[6,7,8,9],[5]],[,,"4505[0-2]\\d{3}|(?:[2358][16-9]\\d[2-9]|4410)\\d{4}|(?:[2358][2-5][2-9]|4(?:[2-57-9][2-9]|6\\d))\\d{5}",,,,"22345678",,,[8],[5,6,7]],[,,"6(?:[78][2-9]|9\\d)\\d{6}",,,,"672123456",,,[9]],[,,"800\\d{4}",,,,"8001234",,,[7]],[,,"900[1-9]\\d\\d",,,,"900123",,,[6]],[,,"808[1-9]\\d\\d",,,,"808123",,,[6]],[,,"700[2-9]\\d{4}",,,,"70021234",,,[8]],[,,,,,,,,,[-1]],"AL",355,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3,4})","$1 $2",["80|9"],"0$1"],[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["4[2-6]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2358][2-5]|4"],"0$1"],[,"(\\d{3})(\\d{5})","$1 $2",["[23578]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["6"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AM:[,[,,"(?:[1-489]\\d|55|60|77)\\d{6}",,,,,,,[8],[5,6]],[,,"(?:(?:1[0-25]|47)\\d|2(?:2[2-46]|3[1-8]|4[2-69]|5[2-7]|6[1-9]|8[1-7])|3[12]2)\\d{5}",,,,"10123456",,,,[5,6]],[,,"(?:33|4[1349]|55|77|88|9[13-9])\\d{6}",,,,"77123456"],[,,"800\\d{5}",,,,"80012345"],[,,"90[016]\\d{5}",,,,"90012345"],[,,"80[1-4]\\d{5}",,,,"80112345"],[,,,,,,,,,[-1]],[,,"60(?:2[78]|3[5-9]|4[02-9]|5[0-46-9]|[6-8]\\d|9[0-2])\\d{4}",,,,"60271234"],"AM",374,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[89]0"],"0 $1"],[,"(\\d{3})(\\d{5})","$1 $2",["2|3[12]"],"(0$1)"],[,"(\\d{2})(\\d{6})","$1 $2",["1|47"],"(0$1)"],[,"(\\d{2})(\\d{6})","$1 $2",["[3-9]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AO:[,[,,"[29]\\d{8}",,,,,,,[9]],[,,"2\\d(?:[0134][25-9]|[25-9]\\d)\\d{5}",,,,"222123456"],[,,"9[1-79]\\d{7}",,,,"923123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"AO",244,"00",,,,,,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[29]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AR:[,[,,"(?:11|[89]\\d\\d)\\d{8}|[2368]\\d{9}",,,,,,,[10,11],[6,7,8]],[,,"3(?:7(?:1[15]|81)|8(?:21|4[16]|69|9[12]))[46]\\d{5}|(?:(?:11[1-8]|670)\\d|2(?:21[2-6]|(?:3[06]|49)4|6(?:04|1[2-8])|9[17][4-6])|3(?:(?:36|64)4|4(?:1[2-8]|[25][4-6]|84)|5(?:1[2-9]|[38][4-6])|8(?:[17][2-6]|3[4-6]|8[3-68])))\\d{6}|(?:2(?:23|64|99)|3(?:43|85))[3-6]\\d{6}|(?:2(?:657|9(?:54|66))|3(?:487|7(?:55|77)|865))[2-8]\\d{5}|(?:2(?:[28]0|37|6[36]|9[48])|3(?:62|7[069]|80))[45]\\d{6}|(?:2(?:2(?:2[59]|44|52)|3(?:26|44)|47[35]|9(?:[07]2|2[26]|34|46))|3327)[45]\\d{5}|(?:2(?:2(?:62|81)|320|622|9(?:42|83))|3(?:329|4(?:62|76|89)|564))[2-6]\\d{5}|(?:2(?:284|3(?:02|23)|477|920)|3(?:4(?:46|[89]2)|541|878))[2-7]\\d{5}|2(?:2(?:21|4[23]|6[145]|7[1-4]|8[356]|9[267])|3(?:16|3[13-8]|43|5[346-8]|9[3-5])|6(?:2[46]|4[78]|5[1568])|9(?:03|2[1457-9]|3[1356]|4[08]|[56][23]|82))4\\d{5}|(?:2(?:257|3(?:24|46|92)|9(?:01|23|64))|3(?:4(?:42|71)|5(?:25|37|4[347]|71)|7(?:18|35|5[17])))[3-6]\\d{5}|(?:2(?:2(?:02|2[3467]|4[156]|5[45]|6[6-8]|91)|3(?:1[47]|25|[45][25]|96)|47[48]|625|932)|3(?:38[2578]|4(?:0[0-24-9]|3[78]|4[457]|58|6[03-9]|72|83|9[136-8])|5(?:2[124]|[368][23]|4[2689]|7[2-6])|7(?:16|2[15]|3[14]|4[13]|5[468]|7[2-5]|8[26])|8(?:2[5-7]|3[278]|4[3-5]|5[78]|6[1-378]|[78]7|94)))[4-6]\\d{5}",,,,"1123456789",,,[10],[6,7,8]],[,,"93(?:7(?:1[15]|81)|8(?:21|4[16]|69|9[12]))[46]\\d{5}|(?:675\\d|9(?:11[1-8]\\d|2(?:21[2-6]|(?:3[06]|49)4|6(?:04|1[2-8])|9[17][4-6])|3(?:(?:36|64)4|4(?:1[2-8]|[25][4-6]|84)|5(?:1[2-9]|[38][4-6])|8(?:[17][2-6]|3[4-6]|8[3-68]))))\\d{6}|9(?:2(?:23|64|99)|3(?:43|85))[3-6]\\d{6}|9(?:2(?:657|9(?:54|66))|3(?:487|7(?:55|77)|865))[2-8]\\d{5}|9(?:2(?:[28]0|37|6[36]|9[48])|3(?:62|7[069]|80))[45]\\d{6}|9(?:2(?:2(?:2[59]|44|52)|3(?:26|44)|47[35]|9(?:[07]2|2[26]|34|46))|3327)[45]\\d{5}|9(?:2(?:2(?:62|81)|320|622|9(?:42|83))|3(?:329|4(?:62|76|89)|564))[2-6]\\d{5}|9(?:2(?:284|3(?:02|23)|477|920)|3(?:4(?:46|[89]2)|541|878))[2-7]\\d{5}|92(?:2(?:21|4[23]|6[145]|7[1-4]|8[356]|9[267])|3(?:16|3[13-8]|43|5[346-8]|9[3-5])|6(?:2[46]|4[78]|5[1568])|9(?:03|2[1457-9]|3[1356]|4[08]|[56][23]|82))4\\d{5}|9(?:2(?:257|3(?:24|46|92)|9(?:01|23|64))|3(?:4(?:42|71)|5(?:25|37|4[347]|71)|7(?:18|35|5[17])))[3-6]\\d{5}|9(?:2(?:2(?:02|2[3467]|4[156]|5[45]|6[6-8]|91)|3(?:1[47]|25|[45][25]|96)|47[48]|625|932)|3(?:38[2578]|4(?:0[0-24-9]|3[78]|4[457]|58|6[03-9]|72|83|9[136-8])|5(?:2[124]|[368][23]|4[2689]|7[2-6])|7(?:16|2[15]|3[14]|4[13]|5[468]|7[2-5]|8[26])|8(?:2[5-7]|3[278]|4[3-5]|5[78]|6[1-378]|[78]7|94)))[4-6]\\d{5}",,,,"91123456789",,,,[6,7,8]],[,,"800\\d{7,8}",,,,"8001234567"],[,,"60[04579]\\d{7}",,,,"6001234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"AR",54,"00","0",,,"0?(?:(11|2(?:2(?:02?|[13]|2[13-79]|4[1-6]|5[2457]|6[124-8]|7[1-4]|8[13-6]|9[1267])|3(?:02?|1[467]|2[03-6]|3[13-8]|[49][2-6]|5[2-8]|[67])|4(?:7[3-578]|9)|6(?:[0136]|2[24-6]|4[6-8]?|5[15-8])|80|9(?:0[1-3]|[19]|2\\d|3[1-6]|4[02568]?|5[2-4]|6[2-46]|72?|8[23]?))|3(?:3(?:2[79]|6|8[2578])|4(?:0[0-24-9]|[12]|3[5-8]?|4[24-7]|5[4-68]?|6[02-9]|7[126]|8[2379]?|9[1-36-8])|5(?:1|2[1245]|3[237]?|4[1-46-9]|6[2-4]|7[1-6]|8[2-5]?)|6[24]|7(?:[069]|1[1568]|2[15]|3[145]|4[13]|5[14-8]|7[2-57]|8[126])|8(?:[01]|2[15-7]|3[2578]?|4[13-6]|5[4-8]?|6[1-357-9]|7[36-8]?|8[5-8]?|9[124])))15)?","9$1",,,[[,"(\\d{3})","$1",["0|1(?:0[0-35-7]|1[02-5]|2[015]|3[47]|4[478])|911"]],[,"(\\d{2})(\\d{4})","$1-$2",["[1-9]"]],[,"(\\d{3})(\\d{4})","$1-$2",["[2-9]"]],[,"(\\d{4})(\\d{4})","$1-$2",["[1-8]"]],[,"(\\d{4})(\\d{2})(\\d{4})","$1 $2-$3",["2(?:2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(?:3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9])","2(?:[23]02|6(?:[25]|4[6-8])|9(?:[02356]|4[02568]|72|8[23]))|3(?:3[28]|4(?:[04679]|3[5-8]|5[4-68]|8[2379])|5(?:[2467]|3[237]|8[2-5])|7[1-578]|8(?:[2469]|3[2578]|5[4-8]|7[36-8]|8[5-8]))|2(?:2[24-9]|3[1-59]|47)","2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3[78]|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8[23])|7[1-578]|8(?:[2469]|3[278]|5[56][46]|86[3-6]))|2(?:2[24-9]|3[1-59]|47)|38(?:[58][78]|7[378])|3(?:4[35][56]|58[45]|8(?:[38]5|54|76))[4-6]","2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3(?:5(?:4[0-25689]|[56])|[78])|58|8[2379])|5(?:[2467]|3[237]|8(?:[23]|4(?:[45]|60)|5(?:4[0-39]|5|64)))|7[1-578]|8(?:[2469]|3[278]|54(?:4|5[13-7]|6[89])|86[3-6]))|2(?:2[24-9]|3[1-59]|47)|38(?:[58][78]|7[378])|3(?:454|85[56])[46]|3(?:4(?:36|5[56])|8(?:[38]5|76))[4-6]"],"0$1",,1],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["1"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[68]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2-$3",["[23]"],"0$1",,1],[,"(\\d)(\\d{4})(\\d{2})(\\d{4})","$2 15-$3-$4",["9(?:2[2-469]|3[3-578])","9(?:2(?:2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(?:3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9]))","9(?:2(?:[23]02|6(?:[25]|4[6-8])|9(?:[02356]|4[02568]|72|8[23]))|3(?:3[28]|4(?:[04679]|3[5-8]|5[4-68]|8[2379])|5(?:[2467]|3[237]|8[2-5])|7[1-578]|8(?:[2469]|3[2578]|5[4-8]|7[36-8]|8[5-8])))|92(?:2[24-9]|3[1-59]|47)","9(?:2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3[78]|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8[23])|7[1-578]|8(?:[2469]|3[278]|5(?:[56][46]|[78])|7[378]|8(?:6[3-6]|[78]))))|92(?:2[24-9]|3[1-59]|47)|93(?:4[35][56]|58[45]|8(?:[38]5|54|76))[4-6]","9(?:2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3(?:5(?:4[0-25689]|[56])|[78])|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8(?:[23]|4(?:[45]|60)|5(?:4[0-39]|5|64)))|7[1-578]|8(?:[2469]|3[278]|5(?:4(?:4|5[13-7]|6[89])|[56][46]|[78])|7[378]|8(?:6[3-6]|[78]))))|92(?:2[24-9]|3[1-59]|47)|93(?:4(?:36|5[56])|8(?:[38]5|76))[4-6]"],"0$1"],[,"(\\d)(\\d{2})(\\d{4})(\\d{4})","$2 15-$3-$4",["91"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{5})","$1-$2-$3",["8"],"0$1"],[,"(\\d)(\\d{3})(\\d{3})(\\d{4})","$2 15-$3-$4",["9"],"0$1"]],[[,"(\\d{4})(\\d{2})(\\d{4})","$1 $2-$3",["2(?:2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(?:3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9])","2(?:[23]02|6(?:[25]|4[6-8])|9(?:[02356]|4[02568]|72|8[23]))|3(?:3[28]|4(?:[04679]|3[5-8]|5[4-68]|8[2379])|5(?:[2467]|3[237]|8[2-5])|7[1-578]|8(?:[2469]|3[2578]|5[4-8]|7[36-8]|8[5-8]))|2(?:2[24-9]|3[1-59]|47)","2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3[78]|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8[23])|7[1-578]|8(?:[2469]|3[278]|5[56][46]|86[3-6]))|2(?:2[24-9]|3[1-59]|47)|38(?:[58][78]|7[378])|3(?:4[35][56]|58[45]|8(?:[38]5|54|76))[4-6]","2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3(?:5(?:4[0-25689]|[56])|[78])|58|8[2379])|5(?:[2467]|3[237]|8(?:[23]|4(?:[45]|60)|5(?:4[0-39]|5|64)))|7[1-578]|8(?:[2469]|3[278]|54(?:4|5[13-7]|6[89])|86[3-6]))|2(?:2[24-9]|3[1-59]|47)|38(?:[58][78]|7[378])|3(?:454|85[56])[46]|3(?:4(?:36|5[56])|8(?:[38]5|76))[4-6]"],"0$1",,1],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["1"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[68]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2-$3",["[23]"],"0$1",,1],[,"(\\d)(\\d{4})(\\d{2})(\\d{4})","$1 $2 $3-$4",["9(?:2[2-469]|3[3-578])","9(?:2(?:2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(?:3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9]))","9(?:2(?:[23]02|6(?:[25]|4[6-8])|9(?:[02356]|4[02568]|72|8[23]))|3(?:3[28]|4(?:[04679]|3[5-8]|5[4-68]|8[2379])|5(?:[2467]|3[237]|8[2-5])|7[1-578]|8(?:[2469]|3[2578]|5[4-8]|7[36-8]|8[5-8])))|92(?:2[24-9]|3[1-59]|47)","9(?:2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3[78]|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8[23])|7[1-578]|8(?:[2469]|3[278]|5(?:[56][46]|[78])|7[378]|8(?:6[3-6]|[78]))))|92(?:2[24-9]|3[1-59]|47)|93(?:4[35][56]|58[45]|8(?:[38]5|54|76))[4-6]","9(?:2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3(?:5(?:4[0-25689]|[56])|[78])|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8(?:[23]|4(?:[45]|60)|5(?:4[0-39]|5|64)))|7[1-578]|8(?:[2469]|3[278]|5(?:4(?:4|5[13-7]|6[89])|[56][46]|[78])|7[378]|8(?:6[3-6]|[78]))))|92(?:2[24-9]|3[1-59]|47)|93(?:4(?:36|5[56])|8(?:[38]5|76))[4-6]"]],[,"(\\d)(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3-$4",["91"]],[,"(\\d{3})(\\d{3})(\\d{5})","$1-$2-$3",["8"],"0$1"],[,"(\\d)(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3-$4",["9"]]],[,,,,,,,,,[-1]],,,[,,"810\\d{7}",,,,,,,[10]],[,,"810\\d{7}",,,,"8101234567",,,[10]],,,[,,,,,,,,,[-1]]],AS:[,[,,"(?:[58]\\d\\d|684|900)\\d{7}",,,,,,,[10],[7]],[,,"6846(?:22|33|44|55|77|88|9[19])\\d{4}",,,,"6846221234",,,,[7]],[,,"684(?:2(?:48|5[2468]|7[26])|7(?:3[13]|70|82))\\d{4}",,,,"6847331234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"AS",1,"011","1",,,"([267]\\d{6})$|1","684$1",,,,,[,,,,,,,,,[-1]],,"684",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AT:[,[,,"1\\d{3,12}|2\\d{6,12}|43(?:(?:0\\d|5[02-9])\\d{3,9}|2\\d{4,5}|[3467]\\d{4}|8\\d{4,6}|9\\d{4,7})|5\\d{4,12}|8\\d{7,12}|9\\d{8,12}|(?:[367]\\d|4[0-24-9])\\d{4,11}",,,,,,,[4,5,6,7,8,9,10,11,12,13],[3]],[,,"1(?:11\\d|[2-9]\\d{3,11})|(?:316|463|(?:51|66|73)2)\\d{3,10}|(?:2(?:1[467]|2[13-8]|5[2357]|6[1-46-8]|7[1-8]|8[124-7]|9[1458])|3(?:1[1-578]|3[23568]|4[5-7]|5[1378]|6[1-38]|8[3-68])|4(?:2[1-8]|35|7[1368]|8[2457])|5(?:2[1-8]|3[357]|4[147]|5[12578]|6[37])|6(?:13|2[1-47]|4[135-8]|5[468])|7(?:2[1-8]|35|4[13478]|5[68]|6[16-8]|7[1-6]|9[45]))\\d{4,10}",,,,"1234567890",,,,[3]],[,,"6(?:5[0-3579]|6[013-9]|[7-9]\\d)\\d{4,10}",,,,"664123456",,,[7,8,9,10,11,12,13]],[,,"800\\d{6,10}",,,,"800123456",,,[9,10,11,12,13]],[,,"(?:8[69][2-68]|9(?:0[01]|3[019]))\\d{6,10}",,,,"900123456",,,[9,10,11,12,13]],[,,"8(?:10|2[018])\\d{6,10}|828\\d{5}",,,,"810123456",,,[8,9,10,11,12,13]],[,,,,,,,,,[-1]],[,,"5(?:0[1-9]|17|[79]\\d)\\d{2,10}|7[28]0\\d{6,10}",,,,"780123456",,,[5,6,7,8,9,10,11,12,13]],"AT",43,"00","0",,,"0",,,,[[,"(\\d{4})","$1",["14"]],[,"(\\d)(\\d{3,12})","$1 $2",["1(?:11|[2-9])"],"0$1"],[,"(\\d{3})(\\d{2})","$1 $2",["517"],"0$1"],[,"(\\d{2})(\\d{3,5})","$1 $2",["5[079]"],"0$1"],[,"(\\d{6})","$1",["[18]"]],[,"(\\d{3})(\\d{3,10})","$1 $2",["(?:31|4)6|51|6(?:5[0-3579]|[6-9])|7(?:20|32|8)|[89]"],"0$1"],[,"(\\d{4})(\\d{3,9})","$1 $2",["[2-467]|5[2-6]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["5"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4,7})","$1 $2 $3",["5"],"0$1"]],[[,"(\\d)(\\d{3,12})","$1 $2",["1(?:11|[2-9])"],"0$1"],[,"(\\d{3})(\\d{2})","$1 $2",["517"],"0$1"],[,"(\\d{2})(\\d{3,5})","$1 $2",["5[079]"],"0$1"],[,"(\\d{3})(\\d{3,10})","$1 $2",["(?:31|4)6|51|6(?:5[0-3579]|[6-9])|7(?:20|32|8)|[89]"],"0$1"],[,"(\\d{4})(\\d{3,9})","$1 $2",["[2-467]|5[2-6]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["5"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4,7})","$1 $2 $3",["5"],"0$1"]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AU:[,[,,"1(?:[0-79]\\d{7}(?:\\d(?:\\d{2})?)?|8[0-24-9]\\d{7})|[2-478]\\d{8}|1\\d{4,7}",,,,,,,[5,6,7,8,9,10,12]],[,,"(?:(?:(?:2(?:[0-26-9]\\d|3[0-8]|4[02-9]|5[0135-9])|7(?:[013-57-9]\\d|2[0-8]))\\d|3(?:(?:[0-3589]\\d|6[1-9]|7[0-35-9])\\d|4(?:[0-578]\\d|90)))\\d\\d|8(?:51(?:0(?:0[03-9]|[12479]\\d|3[2-9]|5[0-8]|6[1-9]|8[0-7])|1(?:[0235689]\\d|1[0-69]|4[0-589]|7[0-47-9])|2(?:0[0-79]|[18][13579]|2[14-9]|3[0-46-9]|[4-6]\\d|7[89]|9[0-4])|3\\d\\d)|(?:6[0-8]|[78]\\d)\\d{3}|9(?:[02-9]\\d{3}|1(?:(?:[0-58]\\d|6[0135-9])\\d|7(?:0[0-24-9]|[1-9]\\d)|9(?:[0-46-9]\\d|5[0-79])))))\\d{3}",,,,"212345678",,,[9],[8]],[,,"4(?:79[01]|83[0-389]|94[0-4])\\d{5}|4(?:[0-36]\\d|4[047-9]|5[0-25-9]|7[02-8]|8[0-24-9]|9[0-37-9])\\d{6}",,,,"412345678",,,[9]],[,,"180(?:0\\d{3}|2)\\d{3}",,,,"1800123456",,,[7,10]],[,,"190[0-26]\\d{6}",,,,"1900123456",,,[10]],[,,"13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",,,,"1300123456",,,[6,8,10,12]],[,,,,,,,,,[-1]],[,,"14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",,,,"147101234",,,[9]],"AU",61,"001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","0",,,"(183[12])|0",,"0011",,[[,"(\\d{2})(\\d{3,4})","$1 $2",["16"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["13"]],[,"(\\d{3})(\\d{3})","$1 $2",["19"]],[,"(\\d{3})(\\d{4})","$1 $2",["180","1802"]],[,"(\\d{4})(\\d{3,4})","$1 $2",["19"]],[,"(\\d{2})(\\d{3})(\\d{2,4})","$1 $2 $3",["16"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["14|4"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["[2378]"],"(0$1)","$CC ($1)"],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:30|[89])"]],[,"(\\d{4})(\\d{4})(\\d{4})","$1 $2 $3",["130"]]],[[,"(\\d{2})(\\d{3,4})","$1 $2",["16"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2,4})","$1 $2 $3",["16"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["14|4"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["[2378]"],"(0$1)","$CC ($1)"],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:30|[89])"]]],[,,"163\\d{2,6}",,,,"1631234",,,[5,6,7,8,9]],1,,[,,"1(?:3(?:00\\d{5}|45[0-4])|802)\\d{3}|1[38]00\\d{6}|13\\d{4}",,,,,,,[6,7,8,10,12]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AW:[,[,,"(?:[25-79]\\d\\d|800)\\d{4}",,,,,,,[7]],[,,"5(?:2\\d|8[1-9])\\d{4}",,,,"5212345"],[,,"(?:290|5[69]\\d|6(?:[03]0|22|4[0-2]|[69]\\d)|7(?:[34]\\d|7[07])|9(?:6[45]|9[4-8]))\\d{4}",,,,"5601234"],[,,"800\\d{4}",,,,"8001234"],[,,"900\\d{4}",,,,"9001234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:28\\d|501)\\d{4}",,,,"5011234"],"AW",297,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[25-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],AX:[,[,,"2\\d{4,9}|35\\d{4,5}|(?:60\\d\\d|800)\\d{4,6}|7\\d{5,11}|(?:[14]\\d|3[0-46-9]|50)\\d{4,8}",,,,,,,[5,6,7,8,9,10,11,12]],[,,"18[1-8]\\d{3,6}",,,,"181234567",,,[6,7,8,9]],[,,"4946\\d{2,6}|(?:4[0-8]|50)\\d{4,8}",,,,"412345678",,,[6,7,8,9,10]],[,,"800\\d{4,6}",,,,"800123456",,,[7,8,9]],[,,"[67]00\\d{5,6}",,,,"600123456",,,[8,9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"AX",358,"00|99(?:[01469]|5(?:[14]1|3[23]|5[59]|77|88|9[09]))","0",,,"0",,"00",,,,[,,,,,,,,,[-1]],,"18",[,,,,,,,,,[-1]],[,,"20\\d{4,8}|60[12]\\d{5,6}|7(?:099\\d{4,5}|5[03-9]\\d{3,7})|20[2-59]\\d\\d|(?:606|7(?:0[78]|1|3\\d))\\d{7}|(?:10|29|3[09]|70[1-5]\\d)\\d{4,8}",,,,"10112345"],,,[,,,,,,,,,[-1]]],AZ:[,[,,"365\\d{6}|(?:[124579]\\d|60|88)\\d{7}",,,,,,,[9],[7]],[,,"(?:2[12]428|3655[02])\\d{4}|(?:2(?:22[0-79]|63[0-28])|3654)\\d{5}|(?:(?:1[28]|46)\\d|2(?:[014-6]2|[23]3))\\d{6}",,,,"123123456",,,,[7]],[,,"36554\\d{4}|(?:[16]0|4[04]|5[015]|7[07]|99)\\d{7}",,,,"401234567"],[,,"88\\d{7}",,,,"881234567"],[,,"900200\\d{3}",,,,"900200123"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"AZ",994,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[1-9]"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["90"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[28]|2|365|46","1[28]|2|365[45]|46","1[28]|2|365(?:4|5[02])|46"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[13-9]"],"0$1"]],[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["90"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[28]|2|365|46","1[28]|2|365[45]|46","1[28]|2|365(?:4|5[02])|46"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[13-9]"],"0$1"]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BA:[,[,,"6\\d{8}|(?:[35689]\\d|49|70)\\d{6}",,,,,,,[8,9],[6]],[,,"(?:3(?:[05-79][2-9]|1[4579]|[23][24-9]|4[2-4689]|8[2457-9])|49[2-579]|5(?:0[2-49]|[13][2-9]|[268][2-4679]|4[4689]|5[2-79]|7[2-69]|9[2-4689]))\\d{5}",,,,"30212345",,,[8],[6]],[,,"6040\\d{5}|6(?:03|[1-356]|44|7\\d)\\d{6}",,,,"61123456"],[,,"8[08]\\d{6}",,,,"80123456",,,[8]],[,,"9[0246]\\d{6}",,,,"90123456",,,[8]],[,,"8[12]\\d{6}",,,,"82123456",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BA",387,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})","$1-$2",["[2-9]"]],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["6[1-3]|[7-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2-$3",["[3-5]|6[56]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["6"],"0$1"]],[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["6[1-3]|[7-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2-$3",["[3-5]|6[56]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["6"],"0$1"]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"703[235]0\\d{3}|70(?:2[0-5]|3[0146]|[56]0)\\d{4}",,,,"70341234",,,[8]],,,[,,,,,,,,,[-1]]],BB:[,[,,"(?:246|[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"246521[0369]\\d{3}|246(?:2(?:2[78]|7[0-4])|4(?:1[024-6]|2\\d|3[2-9])|5(?:20|[34]\\d|54|7[1-3])|6(?:2\\d|38)|7[35]7|9(?:1[89]|63))\\d{4}",,,,"2464123456",,,,[7]],[,,"246(?:(?:2(?:[3568]\\d|4[0-57-9])|3(?:5[2-9]|6[0-6])|4(?:46|5\\d)|69[5-7]|8(?:[2-5]\\d|83))\\d|52(?:1[147]|20))\\d{3}",,,,"2462501234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"(?:246976|900[2-9]\\d\\d)\\d{4}",,,,"9002123456",,,,[7]],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,"24631\\d{5}",,,,"2463101234",,,,[7]],"BB",1,"011","1",,,"([2-9]\\d{6})$|1","246$1",,,,,[,,,,,,,,,[-1]],,"246",[,,,,,,,,,[-1]],[,,"246(?:292|367|4(?:1[7-9]|3[01]|4[47-9]|67)|7(?:1[2-9]|2\\d|3[016]|53))\\d{4}",,,,"2464301234",,,,[7]],,,[,,,,,,,,,[-1]]],BD:[,[,,"[1-469]\\d{9}|8[0-79]\\d{7,8}|[2-79]\\d{8}|[2-9]\\d{7}|[3-9]\\d{6}|[57-9]\\d{5}",,,,,,,[6,7,8,9,10]],[,,"(?:4(?:31\\d\\d|423)|5222)\\d{3}(?:\\d{2})?|8332[6-9]\\d\\d|(?:3(?:03[56]|224)|4(?:22[25]|653))\\d{3,4}|(?:3(?:42[47]|529|823)|4(?:027|525|65(?:28|8))|562|6257|7(?:1(?:5[3-5]|6[12]|7[156]|89)|22[589]56|32|42675|52(?:[25689](?:56|8)|[347]8)|71(?:6[1267]|75|89)|92374)|82(?:2[59]|32)56|9(?:03[23]56|23(?:256|373)|31|5(?:1|2[4589]56)))\\d{3}|(?:3(?:02[348]|22[35]|324|422)|4(?:22[67]|32[236-9]|6(?:2[46]|5[57])|953)|5526|6(?:024|6655)|81)\\d{4,5}|(?:2(?:7(?:1[0-267]|2[0-289]|3[0-29]|4[01]|5[1-3]|6[013]|7[0178]|91)|8(?:0[125]|1[1-6]|2[0157-9]|3[1-69]|41|6[1-35]|7[1-5]|8[1-8]|9[0-6])|9(?:0[0-2]|1[0-4]|2[568]|3[3-6]|5[5-7]|6[0136-9]|7[0-7]|8[014-9]))|3(?:0(?:2[025-79]|3[2-4])|181|22[12]|32[2356]|824)|4(?:02[09]|22[348]|32[045]|523|6(?:27|54))|666(?:22|53)|7(?:22[57-9]|42[56]|82[35])8|8(?:0[124-9]|2(?:181|2[02-4679]8)|4[12]|[5-7]2)|9(?:[04]2|2(?:2|328)|81))\\d{4}|(?:2(?:[23]\\d|[45])\\d\\d|3(?:1(?:2[5-7]|[5-7])|425|822)|4(?:033|1\\d|[257]1|332|4(?:2[246]|5[25])|6(?:2[35]|56|62)|8(?:23|54)|92[2-5])|5(?:02[03489]|22[457]|32[35-79]|42[46]|6(?:[18]|53)|724|826)|6(?:023|2(?:2[2-5]|5[3-5]|8)|32[3478]|42[34]|52[47]|6(?:[18]|6(?:2[34]|5[24]))|[78]2[2-5]|92[2-6])|7(?:02|21\\d|[3-589]1|6[12]|72[24])|8(?:217|3[12]|[5-7]1)|9[24]1)\\d{5}|(?:(?:3[2-8]|5[2-57-9]|6[03-589])1|4[4689][18])\\d{5}|[59]1\\d{5}",,,,"27111234"],[,,"(?:1[13-9]\\d|644)\\d{7}|(?:3[78]|44|66)[02-9]\\d{7}",,,,"1812345678",,,[10]],[,,"80[03]\\d{7}",,,,"8001234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"96(?:0[469]|1[0-47]|3[389]|43|6[69]|7[78])\\d{6}",,,,"9604123456",,,[10]],"BD",880,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{4,6})","$1-$2",["31[5-8]|[459]1"],"0$1"],[,"(\\d{3})(\\d{3,7})","$1-$2",["3(?:[67]|8[013-9])|4(?:6[168]|7|[89][18])|5(?:6[128]|9)|6(?:[15]|28|4[14])|7[2-589]|8(?:0[014-9]|[12])|9[358]|(?:3[2-5]|4[235]|5[2-578]|6[0389]|76|8[3-7]|9[24])1|(?:44|66)[01346-9]"],"0$1"],[,"(\\d{4})(\\d{3,6})","$1-$2",["[13-9]|2[23]"],"0$1"],[,"(\\d)(\\d{7,8})","$1-$2",["2"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BE:[,[,,"4\\d{8}|[1-9]\\d{7}",,,,,,,[8,9]],[,,"80[2-8]\\d{5}|(?:1[0-69]|[23][2-8]|4[23]|5\\d|6[013-57-9]|71|8[1-79]|9[2-4])\\d{6}",,,,"12345678",,,[8]],[,,"4[5-9]\\d{7}",,,,"470123456",,,[9]],[,,"800[1-9]\\d{4}",,,,"80012345",,,[8]],[,,"(?:70(?:2[0-57]|3[04-7]|44|6[4-69]|7[0579])|90\\d\\d)\\d{4}",,,,"90012345",,,[8]],[,,"7879\\d{4}",,,,"78791234",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BE",32,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["(?:80|9)0"],"0$1"],[,"(\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[239]|4[23]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[15-8]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["4"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"78(?:0[57]|1[014-8]|2[25]|3[15-8]|48|[56]0|7[06-8]|9\\d)\\d{4}",,,,"78102345",,,[8]],,,[,,,,,,,,,[-1]]],BF:[,[,,"[025-7]\\d{7}",,,,,,,[8]],[,,"2(?:0(?:49|5[23]|6[5-7]|9[016-9])|4(?:4[569]|5[4-6]|6[5-7]|7[0179])|5(?:[34]\\d|50|6[5-7]))\\d{4}",,,,"20491234"],[,,"(?:0[1-7]|5[0-8]|[67]\\d)\\d{6}",,,,"70123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BF",226,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[025-7]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BG:[,[,,"00800\\d{7}|[2-7]\\d{6,7}|[89]\\d{6,8}|2\\d{5}",,,,,,,[6,7,8,9,12],[4,5]],[,,"2\\d{5,7}|(?:43[1-6]|70[1-9])\\d{4,5}|(?:[36]\\d|4[124-7]|[57][1-9]|8[1-6]|9[1-7])\\d{5,6}",,,,"2123456",,,[6,7,8],[4,5]],[,,"(?:43[07-9]|99[69]\\d)\\d{5}|(?:8[7-9]|98)\\d{7}",,,,"43012345",,,[8,9]],[,,"(?:00800\\d\\d|800)\\d{5}",,,,"80012345",,,[8,12]],[,,"90\\d{6}",,,,"90123456",,,[8]],[,,"700\\d{5}",,,,"70012345",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BG",359,"00","0",,,"0",,,,[[,"(\\d{6})","$1",["1"]],[,"(\\d)(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["2"],"0$1"],[,"(\\d{3})(\\d{4})","$1 $2",["43[1-6]|70[1-9]"],"0$1"],[,"(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["2"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["[356]|4[124-7]|7[1-9]|8[1-6]|9[1-7]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["(?:70|8)0"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3",["43[1-7]|7"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[48]|9[08]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1"]],[[,"(\\d)(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["2"],"0$1"],[,"(\\d{3})(\\d{4})","$1 $2",["43[1-6]|70[1-9]"],"0$1"],[,"(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["2"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["[356]|4[124-7]|7[1-9]|8[1-6]|9[1-7]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["(?:70|8)0"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3",["43[1-7]|7"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[48]|9[08]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1"]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BH:[,[,,"[136-9]\\d{7}",,,,,,,[8]],[,,"(?:1(?:3[1356]|6[0156]|7\\d)\\d|6(?:1[16]\\d|500|6(?:0\\d|3[12]|44|55|7[7-9]|88)|9[69][69])|7(?:[07]\\d\\d|1(?:11|78)))\\d{4}",,,,"17001234"],[,,"(?:3(?:[0-79]\\d|8[0-57-9])\\d|6(?:3(?:00|33|6[16])|441|6(?:3[03-9]|[69]\\d|7[0-689])))\\d{4}",,,,"36001234"],[,,"8[02369]\\d{6}",,,,"80123456"],[,,"(?:87|9[0-8])\\d{6}",,,,"90123456"],[,,"84\\d{6}",,,,"84123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BH",973,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[13679]|8[02-4679]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BI:[,[,,"(?:[267]\\d|31)\\d{6}",,,,,,,[8]],[,,"(?:22|31)\\d{6}",,,,"22201234"],[,,"(?:29|[67][125-9])\\d{6}",,,,"79561234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BI",257,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2367]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BJ:[,[,,"(?:01\\d|[24-689])\\d{7}",,,,,,,[8,10]],[,,"2090\\d{4}|(?:012\\d\\d|2(?:02|1[037]|2[45]|3[68]|4\\d))\\d{5}",,,,"0120211234"],[,,"(?:01(?:2[5-9]|[4-69]\\d)|4[0-8]|[56]\\d|9[013-9])\\d{6}",,,,"0195123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"857[58]\\d{4}",,,,"85751234",,,[8]],"BJ",229,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24-689]"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["0"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"81\\d{6}",,,,"81123456",,,[8]],,,[,,,,,,,,,[-1]]],BL:[,[,,"(?:590\\d|7090)\\d{5}|(?:69|80|9\\d)\\d{7}",,,,,,,[9]],[,,"590(?:2[7-9]|3[3-7]|5[12]|87)\\d{4}",,,,"590271234"],[,,"(?:69(?:0\\d\\d|1(?:2[2-9]|3[0-5])|4(?:0[89]|1[2-6]|9\\d)|6(?:1[016-9]|5[0-4]|[67]\\d))|7090[0-4])\\d{4}",,,,"690001234"],[,,"80[0-5]\\d{6}",,,,"800012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9(?:(?:39[5-7]|76[018])\\d|475[0-5])\\d{4}",,,,"976012345"],"BL",590,"00","0",,,"0",,,,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BM:[,[,,"(?:441|[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"441(?:[46]\\d\\d|5(?:4\\d|60|89))\\d{4}",,,,"4414123456",,,,[7]],[,,"441(?:[2378]\\d|5[0-39]|9[02])\\d{5}",,,,"4413701234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"BM",1,"011","1",,,"([2-9]\\d{6})$|1","441$1",,,,,[,,,,,,,,,[-1]],,"441",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BN:[,[,,"[2-578]\\d{6}",,,,,,,[7]],[,,"22[0-7]\\d{4}|(?:2[013-9]|[34]\\d|5[0-25-9])\\d{5}",,,,"2345678"],[,,"(?:22[89]|[78]\\d\\d)\\d{4}",,,,"7123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"5[34]\\d{5}",,,,"5345678"],"BN",673,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[2-578]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BO:[,[,,"8001\\d{5}|(?:[2-467]\\d|50)\\d{6}",,,,,,,[8,9],[7]],[,,"(?:2(?:2\\d\\d|5(?:11|[258]\\d|9[67])|6(?:12|2\\d|9[34])|8(?:2[34]|39|62))|3(?:3\\d\\d|4(?:6\\d|8[24])|8(?:25|42|5[257]|86|9[25])|9(?:[27]\\d|3[2-4]|4[248]|5[24]|6[2-6]))|4(?:4\\d\\d|6(?:11|[24689]\\d|72)))\\d{4}",,,,"22123456",,,[8],[7]],[,,"[67]\\d{7}",,,,"71234567",,,[8]],[,,"8001[07]\\d{4}",,,,"800171234",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"50\\d{6}",,,,"50123456",,,[8],[7]],"BO",591,"00(?:1\\d)?","0",,,"0(1\\d)?",,,,[[,"(\\d)(\\d{7})","$1 $2",["[235]|4[46]"],,"0$CC $1"],[,"(\\d{8})","$1",["[67]"],,"0$CC $1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["8"],,"0$CC $1"]],,[,,,,,,,,,[-1]],,,[,,"8001[07]\\d{4}",,,,,,,[9]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BQ:[,[,,"(?:[34]1|7\\d)\\d{5}",,,,,,,[7]],[,,"(?:318[023]|41(?:6[023]|70)|7(?:1[578]|2[05]|50)\\d)\\d{3}",,,,"7151234"],[,,"(?:31(?:8[14-8]|9[14578])|416[14-9]|7(?:0[01]|7[07]|8\\d|9[056])\\d)\\d{3}",,,,"3181234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BQ",599,"00",,,,,,,,,,[,,,,,,,,,[-1]],,"[347]",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BR:[,[,,"(?:[1-46-9]\\d\\d|5(?:[0-46-9]\\d|5[0-46-9]))\\d{8}|[1-9]\\d{9}|[3589]\\d{8}|[34]\\d{7}",,,,,,,[8,9,10,11]],[,,"(?:[14689][1-9]|2[12478]|3[1-578]|5[13-5]|7[13-579])[2-5]\\d{7}",,,,"1123456789",,,[10],[8]],[,,"(?:[14689][1-9]|2[12478]|3[1-578]|5[13-5]|7[13-579])(?:7|9\\d)\\d{7}",,,,"11961234567",,,[10,11],[8,9]],[,,"800\\d{6,7}",,,,"800123456",,,[9,10]],[,,"300\\d{6}|[59]00\\d{6,7}",,,,"300123456",,,[9,10]],[,,"(?:30[03]\\d{3}|4(?:0(?:0\\d|20)|370))\\d{4}|300\\d{5}",,,,"40041234",,,[8,10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BR",55,"00(?:1[245]|2[1-35]|31|4[13]|[56]5|99)","0",,,"(?:0|90)(?:(1[245]|2[1-35]|31|4[13]|[56]5|99)(\\d{10,11}))?","$2",,,[[,"(\\d{3,6})","$1",["1(?:1[25-8]|2[357-9]|3[02-68]|4[12568]|5|6[0-8]|8[015]|9[0-47-9])|321|610"]],[,"(\\d{4})(\\d{4})","$1-$2",["300|4(?:0[02]|37)","4(?:02|37)0|[34]00"]],[,"(\\d{4})(\\d{4})","$1-$2",["[2-57]","[2357]|4(?:[0-24-9]|3(?:[0-689]|7[1-9]))"]],[,"(\\d{3})(\\d{2,3})(\\d{4})","$1 $2 $3",["(?:[358]|90)0"],"0$1"],[,"(\\d{5})(\\d{4})","$1-$2",["9"]],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["(?:[14689][1-9]|2[12478]|3[1-578]|5[13-5]|7[13-579])[2-57]"],"($1)","0 $CC ($1)"],[,"(\\d{2})(\\d{5})(\\d{4})","$1 $2-$3",["[16][1-9]|[2-57-9]"],"($1)","0 $CC ($1)"]],[[,"(\\d{4})(\\d{4})","$1-$2",["300|4(?:0[02]|37)","4(?:02|37)0|[34]00"]],[,"(\\d{3})(\\d{2,3})(\\d{4})","$1 $2 $3",["(?:[358]|90)0"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["(?:[14689][1-9]|2[12478]|3[1-578]|5[13-5]|7[13-579])[2-57]"],"($1)","0 $CC ($1)"],[,"(\\d{2})(\\d{5})(\\d{4})","$1 $2-$3",["[16][1-9]|[2-57-9]"],"($1)","0 $CC ($1)"]],[,,,,,,,,,[-1]],,,[,,"30(?:0\\d{5,7}|3\\d{7})|40(?:0\\d|20)\\d{4}|800\\d{6,7}",,,,,,,[8,9,10]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BS:[,[,,"(?:242|[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"242(?:3(?:02|[236][1-9]|4[0-24-9]|5[0-68]|7[347]|8[0-4]|9[2-467])|461|502|6(?:0[1-5]|12|2[013]|[45]0|7[67]|8[78]|9[89])|7(?:02|88))\\d{4}",,,,"2423456789",,,,[7]],[,,"242(?:3(?:5[79]|7[56]|95)|4(?:[23][1-9]|4[1-35-9]|5[1-8]|6[2-8]|7\\d|81)|5(?:2[45]|3[35]|44|5[1-46-9]|65|77)|6[34]6|7(?:27|38)|8(?:0[1-9]|1[02-9]|2\\d|3[0-4]|[89]9))\\d{4}",,,,"2423591234",,,,[7]],[,,"242300\\d{4}|8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456",,,,[7]],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"BS",1,"011","1",,,"([3-8]\\d{6})$|1","242$1",,,,,[,,,,,,,,,[-1]],,"242",[,,,,,,,,,[-1]],[,,"242225\\d{4}",,,,"2422250123"],,,[,,,,,,,,,[-1]]],BT:[,[,,"[17]\\d{7}|[2-8]\\d{6}",,,,,,,[7,8],[6]],[,,"(?:2[3-6]|[34][5-7]|5[236]|6[2-46]|7[246]|8[2-4])\\d{5}",,,,"2345678",,,[7],[6]],[,,"(?:1[67]|77)\\d{6}",,,,"17123456",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BT",975,"00",,,,,,,,[[,"(\\d{3})(\\d{3})","$1 $2",["[2-7]"]],[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[2-68]|7[246]"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[67]|7"]]],[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[2-68]|7[246]"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[67]|7"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BW:[,[,,"(?:0800|(?:[37]|800)\\d)\\d{6}|(?:[2-6]\\d|90)\\d{5}",,,,,,,[7,8,10]],[,,"(?:2(?:4[0-48]|6[0-24]|9[0578])|3(?:1[0-35-9]|55|[69]\\d|7[013]|81)|4(?:6[03]|7[1267]|9[0-5])|5(?:3[03489]|4[0489]|7[1-47]|88|9[0-49])|6(?:2[1-35]|5[149]|8[013467]))\\d{4}",,,,"2401234",,,[7]],[,,"(?:321|7[1-8]\\d)\\d{5}",,,,"71123456",,,[8]],[,,"(?:0800|800\\d)\\d{6}",,,,"0800012345",,,[10]],[,,"90\\d{5}",,,,"9012345",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"79(?:1(?:[0-2]\\d|3[0-3])|2[0-7]\\d)\\d{3}",,,,"79101234",,,[8]],"BW",267,"00",,,,,,,,[[,"(\\d{2})(\\d{5})","$1 $2",["90"]],[,"(\\d{3})(\\d{4})","$1 $2",["[24-6]|3[15-9]"]],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[37]"]],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["0"]],[,"(\\d{3})(\\d{4})(\\d{3})","$1 $2 $3",["8"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BY:[,[,,"(?:[12]\\d|33|44|902)\\d{7}|8(?:0[0-79]\\d{5,7}|[1-7]\\d{9})|8(?:1[0-489]|[5-79]\\d)\\d{7}|8[1-79]\\d{6,7}|8[0-79]\\d{5}|8\\d{5}",,,,,,,[6,7,8,9,10,11],[5]],[,,"(?:1(?:5(?:1[1-5]|[24]\\d|6[2-4]|9[1-7])|6(?:[235]\\d|4[1-7])|7\\d\\d)|2(?:1(?:[246]\\d|3[0-35-9]|5[1-9])|2(?:[235]\\d|4[0-8])|3(?:[26]\\d|3[02-79]|4[024-7]|5[03-7])))\\d{5}",,,,"152450911",,,[9],[5,6,7]],[,,"(?:2(?:5[5-79]|9[1-9])|(?:33|44)\\d)\\d{6}",,,,"294911911",,,[9]],[,,"800\\d{3,7}|8(?:0[13]|20\\d)\\d{7}",,,,"8011234567"],[,,"(?:810|902)\\d{7}",,,,"9021234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"249\\d{6}",,,,"249123456",,,[9]],"BY",375,"810","8",,,"0|80?",,"8~10",,[[,"(\\d{3})(\\d{3})","$1 $2",["800"],"8 $1"],[,"(\\d{3})(\\d{2})(\\d{2,4})","$1 $2 $3",["800"],"8 $1"],[,"(\\d{4})(\\d{2})(\\d{3})","$1 $2-$3",["1(?:5[169]|6[3-5]|7[179])|2(?:1[35]|2[34]|3[3-5])","1(?:5[169]|6(?:3[1-3]|4|5[125])|7(?:1[3-9]|7[0-24-6]|9[2-7]))|2(?:1[35]|2[34]|3[3-5])"],"8 0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2-$3-$4",["1(?:[56]|7[467])|2[1-3]"],"8 0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[1-4]"],"8 0$1"],[,"(\\d{3})(\\d{3,4})(\\d{4})","$1 $2 $3",["[89]"],"8 $1"]],,[,,,,,,,,,[-1]],,,[,,"800\\d{3,7}|(?:8(?:0[13]|10|20\\d)|902)\\d{7}"],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],BZ:[,[,,"(?:0800\\d|[2-8])\\d{6}",,,,,,,[7,11]],[,,"(?:2(?:[02]\\d|36|[68]0)|[3-58](?:[02]\\d|[68]0)|7(?:[02]\\d|32|[68]0))\\d{4}",,,,"2221234",,,[7]],[,,"6[0-35-7]\\d{5}",,,,"6221234",,,[7]],[,,"0800\\d{7}",,,,"08001234123",,,[11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"BZ",501,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1-$2",["[2-8]"]],[,"(\\d)(\\d{3})(\\d{4})(\\d{3})","$1-$2-$3-$4",["0"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CA:[,[,,"[2-9]\\d{9}|3\\d{6}",,,,,,,[7,10]],[,,"(?:2(?:04|[23]6|[48]9|50|63)|3(?:06|43|54|6[578]|82)|4(?:03|1[68]|[26]8|3[178]|50|74)|5(?:06|1[49]|48|79|8[147])|6(?:04|[18]3|39|47|72)|7(?:0[59]|42|53|78|8[02])|8(?:[06]7|19|25|7[39])|9(?:0[25]|42))[2-9]\\d{6}",,,,"5062345678",,,[10],[7]],[,,"(?:2(?:04|[23]6|[48]9|50|63)|3(?:06|43|54|6[578]|82)|4(?:03|1[68]|[26]8|3[178]|50|74)|5(?:06|1[49]|48|79|8[147])|6(?:04|[18]3|39|47|72)|7(?:0[59]|42|53|78|8[02])|8(?:[06]7|19|25|7[39])|9(?:0[25]|42))[2-9]\\d{6}",,,,"5062345678",,,[10],[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456",,,[10]],[,,"900[2-9]\\d{6}",,,,"9002123456",,,[10]],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|(?:5(?:2[125-9]|33|44|66|77|88)|6(?:22|33))[2-9]\\d{6}",,,,"5219023456",,,[10]],[,,"600[2-9]\\d{6}",,,,"6002012345",,,[10]],"CA",1,"011","1",,,"1",,,1,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"310\\d{4}",,,,"3101234",,,[7]],,,[,,,,,,,,,[-1]]],CC:[,[,,"1(?:[0-79]\\d{8}(?:\\d{2})?|8[0-24-9]\\d{7})|[148]\\d{8}|1\\d{5,7}",,,,,,,[6,7,8,9,10,12]],[,,"8(?:51(?:0(?:02|31|60|89)|1(?:18|76)|223)|91(?:0(?:1[0-2]|29)|1(?:[28]2|50|79)|2(?:10|64)|3(?:[06]8|22)|4[29]8|62\\d|70[23]|959))\\d{3}",,,,"891621234",,,[9],[8]],[,,"4(?:79[01]|83[0-389]|94[0-4])\\d{5}|4(?:[0-36]\\d|4[047-9]|5[0-25-9]|7[02-8]|8[0-24-9]|9[0-37-9])\\d{6}",,,,"412345678",,,[9]],[,,"180(?:0\\d{3}|2)\\d{3}",,,,"1800123456",,,[7,10]],[,,"190[0-26]\\d{6}",,,,"1900123456",,,[10]],[,,"13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",,,,"1300123456",,,[6,8,10,12]],[,,,,,,,,,[-1]],[,,"14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",,,,"147101234",,,[9]],"CC",61,"001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","0",,,"([59]\\d{7})$|0","8$1","0011",,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CD:[,[,,"(?:(?:[189]|5\\d)\\d|2)\\d{7}|[1-68]\\d{6}",,,,,,,[7,8,9,10]],[,,"(?:(?:12|573)\\d\\d|276)\\d{5}|[1-6]\\d{6}",,,,"1234567"],[,,"88\\d{5}|(?:8[0-69]|9[017-9])\\d{7}",,,,"991234567",,,[7,9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CD",243,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["88"],"0$1"],[,"(\\d{2})(\\d{5})","$1 $2",["[1-6]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["2"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[89]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["5"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CF:[,[,,"(?:[27]\\d{3}|8776)\\d{4}",,,,,,,[8]],[,,"2[12]\\d{6}",,,,"21612345"],[,,"7[024-7]\\d{6}",,,,"70012345"],[,,,,,,,,,[-1]],[,,"8776\\d{4}",,,,"87761234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CF",236,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[278]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CG:[,[,,"222\\d{6}|(?:0\\d|80)\\d{7}",,,,,,,[9]],[,,"222[1-589]\\d{5}",,,,"222123456"],[,,"026(?:1[0-5]|6[6-9])\\d{4}|0(?:[14-6]\\d\\d|2(?:40|5[5-8]|6[07-9]))\\d{5}",,,,"061234567"],[,,,,,,,,,[-1]],[,,"80[0-2]\\d{6}",,,,"800123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CG",242,"00",,,,,,,,[[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["8"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[02]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CH:[,[,,"8\\d{11}|[2-9]\\d{8}",,,,,,,[9,12]],[,,"(?:2[12467]|3[1-4]|4[134]|5[256]|6[12]|[7-9]1)\\d{7}",,,,"212345678",,,[9]],[,,"(?:6[89]|7[235-9])\\d{7}",,,,"781234567",,,[9]],[,,"800\\d{6}",,,,"800123456",,,[9]],[,,"90[016]\\d{6}",,,,"900123456",,,[9]],[,,"84[0248]\\d{6}",,,,"840123456",,,[9]],[,,"878\\d{6}",,,,"878123456",,,[9]],[,,,,,,,,,[-1]],"CH",41,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8[047]|90"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-79]|81"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["8"],"0$1"]],,[,,"74[0248]\\d{6}",,,,"740123456",,,[9]],,,[,,,,,,,,,[-1]],[,,"5[18]\\d{7}",,,,"581234567",,,[9]],,,[,,"860\\d{9}",,,,"860123456789",,,[12]]],CI:[,[,,"[02]\\d{9}",,,,,,,[10]],[,,"2(?:[15]\\d{3}|7(?:2(?:0[23]|1[2357]|2[245]|3[45]|4[3-5])|3(?:06|1[69]|[2-6]7)))\\d{5}",,,,"2123456789"],[,,"0[157]\\d{8}",,,,"0123456789"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CI",225,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d)(\\d{5})","$1 $2 $3 $4",["2"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3 $4",["0"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CK:[,[,,"[2-578]\\d{4}",,,,,,,[5]],[,,"(?:2\\d|3[13-7]|4[1-5])\\d{3}",,,,"21234"],[,,"[578]\\d{4}",,,,"71234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CK",682,"00",,,,,,,,[[,"(\\d{2})(\\d{3})","$1 $2",["[2-578]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CL:[,[,,"12300\\d{6}|6\\d{9,10}|[2-9]\\d{8}",,,,,,,[9,10,11]],[,,"2(?:1982[0-6]|3314[05-9])\\d{3}|(?:2(?:1(?:160|962)|3(?:2\\d\\d|3(?:[03467]\\d|1[0-35-9]|2[1-9]|5[0-24-9]|8[0-3])|600)|646[59])|80[1-9]\\d\\d|9(?:3(?:[0-57-9]\\d\\d|6(?:0[02-9]|[1-9]\\d))|6(?:[0-8]\\d\\d|9(?:[02-79]\\d|1[05-9]))|7[1-9]\\d\\d|9(?:[03-9]\\d\\d|1(?:[0235-9]\\d|4[0-24-9])|2(?:[0-79]\\d|8[0-46-9]))))\\d{4}|(?:22|3[2-5]|[47][1-35]|5[1-3578]|6[13-57]|8[1-9]|9[2458])\\d{7}",,,,"221234567",,,[9]],[,,"2(?:1982[0-6]|3314[05-9])\\d{3}|(?:2(?:1(?:160|962)|3(?:2\\d\\d|3(?:[03467]\\d|1[0-35-9]|2[1-9]|5[0-24-9]|8[0-3])|600)|646[59])|80[1-9]\\d\\d|9(?:3(?:[0-57-9]\\d\\d|6(?:0[02-9]|[1-9]\\d))|6(?:[0-8]\\d\\d|9(?:[02-79]\\d|1[05-9]))|7[1-9]\\d\\d|9(?:[03-9]\\d\\d|1(?:[0235-9]\\d|4[0-24-9])|2(?:[0-79]\\d|8[0-46-9]))))\\d{4}|(?:22|3[2-5]|[47][1-35]|5[1-3578]|6[13-57]|8[1-9]|9[2458])\\d{7}",,,,"221234567",,,[9]],[,,"(?:123|8)00\\d{6}",,,,"800123456",,,[9,11]],[,,,,,,,,,[-1]],[,,"600\\d{7,8}",,,,"6001234567",,,[10,11]],[,,,,,,,,,[-1]],[,,"44\\d{7}",,,,"441234567",,,[9]],"CL",56,"(?:0|1(?:1[0-69]|2[02-5]|5[13-58]|69|7[0167]|8[018]))0",,,,,,,1,[[,"(\\d{4})","$1",["1(?:[03-589]|21)|[29]0|78"]],[,"(\\d{5})(\\d{4})","$1 $2",["219","2196"],"($1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["44"]],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2[1-36]"],"($1)"],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["9[2-9]"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["3[2-5]|[47]|5[1-3578]|6[13-57]|8(?:0[1-9]|[1-9])"],"($1)"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["60|8"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]],[,"(\\d{3})(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3 $4",["60"]]],[[,"(\\d{5})(\\d{4})","$1 $2",["219","2196"],"($1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["44"]],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2[1-36]"],"($1)"],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["9[2-9]"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["3[2-5]|[47]|5[1-3578]|6[13-57]|8(?:0[1-9]|[1-9])"],"($1)"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["60|8"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]],[,"(\\d{3})(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3 $4",["60"]]],[,,,,,,,,,[-1]],,,[,,"600\\d{7,8}",,,,,,,[10,11]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CM:[,[,,"[26]\\d{8}|88\\d{6,7}",,,,,,,[8,9]],[,,"2(?:22|33)\\d{6}",,,,"222123456",,,[9]],[,,"(?:24[23]|6(?:[25-9]\\d|40))\\d{6}",,,,"671234567",,,[9]],[,,"88\\d{6,7}",,,,"88012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CM",237,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["88"]],[,"(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[26]|88"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CN:[,[,,"(?:(?:1[03-689]|2\\d)\\d\\d|6)\\d{8}|1\\d{10}|[126]\\d{6}(?:\\d(?:\\d{2})?)?|86\\d{5,6}|(?:[3-579]\\d|8[0-57-9])\\d{5,9}",,,,,,,[7,8,9,10,11,12],[5,6]],[,,"(?:10(?:[02-79]\\d\\d|[18](?:0[1-9]|[1-9]\\d))|2(?:[02-57-9]\\d{3}|1(?:[18](?:0[1-9]|[1-9]\\d)|[2-79]\\d\\d))|(?:41[03]|8078|9(?:78|94))\\d\\d)\\d{5}|(?:10|2[0-57-9])(?:1(?:00|23)\\d\\d|95\\d{3,4})|(?:41[03]|9(?:78|94))(?:100\\d\\d|95\\d{3,4})|8078123|(?:43[35]|754|851)\\d{7,8}|(?:43[35]|754|851)(?:1(?:00\\d|23)\\d|95\\d{3,4})|(?:3(?:11|7[179])|4(?:[15]1|3[12])|5(?:1\\d|2[37]|3[12]|51|7[13-79]|9[15])|7(?:[39]1|5[57]|6[09])|8(?:71|98))(?:[02-8]\\d{7}|1(?:0(?:0\\d\\d(?:\\d{3})?|[1-9]\\d{5})|[13-9]\\d{6}|2(?:[0-24-9]\\d{5}|3\\d(?:\\d{4})?))|9(?:[0-46-9]\\d{6}|5\\d{3}(?:\\d(?:\\d{2})?)?))|(?:3(?:1[02-9]|35|49|5\\d|7[02-68]|9[1-68])|4(?:1[24-9]|2[179]|3[46-9]|5[2-9]|6[47-9]|7\\d|8[23])|5(?:3[03-9]|4[36]|5[02-9]|6[1-46]|7[028]|80|9[2-46-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[17]\\d|2[248]|3[04-9]|4[3-6]|5[0-3689]|6[2368]|9[02-9])|8(?:1[236-8]|2[5-7]|3\\d|5[2-9]|7[02-9]|8[36-8]|9[1-7])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))(?:[02-8]\\d{6}|1(?:0(?:0\\d\\d(?:\\d{2})?|[1-9]\\d{4})|[13-9]\\d{5}|2(?:[0-24-9]\\d{4}|3\\d(?:\\d{3})?))|9(?:[0-46-9]\\d{5}|5\\d{3,5}))",,,,"1012345678",,,[7,8,9,10,11],[5,6]],[,,"1740[0-5]\\d{6}|1(?:[38]\\d|4[57]|[59][0-35-9]|6[25-7]|7[0-35-8])\\d{8}",,,,"13123456789",,,[11]],[,,"(?:(?:10|21)8|8)00\\d{7}",,,,"8001234567",,,[10,12]],[,,"16[08]\\d{5}",,,,"16812345",,,[8]],[,,"10(?:10\\d{4}|96\\d{3,4})|400\\d{7}|950\\d{7,8}|(?:2[0-57-9]|3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))96\\d{3,4}",,,,"4001234567",,,[7,8,9,10,11],[5,6]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CN",86,"00|1(?:[12]\\d|79)\\d\\d00","0",,,"(1(?:[12]\\d|79)\\d\\d)|0",,"00",,[[,"(\\d{5,6})","$1",["1(?:00|2[13])|9[56]","1(?:00|2(?:1|39))|9[56]","1(?:00|2(?:1|395))|9[56]"]],[,"(\\d{5,6})","$1",["1(?:0|23)|781|[1-9]12","1(?:0|23)|7812|[1-9]123","1(?:0|23(?:[0-8]|9[0-46-9]))|78123|[1-9]123"]],[,"(\\d{2})(\\d{5,6})","$1 $2",["(?:10|2[0-57-9])[19]|3(?:[157]|35|49|9[1-68])|4(?:1[124-9]|2[179]|6[47-9]|7|8[23])|5(?:[1357]|2[37]|4[36]|6[1-46]|80)|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:07|1[236-8]|2[5-7]|[37]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3|4[13]|5[1-5]|7[0-79]|9[0-35-9])|(?:4[35]|59|85)[1-9]","(?:10|2[0-57-9])(?:1[02]|9[56])|8078|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))1","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|80781|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))12","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|807812|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))123","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:078|1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))123"],"0$1","$CC $1"],[,"(\\d{3})(\\d{4})","$1 $2",["[1-9]","1[1-9]|26|[3-9]|(?:10|2[0-57-9])(?:[0-8]|9[0-47-9])","1(?:0(?:[02-8]|1(?:[013-9]|2[0-24-9])|9[0-47-9])|[1-9])|2(?:[0-57-9](?:[02-8]|1(?:0[1-9]|[13-9]|2[0-24-9])|9[0-47-9])|6)|[3-9]","1(?:0(?:[02-8]|1(?:[013-9]|2[0-24-9])|9[0-47-9])|[1-9])|2(?:[0-57-9](?:[02-8]|1(?:0[1-9]|[13-9]|2[0-24-9])|9[0-47-9])|6)|3(?:[0268]|3[0-46-9]|4[0-8]|9[079])|4(?:[049]|1[03]|2[02-68]|[35]0|6[0-356]|8[014-9])|5(?:0|2[0-24-689]|4[0-2457-9]|6[057-9]|8[1-9]|90)|6(?:[0-24578]|3[06-9]|6[14-79]|9[03-9])|7(?:0[02-9]|2[0135-79]|3[23]|4[0-27-9]|6[1457]|8)|8(?:[046]|1[01459]|2[0-489]|50|8[0-2459]|9[09])|9(?:0[0457]|1[08]|[268]|4[024-9]|5[06-9]|78|94)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))(?:[02-9]|1(?:[013-9]|2[0-24-9]))","1(?:0(?:[02-8]|1(?:[013-9]|2[0-24-9])|9[0-47-9])|[1-9])|2(?:[0-57-9](?:[02-8]|1(?:0[1-9]|[13-9]|2[0-24-9])|9[0-47-9])|6)|3(?:[0268]|3[0-46-9]|4[0-8]|9[079])|4(?:[049]|1[03]|2[02-68]|[35]0|6[0-356]|8[014-9])|5(?:0|2[0-24-689]|4[0-2457-9]|6[057-9]|8[1-9]|90)|6(?:[0-24578]|3[06-9]|6[14-79]|9[03-9])|7(?:0[02-9]|2[0135-79]|3[23]|4[0-27-9]|6[1457]|8)|8(?:0(?:[0-689]|7[0-79])|1[01459]|2[0-489]|[46]|50|8[0-2459]|9[09])|9(?:0[0457]|1[08]|[268]|4[024-9]|5[06-9]|78|94)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:078|1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))(?:[02-9]|1(?:[013-9]|2[0-24-9]))"]],[,"(\\d{4})(\\d{4})","$1 $2",["16[08]"]],[,"(\\d{3})(\\d{5,6})","$1 $2",["3(?:[157]|35|49|9[1-68])|4(?:[17]|2[179]|6[47-9]|8[23])|5(?:[1357]|2[37]|4[36]|6[1-46]|80)|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])|(?:4[35]|59|85)[1-9]","(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))[19]","85[23](?:10|95)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:10|9[56])","85[23](?:100|95)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:100|9[56])"],"0$1","$CC $1"],[,"(\\d{4})(\\d{4})","$1 $2",["[1-9]","1(?:0(?:[02-8]|1[1-9]|9[0-47-9])|[1-9])|2(?:[0-57-9](?:[0-8]|9[0-47-9])|6)|[3-9]","1(?:0(?:[02-8]|1[1-9]|9[0-47-9])|[1-9])|26|3(?:[0268]|4[0-8]|9[079])|4(?:[049]|2[02-68]|[35]0|6[0-356]|8[014-9])|5(?:0|2[0-24-689]|4[0-2457-9]|6[057-9]|8[1-9]|90)|6(?:[0-24578]|3[06-9]|6[14-79]|9[03-9])|7(?:0[02-9]|2[0135-79]|3[23]|4[0-27-9]|6[1457]|8)|8(?:[046]|1[01459]|2[0-489]|5(?:0|[23][0-8])|8[0-2459]|9[09])|9(?:0[0457]|1[08]|[268]|4[024-9]|5[06-9])|(?:33|85[23]9)[0-46-9]|(?:2[0-57-9]|3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:[0-8]|9[0-47-9])","1(?:0[02-8]|[1-9])|2(?:[0-57-9][0-8]|6)|3(?:[0268]|3[0-46-9]|4[0-8]|9[079])|4(?:[049]|2[02-68]|[35]0|6[0-356]|8[014-9])|5(?:0|2[0-24-689]|4[0-2457-9]|6[057-9]|90)|6(?:[0-24578]|3[06-9]|6[14-79]|9[03-9])|7(?:0[02-9]|2[0135-79]|3[23]|4[0-27-9]|6[1457]|8)|8(?:[046]|1[01459]|2[0-489]|5(?:0|[23](?:[02-8]|1[1-9]|9[0-46-9]))|8[0-2459]|9[09])|9(?:0[0457]|1[08]|[268]|4[024-9]|5[06-9])|(?:10|2[0-57-9])9[0-47-9]|(?:101|58|85[23]10)[1-9]|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:[02-8]|1(?:0[1-9]|[1-9])|9[0-47-9])"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["(?:4|80)0"]],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["10|2(?:[02-57-9]|1[1-9])","10|2(?:[02-57-9]|1[1-9])","10[0-79]|2(?:[02-57-9]|1[1-79])|(?:10|21)8(?:0[1-9]|[1-9])"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["3(?:[3-59]|7[02-68])|4(?:[26-8]|3[3-9]|5[2-9])|5(?:3[03-9]|[468]|7[028]|9[2-46-9])|6|7(?:[0-247]|3[04-9]|5[0-4689]|6[2368])|8(?:[1-358]|9[1-7])|9(?:[013479]|5[1-5])|(?:[34]1|55|79|87)[02-9]"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{7,8})","$1 $2",["9"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["80"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["[3-578]"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["1[3-9]"],,"$CC $1"],[,"(\\d{2})(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3 $4",["[12]"],"0$1",,1]],[[,"(\\d{2})(\\d{5,6})","$1 $2",["(?:10|2[0-57-9])[19]|3(?:[157]|35|49|9[1-68])|4(?:1[124-9]|2[179]|6[47-9]|7|8[23])|5(?:[1357]|2[37]|4[36]|6[1-46]|80)|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:07|1[236-8]|2[5-7]|[37]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3|4[13]|5[1-5]|7[0-79]|9[0-35-9])|(?:4[35]|59|85)[1-9]","(?:10|2[0-57-9])(?:1[02]|9[56])|8078|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))1","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|80781|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))12","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|807812|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))123","10(?:1(?:0|23)|9[56])|2[0-57-9](?:1(?:00|23)|9[56])|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:1[124-9]|2[179]|[35][1-9]|6[47-9]|7\\d|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:078|1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|3\\d|4[13]|5[1-5]|7[0-79]|9[0-35-9]))123"],"0$1","$CC $1"],[,"(\\d{3})(\\d{5,6})","$1 $2",["3(?:[157]|35|49|9[1-68])|4(?:[17]|2[179]|6[47-9]|8[23])|5(?:[1357]|2[37]|4[36]|6[1-46]|80)|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])|(?:4[35]|59|85)[1-9]","(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))[19]","85[23](?:10|95)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:10|9[56])","85[23](?:100|95)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:100|9[56])"],"0$1","$CC $1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["(?:4|80)0"]],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["10|2(?:[02-57-9]|1[1-9])","10|2(?:[02-57-9]|1[1-9])","10[0-79]|2(?:[02-57-9]|1[1-79])|(?:10|21)8(?:0[1-9]|[1-9])"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["3(?:[3-59]|7[02-68])|4(?:[26-8]|3[3-9]|5[2-9])|5(?:3[03-9]|[468]|7[028]|9[2-46-9])|6|7(?:[0-247]|3[04-9]|5[0-4689]|6[2368])|8(?:[1-358]|9[1-7])|9(?:[013479]|5[1-5])|(?:[34]1|55|79|87)[02-9]"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{7,8})","$1 $2",["9"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["80"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["[3-578]"],"0$1","$CC $1",1],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["1[3-9]"],,"$CC $1"],[,"(\\d{2})(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3 $4",["[12]"],"0$1",,1]],[,,,,,,,,,[-1]],,,[,,"(?:(?:10|21)8|[48])00\\d{7}|950\\d{7,8}",,,,,,,[10,11,12]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CO:[,[,,"(?:46|60\\d\\d)\\d{6}|(?:1\\d|[39])\\d{9}",,,,,,,[8,10,11],[4,7]],[,,"601055(?:[0-4]\\d|50)\\d\\d|6010(?:[0-4]\\d|5[0-4])\\d{4}|(?:46|60(?:[124-7][2-9]|8[1-9]))\\d{6}",,,,"6012345678",,,[8,10],[4,7]],[,,"333301[0-5]\\d{3}|3333(?:00|2[5-9]|[3-9]\\d)\\d{4}|(?:3(?:24[1-9]|3(?:00|3[0-24-9]))|9101)\\d{6}|3(?:0[0-5]|1\\d|2[0-3]|5[01]|70)\\d{7}",,,,"3211234567",,,[10]],[,,"1800\\d{7}",,,,"18001234567",,,[11]],[,,"(?:19(?:0[01]|4[78])|901)\\d{7}",,,,"19001234567",,,[10,11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CO",57,"00(?:4(?:[14]4|56)|[579])","0",,,"0([3579]|4(?:[14]4|56))?",,,,[[,"(\\d{4})(\\d{4})","$1 $2",["46"]],[,"(\\d{3})(\\d{7})","$1 $2",["6|90"],"($1)","0$CC $1"],[,"(\\d{3})(\\d{7})","$1 $2",["3[0-357]|91"],,"0$CC $1"],[,"(\\d)(\\d{3})(\\d{7})","$1-$2-$3",["1"],"0$1"]],[[,"(\\d{4})(\\d{4})","$1 $2",["46"]],[,"(\\d{3})(\\d{7})","$1 $2",["6|90"],"($1)","0$CC $1"],[,"(\\d{3})(\\d{7})","$1 $2",["3[0-357]|91"],,"0$CC $1"],[,"(\\d)(\\d{3})(\\d{7})","$1 $2 $3",["1"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CR:[,[,,"(?:8\\d|90)\\d{8}|(?:[24-8]\\d{3}|3005)\\d{4}",,,,,,,[8,10]],[,,"210[7-9]\\d{4}|2(?:[024-7]\\d|1[1-9])\\d{5}",,,,"22123456",,,[8]],[,,"(?:3005\\d|6500[01])\\d{3}|(?:5[07]|6[0-4]|7[0-3]|8[3-9])\\d{6}",,,,"83123456",,,[8]],[,,"800\\d{7}",,,,"8001234567",,,[10]],[,,"90[059]\\d{7}",,,,"9001234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:210[0-6]|4\\d{3}|5100)\\d{4}",,,,"40001234",,,[8]],"CR",506,"00",,,,"(19(?:0[0-2468]|1[09]|20|66|77|99))",,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[2-7]|8[3-9]"],,"$CC $1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[89]"],,"$CC $1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CU:[,[,,"(?:[2-7]|8\\d\\d)\\d{7}|[2-47]\\d{6}|[34]\\d{5}",,,,,,,[6,7,8,10],[4,5]],[,,"(?:3[23]|4[89])\\d{4,6}|(?:31|4[36]|8(?:0[25]|78)\\d)\\d{6}|(?:2[1-4]|4[1257]|7\\d)\\d{5,6}",,,,"71234567",,,,[4,5]],[,,"(?:5\\d|6[2-4])\\d{6}",,,,"51234567",,,[8]],[,,"800\\d{7}",,,,"8001234567",,,[10]],[,,,,,,,,,[-1]],[,,"807\\d{7}",,,,"8071234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CU",53,"119","0",,,"0",,,,[[,"(\\d{2})(\\d{4,6})","$1 $2",["2[1-4]|[34]"],"(0$1)"],[,"(\\d)(\\d{6,7})","$1 $2",["7"],"(0$1)"],[,"(\\d)(\\d{7})","$1 $2",["[56]"],"0$1"],[,"(\\d{3})(\\d{7})","$1 $2",["8"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CV:[,[,,"(?:[2-59]\\d\\d|800)\\d{4}",,,,,,,[7]],[,,"2(?:2[1-7]|3[0-8]|4[12]|5[1256]|6\\d|7[1-3]|8[1-5])\\d{4}",,,,"2211234"],[,,"(?:36|5[1-389]|9\\d)\\d{5}",,,,"9911234"],[,,"800\\d{4}",,,,"8001234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:3[3-5]|4[356])\\d{5}",,,,"3401234"],"CV",238,"0",,,,,,,,[[,"(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[2-589]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CW:[,[,,"(?:[34]1|60|(?:7|9\\d)\\d)\\d{5}",,,,,,,[7,8]],[,,"9(?:4(?:3[0-5]|4[14]|6\\d)|50\\d|7(?:2[014]|3[02-9]|4[4-9]|6[357]|77|8[7-9])|8(?:3[39]|[46]\\d|7[01]|8[57-9]))\\d{4}",,,,"94351234"],[,,"953[01]\\d{4}|9(?:5[12467]|6[5-9])\\d{5}",,,,"95181234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"60[0-2]\\d{4}",,,,"6001234",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"CW",599,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[3467]"]],[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["9[4-8]"]]],,[,,"955\\d{5}",,,,"95581234",,,[8]],1,"[69]",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CX:[,[,,"1(?:[0-79]\\d{8}(?:\\d{2})?|8[0-24-9]\\d{7})|[148]\\d{8}|1\\d{5,7}",,,,,,,[6,7,8,9,10,12]],[,,"8(?:51(?:0(?:01|30|59|88)|1(?:17|46|75)|2(?:22|35))|91(?:00[6-9]|1(?:[28]1|49|78)|2(?:09|63)|3(?:12|26|75)|4(?:56|97)|64\\d|7(?:0[01]|1[0-2])|958))\\d{3}",,,,"891641234",,,[9],[8]],[,,"4(?:79[01]|83[0-389]|94[0-4])\\d{5}|4(?:[0-36]\\d|4[047-9]|5[0-25-9]|7[02-8]|8[0-24-9]|9[0-37-9])\\d{6}",,,,"412345678",,,[9]],[,,"180(?:0\\d{3}|2)\\d{3}",,,,"1800123456",,,[7,10]],[,,"190[0-26]\\d{6}",,,,"1900123456",,,[10]],[,,"13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",,,,"1300123456",,,[6,8,10,12]],[,,,,,,,,,[-1]],[,,"14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",,,,"147101234",,,[9]],"CX",61,"001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","0",,,"([59]\\d{7})$|0","8$1","0011",,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],CY:[,[,,"(?:[279]\\d|[58]0)\\d{6}",,,,,,,[8]],[,,"2[2-6]\\d{6}",,,,"22345678"],[,,"9(?:10|[4-79]\\d)\\d{5}",,,,"96123456"],[,,"800\\d{5}",,,,"80001234"],[,,"90[09]\\d{5}",,,,"90012345"],[,,"80[1-9]\\d{5}",,,,"80112345"],[,,"700\\d{5}",,,,"70012345"],[,,,,,,,,,[-1]],"CY",357,"00",,,,,,,,[[,"(\\d{2})(\\d{6})","$1 $2",["[257-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"(?:50|77)\\d{6}",,,,"77123456"],,,[,,,,,,,,,[-1]]],CZ:[,[,,"(?:[2-578]\\d|60)\\d{7}|9\\d{8,11}",,,,,,,[9,10,11,12]],[,,"(?:2\\d|3[1257-9]|4[16-9]|5[13-9])\\d{7}",,,,"212345678",,,[9]],[,,"(?:60[1-8]\\d|7(?:0(?:[2-5]\\d|60)|19[01]|[2379]\\d\\d))\\d{5}",,,,"601123456",,,[9]],[,,"800\\d{6}",,,,"800123456",,,[9]],[,,"9(?:0[05689]|76)\\d{6}",,,,"900123456",,,[9]],[,,"8[134]\\d{7}",,,,"811234567",,,[9]],[,,"70[01]\\d{6}",,,,"700123456",,,[9]],[,,"9[17]0\\d{6}",,,,"910123456",,,[9]],"CZ",420,"00",,,,,,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[2-8]|9[015-7]"]],[,"(\\d{2})(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3 $4",["96"]],[,"(\\d{2})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]],[,"(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"9(?:5\\d|7[2-4])\\d{6}",,,,"972123456",,,[9]],,,[,,"9(?:3\\d{9}|6\\d{7,10})",,,,"93123456789"]],DE:[,[,,"[2579]\\d{5,14}|49(?:[34]0|69|8\\d)\\d\\d?|49(?:37|49|60|7[089]|9\\d)\\d{1,3}|49(?:2[024-9]|3[2-689]|7[1-7])\\d{1,8}|(?:1|[368]\\d|4[0-8])\\d{3,13}|49(?:[015]\\d|2[13]|31|[46][1-8])\\d{1,9}",,,,,,,[4,5,6,7,8,9,10,11,12,13,14,15],[2,3]],[,,"32\\d{9,11}|49[1-6]\\d{10}|322\\d{6}|49[0-7]\\d{3,9}|(?:[34]0|[68]9)\\d{3,13}|(?:2(?:0[1-689]|[1-3569]\\d|4[0-8]|7[1-7]|8[0-7])|3(?:[3569]\\d|4[0-79]|7[1-7]|8[1-8])|4(?:1[02-9]|[2-48]\\d|5[0-6]|6[0-8]|7[0-79])|5(?:0[2-8]|[124-6]\\d|[38][0-8]|[79][0-7])|6(?:0[02-9]|[1-358]\\d|[47][0-8]|6[1-9])|7(?:0[2-8]|1[1-9]|[27][0-7]|3\\d|[4-6][0-8]|8[0-5]|9[013-7])|8(?:0[2-9]|1[0-79]|2\\d|3[0-46-9]|4[0-6]|5[013-9]|6[1-8]|7[0-8]|8[0-24-6])|9(?:0[6-9]|[1-4]\\d|[589][0-7]|6[0-8]|7[0-467]))\\d{3,12}",,,,"30123456",,,[5,6,7,8,9,10,11,12,13,14,15],[2,3,4]],[,,"1(?:(?:5(?:[0-25-9]\\d\\d|310)|76\\d\\d)\\d{6}|6[023]\\d{7,8})|17\\d{8}",,,,"15123456789",,,[10,11]],[,,"800\\d{7,12}",,,,"8001234567890",,,[10,11,12,13,14,15]],[,,"(?:137[7-9]|900(?:[135]|9\\d))\\d{6}",,,,"9001234567",,,[10,11]],[,,"180\\d{5,11}|13(?:7[1-6]\\d\\d|8)\\d{4}",,,,"18012345",,,[7,8,9,10,11,12,13,14]],[,,"700\\d{8}",,,,"70012345678",,,[11]],[,,,,,,,,,[-1]],"DE",49,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3,13})","$1 $2",["3[02]|40|[68]9"],"0$1"],[,"(\\d{3})(\\d{3,12})","$1 $2",["2(?:0[1-389]|1[124]|2[18]|3[14])|3(?:[35-9][15]|4[015])|906|(?:2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1","2(?:0[1-389]|12[0-8])|3(?:[35-9][15]|4[015])|906|2(?:[13][14]|2[18])|(?:2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1"],"0$1"],[,"(\\d{4})(\\d{2,11})","$1 $2",["[24-6]|3(?:[3569][02-46-9]|4[2-4679]|7[2-467]|8[2-46-8])|70[2-8]|8(?:0[2-9]|[1-8])|90[7-9]|[79][1-9]","[24-6]|3(?:3(?:0[1-467]|2[127-9]|3[124578]|7[1257-9]|8[1256]|9[145])|4(?:2[135]|4[13578]|9[1346])|5(?:0[14]|2[1-3589]|6[1-4]|7[13468]|8[13568])|6(?:2[1-489]|3[124-6]|6[13]|7[12579]|8[1-356]|9[135])|7(?:2[1-7]|4[145]|6[1-5]|7[1-4])|8(?:21|3[1468]|6|7[1467]|8[136])|9(?:0[12479]|2[1358]|4[134679]|6[1-9]|7[136]|8[147]|9[1468]))|70[2-8]|8(?:0[2-9]|[1-8])|90[7-9]|[79][1-9]|3[68]4[1347]|3(?:47|60)[1356]|3(?:3[46]|46|5[49])[1246]|3[4579]3[1357]"],"0$1"],[,"(\\d{3})(\\d{4})","$1 $2",["138"],"0$1"],[,"(\\d{5})(\\d{2,10})","$1 $2",["3"],"0$1"],[,"(\\d{3})(\\d{5,11})","$1 $2",["181"],"0$1"],[,"(\\d{3})(\\d)(\\d{4,10})","$1 $2 $3",["1(?:3|80)|9"],"0$1"],[,"(\\d{3})(\\d{7,8})","$1 $2",["1[67]"],"0$1"],[,"(\\d{3})(\\d{7,12})","$1 $2",["8"],"0$1"],[,"(\\d{5})(\\d{6})","$1 $2",["185","1850","18500"],"0$1"],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["7"],"0$1"],[,"(\\d{4})(\\d{7})","$1 $2",["18[68]"],"0$1"],[,"(\\d{4})(\\d{7})","$1 $2",["15[1279]"],"0$1"],[,"(\\d{5})(\\d{6})","$1 $2",["15[03568]","15(?:[0568]|31)"],"0$1"],[,"(\\d{3})(\\d{8})","$1 $2",["18"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{7,8})","$1 $2 $3",["1(?:6[023]|7)"],"0$1"],[,"(\\d{4})(\\d{2})(\\d{7})","$1 $2 $3",["15[279]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{8})","$1 $2 $3",["15"],"0$1"]],,[,,"16(?:4\\d{1,10}|[89]\\d{1,11})",,,,"16412345",,,[4,5,6,7,8,9,10,11,12,13,14]],,,[,,,,,,,,,[-1]],[,,"18(?:1\\d{5,11}|[2-9]\\d{8})",,,,"18500123456",,,[8,9,10,11,12,13,14]],,,[,,"1(?:6(?:013|255|399)|7(?:(?:[015]1|[69]3)3|[2-4]55|[78]99))\\d{7,8}|15(?:(?:[03-68]00|113)\\d|2\\d55|7\\d99|9\\d33)\\d{7}",,,,"177991234567",,,[12,13]]],DJ:[,[,,"(?:2\\d|77)\\d{6}",,,,,,,[8]],[,,"2(?:1[2-5]|7[45])\\d{5}",,,,"21360003"],[,,"77\\d{6}",,,,"77831001"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"DJ",253,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[27]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],DK:[,[,,"[2-9]\\d{7}",,,,,,,[8]],[,,"(?:2(?:[0-59][1-9]|[6-8]\\d)|3(?:[0-3][1-9]|4[13]|5[1-58]|6[1347-9]|7\\d|8[1-8]|9[1-79])|4(?:[0-25][1-9]|[34][2-9]|6[13-579]|7[13579]|8[1-47]|9[127])|5(?:[0-36][1-9]|4[146-9]|5[3-57-9]|7[568]|8[1-358]|9[1-69])|6(?:[0135][1-9]|2[1-68]|4[2-8]|6[1689]|[78]\\d|9[15689])|7(?:[0-69][1-9]|7[3-9]|8[147])|8(?:[16-9][1-9]|2[1-58])|9(?:[1-47-9][1-9]|6\\d))\\d{5}",,,,"32123456"],[,,"(?:2[6-8]|37|6[78]|96)\\d{6}|(?:2[0-59]|3[0-689]|[457]\\d|6[0-69]|8[126-9]|9[1-47-9])[1-9]\\d{5}",,,,"34412345"],[,,"80\\d{6}",,,,"80123456"],[,,"90\\d{6}",,,,"90123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"DK",45,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],DM:[,[,,"(?:[58]\\d\\d|767|900)\\d{7}",,,,,,,[10],[7]],[,,"767(?:2(?:55|66)|4(?:2[01]|4[0-25-9])|50[0-4])\\d{4}",,,,"7674201234",,,,[7]],[,,"767(?:2(?:[2-4689]5|7[5-7])|31[5-7]|61[1-8]|70[1-6])\\d{4}",,,,"7672251234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"DM",1,"011","1",,,"([2-7]\\d{6})$|1","767$1",,,,,[,,,,,,,,,[-1]],,"767",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],DO:[,[,,"(?:[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"8(?:[04]9[2-9]\\d\\d|29(?:2(?:[0-59]\\d|6[04-9]|7[0-27]|8[0237-9])|3(?:[0-35-9]\\d|4[7-9])|[45]\\d\\d|6(?:[0-27-9]\\d|[3-5][1-9]|6[0135-8])|7(?:0[013-9]|[1-37]\\d|4[1-35689]|5[1-4689]|6[1-57-9]|8[1-79]|9[1-8])|8(?:0[146-9]|1[0-48]|[248]\\d|3[1-79]|5[01589]|6[013-68]|7[124-8]|9[0-8])|9(?:[0-24]\\d|3[02-46-9]|5[0-79]|60|7[0169]|8[57-9]|9[02-9])))\\d{4}",,,,"8092345678",,,,[7]],[,,"8[024]9[2-9]\\d{6}",,,,"8092345678",,,,[7]],[,,"8(?:00(?:14|[2-9]\\d)|(?:33|44|55|66|77|88)[2-9]\\d)\\d{5}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"DO",1,"011","1",,,"1",,,,,,[,,,,,,,,,[-1]],,"8001|8[024]9",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],DZ:[,[,,"(?:[1-4]|[5-79]\\d|80)\\d{7}",,,,,,,[8,9]],[,,"9619\\d{5}|(?:1\\d|2[013-79]|3[0-8]|4[013-689])\\d{6}",,,,"12345678"],[,,"(?:5(?:4[0-29]|5\\d|6[0-3])|6(?:[569]\\d|7[0-6])|7[7-9]\\d)\\d{6}",,,,"551234567",,,[9]],[,,"800\\d{6}",,,,"800123456",,,[9]],[,,"80[3-689]1\\d{5}",,,,"808123456",,,[9]],[,,"80[12]1\\d{5}",,,,"801123456",,,[9]],[,,,,,,,,,[-1]],[,,"98[23]\\d{6}",,,,"983123456",,,[9]],"DZ",213,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[1-4]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["9"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-8]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],EC:[,[,,"1\\d{9,10}|(?:[2-7]|9\\d)\\d{7}",,,,,,,[8,9,10,11],[7]],[,,"[2-7][2-7]\\d{6}",,,,"22123456",,,[8],[7]],[,,"964[0-2]\\d{5}|9(?:39|[57][89]|6[0-36-9]|[89]\\d)\\d{6}",,,,"991234567",,,[9]],[,,"1800\\d{7}|1[78]00\\d{6}",,,,"18001234567",,,[10,11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"[2-7]890\\d{4}",,,,"28901234",,,[8]],"EC",593,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{4})","$1-$2",["[2-7]"]],[,"(\\d)(\\d{3})(\\d{4})","$1 $2-$3",["[2-7]"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["9"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3,4})","$1 $2 $3",["1"]]],[[,"(\\d)(\\d{3})(\\d{4})","$1-$2-$3",["[2-7]"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["9"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3,4})","$1 $2 $3",["1"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],EE:[,[,,"8\\d{9}|[4578]\\d{7}|(?:[3-8]\\d|90)\\d{5}",,,,,,,[7,8,10]],[,,"(?:3[23589]|4[3-8]|6\\d|7[1-9]|88)\\d{5}",,,,"3212345",,,[7]],[,,"(?:5\\d{5}|8(?:1(?:0(?:0(?:00|[178]\\d)|[3-9]\\d\\d)|(?:1(?:0[2-6]|1\\d)|(?:2[0-59]|[3-79]\\d)\\d)\\d)|2(?:0(?:0(?:00|4\\d)|(?:19|[2-7]\\d)\\d)|(?:(?:[124-69]\\d|3[5-9])\\d|7(?:[0-79]\\d|8[13-9])|8(?:[2-6]\\d|7[01]))\\d)|[349]\\d{4}))\\d\\d|5(?:(?:[02]\\d|5[0-478])\\d|1(?:[0-8]\\d|95)|6(?:4[0-4]|5[1-589]))\\d{3}",,,,"51234567",,,[7,8]],[,,"800(?:(?:0\\d\\d|1)\\d|[2-9])\\d{3}",,,,"80012345"],[,,"(?:40\\d\\d|900)\\d{4}",,,,"9001234",,,[7,8]],[,,,,,,,,,[-1]],[,,"70[0-2]\\d{5}",,,,"70012345",,,[8]],[,,,,,,,,,[-1]],"EE",372,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[369]|4[3-8]|5(?:[0-2]|5[0-478]|6[45])|7[1-9]|88","[369]|4[3-8]|5(?:[02]|1(?:[0-8]|95)|5[0-478]|6(?:4[0-4]|5[1-589]))|7[1-9]|88"]],[,"(\\d{4})(\\d{3,4})","$1 $2",["[45]|8(?:00|[1-49])","[45]|8(?:00[1-9]|[1-49])"]],[,"(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["7"]],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["8"]]],,[,,,,,,,,,[-1]],,,[,,"800[2-9]\\d{3}",,,,,,,[7]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],EG:[,[,,"[189]\\d{8,9}|[24-6]\\d{8}|[135]\\d{7}",,,,,,,[8,9,10],[6,7]],[,,"13[23]\\d{6}|(?:15|57)\\d{6,7}|(?:2\\d|3|4[05-8]|5[05]|6[24-689]|8[2468]|9[235-7])\\d{7}",,,,"234567890",,,[8,9],[6,7]],[,,"1[0-25]\\d{8}",,,,"1001234567",,,[10]],[,,"800\\d{7}",,,,"8001234567",,,[10]],[,,"900\\d{7}",,,,"9001234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"EG",20,"00","0",,,"0",,,,[[,"(\\d)(\\d{7,8})","$1 $2",["[23]"],"0$1"],[,"(\\d{2})(\\d{6,7})","$1 $2",["1[35]|[4-6]|8[2468]|9[235-7]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],[,"(\\d{2})(\\d{8})","$1 $2",["1"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],EH:[,[,,"[5-8]\\d{8}",,,,,,,[9]],[,,"528[89]\\d{5}",,,,"528812345"],[,,"(?:6(?:[0-79]\\d|8[0-247-9])|7(?:[0167]\\d|2[0-4]|5[01]|8[0-3]))\\d{6}",,,,"650123456"],[,,"80[0-7]\\d{6}",,,,"801234567"],[,,"89\\d{7}",,,,"891234567"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:592(?:4[0-2]|93)|80[89]\\d\\d)\\d{4}",,,,"592401234"],"EH",212,"00","0",,,"0",,,,,,[,,,,,,,,,[-1]],,"528[89]",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],ER:[,[,,"[178]\\d{6}",,,,,,,[7],[6]],[,,"(?:1(?:1[12568]|[24]0|55|6[146])|8\\d\\d)\\d{4}",,,,"8370362",,,,[6]],[,,"(?:17[1-3]|7\\d\\d)\\d{4}",,,,"7123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"ER",291,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[178]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],ES:[,[,,"[5-9]\\d{8}",,,,,,,[9]],[,,"96906(?:0[0-8]|1[1-9]|[2-9]\\d)\\d\\d|9(?:69(?:0[0-57-9]|[1-9]\\d)|73(?:[0-8]\\d|9[1-9]))\\d{4}|(?:8(?:[1356]\\d|[28][0-8]|[47][1-9])|9(?:[135]\\d|[268][0-8]|4[1-9]|7[124-9]))\\d{6}",,,,"810123456"],[,,"(?:590[16]00\\d|9(?:6906(?:09|10)|7390\\d\\d))\\d\\d|(?:6\\d|7[1-48])\\d{7}",,,,"612345678"],[,,"[89]00\\d{6}",,,,"800123456"],[,,"80[367]\\d{6}",,,,"803123456"],[,,"90[12]\\d{6}",,,,"901123456"],[,,"70\\d{7}",,,,"701234567"],[,,,,,,,,,[-1]],"ES",34,"00",,,,,,,,[[,"(\\d{4})","$1",["905"]],[,"(\\d{6})","$1",["[79]9"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[89]00"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-9]"]]],[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[89]00"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-9]"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"51\\d{7}",,,,"511234567"],,,[,,,,,,,,,[-1]]],ET:[,[,,"(?:11|[2-579]\\d)\\d{7}",,,,,,,[9],[7]],[,,"11667[01]\\d{3}|(?:11(?:1(?:1[124]|2[2-7]|3[1-5]|5[5-8]|8[6-8])|2(?:13|3[6-8]|5[89]|7[05-9]|8[2-6])|3(?:2[01]|3[0-289]|4[1289]|7[1-4]|87)|4(?:1[69]|3[2-49]|4[0-3]|6[5-8]|7\\d)|5(?:1[578]|44|5[0-4])|6(?:1[578]|2[69]|39|4[5-7]|5[0-5]|6[0-59]|8[015-8]))|2(?:2(?:11[1-9]|22[0-7]|33\\d|44[1467]|66[1-68])|5(?:11[124-6]|33[2-8]|44[1467]|55[14]|66[1-3679]|77[124-79]|880))|3(?:3(?:11[0-46-8]|(?:22|55)[0-6]|33[0134689]|44[04]|66[01467])|4(?:44[0-8]|55[0-69]|66[0-3]|77[1-5]))|4(?:6(?:119|22[0-24-7]|33[1-5]|44[13-69]|55[14-689]|660|88[1-4])|7(?:(?:11|22)[1-9]|33[13-7]|44[13-6]|55[1-689]))|5(?:7(?:227|55[05]|(?:66|77)[14-8])|8(?:11[149]|22[013-79]|33[0-68]|44[013-8]|550|66[1-5]|77\\d)))\\d{4}",,,,"111112345",,,,[7]],[,,"700[1-9]\\d{5}|(?:7(?:0[1-9]|1[0-8]|22|77|86|99)|9\\d\\d)\\d{6}",,,,"911234567"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"ET",251,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-579]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],FI:[,[,,"[1-35689]\\d{4}|7\\d{10,11}|(?:[124-7]\\d|3[0-46-9])\\d{8}|[1-9]\\d{5,8}",,,,,,,[5,6,7,8,9,10,11,12]],[,,"1[3-7][1-8]\\d{3,6}|(?:19[1-8]|[23568][1-8]\\d|9(?:00|[1-8]\\d))\\d{2,6}",,,,"131234567",,,[5,6,7,8,9]],[,,"4946\\d{2,6}|(?:4[0-8]|50)\\d{4,8}",,,,"412345678",,,[6,7,8,9,10]],[,,"800\\d{4,6}",,,,"800123456",,,[7,8,9]],[,,"[67]00\\d{5,6}",,,,"600123456",,,[8,9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"FI",358,"00|99(?:[01469]|5(?:[14]1|3[23]|5[59]|77|88|9[09]))","0",,,"0",,"00",,[[,"(\\d{5})","$1",["75[12]"],"0$1"],[,"(\\d{5})","$1",["20[2-59]"],"0$1"],[,"(\\d{6})","$1",["11"]],[,"(\\d{3})(\\d{3,7})","$1 $2",["(?:[1-3]0|[68])0|70[07-9]"],"0$1"],[,"(\\d{2})(\\d{4,8})","$1 $2",["[14]|2[09]|50|7[135]"],"0$1"],[,"(\\d{2})(\\d{6,10})","$1 $2",["7"],"0$1"],[,"(\\d)(\\d{4,9})","$1 $2",["(?:19|[2568])[1-8]|3(?:0[1-9]|[1-9])|9"],"0$1"]],[[,"(\\d{5})","$1",["20[2-59]"],"0$1"],[,"(\\d{3})(\\d{3,7})","$1 $2",["(?:[1-3]0|[68])0|70[07-9]"],"0$1"],[,"(\\d{2})(\\d{4,8})","$1 $2",["[14]|2[09]|50|7[135]"],"0$1"],[,"(\\d{2})(\\d{6,10})","$1 $2",["7"],"0$1"],[,"(\\d)(\\d{4,9})","$1 $2",["(?:19|[2568])[1-8]|3(?:0[1-9]|[1-9])|9"],"0$1"]],[,,,,,,,,,[-1]],1,"1[03-79]|[2-9]",[,,"20(?:2[023]|9[89])\\d{1,6}|(?:60[12]\\d|7099)\\d{4,5}|(?:606|7(?:0[78]|1|3\\d))\\d{7}|(?:[1-3]00|7(?:0[1-5]\\d\\d|5[03-9]))\\d{3,7}"],[,,"20\\d{4,8}|60[12]\\d{5,6}|7(?:099\\d{4,5}|5[03-9]\\d{3,7})|20[2-59]\\d\\d|(?:606|7(?:0[78]|1|3\\d))\\d{7}|(?:10|29|3[09]|70[1-5]\\d)\\d{4,8}",,,,"10112345"],,,[,,,,,,,,,[-1]]],FJ:[,[,,"45\\d{5}|(?:0800\\d|[235-9])\\d{6}",,,,,,,[7,11]],[,,"603\\d{4}|(?:3[0-5]|6[25-7]|8[58])\\d{5}",,,,"3212345",,,[7]],[,,"(?:[279]\\d|45|5[01568]|8[034679])\\d{5}",,,,"7012345",,,[7]],[,,"0800\\d{7}",,,,"08001234567",,,[11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"FJ",679,"0(?:0|52)",,,,,,"00",,[[,"(\\d{3})(\\d{4})","$1 $2",["[235-9]|45"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["0"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],FK:[,[,,"[2-7]\\d{4}",,,,,,,[5]],[,,"[2-47]\\d{4}",,,,"31234"],[,,"[56]\\d{4}",,,,"51234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"FK",500,"00",,,,,,,,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],FM:[,[,,"(?:[39]\\d\\d|820)\\d{4}",,,,,,,[7]],[,,"31(?:00[67]|208|309)\\d\\d|(?:3(?:[2357]0[1-9]|602|804|905)|(?:820|9[2-6]\\d)\\d)\\d{3}",,,,"3201234"],[,,"31(?:00[67]|208|309)\\d\\d|(?:3(?:[2357]0[1-9]|602|804|905)|(?:820|9[2-7]\\d)\\d)\\d{3}",,,,"3501234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"FM",691,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[389]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],FO:[,[,,"[2-9]\\d{5}",,,,,,,[6]],[,,"(?:20|[34]\\d|8[19])\\d{4}",,,,"201234"],[,,"(?:[27][1-9]|5\\d|9[16])\\d{4}",,,,"211234"],[,,"80[257-9]\\d{3}",,,,"802123"],[,,"90(?:[13-5][15-7]|2[125-7]|9\\d)\\d\\d",,,,"901123"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:6[0-36]|88)\\d{4}",,,,"601234"],"FO",298,"00",,,,"(10(?:01|[12]0|88))",,,,[[,"(\\d{6})","$1",["[2-9]"],,"$CC $1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],FR:[,[,,"[1-9]\\d{8}",,,,,,,[9]],[,,"(?:26[013-9]|59[1-35-9])\\d{6}|(?:[13]\\d|2[0-57-9]|4[1-9]|5[0-8])\\d{7}",,,,"123456789"],[,,"(?:6(?:[0-24-8]\\d|3[0-8]|9[589])|7[3-9]\\d)\\d{6}",,,,"612345678"],[,,"80[0-5]\\d{6}",,,,"801234567"],[,,"836(?:0[0-36-9]|[1-9]\\d)\\d{4}|8(?:1[2-9]|2[2-47-9]|3[0-57-9]|[569]\\d|8[0-35-9])\\d{6}",,,,"891123456"],[,,"8(?:1[01]|2[0156]|4[024]|84)\\d{6}",,,,"884012345"],[,,,,,,,,,[-1]],[,,"9\\d{8}",,,,"912345678"],"FR",33,"00","0",,,"0",,,,[[,"(\\d{4})","$1",["10"]],[,"(\\d{3})(\\d{3})","$1 $2",["1"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0 $1"],[,"(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[1-79]"],"0$1"]],[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0 $1"],[,"(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[1-79]"],"0$1"]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"80[6-9]\\d{6}",,,,"806123456"],,,[,,,,,,,,,[-1]]],GA:[,[,,"(?:[067]\\d|11)\\d{6}|[2-7]\\d{6}",,,,,,,[7,8]],[,,"[01]1\\d{6}",,,,"01441234",,,[8]],[,,"(?:(?:0[2-7]|7[467])\\d|6(?:0[0-4]|10|[256]\\d))\\d{5}|[2-7]\\d{6}",,,,"06031234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"GA",241,"00",,,,"0(11\\d{6}|60\\d{6}|61\\d{6}|6[256]\\d{6}|7[467]\\d{6})","$1",,,[[,"(\\d)(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-7]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["0"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["11|[67]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GB:[,[,,"[1-357-9]\\d{9}|[18]\\d{8}|8\\d{6}",,,,,,,[7,9,10],[4,5,6,8]],[,,"(?:1(?:1(?:3(?:[0-58]\\d\\d|73[0-35])|4(?:(?:[0-5]\\d|70)\\d|69[7-9])|(?:(?:5[0-26-9]|[78][0-49])\\d|6(?:[0-4]\\d|50))\\d)|(?:2(?:(?:0[024-9]|2[3-9]|3[3-79]|4[1-689]|[58][02-9]|6[0-47-9]|7[013-9]|9\\d)\\d|1(?:[0-7]\\d|8[0-3]))|(?:3(?:0\\d|1[0-8]|[25][02-9]|3[02-579]|[468][0-46-9]|7[1-35-79]|9[2-578])|4(?:0[03-9]|[137]\\d|[28][02-57-9]|4[02-69]|5[0-8]|[69][0-79])|5(?:0[1-35-9]|[16]\\d|2[024-9]|3[015689]|4[02-9]|5[03-9]|7[0-35-9]|8[0-468]|9[0-57-9])|6(?:0[034689]|1\\d|2[0-35689]|[38][013-9]|4[1-467]|5[0-69]|6[13-9]|7[0-8]|9[0-24578])|7(?:0[0246-9]|2\\d|3[0236-8]|4[03-9]|5[0-46-9]|6[013-9]|7[0-35-9]|8[024-9]|9[02-9])|8(?:0[35-9]|2[1-57-9]|3[02-578]|4[0-578]|5[124-9]|6[2-69]|7\\d|8[02-9]|9[02569])|9(?:0[02-589]|[18]\\d|2[02-689]|3[1-57-9]|4[2-9]|5[0-579]|6[2-47-9]|7[0-24578]|9[2-57]))\\d)\\d)|2(?:0[013478]|3[0189]|4[017]|8[0-46-9]|9[0-2])\\d{3})\\d{4}|1(?:2(?:0(?:46[1-4]|87[2-9])|545[1-79]|76(?:2\\d|3[1-8]|6[1-6])|9(?:7(?:2[0-4]|3[2-5])|8(?:2[2-8]|7[0-47-9]|8[3-5])))|3(?:6(?:38[2-5]|47[23])|8(?:47[04-9]|64[0157-9]))|4(?:044[1-7]|20(?:2[23]|8\\d)|6(?:0(?:30|5[2-57]|6[1-8]|7[2-8])|140)|8(?:052|87[1-3]))|5(?:2(?:4(?:3[2-79]|6\\d)|76\\d)|6(?:26[06-9]|686))|6(?:06(?:4\\d|7[4-79])|295[5-7]|35[34]\\d|47(?:24|61)|59(?:5[08]|6[67]|74)|9(?:55[0-4]|77[23]))|7(?:26(?:6[13-9]|7[0-7])|(?:442|688)\\d|50(?:2[0-3]|[3-68]2|76))|8(?:27[56]\\d|37(?:5[2-5]|8[239])|843[2-58])|9(?:0(?:0(?:6[1-8]|85)|52\\d)|3583|4(?:66[1-8]|9(?:2[01]|81))|63(?:23|3[1-4])|9561))\\d{3}",,,,"1212345678",,,[9,10],[4,5,6,7,8]],[,,"7(?:457[0-57-9]|700[01]|911[028])\\d{5}|7(?:[1-3]\\d\\d|4(?:[0-46-9]\\d|5[0-689])|5(?:0[0-8]|[13-9]\\d|2[0-35-9])|7(?:0[1-9]|[1-7]\\d|8[02-9]|9[0-689])|8(?:[014-9]\\d|[23][0-8])|9(?:[024-9]\\d|1[02-9]|3[0-689]))\\d{6}",,,,"7400123456",,,[10]],[,,"80[08]\\d{7}|800\\d{6}|8001111",,,,"8001234567"],[,,"(?:8(?:4[2-5]|7[0-3])|9(?:[01]\\d|8[2-49]))\\d{7}|845464\\d",,,,"9012345678",,,[7,10]],[,,,,,,,,,[-1]],[,,"70\\d{8}",,,,"7012345678",,,[10]],[,,"56\\d{8}",,,,"5612345678",,,[10]],"GB",44,"00","0"," x",,"0",,,,[[,"(\\d{3})(\\d{4})","$1 $2",["800","8001","80011","800111","8001111"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["845","8454","84546","845464"],"0$1"],[,"(\\d{3})(\\d{6})","$1 $2",["800"],"0$1"],[,"(\\d{5})(\\d{4,5})","$1 $2",["1(?:38|5[23]|69|76|94)","1(?:(?:38|69)7|5(?:24|39)|768|946)","1(?:3873|5(?:242|39[4-6])|(?:697|768)[347]|9467)"],"0$1"],[,"(\\d{4})(\\d{5,6})","$1 $2",["1(?:[2-69][02-9]|[78])"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["[25]|7(?:0|6[02-9])","[25]|7(?:0|6(?:[03-9]|2[356]))"],"0$1"],[,"(\\d{4})(\\d{6})","$1 $2",["7"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[1389]"],"0$1"]],,[,,"76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}",,,,"7640123456",,,[10]],1,,[,,,,,,,,,[-1]],[,,"(?:3[0347]|55)\\d{8}",,,,"5512345678",,,[10]],,,[,,,,,,,,,[-1]]],GD:[,[,,"(?:473|[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"473(?:2(?:3[0-2]|69)|3(?:2[89]|86)|4(?:[06]8|3[5-9]|4[0-4]|5[579]|73|90)|63[68]|7(?:58|84)|800|938)\\d{4}",,,,"4732691234",,,,[7]],[,,"473(?:4(?:0[2-79]|1[04-9]|2[0-5]|49|5[68])|5(?:2[01]|3[3-8])|901)\\d{4}",,,,"4734031234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"GD",1,"011","1",,,"([2-9]\\d{6})$|1","473$1",,,,,[,,,,,,,,,[-1]],,"473",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GE:[,[,,"(?:[3-57]\\d\\d|800)\\d{6}",,,,,,,[9],[6,7]],[,,"(?:3(?:[256]\\d|4[124-9]|7[0-4])|4(?:1\\d|2[2-7]|3[1-79]|4[2-8]|7[239]|9[1-7]))\\d{6}",,,,"322123456",,,,[6,7]],[,,"5(?:(?:(?:0555|1(?:[17]77|555))[5-9]|757(?:7[7-9]|8[01]))\\d|22252[0-4])\\d\\d|5(?:0(?:0[17]0|505)|1(?:0[01]0|1(?:07|33|51))|2(?:0[02]0|2[25]2)|3(?:0[03]0|3[35]3)|(?:40[04]|900)0|5222)[0-4]\\d{3}|(?:5(?:0(?:0(?:0\\d|11|22|3[0-6]|44|5[05]|77|88|9[09])|(?:[14]\\d|77)\\d|22[02])|1(?:1(?:[03][01]|[124]\\d|5[2-6]|7[0-4])|4\\d\\d)|[23]555|4(?:4\\d\\d|555)|5(?:[0157-9]\\d\\d|200|333|444)|6[89]\\d\\d|7(?:[0147-9]\\d\\d|5(?:00|[57]5))|8(?:0(?:[018]\\d|2[0-4])|5(?:55|8[89])|8(?:55|88))|9(?:090|[1-35-9]\\d\\d))|790\\d\\d)\\d{4}",,,,"555123456"],[,,"800\\d{6}",,,,"800123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"70[67]\\d{6}",,,,"706123456"],"GE",995,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["70"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["32"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[57]"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[348]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,"70[67]\\d{6}"],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GF:[,[,,"(?:[56]94\\d|7093)\\d{5}|(?:80|9\\d)\\d{7}",,,,,,,[9]],[,,"594(?:[02-49]\\d|1[0-5]|5[6-9]|6[0-3]|80)\\d{4}",,,,"594101234"],[,,"(?:694(?:[0-249]\\d|3[0-8])|7093[0-3])\\d{4}",,,,"694201234"],[,,"80[0-5]\\d{6}",,,,"800012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9(?:(?:396|76\\d)\\d|476[0-5])\\d{4}",,,,"976012345"],"GF",594,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-7]|9[47]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[89]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GG:[,[,,"(?:1481|[357-9]\\d{3})\\d{6}|8\\d{6}(?:\\d{2})?",,,,,,,[7,9,10],[6]],[,,"1481[25-9]\\d{5}",,,,"1481256789",,,[10],[6]],[,,"7(?:(?:781|839)\\d|911[17])\\d{5}",,,,"7781123456",,,[10]],[,,"80[08]\\d{7}|800\\d{6}|8001111",,,,"8001234567"],[,,"(?:8(?:4[2-5]|7[0-3])|9(?:[01]\\d|8[0-3]))\\d{7}|845464\\d",,,,"9012345678",,,[7,10]],[,,,,,,,,,[-1]],[,,"70\\d{8}",,,,"7012345678",,,[10]],[,,"56\\d{8}",,,,"5612345678",,,[10]],"GG",44,"00","0",,,"([25-9]\\d{5})$|0","1481$1",,,,,[,,"76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}",,,,"7640123456",,,[10]],,,[,,,,,,,,,[-1]],[,,"(?:3[0347]|55)\\d{8}",,,,"5512345678",,,[10]],,,[,,,,,,,,,[-1]]],GH:[,[,,"(?:[235]\\d{3}|800)\\d{5}",,,,,,,[8,9],[7]],[,,"3082[0-5]\\d{4}|3(?:0(?:[237]\\d|8[01])|[167](?:2[0-6]|7\\d|80)|2(?:2[0-5]|7\\d|80)|3(?:2[0-3]|7\\d|80)|4(?:2[013-9]|3[01]|7\\d|80)|5(?:2[0-7]|7\\d|80)|8(?:2[0-2]|7\\d|80)|9(?:[28]0|7\\d))\\d{5}",,,,"302345678",,,[9],[7]],[,,"(?:2(?:[0346-9]\\d|5[67])|5(?:[03-7]\\d|9[1-9]))\\d{6}",,,,"231234567",,,[9]],[,,"800\\d{5}",,,,"80012345",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"GH",233,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[237]|8[0-2]"]],[,"(\\d{3})(\\d{5})","$1 $2",["8"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[235]"],"0$1"]],[[,"(\\d{3})(\\d{5})","$1 $2",["8"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[235]"],"0$1"]],[,,,,,,,,,[-1]],,,[,,"800\\d{5}",,,,,,,[8]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GI:[,[,,"(?:[25]\\d|60)\\d{6}",,,,,,,[8]],[,,"2190[0-2]\\d{3}|2(?:0(?:[02]\\d|3[01])|16[24-9]|2[2-5]\\d)\\d{4}",,,,"20012345"],[,,"5251[0-4]\\d{3}|(?:5(?:[146-8]\\d\\d|250)|60(?:1[01]|6\\d))\\d{4}",,,,"57123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"GI",350,"00",,,,,,,,[[,"(\\d{3})(\\d{5})","$1 $2",["2"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GL:[,[,,"(?:19|[2-689]\\d|70)\\d{4}",,,,,,,[6]],[,,"(?:19|3[1-7]|[68][1-9]|70|9\\d)\\d{4}",,,,"321000"],[,,"[245]\\d{5}",,,,"221234"],[,,"80\\d{4}",,,,"801234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"3[89]\\d{4}",,,,"381234"],"GL",299,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["19|[2-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GM:[,[,,"[2-9]\\d{6}",,,,,,,[7]],[,,"(?:4(?:[23]\\d\\d|4(?:1[024679]|[6-9]\\d))|5(?:5(?:3\\d|4[0-7])|6[67]\\d|7(?:1[04]|2[035]|3[58]|48))|8\\d{3})\\d{3}",,,,"5661234"],[,,"(?:[23679]\\d|4[015]|5[0-489])\\d{5}",,,,"3012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"GM",220,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GN:[,[,,"722\\d{6}|(?:3|6\\d)\\d{7}",,,,,,,[8,9]],[,,"3(?:0(?:24|3[12]|4[1-35-7]|5[13]|6[189]|[78]1|9[1478])|1\\d\\d)\\d{4}",,,,"30241234",,,[8]],[,,"6[0-356]\\d{7}",,,,"601123456",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"722\\d{6}",,,,"722123456",,,[9]],"GN",224,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["3"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[67]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GP:[,[,,"(?:590\\d|7090)\\d{5}|(?:69|80|9\\d)\\d{7}",,,,,,,[9]],[,,"590(?:0[1-68]|[14][0-24-9]|2[0-68]|3[1-9]|5[3-579]|[68][0-689]|7[08]|9\\d)\\d{4}",,,,"590201234"],[,,"(?:69(?:0\\d\\d|1(?:2[2-9]|3[0-5])|4(?:0[89]|1[2-6]|9\\d)|6(?:1[016-9]|5[0-4]|[67]\\d))|7090[0-4])\\d{4}",,,,"690001234"],[,,"80[0-5]\\d{6}",,,,"800012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9(?:(?:39[5-7]|76[018])\\d|475[0-5])\\d{4}",,,,"976012345"],"GP",590,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-79]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],,[,,,,,,,,,[-1]],1,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GQ:[,[,,"222\\d{6}|(?:3\\d|55|[89]0)\\d{7}",,,,,,,[9]],[,,"33[0-24-9]\\d[46]\\d{4}|3(?:33|5\\d)\\d[7-9]\\d{4}",,,,"333091234"],[,,"(?:222|55\\d)\\d{6}",,,,"222123456"],[,,"80\\d[1-9]\\d{5}",,,,"800123456"],[,,"90\\d[1-9]\\d{5}",,,,"900123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"GQ",240,"00",,,,,,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235]"]],[,"(\\d{3})(\\d{6})","$1 $2",["[89]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GR:[,[,,"5005000\\d{3}|8\\d{9,11}|(?:[269]\\d|70)\\d{8}",,,,,,,[10,11,12]],[,,"2(?:1\\d\\d|2(?:2[1-46-9]|[36][1-8]|4[1-7]|5[1-4]|7[1-5]|[89][1-9])|3(?:1\\d|2[1-57]|[35][1-3]|4[13]|7[1-7]|8[124-6]|9[1-79])|4(?:1\\d|2[1-8]|3[1-4]|4[13-5]|6[1-578]|9[1-5])|5(?:1\\d|[29][1-4]|3[1-5]|4[124]|5[1-6])|6(?:1\\d|[269][1-6]|3[1245]|4[1-7]|5[13-9]|7[14]|8[1-5])|7(?:1\\d|2[1-5]|3[1-6]|4[1-7]|5[1-57]|6[135]|9[125-7])|8(?:1\\d|2[1-5]|[34][1-4]|9[1-57]))\\d{6}",,,,"2123456789",,,[10]],[,,"68[57-9]\\d{7}|(?:69|94)\\d{8}",,,,"6912345678",,,[10]],[,,"800\\d{7,9}",,,,"8001234567"],[,,"90[19]\\d{7}",,,,"9091234567",,,[10]],[,,"8(?:0[16]|12|[27]5|50)\\d{7}",,,,"8011234567",,,[10]],[,,"70\\d{8}",,,,"7012345678",,,[10]],[,,,,,,,,,[-1]],"GR",30,"00",,,,,,,,[[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["21|7"]],[,"(\\d{4})(\\d{6})","$1 $2",["2(?:2|3[2-57-9]|4[2-469]|5[2-59]|6[2-9]|7[2-69]|8[2-49])|5"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2689]"]],[,"(\\d{3})(\\d{3,4})(\\d{5})","$1 $2 $3",["8"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"5005000\\d{3}",,,,"5005000123",,,[10]],,,[,,,,,,,,,[-1]]],GT:[,[,,"80\\d{6}|(?:1\\d{3}|[2-7])\\d{7}",,,,,,,[8,11]],[,,"[267][2-9]\\d{6}",,,,"22456789",,,[8]],[,,"(?:[3-5]\\d\\d|80[0-4])\\d{5}",,,,"51234567",,,[8]],[,,"18[01]\\d{8}",,,,"18001112222",,,[11]],[,,"19\\d{9}",,,,"19001112222",,,[11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"GT",502,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[2-8]"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GU:[,[,,"(?:[58]\\d\\d|671|900)\\d{7}",,,,,,,[10],[7]],[,,"671(?:2\\d\\d|3(?:00|3[39]|4[349]|55|6[26])|4(?:00|56|7[1-9]|8[02-9])|5(?:55|6[2-5]|88)|6(?:3[2-578]|4[24-9]|5[34]|78|8[235-9])|7(?:[0479]7|2[0167]|3[45]|8[7-9])|8(?:[2-57-9]8|6[478])|9(?:2[29]|6[79]|7[1279]|8[7-9]|9[78]))\\d{4}",,,,"6713001234",,,,[7]],[,,"671(?:2\\d\\d|3(?:00|3[39]|4[349]|55|6[26])|4(?:00|56|7[1-9]|8[02-9])|5(?:55|6[2-5]|88)|6(?:3[2-578]|4[24-9]|5[34]|78|8[235-9])|7(?:[0479]7|2[0167]|3[45]|8[7-9])|8(?:[2-57-9]8|6[478])|9(?:2[29]|6[79]|7[1279]|8[7-9]|9[78]))\\d{4}",,,,"6713001234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"GU",1,"011","1",,,"([2-9]\\d{6})$|1","671$1",,1,,,[,,,,,,,,,[-1]],,"671",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GW:[,[,,"[49]\\d{8}|4\\d{6}",,,,,,,[7,9]],[,,"443\\d{6}",,,,"443201234",,,[9]],[,,"9(?:5\\d|6[569]|77)\\d{6}",,,,"955012345",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"40\\d{5}",,,,"4012345",,,[7]],"GW",245,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["40"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[49]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],GY:[,[,,"(?:[2-8]\\d{3}|9008)\\d{3}",,,,,,,[7]],[,,"(?:2(?:1[6-9]|2[0-35-9]|3[1-4]|5[3-9]|6\\d|7[0-79])|3(?:2[25-9]|3\\d)|4(?:4[0-24]|5[56])|50[0-6]|77[1-57])\\d{4}",,,,"2201234"],[,,"510\\d{4}|(?:6\\d|7[0-5])\\d{5}",,,,"6091234"],[,,"(?:289|8(?:00|6[28]|88|99))\\d{4}",,,,"2891234"],[,,"9008\\d{3}",,,,"9008123"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"515\\d{4}",,,,"5151234"],"GY",592,"001",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],HK:[,[,,"8[0-46-9]\\d{6,7}|9\\d{4,7}|(?:[2-7]|9\\d{3})\\d{7}",,,,,,,[5,6,7,8,9,11]],[,,"(?:2(?:[13-9]\\d|2[013-9])\\d|3(?:(?:[1569][0-24-9]|4[0-246-9]|7[0-24-69])\\d|8(?:4[0-8]|[579]\\d|6[0-2]))|58(?:0[1-9]|1[2-9]))\\d{4}",,,,"21234567",,,[8]],[,,"(?:4(?:44[0-25-9]|6(?:1[0-7]|4[0-57-9]|6[0-4])|7(?:4[0-2]|6[0-5]))|5(?:73[0-6]|95[0-8])|6(?:26[013-8]|66[0-3])|70(?:7[1-8]|8[0-4])|84(?:4[0-2]|8[0-35-9])|9(?:29[013-9]|39[014-9]|59[0-4]|899))\\d{4}|(?:4(?:4[0-35-9]|6[02357-9]|7[05])|5(?:[1-59][0-46-9]|6[0-4689]|7[0-246-9])|6(?:0[1-9]|[13-59]\\d|[268][0-57-9]|7[0-79])|70[1-49]|84[0-39]|9(?:0[1-9]|1[02-9]|[2358][0-8]|[467]\\d))\\d{5}",,,,"51234567",,,[8]],[,,"800\\d{6}",,,,"800123456",,,[9]],[,,"900(?:[0-24-9]\\d{7}|3\\d{1,4})",,,,"90012345678",,,[5,6,7,8,11]],[,,,,,,,,,[-1]],[,,"8(?:1[0-4679]\\d|2(?:[0-36]\\d|7[0-4])|3(?:[034]\\d|2[09]|70))\\d{4}",,,,"81123456",,,[8]],[,,,,,,,,,[-1]],"HK",852,"00(?:30|5[09]|[126-9]?)",,,,,,"00",,[[,"(\\d{3})(\\d{2,5})","$1 $2",["900","9003"]],[,"(\\d{4})(\\d{4})","$1 $2",["[2-7]|8[1-4]|9(?:0[1-9]|[1-8])"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]],[,"(\\d{3})(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]]],,[,,"7(?:1(?:0[0-38]|1[0-3679]|3[013]|69|9[0136])|2(?:[02389]\\d|1[18]|7[27-9])|3(?:[0-38]\\d|7[0-369]|9[2357-9])|47\\d|5(?:[178]\\d|5[0-5])|6(?:0[0-7]|2[236-9]|[35]\\d)|7(?:[27]\\d|8[7-9])|8(?:[23689]\\d|7[1-9])|9(?:[025]\\d|6[0-246-8]|7[0-36-9]|8[238]))\\d{4}",,,,"71123456",,,[8]],,,[,,,,,,,,,[-1]],[,,"30(?:0[1-9]|[15-7]\\d|2[047]|89)\\d{4}",,,,"30161234",,,[8]],,,[,,,,,,,,,[-1]]],HN:[,[,,"8\\d{10}|[237-9]\\d{7}",,,,,,,[8,11]],[,,"2(?:2(?:0[0-59]|1[1-9]|[23]\\d|4[02-7]|5[57]|6[245]|7[0135689]|8[01346-9]|9[0-2])|4(?:0[578]|2[3-59]|3[13-9]|4[0-68]|5[1-3589])|5(?:0[2357-9]|1[1-356]|4[03-5]|5\\d|6[014-69]|7[04]|80)|6(?:[056]\\d|17|2[067]|3[047]|4[0-378]|[78][0-8]|9[01])|7(?:0[5-79]|6[46-9]|7[02-9]|8[034]|91)|8(?:79|8[0-357-9]|9[1-57-9]))\\d{4}",,,,"22123456",,,[8]],[,,"[37-9]\\d{7}",,,,"91234567",,,[8]],[,,"8002\\d{7}",,,,"80021234567",,,[11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"HN",504,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1-$2",["[237-9]"]],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["8"]]],[[,"(\\d{4})(\\d{4})","$1-$2",["[237-9]"]]],[,,,,,,,,,[-1]],,,[,,"8002\\d{7}",,,,,,,[11]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],HR:[,[,,"(?:[24-69]\\d|3[0-79])\\d{7}|80\\d{5,7}|[1-79]\\d{7}|6\\d{5,6}",,,,,,,[6,7,8,9]],[,,"1\\d{7}|(?:2[0-3]|3[1-5]|4[02-47-9]|5[1-3])\\d{6,7}",,,,"12345678",,,[8,9],[6,7]],[,,"9(?:(?:0[1-9]|[12589]\\d)\\d\\d|7(?:[0679]\\d\\d|5(?:[01]\\d|44|55|77|9[5-79])))\\d{4}|98\\d{6}",,,,"921234567",,,[8,9]],[,,"80\\d{5,7}",,,,"800123456",,,[7,8,9]],[,,"6[01459]\\d{6}|6[01]\\d{4,5}",,,,"611234",,,[6,7,8]],[,,,,,,,,,[-1]],[,,"7[45]\\d{6}",,,,"74123456",,,[8]],[,,,,,,,,,[-1]],"HR",385,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{2})(\\d{2,3})","$1 $2 $3",["6[01]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["8"],"0$1"],[,"(\\d)(\\d{4})(\\d{3})","$1 $2 $3",["1"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["6|7[245]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["9"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-57]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"62\\d{6,7}|72\\d{6}",,,,"62123456",,,[8,9]],,,[,,,,,,,,,[-1]]],HT:[,[,,"(?:[2-489]\\d|55)\\d{6}",,,,,,,[8]],[,,"2(?:2\\d|5[1-5]|81|9[149])\\d{5}",,,,"22453300"],[,,"(?:[34]\\d|55)\\d{6}",,,,"34101234"],[,,"8\\d{7}",,,,"80012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9(?:[67][0-4]|8[0-3589]|9\\d)\\d{5}",,,,"98901234"],"HT",509,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["[2-589]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],HU:[,[,,"[235-7]\\d{8}|[1-9]\\d{7}",,,,,,,[8,9],[6,7]],[,,"(?:1\\d|[27][2-9]|3[2-7]|4[24-9]|5[2-79]|6[23689]|8[2-57-9]|9[2-69])\\d{6}",,,,"12345678",,,[8],[6,7]],[,,"(?:[257]0|3[01])\\d{7}",,,,"201234567",,,[9]],[,,"(?:[48]0\\d|680[29])\\d{5}",,,,"80123456"],[,,"9[01]\\d{6}",,,,"90123456",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"21\\d{7}",,,,"211234567",,,[9]],"HU",36,"00","06",,,"06",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"(06 $1)"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[27][2-9]|3[2-7]|4[24-9]|5[2-79]|6|8[2-57-9]|9[2-69]"],"(06 $1)"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-9]"],"06 $1"]],,[,,,,,,,,,[-1]],,,[,,"(?:[48]0\\d|680[29])\\d{5}"],[,,"38\\d{7}",,,,"381234567",,,[9]],,,[,,,,,,,,,[-1]]],ID:[,[,,"00[1-9]\\d{9,14}|(?:[1-36]|8\\d{5})\\d{6}|00\\d{9}|[1-9]\\d{8,10}|[2-9]\\d{7}",,,,,,,[7,8,9,10,11,12,13,14,15,16,17],[5,6]],[,,"2[124]\\d{7,8}|619\\d{8}|2(?:1(?:14|500)|2\\d{3})\\d{3}|61\\d{5,8}|(?:2(?:[35][1-4]|6[0-8]|7[1-6]|8\\d|9[1-8])|3(?:1|[25][1-8]|3[1-68]|4[1-3]|6[1-3568]|7[0-469]|8\\d)|4(?:0[1-589]|1[01347-9]|2[0-36-8]|3[0-24-68]|43|5[1-378]|6[1-5]|7[134]|8[1245])|5(?:1[1-35-9]|2[25-8]|3[124-9]|4[1-3589]|5[1-46]|6[1-8])|6(?:[25]\\d|3[1-69]|4[1-6])|7(?:02|[125][1-9]|[36]\\d|4[1-8]|7[0-36-9])|9(?:0[12]|1[013-8]|2[0-479]|5[125-8]|6[23679]|7[159]|8[01346]))\\d{5,8}",,,,"218350123",,,[7,8,9,10,11],[5,6]],[,,"8[1-35-9]\\d{7,10}",,,,"812345678",,,[9,10,11,12]],[,,"00(?:1803\\d{5,11}|7803\\d{7})|(?:177\\d|800)\\d{5,7}",,,,"8001234567",,,[8,9,10,11,12,13,14,15,16,17]],[,,"809\\d{7}",,,,"8091234567",,,[10]],[,,"804\\d{7}",,,,"8041234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"ID",62,"00[89]","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["15"]],[,"(\\d{2})(\\d{5,9})","$1 $2",["2[124]|[36]1"],"(0$1)"],[,"(\\d{3})(\\d{5,7})","$1 $2",["800"],"0$1"],[,"(\\d{3})(\\d{5,8})","$1 $2",["[2-79]"],"(0$1)"],[,"(\\d{3})(\\d{3,4})(\\d{3})","$1-$2-$3",["8[1-35-9]"],"0$1"],[,"(\\d{3})(\\d{6,8})","$1 $2",["1"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["804"],"0$1"],[,"(\\d{3})(\\d)(\\d{3})(\\d{3})","$1 $2 $3 $4",["80"],"0$1"],[,"(\\d{3})(\\d{4})(\\d{4,5})","$1-$2-$3",["8"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})(\\d{2,8})","$1 $2 $3 $4",["001"]],[,"(\\d{2})(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3 $4",["0"]]],[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["15"]],[,"(\\d{2})(\\d{5,9})","$1 $2",["2[124]|[36]1"],"(0$1)"],[,"(\\d{3})(\\d{5,7})","$1 $2",["800"],"0$1"],[,"(\\d{3})(\\d{5,8})","$1 $2",["[2-79]"],"(0$1)"],[,"(\\d{3})(\\d{3,4})(\\d{3})","$1-$2-$3",["8[1-35-9]"],"0$1"],[,"(\\d{3})(\\d{6,8})","$1 $2",["1"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["804"],"0$1"],[,"(\\d{3})(\\d)(\\d{3})(\\d{3})","$1 $2 $3 $4",["80"],"0$1"],[,"(\\d{3})(\\d{4})(\\d{4,5})","$1-$2-$3",["8"],"0$1"]],[,,,,,,,,,[-1]],,,[,,"001803\\d{5,11}|(?:007803\\d|8071)\\d{6}",,,,,,,[10,11,12,13,14,15,16,17]],[,,"(?:1500|8071\\d{3})\\d{3}",,,,"8071123456",,,[7,10]],,,[,,,,,,,,,[-1]]],IE:[,[,,"(?:1\\d|[2569])\\d{6,8}|4\\d{6,9}|7\\d{8}|8\\d{8,9}",,,,,,,[7,8,9,10],[5,6]],[,,"(?:1\\d|21)\\d{6,7}|(?:2[24-9]|4(?:0[24]|5\\d|7)|5(?:0[45]|1\\d|8)|6(?:1\\d|[237-9])|9(?:1\\d|[35-9]))\\d{5}|(?:23|4(?:[1-469]|8\\d)|5[23679]|6[4-6]|7[14]|9[04])\\d{7}",,,,"2212345",,,,[5,6]],[,,"8(?:22|[35-9]\\d)\\d{6}",,,,"850123456",,,[9]],[,,"1800\\d{6}",,,,"1800123456",,,[10]],[,,"15(?:1[2-8]|[2-8]0|9[089])\\d{6}",,,,"1520123456",,,[10]],[,,"18[59]0\\d{6}",,,,"1850123456",,,[10]],[,,"700\\d{6}",,,,"700123456",,,[9]],[,,"76\\d{7}",,,,"761234567",,,[9]],"IE",353,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{5})","$1 $2",["2[24-9]|47|58|6[237-9]|9[35-9]"],"(0$1)"],[,"(\\d{3})(\\d{5})","$1 $2",["[45]0"],"(0$1)"],[,"(\\d)(\\d{3,4})(\\d{4})","$1 $2 $3",["1"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2569]|4[1-69]|7[14]"],"(0$1)"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["70"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["81"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[78]"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["4"],"(0$1)"],[,"(\\d{2})(\\d)(\\d{3})(\\d{4})","$1 $2 $3 $4",["8"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,"18[59]0\\d{6}",,,,,,,[10]],[,,"818\\d{6}",,,,"818123456",,,[9]],,,[,,"88210[1-9]\\d{4}|8(?:[35-79]5\\d\\d|8(?:[013-9]\\d\\d|2(?:[01][1-9]|[2-9]\\d)))\\d{5}",,,,"8551234567",,,[10]]],IL:[,[,,"1\\d{6}(?:\\d{3,5})?|[57]\\d{8}|[1-489]\\d{7}",,,,,,,[7,8,9,10,11,12]],[,,"153\\d{8,9}|29[1-9]\\d{5}|(?:2[0-8]|[3489]\\d)\\d{6}",,,,"21234567",,,[8,11,12],[7]],[,,"55(?:4(?:[01]0|5[0-2])|57[0-289])\\d{4}|5(?:(?:[0-2][02-9]|[36]\\d|[49][2-9]|8[3-7])\\d|5(?:01|2\\d|3[0-3]|4[34]|5[0-25689]|6[6-8]|7[0-267]|8[7-9]|9[1-9]))\\d{5}",,,,"502345678",,,[9]],[,,"1(?:255|80[019]\\d{3})\\d{3}",,,,"1800123456",,,[7,10]],[,,"1212\\d{4}|1(?:200|9(?:0[0-2]|19))\\d{6}",,,,"1919123456",,,[8,10]],[,,"1700\\d{6}",,,,"1700123456",,,[10]],[,,,,,,,,,[-1]],[,,"7(?:38(?:0\\d|5[0-2569]|88)|8(?:33|55|77|81)\\d)\\d{4}|7(?:18|2[23]|3[237]|47|6[258]|7\\d|82|9[2-9])\\d{6}",,,,"771234567",,,[9]],"IL",972,"0(?:0|1[2-9])","0",,,"0",,,,[[,"(\\d{4})(\\d{3})","$1-$2",["125"]],[,"(\\d{4})(\\d{2})(\\d{2})","$1-$2-$3",["121"]],[,"(\\d)(\\d{3})(\\d{4})","$1-$2-$3",["[2-489]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[57]"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3})","$1-$2-$3",["12"]],[,"(\\d{4})(\\d{6})","$1-$2",["159"]],[,"(\\d)(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3-$4",["1[7-9]"]],[,"(\\d{3})(\\d{1,2})(\\d{3})(\\d{4})","$1-$2 $3-$4",["15"]]],,[,,,,,,,,,[-1]],,,[,,"1700\\d{6}",,,,,,,[10]],[,,"1599\\d{6}",,,,"1599123456",,,[10]],,,[,,"151\\d{8,9}",,,,"15112340000",,,[11,12]]],IM:[,[,,"1624\\d{6}|(?:[3578]\\d|90)\\d{8}",,,,,,,[10],[6]],[,,"1624(?:230|[5-8]\\d\\d)\\d{3}",,,,"1624756789",,,,[6]],[,,"76245[06]\\d{4}|7(?:4576|[59]24\\d|624[0-4689])\\d{5}",,,,"7924123456"],[,,"808162\\d{4}",,,,"8081624567"],[,,"8(?:440[49]06|72299\\d)\\d{3}|(?:8(?:45|70)|90[0167])624\\d{4}",,,,"9016247890"],[,,,,,,,,,[-1]],[,,"70\\d{8}",,,,"7012345678"],[,,"56\\d{8}",,,,"5612345678"],"IM",44,"00","0",,,"([25-8]\\d{5})$|0","1624$1",,,,,[,,,,,,,,,[-1]],,"74576|(?:16|7[56])24",[,,,,,,,,,[-1]],[,,"3440[49]06\\d{3}|(?:3(?:08162|3\\d{4}|45624|7(?:0624|2299))|55\\d{4})\\d{4}",,,,"5512345678"],,,[,,,,,,,,,[-1]]],IN:[,[,,"(?:000800|[2-9]\\d\\d)\\d{7}|1\\d{7,12}",,,,,,,[8,9,10,11,12,13],[6,7]],[,,"2717(?:[2-7]\\d|95)\\d{4}|(?:271[0-689]|782[0-6])[2-7]\\d{5}|(?:170[24]|2(?:(?:[02][2-79]|90)\\d|80[13468])|(?:3(?:23|80)|683|79[1-7])\\d|4(?:20[24]|72[2-8])|552[1-7])\\d{6}|(?:11|33|4[04]|80)[2-7]\\d{7}|(?:342|674|788)(?:[0189][2-7]|[2-7]\\d)\\d{5}|(?:1(?:2[0-249]|3[0-25]|4[145]|[59][14]|6[014]|7[1257]|8[01346])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568]|9[14])|3(?:26|4[13]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[014-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|6(?:12|[2-47]1|5[17]|6[13]|80)|7(?:12|2[14]|3[134]|4[47]|5[15]|[67]1)|8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91))[2-7]\\d{6}|(?:1(?:2[35-8]|3[346-9]|4[236-9]|[59][0235-9]|6[235-9]|7[34689]|8[257-9])|2(?:1[134689]|3[24-8]|4[2-8]|5[25689]|6[2-4679]|7[3-79]|8[2-479]|9[235-9])|3(?:01|1[79]|2[1245]|4[5-8]|5[125689]|6[235-7]|7[157-9]|8[2-46-8])|4(?:1[14578]|2[5689]|3[2-467]|5[4-7]|6[35]|73|8[2689]|9[2389])|5(?:[16][146-9]|2[14-8]|3[1346]|4[14-69]|5[46]|7[2-4]|8[2-8]|9[246])|6(?:1[1358]|2[2457]|3[2-4]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[124-6])|7(?:1[013-9]|2[0235-9]|3[2679]|4[1-35689]|5[2-46-9]|[67][02-9]|8[013-7]|9[089])|8(?:1[1357-9]|2[235-8]|3[03-57-9]|4[0-24-9]|5\\d|6[2457-9]|7[1-6]|8[1256]|9[2-4]))\\d[2-7]\\d{5}",,,,"7410410123",,,[10],[6,7,8]],[,,"(?:61279|7(?:887[02-9]|9(?:313|79[07-9]))|8(?:079[04-9]|(?:84|91)7[02-8]))\\d{5}|(?:6(?:12|[2-47]1|5[17]|6[13]|80)[0189]|7(?:1(?:2[0189]|9[0-5])|2(?:[14][017-9]|8[0-59])|3(?:2[5-8]|[34][017-9]|9[016-9])|4(?:1[015-9]|[29][89]|39|8[389])|5(?:[15][017-9]|2[04-9]|9[7-9])|6(?:0[0-47]|1[0-257-9]|2[0-4]|3[19]|5[4589])|70[0289]|88[089]|97[02-8])|8(?:0(?:6[67]|7[02-8])|70[017-9]|84[01489]|91[0-289]))\\d{6}|(?:7(?:31|4[47])|8(?:16|2[014]|3[126]|6[136]|7[78]|83))(?:[0189]\\d|7[02-8])\\d{5}|(?:6(?:[09]\\d|1[04679]|2[03689]|3[05-9]|4[0489]|50|6[069]|7[07]|8[7-9])|7(?:0\\d|2[0235-79]|3[05-8]|40|5[0346-8]|6[6-9]|7[1-9]|8[0-79]|9[089])|8(?:0[01589]|1[0-57-9]|2[235-9]|3[03-57-9]|[45]\\d|6[02457-9]|7[1-69]|8[0-25-9]|9[02-9])|9\\d\\d)\\d{7}|(?:6(?:(?:1[1358]|2[2457]|3[2-4]|4[235-7]|5[2-689]|6[24578]|8[124-6])\\d|7(?:[235689]\\d|4[0189]))|7(?:1(?:[013-8]\\d|9[6-9])|28[6-8]|3(?:2[0-49]|9[2-5])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]\\d|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4\\d|5[0-367])|70[13-7]|881))[0189]\\d{5}",,,,"8123456789",,,[10]],[,,"000800\\d{7}|1(?:600\\d{6}|80(?:0\\d{4,9}|3\\d{9}))",,,,"1800123456"],[,,"186[12]\\d{9}",,,,"1861123456789",,,[13]],[,,"1860\\d{7}",,,,"18603451234",,,[11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"IN",91,"00","0",,,"0",,,,[[,"(\\d{7})","$1",["575"]],[,"(\\d{8})","$1",["5(?:0|2[23]|3[03]|[67]1|88)","5(?:0|2(?:21|3)|3(?:0|3[23])|616|717|888)","5(?:0|2(?:21|3)|3(?:0|3[23])|616|717|8888)"],,,1],[,"(\\d{4})(\\d{4,5})","$1 $2",["180","1800"],,,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["140"],,,1],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["11|2[02]|33|4[04]|79[1-7]|80[2-46]","11|2[02]|33|4[04]|79(?:[1-6]|7[19])|80(?:[2-4]|6[0-589])","11|2[02]|33|4[04]|79(?:[124-6]|3(?:[02-9]|1[0-24-9])|7(?:1|9[1-6]))|80(?:[2-4]|6[0-589])"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1(?:2[0-249]|3[0-25]|4[145]|[68]|7[1257])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|5[12]|[78]1)|6(?:12|[2-4]1|5[17]|6[13]|80)|7(?:12|3[134]|4[47]|61|88)|8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91)|(?:43|59|75)[15]|(?:1[59]|29|67|72)[14]","1(?:2[0-24]|3[0-25]|4[145]|[59][14]|6[1-9]|7[1257]|8[1-57-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[058]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|674|7(?:(?:2[14]|3[34]|5[15])[2-6]|61[346]|88[0-8])|8(?:70[2-6]|84[235-7]|91[3-7])|(?:1(?:29|60|8[06])|261|552|6(?:12|[2-47]1|5[17]|6[13]|80)|7(?:12|31|4[47])|8(?:16|2[014]|3[126]|6[136]|7[78]|83))[2-7]","1(?:2[0-24]|3[0-25]|4[145]|[59][14]|6[1-9]|7[1257]|8[1-57-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[058]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|6(?:12(?:[2-6]|7[0-8])|74[2-7])|7(?:(?:2[14]|5[15])[2-6]|3171|61[346]|88(?:[2-7]|82))|8(?:70[2-6]|84(?:[2356]|7[19])|91(?:[3-6]|7[19]))|73[134][2-6]|(?:74[47]|8(?:16|2[014]|3[126]|6[136]|7[78]|83))(?:[2-6]|7[19])|(?:1(?:29|60|8[06])|261|552|6(?:[2-4]1|5[17]|6[13]|7(?:1|4[0189])|80)|7(?:12|88[01]))[2-7]"],"0$1",,1],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:[2-479]|5[0235-9])|[2-5]|6(?:1[1358]|2[2457-9]|3[2-5]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[1-6])|7(?:1[013-9]|28|3[129]|4[1-35689]|5[29]|6[02-5]|70)|807","1(?:[2-479]|5[0235-9])|[2-5]|6(?:1[1358]|2(?:[2457]|84|95)|3(?:[2-4]|55)|4[235-7]|5[2-689]|6[24578]|7[235689]|8[1-6])|7(?:1(?:[013-8]|9[6-9])|28[6-8]|3(?:17|2[0-49]|9[2-57])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4|5[0-367])|70[13-7])|807[19]","1(?:[2-479]|5(?:[0236-9]|5[013-9]))|[2-5]|6(?:2(?:84|95)|355|83)|73179|807(?:1|9[1-3])|(?:1552|6(?:1[1358]|2[2457]|3[2-4]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[124-6])\\d|7(?:1(?:[013-8]\\d|9[6-9])|28[6-8]|3(?:2[0-49]|9[2-57])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]\\d|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4\\d|5[0-367])|70[13-7]))[2-7]"],"0$1",,1],[,"(\\d{5})(\\d{5})","$1 $2",["[6-9]"],"0$1",,1],[,"(\\d{4})(\\d{2,4})(\\d{4})","$1 $2 $3",["1(?:6|8[06])","1(?:6|8[06]0)"],,,1],[,"(\\d{3})(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3 $4",["0"]],[,"(\\d{4})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["18"],,,1]],[[,"(\\d{8})","$1",["5(?:0|2[23]|3[03]|[67]1|88)","5(?:0|2(?:21|3)|3(?:0|3[23])|616|717|888)","5(?:0|2(?:21|3)|3(?:0|3[23])|616|717|8888)"],,,1],[,"(\\d{4})(\\d{4,5})","$1 $2",["180","1800"],,,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["140"],,,1],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["11|2[02]|33|4[04]|79[1-7]|80[2-46]","11|2[02]|33|4[04]|79(?:[1-6]|7[19])|80(?:[2-4]|6[0-589])","11|2[02]|33|4[04]|79(?:[124-6]|3(?:[02-9]|1[0-24-9])|7(?:1|9[1-6]))|80(?:[2-4]|6[0-589])"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1(?:2[0-249]|3[0-25]|4[145]|[68]|7[1257])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|5[12]|[78]1)|6(?:12|[2-4]1|5[17]|6[13]|80)|7(?:12|3[134]|4[47]|61|88)|8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91)|(?:43|59|75)[15]|(?:1[59]|29|67|72)[14]","1(?:2[0-24]|3[0-25]|4[145]|[59][14]|6[1-9]|7[1257]|8[1-57-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[058]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|674|7(?:(?:2[14]|3[34]|5[15])[2-6]|61[346]|88[0-8])|8(?:70[2-6]|84[235-7]|91[3-7])|(?:1(?:29|60|8[06])|261|552|6(?:12|[2-47]1|5[17]|6[13]|80)|7(?:12|31|4[47])|8(?:16|2[014]|3[126]|6[136]|7[78]|83))[2-7]","1(?:2[0-24]|3[0-25]|4[145]|[59][14]|6[1-9]|7[1257]|8[1-57-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[058]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|6(?:12(?:[2-6]|7[0-8])|74[2-7])|7(?:(?:2[14]|5[15])[2-6]|3171|61[346]|88(?:[2-7]|82))|8(?:70[2-6]|84(?:[2356]|7[19])|91(?:[3-6]|7[19]))|73[134][2-6]|(?:74[47]|8(?:16|2[014]|3[126]|6[136]|7[78]|83))(?:[2-6]|7[19])|(?:1(?:29|60|8[06])|261|552|6(?:[2-4]1|5[17]|6[13]|7(?:1|4[0189])|80)|7(?:12|88[01]))[2-7]"],"0$1",,1],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:[2-479]|5[0235-9])|[2-5]|6(?:1[1358]|2[2457-9]|3[2-5]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[1-6])|7(?:1[013-9]|28|3[129]|4[1-35689]|5[29]|6[02-5]|70)|807","1(?:[2-479]|5[0235-9])|[2-5]|6(?:1[1358]|2(?:[2457]|84|95)|3(?:[2-4]|55)|4[235-7]|5[2-689]|6[24578]|7[235689]|8[1-6])|7(?:1(?:[013-8]|9[6-9])|28[6-8]|3(?:17|2[0-49]|9[2-57])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4|5[0-367])|70[13-7])|807[19]","1(?:[2-479]|5(?:[0236-9]|5[013-9]))|[2-5]|6(?:2(?:84|95)|355|83)|73179|807(?:1|9[1-3])|(?:1552|6(?:1[1358]|2[2457]|3[2-4]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[124-6])\\d|7(?:1(?:[013-8]\\d|9[6-9])|28[6-8]|3(?:2[0-49]|9[2-57])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]\\d|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4\\d|5[0-367])|70[13-7]))[2-7]"],"0$1",,1],[,"(\\d{5})(\\d{5})","$1 $2",["[6-9]"],"0$1",,1],[,"(\\d{4})(\\d{2,4})(\\d{4})","$1 $2 $3",["1(?:6|8[06])","1(?:6|8[06]0)"],,,1],[,"(\\d{4})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["18"],,,1]],[,,,,,,,,,[-1]],,,[,,"1(?:600\\d{6}|800\\d{4,9})|(?:000800|18(?:03\\d\\d|6(?:0|[12]\\d\\d)))\\d{7}"],[,,"140\\d{7}",,,,"1409305260",,,[10]],,,[,,,,,,,,,[-1]]],IO:[,[,,"3\\d{6}",,,,,,,[7]],[,,"37\\d{5}",,,,"3709100"],[,,"38\\d{5}",,,,"3801234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"IO",246,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["3"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],IQ:[,[,,"(?:1|7\\d\\d)\\d{7}|[2-6]\\d{7,8}",,,,,,,[8,9,10],[6,7]],[,,"1\\d{7}|(?:2[13-5]|3[02367]|4[023]|5[03]|6[026])\\d{6,7}",,,,"12345678",,,[8,9],[6,7]],[,,"7[3-9]\\d{8}",,,,"7912345678",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"IQ",964,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-6]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],IR:[,[,,"[1-9]\\d{9}|(?:[1-8]\\d\\d|9)\\d{3,4}",,,,,,,[4,5,6,7,10],[8]],[,,"(?:1[137]|2[13-68]|3[1458]|4[145]|5[1468]|6[16]|7[1467]|8[13467])(?:[03-57]\\d{7}|[16]\\d{3}(?:\\d{4})?|[289]\\d{3}(?:\\d(?:\\d{3})?)?)|94(?:000[09]|(?:12\\d|30[0-2])\\d|2(?:121|[2689]0\\d)|4(?:111|40\\d))\\d{4}",,,,"2123456789",,,[6,7,10],[4,5,8]],[,,"9(?:(?:0(?:[0-35]\\d|4[4-6])|(?:[13]\\d|2[0-3])\\d)\\d|9(?:[0-46]\\d\\d|5[15]0|8(?:[12]\\d|88)|9(?:0[0-3]|[19]\\d|21|69|77|8[7-9])))\\d{5}",,,,"9123456789",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"IR",98,"00","0",,,"0",,,,[[,"(\\d{4,5})","$1",["96"],"0$1"],[,"(\\d{2})(\\d{4,5})","$1 $2",["(?:1[137]|2[13-68]|3[1458]|4[145]|5[1468]|6[16]|7[1467]|8[13467])[12689]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["9"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["[1-8]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,"9(?:4440\\d{5}|6(?:0[12]|2[16-8]|3(?:08|[14]5|[23]|66)|4(?:0|80)|5[01]|6[89]|86|9[19]))",,,,,,,[4,5,10]],[,,"96(?:0[12]|2[16-8]|3(?:08|[14]5|[23]|66)|4(?:0|80)|5[01]|6[89]|86|9[19])",,,,"9601",,,[4,5]],,,[,,,,,,,,,[-1]]],IS:[,[,,"(?:38\\d|[4-9])\\d{6}",,,,,,,[7,9]],[,,"(?:4(?:1[0-24-69]|2[0-7]|[37][0-8]|4[0-24589]|5[0-68]|6\\d|8[0-36-8])|5(?:05|[156]\\d|2[02578]|3[0-579]|4[03-7]|7[0-2578]|8[0-35-9]|9[013-689])|872)\\d{4}",,,,"4101234",,,[7]],[,,"(?:38[589]\\d\\d|6(?:1[1-8]|2[0-6]|3[026-9]|4[014679]|5[0159]|6[0-69]|70|8[06-8]|9\\d)|7(?:5[057]|[6-9]\\d)|8(?:2[0-59]|[3-69]\\d|8[238]))\\d{4}",,,,"6111234"],[,,"80[0-8]\\d{4}",,,,"8001234",,,[7]],[,,"90(?:0\\d|1[5-79]|2[015-79]|3[135-79]|4[125-7]|5[25-79]|7[1-37]|8[0-35-7])\\d{3}",,,,"9001234",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"49[0-24-79]\\d{4}",,,,"4921234",,,[7]],"IS",354,"00|1(?:0(?:01|[12]0)|100)",,,,,,"00",,[[,"(\\d{3})(\\d{4})","$1 $2",["[4-9]"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["3"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"809\\d{4}",,,,"8091234",,,[7]],,,[,,"(?:689|8(?:7[18]|80)|95[48])\\d{4}",,,,"6891234",,,[7]]],IT:[,[,,"0\\d{5,10}|1\\d{8,10}|3(?:[0-8]\\d{7,10}|9\\d{7,8})|(?:43|55|70)\\d{8}|8\\d{5}(?:\\d{2,4})?",,,,,,,[6,7,8,9,10,11,12]],[,,"0669[0-79]\\d{1,6}|0(?:1(?:[0159]\\d|[27][1-5]|31|4[1-4]|6[1356]|8[2-57])|2\\d\\d|3(?:[0159]\\d|2[1-4]|3[12]|[48][1-6]|6[2-59]|7[1-7])|4(?:[0159]\\d|[23][1-9]|4[245]|6[1-5]|7[1-4]|81)|5(?:[0159]\\d|2[1-5]|3[2-6]|4[1-79]|6[4-6]|7[1-578]|8[3-8])|6(?:[0-57-9]\\d|6[0-8])|7(?:[0159]\\d|2[12]|3[1-7]|4[2-46]|6[13569]|7[13-6]|8[1-59])|8(?:[0159]\\d|2[3-578]|3[1-356]|[6-8][1-5])|9(?:[0159]\\d|[238][1-5]|4[12]|6[1-8]|7[1-6]))\\d{2,7}",,,,"0212345678",,,[6,7,8,9,10,11]],[,,"3[2-9]\\d{7,8}|(?:31|43)\\d{8}",,,,"3123456789",,,[9,10]],[,,"80(?:0\\d{3}|3)\\d{3}",,,,"800123456",,,[6,9]],[,,"(?:0878\\d{3}|89(?:2\\d|3[04]|4(?:[0-4]|[5-9]\\d\\d)|5[0-4]))\\d\\d|(?:1(?:44|6[346])|89(?:38|5[5-9]|9))\\d{6}",,,,"899123456",,,[6,8,9,10]],[,,"84(?:[08]\\d{3}|[17])\\d{3}",,,,"848123456",,,[6,9]],[,,"1(?:78\\d|99)\\d{6}",,,,"1781234567",,,[9,10]],[,,"55\\d{8}",,,,"5512345678",,,[10]],"IT",39,"00",,,,,,,,[[,"(\\d{4,5})","$1",["1(?:0|9[246])","1(?:0|9(?:2[2-9]|[46]))"]],[,"(\\d{6})","$1",["1(?:1|92)"]],[,"(\\d{2})(\\d{4,6})","$1 $2",["0[26]"]],[,"(\\d{3})(\\d{3,6})","$1 $2",["0[13-57-9][0159]|8(?:03|4[17]|9[2-5])","0[13-57-9][0159]|8(?:03|4[17]|9(?:2|3[04]|[45][0-4]))"]],[,"(\\d{4})(\\d{2,6})","$1 $2",["0(?:[13-579][2-46-8]|8[236-8])"]],[,"(\\d{4})(\\d{4})","$1 $2",["894"]],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[26]|5"]],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["1(?:44|[679])|[378]|43"]],[,"(\\d{3})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[13-57-9][0159]|14"]],[,"(\\d{2})(\\d{4})(\\d{5})","$1 $2 $3",["0[26]"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["0"]],[,"(\\d{3})(\\d{4})(\\d{4,5})","$1 $2 $3",["3"]]],[[,"(\\d{2})(\\d{4,6})","$1 $2",["0[26]"]],[,"(\\d{3})(\\d{3,6})","$1 $2",["0[13-57-9][0159]|8(?:03|4[17]|9[2-5])","0[13-57-9][0159]|8(?:03|4[17]|9(?:2|3[04]|[45][0-4]))"]],[,"(\\d{4})(\\d{2,6})","$1 $2",["0(?:[13-579][2-46-8]|8[236-8])"]],[,"(\\d{4})(\\d{4})","$1 $2",["894"]],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[26]|5"]],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["1(?:44|[679])|[378]|43"]],[,"(\\d{3})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[13-57-9][0159]|14"]],[,"(\\d{2})(\\d{4})(\\d{5})","$1 $2 $3",["0[26]"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["0"]],[,"(\\d{3})(\\d{4})(\\d{4,5})","$1 $2 $3",["3"]]],[,,,,,,,,,[-1]],1,,[,,"848\\d{6}",,,,,,,[9]],[,,,,,,,,,[-1]],,,[,,"3[2-8]\\d{9,10}",,,,"33101234501",,,[11,12]]],JE:[,[,,"1534\\d{6}|(?:[3578]\\d|90)\\d{8}",,,,,,,[10],[6]],[,,"1534[0-24-8]\\d{5}",,,,"1534456789",,,,[6]],[,,"7(?:(?:(?:50|82)9|937)\\d|7(?:00[378]|97\\d))\\d{5}",,,,"7797712345"],[,,"80(?:07(?:35|81)|8901)\\d{4}",,,,"8007354567"],[,,"(?:8(?:4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|7(?:0002|1206))|90(?:066[59]|1810|71(?:07|55)))\\d{4}",,,,"9018105678"],[,,,,,,,,,[-1]],[,,"701511\\d{4}",,,,"7015115678"],[,,"56\\d{8}",,,,"5612345678"],"JE",44,"00","0",,,"([0-24-8]\\d{5})$|0","1534$1",,,,,[,,"76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}",,,,"7640123456"],,,[,,,,,,,,,[-1]],[,,"(?:3(?:0(?:07(?:35|81)|8901)|3\\d{4}|4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|7(?:0002|1206))|55\\d{4})\\d{4}",,,,"5512345678"],,,[,,,,,,,,,[-1]]],JM:[,[,,"(?:[58]\\d\\d|658|900)\\d{7}",,,,,,,[10],[7]],[,,"8766060\\d{3}|(?:658(?:2(?:[0-8]\\d|9[0-46-9])|[3-9]\\d\\d)|876(?:52[35]|6(?:0[1-3579]|1[0235-9]|[23]\\d|40|5[06]|6[2-589]|7[0-25-9]|8[04]|9[4-9])|7(?:0[2-689]|[1-6]\\d|8[056]|9[45])|9(?:0[1-8]|1[02378]|[2-8]\\d|9[2-468])))\\d{4}",,,,"8765230123",,,,[7]],[,,"(?:658295|876(?:2(?:0[1-9]|[13-9]\\d|2[013-9])|[348]\\d\\d|5(?:0[1-9]|[1-9]\\d)|6(?:4[89]|6[67])|7(?:0[07]|7\\d|8[1-47-9]|9[0-36-9])|9(?:[01]9|9[0579])))\\d{4}",,,,"8762101234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"JM",1,"011","1",,,"1",,,,,,[,,,,,,,,,[-1]],,"658|876",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],JO:[,[,,"(?:(?:[2689]|7\\d)\\d|32|53)\\d{6}",,,,,,,[8,9]],[,,"87(?:000|90[01])\\d{3}|(?:2(?:6(?:2[0-35-9]|3[0-578]|4[24-7]|5[0-24-8]|[6-8][023]|9[0-3])|7(?:0[1-79]|10|2[014-7]|3[0-689]|4[019]|5[0-3578]))|32(?:0[1-69]|1[1-35-7]|2[024-7]|3\\d|4[0-3]|[5-7][023])|53(?:0[0-3]|[13][023]|2[0-59]|49|5[0-35-9]|6[15]|7[45]|8[1-6]|9[0-36-9])|6(?:2(?:[05]0|22)|3(?:00|33)|4(?:0[0-25]|1[2-7]|2[0569]|[38][07-9]|4[025689]|6[0-589]|7\\d|9[0-2])|5(?:[01][056]|2[034]|3[0-57-9]|4[178]|5[0-69]|6[0-35-9]|7[1-379]|8[0-68]|9[0239]))|87(?:20|7[078]|99))\\d{4}",,,,"62001234",,,[8]],[,,"7(?:[78][0-25-9]|9\\d)\\d{6}",,,,"790123456",,,[9]],[,,"80\\d{6}",,,,"80012345",,,[8]],[,,"9\\d{7}",,,,"90012345",,,[8]],[,,"85\\d{6}",,,,"85012345",,,[8]],[,,"70\\d{7}",,,,"700123456",,,[9]],[,,,,,,,,,[-1]],"JO",962,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2356]|87"],"(0$1)"],[,"(\\d{3})(\\d{5,6})","$1 $2",["[89]"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["70"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["7"],"0$1"]],,[,,"74(?:66|77)\\d{5}",,,,"746612345",,,[9]],,,[,,,,,,,,,[-1]],[,,"8(?:10|8\\d)\\d{5}",,,,"88101234",,,[8]],,,[,,,,,,,,,[-1]]],JP:[,[,,"00[1-9]\\d{6,14}|[25-9]\\d{9}|(?:00|[1-9]\\d\\d)\\d{6}",,,,,,,[8,9,10,11,12,13,14,15,16,17]],[,,"(?:1(?:1[235-8]|2[3-6]|3[3-9]|4[2-6]|[58][2-8]|6[2-7]|7[2-9]|9[1-9])|(?:2[2-9]|[36][1-9])\\d|4(?:[2-578]\\d|6[02-8]|9[2-59])|5(?:[2-589]\\d|6[1-9]|7[2-8])|7(?:[25-9]\\d|3[4-9]|4[02-9])|8(?:[2679]\\d|3[2-9]|4[5-9]|5[1-9]|8[03-9])|9(?:[2-58]\\d|[679][1-9]))\\d{6}",,,,"312345678",,,[9]],[,,"(?:60\\d|[7-9]0[1-9])\\d{7}",,,,"9012345678",,,[10]],[,,"00777(?:[01]|5\\d)\\d\\d|(?:00(?:7778|882[1245])|(?:120|800\\d)\\d\\d)\\d{4}|00(?:37|66|78)\\d{6,13}",,,,"120123456"],[,,"990\\d{6}",,,,"990123456",,,[9]],[,,,,,,,,,[-1]],[,,"60\\d{7}",,,,"601234567",,,[9]],[,,"50[1-9]\\d{7}",,,,"5012345678",,,[10]],"JP",81,"010","0",,,"(000[259]\\d{6})$|(?:(?:003768)0?)|0","$1",,,[[,"(\\d{4})(\\d{4})","$1-$2",["007","0077","00777","00777[01]"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3",["(?:12|57|99)0"],"0$1"],[,"(\\d{4})(\\d)(\\d{4})","$1-$2-$3",["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|499|5(?:76|97)|746|8(?:3[89]|47|51)|9(?:80|9[16])","1(?:267|3(?:7[247]|9[278])|466|5(?:47|58|64)|6(?:3[245]|48|5[4-68]))|499[2468]|5(?:76|97)9|7468|8(?:3(?:8[7-9]|96)|477|51[2-9])|9(?:802|9(?:1[23]|69))|1(?:45|58)[67]","1(?:267|3(?:7[247]|9[278])|466|5(?:47|58|64)|6(?:3[245]|48|5[4-68]))|499[2468]|5(?:769|979[2-69])|7468|8(?:3(?:8[7-9]|96[2457-9])|477|51[2-9])|9(?:802|9(?:1[23]|69))|1(?:45|58)[67]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["60"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1-$2-$3",["3|4(?:2[09]|7[01])|6[1-9]","3|4(?:2(?:0|9[02-69])|7(?:0[019]|1))|6[1-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["1(?:1|5[45]|77|88|9[69])|2(?:2[1-37]|3[0-269]|4[59]|5|6[24]|7[1-358]|8[1369]|9[0-38])|4(?:[28][1-9]|3[0-57]|[45]|6[248]|7[2-579]|9[29])|5(?:2|3[0459]|4[0-369]|5[29]|8[02389]|9[0-389])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9[2-6])|8(?:2[124589]|3[26-9]|49|51|6|7[0-468]|8[68]|9[019])|9(?:[23][1-9]|4[15]|5[138]|6[1-3]|7[156]|8[189]|9[1-489])","1(?:1|5(?:4[018]|5[017])|77|88|9[69])|2(?:2(?:[127]|3[014-9])|3[0-269]|4[59]|5(?:[1-3]|5[0-69]|9[19])|62|7(?:[1-35]|8[0189])|8(?:[16]|3[0134]|9[0-5])|9(?:[028]|17))|4(?:2(?:[13-79]|8[014-6])|3[0-57]|[45]|6[248]|7[2-47]|8[1-9]|9[29])|5(?:2|3(?:[045]|9[0-8])|4[0-369]|5[29]|8[02389]|9[0-3])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9(?:[23]|4[0-59]|5[01569]|6[0167]))|8(?:2(?:[1258]|4[0-39]|9[0-2469])|3(?:[29]|60)|49|51|6(?:[0-24]|36|5[0-3589]|7[23]|9[01459])|7[0-468]|8[68])|9(?:[23][1-9]|4[15]|5[138]|6[1-3]|7[156]|8[189]|9(?:[1289]|3[34]|4[0178]))|(?:264|837)[016-9]|2(?:57|93)[015-9]|(?:25[0468]|422|838)[01]|(?:47[59]|59[89]|8(?:6[68]|9))[019]","1(?:1|5(?:4[018]|5[017])|77|88|9[69])|2(?:2[127]|3[0-269]|4[59]|5(?:[1-3]|5[0-69]|9(?:17|99))|6(?:2|4[016-9])|7(?:[1-35]|8[0189])|8(?:[16]|3[0134]|9[0-5])|9(?:[028]|17))|4(?:2(?:[13-79]|8[014-6])|3[0-57]|[45]|6[248]|7[2-47]|9[29])|5(?:2|3(?:[045]|9(?:[0-58]|6[4-9]|7[0-35689]))|4[0-369]|5[29]|8[02389]|9[0-3])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9(?:[23]|4[0-59]|5[01569]|6[0167]))|8(?:2(?:[1258]|4[0-39]|9[0169])|3(?:[29]|60|7(?:[017-9]|6[6-8]))|49|51|6(?:[0-24]|36[2-57-9]|5(?:[0-389]|5[23])|6(?:[01]|9[178])|7(?:2[2-468]|3[78])|9[0145])|7[0-468]|8[68])|9(?:4[15]|5[138]|7[156]|8[189]|9(?:[1289]|3(?:31|4[357])|4[0178]))|(?:8294|96)[1-3]|2(?:57|93)[015-9]|(?:223|8699)[014-9]|(?:25[0468]|422|838)[01]|(?:48|8292|9[23])[1-9]|(?:47[59]|59[89]|8(?:68|9))[019]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["[14]|[289][2-9]|5[3-9]|7[2-4679]"],"0$1"],[,"(\\d{4})(\\d{2})(\\d{3,4})","$1-$2-$3",["007","0077"]],[,"(\\d{4})(\\d{2})(\\d{4})","$1-$2-$3",["008"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["800"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[25-9]"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3,4})","$1-$2-$3",["0"]],[,"(\\d{4})(\\d{4})(\\d{4,5})","$1-$2-$3",["0"]],[,"(\\d{4})(\\d{5})(\\d{5,6})","$1-$2-$3",["0"]],[,"(\\d{4})(\\d{6})(\\d{6,7})","$1-$2-$3",["0"]]],[[,"(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3",["(?:12|57|99)0"],"0$1"],[,"(\\d{4})(\\d)(\\d{4})","$1-$2-$3",["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|499|5(?:76|97)|746|8(?:3[89]|47|51)|9(?:80|9[16])","1(?:267|3(?:7[247]|9[278])|466|5(?:47|58|64)|6(?:3[245]|48|5[4-68]))|499[2468]|5(?:76|97)9|7468|8(?:3(?:8[7-9]|96)|477|51[2-9])|9(?:802|9(?:1[23]|69))|1(?:45|58)[67]","1(?:267|3(?:7[247]|9[278])|466|5(?:47|58|64)|6(?:3[245]|48|5[4-68]))|499[2468]|5(?:769|979[2-69])|7468|8(?:3(?:8[7-9]|96[2457-9])|477|51[2-9])|9(?:802|9(?:1[23]|69))|1(?:45|58)[67]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["60"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1-$2-$3",["3|4(?:2[09]|7[01])|6[1-9]","3|4(?:2(?:0|9[02-69])|7(?:0[019]|1))|6[1-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["1(?:1|5[45]|77|88|9[69])|2(?:2[1-37]|3[0-269]|4[59]|5|6[24]|7[1-358]|8[1369]|9[0-38])|4(?:[28][1-9]|3[0-57]|[45]|6[248]|7[2-579]|9[29])|5(?:2|3[0459]|4[0-369]|5[29]|8[02389]|9[0-389])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9[2-6])|8(?:2[124589]|3[26-9]|49|51|6|7[0-468]|8[68]|9[019])|9(?:[23][1-9]|4[15]|5[138]|6[1-3]|7[156]|8[189]|9[1-489])","1(?:1|5(?:4[018]|5[017])|77|88|9[69])|2(?:2(?:[127]|3[014-9])|3[0-269]|4[59]|5(?:[1-3]|5[0-69]|9[19])|62|7(?:[1-35]|8[0189])|8(?:[16]|3[0134]|9[0-5])|9(?:[028]|17))|4(?:2(?:[13-79]|8[014-6])|3[0-57]|[45]|6[248]|7[2-47]|8[1-9]|9[29])|5(?:2|3(?:[045]|9[0-8])|4[0-369]|5[29]|8[02389]|9[0-3])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9(?:[23]|4[0-59]|5[01569]|6[0167]))|8(?:2(?:[1258]|4[0-39]|9[0-2469])|3(?:[29]|60)|49|51|6(?:[0-24]|36|5[0-3589]|7[23]|9[01459])|7[0-468]|8[68])|9(?:[23][1-9]|4[15]|5[138]|6[1-3]|7[156]|8[189]|9(?:[1289]|3[34]|4[0178]))|(?:264|837)[016-9]|2(?:57|93)[015-9]|(?:25[0468]|422|838)[01]|(?:47[59]|59[89]|8(?:6[68]|9))[019]","1(?:1|5(?:4[018]|5[017])|77|88|9[69])|2(?:2[127]|3[0-269]|4[59]|5(?:[1-3]|5[0-69]|9(?:17|99))|6(?:2|4[016-9])|7(?:[1-35]|8[0189])|8(?:[16]|3[0134]|9[0-5])|9(?:[028]|17))|4(?:2(?:[13-79]|8[014-6])|3[0-57]|[45]|6[248]|7[2-47]|9[29])|5(?:2|3(?:[045]|9(?:[0-58]|6[4-9]|7[0-35689]))|4[0-369]|5[29]|8[02389]|9[0-3])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9(?:[23]|4[0-59]|5[01569]|6[0167]))|8(?:2(?:[1258]|4[0-39]|9[0169])|3(?:[29]|60|7(?:[017-9]|6[6-8]))|49|51|6(?:[0-24]|36[2-57-9]|5(?:[0-389]|5[23])|6(?:[01]|9[178])|7(?:2[2-468]|3[78])|9[0145])|7[0-468]|8[68])|9(?:4[15]|5[138]|7[156]|8[189]|9(?:[1289]|3(?:31|4[357])|4[0178]))|(?:8294|96)[1-3]|2(?:57|93)[015-9]|(?:223|8699)[014-9]|(?:25[0468]|422|838)[01]|(?:48|8292|9[23])[1-9]|(?:47[59]|59[89]|8(?:68|9))[019]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["[14]|[289][2-9]|5[3-9]|7[2-4679]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["800"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[25-9]"],"0$1"]],[,,"20\\d{8}",,,,"2012345678",,,[10]],,,[,,"00(?:777(?:[01]|(?:5|8\\d)\\d)|882[1245]\\d\\d)\\d\\d|00(?:37|66|78)\\d{6,13}"],[,,"570\\d{6}",,,,"570123456",,,[9]],,,[,,,,,,,,,[-1]]],KE:[,[,,"(?:[17]\\d\\d|900)\\d{6}|(?:2|80)0\\d{6,7}|[4-6]\\d{6,8}",,,,,,,[7,8,9,10]],[,,"(?:4[245]|5[1-79]|6[01457-9])\\d{5,7}|(?:4[136]|5[08]|62)\\d{7}|(?:[24]0|66)\\d{6,7}",,,,"202012345",,,[7,8,9]],[,,"(?:1(?:0[0-8]|1[0-7]|2[014]|30)|7\\d\\d)\\d{6}",,,,"712123456",,,[9]],[,,"800[02-8]\\d{5,6}",,,,"800223456",,,[9,10]],[,,"900[02-9]\\d{5}",,,,"900223456",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"KE",254,"000","0",,,"0",,,,[[,"(\\d{2})(\\d{5,7})","$1 $2",["[24-6]"],"0$1"],[,"(\\d{3})(\\d{6})","$1 $2",["[17]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[89]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KG:[,[,,"8\\d{9}|[235-9]\\d{8}",,,,,,,[9,10],[5,6]],[,,"312(?:5[0-79]\\d|9(?:[0-689]\\d|7[0-24-9]))\\d{3}|(?:3(?:1(?:2[0-46-8]|3[1-9]|47|[56]\\d)|2(?:22|3[0-479]|6[0-7])|4(?:22|5[6-9]|6\\d)|5(?:22|3[4-7]|59|6\\d)|6(?:22|5[35-7]|6\\d)|7(?:22|3[468]|4[1-9]|59|[67]\\d)|9(?:22|4[1-8]|6\\d))|6(?:09|12|2[2-4])\\d)\\d{5}",,,,"312123456",,,[9],[5,6]],[,,"312(?:58\\d|973)\\d{3}|(?:2(?:0[0-35]|2\\d)|5[0-24-7]\\d|600|7(?:[07]\\d|55)|88[08]|9(?:12|9[05-9]))\\d{6}",,,,"700123456",,,[9]],[,,"800\\d{6,7}",,,,"800123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"KG",996,"00","0",,,"0",,,,[[,"(\\d{4})(\\d{5})","$1 $2",["3(?:1[346]|[24-79])"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235-79]|88"],"0$1"],[,"(\\d{3})(\\d{3})(\\d)(\\d{2,3})","$1 $2 $3 $4",["8"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KH:[,[,,"1\\d{9}|[1-9]\\d{7,8}",,,,,,,[8,9,10],[6,7]],[,,"23(?:4(?:[2-4]|[56]\\d)|[568]\\d\\d)\\d{4}|23[236-9]\\d{5}|(?:2[4-6]|3[2-6]|4[2-4]|[5-7][2-5])(?:(?:[237-9]|4[56]|5\\d)\\d{5}|6\\d{5,6})",,,,"23756789",,,[8,9],[6,7]],[,,"(?:(?:1[28]|3[18]|9[67])\\d|6[016-9]|7(?:[07-9]|[16]\\d)|8(?:[013-79]|8\\d))\\d{6}|(?:1\\d|9[0-57-9])\\d{6}|(?:2[3-6]|3[2-6]|4[2-4]|[5-7][2-5])48\\d{5}",,,,"91234567",,,[8,9]],[,,"1800(?:1\\d|2[019])\\d{4}",,,,"1800123456",,,[10]],[,,"1900(?:1\\d|2[09])\\d{4}",,,,"1900123456",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"KH",855,"00[14-9]","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-9]"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KI:[,[,,"(?:[37]\\d|6[0-79])\\d{6}|(?:[2-48]\\d|50)\\d{3}",,,,,,,[5,8]],[,,"(?:[24]\\d|3[1-9]|50|65(?:02[12]|12[56]|22[89]|[3-5]00)|7(?:27\\d\\d|3100|5(?:02[12]|12[56]|22[89]|[34](?:00|81)|500))|8[0-5])\\d{3}",,,,"31234"],[,,"(?:6200[01]|7(?:310[1-9]|5(?:02[03-9]|12[0-47-9]|22[0-7]|[34](?:0[1-9]|8[02-9])|50[1-9])))\\d{3}|(?:63\\d\\d|7(?:(?:[0146-9]\\d|2[0-689])\\d|3(?:[02-9]\\d|1[1-9])|5(?:[0-2][013-9]|[34][1-79]|5[1-9]|[6-9]\\d)))\\d{4}",,,,"72001234",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"30(?:0[01]\\d\\d|12(?:11|20))\\d\\d",,,,"30010000",,,[8]],"KI",686,"00","0",,,"0",,,,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KM:[,[,,"[3478]\\d{6}",,,,,,,[7],[4]],[,,"7[4-7]\\d{5}",,,,"7712345",,,,[4]],[,,"[34]\\d{6}",,,,"3212345"],[,,,,,,,,,[-1]],[,,"8\\d{6}",,,,"8001234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"KM",269,"00",,,,,,,,[[,"(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[3478]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KN:[,[,,"(?:[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"869(?:2(?:29|36)|302|4(?:6[015-9]|70)|56[5-7])\\d{4}",,,,"8692361234",,,,[7]],[,,"869(?:48[89]|55[6-8]|66\\d|76[02-7])\\d{4}",,,,"8697652917",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"KN",1,"011","1",,,"([2-7]\\d{6})$|1","869$1",,,,,[,,,,,,,,,[-1]],,"869",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KP:[,[,,"85\\d{6}|(?:19\\d|[2-7])\\d{7}",,,,,,,[8,10],[6,7]],[,,"(?:(?:195|2)\\d|3[19]|4[159]|5[37]|6[17]|7[39]|85)\\d{6}",,,,"21234567",,,,[6,7]],[,,"19[1-3]\\d{7}",,,,"1921234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"KP",850,"00|99","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["8"],"0$1"],[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2-7]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,"238[02-9]\\d{4}|2(?:[0-24-9]\\d|3[0-79])\\d{5}",,,,,,,[8]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KR:[,[,,"00[1-9]\\d{8,11}|(?:[12]|5\\d{3})\\d{7}|[13-6]\\d{9}|(?:[1-6]\\d|80)\\d{7}|[3-6]\\d{4,5}|(?:00|7)0\\d{8}",,,,,,,[5,6,8,9,10,11,12,13,14],[3,4,7]],[,,"(?:2|3[1-3]|[46][1-4]|5[1-5])[1-9]\\d{6,7}|(?:3[1-3]|[46][1-4]|5[1-5])1\\d{2,3}",,,,"22123456",,,[5,6,8,9,10],[3,4,7]],[,,"1(?:05(?:[0-8]\\d|9[0-6])|22[13]\\d)\\d{4,5}|1(?:0[0-46-9]|[16-9]\\d|2[013-9])\\d{6,7}",,,,"1020000000",,,[9,10]],[,,"00(?:308\\d{6,7}|798\\d{7,9})|(?:00368|[38]0)\\d{7}",,,,"801234567",,,[9,11,12,13,14]],[,,"60[2-9]\\d{6}",,,,"602345678",,,[9]],[,,,,,,,,,[-1]],[,,"50\\d{8,9}",,,,"5012345678",,,[10,11]],[,,"70\\d{8}",,,,"7012345678",,,[10]],"KR",82,"00(?:[125689]|3(?:[46]5|91)|7(?:00|27|3|55|6[126]))","0",,,"0(8(?:[1-46-8]|5\\d\\d))?",,,,[[,"(\\d{5})","$1",["1[016-9]1","1[016-9]11","1[016-9]114"],"0$1"],[,"(\\d{2})(\\d{3,4})","$1-$2",["(?:3[1-3]|[46][1-4]|5[1-5])1"],"0$1","0$CC-$1"],[,"(\\d{4})(\\d{4})","$1-$2",["1"]],[,"(\\d)(\\d{3,4})(\\d{4})","$1-$2-$3",["2"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[36]0|8"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1-$2-$3",["[1346]|5[1-5]"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[57]"],"0$1","0$CC-$1"],[,"(\\d{5})(\\d{3})(\\d{3})","$1 $2 $3",["003","0030"]],[,"(\\d{2})(\\d{5})(\\d{4})","$1-$2-$3",["5"],"0$1","0$CC-$1"],[,"(\\d{5})(\\d{3,4})(\\d{4})","$1 $2 $3",["0"]],[,"(\\d{5})(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3 $4",["0"]]],[[,"(\\d{2})(\\d{3,4})","$1-$2",["(?:3[1-3]|[46][1-4]|5[1-5])1"],"0$1","0$CC-$1"],[,"(\\d{4})(\\d{4})","$1-$2",["1"]],[,"(\\d)(\\d{3,4})(\\d{4})","$1-$2-$3",["2"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[36]0|8"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1-$2-$3",["[1346]|5[1-5]"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[57]"],"0$1","0$CC-$1"],[,"(\\d{2})(\\d{5})(\\d{4})","$1-$2-$3",["5"],"0$1","0$CC-$1"]],[,,"15\\d{7,8}",,,,"1523456789",,,[9,10]],,,[,,"00(?:3(?:08\\d{6,7}|68\\d{7})|798\\d{7,9})",,,,,,,[11,12,13,14]],[,,"1(?:5(?:22|33|44|66|77|88|99)|6(?:[07]0|44|6[0168]|88)|8(?:00|33|55|77|99))\\d{4}",,,,"15441234",,,[8]],,,[,,,,,,,,,[-1]]],KW:[,[,,"18\\d{5}|(?:[2569]\\d|41)\\d{6}",,,,,,,[7,8]],[,,"2(?:[23]\\d\\d|4(?:[1-35-9]\\d|44)|5(?:0[034]|[2-46]\\d|5[1-3]|7[1-7]))\\d{4}",,,,"22345678",,,[8]],[,,"(?:41\\d\\d|5(?:(?:[05]\\d|1[0-7]|6[56])\\d|2(?:22|5[25])|7(?:55|77)|88[58])|6(?:(?:0[034679]|5[015-9]|6\\d)\\d|1(?:00|11|6[16])|2[26]2|3[36]3|4[46]4|7(?:0[013-9]|[67]\\d)|8[68]8|9(?:[069]\\d|3[039]))|9(?:(?:[04679]\\d|8[057-9])\\d|1(?:1[01]|99)|2(?:00|2\\d)|3(?:00|3[03])|5(?:00|5\\d)))\\d{4}",,,,"50012345",,,[8]],[,,"18\\d{5}",,,,"1801234",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"KW",965,"00",,,,,,,,[[,"(\\d{4})(\\d{3,4})","$1 $2",["[169]|2(?:[235]|4[1-35-9])|52"]],[,"(\\d{3})(\\d{5})","$1 $2",["[245]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KY:[,[,,"(?:345|[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"345(?:2(?:22|3[23]|44|66)|333|444|6(?:23|38|40)|7(?:30|4[35-79]|6[6-9]|77)|8(?:00|1[45]|4[89]|88)|9(?:14|4[035-9]))\\d{4}",,,,"3452221234",,,,[7]],[,,"345(?:32[1-9]|42[0-4]|5(?:1[67]|2[5-79]|4[6-9]|50|76)|649|82[56]|9(?:1[679]|2[2-9]|3[06-9]|90))\\d{4}",,,,"3453231234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002345678"],[,,"(?:345976|900[2-9]\\d\\d)\\d{4}",,,,"9002345678"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"KY",1,"011","1",,,"([2-9]\\d{6})$|1","345$1",,,,,[,,,,,,,,,[-1]],,"345",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],KZ:[,[,,"(?:33622|8\\d{8})\\d{5}|[78]\\d{9}",,,,,,,[10,14],[5,6,7]],[,,"(?:33622|7(?:1(?:0(?:[23]\\d|4[0-3]|59|63)|1(?:[23]\\d|4[0-79]|59)|2(?:[23]\\d|59)|3(?:2\\d|3[0-79]|4[0-35-9]|59)|4(?:[24]\\d|3[013-9]|5[1-9]|97)|5(?:2\\d|3[1-9]|4[0-7]|59)|6(?:[2-4]\\d|5[19]|61)|72\\d|8(?:[27]\\d|3[1-46-9]|4[0-5]|59))|2(?:1(?:[23]\\d|4[46-9]|5[3469])|2(?:2\\d|3[0679]|46|5[12679])|3(?:[2-4]\\d|5[139])|4(?:2\\d|3[1-35-9]|59)|5(?:[23]\\d|4[0-8]|59|61)|6(?:2\\d|3[1-9]|4[0-4]|59)|7(?:[2379]\\d|40|5[279])|8(?:[23]\\d|4[0-3]|59)|9(?:2\\d|3[124578]|59))))\\d{5}",,,,"7123456789",,,[10],[5,6,7]],[,,"7(?:0[0-25-8]|47|6[0-4]|7[15-8]|85)\\d{7}",,,,"7710009998",,,[10]],[,,"8(?:00|108\\d{3})\\d{7}",,,,"8001234567"],[,,"809\\d{7}",,,,"8091234567",,,[10]],[,,,,,,,,,[-1]],[,,"808\\d{7}",,,,"8081234567",,,[10]],[,,"751\\d{7}",,,,"7511234567",,,[10]],"KZ",7,"810","8",,,"8",,"8~10",,,,[,,,,,,,,,[-1]],,"33|7",[,,"751\\d{7}",,,,,,,[10]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],LA:[,[,,"[23]\\d{9}|3\\d{8}|(?:[235-8]\\d|41)\\d{6}",,,,,,,[8,9,10],[6]],[,,"(?:2[13]|[35-7][14]|41|8[1468])\\d{6}",,,,"21212862",,,[8],[6]],[,,"208[78]\\d{6}|(?:20[23579]|30[24])\\d{7}",,,,"2023123456",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"LA",856,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2[13]|3[14]|[4-8]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["30[0135-9]"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[23]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"30[0135-9]\\d{6}",,,,"301234567",,,[9]],,,[,,,,,,,,,[-1]]],LB:[,[,,"[27-9]\\d{7}|[13-9]\\d{6}",,,,,,,[7,8]],[,,"7(?:62|8[0-7]|9[04-9])\\d{4}|(?:[14-69]\\d|2(?:[14-69]\\d|[78][1-9])|7[2-57]|8[02-9])\\d{5}",,,,"1123456"],[,,"793(?:[01]\\d|2[0-4])\\d{3}|(?:(?:3|81)\\d|7(?:[01]\\d|6[013-9]|8[89]|9[12]))\\d{5}",,,,"71123456"],[,,,,,,,,,[-1]],[,,"9[01]\\d{6}",,,,"90123456",,,[8]],[,,"80\\d{6}",,,,"80123456",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"LB",961,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[13-69]|7(?:[2-57]|62|8[0-7]|9[04-9])|8[02-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[27-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],LC:[,[,,"(?:[58]\\d\\d|758|900)\\d{7}",,,,,,,[10],[7]],[,,"758(?:234|4(?:30|5\\d|6[2-9]|8[0-2])|57[0-2]|(?:63|75)8)\\d{4}",,,,"7584305678",,,,[7]],[,,"758(?:28[4-7]|384|4(?:6[01]|8[4-9])|5(?:1[89]|20|84)|7(?:1[2-9]|2\\d|3[0-3])|812)\\d{4}",,,,"7582845678",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"LC",1,"011","1",,,"([2-8]\\d{6})$|1","758$1",,,,,[,,,,,,,,,[-1]],,"758",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],LI:[,[,,"[68]\\d{8}|(?:[2378]\\d|90)\\d{5}",,,,,,,[7,9]],[,,"(?:2(?:01|1[27]|2[02]|3\\d|6[02-578]|96)|3(?:[24]0|33|7[0135-7]|8[048]|9[0269]))\\d{4}",,,,"2345678",,,[7]],[,,"(?:6(?:(?:4[5-9]|5[0-469])\\d|6(?:[024-6]\\d|[17]0|3[7-9]))\\d|7(?:[37-9]\\d|42|56))\\d{4}",,,,"660234567"],[,,"8002[28]\\d\\d|80(?:05\\d|9)\\d{4}",,,,"8002222"],[,,"90(?:02[258]|1(?:23|3[14])|66[136])\\d\\d",,,,"9002222",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"LI",423,"00","0",,,"(1001)|0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[2379]|8(?:0[09]|7)","[2379]|8(?:0(?:02|9)|7)"],,"$CC $1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["69"],,"$CC $1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"],,"$CC $1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"870(?:28|87)\\d\\d",,,,"8702812",,,[7]],,,[,,"697(?:42|56|[78]\\d)\\d{4}",,,,"697861234",,,[9]]],LK:[,[,,"[1-9]\\d{8}",,,,,,,[9],[7]],[,,"(?:12[2-9]|602|8[12]\\d|9(?:1\\d|22|9[245]))\\d{6}|(?:11|2[13-7]|3[1-8]|4[157]|5[12457]|6[35-7])[2-57]\\d{6}",,,,"112345678",,,,[7]],[,,"7(?:[0-25-8]\\d|4[0-4])\\d{6}",,,,"712345678"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"LK",94,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[1-689]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"1973\\d{5}",,,,"197312345"],,,[,,,,,,,,,[-1]]],LR:[,[,,"(?:[245]\\d|33|77|88)\\d{7}|(?:2\\d|[4-6])\\d{6}",,,,,,,[7,8,9]],[,,"2\\d{7}",,,,"21234567",,,[8]],[,,"(?:(?:(?:22|33)0|555|(?:77|88)\\d)\\d|4(?:240|[67]))\\d{5}|[56]\\d{6}",,,,"770123456",,,[7,9]],[,,,,,,,,,[-1]],[,,"332(?:02|[34]\\d)\\d{4}",,,,"332021234",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"LR",231,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["4[67]|[56]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[2-578]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],LS:[,[,,"(?:[256]\\d\\d|800)\\d{5}",,,,,,,[8]],[,,"2\\d{7}",,,,"22123456"],[,,"[56]\\d{7}",,,,"50123456"],[,,"800[1256]\\d{4}",,,,"80021234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"LS",266,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[2568]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],LT:[,[,,"(?:[3469]\\d|52|[78]0)\\d{6}",,,,,,,[8]],[,,"(?:3[1478]|4[124-6]|52)\\d{6}",,,,"31234567"],[,,"6\\d{7}",,,,"61234567"],[,,"80[02]\\d{5}",,,,"80012345"],[,,"9(?:0[0239]|10)\\d{5}",,,,"90012345"],[,,"808\\d{5}",,,,"80812345"],[,,"70[05]\\d{5}",,,,"70012345"],[,,"[89]01\\d{5}",,,,"80123456"],"LT",370,"00","0",,,"[08]",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["52[0-7]"],"(0-$1)",,1],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[7-9]"],"0 $1",,1],[,"(\\d{2})(\\d{6})","$1 $2",["37|4(?:[15]|6[1-8])"],"(0-$1)",,1],[,"(\\d{3})(\\d{5})","$1 $2",["[3-6]"],"(0-$1)",,1]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"70[67]\\d{5}",,,,"70712345"],,,[,,,,,,,,,[-1]]],LU:[,[,,"35[013-9]\\d{4,8}|6\\d{8}|35\\d{2,4}|(?:[2457-9]\\d|3[0-46-9])\\d{2,9}",,,,,,,[4,5,6,7,8,9,10,11]],[,,"(?:35[013-9]|80[2-9]|90[89])\\d{1,8}|(?:2[2-9]|3[0-46-9]|[457]\\d|8[13-9]|9[2-579])\\d{2,9}",,,,"27123456"],[,,"6(?:[269][18]|5[1568]|7[189]|81)\\d{6}",,,,"628123456",,,[9]],[,,"800\\d{5}",,,,"80012345",,,[8]],[,,"90[015]\\d{5}",,,,"90012345",,,[8]],[,,"801\\d{5}",,,,"80112345",,,[8]],[,,,,,,,,,[-1]],[,,"20(?:1\\d{5}|[2-689]\\d{1,7})",,,,"20201234",,,[4,5,6,7,8,9,10]],"LU",352,"00",,,,"(15(?:0[06]|1[12]|[35]5|4[04]|6[26]|77|88|99)\\d)",,,,[[,"(\\d{2})(\\d{3})","$1 $2",["2(?:0[2-689]|[2-9])|[3-57]|8(?:0[2-9]|[13-9])|9(?:0[89]|[2-579])"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["2(?:0[2-689]|[2-9])|[3-57]|8(?:0[2-9]|[13-9])|9(?:0[89]|[2-579])"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["20[2-689]"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})","$1 $2 $3 $4",["2(?:[0367]|4[3-8])"],,"$CC $1"],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["80[01]|90[015]"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["20"],,"$CC $1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})","$1 $2 $3 $4 $5",["2(?:[0367]|4[3-8])"],,"$CC $1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{1,5})","$1 $2 $3 $4",["[3-57]|8[13-9]|9(?:0[89]|[2-579])|(?:2|80)[2-9]"],,"$CC $1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],LV:[,[,,"(?:[268]\\d|90)\\d{6}",,,,,,,[8]],[,,"6\\d{7}",,,,"63123456"],[,,"23(?:23[0-57-9]|33[0238])\\d{3}|2(?:[0-24-9]\\d\\d|3(?:0[07]|[14-9]\\d|2[024-9]|3[0-24-9]))\\d{4}",,,,"21234567"],[,,"80\\d{6}",,,,"80123456"],[,,"90\\d{6}",,,,"90123456"],[,,"81\\d{6}",,,,"81123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"LV",371,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[269]|8[01]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],LY:[,[,,"[2-9]\\d{8}",,,,,,,[9],[7]],[,,"(?:2(?:0[56]|[1-6]\\d|7[124579]|8[124])|3(?:1\\d|2[2356])|4(?:[17]\\d|2[1-357]|5[2-4]|8[124])|5(?:[1347]\\d|2[1-469]|5[13-5]|8[1-4])|6(?:[1-479]\\d|5[2-57]|8[1-5])|7(?:[13]\\d|2[13-79])|8(?:[124]\\d|5[124]|84))\\d{6}",,,,"212345678",,,,[7]],[,,"9[1-6]\\d{7}",,,,"912345678"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"LY",218,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{7})","$1-$2",["[2-9]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MA:[,[,,"[5-8]\\d{8}",,,,,,,[9]],[,,"5(?:2(?:[0-25-79]\\d|3[1-578]|4[02-46-8]|8[0235-7])|3(?:[0-47]\\d|5[02-9]|6[02-8]|8[014-9]|9[3-9])|(?:4[067]|5[03])\\d)\\d{5}",,,,"520123456"],[,,"(?:6(?:[0-79]\\d|8[0-247-9])|7(?:[0167]\\d|2[0-4]|5[01]|8[0-3]))\\d{6}",,,,"650123456"],[,,"80[0-7]\\d{6}",,,,"801234567"],[,,"89\\d{7}",,,,"891234567"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:592(?:4[0-2]|93)|80[89]\\d\\d)\\d{4}",,,,"592401234"],"MA",212,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["5[45]"],"0$1"],[,"(\\d{4})(\\d{5})","$1-$2",["5(?:2[2-46-9]|3[3-9]|9)|8(?:0[89]|92)"],"0$1"],[,"(\\d{2})(\\d{7})","$1-$2",["8"],"0$1"],[,"(\\d{3})(\\d{6})","$1-$2",["[5-7]"],"0$1"]],,[,,,,,,,,,[-1]],1,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MC:[,[,,"(?:[3489]|6\\d)\\d{7}",,,,,,,[8,9]],[,,"(?:870|9[2-47-9]\\d)\\d{5}",,,,"99123456",,,[8]],[,,"4(?:[469]\\d|5[1-9])\\d{5}|(?:3|6\\d)\\d{7}",,,,"612345678"],[,,"(?:800|90\\d)\\d{5}",,,,"90123456",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"MC",377,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3",["87"]],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["4"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[389]"]],[,"(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["6"],"0$1"]],[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["4"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[389]"]],[,"(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["6"],"0$1"]],[,,,,,,,,,[-1]],,,[,,"8[07]0\\d{5}",,,,,,,[8]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MD:[,[,,"(?:[235-7]\\d|[89]0)\\d{6}",,,,,,,[8]],[,,"(?:(?:2[1-9]|3[1-79])\\d|5(?:33|5[257]))\\d{5}",,,,"22212345"],[,,"562\\d{5}|(?:6\\d|7[16-9])\\d{6}",,,,"62112345"],[,,"800\\d{5}",,,,"80012345"],[,,"90[056]\\d{5}",,,,"90012345"],[,,"808\\d{5}",,,,"80812345"],[,,,,,,,,,[-1]],[,,"3[08]\\d{6}",,,,"30123456"],"MD",373,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{5})","$1 $2",["[89]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["22|3"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[25-7]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"803\\d{5}",,,,"80312345"],,,[,,,,,,,,,[-1]]],ME:[,[,,"(?:20|[3-79]\\d)\\d{6}|80\\d{6,7}",,,,,,,[8,9],[6]],[,,"(?:20[2-8]|3(?:[0-2][2-7]|3[24-7])|4(?:0[2-467]|1[2467])|5(?:0[2467]|1[24-7]|2[2-467]))\\d{5}",,,,"30234567",,,[8],[6]],[,,"6(?:[07-9]\\d|3[024]|6[0-25])\\d{5}",,,,"67622901",,,[8]],[,,"80(?:[0-2578]|9\\d)\\d{5}",,,,"80080002"],[,,"9(?:4[1568]|5[178])\\d{5}",,,,"94515151",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"78[1-49]\\d{5}",,,,"78108780",,,[8]],"ME",382,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-9]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"77[1-9]\\d{5}",,,,"77273012",,,[8]],,,[,,,,,,,,,[-1]]],MF:[,[,,"(?:590\\d|7090)\\d{5}|(?:69|80|9\\d)\\d{7}",,,,,,,[9]],[,,"590(?:0[079]|[14]3|[27][79]|3[03-7]|5[0-268]|87)\\d{4}",,,,"590271234"],[,,"(?:69(?:0\\d\\d|1(?:2[2-9]|3[0-5])|4(?:0[89]|1[2-6]|9\\d)|6(?:1[016-9]|5[0-4]|[67]\\d))|7090[0-4])\\d{4}",,,,"690001234"],[,,"80[0-5]\\d{6}",,,,"800012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9(?:(?:39[5-7]|76[018])\\d|475[0-5])\\d{4}",,,,"976012345"],"MF",590,"00","0",,,"0",,,,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MG:[,[,,"[23]\\d{8}",,,,,,,[9],[7]],[,,"2072[29]\\d{4}|20(?:2\\d|4[47]|5[3467]|6[279]|7[356]|8[268]|9[2457])\\d{5}",,,,"202123456",,,,[7]],[,,"3[2-47-9]\\d{7}",,,,"321234567"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"22\\d{7}",,,,"221234567"],"MG",261,"00","0",,,"([24-9]\\d{6})$|0","20$1",,,[[,"(\\d{2})(\\d{2})(\\d{3})(\\d{2})","$1 $2 $3 $4",["[23]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MH:[,[,,"329\\d{4}|(?:[256]\\d|45)\\d{5}",,,,,,,[7]],[,,"(?:247|528|625)\\d{4}",,,,"2471234"],[,,"(?:(?:23|54)5|329|45[35-8])\\d{4}",,,,"2351234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"635\\d{4}",,,,"6351234"],"MH",692,"011","1",,,"1",,,,[[,"(\\d{3})(\\d{4})","$1-$2",["[2-6]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MK:[,[,,"[2-578]\\d{7}",,,,,,,[8],[6,7]],[,,"(?:(?:2(?:62|77)0|3444)\\d|4[56]440)\\d{3}|(?:34|4[357])700\\d{3}|(?:2(?:[0-3]\\d|5[0-578]|6[01]|82)|3(?:1[3-68]|[23][2-68]|4[23568])|4(?:[23][2-68]|4[3-68]|5[2568]|6[25-8]|7[24-68]|8[4-68]))\\d{5}",,,,"22012345",,,,[6,7]],[,,"7(?:3555|(?:474|9[019]7)7)\\d{3}|7(?:[0-25-8]\\d\\d|3(?:[1-48]\\d|6[01]|7[01578])|4(?:2\\d|60|7[01578])|9(?:[2-4]\\d|5[01]|7[015]))\\d{4}",,,,"72345678"],[,,"800\\d{5}",,,,"80012345"],[,,"5\\d{7}",,,,"50012345"],[,,"8(?:0[1-9]|[1-9]\\d)\\d{5}",,,,"80123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"MK",389,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["2|34[47]|4(?:[37]7|5[47]|64)"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[347]"],"0$1"],[,"(\\d{3})(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["[58]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],ML:[,[,,"[24-9]\\d{7}",,,,,,,[8]],[,,"2(?:07[0-8]|12[67])\\d{4}|(?:2(?:02|1[4-689])|4(?:0[0-4]|4[1-39]))\\d{5}",,,,"20212345"],[,,"2(?:0(?:01|79)|17\\d)\\d{4}|(?:5[01]|[679]\\d|8[2-49])\\d{6}",,,,"65012345"],[,,"80\\d{6}",,,,"80012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"ML",223,"00",,,,,,,,[[,"(\\d{4})","$1",["67[057-9]|74[045]","67(?:0[09]|[59]9|77|8[89])|74(?:0[02]|44|55)"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24-9]"]]],[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24-9]"]]],[,,,,,,,,,[-1]],,,[,,"80\\d{6}"],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MM:[,[,,"1\\d{5,7}|95\\d{6}|(?:[4-7]|9[0-46-9])\\d{6,8}|(?:2|8\\d)\\d{5,8}",,,,,,,[6,7,8,9,10],[5]],[,,"(?:1(?:(?:12|[28]\\d|3[56]|7[3-6]|9[0-6])\\d|4(?:2[29]|62|7[0-2]|83)|6)|2(?:2(?:00|8[34])|4(?:0\\d|[26]2|7[0-2]|83)|51\\d\\d)|4(?:2(?:2\\d\\d|48[013])|3(?:20\\d|4(?:70|83)|56)|420\\d|5(?:2\\d|470))|6(?:0(?:[23]|88\\d)|(?:124|[56]2\\d)\\d|2472|3(?:20\\d|470)|4(?:2[04]\\d|472)|7(?:3\\d\\d|4[67]0|8(?:[01459]\\d|8))))\\d{4}|5(?:2(?:2\\d{5,6}|47[02]\\d{4})|(?:3472|4(?:2(?:1|86)|470)|522\\d|6(?:20\\d|483)|7(?:20\\d|48[01])|8(?:20\\d|47[02])|9(?:20\\d|470))\\d{4})|7(?:(?:0470|4(?:25\\d|470)|5(?:202|470|96\\d))\\d{4}|1(?:20\\d{4,5}|4(?:70|83)\\d{4}))|8(?:1(?:2\\d{5,6}|4(?:10|7[01]\\d)\\d{3})|2(?:2\\d{5,6}|(?:320|490\\d)\\d{3})|(?:3(?:2\\d\\d|470)|4[24-7]|5(?:(?:2\\d|51)\\d|4(?:[1-35-9]\\d|4[0-57-9]))|6[23])\\d{4})|(?:1[2-6]\\d|4(?:2[24-8]|3[2-7]|[46][2-6]|5[3-5])|5(?:[27][2-8]|3[2-68]|4[24-8]|5[23]|6[2-4]|8[24-7]|9[2-7])|6(?:[19]20|42[03-6]|(?:52|7[45])\\d)|7(?:[04][24-8]|[15][2-7]|22|3[2-4])|8(?:1[2-689]|2[2-8]|(?:[35]2|64)\\d))\\d{4}|25\\d{5,6}|(?:2[2-9]|6(?:1[2356]|[24][2-6]|3[24-6]|5[2-4]|6[2-8]|7[235-7]|8[245]|9[24])|8(?:3[24]|5[245]))\\d{4}",,,,"1234567",,,[6,7,8,9],[5]],[,,"(?:17[01]|9(?:2(?:[0-4]|[56]\\d\\d)|(?:3(?:[0-36]|4\\d)|(?:6\\d|8[89]|9[4-8])\\d|7(?:3|40|[5-9]\\d))\\d|4(?:(?:[0245]\\d|[1379])\\d|88)|5[0-6])\\d)\\d{4}|9[69]1\\d{6}|9(?:[68]\\d|9[089])\\d{5}",,,,"92123456",,,[7,8,9,10]],[,,"80080(?:0[1-9]|2\\d)\\d{3}",,,,"8008001234",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"1333\\d{4}|[12]468\\d{4}",,,,"13331234",,,[8]],"MM",95,"00","0",,,"0",,,,[[,"(\\d)(\\d{2})(\\d{3})","$1 $2 $3",["16|2"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["4(?:[2-46]|5[3-5])|5|6(?:[1-689]|7[235-7])|7(?:[0-4]|5[2-7])|8[1-5]|(?:60|86)[23]"],"0$1"],[,"(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[12]|452|678|86","[12]|452|6788|86"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[4-7]|8[1-35]"],"0$1"],[,"(\\d)(\\d{3})(\\d{4,6})","$1 $2 $3",["9(?:2[0-4]|[35-9]|4[137-9])"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"],[,"(\\d)(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["92"],"0$1"],[,"(\\d)(\\d{5})(\\d{4})","$1 $2 $3",["9"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MN:[,[,,"[12]\\d{7,9}|[5-9]\\d{7}",,,,,,,[8,9,10],[4,5,6]],[,,"[12]2[1-3]\\d{5,6}|(?:(?:[12](?:1|27)|5[368])\\d\\d|7(?:0(?:[0-5]\\d|7[078]|80)|128))\\d{4}|[12](?:3[2-8]|4[2-68]|5[1-4689])\\d{6,7}",,,,"53123456",,,,[4,5,6]],[,,"(?:83[01]|92[039])\\d{5}|(?:5[05]|6[069]|72|8[015689]|9[013-9])\\d{6}",,,,"88123456",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"712[0-79]\\d{4}|7(?:1[013-9]|[5-9]\\d)\\d{5}",,,,"75123456",,,[8]],"MN",976,"001","0",,,"0",,,,[[,"(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["[12]1"],"0$1"],[,"(\\d{4})(\\d{4})","$1 $2",["[5-9]"]],[,"(\\d{3})(\\d{5,6})","$1 $2",["[12]2[1-3]"],"0$1"],[,"(\\d{4})(\\d{5,6})","$1 $2",["[12](?:27|3[2-8]|4[2-68]|5[1-4689])","[12](?:27|3[2-8]|4[2-68]|5[1-4689])[0-3]"],"0$1"],[,"(\\d{5})(\\d{4,5})","$1 $2",["[12]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MO:[,[,,"0800\\d{3}|(?:28|[68]\\d)\\d{6}",,,,,,,[7,8]],[,,"(?:28[2-9]|8(?:11|[2-57-9]\\d))\\d{5}",,,,"28212345",,,[8]],[,,"6800[0-79]\\d{3}|6(?:[235]\\d\\d|6(?:0[0-5]|[1-9]\\d)|8(?:0[1-9]|[14-8]\\d|2[5-9]|[39][0-4]))\\d{4}",,,,"66123456",,,[8]],[,,"0800\\d{3}",,,,"0800501",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"MO",853,"00",,,,,,,,[[,"(\\d{4})(\\d{3})","$1 $2",["0"]],[,"(\\d{4})(\\d{4})","$1 $2",["[268]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MP:[,[,,"[58]\\d{9}|(?:67|90)0\\d{7}",,,,,,,[10],[7]],[,,"670(?:2(?:3[3-7]|56|8[4-8])|32[1-38]|4(?:33|8[348])|5(?:32|55|88)|6(?:64|70|82)|78[3589]|8[3-9]8|989)\\d{4}",,,,"6702345678",,,,[7]],[,,"670(?:2(?:3[3-7]|56|8[4-8])|32[1-38]|4(?:33|8[348])|5(?:32|55|88)|6(?:64|70|82)|78[3589]|8[3-9]8|989)\\d{4}",,,,"6702345678",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"MP",1,"011","1",,,"([2-9]\\d{6})$|1","670$1",,1,,,[,,,,,,,,,[-1]],,"670",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MQ:[,[,,"(?:596\\d|7091)\\d{5}|(?:69|[89]\\d)\\d{7}",,,,,,,[9]],[,,"(?:596(?:[03-7]\\d|1[05]|2[7-9]|8[0-39]|9[04-9])|80[6-9]\\d\\d|9(?:477[6-9]|767[4589]))\\d{4}",,,,"596301234"],[,,"(?:69[67]\\d\\d|7091[0-3])\\d{4}",,,,"696201234"],[,,"80[0-5]\\d{6}",,,,"800012345"],[,,"8[129]\\d{7}",,,,"810123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9(?:397[0-3]|477[0-5]|76(?:6\\d|7[0-367]))\\d{4}",,,,"976612345"],"MQ",596,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-79]|8(?:0[6-9]|[36])"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MR:[,[,,"(?:[2-4]\\d\\d|800)\\d{5}",,,,,,,[8]],[,,"(?:25[08]|35\\d|45[1-7])\\d{5}",,,,"35123456"],[,,"[2-4][0-46-9]\\d{6}",,,,"22123456"],[,,"800\\d{5}",,,,"80012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"MR",222,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-48]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MS:[,[,,"(?:[58]\\d\\d|664|900)\\d{7}",,,,,,,[10],[7]],[,,"6644(?:1[0-3]|91)\\d{4}",,,,"6644912345",,,,[7]],[,,"664(?:3(?:49|9[1-6])|49[2-6])\\d{4}",,,,"6644923456",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"MS",1,"011","1",,,"([34]\\d{6})$|1","664$1",,,,,[,,,,,,,,,[-1]],,"664",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MT:[,[,,"3550\\d{4}|(?:[2579]\\d\\d|800)\\d{5}",,,,,,,[8]],[,,"20(?:3[1-4]|6[059])\\d{4}|2(?:0[19]|[1-357]\\d|60)\\d{5}",,,,"21001234"],[,,"(?:7(?:210|[79]\\d\\d)|9(?:[29]\\d\\d|69[67]|8(?:1[1-3]|89|97)))\\d{4}",,,,"96961234"],[,,"800(?:02|[3467]\\d)\\d{3}",,,,"80071234"],[,,"5(?:0(?:0(?:37|43)|(?:6\\d|70|9[0168])\\d)|[12]\\d0[1-5])\\d{3}",,,,"50037123"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"3550\\d{4}",,,,"35501234"],"MT",356,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[2357-9]"]]],,[,,"7117\\d{4}",,,,"71171234"],,,[,,,,,,,,,[-1]],[,,"501\\d{5}",,,,"50112345"],,,[,,,,,,,,,[-1]]],MU:[,[,,"(?:[57]|8\\d\\d)\\d{7}|[2-468]\\d{6}",,,,,,,[7,8,10]],[,,"(?:2(?:[0346-8]\\d|1[0-7])|4(?:[013568]\\d|2[4-8]|71)|54(?:[3-5]\\d|71)|6\\d\\d|8(?:14|3[129]))\\d{4}",,,,"54480123",,,[7,8]],[,,"5(?:4(?:2[1-389]|7[1-9])|87[15-8])\\d{4}|(?:5(?:2[5-9]|4[3-689]|[57]\\d|8[0-689]|9[0-8])|7(?:0[0-4]|3[013]))\\d{5}",,,,"52512345",,,[8]],[,,"802\\d{7}|80[0-2]\\d{4}",,,,"8001234",,,[7,10]],[,,"30\\d{5}",,,,"3012345",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"3(?:20|9\\d)\\d{4}",,,,"3201234",,,[7]],"MU",230,"0(?:0|[24-7]0|3[03])",,,,,,"020",,[[,"(\\d{3})(\\d{4})","$1 $2",["[2-46]|8[013]"]],[,"(\\d{4})(\\d{4})","$1 $2",["[57]"]],[,"(\\d{5})(\\d{5})","$1 $2",["8"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MV:[,[,,"(?:800|9[0-57-9]\\d)\\d{7}|[34679]\\d{6}",,,,,,,[7,10]],[,,"(?:3(?:0[0-4]|3[0-59])|6(?:[58][024689]|6[024-68]|7[02468]))\\d{4}",,,,"6701234",,,[7]],[,,"(?:46[46]|[79]\\d\\d)\\d{4}",,,,"7712345",,,[7]],[,,"800\\d{7}",,,,"8001234567",,,[10]],[,,"900\\d{7}",,,,"9001234567",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"MV",960,"0(?:0|19)",,,,,,"00",,[[,"(\\d{3})(\\d{4})","$1-$2",["[34679]"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"4(?:0[01]|50)\\d{4}",,,,"4001234",,,[7]],,,[,,,,,,,,,[-1]]],MW:[,[,,"(?:[1289]\\d|31|77)\\d{7}|1\\d{6}",,,,,,,[7,9]],[,,"(?:1[2-9]|2[12]\\d\\d)\\d{5}",,,,"1234567"],[,,"111\\d{6}|(?:31|77|[89][89])\\d{7}",,,,"991234567",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"MW",265,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["1[2-9]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["2"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[137-9]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MX:[,[,,"[2-9]\\d{9}",,,,,,,[10],[7,8]],[,,"657[12]\\d{6}|(?:2(?:0[01]|2\\d|3[1-35-8]|4[13-9]|7[1-689]|8[1-578]|9[467])|3(?:1[1-79]|[2458][1-9]|3\\d|7[1-8]|9[1-5])|4(?:1[1-57-9]|[267][1-9]|3[1-8]|[45]\\d|8[1-35-9]|9[2-689])|5(?:[56]\\d|88|9[1-79])|6(?:1[2-68]|[2-4][1-9]|5[1-3689]|6[0-57-9]|7[1-7]|8[67]|9[4-8])|7(?:[1346][1-9]|[27]\\d|5[13-9]|8[1-69]|9[17])|8(?:1\\d|2[13-689]|3[1-6]|4[124-6]|6[1246-9]|7[0-378]|9[12479])|9(?:1[346-9]|2[1-4]|3[2-46-8]|5[1348]|[69]\\d|7[12]|8[1-8]))\\d{7}",,,,"2001234567",,,,[7,8]],[,,"657[12]\\d{6}|(?:2(?:2\\d|3[1-35-8]|4[13-9]|7[1-689]|8[1-578]|9[467])|3(?:1[1-79]|[2458][1-9]|3\\d|7[1-8]|9[1-5])|4(?:1[1-57-9]|[267][1-9]|3[1-8]|[45]\\d|8[1-35-9]|9[2-689])|5(?:[56]\\d|88|9[1-79])|6(?:1[2-68]|[2-4][1-9]|5[1-3689]|6[0-57-9]|7[1-7]|8[67]|9[4-8])|7(?:[1346][1-9]|[27]\\d|5[13-9]|8[1-69]|9[17])|8(?:1\\d|2[13-689]|3[1-6]|4[124-6]|6[1246-9]|7[0-378]|9[12479])|9(?:1[346-9]|2[1-4]|3[2-46-8]|5[1348]|[69]\\d|7[12]|8[1-8]))\\d{7}",,,,"2221234567",,,,[7,8]],[,,"8(?:00|88)\\d{7}",,,,"8001234567"],[,,"900\\d{7}",,,,"9001234567"],[,,"300\\d{7}",,,,"3001234567"],[,,"500\\d{7}",,,,"5001234567"],[,,,,,,,,,[-1]],"MX",52,"0[09]",,,,,,"00",,[[,"(\\d{5})","$1",["53"]],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["33|5[56]|81"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2-9]"]]],[[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["33|5[56]|81"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2-9]"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MY:[,[,,"1\\d{8,9}|(?:3\\d|[4-9])\\d{7}",,,,,,,[8,9,10],[6,7]],[,,"4270\\d{4}|(?:3(?:2[0-36-9]|3[0-368]|4[0-278]|5[0-24-8]|6[0-467]|7[1246-9]|8\\d|9[0-57])\\d|4(?:2[0-689]|[3-79]\\d|8[1-35689])|5(?:2[0-589]|[3468]\\d|5[0-489]|7[1-9]|9[23])|6(?:2[2-9]|3[1357-9]|[46]\\d|5[0-6]|7[0-35-9]|85|9[015-8])|7(?:[2579]\\d|3[03-68]|4[0-8]|6[5-9]|8[0-35-9])|8(?:[24][2-8]|3[2-5]|5[2-7]|6[2-589]|7[2-578]|[89][2-9])|9(?:0[57]|13|[25-7]\\d|[3489][0-8]))\\d{5}",,,,"323856789",,,[8,9],[6,7]],[,,"1(?:1888[689]|4400|8(?:47|8[27])[0-4])\\d{4}|1(?:0(?:[23568]\\d|4[0-6]|7[016-9]|9[0-8])|1(?:[1-5]\\d\\d|6(?:0[5-9]|[1-9]\\d)|7(?:[0-4]\\d|5[0-7]))|(?:[269]\\d|[37][1-9]|4[235-9])\\d|5(?:31|9\\d\\d)|8(?:1[23]|[236]\\d|4[06]|5(?:46|[7-9])|7[016-9]|8[01]|9[0-8]))\\d{5}",,,,"123456789",,,[9,10]],[,,"1[378]00\\d{6}",,,,"1300123456",,,[10]],[,,"1600\\d{6}",,,,"1600123456",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"15(?:4(?:6[0-4]\\d|8(?:0[125]|[17]\\d|21|3[01]|4[01589]|5[014]|6[02]))|6(?:32[0-6]|78\\d))\\d{4}",,,,"1546012345",,,[10]],"MY",60,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1-$2 $3",["[4-79]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1-$2 $3",["1(?:[02469]|[378][1-9]|53)|8","1(?:[02469]|[37][1-9]|53|8(?:[1-46-9]|5[7-9]))|8"],"0$1"],[,"(\\d)(\\d{4})(\\d{4})","$1-$2 $3",["3"],"0$1"],[,"(\\d)(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3-$4",["1(?:[367]|80)"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2 $3",["15"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4})","$1-$2 $3",["1"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],MZ:[,[,,"(?:2|8\\d)\\d{7}",,,,,,,[8,9]],[,,"2(?:[1346]\\d|5[0-2]|[78][12]|93)\\d{5}",,,,"21123456",,,[8]],[,,"8[2-79]\\d{7}",,,,"821234567",,,[9]],[,,"800\\d{6}",,,,"800123456",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"MZ",258,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["2|8[2-79]"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NA:[,[,,"[68]\\d{7,8}",,,,,,,[8,9]],[,,"64426\\d{3}|6(?:1(?:2[2-7]|3[01378]|4[0-4])|254|32[0237]|4(?:27|41|5[25])|52[236-8]|626|7(?:2[2-4]|30))\\d{4,5}|6(?:1(?:(?:0\\d|2[0189]|3[24-69]|4[5-9])\\d|17|69|7[014])|2(?:17|5[0-36-8]|69|70)|3(?:17|2[14-689]|34|6[289]|7[01]|81)|4(?:17|2[0-2]|4[06]|5[0137]|69|7[01])|5(?:17|2[0459]|69|7[01])|6(?:17|25|38|42|69|7[01])|7(?:17|2[569]|3[13]|6[89]|7[01]))\\d{4}",,,,"61221234"],[,,"(?:60|8[1245])\\d{7}",,,,"811234567",,,[9]],[,,"80\\d{7}",,,,"800123456",,,[9]],[,,"8701\\d{5}",,,,"870123456",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"8(?:3\\d\\d|86)\\d{5}",,,,"88612345"],"NA",264,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["88"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["6"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["87"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NC:[,[,,"(?:050|[2-57-9]\\d\\d)\\d{3}",,,,,,,[6]],[,,"(?:2[03-9]|3[0-5]|4[1-7]|88)\\d{4}",,,,"201234"],[,,"(?:5[0-4]|[79]\\d|8[0-79])\\d{4}",,,,"751234"],[,,"050\\d{3}",,,,"050012"],[,,"36\\d{4}",,,,"366711"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"NC",687,"00",,,,,,,,[[,"(\\d{3})","$1",["5[6-8]"]],[,"(\\d{2})(\\d{2})(\\d{2})","$1.$2.$3",["[02-57-9]"]]],[[,"(\\d{2})(\\d{2})(\\d{2})","$1.$2.$3",["[02-57-9]"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NE:[,[,,"[027-9]\\d{7}",,,,,,,[8]],[,,"2(?:0(?:20|3[1-8]|4[13-5]|5[14]|6[14578]|7[1-578])|1(?:4[145]|5[14]|6[14-68]|7[169]|88))\\d{4}",,,,"20201234"],[,,"(?:23|7[0467]|[89]\\d)\\d{6}",,,,"93123456"],[,,"08\\d{6}",,,,"08123456"],[,,"09\\d{6}",,,,"09123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"NE",227,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["08"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[089]|2[013]|7[0467]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NF:[,[,,"[13]\\d{5}",,,,,,,[6],[5]],[,,"(?:1(?:06|17|28|39)|3[0-2]\\d)\\d{3}",,,,"106609",,,,[5]],[,,"(?:14|3[58])\\d{4}",,,,"381234",,,,[5]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"NF",672,"00",,,,"([0-258]\\d{4})$","3$1",,,[[,"(\\d{2})(\\d{4})","$1 $2",["1[0-3]"]],[,"(\\d)(\\d{5})","$1 $2",["[13]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NG:[,[,,"38\\d{6}|[78]\\d{9,13}|(?:20|9\\d)\\d{8}",,,,,,,[8,10,11,12,13,14],[6,7]],[,,"(?:20(?:[1259]\\d|3[013-9]|4[1-8]|6[024-689]|7[1-79]|8[2-9])|38)\\d{6}",,,,"2033123456",,,[8,10],[6,7]],[,,"(?:702[0-24-9]|819[01])\\d{6}|(?:7(?:0[13-9]|[12]\\d)|8(?:0[1-9]|1[0-8])|9(?:0[1-9]|1[1-6]))\\d{7}",,,,"8021234567",,,[10]],[,,"800\\d{7,11}",,,,"80017591759",,,[10,11,12,13,14]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"NG",234,"009","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["3"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[7-9]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["20[129]"],"0$1"],[,"(\\d{4})(\\d{2})(\\d{4})","$1 $2 $3",["2"],"0$1"],[,"(\\d{3})(\\d{4})(\\d{4,5})","$1 $2 $3",["[78]"],"0$1"],[,"(\\d{3})(\\d{5})(\\d{5,6})","$1 $2 $3",["[78]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"700\\d{7,11}",,,,"7001234567",,,[10,11,12,13,14]],,,[,,,,,,,,,[-1]]],NI:[,[,,"(?:1800|[25-8]\\d{3})\\d{4}",,,,,,,[8]],[,,"2\\d{7}",,,,"21234567"],[,,"(?:5(?:5[0-7]|[78]\\d)|6(?:20|3[035]|4[045]|5[05]|77|8[1-9]|9[059])|(?:7[5-8]|8\\d)\\d)\\d{5}",,,,"81234567"],[,,"1800\\d{4}",,,,"18001234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"NI",505,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[125-8]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NL:[,[,,"(?:[124-7]\\d\\d|3(?:[02-9]\\d|1[0-8]))\\d{6}|8\\d{6,9}|9\\d{6,10}|1\\d{4,5}",,,,,,,[5,6,7,8,9,10,11]],[,,"(?:1(?:[035]\\d|1[13-578]|6[124-8]|7[24]|8[0-467])|2(?:[0346]\\d|2[2-46-9]|5[125]|9[479])|3(?:[03568]\\d|1[3-8]|2[01]|4[1-8])|4(?:[0356]\\d|1[1-368]|7[58]|8[15-8]|9[23579])|5(?:[0358]\\d|[19][1-9]|2[1-57-9]|4[13-8]|6[126]|7[0-3578])|7\\d\\d)\\d{6}",,,,"101234567",,,[9]],[,,"(?:6[1-58]|970\\d)\\d{7}",,,,"612345678",,,[9,11]],[,,"800\\d{4,7}",,,,"8001234",,,[7,8,9,10]],[,,"90[069]\\d{4,7}",,,,"9061234",,,[7,8,9,10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:85|91)\\d{7}",,,,"851234567",,,[9]],"NL",31,"00","0",,,"0",,,,[[,"(\\d{4})","$1",["1[238]|[34]"]],[,"(\\d{2})(\\d{3,4})","$1 $2",["14"]],[,"(\\d{6})","$1",["1"]],[,"(\\d{3})(\\d{4,7})","$1 $2",["[89]0"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["66"],"0$1"],[,"(\\d)(\\d{8})","$1 $2",["6"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-578]|91"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{5})","$1 $2 $3",["9"],"0$1"]],[[,"(\\d{3})(\\d{4,7})","$1 $2",["[89]0"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["66"],"0$1"],[,"(\\d)(\\d{8})","$1 $2",["6"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-578]|91"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{5})","$1 $2 $3",["9"],"0$1"]],[,,"66\\d{7}",,,,"662345678",,,[9]],,,[,,"140(?:1[035]|2[0346]|3[03568]|4[0356]|5[0358]|8[458])|140(?:1[16-8]|2[259]|3[124]|4[17-9]|5[124679]|7)\\d",,,,,,,[5,6]],[,,"140(?:1[035]|2[0346]|3[03568]|4[0356]|5[0358]|8[458])|(?:140(?:1[16-8]|2[259]|3[124]|4[17-9]|5[124679]|7)|8[478]\\d{6})\\d",,,,"14020",,,[5,6,9]],,,[,,,,,,,,,[-1]]],NO:[,[,,"(?:0|[2-9]\\d{3})\\d{4}",,,,,,,[5,8]],[,,"(?:2[1-4]|3[1-3578]|5[1-35-7]|6[1-4679]|7[0-8])\\d{6}",,,,"21234567",,,[8]],[,,"(?:4[015-8]|9\\d)\\d{6}",,,,"40612345",,,[8]],[,,"80[01]\\d{5}",,,,"80012345",,,[8]],[,,"82[09]\\d{5}",,,,"82012345",,,[8]],[,,"810(?:0[0-6]|[2-8]\\d)\\d{3}",,,,"81021234",,,[8]],[,,"880\\d{5}",,,,"88012345",,,[8]],[,,"85[0-5]\\d{5}",,,,"85012345",,,[8]],"NO",47,"00",,,,,,,,[[,"(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["8"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-79]"]]],,[,,,,,,,,,[-1]],1,"[02-689]|7[0-8]",[,,,,,,,,,[-1]],[,,"(?:0[235-9]|81(?:0(?:0[7-9]|1\\d)|5\\d\\d))\\d{3}",,,,"02000"],,,[,,"81[23]\\d{5}",,,,"81212345",,,[8]]],NP:[,[,,"(?:1\\d|9)\\d{9}|[1-9]\\d{7}",,,,,,,[8,10,11],[6,7]],[,,"(?:1[0-6]\\d|99[02-6])\\d{5}|(?:2[13-79]|3[135-8]|4[146-9]|5[135-7]|6[13-9]|7[15-9]|8[1-46-9]|9[1-7])[2-6]\\d{5}",,,,"14567890",,,[8],[6,7]],[,,"9(?:00|6[0-3]|7[024-6]|8[0-24-68])\\d{7}",,,,"9841234567",,,[10]],[,,"1(?:66001|800\\d\\d)\\d{5}",,,,"16600101234",,,[11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"NP",977,"00","0",,,"0",,,,[[,"(\\d)(\\d{7})","$1-$2",["1[2-6]"],"0$1"],[,"(\\d{2})(\\d{6})","$1-$2",["1[01]|[2-8]|9(?:[1-59]|[67][2-6])"],"0$1"],[,"(\\d{3})(\\d{7})","$1-$2",["9"]],[,"(\\d{4})(\\d{2})(\\d{5})","$1-$2-$3",["1"]]],[[,"(\\d)(\\d{7})","$1-$2",["1[2-6]"],"0$1"],[,"(\\d{2})(\\d{6})","$1-$2",["1[01]|[2-8]|9(?:[1-59]|[67][2-6])"],"0$1"],[,"(\\d{3})(\\d{7})","$1-$2",["9"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NR:[,[,,"(?:444|(?:55|8\\d)\\d|666)\\d{4}",,,,,,,[7]],[,,"444\\d{4}",,,,"4441234"],[,,"(?:55[3-9]|666|8\\d\\d)\\d{4}",,,,"5551234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"NR",674,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[4-68]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NU:[,[,,"(?:[4-7]|888\\d)\\d{3}",,,,,,,[4,7]],[,,"[47]\\d{3}",,,,"7012",,,[4]],[,,"(?:[56]|888[1-9])\\d{3}",,,,"8884012"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"NU",683,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["8"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],NZ:[,[,,"[1289]\\d{9}|50\\d{5}(?:\\d{2,3})?|[27-9]\\d{7,8}|(?:[34]\\d|6[0-35-9])\\d{6}|8\\d{4,6}",,,,,,,[5,6,7,8,9,10]],[,,"240\\d{5}|(?:3[2-79]|[49][2-9]|6[235-9]|7[2-57-9])\\d{6}",,,,"32345678",,,[8],[7]],[,,"2(?:[0-27-9]\\d|6)\\d{6,7}|2(?:1\\d|75)\\d{5}",,,,"211234567",,,[8,9,10]],[,,"508\\d{6,7}|80\\d{6,8}",,,,"800123456",,,[8,9,10]],[,,"(?:1[13-57-9]\\d{5}|50(?:0[08]|30|66|77|88))\\d{3}|90\\d{6,8}",,,,"900123456",,,[7,8,9,10]],[,,,,,,,,,[-1]],[,,"70\\d{7}",,,,"701234567",,,[9]],[,,,,,,,,,[-1]],"NZ",64,"0(?:0|161)","0",,,"0",,"00",,[[,"(\\d{2})(\\d{3,8})","$1 $2",["8[1-79]"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["50[036-8]|8|90","50(?:[0367]|88)|8|90"],"0$1"],[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["24|[346]|7[2-57-9]|9[2-9]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["2(?:10|74)|[589]"],"0$1"],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["1|2[028]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,5})","$1 $2 $3",["2(?:[169]|7[0-35-9])|7"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"8(?:1[16-9]|22|3\\d|4[045]|5[459]|6[235-9]|7[0-3579]|90)\\d{2,7}",,,,"83012378"],,,[,,,,,,,,,[-1]]],OM:[,[,,"(?:1505|[279]\\d{3}|500)\\d{4}|800\\d{5,6}",,,,,,,[7,8,9]],[,,"2[1-6]\\d{6}",,,,"23123456",,,[8]],[,,"(?:1505|90[1-9]\\d)\\d{4}|(?:7[126-9]|9[1-9])\\d{6}",,,,"92123456",,,[8]],[,,"8007\\d{4,5}|(?:500|800[05])\\d{4}",,,,"80071234"],[,,"900\\d{5}",,,,"90012345",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"OM",968,"00",,,,,,,,[[,"(\\d{3})(\\d{4,6})","$1 $2",["[58]"]],[,"(\\d{2})(\\d{6})","$1 $2",["2"]],[,"(\\d{4})(\\d{4})","$1 $2",["[179]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PA:[,[,,"(?:00800|8\\d{3})\\d{6}|[68]\\d{7}|[1-57-9]\\d{6}",,,,,,,[7,8,10,11]],[,,"(?:1(?:0\\d|1[479]|2[37]|3[0137]|4[17]|5[05]|6[058]|7[0167]|8[2358]|9[1389])|2(?:[0235-79]\\d|1[0-7]|4[013-9]|8[02-9])|3(?:[07-9]\\d|1[0-7]|2[0-5]|33|4[0-79]|5[0-35]|6[068])|4(?:00|3[0-579]|4\\d|7[0-57-9])|5(?:[01]\\d|2[0-7]|[56]0|79)|7(?:0[09]|2[0-26-8]|3[03]|4[04]|5[05-9]|6[0156]|7[0-24-9]|8[5-9]|90)|8(?:09|2[89]|3\\d|4[0-24-689]|5[014]|8[02])|9(?:0[5-9]|1[0135-8]|2[036-9]|3[35-79]|40|5[0457-9]|6[05-9]|7[04-9]|8[35-8]|9\\d))\\d{4}",,,,"2001234",,,[7]],[,,"(?:1[16]1|21[89]|6\\d{3}|8(?:1[01]|7[23]))\\d{4}",,,,"61234567",,,[7,8]],[,,"800\\d{4,5}|(?:00800|800\\d)\\d{6}",,,,"8001234"],[,,"(?:8(?:22|55|60|7[78]|86)|9(?:00|81))\\d{4}",,,,"8601234",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"PA",507,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1-$2",["[1-57-9]"]],[,"(\\d{4})(\\d{4})","$1-$2",["[68]"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PE:[,[,,"(?:[14-8]|9\\d)\\d{7}",,,,,,,[8,9],[6,7]],[,,"(?:(?:(?:4[34]|5[14])[0-8]|687)\\d|7(?:173|(?:3[0-8]|55)\\d)|8(?:10[05689]|6(?:0[06-9]|1[6-9]|29)|7(?:0[0569]|[56]0)))\\d{4}|(?:1[0-8]|4[12]|5[236]|6[1-7]|7[246]|8[2-4])\\d{6}",,,,"11234567",,,[8],[6,7]],[,,"9\\d{8}",,,,"912345678",,,[9]],[,,"800\\d{5}",,,,"80012345",,,[8]],[,,"805\\d{5}",,,,"80512345",,,[8]],[,,"801\\d{5}",,,,"80112345",,,[8]],[,,"80[24]\\d{5}",,,,"80212345",,,[8]],[,,,,,,,,,[-1]],"PE",51,"00|19(?:1[124]|77|90)00","0"," Anexo ",,"0",,"00",,[[,"(\\d{3})(\\d{5})","$1 $2",["80"],"(0$1)"],[,"(\\d)(\\d{7})","$1 $2",["1"],"(0$1)"],[,"(\\d{2})(\\d{6})","$1 $2",["[4-8]"],"(0$1)"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["9"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PF:[,[,,"4\\d{5}(?:\\d{2})?|8\\d{7,8}",,,,,,,[6,8,9]],[,,"4(?:0[4-689]|9[4-68])\\d{5}",,,,"40412345",,,[8]],[,,"8[7-9]\\d{6}",,,,"87123456",,,[8]],[,,"80[0-5]\\d{6}",,,,"800012345",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"499\\d{5}",,,,"49901234",,,[8]],"PF",689,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["44"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["4|8[7-9]"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]]],,[,,,,,,,,,[-1]],,,[,,"44\\d{4}",,,,,,,[6]],[,,"44\\d{4}",,,,"440123",,,[6]],,,[,,,,,,,,,[-1]]],PG:[,[,,"(?:180|[78]\\d{3})\\d{4}|(?:[2-589]\\d|64)\\d{5}",,,,,,,[7,8]],[,,"(?:(?:3[0-2]|4[257]|5[34]|9[78])\\d|64[1-9]|85[02-46-9])\\d{4}",,,,"3123456",,,[7]],[,,"(?:7\\d|8[1-38])\\d{6}",,,,"70123456",,,[8]],[,,"180\\d{4}",,,,"1801234",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"2(?:0[0-57]|7[568])\\d{4}",,,,"2751234",,,[7]],"PG",675,"00|140[1-3]",,,,,,"00",,[[,"(\\d{3})(\\d{4})","$1 $2",["18|[2-69]|85"]],[,"(\\d{4})(\\d{4})","$1 $2",["[78]"]]],,[,,"27[01]\\d{4}",,,,"2700123",,,[7]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PH:[,[,,"(?:[2-7]|9\\d)\\d{8}|2\\d{5}|(?:1800|8)\\d{7,9}",,,,,,,[6,8,9,10,11,12,13],[4,5,7]],[,,"(?:(?:2[3-8]|3[2-68]|4[2-9]|5[2-6]|6[2-58]|7[24578])\\d{3}|88(?:22\\d\\d|42))\\d{4}|(?:2|8[2-8]\\d\\d)\\d{5}",,,,"232345678",,,[6,8,9,10],[4,5,7]],[,,"(?:8(?:1[37]|9[5-8])|9(?:0[5-9]|1[0-24-9]|[235-7]\\d|4[2-9]|8[135-9]|9[1-9]))\\d{7}",,,,"9051234567",,,[10]],[,,"1800\\d{7,9}",,,,"180012345678",,,[11,12,13]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"PH",63,"00","0",,,"0",,,,[[,"(\\d)(\\d{5})","$1 $2",["2"],"(0$1)"],[,"(\\d{4})(\\d{4,6})","$1 $2",["3(?:23|39|46)|4(?:2[3-6]|[35]9|4[26]|76)|544|88[245]|(?:52|64|86)2","3(?:230|397|461)|4(?:2(?:35|[46]4|51)|396|4(?:22|63)|59[347]|76[15])|5(?:221|446)|642[23]|8(?:622|8(?:[24]2|5[13]))"],"(0$1)"],[,"(\\d{5})(\\d{4})","$1 $2",["346|4(?:27|9[35])|883","3469|4(?:279|9(?:30|56))|8834"],"(0$1)"],[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[3-7]|8[2-8]"],"(0$1)"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]],[,"(\\d{4})(\\d{1,2})(\\d{3})(\\d{4})","$1 $2 $3 $4",["1"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PK:[,[,,"122\\d{6}|[24-8]\\d{10,11}|9(?:[013-9]\\d{8,10}|2(?:[01]\\d\\d|2(?:[06-8]\\d|1[01]))\\d{7})|(?:[2-8]\\d{3}|92(?:[0-7]\\d|8[1-9]))\\d{6}|[24-9]\\d{8}|[89]\\d{7}",,,,,,,[8,9,10,11,12],[5,6,7]],[,,"(?:(?:21|42)[2-9]|58[126])\\d{7}|(?:2[25]|4[0146-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]\\d{6,7}|(?:2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:2[2-8]|3[27-9]|4[2-6]|6[3569]|9[25-8]))[2-9]\\d{5,6}",,,,"2123456789",,,[9,10],[5,6,7,8]],[,,"3(?:[0-247]\\d|3[0-79]|55|64)\\d{7}",,,,"3012345678",,,[10]],[,,"800\\d{5}(?:\\d{3})?",,,,"80012345",,,[8,11]],[,,"900\\d{5}",,,,"90012345",,,[8]],[,,,,,,,,,[-1]],[,,"122\\d{6}",,,,"122044444",,,[9]],[,,,,,,,,,[-1]],"PK",92,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{2,7})","$1 $2 $3",["[89]0"],"0$1"],[,"(\\d{4})(\\d{5})","$1 $2",["1"]],[,"(\\d{3})(\\d{6,7})","$1 $2",["2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:2[2-8]|3[27-9]|4[2-6]|6[3569]|9[25-8])","9(?:2[3-8]|98)|(?:2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:22|3[27-9]|4[2-6]|6[3569]|9[25-7]))[2-9]"],"(0$1)"],[,"(\\d{2})(\\d{7,8})","$1 $2",["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]"],"(0$1)"],[,"(\\d{5})(\\d{5})","$1 $2",["58"],"(0$1)"],[,"(\\d{3})(\\d{7})","$1 $2",["3"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91"],"(0$1)"],[,"(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[24-9]"],"(0$1)"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"(?:2(?:[125]|3[2358]|4[2-4]|9[2-8])|4(?:[0-246-9]|5[3479])|5(?:[1-35-7]|4[2-467])|6(?:0[468]|[1-8])|7(?:[14]|2[236])|8(?:[16]|2[2-689]|3[23578]|4[3478]|5[2356])|9(?:1|22|3[27-9]|4[2-6]|6[3569]|9[2-7]))111\\d{6}",,,,"21111825888",,,[11,12]],,,[,,,,,,,,,[-1]]],PL:[,[,,"(?:6|8\\d\\d)\\d{7}|[1-9]\\d{6}(?:\\d{2})?|[26]\\d{5}",,,,,,,[6,7,8,9,10]],[,,"47\\d{7}|(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])(?:[02-9]\\d{6}|1(?:[0-8]\\d{5}|9\\d{3}(?:\\d{2})?))",,,,"123456789",,,[7,9]],[,,"21(?:1[013-5]|2\\d|3[4-9])\\d{5}|(?:45|5[0137]|6[069]|7[2389]|88)\\d{7}",,,,"512345678",,,[9]],[,,"800\\d{6,7}",,,,"800123456",,,[9,10]],[,,"70[01346-8]\\d{6}",,,,"701234567",,,[9]],[,,"801\\d{6}",,,,"801234567",,,[9]],[,,,,,,,,,[-1]],[,,"39\\d{7}",,,,"391234567",,,[9]],"PL",48,"00",,,,,,,,[[,"(\\d{5})","$1",["19"]],[,"(\\d{3})(\\d{3})","$1 $2",["11|20|64"]],[,"(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])1","(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])19"]],[,"(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["64"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["21|39|45|5[0137]|6[0469]|7[02389]|8(?:0[14]|8)"]],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[2-8]|[2-7]|8[1-79]|9[145]"]],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["8"]]],,[,,"64\\d{4,7}",,,,"641234567",,,[6,7,8,9]],,,[,,,,,,,,,[-1]],[,,"804\\d{6}",,,,"804123456",,,[9]],,,[,,,,,,,,,[-1]]],PM:[,[,,"[45]\\d{5}|(?:708|8\\d\\d)\\d{6}",,,,,,,[6,9]],[,,"(?:4[1-35-9]|5[0-47-9]|80[6-9]\\d\\d)\\d{4}",,,,"430123"],[,,"(?:4[02-489]|5[02-9]|708(?:4[0-5]|5[0-6]))\\d{4}",,,,"551234"],[,,"80[0-5]\\d{6}",,,,"800012345",,,[9]],[,,"8[129]\\d{7}",,,,"810123456",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"PM",508,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["[45]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["7"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PR:[,[,,"(?:[589]\\d\\d|787)\\d{7}",,,,,,,[10],[7]],[,,"(?:787|939)[2-9]\\d{6}",,,,"7872345678",,,,[7]],[,,"(?:787|939)[2-9]\\d{6}",,,,"7872345678",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002345678"],[,,"900[2-9]\\d{6}",,,,"9002345678"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"PR",1,"011","1",,,"1",,,1,,,[,,,,,,,,,[-1]],,"787|939",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PS:[,[,,"[2489]2\\d{6}|(?:1\\d|5)\\d{8}",,,,,,,[8,9,10],[7]],[,,"(?:22[2-47-9]|42[45]|82[014-68]|92[3569])\\d{5}",,,,"22234567",,,[8],[7]],[,,"5[69]\\d{7}",,,,"599123456",,,[9]],[,,"1800\\d{6}",,,,"1800123456",,,[10]],[,,,,,,,,,[-1]],[,,"1700\\d{6}",,,,"1700123456",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"PS",970,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2489]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["5"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PT:[,[,,"1693\\d{5}|(?:[26-9]\\d|30)\\d{7}",,,,,,,[9]],[,,"2(?:[12]\\d|3[1-689]|4[1-59]|[57][1-9]|6[1-35689]|8[1-69]|9[1256])\\d{6}",,,,"212345678"],[,,"6(?:[06]92(?:30|9\\d)|[35]92(?:[049]\\d|3[034]))\\d{3}|(?:(?:16|6[0356])93|9(?:[1-36]\\d\\d|480))\\d{5}",,,,"912345678"],[,,"80[02]\\d{6}",,,,"800123456"],[,,"(?:6(?:0[178]|4[68])\\d|76(?:0[1-57]|1[2-47]|2[237]))\\d{5}",,,,"760123456"],[,,"80(?:8\\d|9[1579])\\d{5}",,,,"808123456"],[,,"884[0-4689]\\d{5}",,,,"884123456"],[,,"30\\d{7}",,,,"301234567"],"PT",351,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["2[12]"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["16|[236-9]"]]],,[,,"6(?:222\\d|8988)\\d{4}",,,,"622212345"],,,[,,,,,,,,,[-1]],[,,"70(?:38[01]|596|(?:7\\d|8[17])\\d)\\d{4}",,,,"707123456"],,,[,,"600\\d{6}|6[06]92(?:0\\d|3[349]|49)\\d{3}",,,,"600110000"]],PW:[,[,,"(?:[24-8]\\d\\d|345|900)\\d{4}",,,,,,,[7]],[,,"(?:2(?:55|77)|345|488|5(?:35|44|87)|6(?:22|54|79)|7(?:33|47)|8(?:24|55|76)|900)\\d{4}",,,,"2771234"],[,,"(?:(?:46|83)[0-5]|6[2-4689]0)\\d{4}|(?:45|77|88)\\d{5}",,,,"6201234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"PW",680,"01[12]",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],PY:[,[,,"59\\d{4,6}|9\\d{5,10}|(?:[2-46-8]\\d|5[0-8])\\d{4,7}",,,,,,,[6,7,8,9,10,11],[5]],[,,"(?:[26]1|3[289]|4[1246-8]|7[1-3]|8[1-36])\\d{5,7}|(?:2(?:2[4-68]|[4-68]\\d|7[15]|9[1-5])|3(?:18|3[167]|4[2357]|51|[67]\\d)|4(?:3[12]|5[13]|9[1-47])|5(?:[1-4]\\d|5[02-4])|6(?:3[1-3]|44|7[1-8])|7(?:4[0-4]|5\\d|6[1-578]|75|8[0-8])|858)\\d{5,6}",,,,"212345678",,,[7,8,9],[5,6]],[,,"9(?:51|6[129]|7[1-6]|8[1-7]|9[1-5])\\d{6}",,,,"961456789",,,[9]],[,,"9800\\d{5,7}",,,,"98000123456",,,[9,10,11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"8700[0-4]\\d{4}",,,,"870012345",,,[9]],"PY",595,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3,6})","$1 $2",["[2-9]0"],"0$1"],[,"(\\d{2})(\\d{5})","$1 $2",["[26]1|3[289]|4[1246-8]|7[1-3]|8[1-36]"],"(0$1)"],[,"(\\d{3})(\\d{4,5})","$1 $2",["2[279]|3[13-5]|4[359]|5|6(?:[34]|7[1-46-8])|7[46-8]|85"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["2[14-68]|3[26-9]|4[1246-8]|6(?:1|75)|7[1-35]|8[1-36]"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["87"]],[,"(\\d{3})(\\d{6})","$1 $2",["9(?:[5-79]|8[1-7])"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[2-8]"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["9"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"[2-9]0\\d{4,7}",,,,"201234567",,,[6,7,8,9]],,,[,,,,,,,,,[-1]]],QA:[,[,,"800\\d{4}|(?:2|800)\\d{6}|(?:0080|[3-7])\\d{7}",,,,,,,[7,8,9,11]],[,,"4(?:1111|2022)\\d{3}|4(?:[04]\\d\\d|14[0-6]|999)\\d{4}",,,,"44123456",,,[8]],[,,"[35-7]\\d{7}",,,,"33123456",,,[8]],[,,"800\\d{4}|(?:0080[01]|800)\\d{6}",,,,"8001234",,,[7,9,11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"QA",974,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["2[16]|8"]],[,"(\\d{4})(\\d{4})","$1 $2",["[3-7]"]]],,[,,"2[16]\\d{5}",,,,"2123456",,,[7]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],RE:[,[,,"709\\d{6}|(?:26|[689]\\d)\\d{7}",,,,,,,[9]],[,,"26(?:2\\d\\d|3(?:0\\d|1[0-6]))\\d{4}",,,,"262161234"],[,,"(?:69(?:2\\d\\d|3(?:[06][0-6]|1[013]|2[0-2]|3[0-39]|4\\d|5[0-5]|7[0-37]|8[0-8]|9[0-479]))|7092[0-3])\\d{4}",,,,"692123456"],[,,"80\\d{7}",,,,"801234567"],[,,"89[1-37-9]\\d{6}",,,,"891123456"],[,,"8(?:1[019]|2[0156]|84|90)\\d{6}",,,,"810123456"],[,,,,,,,,,[-1]],[,,"9(?:399[0-3]|479[0-5]|76(?:2[278]|3[0-37]))\\d{4}",,,,"939901234"],"RE",262,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[26-9]"],"0$1"]],,[,,,,,,,,,[-1]],1,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],RO:[,[,,"(?:[236-8]\\d|90)\\d{7}|[23]\\d{5}",,,,,,,[6,9]],[,,"[23][13-6]\\d{7}|(?:2(?:19\\d|[3-6]\\d9)|31\\d\\d)\\d\\d",,,,"211234567"],[,,"(?:630|702)0\\d{5}|(?:6(?:00|2\\d)|7(?:0[013-9]|1[0-3]|[2-7]\\d|8[03-8]|9[0-39]))\\d{6}",,,,"712034567",,,[9]],[,,"800\\d{6}",,,,"800123456",,,[9]],[,,"90[0136]\\d{6}",,,,"900123456",,,[9]],[,,"801\\d{6}",,,,"801123456",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"RO",40,"00","0"," int ",,"0",,,,[[,"(\\d{3})(\\d{3})","$1 $2",["2[3-6]","2[3-6]\\d9"],"0$1"],[,"(\\d{2})(\\d{4})","$1 $2",["219|31"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[23]1"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[236-9]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"(?:37\\d|80[578])\\d{6}",,,,"372123456",,,[9]],,,[,,,,,,,,,[-1]]],RS:[,[,,"38[02-9]\\d{6,9}|6\\d{7,9}|90\\d{4,8}|38\\d{5,6}|(?:7\\d\\d|800)\\d{3,9}|(?:[12]\\d|3[0-79])\\d{5,10}",,,,,,,[6,7,8,9,10,11,12],[4,5]],[,,"(?:11[1-9]\\d|(?:2[389]|39)(?:0[2-9]|[2-9]\\d))\\d{3,8}|(?:1[02-9]|2[0-24-7]|3[0-8])[2-9]\\d{4,9}",,,,"10234567",,,[7,8,9,10,11,12],[4,5,6]],[,,"6(?:[0-689]|7\\d)\\d{6,7}",,,,"601234567",,,[8,9,10]],[,,"800\\d{3,9}",,,,"80012345"],[,,"(?:78\\d|90[0169])\\d{3,7}",,,,"90012345",,,[6,7,8,9,10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"RS",381,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3,9})","$1 $2",["(?:2[389]|39)0|[7-9]"],"0$1"],[,"(\\d{2})(\\d{5,10})","$1 $2",["[1-36]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"7[06]\\d{4,10}",,,,"700123456"],,,[,,,,,,,,,[-1]]],RU:[,[,,"8\\d{13}|[347-9]\\d{9}",,,,,,,[10,14],[7]],[,,"(?:3(?:0[12]|4[1-35-79]|5[1-3]|65|8[1-58]|9[0145])|4(?:01|1[1356]|2[13467]|7[1-5]|8[1-7]|9[1-689])|8(?:1[1-8]|2[01]|3[13-6]|4[0-8]|5[15]|6[1-35-79]|7[1-37-9]))\\d{7}",,,,"3011234567",,,[10],[7]],[,,"9\\d{9}",,,,"9123456789",,,[10]],[,,"8(?:0[04]|108\\d{3})\\d{7}",,,,"8001234567"],[,,"80[39]\\d{7}",,,,"8091234567",,,[10]],[,,,,,,,,,[-1]],[,,"808\\d{7}",,,,"8081234567",,,[10]],[,,,,,,,,,[-1]],"RU",7,"810","8",,,"8",,"8~10",,[[,"(\\d{3})(\\d{2})(\\d{2})","$1-$2-$3",["[0-79]"]],[,"(\\d{4})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["7(?:1[0-8]|2[1-9])","7(?:1(?:[0-356]2|4[29]|7|8[27])|2(?:1[23]|[2-9]2))","7(?:1(?:[0-356]2|4[29]|7|8[27])|2(?:13[03-69]|62[013-9]))|72[1-57-9]2"],"8 ($1)",,1],[,"(\\d{5})(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["7(?:1[0-68]|2[1-9])","7(?:1(?:[06][3-6]|[18]|2[35]|[3-5][3-5])|2(?:[13][3-5]|[24-689]|7[457]))","7(?:1(?:0(?:[356]|4[023])|[18]|2(?:3[013-9]|5)|3[45]|43[013-79]|5(?:3[1-8]|4[1-7]|5)|6(?:3[0-35-9]|[4-6]))|2(?:1(?:3[178]|[45])|[24-689]|3[35]|7[457]))|7(?:14|23)4[0-8]|71(?:33|45)[1-79]"],"8 ($1)",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"8 ($1)",,1],[,"(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[349]|8(?:[02-7]|1[1-8])"],"8 ($1)",,1],[,"(\\d{4})(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3 $4",["8"],"8 ($1)"]],[[,"(\\d{4})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["7(?:1[0-8]|2[1-9])","7(?:1(?:[0-356]2|4[29]|7|8[27])|2(?:1[23]|[2-9]2))","7(?:1(?:[0-356]2|4[29]|7|8[27])|2(?:13[03-69]|62[013-9]))|72[1-57-9]2"],"8 ($1)",,1],[,"(\\d{5})(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["7(?:1[0-68]|2[1-9])","7(?:1(?:[06][3-6]|[18]|2[35]|[3-5][3-5])|2(?:[13][3-5]|[24-689]|7[457]))","7(?:1(?:0(?:[356]|4[023])|[18]|2(?:3[013-9]|5)|3[45]|43[013-79]|5(?:3[1-8]|4[1-7]|5)|6(?:3[0-35-9]|[4-6]))|2(?:1(?:3[178]|[45])|[24-689]|3[35]|7[457]))|7(?:14|23)4[0-8]|71(?:33|45)[1-79]"],"8 ($1)",,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"8 ($1)",,1],[,"(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[349]|8(?:[02-7]|1[1-8])"],"8 ($1)",,1],[,"(\\d{4})(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3 $4",["8"],"8 ($1)"]],[,,,,,,,,,[-1]],1,"3[04-689]|[489]",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],RW:[,[,,"(?:06|[27]\\d\\d|[89]00)\\d{6}",,,,,,,[8,9]],[,,"(?:06|2[23568]\\d)\\d{6}",,,,"250123456"],[,,"7[237-9]\\d{7}",,,,"720123456",,,[9]],[,,"800\\d{6}",,,,"800123456",,,[9]],[,,"900\\d{6}",,,,"900123456",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"RW",250,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["0"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["2"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[7-9]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SA:[,[,,"92\\d{7}|(?:[15]|8\\d)\\d{8}",,,,,,,[9,10],[7]],[,,"1(?:1\\d|2[24-8]|3[35-8]|4[3-68]|6[2-5]|7[235-7])\\d{6}",,,,"112345678",,,[9],[7]],[,,"579[01]\\d{5}|5(?:[013-689]\\d|7[0-8])\\d{6}",,,,"512345678",,,[9]],[,,"800\\d{7}",,,,"8001234567",,,[10]],[,,"925\\d{6}",,,,"925012345",,,[9]],[,,"920\\d{6}",,,,"920012345",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"SA",966,"00","0",,,"0",,,,[[,"(\\d{4})(\\d{5})","$1 $2",["9"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["5"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["81"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"811\\d{7}",,,,"8110123456",,,[10]],,,[,,,,,,,,,[-1]]],SB:[,[,,"[6-9]\\d{6}|[1-6]\\d{4}",,,,,,,[5,7]],[,,"(?:1[4-79]|[23]\\d|4[0-2]|5[03]|6[0-37])\\d{3}",,,,"40123",,,[5]],[,,"48\\d{3}|(?:(?:6[89]|7[1-9]|8[4-9])\\d|9(?:1[2-9]|2[013-9]|3[0-2]|[46]\\d|5[0-46-9]|7[0-689]|8[0-79]|9[0-8]))\\d{4}",,,,"7421234"],[,,"1[38]\\d{3}",,,,"18123",,,[5]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"5[12]\\d{3}",,,,"51123",,,[5]],"SB",677,"0[01]",,,,,,,,[[,"(\\d{2})(\\d{5})","$1 $2",["6[89]|7|8[4-9]|9(?:[1-8]|9[0-8])"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SC:[,[,,"(?:[2489]\\d|64)\\d{5}",,,,,,,[7]],[,,"4[2-46]\\d{5}",,,,"4217123"],[,,"2[125-8]\\d{5}",,,,"2510123"],[,,"800[08]\\d{3}",,,,"8000000"],[,,"85\\d{5}",,,,"8512345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"971\\d{4}|(?:64|95)\\d{5}",,,,"6412345"],"SC",248,"010|0[0-2]",,,,,,"00",,[[,"(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[246]|9[57]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SD:[,[,,"[19]\\d{8}",,,,,,,[9]],[,,"1(?:5\\d|8[35-7])\\d{6}",,,,"153123456"],[,,"(?:1[0-2]|9[0-3569])\\d{7}",,,,"911231234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"SD",249,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[19]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SE:[,[,,"(?:[26]\\d\\d|9)\\d{9}|[1-9]\\d{8}|[1-689]\\d{7}|[1-4689]\\d{6}|2\\d{5}",,,,,,,[6,7,8,9,10,12]],[,,"(?:(?:[12][136]|3[356]|4[0246]|6[03]|8\\d)\\d|90[1-9])\\d{4,6}|(?:1(?:2[0-35]|4[0-4]|5[0-25-9]|7[13-6]|[89]\\d)|2(?:2[0-7]|4[0136-8]|5[0138]|7[018]|8[01]|9[0-57])|3(?:0[0-4]|1\\d|2[0-25]|4[056]|7[0-2]|8[0-3]|9[023])|4(?:1[013-8]|3[0135]|5[14-79]|7[0-246-9]|8[0156]|9[0-689])|5(?:0[0-6]|[15][0-5]|2[0-68]|3[0-4]|4\\d|6[03-5]|7[013]|8[0-79]|9[01])|6(?:1[1-3]|2[0-4]|4[02-57]|5[0-37]|6[0-3]|7[0-2]|8[0247]|9[0-356])|9(?:1[0-68]|2\\d|3[02-5]|4[0-3]|5[0-4]|[68][01]|7[0135-8]))\\d{5,6}",,,,"8123456",,,[7,8,9]],[,,"7[02369]\\d{7}",,,,"701234567",,,[9]],[,,"20\\d{4,7}",,,,"20123456",,,[6,7,8,9]],[,,"649\\d{6}|99[1-59]\\d{4}(?:\\d{3})?|9(?:00|39|44)[1-8]\\d{3,6}",,,,"9001234567",,,[7,8,9,10]],[,,"77[0-7]\\d{6}",,,,"771234567",,,[9]],[,,"75[1-8]\\d{6}",,,,"751234567",,,[9]],[,,,,,,,,,[-1]],"SE",46,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{2,3})(\\d{2})","$1-$2 $3",["20"],"0$1"],[,"(\\d{3})(\\d{4})","$1-$2",["9(?:00|39|44|9)"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})","$1-$2 $3",["[12][136]|3[356]|4[0246]|6[03]|90[1-9]"],"0$1"],[,"(\\d)(\\d{2,3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["8"],"0$1"],[,"(\\d{3})(\\d{2,3})(\\d{2})","$1-$2 $3",["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[125689]|4[02-57]|7[0-2])|9(?:[125-8]|3[02-5]|4[0-3])"],"0$1"],[,"(\\d{3})(\\d{2,3})(\\d{3})","$1-$2 $3",["9(?:00|39|44)"],"0$1"],[,"(\\d{2})(\\d{2,3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["1[13689]|2[0136]|3[1356]|4[0246]|54|6[03]|90[1-9]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["10|7"],"0$1"],[,"(\\d)(\\d{3})(\\d{3})(\\d{2})","$1-$2 $3 $4",["8"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1-$2 $3 $4",["[13-5]|2(?:[247-9]|5[0138])|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[02-5]|4[0-3])"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{3})","$1-$2 $3 $4",["9"],"0$1"],[,"(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1-$2 $3 $4 $5",["[26]"],"0$1"]],[[,"(\\d{2})(\\d{2,3})(\\d{2})","$1 $2 $3",["20"]],[,"(\\d{3})(\\d{4})","$1 $2",["9(?:00|39|44|9)"]],[,"(\\d{2})(\\d{3})(\\d{2})","$1 $2 $3",["[12][136]|3[356]|4[0246]|6[03]|90[1-9]"]],[,"(\\d)(\\d{2,3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]],[,"(\\d{3})(\\d{2,3})(\\d{2})","$1 $2 $3",["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[125689]|4[02-57]|7[0-2])|9(?:[125-8]|3[02-5]|4[0-3])"]],[,"(\\d{3})(\\d{2,3})(\\d{3})","$1 $2 $3",["9(?:00|39|44)"]],[,"(\\d{2})(\\d{2,3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[13689]|2[0136]|3[1356]|4[0246]|54|6[03]|90[1-9]"]],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["10|7"]],[,"(\\d)(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3 $4",["8"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[13-5]|2(?:[247-9]|5[0138])|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[02-5]|4[0-3])"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["9"]],[,"(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[26]"]]],[,,"74[02-9]\\d{6}",,,,"740123456",,,[9]],,,[,,,,,,,,,[-1]],[,,"10[1-8]\\d{6}",,,,"102345678",,,[9]],,,[,,"(?:25[245]|67[3-68])\\d{9}",,,,"254123456789",,,[12]]],SG:[,[,,"(?:(?:1\\d|8)\\d\\d|7000)\\d{7}|[3689]\\d{7}",,,,,,,[8,10,11]],[,,"662[0-24-9]\\d{4}|6(?:[0-578]\\d|6[013-57-9]|9[0-35-9])\\d{5}",,,,"61234567",,,[8]],[,,"896[0-4]\\d{4}|(?:8(?:0[1-9]|[1-8]\\d|9[0-5])|9[0-8]\\d)\\d{5}",,,,"81234567",,,[8]],[,,"(?:18|8)00\\d{7}",,,,"18001234567",,,[10,11]],[,,"1900\\d{7}",,,,"19001234567",,,[11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:3[12]\\d|666)\\d{5}",,,,"31234567",,,[8]],"SG",65,"0[0-3]\\d",,,,,,,,[[,"(\\d{4,5})","$1",["1[013-9]|77","1(?:[013-8]|9(?:0[1-9]|[1-9]))|77"]],[,"(\\d{4})(\\d{4})","$1 $2",["[369]|8(?:0[1-9]|[1-9])"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]],[,"(\\d{4})(\\d{4})(\\d{3})","$1 $2 $3",["7"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]]],[[,"(\\d{4})(\\d{4})","$1 $2",["[369]|8(?:0[1-9]|[1-9])"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]],[,"(\\d{4})(\\d{4})(\\d{3})","$1 $2 $3",["7"]],[,"(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"7000\\d{7}",,,,"70001234567",,,[11]],,,[,,,,,,,,,[-1]]],SH:[,[,,"(?:[256]\\d|8)\\d{3}",,,,,,,[4,5]],[,,"2(?:[0-57-9]\\d|6[4-9])\\d\\d",,,,"22158"],[,,"[56]\\d{4}",,,,"51234",,,[5]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"262\\d\\d",,,,"26212",,,[5]],"SH",290,"00",,,,,,,,,,[,,,,,,,,,[-1]],1,"[256]",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SI:[,[,,"[1-7]\\d{7}|8\\d{4,7}|90\\d{4,6}",,,,,,,[5,6,7,8]],[,,"(?:[1-357][2-8]|4[24-8])\\d{6}",,,,"12345678",,,[8],[7]],[,,"65(?:[178]\\d|5[56]|6[01])\\d{4}|(?:[37][01]|4[0139]|51|6[489])\\d{6}",,,,"31234567",,,[8]],[,,"80\\d{4,6}",,,,"80123456",,,[6,7,8]],[,,"89[1-3]\\d{2,5}|90\\d{4,6}",,,,"90123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:59\\d\\d|8(?:1(?:[67]\\d|8[0-589])|2(?:0\\d|2[0-37-9]|8[0-2489])|3[389]\\d))\\d{4}",,,,"59012345",,,[8]],"SI",386,"00|10(?:22|66|88|99)","0",,,"0",,"00",,[[,"(\\d{2})(\\d{3,6})","$1 $2",["8[09]|9"],"0$1"],[,"(\\d{3})(\\d{5})","$1 $2",["59|8"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[37][01]|4[0139]|51|6"],"0$1"],[,"(\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[1-57]"],"(0$1)"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SJ:[,[,,"0\\d{4}|(?:[489]\\d|79)\\d{6}",,,,,,,[5,8]],[,,"79\\d{6}",,,,"79123456",,,[8]],[,,"(?:4[015-8]|9\\d)\\d{6}",,,,"41234567",,,[8]],[,,"80[01]\\d{5}",,,,"80012345",,,[8]],[,,"82[09]\\d{5}",,,,"82012345",,,[8]],[,,"810(?:0[0-6]|[2-8]\\d)\\d{3}",,,,"81021234",,,[8]],[,,"880\\d{5}",,,,"88012345",,,[8]],[,,"85[0-5]\\d{5}",,,,"85012345",,,[8]],"SJ",47,"00",,,,,,,,,,[,,,,,,,,,[-1]],,"79",[,,,,,,,,,[-1]],[,,"(?:0[235-9]|81(?:0(?:0[7-9]|1\\d)|5\\d\\d))\\d{3}",,,,"02000"],,,[,,"81[23]\\d{5}",,,,"81212345",,,[8]]],SK:[,[,,"[2-689]\\d{8}|[2-59]\\d{6}|[2-5]\\d{5}",,,,,,,[6,7,9]],[,,"(?:2(?:16|[2-9]\\d{3})|(?:(?:[3-5][1-8]\\d|819)\\d|601[1-5])\\d)\\d{4}|(?:2|[3-5][1-8])1[67]\\d{3}|[3-5][1-8]16\\d\\d",,,,"221234567"],[,,"909[1-9]\\d{5}|9(?:0[1-8]|1[0-24-9]|4[03-57-9]|5\\d)\\d{6}",,,,"912123456",,,[9]],[,,"800\\d{6}",,,,"800123456",,,[9]],[,,"9(?:00|[78]\\d)\\d{6}",,,,"900123456",,,[9]],[,,"8[5-9]\\d{7}",,,,"850123456",,,[9]],[,,,,,,,,,[-1]],[,,"6(?:02|5[0-4]|9[0-6])\\d{6}",,,,"690123456",,,[9]],"SK",421,"00","0",,,"0",,,,[[,"(\\d)(\\d{2})(\\d{3,4})","$1 $2 $3",["21"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2,3})","$1 $2 $3",["[3-5][1-8]1","[3-5][1-8]1[67]"],"0$1"],[,"(\\d{4})(\\d{3})","$1 $2",["909","9090"],"0$1"],[,"(\\d)(\\d{3})(\\d{3})(\\d{2})","$1/$2 $3 $4",["2"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[689]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1/$2 $3 $4",["[3-5]"],"0$1"]],[[,"(\\d)(\\d{2})(\\d{3,4})","$1 $2 $3",["21"],"0$1"],[,"(\\d{2})(\\d{2})(\\d{2,3})","$1 $2 $3",["[3-5][1-8]1","[3-5][1-8]1[67]"],"0$1"],[,"(\\d)(\\d{3})(\\d{3})(\\d{2})","$1/$2 $3 $4",["2"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[689]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1/$2 $3 $4",["[3-5]"],"0$1"]],[,,"9090\\d{3}",,,,"9090123",,,[7]],,,[,,"9090\\d{3}|(?:602|8(?:00|[5-9]\\d)|9(?:00|[78]\\d))\\d{6}",,,,,,,[7,9]],[,,"96\\d{7}",,,,"961234567",,,[9]],,,[,,,,,,,,,[-1]]],SL:[,[,,"(?:[237-9]\\d|66)\\d{6}",,,,,,,[8],[6]],[,,"22[2-4][2-9]\\d{4}",,,,"22221234",,,,[6]],[,,"(?:25|3[0-5]|66|7[2-9]|8[08]|9[09])\\d{6}",,,,"25123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"SL",232,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{6})","$1 $2",["[236-9]"],"(0$1)"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SM:[,[,,"(?:0549|[5-7]\\d)\\d{6}",,,,,,,[8,10],[6]],[,,"0549(?:8[0157-9]|9\\d)\\d{4}",,,,"0549886377",,,[10],[6]],[,,"6[16]\\d{6}",,,,"66661212",,,[8]],[,,,,,,,,,[-1]],[,,"7[178]\\d{6}",,,,"71123456",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"5[158]\\d{6}",,,,"58001110",,,[8]],"SM",378,"00",,,,"([89]\\d{5})$","0549$1",,,[[,"(\\d{6})","$1",["[89]"]],[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-7]"]],[,"(\\d{4})(\\d{6})","$1 $2",["0"]]],[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-7]"]],[,"(\\d{4})(\\d{6})","$1 $2",["0"]]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SN:[,[,,"(?:[378]\\d|93)\\d{7}",,,,,,,[9]],[,,"3(?:0(?:1[0-2]|80)|282|3(?:8[1-9]|9[3-9])|611)\\d{5}",,,,"301012345"],[,,"7(?:(?:[06-8]\\d|[19]0|21)\\d|5(?:0[01]|[19]0|2[25]|3[36]|[4-7]\\d|8[35]))\\d{5}",,,,"701234567"],[,,"800\\d{6}",,,,"800123456"],[,,"88[4689]\\d{6}",,,,"884123456"],[,,"81[02468]\\d{6}",,,,"810123456"],[,,,,,,,,,[-1]],[,,"(?:3(?:392|9[01]\\d)\\d|93(?:3[13]0|929))\\d{4}",,,,"933301234"],"SN",221,"00",,,,,,,,[[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[379]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SO:[,[,,"[346-9]\\d{8}|[12679]\\d{7}|[1-5]\\d{6}|[1348]\\d{5}",,,,,,,[6,7,8,9]],[,,"(?:1\\d|2[0-79]|3[0-46-8]|4[0-7]|5[57-9])\\d{5}|(?:[134]\\d|8[125])\\d{4}",,,,"4012345",,,[6,7]],[,,"(?:(?:15|(?:3[59]|4[89]|6\\d|7[79]|8[08])\\d|9(?:0\\d|[2-9]))\\d|2(?:4\\d|8))\\d{5}|(?:[67]\\d\\d|904)\\d{5}",,,,"71123456",,,[7,8,9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"SO",252,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{4})","$1 $2",["8[125]"]],[,"(\\d{6})","$1",["[134]"]],[,"(\\d)(\\d{6})","$1 $2",["[15]|2[0-79]|3[0-46-8]|4[0-7]"]],[,"(\\d)(\\d{7})","$1 $2",["(?:2|90)4|[67]"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[348]|64|79|90"]],[,"(\\d{2})(\\d{5,7})","$1 $2",["1|28|6[0-35-9]|77|9[2-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SR:[,[,,"(?:[2-5]|68|[78]\\d)\\d{5}",,,,,,,[6,7]],[,,"(?:2[1-3]|3[0-7]|(?:4|68)\\d|5[2-58])\\d{4}",,,,"211234"],[,,"(?:7[124-7]|8[124-9])\\d{5}",,,,"7412345",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"56\\d{4}",,,,"561234",,,[6]],"SR",597,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})","$1-$2-$3",["56"]],[,"(\\d{3})(\\d{3})","$1-$2",["[2-5]"]],[,"(\\d{3})(\\d{4})","$1-$2",["[6-8]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SS:[,[,,"[19]\\d{8}",,,,,,,[9]],[,,"1[89]\\d{7}",,,,"181234567"],[,,"(?:12|9[1257-9])\\d{7}",,,,"977123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"SS",211,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[19]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],ST:[,[,,"(?:22|9\\d)\\d{5}",,,,,,,[7]],[,,"22\\d{5}",,,,"2221234"],[,,"900[5-9]\\d{3}|9(?:0[1-9]|[89]\\d)\\d{4}",,,,"9812345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"ST",239,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[29]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SV:[,[,,"[267]\\d{7}|(?:80\\d|900)\\d{4}(?:\\d{4})?",,,,,,,[7,8,11]],[,,"2(?:79(?:0[0347-9]|[1-9]\\d)|89(?:0[024589]|[1-9]\\d))\\d{3}|2(?:[1-69]\\d|[78][0-8])\\d{5}",,,,"21234567",,,[8]],[,,"[67]\\d{7}",,,,"70123456",,,[8]],[,,"800\\d{8}|80[01]\\d{4}",,,,"8001234",,,[7,11]],[,,"900\\d{4}(?:\\d{4})?",,,,"9001234",,,[7,11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"SV",503,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[89]"]],[,"(\\d{4})(\\d{4})","$1 $2",["[267]"]],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["[89]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SX:[,[,,"7215\\d{6}|(?:[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"7215(?:4[2-8]|8[239]|9[056])\\d{4}",,,,"7215425678",,,,[7]],[,,"7215(?:1[02]|2\\d|5[034679]|8[014-8])\\d{4}",,,,"7215205678",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002123456"],[,,"900[2-9]\\d{6}",,,,"9002123456"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"SX",1,"011","1",,,"(5\\d{6})$|1","721$1",,,,,[,,,,,,,,,[-1]],,"721",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SY:[,[,,"[1-359]\\d{8}|[1-5]\\d{7}",,,,,,,[8,9],[6,7]],[,,"21\\d{6,7}|(?:1(?:[14]\\d|[2356])|2[235]|3(?:[13]\\d|4)|4[134]|5[1-3])\\d{6}",,,,"112345678",,,,[6,7]],[,,"(?:50|9[1-689])\\d{7}",,,,"944567890",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"SY",963,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-4]|5[1-3]"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[59]"],"0$1",,1]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],SZ:[,[,,"0800\\d{4}|(?:[237]\\d|900)\\d{6}",,,,,,,[8,9]],[,,"[23][2-5]\\d{6}",,,,"22171234",,,[8]],[,,"7[6-9]\\d{6}",,,,"76123456",,,[8]],[,,"0800\\d{4}",,,,"08001234",,,[8]],[,,"900\\d{6}",,,,"900012345",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"70\\d{6}",,,,"70012345",,,[8]],"SZ",268,"00",,,,,,,,[[,"(\\d{4})(\\d{4})","$1 $2",["[0237]"]],[,"(\\d{5})(\\d{4})","$1 $2",["9"]]],,[,,,,,,,,,[-1]],,,[,,"0800\\d{4}",,,,,,,[8]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TA:[,[,,"8\\d{3}",,,,,,,[4]],[,,"8\\d{3}",,,,"8999"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"TA",290,"00",,,,,,,,,,[,,,,,,,,,[-1]],,"8",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TC:[,[,,"(?:[58]\\d\\d|649|900)\\d{7}",,,,,,,[10],[7]],[,,"649(?:266|712|9(?:4\\d|50))\\d{4}",,,,"6497121234",,,,[7]],[,,"649(?:2(?:3[129]|4[1-79])|3\\d\\d|4[34][1-3])\\d{4}",,,,"6492311234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002345678"],[,,"900[2-9]\\d{6}",,,,"9002345678"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,"649(?:71[01]|966)\\d{4}",,,,"6497101234",,,,[7]],"TC",1,"011","1",,,"([2-479]\\d{6})$|1","649$1",,,,,[,,,,,,,,,[-1]],,"649",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TD:[,[,,"(?:22|[689]\\d|77)\\d{6}",,,,,,,[8]],[,,"22(?:[37-9]0|5[0-5]|6[89])\\d{4}",,,,"22501234"],[,,"(?:[69]\\d|77|8[56])\\d{6}",,,,"63012345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"TD",235,"00|16",,,,,,"00",,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[26-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TG:[,[,,"[279]\\d{7}",,,,,,,[8]],[,,"2(?:2[2-7]|3[23]|4[45]|55|6[67]|77)\\d{5}",,,,"22212345"],[,,"(?:7[0-29]|9[0-36-9])\\d{6}",,,,"90112345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"TG",228,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[279]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TH:[,[,,"(?:001800|[2-57]|[689]\\d)\\d{7}|1\\d{7,9}",,,,,,,[8,9,10,13]],[,,"(?:1[0689]|2\\d|3[2-9]|4[2-5]|5[2-6]|7[3-7])\\d{6}",,,,"21234567",,,[8]],[,,"67(?:1[0-8]|2[4-7])\\d{5}|(?:14|6[1-6]|[89]\\d)\\d{7}",,,,"812345678",,,[9]],[,,"(?:001800\\d|1800)\\d{6}",,,,"1800123456",,,[10,13]],[,,"1900\\d{6}",,,,"1900123456",,,[10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"6[08]\\d{7}",,,,"601234567",,,[9]],"TH",66,"00[1-9]","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["2"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[13-9]"],"0$1"],[,"(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TJ:[,[,,"[0-57-9]\\d{8}",,,,,,,[9],[3,5,6,7]],[,,"(?:3(?:1[3-5]|2[245]|3[12]|4[24-7]|5[25]|72)|4(?:46|74|87))\\d{6}",,,,"372123456",,,,[3,5,6,7]],[,,"(?:33[03-9]|4(?:1[18]|4[02-479])|81[1-9])\\d{6}|(?:[09]\\d|1[0178]|2[02]|[34]0|5[05]|7[01578]|8[078])\\d{7}",,,,"917123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"TJ",992,"810",,,,,,"8~10",,[[,"(\\d{6})(\\d)(\\d{2})","$1 $2 $3",["331","3317"]],[,"(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["44[02-479]|[34]7"]],[,"(\\d{4})(\\d)(\\d{4})","$1 $2 $3",["3(?:[1245]|3[12])"]],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[0-57-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TK:[,[,,"[2-47]\\d{3,6}",,,,,,,[4,5,6,7]],[,,"(?:2[2-4]|[34]\\d)\\d{2,5}",,,,"3101"],[,,"7[2-4]\\d{2,5}",,,,"7290"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"TK",690,"00",,,,,,,,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TL:[,[,,"7\\d{7}|(?:[2-47]\\d|[89]0)\\d{5}",,,,,,,[7,8]],[,,"(?:2[1-5]|3[1-9]|4[1-4])\\d{5}",,,,"2112345",,,[7]],[,,"7[2-8]\\d{6}",,,,"77212345",,,[8]],[,,"80\\d{5}",,,,"8012345",,,[7]],[,,"90\\d{5}",,,,"9012345",,,[7]],[,,,,,,,,,[-1]],[,,"70\\d{5}",,,,"7012345",,,[7]],[,,,,,,,,,[-1]],"TL",670,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[2-489]|70"]],[,"(\\d{4})(\\d{4})","$1 $2",["7"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TM:[,[,,"(?:[1-6]\\d|71)\\d{6}",,,,,,,[8]],[,,"(?:1(?:2\\d|3[1-9])|2(?:22|4[0-35-8])|3(?:22|4[03-9])|4(?:22|3[128]|4\\d|6[15])|5(?:22|5[7-9]|6[014-689]))\\d{5}",,,,"12345678"],[,,"(?:6\\d|71)\\d{6}",,,,"66123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"TM",993,"810","8",,,"8",,"8~10",,[[,"(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2-$3-$4",["12"],"(8 $1)"],[,"(\\d{3})(\\d)(\\d{2})(\\d{2})","$1 $2-$3-$4",["[1-5]"],"(8 $1)"],[,"(\\d{2})(\\d{6})","$1 $2",["[67]"],"8 $1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TN:[,[,,"[2-57-9]\\d{7}",,,,,,,[8]],[,,"81200\\d{3}|(?:3[0-2]|7\\d)\\d{6}",,,,"30010123"],[,,"3(?:001|[12]40)\\d{4}|(?:(?:[259]\\d|4[0-8])\\d|3(?:1[1-35]|6[0-4]|91))\\d{5}",,,,"20123456"],[,,"8010\\d{4}",,,,"80101234"],[,,"88\\d{6}",,,,"88123456"],[,,"8[12]10\\d{4}",,,,"81101234"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"TN",216,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2-57-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TO:[,[,,"(?:0800|(?:[5-8]\\d\\d|999)\\d)\\d{3}|[2-8]\\d{4}",,,,,,,[5,7]],[,,"(?:2\\d|3[0-8]|4[0-4]|50|6[09]|7[0-24-69]|8[05])\\d{3}",,,,"20123",,,[5]],[,,"(?:5(?:4[0-5]|5[4-6])|6(?:[09]\\d|3[02]|8[15-9])|(?:7\\d|8[46-9])\\d|999)\\d{4}",,,,"7715123",,,[7]],[,,"0800\\d{3}",,,,"0800222",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"55[0-37-9]\\d{4}",,,,"5510123",,,[7]],"TO",676,"00",,,,,,,,[[,"(\\d{2})(\\d{3})","$1-$2",["[2-4]|50|6[09]|7[0-24-69]|8[05]"]],[,"(\\d{4})(\\d{3})","$1 $2",["0"]],[,"(\\d{3})(\\d{4})","$1 $2",["[5-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TR:[,[,,"4\\d{6}|8\\d{11,12}|(?:[2-58]\\d\\d|900)\\d{7}",,,,,,,[7,10,12,13]],[,,"(?:2(?:[13][26]|[28][2468]|[45][268]|[67][246])|3(?:[13][28]|[24-6][2468]|[78][02468]|92)|4(?:[16][246]|[23578][2468]|4[26]))\\d{7}",,,,"2123456789",,,[10]],[,,"561(?:011|61\\d)\\d{4}|5(?:0[15-7]|1[06]|24|[34]\\d|5[1-59]|9[46])\\d{7}",,,,"5012345678",,,[10]],[,,"8(?:00\\d{7}(?:\\d{2,3})?|11\\d{7})",,,,"8001234567",,,[10,12,13]],[,,"(?:8[89]8|900)\\d{7}",,,,"9001234567",,,[10]],[,,,,,,,,,[-1]],[,,"592(?:21[12]|461)\\d{4}",,,,"5922121234",,,[10]],[,,"850\\d{7}",,,,"8500123456",,,[10]],"TR",90,"00","0",,,"0",,,,[[,"(\\d{3})(\\d)(\\d{3})","$1 $2 $3",["444"],,,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["512|8[01589]|90"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["5(?:[0-59]|61)","5(?:[0-59]|61[06])","5(?:[0-59]|61[06]1)"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24][1-8]|3[1-9]"],"(0$1)",,1],[,"(\\d{3})(\\d{3})(\\d{6,7})","$1 $2 $3",["80"],"0$1",,1]],[[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["512|8[01589]|90"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["5(?:[0-59]|61)","5(?:[0-59]|61[06])","5(?:[0-59]|61[06]1)"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24][1-8]|3[1-9]"],"(0$1)",,1],[,"(\\d{3})(\\d{3})(\\d{6,7})","$1 $2 $3",["80"],"0$1",,1]],[,,"512\\d{7}",,,,"5123456789",,,[10]],,,[,,"(?:444|811\\d{3})\\d{4}",,,,,,,[7,10]],[,,"444\\d{4}",,,,"4441444",,,[7]],,,[,,,,,,,,,[-1]]],TT:[,[,,"(?:[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"868(?:2(?:01|1[5-9]|[23]\\d|4[0-2])|6(?:0[7-9]|1[02-8]|2[1-9]|[3-69]\\d|7[0-79])|82[124])\\d{4}",,,,"8682211234",,,,[7]],[,,"868(?:(?:2[5-9]|3\\d)\\d|4(?:3[0-6]|[6-9]\\d)|6(?:20|78|8\\d)|7(?:0[1-9]|1[02-9]|[2-9]\\d))\\d{4}",,,,"8682911234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002345678"],[,,"900[2-9]\\d{6}",,,,"9002345678"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"TT",1,"011","1",,,"([2-46-8]\\d{6})$|1","868$1",,,,,[,,,,,,,,,[-1]],,"868",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,"868619\\d{4}",,,,"8686191234",,,,[7]]],TV:[,[,,"(?:2|7\\d\\d|90)\\d{4}",,,,,,,[5,6,7]],[,,"2[02-9]\\d{3}",,,,"20123",,,[5]],[,,"(?:7[01]\\d|90)\\d{4}",,,,"901234",,,[6,7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"TV",688,"00",,,,,,,,[[,"(\\d{2})(\\d{3})","$1 $2",["2"]],[,"(\\d{2})(\\d{4})","$1 $2",["90"]],[,"(\\d{2})(\\d{5})","$1 $2",["7"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],TW:[,[,,"[2-689]\\d{8}|7\\d{9,10}|[2-8]\\d{7}|2\\d{6}",,,,,,,[7,8,9,10,11]],[,,"(?:2[2-8]\\d|370|55[01]|7[1-9])\\d{6}|4(?:(?:0(?:0[1-9]|[2-48]\\d)|1[023]\\d)\\d{4,5}|(?:[239]\\d\\d|4(?:0[56]|12|49))\\d{5})|6(?:[01]\\d{7}|4(?:0[56]|12|24|4[09])\\d{4,5})|8(?:(?:2(?:3\\d|4[0-269]|[578]0|66)|36[24-9]|90\\d\\d)\\d{4}|4(?:0[56]|12|24|4[09])\\d{4,5})|(?:2(?:2(?:0\\d\\d|4(?:0[68]|[249]0|3[0-467]|5[0-25-9]|6[0235689]))|(?:3(?:[09]\\d|1[0-4])|(?:4\\d|5[0-49]|6[0-29]|7[0-5])\\d)\\d)|(?:(?:3[2-9]|5[2-8]|6[0-35-79]|8[7-9])\\d\\d|4(?:2(?:[089]\\d|7[1-9])|(?:3[0-4]|[78]\\d|9[01])\\d))\\d)\\d{3}",,,,"221234567",,,[8,9]],[,,"(?:40001[0-2]|9[0-8]\\d{4})\\d{3}",,,,"912345678",,,[9]],[,,"80[0-79]\\d{6}|800\\d{5}",,,,"800123456",,,[8,9]],[,,"20(?:[013-9]\\d\\d|2)\\d{4}",,,,"203123456",,,[7,9]],[,,,,,,,,,[-1]],[,,"99\\d{7}",,,,"990123456",,,[9]],[,,"7010(?:[0-2679]\\d|3[0-7]|8[0-5])\\d{5}|70\\d{8}",,,,"7012345678",,,[10,11]],"TW",886,"0(?:0[25-79]|19)","0","#",,"0",,,,[[,"(\\d{2})(\\d)(\\d{4})","$1 $2 $3",["202"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[258]0"],"0$1"],[,"(\\d)(\\d{3,4})(\\d{4})","$1 $2 $3",["[23568]|4(?:0[02-48]|[1-47-9])|7[1-9]","[23568]|4(?:0[2-48]|[1-47-9])|(?:400|7)[1-9]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[49]"],"0$1"],[,"(\\d{2})(\\d{4})(\\d{4,5})","$1 $2 $3",["7"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"50[0-46-9]\\d{6}",,,,"500123456",,,[9]],,,[,,,,,,,,,[-1]]],TZ:[,[,,"(?:[25-8]\\d|41|90)\\d{7}",,,,,,,[9]],[,,"2[2-8]\\d{7}",,,,"222345678"],[,,"(?:6[125-9]|7[13-9])\\d{7}",,,,"621234567"],[,,"80[08]\\d{6}",,,,"800123456"],[,,"90\\d{7}",,,,"900123456"],[,,"8(?:40|6[01])\\d{6}",,,,"840123456"],[,,,,,,,,,[-1]],[,,"41\\d{7}",,,,"412345678"],"TZ",255,"00[056]","0",,,"0",,,,[[,"(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[24]"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["5"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[67]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,"(?:8(?:[04]0|6[01])|90\\d)\\d{6}"],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],UA:[,[,,"[89]\\d{9}|[3-9]\\d{8}",,,,,,,[9,10],[5,6,7]],[,,"(?:3[1-8]|4[13-8]|5[1-7]|6[12459])\\d{7}",,,,"311234567",,,[9],[5,6,7]],[,,"790\\d{6}|(?:39|50|6[36-8]|7[1-357]|9[1-9])\\d{7}",,,,"501234567",,,[9]],[,,"800[1-8]\\d{5,6}",,,,"800123456"],[,,"900[239]\\d{5,6}",,,,"900212345"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"89[1-579]\\d{6}",,,,"891234567",,,[9]],"UA",380,"00","0",,,"0",,"0~0",,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6[12][29]|(?:3[1-8]|4[136-8]|5[12457]|6[49])2|(?:56|65)[24]","6[12][29]|(?:35|4[1378]|5[12457]|6[49])2|(?:56|65)[24]|(?:3[1-46-8]|46)2[013-9]"],"0$1"],[,"(\\d{4})(\\d{5})","$1 $2",["3[1-8]|4(?:[1367]|[45][6-9]|8[4-6])|5(?:[1-5]|6[0135689]|7[4-6])|6(?:[12][3-7]|[459])","3[1-8]|4(?:[1367]|[45][6-9]|8[4-6])|5(?:[1-5]|6(?:[015689]|3[02389])|7[4-6])|6(?:[12][3-7]|[459])"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[3-7]|89|9[1-9]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[89]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],UG:[,[,,"800\\d{6}|(?:[29]0|[347]\\d)\\d{7}",,,,,,,[9],[5,6,7]],[,,"20(?:(?:240|30[67])\\d|6(?:00[0-2]|30[0-4]))\\d{3}|(?:20(?:[017]\\d|2[5-9]|3[1-4]|5[0-4]|6[15-9])|[34]\\d{3})\\d{5}",,,,"312345678",,,,[5,6,7]],[,,"72[48]0\\d{5}|7(?:[015-8]\\d|2[067]|36|4[0-7]|9[89])\\d{6}",,,,"712345678"],[,,"800[1-3]\\d{5}",,,,"800123456"],[,,"90[1-3]\\d{6}",,,,"901123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"UG",256,"00[057]","0",,,"0",,,,[[,"(\\d{4})(\\d{5})","$1 $2",["202","2024"],"0$1"],[,"(\\d{3})(\\d{6})","$1 $2",["[27-9]|4(?:6[45]|[7-9])"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["[34]"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],US:[,[,,"[2-9]\\d{9}|3\\d{6}",,,,,,,[10],[7]],[,,"(?:3052(?:0[0-8]|[1-9]\\d)|5056(?:[0-35-9]\\d|4[468]))\\d{4}|(?:305[3-9]|472[24]|505[2-57-9]|983[2-47-9])\\d{6}|(?:2(?:0[1-35-9]|1[02-9]|2[03-57-9]|3[1459]|4[08]|5[1-46]|6[0279]|7[0269]|8[13])|3(?:0[1-47-9]|1[02-9]|2[0135-79]|3[0-24679]|4[167]|5[0-2]|6[01349]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[023578]|58|6[349]|7[0589]|8[04])|5(?:0[1-47-9]|1[0235-8]|20|3[0149]|4[01]|5[179]|6[1-47]|7[0-5]|8[0256])|6(?:0[1-35-9]|1[024-9]|2[03689]|3[016]|4[0156]|5[01679]|6[0-279]|78|8[0-29])|7(?:0[1-46-8]|1[2-9]|2[04-8]|3[0-247]|4[037]|5[47]|6[02359]|7[0-59]|8[156])|8(?:0[1-68]|1[02-8]|2[068]|3[0-2589]|4[03578]|5[046-9]|6[02-5]|7[028])|9(?:0[1346-9]|1[02-9]|2[0589]|3[0146-8]|4[01357-9]|5[12469]|7[0-389]|8[04-69]))[2-9]\\d{6}",,,,"2015550123",,,,[7]],[,,"(?:3052(?:0[0-8]|[1-9]\\d)|5056(?:[0-35-9]\\d|4[468]))\\d{4}|(?:305[3-9]|472[24]|505[2-57-9]|983[2-47-9])\\d{6}|(?:2(?:0[1-35-9]|1[02-9]|2[03-57-9]|3[1459]|4[08]|5[1-46]|6[0279]|7[0269]|8[13])|3(?:0[1-47-9]|1[02-9]|2[0135-79]|3[0-24679]|4[167]|5[0-2]|6[01349]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[023578]|58|6[349]|7[0589]|8[04])|5(?:0[1-47-9]|1[0235-8]|20|3[0149]|4[01]|5[179]|6[1-47]|7[0-5]|8[0256])|6(?:0[1-35-9]|1[024-9]|2[03689]|3[016]|4[0156]|5[01679]|6[0-279]|78|8[0-29])|7(?:0[1-46-8]|1[2-9]|2[04-8]|3[0-247]|4[037]|5[47]|6[02359]|7[0-59]|8[156])|8(?:0[1-68]|1[02-8]|2[068]|3[0-2589]|4[03578]|5[046-9]|6[02-5]|7[028])|9(?:0[1346-9]|1[02-9]|2[0589]|3[0146-8]|4[01357-9]|5[12469]|7[0-389]|8[04-69]))[2-9]\\d{6}",,,,"2015550123",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002345678"],[,,"900[2-9]\\d{6}",,,,"9002345678"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,"305209\\d{4}",,,,"3052090123",,,,[7]],"US",1,"011","1",,,"1",,,1,[[,"(\\d{3})(\\d{4})","$1-$2",["310"],,,1],[,"(\\d{3})(\\d{4})","$1-$2",["[24-9]|3(?:[02-9]|1[1-9])"]],[,"(\\d{3})(\\d{3})(\\d{4})","($1) $2-$3",["[2-9]"],,,1]],[[,"(\\d{3})(\\d{4})","$1-$2",["310"],,,1],[,"(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[2-9]"]]],[,,,,,,,,,[-1]],1,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],UY:[,[,,"0004\\d{2,9}|[1249]\\d{7}|(?:[49]\\d|80)\\d{5}",,,,,,,[6,7,8,9,10,11,12,13]],[,,"(?:1(?:770|9(?:20|[89]7))|(?:2\\d|4[2-7])\\d\\d)\\d{4}",,,,"21231234",,,[8],[7]],[,,"9[1-9]\\d{6}",,,,"94231234",,,[8]],[,,"0004\\d{2,9}|(?:405|80[05])\\d{4}",,,,"8001234"],[,,"90[0-8]\\d{4}",,,,"9001234",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"UY",598,"0(?:0|1[3-9]\\d)","0"," int. ",,"0",,"00",,[[,"(\\d{3})(\\d{3,4})","$1 $2",["0"]],[,"(\\d{3})(\\d{4})","$1 $2",["[49]0|8"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1"],[,"(\\d{4})(\\d{4})","$1 $2",["[124]"]],[,"(\\d{3})(\\d{3})(\\d{2,4})","$1 $2 $3",["0"]],[,"(\\d{3})(\\d{3})(\\d{3})(\\d{2,4})","$1 $2 $3 $4",["0"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],UZ:[,[,,"(?:20|33|[5-9]\\d)\\d{7}",,,,,,,[9]],[,,"(?:55\\d\\d|6(?:1(?:22|3[124]|4[1-4]|5[1-3578]|64)|2(?:22|3[0-57-9]|41)|5(?:22|3[3-7]|5[024-8])|[69]\\d\\d|7(?:[23]\\d|7[69]))|7(?:0(?:5[4-9]|6[0146]|7[124-6]|9[135-8])|(?:1[12]|[68]\\d)\\d|2(?:22|3[13-57-9]|4[1-3579]|5[14])|3(?:2\\d|3[1578]|4[1-35-7]|5[1-57]|61)|4(?:2\\d|3[1-579]|7[1-79])|5(?:22|5[1-9]|6[1457])|9(?:22|5[1-9])))\\d{5}",,,,"669050123"],[,,"(?:(?:[25]0|33|8[78]|9[0-57-9])\\d{3}|6(?:1(?:2(?:2[01]|98)|35[0-4]|50\\d|61[23]|7(?:[01][017]|4\\d|55|9[5-9]))|2(?:(?:11|7\\d)\\d|2(?:[12]1|9[01379])|5(?:[126]\\d|3[0-4]))|5(?:19[01]|2(?:27|9[26])|(?:30|59|7\\d)\\d)|6(?:2(?:1[5-9]|2[0367]|38|41|52|60)|(?:3[79]|9[0-3])\\d|4(?:56|83)|7(?:[07]\\d|1[017]|3[07]|4[047]|5[057]|67|8[0178]|9[79]))|7(?:2(?:24|3[237]|4[5-9]|7[15-8])|5(?:7[12]|8[0589])|7(?:0\\d|[39][07])|9(?:0\\d|7[079])))|7(?:[07]\\d{3}|1(?:13[01]|6(?:0[47]|1[67]|66)|71[3-69]|98\\d)|2(?:2(?:2[79]|95)|3(?:2[5-9]|6[0-6])|57\\d|7(?:0\\d|1[17]|2[27]|3[37]|44|5[057]|66|88))|3(?:2(?:1[0-6]|21|3[469]|7[159])|(?:33|9[4-6])\\d|5(?:0[0-4]|5[579]|9\\d)|7(?:[0-3579]\\d|4[0467]|6[67]|8[078]))|4(?:2(?:29|5[0257]|6[0-7]|7[1-57])|5(?:1[0-4]|8\\d|9[5-9])|7(?:0\\d|1[024589]|2[0-27]|3[0137]|[46][07]|5[01]|7[5-9]|9[079])|9(?:7[015-9]|[89]\\d))|5(?:112|2(?:0\\d|2[29]|[49]4)|3[1568]\\d|52[6-9]|7(?:0[01578]|1[017]|[23]7|4[047]|[5-7]\\d|8[78]|9[079]))|9(?:22[128]|3(?:2[0-4]|7\\d)|57[02569]|7(?:2[05-9]|3[37]|4\\d|60|7[2579]|87|9[07]))))\\d{4}",,,,"912345678"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"UZ",998,"00",,,,,,,,[[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[235-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],VA:[,[,,"0\\d{5,10}|3[0-8]\\d{7,10}|55\\d{8}|8\\d{5}(?:\\d{2,4})?|(?:1\\d|39)\\d{7,8}",,,,,,,[6,7,8,9,10,11,12]],[,,"06698\\d{1,6}",,,,"0669812345",,,[6,7,8,9,10,11]],[,,"3[1-9]\\d{8}|3[2-9]\\d{7}",,,,"3123456789",,,[9,10]],[,,"80(?:0\\d{3}|3)\\d{3}",,,,"800123456",,,[6,9]],[,,"(?:0878\\d{3}|89(?:2\\d|3[04]|4(?:[0-4]|[5-9]\\d\\d)|5[0-4]))\\d\\d|(?:1(?:44|6[346])|89(?:38|5[5-9]|9))\\d{6}",,,,"899123456",,,[6,8,9,10]],[,,"84(?:[08]\\d{3}|[17])\\d{3}",,,,"848123456",,,[6,9]],[,,"1(?:78\\d|99)\\d{6}",,,,"1781234567",,,[9,10]],[,,"55\\d{8}",,,,"5512345678",,,[10]],"VA",39,"00",,,,,,,,,,[,,,,,,,,,[-1]],,"06698",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,"3[2-8]\\d{9,10}",,,,"33101234501",,,[11,12]]],VC:[,[,,"(?:[58]\\d\\d|784|900)\\d{7}",,,,,,,[10],[7]],[,,"784(?:266|3(?:6[6-9]|7\\d|8[0-6])|4(?:38|5[0-36-8]|8[0-8])|5(?:55|7[0-2]|93)|638|784)\\d{4}",,,,"7842661234",,,,[7]],[,,"784(?:4(?:3[0-5]|5[45]|89|9[0-8])|5(?:2[6-9]|3[0-4])|720)\\d{4}",,,,"7844301234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002345678"],[,,"900[2-9]\\d{6}",,,,"9002345678"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,"78451[0-2]\\d{4}",,,,"7845101234",,,,[7]],"VC",1,"011","1",,,"([2-7]\\d{6})$|1","784$1",,,,,[,,,,,,,,,[-1]],,"784",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],VE:[,[,,"[68]00\\d{7}|(?:[24]\\d|[59]0)\\d{8}",,,,,,,[10],[7]],[,,"(?:2(?:12|3[457-9]|[467]\\d|[58][1-9]|9[1-6])|[4-6]00)\\d{7}",,,,"2121234567",,,,[7]],[,,"4(?:1[24-8]|2[46])\\d{7}",,,,"4121234567"],[,,"800\\d{7}",,,,"8001234567"],[,,"90[01]\\d{7}",,,,"9001234567"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"VE",58,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{7})","$1-$2",["[24-689]"],"0$1","$CC $1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"501\\d{7}",,,,"5010123456",,,,[7]],,,[,,,,,,,,,[-1]]],VG:[,[,,"(?:284|[58]\\d\\d|900)\\d{7}",,,,,,,[10],[7]],[,,"284(?:229|4(?:22|9[45])|774|8(?:52|6[459]))\\d{4}",,,,"2842291234",,,,[7]],[,,"284(?:245|3(?:0[0-3]|4[0-7]|68|9[34])|4(?:4[0-6]|68|9[69])|5(?:4[0-7]|68|9[69]))\\d{4}",,,,"2843001234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002345678"],[,,"900[2-9]\\d{6}",,,,"9002345678"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"VG",1,"011","1",,,"([2-578]\\d{6})$|1","284$1",,,,,[,,,,,,,,,[-1]],,"284",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],VI:[,[,,"[58]\\d{9}|(?:34|90)0\\d{7}",,,,,,,[10],[7]],[,,"340(?:2(?:0\\d|10|2[06-8]|4[49]|77)|3(?:32|44)|4(?:2[23]|44|7[34]|89)|5(?:1[34]|55)|6(?:2[56]|4[23]|77|9[023])|7(?:1[2-57-9]|2[57]|7\\d)|884|998)\\d{4}",,,,"3406421234",,,,[7]],[,,"340(?:2(?:0\\d|10|2[06-8]|4[49]|77)|3(?:32|44)|4(?:2[23]|44|7[34]|89)|5(?:1[34]|55)|6(?:2[56]|4[23]|77|9[023])|7(?:1[2-57-9]|2[57]|7\\d)|884|998)\\d{4}",,,,"3406421234",,,,[7]],[,,"8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",,,,"8002345678"],[,,"900[2-9]\\d{6}",,,,"9002345678"],[,,,,,,,,,[-1]],[,,"52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}",,,,"5002345678"],[,,,,,,,,,[-1]],"VI",1,"011","1",,,"([2-9]\\d{6})$|1","340$1",,1,,,[,,,,,,,,,[-1]],,"340",[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],VN:[,[,,"[12]\\d{9}|[135-9]\\d{8}|[16]\\d{7}|[16-8]\\d{6}",,,,,,,[7,8,9,10]],[,,"2(?:0[3-9]|1[0-689]|2[0-25-9]|[38][2-9]|4[2-8]|5[124-9]|6[0-39]|7[0-7]|9[0-4679])\\d{7}",,,,"2101234567",,,[10]],[,,"(?:5(?:2[238]|59)|89[6-9]|99[013-9])\\d{6}|(?:3\\d|5[1689]|7[06-9]|8[1-8]|9[0-8])\\d{7}",,,,"912345678",,,[9]],[,,"1800\\d{4,6}|12(?:0[13]|28)\\d{4}",,,,"1800123456",,,[8,9,10]],[,,"1900\\d{4,6}",,,,"1900123456",,,[8,9,10]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"672\\d{6}",,,,"672012345",,,[9]],"VN",84,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[17]99"],"0$1",,1],[,"(\\d{2})(\\d{5})","$1 $2",["80"],"0$1",,1],[,"(\\d{3})(\\d{4,5})","$1 $2",["69"],"0$1",,1],[,"(\\d{4})(\\d{4,6})","$1 $2",["1"],,,1],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["6"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[357-9]"],"0$1",,1],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["2[48]"],"0$1",,1],[,"(\\d{3})(\\d{4})(\\d{3})","$1 $2 $3",["2"],"0$1",,1]],[[,"(\\d{2})(\\d{5})","$1 $2",["80"],"0$1",,1],[,"(\\d{4})(\\d{4,6})","$1 $2",["1"],,,1],[,"(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["6"],"0$1",,1],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[357-9]"],"0$1",,1],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["2[48]"],"0$1",,1],[,"(\\d{3})(\\d{4})(\\d{3})","$1 $2 $3",["2"],"0$1",,1]],[,,,,,,,,,[-1]],,,[,,"[17]99\\d{4}|69\\d{5,6}",,,,,,,[7,8]],[,,"(?:[17]99|80\\d)\\d{4}|69\\d{5,6}",,,,"1992000",,,[7,8]],,,[,,,,,,,,,[-1]]],VU:[,[,,"[57-9]\\d{6}|(?:[238]\\d|48)\\d{3}",,,,,,,[5,7]],[,,"(?:38[0-8]|48[4-9])\\d\\d|(?:2[02-9]|3[4-7]|88)\\d{3}",,,,"22123",,,[5]],[,,"(?:[58]\\d|7[013-7])\\d{5}",,,,"5912345",,,[7]],[,,"81[18]\\d\\d",,,,"81123",,,[5]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9(?:0[1-9]|1[01])\\d{4}",,,,"9010123",,,[7]],"VU",678,"00",,,,,,,,[[,"(\\d{3})(\\d{4})","$1 $2",["[57-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"(?:3[03]|900\\d)\\d{3}",,,,"30123"],,,[,,,,,,,,,[-1]]],WF:[,[,,"(?:40|72|8\\d{4})\\d{4}|[89]\\d{5}",,,,,,,[6,9]],[,,"72\\d{4}",,,,"721234",,,[6]],[,,"(?:72|8[23])\\d{4}",,,,"821234",,,[6]],[,,"80[0-5]\\d{6}",,,,"800012345",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9[23]\\d{4}",,,,"921234",,,[6]],"WF",681,"00",,,,,,,,[[,"(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["[47-9]"]],[,"(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,"[48]0\\d{4}",,,,"401234",,,[6]]],WS:[,[,,"(?:[2-6]|8\\d{5})\\d{4}|[78]\\d{6}|[68]\\d{5}",,,,,,,[5,6,7,10]],[,,"6[1-9]\\d{3}|(?:[2-5]|60)\\d{4}",,,,"22123",,,[5,6]],[,,"(?:7[1-35-7]|8(?:[3-7]|9\\d{3}))\\d{5}",,,,"7212345",,,[7,10]],[,,"800\\d{3}",,,,"800123",,,[6]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"WS",685,"0",,,,,,,,[[,"(\\d{5})","$1",["[2-5]|6[1-9]"]],[,"(\\d{3})(\\d{3,7})","$1 $2",["[68]"]],[,"(\\d{2})(\\d{5})","$1 $2",["7"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],XK:[,[,,"2\\d{7,8}|3\\d{7,11}|(?:4\\d\\d|[89]00)\\d{5}",,,,,,,[8,9,10,11,12]],[,,"38\\d{6,10}|(?:2[89]|39)(?:0\\d{5,6}|[1-9]\\d{5})",,,,"28012345"],[,,"4[3-9]\\d{6}",,,,"43201234",,,[8]],[,,"800\\d{5}",,,,"80001234",,,[8]],[,,"900\\d{5}",,,,"90001234",,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"XK",383,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{5})","$1 $2",["[89]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2-4]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["2|39"],"0$1"],[,"(\\d{2})(\\d{7,10})","$1 $2",["3"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],YE:[,[,,"(?:1|7\\d)\\d{7}|[1-7]\\d{6}",,,,,,,[7,8,9],[6]],[,,"78[0-7]\\d{4}|17\\d{6}|(?:[12][2-68]|3[2358]|4[2-58]|5[2-6]|6[3-58]|7[24-6])\\d{5}",,,,"1234567",,,[7,8],[6]],[,,"7[01378]\\d{7}",,,,"712345678",,,[9]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"YE",967,"00","0",,,"0",,,,[[,"(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-6]|7(?:[24-6]|8[0-7])"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["7"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],YT:[,[,,"7093\\d{5}|(?:80|9\\d)\\d{7}|(?:26|63)9\\d{6}",,,,,,,[9]],[,,"269(?:0[0-467]|15|5[0-4]|6\\d|[78]0)\\d{4}",,,,"269601234"],[,,"(?:639(?:0[0-79]|1[019]|[267]\\d|3[09]|40|5[05-9]|9[04-79])|7093[5-7])\\d{4}",,,,"639012345"],[,,"80\\d{7}",,,,"801234567"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"9(?:(?:39|47)8[01]|769\\d)\\d{4}",,,,"939801234"],"YT",262,"00","0",,,"0",,,,,,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],ZA:[,[,,"[1-79]\\d{8}|8\\d{4,9}",,,,,,,[5,6,7,8,9,10]],[,,"(?:2(?:0330|4302)|52087)0\\d{3}|(?:1[0-8]|2[1-378]|3[1-69]|4\\d|5[1346-8])\\d{7}",,,,"101234567",,,[9]],[,,"(?:1(?:3492[0-25]|4495[0235]|549(?:20|5[01]))|4[34]492[01])\\d{3}|8[1-4]\\d{3,7}|(?:2[27]|47|54)4950\\d{3}|(?:1(?:049[2-4]|9[12]\\d\\d)|(?:6\\d\\d|7(?:[0-46-9]\\d|5[0-4]))\\d\\d|8(?:5\\d{3}|7(?:08[67]|158|28[5-9]|310)))\\d{4}|(?:1[6-8]|28|3[2-69]|4[025689]|5[36-8])4920\\d{3}|(?:12|[2-5]1)492\\d{4}",,,,"711234567",,,[5,6,7,8,9]],[,,"80\\d{7}",,,,"801234567",,,[9]],[,,"(?:86[2-9]|9[0-2]\\d)\\d{6}",,,,"862345678",,,[9]],[,,"860\\d{6}",,,,"860123456",,,[9]],[,,,,,,,,,[-1]],[,,"87(?:08[0-589]|15[0-79]|28[0-4]|31[1-9])\\d{4}|87(?:[02][0-79]|1[0-46-9]|3[02-9]|[4-9]\\d)\\d{5}",,,,"871234567",,,[9]],"ZA",27,"00","0",,,"0",,,,[[,"(\\d{2})(\\d{3,4})","$1 $2",["8[1-4]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["8[1-4]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["860"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-9]"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"861\\d{6,7}",,,,"861123456",,,[9,10]],,,[,,,,,,,,,[-1]]],ZM:[,[,,"800\\d{6}|(?:21|63|[79]\\d)\\d{7}",,,,,,,[9],[6]],[,,"21[1-8]\\d{6}",,,,"211234567",,,,[6]],[,,"(?:7[5-79]|9[5-8])\\d{7}",,,,"955123456"],[,,"800\\d{6}",,,,"800123456"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"63\\d{7}",,,,"630123456"],"ZM",260,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3})","$1 $2",["[1-9]"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[28]"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["[79]"],"0$1"]],[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[28]"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["[79]"],"0$1"]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],ZW:[,[,,"2(?:[0-57-9]\\d{6,8}|6[0-24-9]\\d{6,7})|[38]\\d{9}|[35-8]\\d{8}|[3-6]\\d{7}|[1-689]\\d{6}|[1-3569]\\d{5}|[1356]\\d{4}",,,,,,,[5,6,7,8,9,10],[3,4]],[,,"(?:1(?:(?:3\\d|9)\\d|[4-8])|2(?:(?:(?:0(?:2[014]|5)|(?:2[0157]|31|84|9)\\d\\d|[56](?:[14]\\d\\d|20)|7(?:[089]|2[03]|[35]\\d\\d))\\d|4(?:2\\d\\d|8))\\d|1(?:2|[39]\\d{4}))|3(?:(?:123|(?:29\\d|92)\\d)\\d\\d|7(?:[19]|[56]\\d))|5(?:0|1[2-478]|26|[37]2|4(?:2\\d{3}|83)|5(?:25\\d\\d|[78])|[689]\\d)|6(?:(?:[16-8]21|28|52[013])\\d\\d|[39])|8(?:[1349]28|523)\\d\\d)\\d{3}|(?:4\\d\\d|9[2-9])\\d{4,5}|(?:(?:2(?:(?:(?:0|8[146])\\d|7[1-7])\\d|2(?:[278]\\d|92)|58(?:2\\d|3))|3(?:[26]|9\\d{3})|5(?:4\\d|5)\\d\\d)\\d|6(?:(?:(?:[0-246]|[78]\\d)\\d|37)\\d|5[2-8]))\\d\\d|(?:2(?:[569]\\d|8[2-57-9])|3(?:[013-59]\\d|8[37])|6[89]8)\\d{3}",,,,"1312345",,,,[3,4]],[,,"7(?:[1278]\\d|3[1-9])\\d{6}",,,,"712345678",,,[9]],[,,"80(?:[01]\\d|20|8[0-8])\\d{3}",,,,"8001234",,,[7]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"86(?:1[12]|22|30|44|55|77|8[368])\\d{6}",,,,"8686123456",,,[10]],"ZW",263,"00","0",,,"0",,,,[[,"(\\d{3})(\\d{3,5})","$1 $2",["2(?:0[45]|2[278]|[49]8)|3(?:[09]8|17)|6(?:[29]8|37|75)|[23][78]|(?:33|5[15]|6[68])[78]"],"0$1"],[,"(\\d)(\\d{3})(\\d{2,4})","$1 $2 $3",["[49]"],"0$1"],[,"(\\d{3})(\\d{4})","$1 $2",["80"],"0$1"],[,"(\\d{2})(\\d{7})","$1 $2",["24|8[13-59]|(?:2[05-79]|39|5[45]|6[15-8])2","2(?:02[014]|4|[56]20|[79]2)|392|5(?:42|525)|6(?:[16-8]21|52[013])|8[13-59]"],"(0$1)"],[,"(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"],[,"(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["2(?:1[39]|2[0157]|[378]|[56][14])|3(?:12|29)","2(?:1[39]|2[0157]|[378]|[56][14])|3(?:123|29)"],"0$1"],[,"(\\d{4})(\\d{6})","$1 $2",["8"],"0$1"],[,"(\\d{2})(\\d{3,5})","$1 $2",["1|2(?:0[0-36-9]|12|29|[56])|3(?:1[0-689]|[24-6])|5(?:[0236-9]|1[2-4])|6(?:[013-59]|7[0-46-9])|(?:33|55|6[68])[0-69]|(?:29|3[09]|62)[0-79]"],"0$1"],[,"(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["29[013-9]|39|54"],"0$1"],[,"(\\d{4})(\\d{3,5})","$1 $2",["(?:25|54)8","258|5483"],"0$1"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],800:[,[,,"(?:00|[1-9]\\d)\\d{6}",,,,,,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:00|[1-9]\\d)\\d{6}",,,,"12345678"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"001",800,,,,,,,,1,[[,"(\\d{4})(\\d{4})","$1 $2",["\\d"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],808:[,[,,"[1-9]\\d{7}",,,,,,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"[1-9]\\d{7}",,,,"12345678"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"001",808,,,,,,,,1,[[,"(\\d{4})(\\d{4})","$1 $2",["[1-9]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],870:[,[,,"7\\d{11}|[235-7]\\d{8}",,,,,,,[9,12]],[,,,,,,,,,[-1]],[,,"(?:[356]|774[45])\\d{8}|7[6-8]\\d{7}",,,,"301234567"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"2\\d{8}",,,,"201234567",,,[9]],"001",870,,,,,,,,,[[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235-7]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],878:[,[,,"10\\d{10}",,,,,,,[12]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"10\\d{10}",,,,"101234567890"],"001",878,,,,,,,,1,[[,"(\\d{2})(\\d{5})(\\d{5})","$1 $2 $3",["1"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],881:[,[,,"6\\d{9}|[0-36-9]\\d{8}",,,,,,,[9,10]],[,,,,,,,,,[-1]],[,,"6\\d{9}|[0-36-9]\\d{8}",,,,"612345678"],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"001",881,,,,,,,,,[[,"(\\d)(\\d{3})(\\d{5})","$1 $2 $3",["[0-37-9]"]],[,"(\\d)(\\d{3})(\\d{5,6})","$1 $2 $3",["6"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],882:[,[,,"[13]\\d{6}(?:\\d{2,5})?|[19]\\d{7}|(?:[25]\\d\\d|4)\\d{7}(?:\\d{2})?",,,,,,,[7,8,9,10,11,12]],[,,,,,,,,,[-1]],[,,"342\\d{4}|(?:337|49)\\d{6}|(?:3(?:2|47|7\\d{3})|50\\d{3})\\d{7}",,,,"3421234",,,[7,8,9,10,12]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"1(?:3(?:0[0347]|[13][0139]|2[035]|4[013568]|6[0459]|7[06]|8[15-8]|9[0689])\\d{4}|6\\d{5,10})|(?:345\\d|9[89])\\d{6}|(?:10|2(?:3|85\\d)|3(?:[15]|[69]\\d\\d)|4[15-8]|51)\\d{8}",,,,"390123456789"],"001",882,,,,,,,,,[[,"(\\d{2})(\\d{5})","$1 $2",["16|342"]],[,"(\\d{2})(\\d{6})","$1 $2",["49"]],[,"(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["1[36]|9"]],[,"(\\d{2})(\\d{4})(\\d{3})","$1 $2 $3",["3[23]"]],[,"(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["16"]],[,"(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["10|23|3(?:[15]|4[57])|4|51"]],[,"(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["34"]],[,"(\\d{2})(\\d{4,5})(\\d{5})","$1 $2 $3",["[1-35]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,"348[57]\\d{7}",,,,"34851234567",,,[11]]],883:[,[,,"(?:[1-4]\\d|51)\\d{6,10}",,,,,,,[8,9,10,11,12]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"(?:2(?:00\\d\\d|10)|(?:370[1-9]|51\\d0)\\d)\\d{7}|51(?:00\\d{5}|[24-9]0\\d{4,7})|(?:1[0-79]|2[24-689]|3[02-689]|4[0-4])0\\d{5,9}",,,,"510012345"],"001",883,,,,,,,,1,[[,"(\\d{3})(\\d{3})(\\d{2,8})","$1 $2 $3",["[14]|2[24-689]|3[02-689]|51[24-9]"]],[,"(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["510"]],[,"(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["21"]],[,"(\\d{4})(\\d{4})(\\d{4})","$1 $2 $3",["51[13]"]],[,"(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[235]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]],888:[,[,,"\\d{11}",,,,,,,[11]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"001",888,,,,,,,,1,[[,"(\\d{3})(\\d{3})(\\d{5})","$1 $2 $3"]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,"\\d{11}",,,,"12345678901"],,,[,,,,,,,,,[-1]]],979:[,[,,"[1359]\\d{8}",,,,,,,[9],[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,"[1359]\\d{8}",,,,"123456789",,,,[8]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],"001",979,,,,,,,,1,[[,"(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["[1359]"]]],,[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]],[,,,,,,,,,[-1]],,,[,,,,,,,,,[-1]]]};function K(){this.g={}}K.h=void 0,K.g=function(){return K.h?K.h:K.h=new K};var V={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"},j={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","+":"+","*":"*","#":"#"},H={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9",A:"2",B:"2",C:"2",D:"3",E:"3",F:"3",G:"4",H:"4",I:"4",J:"5",K:"5",L:"5",M:"6",N:"6",O:"6",P:"7",Q:"7",R:"7",S:"7",T:"8",U:"8",V:"8",W:"9",X:"9",Y:"9",Z:"9"},z=RegExp("[+＋]+"),W=RegExp("^[+＋]+"),Z=RegExp("([0-9０-９٠-٩۰-۹])"),Y=RegExp("[+＋0-9０-９٠-٩۰-۹]"),J=/[\\\/] *x/,q=RegExp("[^0-9０-９٠-٩۰-۹A-Za-z#]+$"),X=/(?:.*?[A-Za-z]){3}.*/,Q=RegExp("^\\+([0-9０-９٠-٩۰-۹]|[\\-\\.\\(\\)]?)*[0-9０-９٠-٩۰-۹]([0-9０-９٠-٩۰-۹]|[\\-\\.\\(\\)]?)*$"),dd=RegExp("^([A-Za-z0-9０-９٠-٩۰-۹]+((\\-)*[A-Za-z0-9０-９٠-٩۰-۹])*\\.)*[A-Za-z]+((\\-)*[A-Za-z0-9０-９٠-٩۰-۹])*\\.?$");function td(d){return"([0-9０-９٠-٩۰-۹]{1,"+d+"})"}function ed(){return";ext="+td("20")+"|[  \\t,]*(?:e?xt(?:ensi(?:ó?|ó))?n?|ｅ?ｘｔｎ?|доб|anexo)[:\\.．]?[  \\t,-]*"+td("20")+"#?|[  \\t,]*(?:[xｘ#＃~～]|int|ｉｎｔ)[:\\.．]?[  \\t,-]*"+td("9")+"#?|[- ]+"+td("6")+"#|[  \\t]*(?:,{2}|;)[:\\.．]?[  \\t,-]*"+td("15")+"#?|[  \\t]*(?:,)+[:\\.．]?[  \\t,-]*"+td("9")+"#?"}var $d=new RegExp("(?:"+ed()+")$","i"),nd=new RegExp("^[0-9０-９٠-٩۰-۹]{2}$|^[+＋]*(?:[-x‐-―−ー－-／  ­​⁠　()（）［］.\\[\\]/~⁓∼～*]*[0-9０-９٠-٩۰-۹]){3,}[-x‐-―−ー－-／  ­​⁠　()（）［］.\\[\\]/~⁓∼～*A-Za-z0-9０-９٠-٩۰-۹]*(?:"+ed()+")?$","i"),id=/(\$\d)/,rd=/^\(?\$1\)?$/;function od(d){return!(2>d.length)&&Md(nd,d)}function sd(d){return Md(X,d)?ud(d,H):ud(d,V)}function ad(d){var t=sd(d.toString());E(d),d.g(t)}function ld(d){return null!=d&&(1!=_(d,9)||-1!=b(d,9)[0])}function ud(d,t){for(var e,$=new N,n=d.length,i=0;i<n;++i)null!=(e=t[(e=d.charAt(i)).toUpperCase()])&&$.g(e);return $.toString()}function hd(d){return 0==d.length||rd.test(d)}function cd(d){return null!=d&&isNaN(d)&&d.toUpperCase()in U}function pd(d,t,e){return bd(d,"001"==e?""+t:e)}function gd(d){if(!C(d,2))return"";var t=""+y(d,2);return C(d,4)&&y(d,4)&&0<f(d,8)?Array(f(d,8)+1).join("0")+t:t}function Cd(d,t,e,$){switch(t){case 0:return"+"+d+e+$;case 1:return"+"+d+" "+e+$;case 3:return"tel:+"+d+"-"+e+$;default:return e+$}}function md(d,t){switch(t){case 4:return y(d,5);case 3:return y(d,4);case 1:return y(d,3);case 0:case 2:return y(d,2);case 5:return y(d,6);case 6:return y(d,8);case 7:return y(d,7);case 8:return y(d,21);case 9:return y(d,25);case 10:return y(d,28);default:return y(d,1)}}function yd(d,t){var e=Id(d,t);return null==(d=pd(d,f(t,1),e))?-1:fd(t=gd(t),d)}function fd(d,t){return _d(d,y(t,1))?_d(d,y(t,5))?4:_d(d,y(t,4))?3:_d(d,y(t,6))?5:_d(d,y(t,8))?6:_d(d,y(t,7))?7:_d(d,y(t,21))?8:_d(d,y(t,25))?9:_d(d,y(t,28))?10:_d(d,y(t,2))?y(t,18)||_d(d,y(t,3))?2:0:!y(t,18)&&_d(d,y(t,3))?1:-1:-1}function bd(d,t){if(null==t)return null;t=t.toUpperCase();var e=d.g[t];if(null==e){if(null==(e=U[t]))return null;e=(new T).g(R.m(),e),d.g[t]=e}return e}function _d(d,t){var e=d.length;return!(0<_(t,9)&&-1==b(t,9).indexOf(e))&&Md(f(t,2),d)}function Id(d,t){if(null==t)return null;var e=f(t,1);if(null==(e=F[e]))d=null;else if(1==e.length)d=e[0];else d:{t=gd(t);for(var $,n=e.length,i=0;i<n;i++){var r=bd(d,$=e[i]);if(C(r,23)){if(0==t.search(y(r,23))){d=$;break d}}else if(-1!=fd(t,r)){d=$;break d}}d=null}return d}function vd(d){return null==(d=F[d])?"ZZ":d[0]}function wd(d,t){if(null==(d=bd(d,t)))throw Error("Invalid region code: "+t);return f(d,10)}function Sd(d,t,e,$){var n=md(e,$),i=0==_(n,9)?b(y(e,1),9):b(n,9);if(n=b(n,10),2==$){if(!ld(md(e,0)))return Sd(d,t,e,1);ld(d=md(e,1))&&((i=i.concat(0==_(d,9)?b(y(e,1),9):b(d,9))).sort(),0==n.length?n=b(d,10):(n=n.concat(b(d,10))).sort())}return-1==i[0]?5:(t=t.length,-1<n.indexOf(t)?4:(e=i[0])==t?0:e>t?2:i[i.length-1]<t?3:-1<i.indexOf(t,1)?0:5)}function Ld(d,t,e){var $=gd(t);return(t=f(t,1))in F?Sd(d,$,t=pd(d,t,vd(t)),e):1}function Ad(d,t){if(0==(d=d.toString()).length||"0"==d.charAt(0))return 0;for(var e,$=d.length,n=1;3>=n&&n<=$;++n)if((e=parseInt(d.substring(0,n),10))in F)return t.g(d.substring(n)),e;return 0}function Td(d,t,e,$,n,i){if(0==t.length)return 0;var r;t=new N(t),null!=e&&(r=y(e,11)),null==r&&(r="NonMatch");var o=t.toString();if(0==o.length)r=20;else if(W.test(o))o=o.replace(W,""),E(t),t.g(sd(o)),r=1;else{if(o=new RegExp(r),ad(t),0==(r=t.toString()).search(o)){o=r.match(o)[0].length;var s=r.substring(o).match(Z);s&&null!=s[1]&&0<s[1].length&&"0"==ud(s[1],V)?r=!1:(E(t),t.g(r.substring(o)),r=!0)}else r=!1;r=r?5:20}if(n&&I(i,6,r),20!=r){if(2>=t.h.length)throw Error("Phone number too short after IDD");if(0!=(d=Ad(t,$)))return I(i,1,d),d;throw Error("Invalid country calling code")}return null!=e&&(o=""+(r=f(e,10)),0==(s=t.toString()).lastIndexOf(o,0)&&(o=new N(s.substring(o.length)),s=y(e,1),s=new RegExp(f(s,2)),Nd(o,e,null),o=o.toString(),!Md(s,t.toString())&&Md(s,o)||3==Sd(d,t.toString(),e,-1)))?($.g(o),n&&I(i,6,10),I(i,1,r),r):(I(i,1,0),0)}function Nd(d,t,e){var $=d.toString(),n=$.length,i=y(t,15);if(0!=n&&null!=i&&0!=i.length){var r=new RegExp("^(?:"+i+")");if(n=r.exec($)){var o=Md(i=new RegExp(f(y(t,1),2)),$),s=n.length-1;null==(t=y(t,16))||0==t.length||null==n[s]||0==n[s].length?o&&!Md(i,$.substring(n[0].length))||(null!=e&&0<s&&null!=n[s]&&e.g(n[1]),d.set($.substring(n[0].length))):($=$.replace(r,t),(!o||Md(i,$))&&(null!=e&&0<s&&e.g(n[1]),d.set($)))}}}function Ed(d,t,e){if(!cd(e)&&0<t.length&&"+"!=t.charAt(0))throw Error("Invalid country calling code");return Dd(d,t,e,!0)}function Dd(d,t,e,$){if(null==t)throw Error("The string supplied did not seem to be a phone number");if(250<t.length)throw Error("The string supplied is too long to be a phone number");var n=new N,i=t.indexOf(";phone-context=");if(-1===i)i=null;else if((i+=15)>=t.length)i="";else{var r=t.indexOf(";",i);i=-1!==r?t.substring(i,r):t.substring(i)}var o=i;if(null==o?r=!0:0===o.length?r=!1:(r=Q.exec(o),o=dd.exec(o),r=null!==r||null!==o),!r)throw Error("The string supplied did not seem to be a phone number");if(null!=i?("+"===i.charAt(0)&&n.g(i),i=t.indexOf("tel:"),n.g(t.substring(0<=i?i+4:0,t.indexOf(";phone-context=")))):(i=n.g,0<=(o=(r=t??"").search(Y))?0<=(o=(r=(r=r.substring(o)).replace(q,"")).search(J))&&(r=r.substring(0,o)):r="",i.call(n,r)),0<(r=(i=n.toString()).indexOf(";isub="))&&(E(n),n.g(i.substring(0,r))),!od(n.toString()))throw Error("The string supplied did not seem to be a phone number");if(i=n.toString(),!(cd(e)||null!=i&&0<i.length&&W.test(i)))throw Error("Invalid country calling code");i=new O,$&&I(i,5,t);d:{if(0<=(r=(t=n.toString()).search($d))&&od(t.substring(0,r)))for(var s=(o=t.match($d)).length,a=1;a<s;++a)if(null!=o[a]&&0<o[a].length){E(n),n.g(t.substring(0,r)),t=o[a];break d}t=""}0<t.length&&I(i,3,t),r=bd(d,e),t=new N,o=0,s=n.toString();try{o=Td(d,s,r,t,$,i)}catch(e){if("Invalid country calling code"!=e.message||!W.test(s))throw e;if(0==(o=Td(d,s=s.replace(W,""),r,t,$,i)))throw e}if(0!=o?(n=vd(o))!=e&&(r=pd(d,o,n)):(ad(n),t.g(n.toString()),null!=e?I(i,1,o=f(r,10)):$&&(delete i.h[6],i.g&&delete i.g[6])),2>t.h.length)throw Error("The string supplied is too short to be a phone number");if(null!=r&&(e=new N,Nd(n=new N(t.toString()),r,e),2!=(d=Sd(d,n.toString(),r,-1))&&4!=d&&5!=d&&(t=n,$&&0<e.toString().length&&I(i,7,e.toString()))),2>(d=($=t.toString()).length))throw Error("The string supplied is too short to be a phone number");if(17<d)throw Error("The string supplied is too long to be a phone number");if(1<$.length&&"0"==$.charAt(0)){for(I(i,4,!0),d=1;d<$.length-1&&"0"==$.charAt(d);)d++;1!=d&&I(i,8,d)}return I(i,2,parseInt($,10)),i}function Md(d,t){return!(!(d="string"==typeof d?t.match("^(?:"+d+")$"):t.match(d))||d[0].length!=t.length)}function Pd(d){this.fa=RegExp(" "),this.ja="",this.v=new N,this.da="",this.s=new N,this.ba=new N,this.u=!0,this.ea=this.ca=this.la=!1,this.ga=K.g(),this.$=0,this.h=new N,this.ha=!1,this.o="",this.g=new N,this.j=[],this.ka=d,this.l=Od(this,this.ka)}K.prototype.format=function(d,t){if(0==y(d,2)&&C(d,5)){var e=f(d,5);if(0<e.length)return e}e=f(d,1);var $=gd(d);if(0==t)return Cd(e,0,$,"");if(!(e in F))return $;var n=pd(this,e,vd(e));d=C(d,3)&&0!=y(d,3).length?3==t?";ext="+y(d,3):C(n,13)?y(n,13)+f(d,3):" ext. "+f(d,3):"";d:{for(var i,r=(n=0==b(n,20).length||2==t?b(n,19):b(n,20)).length,o=0;o<r;++o){var s=_(i=n[o],3);if((0==s||0==$.search(y(i,3,s-1)))&&Md(s=new RegExp(y(i,1)),$)){n=i;break d}}n=null}return null!=n&&(n=f(r=n,2),i=new RegExp(y(r,1)),f(r,5),r=f(r,4),$=2==t&&null!=r&&0<r.length?$.replace(i,n.replace(id,r)):$.replace(i,n),3==t&&($=($=$.replace(RegExp("^[-x‐-―−ー－-／  ­​⁠　()（）［］.\\[\\]/~⁓∼～]+"),"")).replace(RegExp("[-x‐-―−ー－-／  ­​⁠　()（）［］.\\[\\]/~⁓∼～]+","g"),"-"))),Cd(e,t,$,d)};var xd=new R;I(xd,11,"NA");var Rd=RegExp("^[-x‐-―−ー－-／  ­​⁠　()（）［］.\\[\\]/~⁓∼～]*\\$1[-x‐-―−ー－-／  ­​⁠　()（）［］.\\[\\]/~⁓∼～]*(\\$\\d[-x‐-―−ー－-／  ­​⁠　()（）［］.\\[\\]/~⁓∼～]*)*$"),Bd=/[- ]/;function Od(d,t){var e=d.ga;return t=cd(t)?wd(e,t):0,null!=(d=bd(d.ga,vd(t)))?d:xd}function kd(d){for(var t=d.j.length,e=0;e<t;++e){var $=d.j[e],n=f($,1);if(d.da==n)return!1;var i=d,r=$,o=f(r,1);E(i.v);var s=i;r=f(r,2);var a="999999999999999".match(o)[0];if(0<(s=a.length<s.g.h.length?"":(s=a.replace(new RegExp(o,"g"),r)).replace(RegExp("9","g")," ")).length?(i.v.g(s),i=!0):i=!1,i)return d.da=n,d.ha=Bd.test(y($,4)),d.$=0,!0}return d.u=!1}function Gd(d,t){for(var e=[],$=t.length-3,n=d.j.length,i=0;i<n;++i){var r=d.j[i];0==_(r,3)?e.push(d.j[i]):(r=y(r,3,Math.min($,_(r,3)-1)),0==t.search(r)&&e.push(d.j[i]))}d.j=e}function Fd(d,t){d.s.g(t);var e=t;if(Z.test(e)||1==d.s.h.length&&z.test(e)?("+"==t?(e=t,d.ba.g(t)):(e=V[t],d.ba.g(e),d.g.g(e)),t=e):(d.u=!1,d.la=!0),!d.u){if(!d.la)if(Wd(d)){if(Zd(d))return Ud(d)}else if(0<d.o.length&&(t=d.g.toString(),E(d.g),d.g.g(d.o),d.g.g(t),e=(t=d.h.toString()).lastIndexOf(d.o),E(d.h),d.h.g(t.substring(0,e))),d.o!=zd(d))return d.h.g(" "),Ud(d);return d.s.toString()}switch(d.ba.h.length){case 0:case 1:case 2:return d.s.toString();case 3:if(!Wd(d))return d.o=zd(d),jd(d);d.ea=!0;default:return d.ea?(Zd(d)&&(d.ea=!1),d.h.toString()+d.g.toString()):0<d.j.length?(t=Yd(d,t),0<(e=Kd(d)).length?e:(Gd(d,d.g.toString()),kd(d)?Hd(d):d.u?Vd(d,t):d.s.toString())):jd(d)}}function Ud(d){return d.u=!0,d.ea=!1,d.j=[],d.$=0,E(d.v),d.da="",jd(d)}function Kd(d){for(var t=d.g.toString(),e=d.j.length,$=0;$<e;++$){var n=d.j[$],i=f(n,1);if(new RegExp("^(?:"+i+")$").test(t)&&(d.ha=Bd.test(y(n,4)),ud(n=Vd(d,n=t.replace(new RegExp(i,"g"),y(n,2))),j)==d.ba))return n}return""}function Vd(d,t){var e=d.h.h.length;return d.ha&&0<e&&" "!=d.h.toString().charAt(e-1)?d.h+" "+t:d.h+t}function jd(d){var t=d.g.toString();if(3<=t.length){for(var e=d.ca&&0==d.o.length&&0<_(d.l,20)?b(d.l,20):b(d.l,19),$=e.length,n=0;n<$;++n){var i=e[n];0<d.o.length&&hd(f(i,4))&&!y(i,6)&&!C(i,5)||(0!=d.o.length||d.ca||hd(f(i,4))||y(i,6))&&Rd.test(f(i,2))&&d.j.push(i)}return Gd(d,t),0<(t=Kd(d)).length?t:kd(d)?Hd(d):d.s.toString()}return Vd(d,t)}function Hd(d){var t=d.g.toString(),e=t.length;if(0<e){for(var $="",n=0;n<e;n++)$=Yd(d,t.charAt(n));return d.u?Vd(d,$):d.s.toString()}return d.h.toString()}function zd(d){var t=d.g.toString(),e=0;if(1!=y(d.l,10))var $=!1;else $="1"==($=d.g.toString()).charAt(0)&&"0"!=$.charAt(1)&&"1"!=$.charAt(1);return $?(e=1,d.h.g("1").g(" "),d.ca=!0):C(d.l,15)&&($=new RegExp("^(?:"+y(d.l,15)+")"),null!=($=t.match($))&&null!=$[0]&&0<$[0].length&&(d.ca=!0,e=$[0].length,d.h.g(t.substring(0,e)))),E(d.g),d.g.g(t.substring(e)),t.substring(0,e)}function Wd(d){var t=d.ba.toString(),e=new RegExp("^(?:\\+|"+y(d.l,11)+")");return null!=(e=t.match(e))&&null!=e[0]&&0<e[0].length&&(d.ca=!0,e=e[0].length,E(d.g),d.g.g(t.substring(e)),E(d.h),d.h.g(t.substring(0,e)),"+"!=t.charAt(0)&&d.h.g(" "),!0)}function Zd(d){if(0==d.g.h.length)return!1;var t=new N,e=Ad(d.g,t);return 0!=e&&(E(d.g),d.g.g(t.toString()),"001"==(t=vd(e))?d.l=bd(d.ga,""+e):t!=d.ka&&(d.l=Od(d,t)),d.h.g(""+e).g(" "),d.o="",!0)}function Yd(d,t){var e=d.v.toString();if(0<=e.substring(d.$).search(d.fa)){var $=e.search(d.fa);return t=e.replace(d.fa,t),E(d.v),d.v.g(t),d.$=$,t.substring(0,d.$+1)}return 1==d.j.length&&(d.u=!1),d.da="",d.s.toString()}const Jd={FIXED_LINE:0,MOBILE:1,FIXED_LINE_OR_MOBILE:2,TOLL_FREE:3,PREMIUM_RATE:4,SHARED_COST:5,VOIP:6,PERSONAL_NUMBER:7,PAGER:8,UAN:9,VOICEMAIL:10,UNKNOWN:-1};t("intlTelInputUtilsTemp",{}),t("intlTelInputUtilsTemp.formatNumberAsYouType",((d,t)=>{try{const e=d.replace(/[^+0-9]/g,""),$=new Pd(t);t="";for(let d=0;d<e.length;d++)$.ja=Fd($,e.charAt(d)),t=$.ja;return t}catch{return d}})),t("intlTelInputUtilsTemp.formatNumber",((d,t,e)=>{try{const n=K.g(),i=Ed(n,d,t);var $=Ld(n,i,-1);return 0==$||4==$?n.format(i,void 0===e?0:e):d}catch{return d}})),t("intlTelInputUtilsTemp.getExampleNumber",((d,t,e,$)=>{try{const o=K.g();d:{var n=o;if(cd(d)){var i=md(bd(n,d),e);try{if(C(i,6)){var r=Dd(n,y(i,6),d,!1);break d}}catch(d){}}r=null}return o.format(r,$?0:t?2:1)}catch{return""}})),t("intlTelInputUtilsTemp.getExtension",((d,t)=>{try{return y(Ed(K.g(),d,t),3)}catch{return""}})),t("intlTelInputUtilsTemp.getNumberType",((d,t)=>{try{const e=K.g();return yd(e,Ed(e,d,t))}catch{return-99}})),t("intlTelInputUtilsTemp.getValidationError",((d,t)=>{if(!t)return 1;try{const e=K.g();return Ld(e,Ed(e,d,t),-1)}catch(t){return"Invalid country calling code"===t.message?1:3>=d.length||"Phone number too short after IDD"===t.message||"The string supplied is too short to be a phone number"===t.message?2:"The string supplied is too long to be a phone number"===t.message?3:-99}})),t("intlTelInputUtilsTemp.isValidNumber",((d,t,e)=>{try{const $=K.g(),n=Ed($,d,t),i=function(d,t){var e=Id(d,t),$=f(t,1),n=pd(d,$,e);return n=null!=n&&("001"==e||$==wd(d,e))&&-1!=fd(d=gd(t),n)}($,n);if(e){const d=e.map((d=>Jd[d]));return i&&d.includes(yd($,n))}return i}catch{return!1}})),t("intlTelInputUtilsTemp.isPossibleNumber",((d,t,e)=>{try{const $=K.g(),n=Ed($,d,t);if(e){e.includes("FIXED_LINE_OR_MOBILE")&&(e.includes("MOBILE")||e.push("MOBILE"),e.includes("FIXED_LINE")||e.push("FIXED_LINE"));for(let d of e)if(0===Ld($,n,Jd[d]))return!0;return!1}return 0===Ld($,n,-1)}catch{return!1}})),t("intlTelInputUtilsTemp.getCoreNumber",((d,t)=>{try{return y(Ed(K.g(),d,t),2).toString()}catch{return""}})),t("intlTelInputUtilsTemp.numberFormat",{E164:0,INTERNATIONAL:1,NATIONAL:2,RFC3966:3}),t("intlTelInputUtilsTemp.numberType",Jd),t("intlTelInputUtilsTemp.validationError",{IS_POSSIBLE:0,INVALID_COUNTRY_CODE:1,TOO_SHORT:2,TOO_LONG:3,IS_POSSIBLE_LOCAL_ONLY:4,INVALID_LENGTH:5})}();var b=window.intlTelInputUtilsTemp;delete window.intlTelInputUtilsTemp;var _=b;f.utils=_;var I,v=f;return I=n,((n,i,r,o)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let s of e(i))$.call(n,s)||s===r||d(n,s,{get:()=>i[s],enumerable:!(o=t(i,s))||o.enumerable});return n})(d({},"__esModule",{value:!0}),I)})();return d.default},d.exports?d.exports=t():window.intlTelInput=t()}},t={};function e($){var n=t[$];if(void 0!==n)return n.exports;var i=t[$]={exports:{}};return d[$](i,i.exports,e),i.exports}e.n=function(d){var t=d&&d.__esModule?function(){return d.default}:function(){return d};return e.d(t,{a:t}),t},e.d=function(d,t){for(var $ in t)e.o(t,$)&&!e.o(d,$)&&Object.defineProperty(d,$,{enumerable:!0,get:t[$]})},e.o=function(d,t){return Object.prototype.hasOwnProperty.call(d,t)},function(){"use strict";var d=e(1446),t=e.n(d);window.FormiePhoneCountry=class{constructor(){let d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$form=d.$form,this.form=this.$form.form,this.$field=d.$field.querySelector('input[type="tel"]'),this.$countryInput=d.$field.querySelector("[data-country]"),this.countryDefaultValue=d.countryDefaultValue,this.countryAllowed=d.countryAllowed,this.language=d.language,this.$field&&this.$countryInput?this.initValidator():console.error('Unable to find country field “input[type="tel"]” or “[data-country]”')}initValidator(){const d={allowDropdown:!0,autoHideDialCode:!0,autoInsertDialCode:!0,nationalMode:!1,preferredCountries:[],separateDialCode:!0,showSelectedDialCode:!0,initialCountry:"auto",autoPlaceholder:"off",formatOnDisplay:!1,formatAsYouType:!1,validationNumberTypes:null};this.countryAllowed&&this.countryAllowed.length&&(d.onlyCountries=this.countryAllowed.map((d=>d.value.toLowerCase())),[d.initialCountry]=d.onlyCountries,1===d.onlyCountries.length&&(d.allowDropdown=!1,d.separateDialCode=!1,d.nationalMode=!0),this.$field.restrictedCountries=!0),this.countryDefaultValue&&(d.initialCountry=this.countryDefaultValue),d.onlyCountries&&d.onlyCountries.length&&d.initialCountry&&(d.onlyCountries.includes(d.initialCountry)||d.onlyCountries.push(d.initialCountry.toLowerCase())),this.$field.validator&&this.$field.validator.destroy(),this.validator=t()(this.$field,d),this.$field.validator=this.validator,this.$field.$countryInput=this.$countryInput,this.$field.$countryInput&&this.$field.$countryInput.value&&this.validator.setCountry(this.$field.$countryInput.value),this.$field.dispatchEvent(new CustomEvent("init",{bubbles:!0,detail:{phoneCountry:this,validator:this.validator,validatorOptions:d}})),this.form.addEventListener(this.$field,function(d){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t||(t=Math.random().toString(36).substr(2,5)),`${d}.${t}`}("countrychange"),this.countryChange.bind(this)),this.form.registerEvent("registerFormieValidation",this.registerValidation.bind(this)),this.$field.dispatchEvent(new Event("countrychange",{bubbles:!0})),this.form.formTheme&&this.form.formTheme.updateFormHash()}countryChange(d){const t=this.validator.getSelectedCountryData().iso2;this.$countryInput&&t&&(this.$countryInput.value=t.toUpperCase())}registerValidation(d){d.validator.addValidator("phoneCountry",(d=>{let{input:t}=d;if("tel"!==t.getAttribute("type"))return!0;if(t.value.trim()&&t.validator){if(!t.validator.isValidNumber())return!1;{const d=t.validator.getSelectedCountryData().iso2;if(t.restrictedCountries&&!t.validator.options.onlyCountries.includes(d))return!1;t.$countryInput&&d&&(t.$countryInput.value=d.toUpperCase())}}return!0}),(d=>{let{input:t}=d;return function(d){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return window.FormieTranslations&&(d=window.FormieTranslations[d]||d),d.replace(/{([a-zA-Z0-9]+)}/g,((d,e)=>t[e]?t[e]:d))}(["Invalid number","Invalid country code","Too short","Too long"][t.validator?t.validator.getValidationError():""]||"Invalid number")}))}}}()}();


# ====================================================================
# FILE: src/web/assets/frontend/dist/js/payments/payway.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-1 ---
     1| !function(){"use strict";const e=function(e,t){e&&t&&("string"==typeof t&&(t=t.split(" ")),t.forEach((t=>{e.classList.add(t)})))},t=function(e,t){e&&t&&("string"==typeof t&&(t=t.split(" ")),t.forEach((t=>{e.classList.remove(t)})))},i=function(e,t){let i=e.querySelectorAll(`[name="${t}"]`);const s=e.querySelectorAll(`[name="${t}[]"]`);return s.length&&(i=s),i},s=function(e){return`fields[${e=e.replace("{field:","").replace("{","").replace("}","").replace("]","").split("[").join("][")}]`};class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.initialized=!1,this.$form=e.$form,this.form=this.$form.form,this.$field=e.$field,this.successClass=this.form.getClasses("success"),this.successMessageClass=this.form.getClasses("successMessage"),this.errorClass=this.form.getClasses("error"),this.errorMessageClass=this.form.getClasses("errorMessage"),this.isVisible=!1;const t=new IntersectionObserver((e=>{0==e[0].intersectionRatio?(this.isVisible=!1,this.initialized&&this.onHide()):(this.isVisible=!0,this.initialized&&this.onShow())}),{root:this.$form,rootMargin:"50px"});setTimeout((()=>{t.observe(this.$field)}),500)}eventKey(e,t){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t||(t=Math.random().toString(36).substr(2,5)),`${e}.${t}`}(e,`${t}-${this.$field.getAttribute("data-field-handle")}`)}removeSuccess(){t(this.$field,this.successClass);const e=this.$field.querySelector("[data-payment-success]");e&&e.remove()}addSuccess(t){e(this.$field,this.successClass);const i=this.$field.querySelector("[data-field-type] > div");if(!i)return console.error("Unable to find `[data-field-type] > div` to add success message.");const s=document.createElement("div");s.textContent=t,s.setAttribute("data-payment-success",""),e(s,this.successMessageClass),i.appendChild(s)}removeError(){t(this.$field,this.errorClass);const e=this.$field.querySelector("[data-payment-error]");e&&e.remove()}addError(t){e(this.$field,this.errorClass);const i=this.$field.querySelector("[data-field-type] > div");if(!i)return console.error("Unable to find `[data-field-type] > div` to add error message.");const s=document.createElement("div");s.textContent=t,s.setAttribute("data-payment-error",""),e(s,this.errorMessageClass),i.appendChild(s),this.submitHandler&&this.submitHandler.formSubmitError()}updateInputs(e,t){const i=this.$field.querySelector(`[name*="${e}"]`);i&&(i.value=t)}getBillingData(){if(!this.billingDetails)return{};const e={};if(this.billingDetails.billingName){const t=this.getFieldValue(this.billingDetails.billingName);t&&(e.name=t)}if(this.billingDetails.billingEmail){const t=this.getFieldValue(this.billingDetails.billingEmail);t&&(e.email=t)}if(this.billingDetails.billingAddress){e.address={};const t=this.getFieldValue(`${this.billingDetails.billingAddress}[address1]`),i=this.getFieldValue(`${this.billingDetails.billingAddress}[address2]`),s=this.getFieldValue(`${this.billingDetails.billingAddress}[address3]`),r=this.getFieldValue(`${this.billingDetails.billingAddress}[city]`),a=this.getFieldValue(`${this.billingDetails.billingAddress}[zip]`),l=this.getFieldValue(`${this.billingDetails.billingAddress}[state]`),n=this.getFieldValue(`${this.billingDetails.billingAddress}[country]`);t&&(e.address.line1=t),i&&(e.address.line2=i),s&&(e.address.line3=s),r&&(e.address.city=r),a&&(e.address.postal_code=a),l&&(e.address.state=l),n&&(e.address.country=n)}new CustomEvent("modifyBillingDetails",{bubbles:!0,detail:{provider:this,billing:e}});return{billing_details:e}}getFieldValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string";const r=function(e,t){let r="";t=s(t);const a=i(e,t);return a&&a.forEach((e=>"checkbox"!==e.type&&"radio"!==e.type||e.checked?r=e.value:void 0)),r}(this.$form,e);return"float"===t||"int"===t||"number"===t?function(e){let t=e.replace(/[^\d.,-]/g,"");const i=t.includes(","),s=t.includes(".");return t=i&&s?t.replace(/\./g,"").replace(/,/,"."):i&&!s?t.replace(/,/,"."):t.replace(/,/g,""),parseFloat(t)}(r):r}getFieldLabel(e){return function(e,t){let r="";t=s(t);const a=i(e,t);return a&&a.forEach((e=>{const t=e.closest("[data-field-type]");if(t){const e=t.querySelector("[data-field-label]");e&&(r=e.childNodes[0].textContent?.trim()??"")}})),r}(this.$form,e)}onShow(){}onHide(){}processResubmit(){this.form.config.Formie.refreshFormTokens(this.form),this.submitHandler.processSubmit(["payment"])}}window.FormiePaymentProvider=r;window.FormiePayWay=class extends r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.$form=e.$form,this.form=this.$form.form,this.$field=e.$field,this.$input=this.$field.querySelector("[data-fui-payway-button]"),this.$input?(this.publishableKey=e.publishableKey,this.currency=e.currency,this.amountType=e.amountType,this.amountFixed=e.amountFixed,this.amountVariable=e.amountVariable,this.paywayScriptId="FORMIE_PAYWAY_SCRIPT",this.publishableKey?this.initialized=!0:console.error("Missing publishableKey for PayWay.")):console.error("Unable to find PayWay placeholder for [data-fui-payway-button]")}onShow(){this.initField()}onHide(){this.onAfterSubmit(),this.form.removeEventListener(this.eventKey("onFormiePaymentValidate","payway")),this.form.removeEventListener(this.eventKey("onAfterFormieSubmit","payway"))}initField(){if(document.getElementById(this.paywayScriptId))(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;const i=Date.now(),s=function(r,a){window[e]?r(window[e]):t&&Date.now()-i>=t?a(new Error("timeout")):setTimeout(s.bind(this,r,a),30)};return new Promise(s)})("payway").then((()=>{this.mountCard()}));else{const e=document.createElement("script");e.id=this.paywayScriptId,e.src="https://api.payway.com.au/rest/v1/payway.js",e.async=!0,e.defer=!0,e.onload=()=>{this.mountCard()},document.body.appendChild(e)}this.form.addEventListener(this.$form,this.eventKey("onFormiePaymentValidate","payway"),this.onValidate.bind(this)),this.form.addEventListener(this.$form,this.eventKey("onAfterFormieSubmit","payway"),this.onAfterSubmit.bind(this))}mountCard(){this.form.destroyed||payway.createCreditCardFrame({layout:"wide",publishableApiKey:this.publishableKey,tokenMode:"callback"},((e,t)=>{e?console.error(`Error creating frame: ${e.message}`):this.creditCardFrame=t}))}onValidate(e){"submit"!==this.form.submitAction||e.detail.invalid||(e.preventDefault(),this.submitHandler=e.detail.submitHandler,this.removeError(),this.creditCardFrame?this.creditCardFrame.getToken(((e,t)=>{e?(console.error(`Error getting token: ${e.message}`),this.addError(e.message)):(this.updateInputs("paywayTokenId",t.singleUseTokenId),this.submitHandler.submitForm())})):console.error("Credit Card Frame is invalid."))}onAfterSubmit(e){this.creditCardFrame&&(this.creditCardFrame.destroy(),this.creditCardFrame=null),this.updateInputs("paywayTokenId","")}}}();


# ====================================================================
# FILE: src/web/assets/frontend/dist/js/payments/stripe.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-1 ---
     1| !function(){"use strict";const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return window.FormieTranslations&&(e=window.FormieTranslations[e]||e),e.replace(/{([a-zA-Z0-9]+)}/g,((e,i)=>t[i]?t[i]:e))},t=function(e,t){e&&t&&("string"==typeof t&&(t=t.split(" ")),t.forEach((t=>{e.classList.add(t)})))},i=function(e,t){e&&t&&("string"==typeof t&&(t=t.split(" ")),t.forEach((t=>{e.classList.remove(t)})))},s=function(e,t){let i=e.querySelectorAll(`[name="${t}"]`);const s=e.querySelectorAll(`[name="${t}[]"]`);return s.length&&(i=s),i},r=function(e){return`fields[${e=e.replace("{field:","").replace("{","").replace("}","").replace("]","").split("[").join("][")}]`};class n{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.initialized=!1,this.$form=e.$form,this.form=this.$form.form,this.$field=e.$field,this.successClass=this.form.getClasses("success"),this.successMessageClass=this.form.getClasses("successMessage"),this.errorClass=this.form.getClasses("error"),this.errorMessageClass=this.form.getClasses("errorMessage"),this.isVisible=!1;const t=new IntersectionObserver((e=>{0==e[0].intersectionRatio?(this.isVisible=!1,this.initialized&&this.onHide()):(this.isVisible=!0,this.initialized&&this.onShow())}),{root:this.$form,rootMargin:"50px"});setTimeout((()=>{t.observe(this.$field)}),500)}eventKey(e,t){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t||(t=Math.random().toString(36).substr(2,5)),`${e}.${t}`}(e,`${t}-${this.$field.getAttribute("data-field-handle")}`)}removeSuccess(){i(this.$field,this.successClass);const e=this.$field.querySelector("[data-payment-success]");e&&e.remove()}addSuccess(e){t(this.$field,this.successClass);const i=this.$field.querySelector("[data-field-type] > div");if(!i)return console.error("Unable to find `[data-field-type] > div` to add success message.");const s=document.createElement("div");s.textContent=e,s.setAttribute("data-payment-success",""),t(s,this.successMessageClass),i.appendChild(s)}removeError(){i(this.$field,this.errorClass);const e=this.$field.querySelector("[data-payment-error]");e&&e.remove()}addError(e){t(this.$field,this.errorClass);const i=this.$field.querySelector("[data-field-type] > div");if(!i)return console.error("Unable to find `[data-field-type] > div` to add error message.");const s=document.createElement("div");s.textContent=e,s.setAttribute("data-payment-error",""),t(s,this.errorMessageClass),i.appendChild(s),this.submitHandler&&this.submitHandler.formSubmitError()}updateInputs(e,t){const i=this.$field.querySelector(`[name*="${e}"]`);i&&(i.value=t)}getBillingData(){if(!this.billingDetails)return{};const e={};if(this.billingDetails.billingName){const t=this.getFieldValue(this.billingDetails.billingName);t&&(e.name=t)}if(this.billingDetails.billingEmail){const t=this.getFieldValue(this.billingDetails.billingEmail);t&&(e.email=t)}if(this.billingDetails.billingAddress){e.address={};const t=this.getFieldValue(`${this.billingDetails.billingAddress}[address1]`),i=this.getFieldValue(`${this.billingDetails.billingAddress}[address2]`),s=this.getFieldValue(`${this.billingDetails.billingAddress}[address3]`),r=this.getFieldValue(`${this.billingDetails.billingAddress}[city]`),n=this.getFieldValue(`${this.billingDetails.billingAddress}[zip]`),o=this.getFieldValue(`${this.billingDetails.billingAddress}[state]`),l=this.getFieldValue(`${this.billingDetails.billingAddress}[country]`);t&&(e.address.line1=t),i&&(e.address.line2=i),s&&(e.address.line3=s),r&&(e.address.city=r),n&&(e.address.postal_code=n),o&&(e.address.state=o),l&&(e.address.country=l)}new CustomEvent("modifyBillingDetails",{bubbles:!0,detail:{provider:this,billing:e}});return{billing_details:e}}getFieldValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string";const i=function(e,t){let i="";t=r(t);const n=s(e,t);return n&&n.forEach((e=>"checkbox"!==e.type&&"radio"!==e.type||e.checked?i=e.value:void 0)),i}(this.$form,e);return"float"===t||"int"===t||"number"===t?function(e){let t=e.replace(/[^\d.,-]/g,"");const i=t.includes(","),s=t.includes(".");return t=i&&s?t.replace(/\./g,"").replace(/,/,"."):i&&!s?t.replace(/,/,"."):t.replace(/,/g,""),parseFloat(t)}(i):i}getFieldLabel(e){return function(e,t){let i="";t=r(t);const n=s(e,t);return n&&n.forEach((e=>{const t=e.closest("[data-field-type]");if(t){const e=t.querySelector("[data-field-label]");e&&(i=e.childNodes[0].textContent?.trim()??"")}})),i}(this.$form,e)}onShow(){}onHide(){}processResubmit(){this.form.config.Formie.refreshFormTokens(this.form),this.submitHandler.processSubmit(["payment"])}}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}window.FormiePaymentProvider=n;window.FormieStripe=class extends n{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.$form=e.$form,this.form=this.$form.form,this.$field=e.$field,this.$input=this.$field.querySelector("[data-fui-stripe-elements]"),this.$placeholder=this.$field.querySelector("[data-fui-stripe-elements-placeholder]"),this.$input?(this.boundEvents=!1,this.publishableKey=e.publishableKey,this.paymentType=e.paymentType,this.billingDetails=e.billingDetails||{},this.hidePostalCode=e.hidePostalCode||!1,this.hideIcon=e.hideIcon||!1,this.initialPaymentInformation=e.initialPaymentInformation||{},this.paymentInformation=function(e){if(void 0!==e)return JSON.parse(JSON.stringify(e))}(this.initialPaymentInformation),this.stripeScriptId="FORMIE_STRIPE_SCRIPT",this.publishableKey?this.initialized=!0:console.error("Missing publishable key for Stripe.")):console.error("Unable to find Stripe Elements placeholder for [data-fui-stripe-elements]")}onShow(){this.loadStripe()}onHide(){this.paymentElement&&(this.paymentElement.destroy(),this.paymentElement=null,this.stripe=null,this.boundEvents=!1,this.form.removeEventListener(this.eventKey("onFormiePaymentValidate","stripe")),this.form.removeEventListener(this.eventKey("onAfterFormieSubmit","stripe")),this.form.removeEventListener(this.eventKey("FormiePaymentStripeConfirm","stripe")))}loadStripe(){try{if(document.getElementById(this.stripeScriptId))(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;const i=Date.now(),s=function(r,n){window[e]?r(window[e]):t&&Date.now()-i>=t?n(new Error("timeout")):setTimeout(s.bind(this,r,n),30)};return new Promise(s)})("Stripe").then((()=>{this.initStripe()}));else{const e=document.createElement("script");e.id=this.stripeScriptId,e.src="https://js.stripe.com/v3",e.async=!0,e.defer=!0,e.onload=()=>{this.initStripe()},document.body.appendChild(e)}this.boundEvents||(this.form.addEventListener(this.$form,this.eventKey("onFormiePaymentValidate","stripe"),this.onValidate.bind(this)),this.form.addEventListener(this.$form,this.eventKey("onAfterFormieSubmit","stripe"),this.onAfterSubmit.bind(this)),this.form.addEventListener(this.$form,this.eventKey("FormiePaymentStripeConfirm","stripe"),this.onValidateConfirm.bind(this)),this.boundEvents=!0)}catch(e){console.error(e),this.showPlaceholder(e,"error")}}initStripe(){if(!this.form.destroyed)try{this.stripe=Stripe(this.publishableKey),this.handleDynamicValues()&&this.renderStripe()}catch(e){console.error(e),this.showPlaceholder(e,"error")}}renderStripe(){try{const t=this.isSubscription()?"subscription":"payment",i={},s=l(l({},this.paymentInformation),{},{capture_method:"automatic",mode:t,appearance:{}}),r=new CustomEvent("beforeInit",{bubbles:!0,detail:{stripe:this,elementOptions:s,paymentOptions:i}});if(this.$field.dispatchEvent(r),!s.amount)return void this.showPlaceholder(e("Invalid amount."),"error");if(!s.currency)return void this.showPlaceholder(e("Invalid currency."),"error");this.elements=this.stripe.elements(s),this.paymentElement=this.elements.create("payment",i),this.paymentElement.mount(this.$input),this.hidePlaceholder()}catch(e){console.error(e),this.showPlaceholder(e,"error")}}onValidate(e){"submit"!==this.form.submitAction||e.detail.invalid||this.elements&&(e.preventDefault(),this.submitHandler=e.detail.submitHandler,this.removeError(),this.elements.submit().then((e=>{if(e.error)return this.addError(e.error.message);this.submitHandler.submitForm()})))}showPlaceholder(e,t){this.$placeholder.innerHTML=e,this.$placeholder.classList.remove("fui-hidden"),"error"===t&&this.$placeholder.classList.add("fui-error-message")}hidePlaceholder(){this.$placeholder.classList.add("fui-hidden")}onValidateConfirm(e){const{data:t}=e.detail;this.addLoading();const i=new URL(t.returnUrl);i.searchParams.append("origin",window.location.href),this.form.formTheme&&this.form.formTheme.updateFormHash();("setup"===t.type?this.stripe.confirmSetup:this.stripe.confirmPayment)({elements:this.elements,clientSecret:t.clientSecret,redirect:"if_required",confirmParams:{return_url:i.toString()}}).then((e=>{if(this.removeError(),e.error)return this.removeLoading(),this.addError(e.error.message);this.updateInputs("stripeSubscriptionId",t.subscriptionId),this.updateInputs("stripePaymentIntentId",e.paymentIntent.id),this.processResubmit()}))}hasDynamicValue(e){return(this.initialPaymentInformation[e]??null).toString().includes("{field:")??!1}hasDynamicValues(){return this.hasDynamicValue("amount")||this.hasDynamicValue("currency")}checkDynamicValues(){const t=this.initialPaymentInformation?.amount??null,i=this.initialPaymentInformation?.currency??null,s=this.getFieldValue(t,"number"),r=this.getFieldValue(i),n=this.getFieldLabel(t),o=this.getFieldLabel(i);if(this.hasDynamicValue("amount")){if(!s)return this.showPlaceholder(e("Provide a value for “{label}” to proceed.",{label:n}),"error"),!1;this.paymentInformation.amount=100*s}if(this.hasDynamicValue("currency")){if(!r)return this.showPlaceholder(e("Provide a value for “{label}” to proceed.",{label:o}),"error"),!1;this.paymentInformation.currency=r.toLowerCase()}return!0}handleDynamicValues(){return!this.hasDynamicValues()||(this.$form.addEventListener("input",function(e,t){let i;return function(){for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];clearTimeout(i),i=setTimeout((()=>{e.apply(this,r)}),t)}}((e=>{const t=e.target.name,i=this.initialPaymentInformation?.amount??null,s=this.initialPaymentInformation?.currency??null;t!==r(i)&&t!==r(s)||this.checkDynamicValues()&&(this.hidePlaceholder(),this.elements?this.elements.update(this.paymentInformation):this.renderStripe())}),600)),this.checkDynamicValues())}isSubscription(){return"subscription"===this.paymentType}addLoading(){this.form.formTheme&&this.form.formTheme.addLoading()}removeLoading(){this.form.formTheme&&this.form.formTheme.removeLoading()}onAfterSubmit(e){this.paymentElement&&this.paymentElement.clear(),this.updateInputs("stripePaymentIntentId",""),this.updateInputs("stripeSubscriptionId","")}}}();


# ====================================================================
# FILE: src/web/assets/frontend/src/js/fields/phone-country.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-115 ---
     1| import { t, eventKey } from '../utils/utils';
     2| import intlTelInput from 'intl-tel-input/intlTelInputWithUtils';
     3| export class FormiePhoneCountry {
     4|     constructor(settings = {}) {
     5|         this.$form = settings.$form;
     6|         this.form = this.$form.form;
     7|         this.$field = settings.$field.querySelector('input[type="tel"]');
     8|         this.$countryInput = settings.$field.querySelector('[data-country]');
     9|         this.countryDefaultValue = settings.countryDefaultValue;
    10|         this.countryAllowed = settings.countryAllowed;
    11|         this.language = settings.language;
    12|         if (this.$field && this.$countryInput) {
    13|             this.initValidator();
    14|         } else {
    15|             console.error('Unable to find country field “input[type="tel"]” or “[data-country]”');
    16|         }
    17|     }
    18|     initValidator() {
    19|         const options = {
    20|             allowDropdown: true,
    21|             autoHideDialCode: true,
    22|             autoInsertDialCode: true,
    23|             nationalMode: false,
    24|             preferredCountries: [],
    25|             separateDialCode: true,
    26|             showSelectedDialCode: true,
    27|             initialCountry: 'auto',
    28|             autoPlaceholder: 'off',
    29|             formatOnDisplay: false,
    30|             formatAsYouType: false,
    31|             validationNumberTypes: null,
    32|         };
    33|         if (this.countryAllowed && this.countryAllowed.length) {
    34|             options.onlyCountries = this.countryAllowed.map((item) => {
    35|                 return item.value.toLowerCase();
    36|             });
    37|             [options.initialCountry] = options.onlyCountries;
    38|             if (options.onlyCountries.length === 1) {
    39|                 options.allowDropdown = false;
    40|                 options.separateDialCode = false;
    41|                 options.nationalMode = true;
    42|             }
    43|             this.$field.restrictedCountries = true;
    44|         }
    45|         if (this.countryDefaultValue) {
    46|             options.initialCountry = this.countryDefaultValue;
    47|         }
    48|         if (options.onlyCountries && options.onlyCountries.length && options.initialCountry) {
    49|             if (!options.onlyCountries.includes(options.initialCountry)) {
    50|                 options.onlyCountries.push(options.initialCountry.toLowerCase());
    51|             }
    52|         }
    53|         if (this.$field.validator) {
    54|             this.$field.validator.destroy();
    55|         }
    56|         this.validator = intlTelInput(this.$field, options);
    57|         this.$field.validator = this.validator;
    58|         this.$field.$countryInput = this.$countryInput;
    59|         if (this.$field.$countryInput && this.$field.$countryInput.value) {
    60|             this.validator.setCountry(this.$field.$countryInput.value);
    61|         }
    62|         this.$field.dispatchEvent(new CustomEvent('init', {
    63|             bubbles: true,
    64|             detail: {
    65|                 phoneCountry: this,
    66|                 validator: this.validator,
    67|                 validatorOptions: options,
    68|             },
    69|         }));
    70|         this.form.addEventListener(this.$field, eventKey('countrychange'), this.countryChange.bind(this));
    71|         this.form.registerEvent('registerFormieValidation', this.registerValidation.bind(this));
    72|         this.$field.dispatchEvent(new Event('countrychange', { bubbles: true }));
    73|         if (this.form.formTheme) {
    74|             this.form.formTheme.updateFormHash();
    75|         }
    76|     }
    77|     countryChange(e) {
    78|         const countryData = this.validator.getSelectedCountryData();
    79|         const selectedCountryCode = countryData.iso2;
    80|         if (this.$countryInput && selectedCountryCode) {
    81|             this.$countryInput.value = selectedCountryCode.toUpperCase();
    82|         }
    83|     }
    84|     registerValidation(e) {
    85|         e.validator.addValidator('phoneCountry', ({ input }) => {
    86|             const type = input.getAttribute('type');
    87|             if (type !== 'tel') {
    88|                 return true;
    89|             }
    90|             if (input.value.trim() && input.validator) {
    91|                 if (input.validator.isValidNumber()) {
    92|                     const countryData = input.validator.getSelectedCountryData();
    93|                     const selectedCountryCode = countryData.iso2;
    94|                     if (input.restrictedCountries) {
    95|                         if (!input.validator.options.onlyCountries.includes(selectedCountryCode)) {
    96|                             return false;
    97|                         }
    98|                     }
    99|                     if (input.$countryInput && selectedCountryCode) {
   100|                         input.$countryInput.value = selectedCountryCode.toUpperCase();
   101|                     }
   102|                 } else {
   103|                     return false;
   104|                 }
   105|             }
   106|             return true;
   107|         }, ({ input }) => {
   108|             const errorMap = ['Invalid number', 'Invalid country code', 'Too short', 'Too long'];
   109|             const errorCode = input.validator ? input.validator.getValidationError() : '';
   110|             const errorMessage = errorMap[errorCode] || 'Invalid number';
   111|             return t(errorMessage);
   112|         });
   113|     }
   114| }
   115| window.FormiePhoneCountry = FormiePhoneCountry;


# ====================================================================
# FILE: src/web/assets/frontend/src/js/payments/payway.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-98 ---
     1| import { t, ensureVariable } from '../utils/utils';
     2| import { FormiePaymentProvider } from './payment-provider';
     3| export class FormiePayWay extends FormiePaymentProvider {
     4|     constructor(settings = {}) {
     5|         super(settings);
     6|         this.$form = settings.$form;
     7|         this.form = this.$form.form;
     8|         this.$field = settings.$field;
     9|         this.$input = this.$field.querySelector('[data-fui-payway-button]');
    10|         if (!this.$input) {
    11|             console.error('Unable to find PayWay placeholder for [data-fui-payway-button]');
    12|             return;
    13|         }
    14|         this.publishableKey = settings.publishableKey;
    15|         this.currency = settings.currency;
    16|         this.amountType = settings.amountType;
    17|         this.amountFixed = settings.amountFixed;
    18|         this.amountVariable = settings.amountVariable;
    19|         this.paywayScriptId = 'FORMIE_PAYWAY_SCRIPT';
    20|         if (!this.publishableKey) {
    21|             console.error('Missing publishableKey for PayWay.');
    22|             return;
    23|         }
    24|         this.initialized = true;
    25|     }
    26|     onShow() {
    27|         this.initField();
    28|     }
    29|     onHide() {
    30|         this.onAfterSubmit();
    31|         this.form.removeEventListener(this.eventKey('onFormiePaymentValidate', 'payway'));
    32|         this.form.removeEventListener(this.eventKey('onAfterFormieSubmit', 'payway'));
    33|     }
    34|     initField() {
    35|         if (!document.getElementById(this.paywayScriptId)) {
    36|             const $script = document.createElement('script');
    37|             $script.id = this.paywayScriptId;
    38|             $script.src = 'https://api.payway.com.au/rest/v1/payway.js';
    39|             $script.async = true;
    40|             $script.defer = true;
    41|             $script.onload = () => {
    42|                 this.mountCard();
    43|             };
    44|             document.body.appendChild($script);
    45|         } else {
    46|             ensureVariable('payway').then(() => {
    47|                 this.mountCard();
    48|             });
    49|         }
    50|         this.form.addEventListener(this.$form, this.eventKey('onFormiePaymentValidate', 'payway'), this.onValidate.bind(this));
    51|         this.form.addEventListener(this.$form, this.eventKey('onAfterFormieSubmit', 'payway'), this.onAfterSubmit.bind(this));
    52|     }
    53|     mountCard() {
    54|         if (this.form.destroyed) {
    55|             return;
    56|         }
    57|         payway.createCreditCardFrame({
    58|             layout: 'wide',
    59|             publishableApiKey: this.publishableKey,
    60|             tokenMode: 'callback',
    61|         }, (err, frame) => {
    62|             if (err) {
    63|                 console.error(`Error creating frame: ${err.message}`);
    64|             } else {
    65|                 this.creditCardFrame = frame;
    66|             }
    67|         });
    68|     }
    69|     onValidate(e) {
    70|         if (this.form.submitAction !== 'submit' || e.detail.invalid) {
    71|             return;
    72|         }
    73|         e.preventDefault();
    74|         this.submitHandler = e.detail.submitHandler;
    75|         this.removeError();
    76|         if (this.creditCardFrame) {
    77|             this.creditCardFrame.getToken((err, data) => {
    78|                 if (err) {
    79|                     console.error(`Error getting token: ${err.message}`);
    80|                     this.addError(err.message);
    81|                 } else {
    82|                     this.updateInputs('paywayTokenId', data.singleUseTokenId);
    83|                     this.submitHandler.submitForm();
    84|                 }
    85|             });
    86|         } else {
    87|             console.error('Credit Card Frame is invalid.');
    88|         }
    89|     }
    90|     onAfterSubmit(e) {
    91|         if (this.creditCardFrame) {
    92|             this.creditCardFrame.destroy();
    93|             this.creditCardFrame = null;
    94|         }
    95|         this.updateInputs('paywayTokenId', '');
    96|     }
    97| }
    98| window.FormiePayWay = FormiePayWay;


# ====================================================================
# FILE: src/web/assets/frontend/src/js/payments/stripe.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-249 ---
     1| import { t, clone, ensureVariable, debounce } from '../utils/utils';
     2| import { getFieldName } from '../utils/fields';
     3| import { FormiePaymentProvider } from './payment-provider';
     4| export class FormieStripe extends FormiePaymentProvider {
     5|     constructor(settings = {}) {
     6|         super(settings);
     7|         this.$form = settings.$form;
     8|         this.form = this.$form.form;
     9|         this.$field = settings.$field;
    10|         this.$input = this.$field.querySelector('[data-fui-stripe-elements]');
    11|         this.$placeholder = this.$field.querySelector('[data-fui-stripe-elements-placeholder]');
    12|         if (!this.$input) {
    13|             console.error('Unable to find Stripe Elements placeholder for [data-fui-stripe-elements]');
    14|             return;
    15|         }
    16|         this.boundEvents = false;
    17|         this.publishableKey = settings.publishableKey;
    18|         this.paymentType = settings.paymentType;
    19|         this.billingDetails = settings.billingDetails || {};
    20|         this.hidePostalCode = settings.hidePostalCode || false;
    21|         this.hideIcon = settings.hideIcon || false;
    22|         this.initialPaymentInformation = settings.initialPaymentInformation || {};
    23|         this.paymentInformation = clone(this.initialPaymentInformation);
    24|         this.stripeScriptId = 'FORMIE_STRIPE_SCRIPT';
    25|         if (!this.publishableKey) {
    26|             console.error('Missing publishable key for Stripe.');
    27|             return;
    28|         }
    29|         this.initialized = true;
    30|     }
    31|     onShow() {
    32|         this.loadStripe();
    33|     }
    34|     onHide() {
    35|         if (this.paymentElement) {
    36|             this.paymentElement.destroy();
    37|             this.paymentElement = null;
    38|             this.stripe = null;
    39|             this.boundEvents = false;
    40|             this.form.removeEventListener(this.eventKey('onFormiePaymentValidate', 'stripe'));
    41|             this.form.removeEventListener(this.eventKey('onAfterFormieSubmit', 'stripe'));
    42|             this.form.removeEventListener(this.eventKey('FormiePaymentStripeConfirm', 'stripe'));
    43|         }
    44|     }
    45|     loadStripe() {
    46|         try {
    47|             if (!document.getElementById(this.stripeScriptId)) {
    48|                 const $script = document.createElement('script');
    49|                 $script.id = this.stripeScriptId;
    50|                 $script.src = 'https://js.stripe.com/v3';
    51|                 $script.async = true;
    52|                 $script.defer = true;
    53|                 $script.onload = () => {
    54|                     this.initStripe();
    55|                 };
    56|                 document.body.appendChild($script);
    57|             } else {
    58|                 ensureVariable('Stripe').then(() => {
    59|                     this.initStripe();
    60|                 });
    61|             }
    62|             if (!this.boundEvents) {
    63|                 this.form.addEventListener(this.$form, this.eventKey('onFormiePaymentValidate', 'stripe'), this.onValidate.bind(this));
    64|                 this.form.addEventListener(this.$form, this.eventKey('onAfterFormieSubmit', 'stripe'), this.onAfterSubmit.bind(this));
    65|                 this.form.addEventListener(this.$form, this.eventKey('FormiePaymentStripeConfirm', 'stripe'), this.onValidateConfirm.bind(this));
    66|                 this.boundEvents = true;
    67|             }
    68|         } catch (error) {
    69|             console.error(error);
    70|             this.showPlaceholder(error, 'error');
    71|         }
    72|     }
    73|     initStripe() {
    74|         if (this.form.destroyed) {
    75|             return;
    76|         }
    77|         try {
    78|             this.stripe = Stripe(this.publishableKey);
    79|             if (this.handleDynamicValues()) {
    80|                 this.renderStripe();
    81|             }
    82|         } catch (error) {
    83|             console.error(error);
    84|             this.showPlaceholder(error, 'error');
    85|         }
    86|     }
    87|     renderStripe() {
    88|         try {
    89|             const mode = this.isSubscription() ? 'subscription' : 'payment';
    90|             const paymentOptions = {};
    91|             const elementOptions = {
    92|                 ...this.paymentInformation,
    93|                 capture_method: 'automatic',
    94|                 mode,
    95|                 appearance: {},
    96|             };
    97|             const beforeInitEvent = new CustomEvent('beforeInit', {
    98|                 bubbles: true,
    99|                 detail: {
   100|                     stripe: this,
   101|                     elementOptions,
   102|                     paymentOptions,
   103|                 },
   104|             });
   105|             this.$field.dispatchEvent(beforeInitEvent);
   106|             if (!elementOptions.amount) {
   107|                 this.showPlaceholder(t('Invalid amount.'), 'error');
   108|                 return;
   109|             }
   110|             if (!elementOptions.currency) {
   111|                 this.showPlaceholder(t('Invalid currency.'), 'error');
   112|                 return;
   113|             }
   114|             this.elements = this.stripe.elements(elementOptions);
   115|             this.paymentElement = this.elements.create('payment', paymentOptions);
   116|             this.paymentElement.mount(this.$input);
   117|             this.hidePlaceholder();
   118|         } catch (error) {
   119|             console.error(error);
   120|             this.showPlaceholder(error, 'error');
   121|         }
   122|     }
   123|     onValidate(e) {
   124|         if (this.form.submitAction !== 'submit' || e.detail.invalid) {
   125|             return;
   126|         }
   127|         if (!this.elements) {
   128|             return;
   129|         }
   130|         e.preventDefault();
   131|         this.submitHandler = e.detail.submitHandler;
   132|         this.removeError();
   133|         this.elements.submit().then((result) => {
   134|             if (result.error) {
   135|                 return this.addError(result.error.message);
   136|             }
   137|             this.submitHandler.submitForm();
   138|         });
   139|     }
   140|     showPlaceholder(message, type) {
   141|         this.$placeholder.innerHTML = message;
   142|         this.$placeholder.classList.remove('fui-hidden');
   143|         if (type === 'error') {
   144|             this.$placeholder.classList.add('fui-error-message');
   145|         }
   146|     }
   147|     hidePlaceholder() {
   148|         this.$placeholder.classList.add('fui-hidden');
   149|     }
   150|     onValidateConfirm(e) {
   151|         const { data } = e.detail;
   152|         this.addLoading();
   153|         const returnUrl = new URL(data.returnUrl);
   154|         returnUrl.searchParams.append('origin', window.location.href);
   155|         if (this.form.formTheme) {
   156|             this.form.formTheme.updateFormHash();
   157|         }
   158|         const confirmIntent = data.type === 'setup' ? this.stripe.confirmSetup : this.stripe.confirmPayment;
   159|         confirmIntent({
   160|             elements: this.elements,
   161|             clientSecret: data.clientSecret,
   162|             redirect: 'if_required',
   163|             confirmParams: {
   164|                 return_url: returnUrl.toString(),
   165|             },
   166|         }).then((result) => {
   167|             this.removeError();
   168|             if (result.error) {
   169|                 this.removeLoading();
   170|                 return this.addError(result.error.message);
   171|             }
   172|             this.updateInputs('stripeSubscriptionId', data.subscriptionId);
   173|             this.updateInputs('stripePaymentIntentId', result.paymentIntent.id);
   174|             this.processResubmit();
   175|         });
   176|     }
   177|     hasDynamicValue(key) {
   178|         const value = this.initialPaymentInformation[key] ?? null;
   179|         return value.toString().includes('{field:') ?? false;
   180|     }
   181|     hasDynamicValues() {
   182|         return this.hasDynamicValue('amount') || this.hasDynamicValue('currency');
   183|     }
   184|     checkDynamicValues() {
   185|         const amount = this.initialPaymentInformation?.amount ?? null;
   186|         const currency = this.initialPaymentInformation?.currency ?? null;
   187|         const amountValue = this.getFieldValue(amount, 'number');
   188|         const currencyValue = this.getFieldValue(currency);
   189|         const amountLabel = this.getFieldLabel(amount);
   190|         const currencyLabel = this.getFieldLabel(currency);
   191|         if (this.hasDynamicValue('amount')) {
   192|             if (!amountValue) {
   193|                 this.showPlaceholder(t('Provide a value for “{label}” to proceed.', { label: amountLabel }), 'error');
   194|                 return false;
   195|             }
   196|             this.paymentInformation.amount = amountValue * 100;
   197|         }
   198|         if (this.hasDynamicValue('currency')) {
   199|             if (!currencyValue) {
   200|                 this.showPlaceholder(t('Provide a value for “{label}” to proceed.', { label: currencyLabel }), 'error');
   201|                 return false;
   202|             }
   203|             this.paymentInformation.currency = currencyValue.toLowerCase();
   204|         }
   205|         return true;
   206|     }
   207|     handleDynamicValues() {
   208|         if (!this.hasDynamicValues()) {
   209|             return true;
   210|         }
   211|         this.$form.addEventListener('input', debounce((event) => {
   212|             const fieldName = event.target.name;
   213|             const amount = this.initialPaymentInformation?.amount ?? null;
   214|             const currency = this.initialPaymentInformation?.currency ?? null;
   215|             if (fieldName === getFieldName(amount) || fieldName === getFieldName(currency)) {
   216|                 if (this.checkDynamicValues()) {
   217|                     this.hidePlaceholder();
   218|                     if (this.elements) {
   219|                         this.elements.update(this.paymentInformation);
   220|                     } else {
   221|                         this.renderStripe();
   222|                     }
   223|                 }
   224|             }
   225|         }, 600));
   226|         return this.checkDynamicValues();
   227|     }
   228|     isSubscription() {
   229|         return this.paymentType === 'subscription';
   230|     }
   231|     addLoading() {
   232|         if (this.form.formTheme) {
   233|             this.form.formTheme.addLoading();
   234|         }
   235|     }
   236|     removeLoading() {
   237|         if (this.form.formTheme) {
   238|             this.form.formTheme.removeLoading();
   239|         }
   240|     }
   241|     onAfterSubmit(e) {
   242|         if (this.paymentElement) {
   243|             this.paymentElement.clear();
   244|         }
   245|         this.updateInputs('stripePaymentIntentId', '');
   246|         this.updateInputs('stripeSubscriptionId', '');
   247|     }
   248| }
   249| window.FormieStripe = FormieStripe;

