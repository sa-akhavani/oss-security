# ====================================================================
# FILE: src/View/Helper/FormElementErrors.php
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 1-28 ---
     1| <?php
     2| namespace Laminas\Form\View\Helper;
     3| use Laminas\Form\ElementInterface;
     4| use Laminas\Form\Exception;
     5| use Traversable;
     6| use function array_merge;
     7| use function array_walk_recursive;
     8| use function count;
     9| use function get_class;
    10| use function gettype;
    11| use function implode;
    12| use function is_array;
    13| use function is_object;
    14| use function iterator_to_array;
    15| use function sprintf;
    16| class FormElementErrors extends AbstractHelper
    17| {
    18|     /**@+
    19|      * @var string Templates for the open/close/separators for message tags
    20|      */
    21|     protected $messageCloseString     = '</li></ul>';
    22|     protected $messageOpenFormat      = '<ul%s><li>';
    23|     protected $messageSeparatorString = '</li><li>';
    24|     /**@-*/
    25|     /**
    26|      * @var array Default attributes for the open format tag
    27|      */
    28|     protected $attributes = [];

# --- HUNK 2: Lines 65-109 ---
    65|             $messages = iterator_to_array($messages);
    66|         } elseif (! is_array($messages)) {
    67|             throw new Exception\DomainException(sprintf(
    68|                 '%s expects that $element->getMessages() will return an array or Traversable; received "%s"',
    69|                 __METHOD__,
    70|                 is_object($messages) ? get_class($messages) : gettype($messages)
    71|             ));
    72|         }
    73|         if (! $messages) {
    74|             return '';
    75|         }
    76|         $messages = $this->flattenMessages($messages);
    77|         if (! $messages) {
    78|             return '';
    79|         }
    80|         $attributes = array_merge($this->attributes, $attributes);
    81|         $attributes = $this->createAttributesString($attributes);
    82|         if (! empty($attributes)) {
    83|             $attributes = ' ' . $attributes;
    84|         }
    85|         $count   = count($messages);
    86|         $escaper = $this->getEscapeHtmlHelper();
    87|         for ($i = 0; $i < $count; $i += 1) {
    88|             $messages[$i] = $escaper($messages[$i]);
    89|         }
    90|         $markup  = sprintf($this->getMessageOpenFormat(), $attributes);
    91|         $markup .= implode($this->getMessageSeparatorString(), $messages);
    92|         $markup .= $this->getMessageCloseString();
    93|         return $markup;
    94|     }
    95|     /**
    96|      * Set the attributes that will go on the message open format
    97|      *
    98|      * @param  array $attributes key value pairs of attributes
    99|      * @return $this
   100|      */
   101|     public function setAttributes(array $attributes)
   102|     {
   103|         $this->attributes = $attributes;
   104|         return $this;
   105|     }
   106|     /**
   107|      * Get the attributes that will go on the message open format
   108|      *
   109|      * @return array

