--- a//dev/null
+++ b/apps/advanced/backend/assets/AppAsset.php
@@ -0,0 +1,26 @@
+<?php
+/**
+ * @link http://www.yiiframework.com/
+ * @copyright Copyright (c) 2008 Yii Software LLC
+ * @license http://www.yiiframework.com/license/
+ */
+namespace backend\assets;
+use yii\web\AssetBundle;
+/**
+ * @author Qiang Xue <qiang.xue@gmail.com>
+ * @since 2.0
+ */
+class AppAsset extends AssetBundle
+{
+    public $basePath = '@webroot';
+    public $baseUrl = '@web';
+    public $css = [
+        'css/site.css',
+    ];
+    public $js = [
+    ];
+    public $depends = [
+        'yii\web\YiiAsset',
+        'yii\bootstrap\BootstrapAsset',
+    ];
+}

--- a//dev/null
+++ b/apps/advanced/backend/config/bootstrap.php
@@ -0,0 +1 @@
+<?php

--- a//dev/null
+++ b/apps/advanced/backend/config/main.php
@@ -0,0 +1,33 @@
+<?php
+$params = array_merge(
+    require(__DIR__ . '/../../common/config/params.php'),
+    require(__DIR__ . '/../../common/config/params-local.php'),
+    require(__DIR__ . '/params.php'),
+    require(__DIR__ . '/params-local.php')
+);
+return [
+    'id' => 'app-backend',
+    'basePath' => dirname(__DIR__),
+    'controllerNamespace' => 'backend\controllers',
+    'bootstrap' => ['log'],
+    'modules' => [],
+    'components' => [
+        'user' => [
+            'identityClass' => 'common\models\User',
+            'enableAutoLogin' => true,
+        ],
+        'log' => [
+            'traceLevel' => YII_DEBUG ? 3 : 0,
+            'targets' => [
+                [
+                    'class' => 'yii\log\FileTarget',
+                    'levels' => ['error', 'warning'],
+                ],
+            ],
+        ],
+        'errorHandler' => [
+            'errorAction' => 'site/error',
+        ],
+    ],
+    'params' => $params,
+];

--- a//dev/null
+++ b/apps/advanced/backend/config/params.php
@@ -0,0 +1,4 @@
+<?php
+return [
+    'adminEmail' => 'admin@example.com',
+];

--- a//dev/null
+++ b/apps/advanced/backend/controllers/SiteController.php
@@ -0,0 +1,75 @@
+<?php
+namespace backend\controllers;
+use Yii;
+use yii\filters\AccessControl;
+use yii\web\Controller;
+use common\models\LoginForm;
+use yii\filters\VerbFilter;
+/**
+ * Site controller
+ */
+class SiteController extends Controller
+{
+    /**
+     * @inheritdoc
+     */
+    public function behaviors()
+    {
+        return [
+            'access' => [
+                'class' => AccessControl::className(),
+                'rules' => [
+                    [
+                        'actions' => ['login', 'error'],
+                        'allow' => true,
+                    ],
+                    [
+                        'actions' => ['logout', 'index'],
+                        'allow' => true,
+                        'roles' => ['@'],
+                    ],
+                ],
+            ],
+            'verbs' => [
+                'class' => VerbFilter::className(),
+                'actions' => [
+                    'logout' => ['post'],
+                ],
+            ],
+        ];
+    }
+    /**
+     * @inheritdoc
+     */
+    public function actions()
+    {
+        return [
+            'error' => [
+                'class' => 'yii\web\ErrorAction',
+            ],
+        ];
+    }
+    public function actionIndex()
+    {
+        return $this->render('index');
+    }
+    public function actionLogin()
+    {
+        if (!\Yii::$app->user->isGuest) {
+            return $this->goHome();
+        }
+        $model = new LoginForm();
+        if ($model->load(Yii::$app->request->post()) && $model->login()) {
+            return $this->goBack();
+        } else {
+            return $this->render('login', [
+                'model' => $model,
+            ]);
+        }
+    }
+    public function actionLogout()
+    {
+        Yii::$app->user->logout();
+        return $this->goHome();
+    }
+}

--- a//dev/null
+++ b/apps/advanced/backend/views/layouts/main.php
@@ -0,0 +1,66 @@
+<?php
+use backend\assets\AppAsset;
+use yii\helpers\Html;
+use yii\bootstrap\Nav;
+use yii\bootstrap\NavBar;
+use yii\widgets\Breadcrumbs;
+/* @var $this \yii\web\View */
+/* @var $content string */
+AppAsset::register($this);
+?>
+<?php $this->beginPage() ?>
+<!DOCTYPE html>
+<html lang="<?= Yii::$app->language ?>">
+<head>
+    <meta charset="<?= Yii::$app->charset ?>">
+    <meta name="viewport" content="width=device-width, initial-scale=1">
+    <?= Html::csrfMetaTags() ?>
+    <title><?= Html::encode($this->title) ?></title>
+    <?php $this->head() ?>
+</head>
+<body>
+    <?php $this->beginBody() ?>
+    <div class="wrap">
+        <?php
+            NavBar::begin([
+                'brandLabel' => 'My Company',
+                'brandUrl' => Yii::$app->homeUrl,
+                'options' => [
+                    'class' => 'navbar-inverse navbar-fixed-top',
+                ],
+            ]);
+            $menuItems = [
+                ['label' => 'Home', 'url' => ['/site/index']],
+            ];
+            if (Yii::$app->user->isGuest) {
+                $menuItems[] = ['label' => 'Login', 'url' => ['/site/login']];
+            } else {
+                $menuItems[] = [
+                    'label' => 'Logout (' . Yii::$app->user->identity->username . ')',
+                    'url' => ['/site/logout'],
+                    'linkOptions' => ['data-method' => 'post']
+                ];
+            }
+            echo Nav::widget([
+                'options' => ['class' => 'navbar-nav navbar-right'],
+                'items' => $menuItems,
+            ]);
+            NavBar::end();
+        ?>
+        <div class="container">
+        <?= Breadcrumbs::widget([
+            'links' => isset($this->params['breadcrumbs']) ? $this->params['breadcrumbs'] : [],
+        ]) ?>
+        <?= $content ?>
+        </div>
+    </div>
+    <footer class="footer">
+        <div class="container">
+        <p class="pull-left">&copy; My Company <?= date('Y') ?></p>
+        <p class="pull-right"><?= Yii::powered() ?></p>
+        </div>
+    </footer>
+    <?php $this->endBody() ?>
+</body>
+</html>
+<?php $this->endPage() ?>

--- a//dev/null
+++ b/apps/advanced/backend/views/site/error.php
@@ -0,0 +1,20 @@
+<?php
+use yii\helpers\Html;
+/* @var $this yii\web\View */
+/* @var $name string */
+/* @var $message string */
+/* @var $exception Exception */
+$this->title = $name;
+?>
+<div class="site-error">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <div class="alert alert-danger">
+        <?= nl2br(Html::encode($message)) ?>
+    </div>
+    <p>
+        The above error occurred while the Web server was processing your request.
+    </p>
+    <p>
+        Please contact us if you think this is a server error. Thank you.
+    </p>
+</div>

--- a//dev/null
+++ b/apps/advanced/backend/views/site/index.php
@@ -0,0 +1,39 @@
+<?php
+/* @var $this yii\web\View */
+$this->title = 'My Yii Application';
+?>
+<div class="site-index">
+    <div class="jumbotron">
+        <h1>Congratulations!</h1>
+        <p class="lead">You have successfully created your Yii-powered application.</p>
+        <p><a class="btn btn-lg btn-success" href="http://www.yiiframework.com">Get started with Yii</a></p>
+    </div>
+    <div class="body-content">
+        <div class="row">
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/doc/">Yii Documentation &raquo;</a></p>
+            </div>
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/forum/">Yii Forum &raquo;</a></p>
+            </div>
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/extensions/">Yii Extensions &raquo;</a></p>
+            </div>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/advanced/backend/views/site/login.php
@@ -0,0 +1,25 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\ActiveForm;
+/* @var $this yii\web\View */
+/* @var $form yii\bootstrap\ActiveForm */
+/* @var $model \common\models\LoginForm */
+$this->title = 'Login';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-login">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>Please fill out the following fields to login:</p>
+    <div class="row">
+        <div class="col-lg-5">
+            <?php $form = ActiveForm::begin(['id' => 'login-form']); ?>
+                <?= $form->field($model, 'username') ?>
+                <?= $form->field($model, 'password')->passwordInput() ?>
+                <?= $form->field($model, 'rememberMe')->checkbox() ?>
+                <div class="form-group">
+                    <?= Html::submitButton('Login', ['class' => 'btn btn-primary', 'name' => 'login-button']) ?>
+                </div>
+            <?php ActiveForm::end(); ?>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/advanced/common/config/bootstrap.php
@@ -0,0 +1,5 @@
+<?php
+Yii::setAlias('common', dirname(__DIR__));
+Yii::setAlias('frontend', dirname(dirname(__DIR__)) . '/frontend');
+Yii::setAlias('backend', dirname(dirname(__DIR__)) . '/backend');
+Yii::setAlias('console', dirname(dirname(__DIR__)) . '/console');

--- a//dev/null
+++ b/apps/advanced/common/config/main.php
@@ -0,0 +1,9 @@
+<?php
+return [
+    'vendorPath' => dirname(dirname(__DIR__)) . '/vendor',
+    'components' => [
+        'cache' => [
+            'class' => 'yii\caching\FileCache',
+        ],
+    ],
+];

--- a//dev/null
+++ b/apps/advanced/common/config/params.php
@@ -0,0 +1,6 @@
+<?php
+return [
+    'adminEmail' => 'admin@example.com',
+    'supportEmail' => 'support@example.com',
+    'user.passwordResetTokenExpire' => 3600,
+];

--- a//dev/null
+++ b/apps/advanced/common/mail/layouts/html.php
@@ -0,0 +1,21 @@
+<?php
+use yii\helpers\Html;
+/* @var $this \yii\web\View view component instance */
+/* @var $message \yii\mail\MessageInterface the message being composed */
+/* @var $content string main view render result */
+?>
+<?php $this->beginPage() ?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+    <meta http-equiv="Content-Type" content="text/html; charset=<?= Yii::$app->charset ?>" />
+    <title><?= Html::encode($this->title) ?></title>
+    <?php $this->head() ?>
+</head>
+<body>
+    <?php $this->beginBody() ?>
+    <?= $content ?>
+    <?php $this->endBody() ?>
+</body>
+</html>
+<?php $this->endPage() ?>

--- a//dev/null
+++ b/apps/advanced/common/mail/layouts/text.php
@@ -0,0 +1,11 @@
+<?php
+use yii\helpers\Html;
+/* @var $this \yii\web\View view component instance */
+/* @var $message \yii\mail\MessageInterface the message being composed */
+/* @var $content string main view render result */
+?>
+<?php $this->beginPage() ?>
+<?php $this->beginBody() ?>
+<?= $content ?>
+<?php $this->endBody() ?>
+<?php $this->endPage() ?>

--- a//dev/null
+++ b/apps/advanced/common/mail/passwordResetToken-html.php
@@ -0,0 +1,11 @@
+<?php
+use yii\helpers\Html;
+/* @var $this yii\web\View */
+/* @var $user common\models\User */
+$resetLink = Yii::$app->urlManager->createAbsoluteUrl(['site/reset-password', 'token' => $user->password_reset_token]);
+?>
+<div class="password-reset">
+    <p>Hello <?= Html::encode($user->username) ?>,</p>
+    <p>Follow the link below to reset your password:</p>
+    <p><?= Html::a(Html::encode($resetLink), $resetLink) ?></p>
+</div>

--- a//dev/null
+++ b/apps/advanced/common/mail/passwordResetToken-text.php
@@ -0,0 +1,8 @@
+<?php
+/* @var $this yii\web\View */
+/* @var $user common\models\User */
+$resetLink = Yii::$app->urlManager->createAbsoluteUrl(['site/reset-password', 'token' => $user->password_reset_token]);
+?>
+Hello <?= $user->username ?>,
+Follow the link below to reset your password:
+<?= $resetLink ?>

--- a//dev/null
+++ b/apps/advanced/common/models/LoginForm.php
@@ -0,0 +1,66 @@
+<?php
+namespace common\models;
+use Yii;
+use yii\base\Model;
+/**
+ * Login form
+ */
+class LoginForm extends Model
+{
+    public $username;
+    public $password;
+    public $rememberMe = true;
+    private $_user = false;
+    /**
+     * @inheritdoc
+     */
+    public function rules()
+    {
+        return [
+            [['username', 'password'], 'required'],
+            ['rememberMe', 'boolean'],
+            ['password', 'validatePassword'],
+        ];
+    }
+    /**
+     * Validates the password.
+     * This method serves as the inline validation for password.
+     *
+     * @param string $attribute the attribute currently being validated
+     * @param array $params the additional name-value pairs given in the rule
+     */
+    public function validatePassword($attribute, $params)
+    {
+        if (!$this->hasErrors()) {
+            $user = $this->getUser();
+            if (!$user || !$user->validatePassword($this->password)) {
+                $this->addError($attribute, 'Incorrect username or password.');
+            }
+        }
+    }
+    /**
+     * Logs in a user using the provided username and password.
+     *
+     * @return boolean whether the user is logged in successfully
+     */
+    public function login()
+    {
+        if ($this->validate()) {
+            return Yii::$app->user->login($this->getUser(), $this->rememberMe ? 3600 * 24 * 30 : 0);
+        } else {
+            return false;
+        }
+    }
+    /**
+     * Finds user by [[username]]
+     *
+     * @return User|null
+     */
+    public function getUser()
+    {
+        if ($this->_user === false) {
+            $this->_user = User::findByUsername($this->username);
+        }
+        return $this->_user;
+    }
+}

--- a//dev/null
+++ b/apps/advanced/common/models/User.php
@@ -0,0 +1,169 @@
+<?php
+namespace common\models;
+use Yii;
+use yii\base\NotSupportedException;
+use yii\behaviors\TimestampBehavior;
+use yii\db\ActiveRecord;
+use yii\web\IdentityInterface;
+/**
+ * User model
+ *
+ * @property integer $id
+ * @property string $username
+ * @property string $password_hash
+ * @property string $password_reset_token
+ * @property string $email
+ * @property string $auth_key
+ * @property integer $status
+ * @property integer $created_at
+ * @property integer $updated_at
+ * @property string $password write-only password
+ */
+class User extends ActiveRecord implements IdentityInterface
+{
+    const STATUS_DELETED = 0;
+    const STATUS_ACTIVE = 10;
+    /**
+     * @inheritdoc
+     */
+    public static function tableName()
+    {
+        return '{{%user}}';
+    }
+    /**
+     * @inheritdoc
+     */
+    public function behaviors()
+    {
+        return [
+            TimestampBehavior::className(),
+        ];
+    }
+    /**
+     * @inheritdoc
+     */
+    public function rules()
+    {
+        return [
+            ['status', 'default', 'value' => self::STATUS_ACTIVE],
+            ['status', 'in', 'range' => [self::STATUS_ACTIVE, self::STATUS_DELETED]],
+        ];
+    }
+    /**
+     * @inheritdoc
+     */
+    public static function findIdentity($id)
+    {
+        return static::findOne(['id' => $id, 'status' => self::STATUS_ACTIVE]);
+    }
+    /**
+     * @inheritdoc
+     */
+    public static function findIdentityByAccessToken($token, $type = null)
+    {
+        throw new NotSupportedException('"findIdentityByAccessToken" is not implemented.');
+    }
+    /**
+     * Finds user by username
+     *
+     * @param string $username
+     * @return static|null
+     */
+    public static function findByUsername($username)
+    {
+        return static::findOne(['username' => $username, 'status' => self::STATUS_ACTIVE]);
+    }
+    /**
+     * Finds user by password reset token
+     *
+     * @param string $token password reset token
+     * @return static|null
+     */
+    public static function findByPasswordResetToken($token)
+    {
+        if (!static::isPasswordResetTokenValid($token)) {
+            return null;
+        }
+        return static::findOne([
+            'password_reset_token' => $token,
+            'status' => self::STATUS_ACTIVE,
+        ]);
+    }
+    /**
+     * Finds out if password reset token is valid
+     *
+     * @param string $token password reset token
+     * @return boolean
+     */
+    public static function isPasswordResetTokenValid($token)
+    {
+        if (empty($token)) {
+            return false;
+        }
+        $expire = Yii::$app->params['user.passwordResetTokenExpire'];
+        $parts = explode('_', $token);
+        $timestamp = (int) end($parts);
+        return $timestamp + $expire >= time();
+    }
+    /**
+     * @inheritdoc
+     */
+    public function getId()
+    {
+        return $this->getPrimaryKey();
+    }
+    /**
+     * @inheritdoc
+     */
+    public function getAuthKey()
+    {
+        return $this->auth_key;
+    }
+    /**
+     * @inheritdoc
+     */
+    public function validateAuthKey($authKey)
+    {
+        return $this->getAuthKey() === $authKey;
+    }
+    /**
+     * Validates password
+     *
+     * @param string $password password to validate
+     * @return boolean if password provided is valid for current user
+     */
+    public function validatePassword($password)
+    {
+        return Yii::$app->security->validatePassword($password, $this->password_hash);
+    }
+    /**
+     * Generates password hash from password and sets it to the model
+     *
+     * @param string $password
+     */
+    public function setPassword($password)
+    {
+        $this->password_hash = Yii::$app->security->generatePasswordHash($password);
+    }
+    /**
+     * Generates "remember me" authentication key
+     */
+    public function generateAuthKey()
+    {
+        $this->auth_key = Yii::$app->security->generateRandomString();
+    }
+    /**
+     * Generates new password reset token
+     */
+    public function generatePasswordResetToken()
+    {
+        $this->password_reset_token = Yii::$app->security->generateRandomString() . '_' . time();
+    }
+    /**
+     * Removes password reset token
+     */
+    public function removePasswordResetToken()
+    {
+        $this->password_reset_token = null;
+    }
+}

--- a//dev/null
+++ b/apps/advanced/console/config/bootstrap.php
@@ -0,0 +1 @@
+<?php

--- a//dev/null
+++ b/apps/advanced/console/config/main.php
@@ -0,0 +1,24 @@
+<?php
+$params = array_merge(
+    require(__DIR__ . '/../../common/config/params.php'),
+    require(__DIR__ . '/../../common/config/params-local.php'),
+    require(__DIR__ . '/params.php'),
+    require(__DIR__ . '/params-local.php')
+);
+return [
+    'id' => 'app-console',
+    'basePath' => dirname(__DIR__),
+    'bootstrap' => ['log'],
+    'controllerNamespace' => 'console\controllers',
+    'components' => [
+        'log' => [
+            'targets' => [
+                [
+                    'class' => 'yii\log\FileTarget',
+                    'levels' => ['error', 'warning'],
+                ],
+            ],
+        ],
+    ],
+    'params' => $params,
+];

--- a//dev/null
+++ b/apps/advanced/console/config/params.php
@@ -0,0 +1,4 @@
+<?php
+return [
+    'adminEmail' => 'admin@example.com',
+];

--- a//dev/null
+++ b/apps/advanced/console/migrations/m130524_201442_init.php
@@ -0,0 +1,28 @@
+<?php
+use yii\db\Schema;
+use yii\db\Migration;
+class m130524_201442_init extends Migration
+{
+    public function up()
+    {
+        $tableOptions = null;
+        if ($this->db->driverName === 'mysql') {
+            $tableOptions = 'CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE=InnoDB';
+        }
+        $this->createTable('{{%user}}', [
+            'id' => Schema::TYPE_PK,
+            'username' => Schema::TYPE_STRING . ' NOT NULL',
+            'auth_key' => Schema::TYPE_STRING . '(32) NOT NULL',
+            'password_hash' => Schema::TYPE_STRING . ' NOT NULL',
+            'password_reset_token' => Schema::TYPE_STRING,
+            'email' => Schema::TYPE_STRING . ' NOT NULL',
+            'status' => Schema::TYPE_SMALLINT . ' NOT NULL DEFAULT 10',
+            'created_at' => Schema::TYPE_INTEGER . ' NOT NULL',
+            'updated_at' => Schema::TYPE_INTEGER . ' NOT NULL',
+        ], $tableOptions);
+    }
+    public function down()
+    {
+        $this->dropTable('{{%user}}');
+    }
+}

--- a//dev/null
+++ b/apps/advanced/environments/dev/backend/config/main-local.php
@@ -0,0 +1,15 @@
+<?php
+$config = [
+    'components' => [
+        'request' => [
+            'cookieValidationKey' => '',
+        ],
+    ],
+];
+if (!YII_ENV_TEST) {
+    $config['bootstrap'][] = 'debug';
+    $config['modules']['debug'] = 'yii\debug\Module';
+    $config['bootstrap'][] = 'gii';
+    $config['modules']['gii'] = 'yii\gii\Module';
+}
+return $config;

--- a//dev/null
+++ b/apps/advanced/environments/dev/backend/config/params-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/dev/backend/web/index.php
@@ -0,0 +1,15 @@
+<?php
+defined('YII_DEBUG') or define('YII_DEBUG', true);
+defined('YII_ENV') or define('YII_ENV', 'dev');
+require(__DIR__ . '/../../vendor/autoload.php');
+require(__DIR__ . '/../../vendor/yiisoft/yii2/Yii.php');
+require(__DIR__ . '/../../common/config/bootstrap.php');
+require(__DIR__ . '/../config/bootstrap.php');
+$config = yii\helpers\ArrayHelper::merge(
+    require(__DIR__ . '/../../common/config/main.php'),
+    require(__DIR__ . '/../../common/config/main-local.php'),
+    require(__DIR__ . '/../config/main.php'),
+    require(__DIR__ . '/../config/main-local.php')
+);
+$application = new yii\web\Application($config);
+$application->run();

--- a//dev/null
+++ b/apps/advanced/environments/dev/common/config/main-local.php
@@ -0,0 +1,17 @@
+<?php
+return [
+    'components' => [
+        'db' => [
+            'class' => 'yii\db\Connection',
+            'dsn' => 'mysql:host=localhost;dbname=yii2advanced',
+            'username' => 'root',
+            'password' => '',
+            'charset' => 'utf8',
+        ],
+        'mailer' => [
+            'class' => 'yii\swiftmailer\Mailer',
+            'viewPath' => '@common/mail',
+            'useFileTransport' => true,
+        ],
+    ],
+];

--- a//dev/null
+++ b/apps/advanced/environments/dev/common/config/params-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/dev/console/config/main-local.php
@@ -0,0 +1,7 @@
+<?php
+return [
+    'bootstrap' => ['gii'],
+    'modules' => [
+        'gii' => 'yii\gii\Module',
+    ],
+];

--- a//dev/null
+++ b/apps/advanced/environments/dev/console/config/params-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/dev/frontend/config/main-local.php
@@ -0,0 +1,15 @@
+<?php
+$config = [
+    'components' => [
+        'request' => [
+            'cookieValidationKey' => '',
+        ],
+    ],
+];
+if (!YII_ENV_TEST) {
+    $config['bootstrap'][] = 'debug';
+    $config['modules']['debug'] = 'yii\debug\Module';
+    $config['bootstrap'][] = 'gii';
+    $config['modules']['gii'] = 'yii\gii\Module';
+}
+return $config;

--- a//dev/null
+++ b/apps/advanced/environments/dev/frontend/config/params-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/dev/frontend/web/index.php
@@ -0,0 +1,15 @@
+<?php
+defined('YII_DEBUG') or define('YII_DEBUG', true);
+defined('YII_ENV') or define('YII_ENV', 'dev');
+require(__DIR__ . '/../../vendor/autoload.php');
+require(__DIR__ . '/../../vendor/yiisoft/yii2/Yii.php');
+require(__DIR__ . '/../../common/config/bootstrap.php');
+require(__DIR__ . '/../config/bootstrap.php');
+$config = yii\helpers\ArrayHelper::merge(
+    require(__DIR__ . '/../../common/config/main.php'),
+    require(__DIR__ . '/../../common/config/main-local.php'),
+    require(__DIR__ . '/../config/main.php'),
+    require(__DIR__ . '/../config/main-local.php')
+);
+$application = new yii\web\Application($config);
+$application->run();

--- a//dev/null
+++ b/apps/advanced/environments/index.php
@@ -0,0 +1,61 @@
+<?php
+/**
+ * The manifest of files that are local to specific environment.
+ * This file returns a list of environments that the application
+ * may be installed under. The returned data must be in the following
+ * format:
+ *
+ * ```php
+ * return [
+ *     'environment name' => [
+ *         'path' => 'directory storing the local files',
+ *         'setWritable' => [
+ *             // list of directories that should be set writable
+ *         ],
+ *         'setExecutable' => [
+ *             // list of files that should be set executable
+ *         ],
+ *         'setCookieValidationKey' => [
+ *             // list of config files that need to be inserted with automatically generated cookie validation keys
+ *         ],
+ *         'createSymlink' => [
+ *             // list of symlinks to be created. Keys are symlinks, and values are the targets.
+ *         ],
+ *     ],
+ * ];
+ * ```
+ */
+return [
+    'Development' => [
+        'path' => 'dev',
+        'setWritable' => [
+            'backend/runtime',
+            'backend/web/assets',
+            'frontend/runtime',
+            'frontend/web/assets',
+        ],
+        'setExecutable' => [
+            'yii',
+        ],
+        'setCookieValidationKey' => [
+            'backend/config/main-local.php',
+            'frontend/config/main-local.php',
+        ],
+    ],
+    'Production' => [
+        'path' => 'prod',
+        'setWritable' => [
+            'backend/runtime',
+            'backend/web/assets',
+            'frontend/runtime',
+            'frontend/web/assets',
+        ],
+        'setExecutable' => [
+            'yii',
+        ],
+        'setCookieValidationKey' => [
+            'backend/config/main-local.php',
+            'frontend/config/main-local.php',
+        ],
+    ],
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/backend/config/main-local.php
@@ -0,0 +1,8 @@
+<?php
+return [
+    'components' => [
+        'request' => [
+            'cookieValidationKey' => '',
+        ],
+    ],
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/backend/config/params-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/backend/web/index.php
@@ -0,0 +1,15 @@
+<?php
+defined('YII_DEBUG') or define('YII_DEBUG', false);
+defined('YII_ENV') or define('YII_ENV', 'prod');
+require(__DIR__ . '/../../vendor/autoload.php');
+require(__DIR__ . '/../../vendor/yiisoft/yii2/Yii.php');
+require(__DIR__ . '/../../common/config/bootstrap.php');
+require(__DIR__ . '/../config/bootstrap.php');
+$config = yii\helpers\ArrayHelper::merge(
+    require(__DIR__ . '/../../common/config/main.php'),
+    require(__DIR__ . '/../../common/config/main-local.php'),
+    require(__DIR__ . '/../config/main.php'),
+    require(__DIR__ . '/../config/main-local.php')
+);
+$application = new yii\web\Application($config);
+$application->run();

--- a//dev/null
+++ b/apps/advanced/environments/prod/common/config/main-local.php
@@ -0,0 +1,16 @@
+<?php
+return [
+    'components' => [
+        'db' => [
+            'class' => 'yii\db\Connection',
+            'dsn' => 'mysql:host=localhost;dbname=yii2advanced',
+            'username' => 'root',
+            'password' => '',
+            'charset' => 'utf8',
+        ],
+        'mailer' => [
+            'class' => 'yii\swiftmailer\Mailer',
+            'viewPath' => '@common/mail',
+        ],
+    ],
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/common/config/params-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/console/config/main-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/console/config/params-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/frontend/config/main-local.php
@@ -0,0 +1,8 @@
+<?php
+return [
+    'components' => [
+        'request' => [
+            'cookieValidationKey' => '',
+        ],
+    ],
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/frontend/config/params-local.php
@@ -0,0 +1,3 @@
+<?php
+return [
+];

--- a//dev/null
+++ b/apps/advanced/environments/prod/frontend/web/index.php
@@ -0,0 +1,15 @@
+<?php
+defined('YII_DEBUG') or define('YII_DEBUG', false);
+defined('YII_ENV') or define('YII_ENV', 'prod');
+require(__DIR__ . '/../../vendor/autoload.php');
+require(__DIR__ . '/../../vendor/yiisoft/yii2/Yii.php');
+require(__DIR__ . '/../../common/config/bootstrap.php');
+require(__DIR__ . '/../config/bootstrap.php');
+$config = yii\helpers\ArrayHelper::merge(
+    require(__DIR__ . '/../../common/config/main.php'),
+    require(__DIR__ . '/../../common/config/main-local.php'),
+    require(__DIR__ . '/../config/main.php'),
+    require(__DIR__ . '/../config/main-local.php')
+);
+$application = new yii\web\Application($config);
+$application->run();

--- a//dev/null
+++ b/apps/advanced/frontend/assets/AppAsset.php
@@ -0,0 +1,26 @@
+<?php
+/**
+ * @link http://www.yiiframework.com/
+ * @copyright Copyright (c) 2008 Yii Software LLC
+ * @license http://www.yiiframework.com/license/
+ */
+namespace frontend\assets;
+use yii\web\AssetBundle;
+/**
+ * @author Qiang Xue <qiang.xue@gmail.com>
+ * @since 2.0
+ */
+class AppAsset extends AssetBundle
+{
+    public $basePath = '@webroot';
+    public $baseUrl = '@web';
+    public $css = [
+        'css/site.css',
+    ];
+    public $js = [
+    ];
+    public $depends = [
+        'yii\web\YiiAsset',
+        'yii\bootstrap\BootstrapAsset',
+    ];
+}

--- a//dev/null
+++ b/apps/advanced/frontend/config/bootstrap.php
@@ -0,0 +1 @@
+<?php

--- a//dev/null
+++ b/apps/advanced/frontend/config/main.php
@@ -0,0 +1,32 @@
+<?php
+$params = array_merge(
+    require(__DIR__ . '/../../common/config/params.php'),
+    require(__DIR__ . '/../../common/config/params-local.php'),
+    require(__DIR__ . '/params.php'),
+    require(__DIR__ . '/params-local.php')
+);
+return [
+    'id' => 'app-frontend',
+    'basePath' => dirname(__DIR__),
+    'bootstrap' => ['log'],
+    'controllerNamespace' => 'frontend\controllers',
+    'components' => [
+        'user' => [
+            'identityClass' => 'common\models\User',
+            'enableAutoLogin' => true,
+        ],
+        'log' => [
+            'traceLevel' => YII_DEBUG ? 3 : 0,
+            'targets' => [
+                [
+                    'class' => 'yii\log\FileTarget',
+                    'levels' => ['error', 'warning'],
+                ],
+            ],
+        ],
+        'errorHandler' => [
+            'errorAction' => 'site/error',
+        ],
+    ],
+    'params' => $params,
+];

--- a//dev/null
+++ b/apps/advanced/frontend/config/params.php
@@ -0,0 +1,4 @@
+<?php
+return [
+    'adminEmail' => 'admin@example.com',
+];

--- a//dev/null
+++ b/apps/advanced/frontend/controllers/SiteController.php
@@ -0,0 +1,151 @@
+<?php
+namespace frontend\controllers;
+use Yii;
+use common\models\LoginForm;
+use frontend\models\PasswordResetRequestForm;
+use frontend\models\ResetPasswordForm;
+use frontend\models\SignupForm;
+use frontend\models\ContactForm;
+use yii\base\InvalidParamException;
+use yii\web\BadRequestHttpException;
+use yii\web\Controller;
+use yii\filters\VerbFilter;
+use yii\filters\AccessControl;
+/**
+ * Site controller
+ */
+class SiteController extends Controller
+{
+    /**
+     * @inheritdoc
+     */
+    public function behaviors()
+    {
+        return [
+            'access' => [
+                'class' => AccessControl::className(),
+                'only' => ['logout', 'signup'],
+                'rules' => [
+                    [
+                        'actions' => ['signup'],
+                        'allow' => true,
+                        'roles' => ['?'],
+                    ],
+                    [
+                        'actions' => ['logout'],
+                        'allow' => true,
+                        'roles' => ['@'],
+                    ],
+                ],
+            ],
+            'verbs' => [
+                'class' => VerbFilter::className(),
+                'actions' => [
+                    'logout' => ['post'],
+                ],
+            ],
+        ];
+    }
+    /**
+     * @inheritdoc
+     */
+    public function actions()
+    {
+        return [
+            'error' => [
+                'class' => 'yii\web\ErrorAction',
+            ],
+            'captcha' => [
+                'class' => 'yii\captcha\CaptchaAction',
+                'fixedVerifyCode' => YII_ENV_TEST ? 'testme' : null,
+            ],
+        ];
+    }
+    public function actionIndex()
+    {
+        return $this->render('index');
+    }
+    public function actionLogin()
+    {
+        if (!\Yii::$app->user->isGuest) {
+            return $this->goHome();
+        }
+        $model = new LoginForm();
+        if ($model->load(Yii::$app->request->post()) && $model->login()) {
+            return $this->goBack();
+        } else {
+            return $this->render('login', [
+                'model' => $model,
+            ]);
+        }
+    }
+    public function actionLogout()
+    {
+        Yii::$app->user->logout();
+        return $this->goHome();
+    }
+    public function actionContact()
+    {
+        $model = new ContactForm();
+        if ($model->load(Yii::$app->request->post()) && $model->validate()) {
+            if ($model->sendEmail(Yii::$app->params['adminEmail'])) {
+                Yii::$app->session->setFlash('success', 'Thank you for contacting us. We will respond to you as soon as possible.');
+            } else {
+                Yii::$app->session->setFlash('error', 'There was an error sending email.');
+            }
+            return $this->refresh();
+        } else {
+            return $this->render('contact', [
+                'model' => $model,
+            ]);
+        }
+    }
+    public function actionAbout()
+    {
+        return $this->render('about');
+    }
+    public function actionSignup()
+    {
+        $model = new SignupForm();
+        if ($model->load(Yii::$app->request->post())) {
+            if ($user = $model->signup()) {
+                if (Yii::$app->getUser()->login($user)) {
+                    return $this->goHome();
+                }
+            }
+        }
+        return $this->render('signup', [
+            'model' => $model,
+        ]);
+    }
+    public function actionRequestPasswordReset()
+    {
+        $model = new PasswordResetRequestForm();
+        if ($model->load(Yii::$app->request->post()) && $model->validate()) {
+            if ($model->sendEmail()) {
+                Yii::$app->getSession()->setFlash('success', 'Check your email for further instructions.');
+                return $this->goHome();
+            } else {
+                Yii::$app->getSession()->setFlash('error', 'Sorry, we are unable to reset password for email provided.');
+            }
+        }
+        return $this->render('requestPasswordResetToken', [
+            'model' => $model,
+        ]);
+    }
+    public function actionResetPassword($token)
+    {
+        try {
+            $model = new ResetPasswordForm($token);
+        } catch (InvalidParamException $e) {
+            throw new BadRequestHttpException($e->getMessage());
+        }
+        if ($model->load(Yii::$app->request->post()) && $model->validate() && $model->resetPassword()) {
+            Yii::$app->getSession()->setFlash('success', 'New password was saved.');
+            return $this->goHome();
+        }
+        return $this->render('resetPassword', [
+            'model' => $model,
+        ]);
+    }
+}

--- a//dev/null
+++ b/apps/advanced/frontend/models/ContactForm.php
@@ -0,0 +1,50 @@
+<?php
+namespace frontend\models;
+use Yii;
+use yii\base\Model;
+/**
+ * ContactForm is the model behind the contact form.
+ */
+class ContactForm extends Model
+{
+    public $name;
+    public $email;
+    public $subject;
+    public $body;
+    public $verifyCode;
+    /**
+     * @inheritdoc
+     */
+    public function rules()
+    {
+        return [
+            [['name', 'email', 'subject', 'body'], 'required'],
+            ['email', 'email'],
+            ['verifyCode', 'captcha'],
+        ];
+    }
+    /**
+     * @inheritdoc
+     */
+    public function attributeLabels()
+    {
+        return [
+            'verifyCode' => 'Verification Code',
+        ];
+    }
+    /**
+     * Sends an email to the specified email address using the information collected by this model.
+     *
+     * @param  string  $email the target email address
+     * @return boolean whether the email was sent
+     */
+    public function sendEmail($email)
+    {
+        return Yii::$app->mailer->compose()
+            ->setTo($email)
+            ->setFrom([$this->email => $this->name])
+            ->setSubject($this->subject)
+            ->setTextBody($this->body)
+            ->send();
+    }
+}

--- a//dev/null
+++ b/apps/advanced/frontend/models/PasswordResetRequestForm.php
@@ -0,0 +1,53 @@
+<?php
+namespace frontend\models;
+use common\models\User;
+use yii\base\Model;
+/**
+ * Password reset request form
+ */
+class PasswordResetRequestForm extends Model
+{
+    public $email;
+    /**
+     * @inheritdoc
+     */
+    public function rules()
+    {
+        return [
+            ['email', 'filter', 'filter' => 'trim'],
+            ['email', 'required'],
+            ['email', 'email'],
+            ['email', 'exist',
+                'targetClass' => '\common\models\User',
+                'filter' => ['status' => User::STATUS_ACTIVE],
+                'message' => 'There is no user with such email.'
+            ],
+        ];
+    }
+    /**
+     * Sends an email with a link, for resetting the password.
+     *
+     * @return boolean whether the email was send
+     */
+    public function sendEmail()
+    {
+        /* @var $user User */
+        $user = User::findOne([
+            'status' => User::STATUS_ACTIVE,
+            'email' => $this->email,
+        ]);
+        if ($user) {
+            if (!User::isPasswordResetTokenValid($user->password_reset_token)) {
+                $user->generatePasswordResetToken();
+            }
+            if ($user->save()) {
+                return \Yii::$app->mailer->compose(['html' => 'passwordResetToken-html', 'text' => 'passwordResetToken-text'], ['user' => $user])
+                    ->setFrom([\Yii::$app->params['supportEmail'] => \Yii::$app->name . ' robot'])
+                    ->setTo($this->email)
+                    ->setSubject('Password reset for ' . \Yii::$app->name)
+                    ->send();
+            }
+        }
+        return false;
+    }
+}

--- a//dev/null
+++ b/apps/advanced/frontend/models/ResetPasswordForm.php
@@ -0,0 +1,57 @@
+<?php
+namespace frontend\models;
+use common\models\User;
+use yii\base\InvalidParamException;
+use yii\base\Model;
+use Yii;
+/**
+ * Password reset form
+ */
+class ResetPasswordForm extends Model
+{
+    public $password;
+    /**
+     * @var \common\models\User
+     */
+    private $_user;
+    /**
+     * Creates a form model given a token.
+     *
+     * @param  string                          $token
+     * @param  array                           $config name-value pairs that will be used to initialize the object properties
+     * @throws \yii\base\InvalidParamException if token is empty or not valid
+     */
+    public function __construct($token, $config = [])
+    {
+        if (empty($token) || !is_string($token)) {
+            throw new InvalidParamException('Password reset token cannot be blank.');
+        }
+        $this->_user = User::findByPasswordResetToken($token);
+        if (!$this->_user) {
+            throw new InvalidParamException('Wrong password reset token.');
+        }
+        parent::__construct($config);
+    }
+    /**
+     * @inheritdoc
+     */
+    public function rules()
+    {
+        return [
+            ['password', 'required'],
+            ['password', 'string', 'min' => 6],
+        ];
+    }
+    /**
+     * Resets password.
+     *
+     * @return boolean if password was reset.
+     */
+    public function resetPassword()
+    {
+        $user = $this->_user;
+        $user->setPassword($this->password);
+        $user->removePasswordResetToken();
+        return $user->save();
+    }
+}

--- a//dev/null
+++ b/apps/advanced/frontend/models/SignupForm.php
@@ -0,0 +1,51 @@
+<?php
+namespace frontend\models;
+use common\models\User;
+use yii\base\Model;
+use Yii;
+/**
+ * Signup form
+ */
+class SignupForm extends Model
+{
+    public $username;
+    public $email;
+    public $password;
+    /**
+     * @inheritdoc
+     */
+    public function rules()
+    {
+        return [
+            ['username', 'filter', 'filter' => 'trim'],
+            ['username', 'required'],
+            ['username', 'unique', 'targetClass' => '\common\models\User', 'message' => 'This username has already been taken.'],
+            ['username', 'string', 'min' => 2, 'max' => 255],
+            ['email', 'filter', 'filter' => 'trim'],
+            ['email', 'required'],
+            ['email', 'email'],
+            ['email', 'unique', 'targetClass' => '\common\models\User', 'message' => 'This email address has already been taken.'],
+            ['password', 'required'],
+            ['password', 'string', 'min' => 6],
+        ];
+    }
+    /**
+     * Signs user up.
+     *
+     * @return User|null the saved model or null if saving fails
+     */
+    public function signup()
+    {
+        if ($this->validate()) {
+            $user = new User();
+            $user->username = $this->username;
+            $user->email = $this->email;
+            $user->setPassword($this->password);
+            $user->generateAuthKey();
+            if ($user->save()) {
+                return $user;
+            }
+        }
+        return null;
+    }
+}

--- a//dev/null
+++ b/apps/advanced/frontend/views/layouts/main.php
@@ -0,0 +1,71 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\Nav;
+use yii\bootstrap\NavBar;
+use yii\widgets\Breadcrumbs;
+use frontend\assets\AppAsset;
+use frontend\widgets\Alert;
+/* @var $this \yii\web\View */
+/* @var $content string */
+AppAsset::register($this);
+?>
+<?php $this->beginPage() ?>
+<!DOCTYPE html>
+<html lang="<?= Yii::$app->language ?>">
+<head>
+    <meta charset="<?= Yii::$app->charset ?>">
+    <meta name="viewport" content="width=device-width, initial-scale=1">
+    <?= Html::csrfMetaTags() ?>
+    <title><?= Html::encode($this->title) ?></title>
+    <?php $this->head() ?>
+</head>
+<body>
+    <?php $this->beginBody() ?>
+    <div class="wrap">
+        <?php
+            NavBar::begin([
+                'brandLabel' => 'My Company',
+                'brandUrl' => Yii::$app->homeUrl,
+                'options' => [
+                    'class' => 'navbar-inverse navbar-fixed-top',
+                ],
+            ]);
+            $menuItems = [
+                ['label' => 'Home', 'url' => ['/site/index']],
+                ['label' => 'About', 'url' => ['/site/about']],
+                ['label' => 'Contact', 'url' => ['/site/contact']],
+            ];
+            if (Yii::$app->user->isGuest) {
+                $menuItems[] = ['label' => 'Signup', 'url' => ['/site/signup']];
+                $menuItems[] = ['label' => 'Login', 'url' => ['/site/login']];
+            } else {
+                $menuItems[] = [
+                    'label' => 'Logout (' . Yii::$app->user->identity->username . ')',
+                    'url' => ['/site/logout'],
+                    'linkOptions' => ['data-method' => 'post']
+                ];
+            }
+            echo Nav::widget([
+                'options' => ['class' => 'navbar-nav navbar-right'],
+                'items' => $menuItems,
+            ]);
+            NavBar::end();
+        ?>
+        <div class="container">
+        <?= Breadcrumbs::widget([
+            'links' => isset($this->params['breadcrumbs']) ? $this->params['breadcrumbs'] : [],
+        ]) ?>
+        <?= Alert::widget() ?>
+        <?= $content ?>
+        </div>
+    </div>
+    <footer class="footer">
+        <div class="container">
+        <p class="pull-left">&copy; My Company <?= date('Y') ?></p>
+        <p class="pull-right"><?= Yii::powered() ?></p>
+        </div>
+    </footer>
+    <?php $this->endBody() ?>
+</body>
+</html>
+<?php $this->endPage() ?>

--- a//dev/null
+++ b/apps/advanced/frontend/views/site/about.php
@@ -0,0 +1,11 @@
+<?php
+use yii\helpers\Html;
+/* @var $this yii\web\View */
+$this->title = 'About';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-about">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>This is the About page. You may modify the following file to customize its content:</p>
+    <code><?= __FILE__ ?></code>
+</div>

--- a//dev/null
+++ b/apps/advanced/frontend/views/site/contact.php
@@ -0,0 +1,32 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\ActiveForm;
+use yii\captcha\Captcha;
+/* @var $this yii\web\View */
+/* @var $form yii\bootstrap\ActiveForm */
+/* @var $model \frontend\models\ContactForm */
+$this->title = 'Contact';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-contact">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>
+        If you have business inquiries or other questions, please fill out the following form to contact us. Thank you.
+    </p>
+    <div class="row">
+        <div class="col-lg-5">
+            <?php $form = ActiveForm::begin(['id' => 'contact-form']); ?>
+                <?= $form->field($model, 'name') ?>
+                <?= $form->field($model, 'email') ?>
+                <?= $form->field($model, 'subject') ?>
+                <?= $form->field($model, 'body')->textArea(['rows' => 6]) ?>
+                <?= $form->field($model, 'verifyCode')->widget(Captcha::className(), [
+                    'template' => '<div class="row"><div class="col-lg-3">{image}</div><div class="col-lg-6">{input}</div></div>',
+                ]) ?>
+                <div class="form-group">
+                    <?= Html::submitButton('Submit', ['class' => 'btn btn-primary', 'name' => 'contact-button']) ?>
+                </div>
+            <?php ActiveForm::end(); ?>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/advanced/frontend/views/site/error.php
@@ -0,0 +1,20 @@
+<?php
+use yii\helpers\Html;
+/* @var $this yii\web\View */
+/* @var $name string */
+/* @var $message string */
+/* @var $exception Exception */
+$this->title = $name;
+?>
+<div class="site-error">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <div class="alert alert-danger">
+        <?= nl2br(Html::encode($message)) ?>
+    </div>
+    <p>
+        The above error occurred while the Web server was processing your request.
+    </p>
+    <p>
+        Please contact us if you think this is a server error. Thank you.
+    </p>
+</div>

--- a//dev/null
+++ b/apps/advanced/frontend/views/site/index.php
@@ -0,0 +1,39 @@
+<?php
+/* @var $this yii\web\View */
+$this->title = 'My Yii Application';
+?>
+<div class="site-index">
+    <div class="jumbotron">
+        <h1>Congratulations!</h1>
+        <p class="lead">You have successfully created your Yii-powered application.</p>
+        <p><a class="btn btn-lg btn-success" href="http://www.yiiframework.com">Get started with Yii</a></p>
+    </div>
+    <div class="body-content">
+        <div class="row">
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/doc/">Yii Documentation &raquo;</a></p>
+            </div>
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/forum/">Yii Forum &raquo;</a></p>
+            </div>
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/extensions/">Yii Extensions &raquo;</a></p>
+            </div>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/advanced/frontend/views/site/login.php
@@ -0,0 +1,28 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\ActiveForm;
+/* @var $this yii\web\View */
+/* @var $form yii\bootstrap\ActiveForm */
+/* @var $model \common\models\LoginForm */
+$this->title = 'Login';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-login">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>Please fill out the following fields to login:</p>
+    <div class="row">
+        <div class="col-lg-5">
+            <?php $form = ActiveForm::begin(['id' => 'login-form']); ?>
+                <?= $form->field($model, 'username') ?>
+                <?= $form->field($model, 'password')->passwordInput() ?>
+                <?= $form->field($model, 'rememberMe')->checkbox() ?>
+                <div style="color:#999;margin:1em 0">
+                    If you forgot your password you can <?= Html::a('reset it', ['site/request-password-reset']) ?>.
+                </div>
+                <div class="form-group">
+                    <?= Html::submitButton('Login', ['class' => 'btn btn-primary', 'name' => 'login-button']) ?>
+                </div>
+            <?php ActiveForm::end(); ?>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/advanced/frontend/views/site/requestPasswordResetToken.php
@@ -0,0 +1,23 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\ActiveForm;
+/* @var $this yii\web\View */
+/* @var $form yii\bootstrap\ActiveForm */
+/* @var $model \frontend\models\PasswordResetRequestForm */
+$this->title = 'Request password reset';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-request-password-reset">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>Please fill out your email. A link to reset password will be sent there.</p>
+    <div class="row">
+        <div class="col-lg-5">
+            <?php $form = ActiveForm::begin(['id' => 'request-password-reset-form']); ?>
+                <?= $form->field($model, 'email') ?>
+                <div class="form-group">
+                    <?= Html::submitButton('Send', ['class' => 'btn btn-primary']) ?>
+                </div>
+            <?php ActiveForm::end(); ?>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/advanced/frontend/views/site/resetPassword.php
@@ -0,0 +1,23 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\ActiveForm;
+/* @var $this yii\web\View */
+/* @var $form yii\bootstrap\ActiveForm */
+/* @var $model \frontend\models\ResetPasswordForm */
+$this->title = 'Reset password';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-reset-password">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>Please choose your new password:</p>
+    <div class="row">
+        <div class="col-lg-5">
+            <?php $form = ActiveForm::begin(['id' => 'reset-password-form']); ?>
+                <?= $form->field($model, 'password')->passwordInput() ?>
+                <div class="form-group">
+                    <?= Html::submitButton('Save', ['class' => 'btn btn-primary']) ?>
+                </div>
+            <?php ActiveForm::end(); ?>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/advanced/frontend/views/site/signup.php
@@ -0,0 +1,25 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\ActiveForm;
+/* @var $this yii\web\View */
+/* @var $form yii\bootstrap\ActiveForm */
+/* @var $model \frontend\models\SignupForm */
+$this->title = 'Signup';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-signup">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>Please fill out the following fields to signup:</p>
+    <div class="row">
+        <div class="col-lg-5">
+            <?php $form = ActiveForm::begin(['id' => 'form-signup']); ?>
+                <?= $form->field($model, 'username') ?>
+                <?= $form->field($model, 'email') ?>
+                <?= $form->field($model, 'password')->passwordInput() ?>
+                <div class="form-group">
+                    <?= Html::submitButton('Signup', ['class' => 'btn btn-primary', 'name' => 'signup-button']) ?>
+                </div>
+            <?php ActiveForm::end(); ?>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/advanced/frontend/widgets/Alert.php
@@ -0,0 +1,70 @@
+<?php
+/**
+ * @link http://www.yiiframework.com/
+ * @copyright Copyright (c) 2008 Yii Software LLC
+ * @license http://www.yiiframework.com/license/
+ */
+namespace frontend\widgets;
+/**
+ * Alert widget renders a message from session flash. All flash messages are displayed
+ * in the sequence they were assigned using setFlash. You can set message as following:
+ *
+ * ```php
+ * \Yii::$app->getSession()->setFlash('error', 'This is the message');
+ * \Yii::$app->getSession()->setFlash('success', 'This is the message');
+ * \Yii::$app->getSession()->setFlash('info', 'This is the message');
+ * ```
+ *
+ * Multiple messages could be set as follows:
+ *
+ * ```php
+ * \Yii::$app->getSession()->setFlash('error', ['Error 1', 'Error 2']);
+ * ```
+ *
+ * @author Kartik Visweswaran <kartikv2@gmail.com>
+ * @author Alexander Makarov <sam@rmcreative.ru>
+ */
+class Alert extends \yii\bootstrap\Widget
+{
+    /**
+     * @var array the alert types configuration for the flash messages.
+     * This array is setup as $key => $value, where:
+     * - $key is the name of the session flash variable
+     * - $value is the bootstrap alert type (i.e. danger, success, info, warning)
+     */
+    public $alertTypes = [
+        'error'   => 'alert-danger',
+        'danger'  => 'alert-danger',
+        'success' => 'alert-success',
+        'info'    => 'alert-info',
+        'warning' => 'alert-warning'
+    ];
+    /**
+     * @var array the options for rendering the close button tag.
+     */
+    public $closeButton = [];
+    public function init()
+    {
+        parent::init();
+        $session = \Yii::$app->getSession();
+        $flashes = $session->getAllFlashes();
+        $appendCss = isset($this->options['class']) ? ' ' . $this->options['class'] : '';
+        foreach ($flashes as $type => $data) {
+            if (isset($this->alertTypes[$type])) {
+                $data = (array) $data;
+                foreach ($data as $i => $message) {
+                    /* initialize css class for each alert box */
+                    $this->options['class'] = $this->alertTypes[$type] . $appendCss;
+                    /* assign unique id to each alert box */
+                    $this->options['id'] = $this->getId() . '-' . $type . '-' . $i;
+                    echo \yii\bootstrap\Alert::widget([
+                        'body' => $message,
+                        'closeButton' => $this->closeButton,
+                        'options' => $this->options,
+                    ]);
+                }
+                $session->removeFlash($type);
+            }
+        }
+    }
+}

--- a//dev/null
+++ b/apps/advanced/requirements.php
@@ -0,0 +1,120 @@
+<?php
+/**
+ * Application requirement checker script.
+ *
+ * In order to run this script use the following console command:
+ * php requirements.php
+ *
+ * In order to run this script from the web, you should copy it to the web root.
+ * If you are using Linux you can create a hard link instead, using the following command:
+ * ln requirements.php ../requirements.php
+ */
+$frameworkPath = dirname(__FILE__) . '/vendor/yiisoft/yii2';
+if (!is_dir($frameworkPath)) {
+    echo '<h1>Error</h1>';
+    echo '<p><strong>The path to yii framework seems to be incorrect.</strong></p>';
+    echo '<p>You need to install Yii framework via composer or adjust the framework path in file <abbr title="' . __FILE__ . '">' . basename(__FILE__) . '</abbr>.</p>';
+    echo '<p>Please refer to the <abbr title="' . dirname(__FILE__) . '/README.md">README</abbr> on how to install Yii.</p>';
+}
+require_once($frameworkPath . '/requirements/YiiRequirementChecker.php');
+$requirementsChecker = new YiiRequirementChecker();
+$gdMemo = $imagickMemo = 'Either GD PHP extension with FreeType support or ImageMagick PHP extension with PNG support is required for image CAPTCHA.';
+$gdOK = $imagickOK = false;
+if (extension_loaded('imagick')) {
+    $imagick = new Imagick();
+    $imagickFormats = $imagick->queryFormats('PNG');
+    if (in_array('PNG', $imagickFormats)) {
+        $imagickOK = true;
+    } else {
+        $imagickMemo = 'Imagick extension should be installed with PNG support in order to be used for image CAPTCHA.';
+    }
+}
+if (extension_loaded('gd')) {
+    $gdInfo = gd_info();
+    if (!empty($gdInfo['FreeType Support'])) {
+        $gdOK = true;
+    } else {
+        $gdMemo = 'GD extension should be installed with FreeType support in order to be used for image CAPTCHA.';
+    }
+}
+/**
+ * Adjust requirements according to your application specifics.
+ */
+$requirements = array(
+    array(
+        'name' => 'PDO extension',
+        'mandatory' => true,
+        'condition' => extension_loaded('pdo'),
+        'by' => 'All DB-related classes',
+    ),
+    array(
+        'name' => 'PDO SQLite extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('pdo_sqlite'),
+        'by' => 'All DB-related classes',
+        'memo' => 'Required for SQLite database.',
+    ),
+    array(
+        'name' => 'PDO MySQL extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('pdo_mysql'),
+        'by' => 'All DB-related classes',
+        'memo' => 'Required for MySQL database.',
+    ),
+    array(
+        'name' => 'PDO PostgreSQL extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('pdo_pgsql'),
+        'by' => 'All DB-related classes',
+        'memo' => 'Required for PostgreSQL database.',
+    ),
+    array(
+        'name' => 'Memcache extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('memcache') || extension_loaded('memcached'),
+        'by' => '<a href="http://www.yiiframework.com/doc-2.0/yii-caching-memcache.html">MemCache</a>',
+        'memo' => extension_loaded('memcached') ? 'To use memcached set <a href="http://www.yiiframework.com/doc-2.0/yii-caching-memcache.html#$useMemcached-detail">MemCache::useMemcached</a> to <code>true</code>.' : ''
+    ),
+    array(
+        'name' => 'APC extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('apc'),
+        'by' => '<a href="http://www.yiiframework.com/doc-2.0/yii-caching-apccache.html">ApcCache</a>',
+    ),
+    array(
+        'name' => 'GD PHP extension with FreeType support',
+        'mandatory' => false,
+        'condition' => $gdOK,
+        'by' => '<a href="http://www.yiiframework.com/doc-2.0/yii-captcha-captcha.html">Captcha</a>',
+        'memo' => $gdMemo,
+    ),
+    array(
+        'name' => 'ImageMagick PHP extension with PNG support',
+        'mandatory' => false,
+        'condition' => $imagickOK,
+        'by' => '<a href="http://www.yiiframework.com/doc-2.0/yii-captcha-captcha.html">Captcha</a>',
+        'memo' => $imagickMemo,
+    ),
+    'phpExposePhp' => array(
+        'name' => 'Expose PHP',
+        'mandatory' => false,
+        'condition' => $requirementsChecker->checkPhpIniOff("expose_php"),
+        'by' => 'Security reasons',
+        'memo' => '"expose_php" should be disabled at php.ini',
+    ),
+    'phpAllowUrlInclude' => array(
+        'name' => 'PHP allow url include',
+        'mandatory' => false,
+        'condition' => $requirementsChecker->checkPhpIniOff("allow_url_include"),
+        'by' => 'Security reasons',
+        'memo' => '"allow_url_include" should be disabled at php.ini',
+    ),
+    'phpSmtp' => array(
+        'name' => 'PHP mail SMTP',
+        'mandatory' => false,
+        'condition' => strlen(ini_get('SMTP')) > 0,
+        'by' => 'Email sending',
+        'memo' => 'PHP mail SMTP server required',
+    ),
+);
+$requirementsChecker->checkYii()->check($requirements)->render();

--- a//dev/null
+++ b/apps/basic/assets/AppAsset.php
@@ -0,0 +1,26 @@
+<?php
+/**
+ * @link http://www.yiiframework.com/
+ * @copyright Copyright (c) 2008 Yii Software LLC
+ * @license http://www.yiiframework.com/license/
+ */
+namespace app\assets;
+use yii\web\AssetBundle;
+/**
+ * @author Qiang Xue <qiang.xue@gmail.com>
+ * @since 2.0
+ */
+class AppAsset extends AssetBundle
+{
+    public $basePath = '@webroot';
+    public $baseUrl = '@web';
+    public $css = [
+        'css/site.css',
+    ];
+    public $js = [
+    ];
+    public $depends = [
+        'yii\web\YiiAsset',
+        'yii\bootstrap\BootstrapAsset',
+    ];
+}

--- a//dev/null
+++ b/apps/basic/commands/HelloController.php
@@ -0,0 +1,27 @@
+<?php
+/**
+ * @link http://www.yiiframework.com/
+ * @copyright Copyright (c) 2008 Yii Software LLC
+ * @license http://www.yiiframework.com/license/
+ */
+namespace app\commands;
+use yii\console\Controller;
+/**
+ * This command echoes the first argument that you have entered.
+ *
+ * This command is provided as an example for you to learn how to create console commands.
+ *
+ * @author Qiang Xue <qiang.xue@gmail.com>
+ * @since 2.0
+ */
+class HelloController extends Controller
+{
+    /**
+     * This command echoes what you have entered as the message.
+     * @param string $message the message to be echoed.
+     */
+    public function actionIndex($message = 'hello world')
+    {
+        echo $message . "\n";
+    }
+}

--- a//dev/null
+++ b/apps/basic/config/console.php
@@ -0,0 +1,28 @@
+<?php
+Yii::setAlias('@tests', dirname(__DIR__) . '/tests');
+$params = require(__DIR__ . '/params.php');
+$db = require(__DIR__ . '/db.php');
+return [
+    'id' => 'basic-console',
+    'basePath' => dirname(__DIR__),
+    'bootstrap' => ['log', 'gii'],
+    'controllerNamespace' => 'app\commands',
+    'modules' => [
+        'gii' => 'yii\gii\Module',
+    ],
+    'components' => [
+        'cache' => [
+            'class' => 'yii\caching\FileCache',
+        ],
+        'log' => [
+            'targets' => [
+                [
+                    'class' => 'yii\log\FileTarget',
+                    'levels' => ['error', 'warning'],
+                ],
+            ],
+        ],
+        'db' => $db,
+    ],
+    'params' => $params,
+];

--- a//dev/null
+++ b/apps/basic/config/db.php
@@ -0,0 +1,8 @@
+<?php
+return [
+    'class' => 'yii\db\Connection',
+    'dsn' => 'mysql:host=localhost;dbname=yii2basic',
+    'username' => 'root',
+    'password' => '',
+    'charset' => 'utf8',
+];

--- a//dev/null
+++ b/apps/basic/config/params.php
@@ -0,0 +1,4 @@
+<?php
+return [
+    'adminEmail' => 'admin@example.com',
+];

--- a//dev/null
+++ b/apps/basic/config/web.php
@@ -0,0 +1,44 @@
+<?php
+$params = require(__DIR__ . '/params.php');
+$config = [
+    'id' => 'basic',
+    'basePath' => dirname(__DIR__),
+    'bootstrap' => ['log'],
+    'components' => [
+        'request' => [
+            'cookieValidationKey' => '',
+        ],
+        'cache' => [
+            'class' => 'yii\caching\FileCache',
+        ],
+        'user' => [
+            'identityClass' => 'app\models\User',
+            'enableAutoLogin' => true,
+        ],
+        'errorHandler' => [
+            'errorAction' => 'site/error',
+        ],
+        'mailer' => [
+            'class' => 'yii\swiftmailer\Mailer',
+            'useFileTransport' => true,
+        ],
+        'log' => [
+            'traceLevel' => YII_DEBUG ? 3 : 0,
+            'targets' => [
+                [
+                    'class' => 'yii\log\FileTarget',
+                    'levels' => ['error', 'warning'],
+                ],
+            ],
+        ],
+        'db' => require(__DIR__ . '/db.php'),
+    ],
+    'params' => $params,
+];
+if (YII_ENV_DEV) {
+    $config['bootstrap'][] = 'debug';
+    $config['modules']['debug'] = 'yii\debug\Module';
+    $config['bootstrap'][] = 'gii';
+    $config['modules']['gii'] = 'yii\gii\Module';
+}
+return $config;

--- a//dev/null
+++ b/apps/basic/controllers/SiteController.php
@@ -0,0 +1,84 @@
+<?php
+namespace app\controllers;
+use Yii;
+use yii\filters\AccessControl;
+use yii\web\Controller;
+use yii\filters\VerbFilter;
+use app\models\LoginForm;
+use app\models\ContactForm;
+class SiteController extends Controller
+{
+    public function behaviors()
+    {
+        return [
+            'access' => [
+                'class' => AccessControl::className(),
+                'only' => ['logout'],
+                'rules' => [
+                    [
+                        'actions' => ['logout'],
+                        'allow' => true,
+                        'roles' => ['@'],
+                    ],
+                ],
+            ],
+            'verbs' => [
+                'class' => VerbFilter::className(),
+                'actions' => [
+                    'logout' => ['post'],
+                ],
+            ],
+        ];
+    }
+    public function actions()
+    {
+        return [
+            'error' => [
+                'class' => 'yii\web\ErrorAction',
+            ],
+            'captcha' => [
+                'class' => 'yii\captcha\CaptchaAction',
+                'fixedVerifyCode' => YII_ENV_TEST ? 'testme' : null,
+            ],
+        ];
+    }
+    public function actionIndex()
+    {
+        return $this->render('index');
+    }
+    public function actionLogin()
+    {
+        if (!\Yii::$app->user->isGuest) {
+            return $this->goHome();
+        }
+        $model = new LoginForm();
+        if ($model->load(Yii::$app->request->post()) && $model->login()) {
+            return $this->goBack();
+        } else {
+            return $this->render('login', [
+                'model' => $model,
+            ]);
+        }
+    }
+    public function actionLogout()
+    {
+        Yii::$app->user->logout();
+        return $this->goHome();
+    }
+    public function actionContact()
+    {
+        $model = new ContactForm();
+        if ($model->load(Yii::$app->request->post()) && $model->contact(Yii::$app->params['adminEmail'])) {
+            Yii::$app->session->setFlash('contactFormSubmitted');
+            return $this->refresh();
+        } else {
+            return $this->render('contact', [
+                'model' => $model,
+            ]);
+        }
+    }
+    public function actionAbout()
+    {
+        return $this->render('about');
+    }
+}

--- a//dev/null
+++ b/apps/basic/mail/layouts/html.php
@@ -0,0 +1,21 @@
+<?php
+use yii\helpers\Html;
+/* @var $this \yii\web\View view component instance */
+/* @var $message \yii\mail\MessageInterface the message being composed */
+/* @var $content string main view render result */
+?>
+<?php $this->beginPage() ?>
+<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
+<html xmlns="http://www.w3.org/1999/xhtml">
+<head>
+    <meta http-equiv="Content-Type" content="text/html; charset=<?= Yii::$app->charset ?>" />
+    <title><?= Html::encode($this->title) ?></title>
+    <?php $this->head() ?>
+</head>
+<body>
+    <?php $this->beginBody() ?>
+    <?= $content ?>
+    <?php $this->endBody() ?>
+</body>
+</html>
+<?php $this->endPage() ?>

--- a//dev/null
+++ b/apps/basic/models/ContactForm.php
@@ -0,0 +1,54 @@
+<?php
+namespace app\models;
+use Yii;
+use yii\base\Model;
+/**
+ * ContactForm is the model behind the contact form.
+ */
+class ContactForm extends Model
+{
+    public $name;
+    public $email;
+    public $subject;
+    public $body;
+    public $verifyCode;
+    /**
+     * @return array the validation rules.
+     */
+    public function rules()
+    {
+        return [
+            [['name', 'email', 'subject', 'body'], 'required'],
+            ['email', 'email'],
+            ['verifyCode', 'captcha'],
+        ];
+    }
+    /**
+     * @return array customized attribute labels
+     */
+    public function attributeLabels()
+    {
+        return [
+            'verifyCode' => 'Verification Code',
+        ];
+    }
+    /**
+     * Sends an email to the specified email address using the information collected by this model.
+     * @param  string  $email the target email address
+     * @return boolean whether the model passes validation
+     */
+    public function contact($email)
+    {
+        if ($this->validate()) {
+            Yii::$app->mailer->compose()
+                ->setTo($email)
+                ->setFrom([$this->email => $this->name])
+                ->setSubject($this->subject)
+                ->setTextBody($this->body)
+                ->send();
+            return true;
+        } else {
+            return false;
+        }
+    }
+}

--- a//dev/null
+++ b/apps/basic/models/LoginForm.php
@@ -0,0 +1,65 @@
+<?php
+namespace app\models;
+use Yii;
+use yii\base\Model;
+/**
+ * LoginForm is the model behind the login form.
+ */
+class LoginForm extends Model
+{
+    public $username;
+    public $password;
+    public $rememberMe = true;
+    private $_user = false;
+    /**
+     * @return array the validation rules.
+     */
+    public function rules()
+    {
+        return [
+            [['username', 'password'], 'required'],
+            ['rememberMe', 'boolean'],
+            ['password', 'validatePassword'],
+        ];
+    }
+    /**
+     * Validates the password.
+     * This method serves as the inline validation for password.
+     *
+     * @param string $attribute the attribute currently being validated
+     * @param array $params the additional name-value pairs given in the rule
+     */
+    public function validatePassword($attribute, $params)
+    {
+        if (!$this->hasErrors()) {
+            $user = $this->getUser();
+            if (!$user || !$user->validatePassword($this->password)) {
+                $this->addError($attribute, 'Incorrect username or password.');
+            }
+        }
+    }
+    /**
+     * Logs in a user using the provided username and password.
+     * @return boolean whether the user is logged in successfully
+     */
+    public function login()
+    {
+        if ($this->validate()) {
+            return Yii::$app->user->login($this->getUser(), $this->rememberMe ? 3600*24*30 : 0);
+        } else {
+            return false;
+        }
+    }
+    /**
+     * Finds user by [[username]]
+     *
+     * @return User|null
+     */
+    public function getUser()
+    {
+        if ($this->_user === false) {
+            $this->_user = User::findByUsername($this->username);
+        }
+        return $this->_user;
+    }
+}

--- a//dev/null
+++ b/apps/basic/models/User.php
@@ -0,0 +1,91 @@
+<?php
+namespace app\models;
+class User extends \yii\base\Object implements \yii\web\IdentityInterface
+{
+    public $id;
+    public $username;
+    public $password;
+    public $authKey;
+    public $accessToken;
+    private static $users = [
+        '100' => [
+            'id' => '100',
+            'username' => 'admin',
+            'password' => 'admin',
+            'authKey' => 'test100key',
+            'accessToken' => '100-token',
+        ],
+        '101' => [
+            'id' => '101',
+            'username' => 'demo',
+            'password' => 'demo',
+            'authKey' => 'test101key',
+            'accessToken' => '101-token',
+        ],
+    ];
+    /**
+     * @inheritdoc
+     */
+    public static function findIdentity($id)
+    {
+        return isset(self::$users[$id]) ? new static(self::$users[$id]) : null;
+    }
+    /**
+     * @inheritdoc
+     */
+    public static function findIdentityByAccessToken($token, $type = null)
+    {
+        foreach (self::$users as $user) {
+            if ($user['accessToken'] === $token) {
+                return new static($user);
+            }
+        }
+        return null;
+    }
+    /**
+     * Finds user by username
+     *
+     * @param  string      $username
+     * @return static|null
+     */
+    public static function findByUsername($username)
+    {
+        foreach (self::$users as $user) {
+            if (strcasecmp($user['username'], $username) === 0) {
+                return new static($user);
+            }
+        }
+        return null;
+    }
+    /**
+     * @inheritdoc
+     */
+    public function getId()
+    {
+        return $this->id;
+    }
+    /**
+     * @inheritdoc
+     */
+    public function getAuthKey()
+    {
+        return $this->authKey;
+    }
+    /**
+     * @inheritdoc
+     */
+    public function validateAuthKey($authKey)
+    {
+        return $this->authKey === $authKey;
+    }
+    /**
+     * Validates password
+     *
+     * @param  string  $password password to validate
+     * @return boolean if password provided is valid for current user
+     */
+    public function validatePassword($password)
+    {
+        return $this->password === $password;
+    }
+}

--- a//dev/null
+++ b/apps/basic/requirements.php
@@ -0,0 +1,120 @@
+<?php
+/**
+ * Application requirement checker script.
+ *
+ * In order to run this script use the following console command:
+ * php requirements.php
+ *
+ * In order to run this script from the web, you should copy it to the web root.
+ * If you are using Linux you can create a hard link instead, using the following command:
+ * ln requirements.php ../requirements.php
+ */
+$frameworkPath = dirname(__FILE__) . '/vendor/yiisoft/yii2';
+if (!is_dir($frameworkPath)) {
+    echo '<h1>Error</h1>';
+    echo '<p><strong>The path to yii framework seems to be incorrect.</strong></p>';
+    echo '<p>You need to install Yii framework via composer or adjust the framework path in file <abbr title="' . __FILE__ . '">' . basename(__FILE__) . '</abbr>.</p>';
+    echo '<p>Please refer to the <abbr title="' . dirname(__FILE__) . '/README.md">README</abbr> on how to install Yii.</p>';
+}
+require_once($frameworkPath . '/requirements/YiiRequirementChecker.php');
+$requirementsChecker = new YiiRequirementChecker();
+$gdMemo = $imagickMemo = 'Either GD PHP extension with FreeType support or ImageMagick PHP extension with PNG support is required for image CAPTCHA.';
+$gdOK = $imagickOK = false;
+if (extension_loaded('imagick')) {
+    $imagick = new Imagick();
+    $imagickFormats = $imagick->queryFormats('PNG');
+    if (in_array('PNG', $imagickFormats)) {
+        $imagickOK = true;
+    } else {
+        $imagickMemo = 'Imagick extension should be installed with PNG support in order to be used for image CAPTCHA.';
+    }
+}
+if (extension_loaded('gd')) {
+    $gdInfo = gd_info();
+    if (!empty($gdInfo['FreeType Support'])) {
+        $gdOK = true;
+    } else {
+        $gdMemo = 'GD extension should be installed with FreeType support in order to be used for image CAPTCHA.';
+    }
+}
+/**
+ * Adjust requirements according to your application specifics.
+ */
+$requirements = array(
+    array(
+        'name' => 'PDO extension',
+        'mandatory' => true,
+        'condition' => extension_loaded('pdo'),
+        'by' => 'All DB-related classes',
+    ),
+    array(
+        'name' => 'PDO SQLite extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('pdo_sqlite'),
+        'by' => 'All DB-related classes',
+        'memo' => 'Required for SQLite database.',
+    ),
+    array(
+        'name' => 'PDO MySQL extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('pdo_mysql'),
+        'by' => 'All DB-related classes',
+        'memo' => 'Required for MySQL database.',
+    ),
+    array(
+        'name' => 'PDO PostgreSQL extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('pdo_pgsql'),
+        'by' => 'All DB-related classes',
+        'memo' => 'Required for PostgreSQL database.',
+    ),
+    array(
+        'name' => 'Memcache extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('memcache') || extension_loaded('memcached'),
+        'by' => '<a href="http://www.yiiframework.com/doc-2.0/yii-caching-memcache.html">MemCache</a>',
+        'memo' => extension_loaded('memcached') ? 'To use memcached set <a href="http://www.yiiframework.com/doc-2.0/yii-caching-memcache.html#$useMemcached-detail">MemCache::useMemcached</a> to <code>true</code>.' : ''
+    ),
+    array(
+        'name' => 'APC extension',
+        'mandatory' => false,
+        'condition' => extension_loaded('apc'),
+        'by' => '<a href="http://www.yiiframework.com/doc-2.0/yii-caching-apccache.html">ApcCache</a>',
+    ),
+    array(
+        'name' => 'GD PHP extension with FreeType support',
+        'mandatory' => false,
+        'condition' => $gdOK,
+        'by' => '<a href="http://www.yiiframework.com/doc-2.0/yii-captcha-captcha.html">Captcha</a>',
+        'memo' => $gdMemo,
+    ),
+    array(
+        'name' => 'ImageMagick PHP extension with PNG support',
+        'mandatory' => false,
+        'condition' => $imagickOK,
+        'by' => '<a href="http://www.yiiframework.com/doc-2.0/yii-captcha-captcha.html">Captcha</a>',
+        'memo' => $imagickMemo,
+    ),
+    'phpExposePhp' => array(
+        'name' => 'Expose PHP',
+        'mandatory' => false,
+        'condition' => $requirementsChecker->checkPhpIniOff("expose_php"),
+        'by' => 'Security reasons',
+        'memo' => '"expose_php" should be disabled at php.ini',
+    ),
+    'phpAllowUrlInclude' => array(
+        'name' => 'PHP allow url include',
+        'mandatory' => false,
+        'condition' => $requirementsChecker->checkPhpIniOff("allow_url_include"),
+        'by' => 'Security reasons',
+        'memo' => '"allow_url_include" should be disabled at php.ini',
+    ),
+    'phpSmtp' => array(
+        'name' => 'PHP mail SMTP',
+        'mandatory' => false,
+        'condition' => strlen(ini_get('SMTP'))>0,
+        'by' => 'Email sending',
+        'memo' => 'PHP mail SMTP server required',
+    ),
+);
+$requirementsChecker->checkYii()->check($requirements)->render();

--- a//dev/null
+++ b/apps/basic/views/layouts/main.php
@@ -0,0 +1,63 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\Nav;
+use yii\bootstrap\NavBar;
+use yii\widgets\Breadcrumbs;
+use app\assets\AppAsset;
+/* @var $this \yii\web\View */
+/* @var $content string */
+AppAsset::register($this);
+?>
+<?php $this->beginPage() ?>
+<!DOCTYPE html>
+<html lang="<?= Yii::$app->language ?>">
+<head>
+    <meta charset="<?= Yii::$app->charset ?>">
+    <meta name="viewport" content="width=device-width, initial-scale=1">
+    <?= Html::csrfMetaTags() ?>
+    <title><?= Html::encode($this->title) ?></title>
+    <?php $this->head() ?>
+</head>
+<body>
+<?php $this->beginBody() ?>
+    <div class="wrap">
+        <?php
+            NavBar::begin([
+                'brandLabel' => 'My Company',
+                'brandUrl' => Yii::$app->homeUrl,
+                'options' => [
+                    'class' => 'navbar-inverse navbar-fixed-top',
+                ],
+            ]);
+            echo Nav::widget([
+                'options' => ['class' => 'navbar-nav navbar-right'],
+                'items' => [
+                    ['label' => 'Home', 'url' => ['/site/index']],
+                    ['label' => 'About', 'url' => ['/site/about']],
+                    ['label' => 'Contact', 'url' => ['/site/contact']],
+                    Yii::$app->user->isGuest ?
+                        ['label' => 'Login', 'url' => ['/site/login']] :
+                        ['label' => 'Logout (' . Yii::$app->user->identity->username . ')',
+                            'url' => ['/site/logout'],
+                            'linkOptions' => ['data-method' => 'post']],
+                ],
+            ]);
+            NavBar::end();
+        ?>
+        <div class="container">
+            <?= Breadcrumbs::widget([
+                'links' => isset($this->params['breadcrumbs']) ? $this->params['breadcrumbs'] : [],
+            ]) ?>
+            <?= $content ?>
+        </div>
+    </div>
+    <footer class="footer">
+        <div class="container">
+            <p class="pull-left">&copy; My Company <?= date('Y') ?></p>
+            <p class="pull-right"><?= Yii::powered() ?></p>
+        </div>
+    </footer>
+<?php $this->endBody() ?>
+</body>
+</html>
+<?php $this->endPage() ?>

--- a//dev/null
+++ b/apps/basic/views/site/about.php
@@ -0,0 +1,13 @@
+<?php
+use yii\helpers\Html;
+/* @var $this yii\web\View */
+$this->title = 'About';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-about">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>
+        This is the About page. You may modify the following file to customize its content:
+    </p>
+    <code><?= __FILE__ ?></code>
+</div>

--- a//dev/null
+++ b/apps/basic/views/site/contact.php
@@ -0,0 +1,48 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\ActiveForm;
+use yii\captcha\Captcha;
+/* @var $this yii\web\View */
+/* @var $form yii\bootstrap\ActiveForm */
+/* @var $model app\models\ContactForm */
+$this->title = 'Contact';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-contact">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <?php if (Yii::$app->session->hasFlash('contactFormSubmitted')): ?>
+    <div class="alert alert-success">
+        Thank you for contacting us. We will respond to you as soon as possible.
+    </div>
+    <p>
+        Note that if you turn on the Yii debugger, you should be able
+        to view the mail message on the mail panel of the debugger.
+        <?php if (Yii::$app->mailer->useFileTransport): ?>
+        Because the application is in development mode, the email is not sent but saved as
+        a file under <code><?= Yii::getAlias(Yii::$app->mailer->fileTransportPath) ?></code>.
+        Please configure the <code>useFileTransport</code> property of the <code>mail</code>
+        application component to be false to enable email sending.
+        <?php endif; ?>
+    </p>
+    <?php else: ?>
+    <p>
+        If you have business inquiries or other questions, please fill out the following form to contact us. Thank you.
+    </p>
+    <div class="row">
+        <div class="col-lg-5">
+            <?php $form = ActiveForm::begin(['id' => 'contact-form']); ?>
+                <?= $form->field($model, 'name') ?>
+                <?= $form->field($model, 'email') ?>
+                <?= $form->field($model, 'subject') ?>
+                <?= $form->field($model, 'body')->textArea(['rows' => 6]) ?>
+                <?= $form->field($model, 'verifyCode')->widget(Captcha::className(), [
+                    'template' => '<div class="row"><div class="col-lg-3">{image}</div><div class="col-lg-6">{input}</div></div>',
+                ]) ?>
+                <div class="form-group">
+                    <?= Html::submitButton('Submit', ['class' => 'btn btn-primary', 'name' => 'contact-button']) ?>
+                </div>
+            <?php ActiveForm::end(); ?>
+        </div>
+    </div>
+    <?php endif; ?>
+</div>

--- a//dev/null
+++ b/apps/basic/views/site/error.php
@@ -0,0 +1,20 @@
+<?php
+use yii\helpers\Html;
+/* @var $this yii\web\View */
+/* @var $name string */
+/* @var $message string */
+/* @var $exception Exception */
+$this->title = $name;
+?>
+<div class="site-error">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <div class="alert alert-danger">
+        <?= nl2br(Html::encode($message)) ?>
+    </div>
+    <p>
+        The above error occurred while the Web server was processing your request.
+    </p>
+    <p>
+        Please contact us if you think this is a server error. Thank you.
+    </p>
+</div>

--- a//dev/null
+++ b/apps/basic/views/site/index.php
@@ -0,0 +1,39 @@
+<?php
+/* @var $this yii\web\View */
+$this->title = 'My Yii Application';
+?>
+<div class="site-index">
+    <div class="jumbotron">
+        <h1>Congratulations!</h1>
+        <p class="lead">You have successfully created your Yii-powered application.</p>
+        <p><a class="btn btn-lg btn-success" href="http://www.yiiframework.com">Get started with Yii</a></p>
+    </div>
+    <div class="body-content">
+        <div class="row">
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/doc/">Yii Documentation &raquo;</a></p>
+            </div>
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/forum/">Yii Forum &raquo;</a></p>
+            </div>
+            <div class="col-lg-4">
+                <h2>Heading</h2>
+                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
+                    dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip
+                    ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
+                    fugiat nulla pariatur.</p>
+                <p><a class="btn btn-default" href="http://www.yiiframework.com/extensions/">Yii Extensions &raquo;</a></p>
+            </div>
+        </div>
+    </div>
+</div>

--- a//dev/null
+++ b/apps/basic/views/site/login.php
@@ -0,0 +1,36 @@
+<?php
+use yii\helpers\Html;
+use yii\bootstrap\ActiveForm;
+/* @var $this yii\web\View */
+/* @var $form yii\bootstrap\ActiveForm */
+/* @var $model app\models\LoginForm */
+$this->title = 'Login';
+$this->params['breadcrumbs'][] = $this->title;
+?>
+<div class="site-login">
+    <h1><?= Html::encode($this->title) ?></h1>
+    <p>Please fill out the following fields to login:</p>
+    <?php $form = ActiveForm::begin([
+        'id' => 'login-form',
+        'options' => ['class' => 'form-horizontal'],
+        'fieldConfig' => [
+            'template' => "{label}\n<div class=\"col-lg-3\">{input}</div>\n<div class=\"col-lg-8\">{error}</div>",
+            'labelOptions' => ['class' => 'col-lg-1 control-label'],
+        ],
+    ]); ?>
+    <?= $form->field($model, 'username') ?>
+    <?= $form->field($model, 'password')->passwordInput() ?>
+    <?= $form->field($model, 'rememberMe', [
+        'template' => "<div class=\"col-lg-offset-1 col-lg-3\">{input}</div>\n<div class=\"col-lg-8\">{error}</div>",
+    ])->checkbox() ?>
+    <div class="form-group">
+        <div class="col-lg-offset-1 col-lg-11">
+            <?= Html::submitButton('Login', ['class' => 'btn btn-primary', 'name' => 'login-button']) ?>
+        </div>
+    </div>
+    <?php ActiveForm::end(); ?>
+    <div class="col-lg-offset-1" style="color:#999;">
+        You may login with <strong>admin/admin</strong> or <strong>demo/demo</strong>.<br>
+        To modify the username/password, please check out the code <code>app\models\User::$users</code>.
+    </div>
+</div>

--- a//dev/null
+++ b/apps/basic/web/index.php
@@ -0,0 +1,7 @@
+<?php
+defined('YII_DEBUG') or define('YII_DEBUG', true);
+defined('YII_ENV') or define('YII_ENV', 'dev');
+require(__DIR__ . '/../vendor/autoload.php');
+require(__DIR__ . '/../vendor/yiisoft/yii2/Yii.php');
+$config = require(__DIR__ . '/../config/web.php');
+(new yii\web\Application($config))->run();

--- a//dev/null
+++ b/apps/benchmark/index.php
@@ -0,0 +1,14 @@
+<?php
+defined('YII_DEBUG') or define('YII_DEBUG', false);
+require(__DIR__ . '/protected/vendor/yiisoft/yii2/Yii.php');
+$config = [
+    'id' => 'benchmark',
+    'basePath' => __DIR__ . '/protected',
+    'components' => [
+        'urlManager' => [
+            'enablePrettyUrl' => true,
+        ],
+    ],
+];
+$application = new yii\web\Application($config);
+$application->run();

--- a//dev/null
+++ b/apps/benchmark/protected/controllers/SiteController.php
@@ -0,0 +1,11 @@
+<?php
+namespace app\controllers;
+use yii\web\Controller;
+class SiteController extends Controller
+{
+    public $defaultAction = 'hello';
+    public function actionHello()
+    {
+        return 'hello world';
+    }
+}

--- a//dev/null
+++ b/build/controllers/AppController.php
@@ -0,0 +1,108 @@
+<?php
+/**
+ * @link http://www.yiiframework.com/
+ * @copyright Copyright (c) 2008 Yii Software LLC
+ * @license http://www.yiiframework.com/license/
+ */
+namespace yii\build\controllers;
+use Yii;
+use yii\console\Controller;
+use yii\helpers\FileHelper;
+/**
+ * AppController will link the yii2 dev installation to the containted applications vendor dirs
+ * to help working on yii using the application to test it.
+ *
+ * @author Carsten Brandt <mail@cebe.cc>
+ * @since 2.0
+ */
+class AppController extends Controller
+{
+    public $defaultAction = 'link';
+    /**
+     * Properly removes symlinked directory under Windows, MacOS and Linux
+     *
+     * @param string $file path to symlink
+     */
+    protected function unlink($file)
+    {
+        if (is_dir($file) && DIRECTORY_SEPARATOR === '\\') {
+            rmdir($file);
+        } else {
+            unlink($file);
+        }
+    }
+    /**
+     * This command runs the following shell commands in the dev repo root:
+     *
+     * - Run `composer update`
+     * - `rm -rf apps/basic/vendor/yiisoft/yii2`
+     * - `rm -rf apps/basic/vendor/yiisoft/yii2-*`
+     *
+     * And replaces them with symbolic links to the extensions and framework path in the dev repo.
+     * @param string $app the application name `basic` or `advanced`.
+     */
+    public function actionLink($app)
+    {
+        $base = dirname(dirname(__DIR__));
+        $appDir = "$base/apps/$app";
+        if (is_link($link = "$appDir/vendor/yiisoft/yii2")) {
+            $this->stdout("Removing symlink $link.\n");
+            $this->unlink($link);
+        }
+        $extensions = $this->findDirs("$appDir/vendor/yiisoft");
+        foreach($extensions as $ext) {
+            if (is_link($link = "$appDir/vendor/yiisoft/yii2-$ext")) {
+                $this->stdout("Removing symlink $link.\n");
+                $this->unlink($link);
+            }
+        }
+        chdir($appDir);
+        passthru('composer update --prefer-dist');
+        if (is_dir($link = "$appDir/vendor/yiisoft/yii2")) {
+            $this->stdout("Removing dir $link.\n");
+            FileHelper::removeDirectory($link);
+            $this->stdout("Creating symlink for $link.\n");
+            symlink("$base/framework", $link);
+        }
+        $extensions = $this->findDirs("$appDir/vendor/yiisoft");
+        foreach($extensions as $ext) {
+            if (is_dir($link = "$appDir/vendor/yiisoft/yii2-$ext")) {
+                $this->stdout("Removing dir $link.\n");
+                FileHelper::removeDirectory($link);
+                $this->stdout("Creating symlink for $link.\n");
+                symlink("$base/extensions/$ext", $link);
+            }
+        }
+        $this->stdout("done.\n");
+    }
+    /**
+     * Finds linkable applications
+     *
+     * @param string $dir directory to search in
+     * @return array list of applications command can link
+     */
+    protected function findDirs($dir)
+    {
+        $list = [];
+        $handle = @opendir($dir);
+        if ($handle === false) {
+            return [];
+        }
+        while (($file = readdir($handle)) !== false) {
+            if ($file === '.' || $file === '..') {
+                continue;
+            }
+            $path = $dir . DIRECTORY_SEPARATOR . $file;
+            if (is_dir($path) && preg_match('/^yii2-(.*)$/', $file, $matches)) {
+                $list[] = $matches[1];
+            }
+        }
+        closedir($handle);
+        foreach($list as $i => $e) {
+            if ($e == 'composer') { // skip composer to not break composer update
+                unset($list[$i]);
+            }
+        }
+        return $list;
+    }
+}

--- a/build/controllers/DevController.php
+++ b//dev/null
@@ -1,280 +0,0 @@
-<?php
-/**
- * @link http://www.yiiframework.com/
- * @copyright Copyright (c) 2008 Yii Software LLC
- * @license http://www.yiiframework.com/license/
- */
-namespace yii\build\controllers;
-use Yii;
-use yii\base\InvalidParamException;
-use yii\console\Controller;
-use yii\helpers\Console;
-use yii\helpers\FileHelper;
-/**
- * This command helps to set up a dev environment with all extensions and applications
- *
- * It will clone an extension or app repo and link the yii2 dev installation to the containted applications/extensions vendor dirs
- * to help working on yii using the application to test it.
- *
- * @author Carsten Brandt <mail@cebe.cc>
- * @since 2.0
- */
-class DevController extends Controller
-{
-    public $defaultAction = 'all';
-    public $apps = [
-        'basic' => 'git@github.com:yiisoft/yii2-app-basic.git',
-        'advanced' => 'git@github.com:yiisoft/yii2-app-advanced.git',
-        'benchmark' => 'git@github.com:yiisoft/yii2-app-benchmark.git',
-    ];
-    public $extensions = [
-        'apidoc' => 'git@github.com:yiisoft/yii2-apidoc.git',
-        'authclient' => 'git@github.com:yiisoft/yii2-authclient.git',
-        'bootstrap' => 'git@github.com:yiisoft/yii2-bootstrap.git',
-        'codeception' => 'git@github.com:yiisoft/yii2-codeception.git',
-        'composer' => 'git@github.com:yiisoft/yii2-composer.git',
-        'debug' => 'git@github.com:yiisoft/yii2-debug.git',
-        'elasticsearch' => 'git@github.com:yiisoft/yii2-elasticsearch.git',
-        'faker' => 'git@github.com:yiisoft/yii2-faker.git',
-        'gii' => 'git@github.com:yiisoft/yii2-gii.git',
-        'imagine' => 'git@github.com:yiisoft/yii2-imagine.git',
-        'jui' => 'git@github.com:yiisoft/yii2-jui.git',
-        'mongodb' => 'git@github.com:yiisoft/yii2-mongodb.git',
-        'redis' => 'git@github.com:yiisoft/yii2-redis.git',
-        'smarty' => 'git@github.com:yiisoft/yii2-smarty.git',
-        'sphinx' => 'git@github.com:yiisoft/yii2-sphinx.git',
-        'swiftmailer' => 'git@github.com:yiisoft/yii2-swiftmailer.git',
-        'twig' => 'git@github.com:yiisoft/yii2-twig.git',
-    ];
-    /**
-     * Install all extensions and advanced + basic app
-     */
-    public function actionAll()
-    {
-        if (!$this->confirm('Install all applications and all extensions now?')) {
-            return 1;
-        }
-        foreach($this->extensions as $ext => $repo) {
-            $ret = $this->actionExt($ext, $repo);
-            if ($ret !== 0) {
-                return $ret;
-            }
-        }
-        foreach($this->apps as $app => $repo) {
-            $ret = $this->actionApp($app, $repo);
-            if ($ret !== 0) {
-                return $ret;
-            }
-        }
-        return 0;
-    }
-    /**
-     * Runs a command in all extension and application directories
-     *
-     * Can be used to run e.g. `git pull`.
-     *
-     *     ./build/build dev/run git pull
-     *
-     * @param string $command the command to run
-     */
-    public function actionRun($command)
-    {
-        $command = implode(' ', func_get_args());
-        $base = dirname(dirname(__DIR__));
-        $dirs = $this->listSubDirs("$base/extensions");
-        $dirs = array_merge($dirs, $this->listSubDirs("$base/apps"));
-        asort($dirs);
-        $oldcwd = getcwd();
-        foreach($dirs as $dir) {
-            $displayDir = substr($dir, strlen($base));
-            $this->stdout("Running '$command' in $displayDir...\n", Console::BOLD);
-            chdir($dir);
-            passthru($command);
-            $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        }
-        chdir($oldcwd);
-    }
-    /**
-     * This command installs a project template in the `apps` directory and links the framework and extensions
-     *
-     * It basically runs the following commands in the dev repo root:
-     *
-     * - Run `composer update`
-     * - `rm -rf apps/basic/vendor/yiisoft/yii2`
-     * - `rm -rf apps/basic/vendor/yiisoft/yii2-*`
-     *
-     * And replaces them with symbolic links to the extensions and framework path in the dev repo.
-     *
-     * Extensions required by the application are automatically installed using the `ext` action.
-     *
-     * @param string $app the application name e.g. `basic` or `advanced`.
-     * @param string $repo url of the git repo to clone if it does not already exist.
-     * @return int return code
-     */
-    public function actionApp($app, $repo = null)
-    {
-        $base = dirname(dirname(__DIR__));
-        $appDir = "$base/apps/$app";
-        if (!file_exists($appDir)) {
-            if (empty($repo)) {
-                if (isset($this->apps[$app])) {
-                    $repo = $this->apps[$app];
-                } else {
-                    $this->stderr("Repo argument is required for app '$app'.\n", Console::FG_RED);
-                    return 1;
-                }
-            }
-            $this->stdout("cloning application repo '$app' from '$repo'...\n", Console::BOLD);
-            passthru('git clone ' . escapeshellarg($repo) . ' ' . $appDir);
-            $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        }
-        $this->stdout("cleaning up application '$app' vendor directory...\n", Console::BOLD);
-        $this->cleanupVendorDir($appDir);
-        $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        $this->stdout("updating composer for app '$app'...\n", Console::BOLD);
-        chdir($appDir);
-        passthru('composer update --prefer-dist');
-        $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        $this->stdout("linking framework and extensions to '$app' app vendor dir...\n", Console::BOLD);
-        $this->linkFrameworkAndExtensions($appDir, $base);
-        $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        return 0;
-    }
-    /**
-     * This command installs an extension in the `extensions` directory and links the framework and other extensions
-     *
-     * @param string $extension the application name e.g. `basic` or `advanced`.
-     * @param string $repo url of the git repo to clone if it does not already exist.
-     */
-    public function actionExt($extension, $repo = null)
-    {
-        $base = dirname(dirname(__DIR__));
-        $extensionDir = "$base/extensions/$extension";
-        if (!file_exists($extensionDir)) {
-            if (empty($repo)) {
-                if (isset($this->extensions[$extension])) {
-                    $repo = $this->extensions[$extension];
-                } else {
-                    $this->stderr("Repo argument is required for extension '$extension'.\n", Console::FG_RED);
-                    return 1;
-                }
-            }
-            $this->stdout("cloning extension repo '$extension' from '$repo'...\n", Console::BOLD);
-            passthru('git clone ' . escapeshellarg($repo) . ' ' . $extensionDir);
-            $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        }
-        $this->stdout("cleaning up extension '$extension' vendor directory...\n", Console::BOLD);
-        $this->cleanupVendorDir($extensionDir);
-        $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        $this->stdout("updating composer for extension '$extension'...\n", Console::BOLD);
-        chdir($extensionDir);
-        passthru('composer update --prefer-dist');
-        $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        $this->stdout("linking framework and extensions to '$extension' vendor dir...\n", Console::BOLD);
-        $this->linkFrameworkAndExtensions($extensionDir, $base);
-        $this->stdout("done.\n", Console::BOLD, Console::FG_GREEN);
-        return 0;
-    }
-    protected function cleanupVendorDir($dir)
-    {
-        if (is_link($link = "$dir/vendor/yiisoft/yii2")) {
-            $this->stdout("Removing symlink $link.\n");
-            $this->unlink($link);
-        }
-        $extensions = $this->findDirs("$dir/vendor/yiisoft");
-        foreach($extensions as $ext) {
-            if (is_link($link = "$dir/vendor/yiisoft/yii2-$ext")) {
-                $this->stdout("Removing symlink $link.\n");
-                $this->unlink($link);
-            }
-        }
-    }
-    protected function linkFrameworkAndExtensions($dir, $base)
-    {
-        if (is_dir($link = "$dir/vendor/yiisoft/yii2")) {
-            $this->stdout("Removing dir $link.\n");
-            FileHelper::removeDirectory($link);
-            $this->stdout("Creating symlink for $link.\n");
-            symlink("$base/framework", $link);
-        }
-        $extensions = $this->findDirs("$dir/vendor/yiisoft");
-        foreach($extensions as $ext) {
-            if (is_dir($link = "$dir/vendor/yiisoft/yii2-$ext")) {
-                $this->stdout("Removing dir $link.\n");
-                FileHelper::removeDirectory($link);
-                $this->stdout("Creating symlink for $link.\n");
-                if (!file_exists("$base/extensions/$ext")) {
-                    $ret = $this->actionExt($ext);
-                    if ($ret !== 0) {
-                        return $ret;
-                    }
-                }
-                symlink("$base/extensions/$ext", $link);
-            }
-        }
-    }
-    /**
-     * Properly removes symlinked directory under Windows, MacOS and Linux
-     *
-     * @param string $file path to symlink
-     */
-    protected function unlink($file)
-    {
-        if (is_dir($file) && DIRECTORY_SEPARATOR === '\\') {
-            rmdir($file);
-        } else {
-            unlink($file);
-        }
-    }
-    protected function listSubDirs($dir)
-    {
-        $list = [];
-        $handle = opendir($dir);
-        if ($handle === false) {
-            throw new InvalidParamException("Unable to open directory: $dir");
-        }
-        while (($file = readdir($handle)) !== false) {
-            if ($file === '.' || $file === '..') {
-                continue;
-            }
-            if ($file[0] === '.') {
-                continue;
-            }
-            if (is_dir("$dir/$file")) {
-                $list[] = "$dir/$file";
-            }
-        }
-        closedir($handle);
-        return $list;
-    }
-    /**
-     * Finds linkable applications
-     *
-     * @param string $dir directory to search in
-     * @return array list of applications command can link
-     */
-    protected function findDirs($dir)
-    {
-        $list = [];
-        $handle = @opendir($dir);
-        if ($handle === false) {
-            return [];
-        }
-        while (($file = readdir($handle)) !== false) {
-            if ($file === '.' || $file === '..') {
-                continue;
-            }
-            $path = $dir . DIRECTORY_SEPARATOR . $file;
-            if (is_dir($path) && preg_match('/^yii2-(.*)$/', $file, $matches)) {
-                $list[] = $matches[1];
-            }
-        }
-        closedir($handle);
-        foreach($list as $i => $e) {
-            if ($e == 'composer') { // skip composer to not break composer update
-                unset($list[$i]);
-            }
-        }
-        return $list;
-    }
-}
