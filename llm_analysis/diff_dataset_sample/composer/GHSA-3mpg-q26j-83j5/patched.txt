# ====================================================================
# FILE: src/CodeFile.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @link http://www.yiiframework.com/
     4|  * @copyright Copyright (c) 2008 Yii Software LLC
     5|  * @license http://www.yiiframework.com/license/
     6|  */
     7| namespace yii\gii;
     8| use Yii;
     9| use yii\base\BaseObject;
    10| use yii\gii\components\DiffRendererHtmlInline;
    11| use yii\helpers\Html;
    12| /**
    13|  * CodeFile represents a code file to be generated.
    14|  *
    15|  * @property-read string $relativePath The code file path relative to the application base path. This property
    16|  * is read-only.
    17|  * @property-read string $type The code file extension (e.g. php, txt). This property is read-only.
    18|  *
    19|  * @author Qiang Xue <qiang.xue@gmail.com>
    20|  * @since 2.0
    21|  */
    22| class CodeFile extends BaseObject
    23| {
    24|     /**
    25|      * The code file is new.
    26|      */
    27|     const OP_CREATE = 'create';
    28|     /**
    29|      * The code file already exists, and the new one may need to overwrite it.
    30|      */
    31|     const OP_OVERWRITE = 'overwrite';
    32|     /**
    33|      * The new code file and the existing one are identical.
    34|      */
    35|     const OP_SKIP = 'skip';
    36|     /**
    37|      * @var string an ID that uniquely identifies this code file.


# ====================================================================
# FILE: src/Generator.php
# Total hunks: 4
# ====================================================================
# --- HUNK 1: Lines 7-50 ---
     7| namespace yii\gii;
     8| use Yii;
     9| use ReflectionClass;
    10| use yii\base\InvalidConfigException;
    11| use yii\base\Model;
    12| use yii\helpers\VarDumper;
    13| use yii\web\View;
    14| /**
    15|  * This is the base class for all generator classes.
    16|  *
    17|  * A generator instance is responsible for taking user inputs, validating them,
    18|  * and using them to generate the corresponding code based on a set of code template files.
    19|  *
    20|  * A generator class typically needs to implement the following methods:
    21|  *
    22|  * - [[getName()]]: returns the name of the generator
    23|  * - [[getDescription()]]: returns the detailed description of the generator
    24|  * - [[generate()]]: generates the code based on the current user input and the specified code template files.
    25|  *   This is the place where main code generation code resides.
    26|  *
    27|  * @property-read string $description The detailed description of the generator. This property is read-only.
    28|  * @property-read string $stickyDataFile The file path that stores the sticky attribute values. This property
    29|  * is read-only.
    30|  * @property-read string $templatePath The root path of the template files that are currently being used. This
    31|  * property is read-only.
    32|  *
    33|  * @author Qiang Xue <qiang.xue@gmail.com>
    34|  * @since 2.0
    35|  */
    36| abstract class Generator extends Model
    37| {
    38|     /**
    39|      * @var array a list of available code templates. The array keys are the template names,
    40|      * and the array values are the corresponding template paths or path aliases.
    41|      */
    42|     public $templates = [];
    43|     /**
    44|      * @var string the name of the code template that the user has selected.
    45|      * The value of this property is internally managed by this class.
    46|      */
    47|     public $template = 'default';
    48|     /**
    49|      * @var bool whether the strings will be generated using `Yii::t()` or normal strings.
    50|      */

# --- HUNK 2: Lines 341-386 ---
   341|     public function validateNewClass($attribute, $params)
   342|     {
   343|         $class = ltrim($this->$attribute, '\\');
   344|         if (($pos = strrpos($class, '\\')) === false) {
   345|             $this->addError($attribute, "The class name must contain fully qualified namespace name.");
   346|         } else {
   347|             $ns = substr($class, 0, $pos);
   348|             $path = Yii::getAlias('@' . str_replace('\\', '/', $ns), false);
   349|             if ($path === false) {
   350|                 $this->addError($attribute, "The class namespace is invalid: $ns");
   351|             } elseif (!is_dir($path)) {
   352|                 $this->addError($attribute, "Please make sure the directory containing this class exists: $path");
   353|             }
   354|         }
   355|     }
   356|     /**
   357|      * Checks if message category is not empty when I18N is enabled.
   358|      */
   359|     public function validateMessageCategory()
   360|     {
   361|         if ($this->enableI18N) {
   362|             if (empty($this->messageCategory)) {
   363|                 $this->addError('messageCategory', "Message Category cannot be blank.");
   364|             } elseif (!preg_match('~\w+~', $this->messageCategory)) {
   365|                 $this->addError('messageCategory', "Message Category is not valid. It should contain only alphanumeric characters and _.");
   366|             }
   367|         }
   368|     }
   369|     /**
   370|      * @param string $value the attribute to be validated
   371|      * @return bool whether the value is a reserved PHP keyword.
   372|      */
   373|     public function isReservedKeyword($value)
   374|     {
   375|         static $keywords = [
   376|             '__class__',
   377|             '__dir__',
   378|             '__file__',
   379|             '__function__',
   380|             '__line__',
   381|             '__method__',
   382|             '__namespace__',
   383|             '__trait__',
   384|             'abstract',
   385|             'and',
   386|             'array',

# --- HUNK 3: Lines 400-476 ---
   400|             'do',
   401|             'echo',
   402|             'else',
   403|             'elseif',
   404|             'empty',
   405|             'enddeclare',
   406|             'endfor',
   407|             'endforeach',
   408|             'endif',
   409|             'endswitch',
   410|             'endwhile',
   411|             'eval',
   412|             'exception',
   413|             'exit',
   414|             'extends',
   415|             'final',
   416|             'finally',
   417|             'for',
   418|             'foreach',
   419|             'function',
   420|             'fn',
   421|             'global',
   422|             'goto',
   423|             'if',
   424|             'implements',
   425|             'include',
   426|             'include_once',
   427|             'instanceof',
   428|             'insteadof',
   429|             'interface',
   430|             'isset',
   431|             'list',
   432|             'namespace',
   433|             'new',
   434|             'old_function',
   435|             'or',
   436|             'parent',
   437|             'php_user_filter',
   438|             'print',
   439|             'private',
   440|             'protected',
   441|             'public',
   442|             'require',
   443|             'require_once',
   444|             'return',
   445|             'static',
   446|             'switch',
   447|             'this',
   448|             'throw',
   449|             'trait',
   450|             'try',
   451|             'unset',
   452|             'use',
   453|             'var',
   454|             'while',
   455|             'xor',
   456|             'yield'
   457|         ];
   458|         return in_array(strtolower($value), $keywords, true);
   459|     }
   460|     /**
   461|      * Generates a string depending on enableI18N property
   462|      *
   463|      * @param string $string the text be generated
   464|      * @param array $placeholders the placeholders to use by `Yii::t()`
   465|      * @return string
   466|      */
   467|     public function generateString($string = '', $placeholders = [])
   468|     {
   469|         $string = addslashes($string);
   470|         if ($this->enableI18N) {
   471|             if (!empty($placeholders)) {
   472|                 $ph = ', ' . VarDumper::export($placeholders);
   473|             } else {
   474|                 $ph = '';
   475|             }
   476|             $str = "Yii::t('" . $this->messageCategory . "', '" . $string . "'" . $ph . ")";


# ====================================================================
# FILE: src/assets/js/gii.js
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 169-230 ---
   169|         if (valueToCopy && (e.ctrlKey || e.metaKey) && (e.which === 67)) {
   170|             return onKeydown(e);
   171|         }
   172|     }).on("keyup", onKeyup);
   173|     return {
   174|         init: function () {
   175|             initStickyInputs();
   176|             initPreviewDiffLinks();
   177|             initConfirmationCheckboxes();
   178|             initToggleActions();
   179|             initFilterRows();
   180|             $('#model-generator #generator-tablename').change(function () {
   181|                 var show = ($(this).val().indexOf('*') === -1);
   182|                 $('.field-generator-modelclass').toggle(show);
   183|                 if ($('#generator-generatequery').is(':checked')) {
   184|                     $('.field-generator-queryclass').toggle(show);
   185|                 }
   186|                 $('.field-generator-caseinsensitive').toggle(!show);
   187|             }).change();
   188|             $('#model-generator #generator-tablename').on('blur', function () {
   189|                 var $this = $(this);
   190|                 var $modelClass = $('#generator-modelclass');
   191|                 var tableName = $this.val();
   192|                 var tablePrefix = $this.data('table-prefix') || '';
   193|                 if (tablePrefix.length) {
   194|                     if (tableName.slice(0, tablePrefix.length) === tablePrefix) {
   195|                         tableName = tableName.slice(tablePrefix.length);
   196|                     }
   197|                 }
   198|                 if ($modelClass.val() === '' && tableName && tableName.indexOf('*') === -1) {
   199|                     ajaxRequest = $.ajax({
   200|                         type: 'POST',
   201|                         cache: false,
   202|                         url: $this.data('action'),
   203|                         data: $('#model-generator').serializeArray(),
   204|                         success: function (response) {
   205|                             $modelClass.val(response).blur();
   206|                         },
   207|                         error: function (XMLHttpRequest, textStatus, errorThrown) {
   208|                             $modal.find('.modal-body').html('<div class="error">' + XMLHttpRequest.responseText + '</div>');
   209|                         }
   210|                     });
   211|                 }
   212|             });
   213|             $('#model-generator #generator-modelclass').on('blur', function () {
   214|                 var modelClass = $(this).val();
   215|                 if (modelClass !== '') {
   216|                     var queryClass = $('#generator-queryclass').val();
   217|                     if (queryClass === '') {
   218|                         queryClass = modelClass + 'Query';
   219|                         $('#generator-queryclass').val(queryClass);
   220|                     }
   221|                 }
   222|             });
   223|             $('#model-generator #generator-ns').on('blur', function () {
   224|                 var stickyValue = $('#model-generator .field-generator-queryns .sticky-value');
   225|                 var input = $('#model-generator #generator-queryns');
   226|                 if (stickyValue.is(':visible') || !input.is(':visible')) {
   227|                     var ns = $(this).val();
   228|                     stickyValue.html(ns);
   229|                     input.val(ns);
   230|                 }


# ====================================================================
# FILE: src/generators/controller/Generator.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @link http://www.yiiframework.com/
     4|  * @copyright Copyright (c) 2008 Yii Software LLC
     5|  * @license http://www.yiiframework.com/license/
     6|  */
     7| namespace yii\gii\generators\controller;
     8| use Yii;
     9| use yii\gii\CodeFile;
    10| use yii\helpers\Html;
    11| use yii\helpers\Inflector;
    12| use yii\helpers\StringHelper;
    13| /**
    14|  * This generator will generate a controller and one or a few action view files.
    15|  *
    16|  * @property-read array $actionIDs An array of action IDs entered by the user. This property is read-only.
    17|  * @property-read string $controllerFile The controller class file path. This property is read-only.
    18|  * @property-read string $controllerID The controller ID. This property is read-only.
    19|  * @property-read string $controllerNamespace The namespace of the controller class. This property is
    20|  * read-only.
    21|  * @property-read string $controllerSubPath The controller sub path. This property is read-only.
    22|  *
    23|  * @author Qiang Xue <qiang.xue@gmail.com>
    24|  * @since 2.0
    25|  */
    26| class Generator extends \yii\gii\Generator
    27| {
    28|     /**
    29|      * @var string the controller class name
    30|      */
    31|     public $controllerClass;
    32|     /**
    33|      * @var string the controller's view path
    34|      */
    35|     public $viewPath;
    36|     /**
    37|      * @var string the base class of the controller
    38|      */
    39|     public $baseClass = 'yii\web\Controller';
    40|     /**
    41|      * @var string list of action IDs separated by commas or spaces


# ====================================================================
# FILE: src/generators/crud/Generator.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /**
     3|  * @link http://www.yiiframework.com/
     4|  * @copyright Copyright (c) 2008 Yii Software LLC
     5|  * @license http://www.yiiframework.com/license/
     6|  */
     7| namespace yii\gii\generators\crud;
     8| use Yii;
     9| use yii\db\ActiveRecord;
    10| use yii\db\BaseActiveRecord;
    11| use yii\db\Schema;
    12| use yii\gii\CodeFile;
    13| use yii\helpers\Inflector;
    14| use yii\helpers\VarDumper;
    15| use yii\web\Controller;
    16| /**
    17|  * Generates CRUD
    18|  *
    19|  * @property-read array $columnNames Model column names. This property is read-only.
    20|  * @property-read string $controllerID The controller ID (without the module ID prefix). This property is
    21|  * read-only.
    22|  * @property-read string $nameAttribute This property is read-only.
    23|  * @property-read array $searchAttributes Searchable attributes. This property is read-only.
    24|  * @property-read bool|\yii\db\TableSchema $tableSchema This property is read-only.
    25|  * @property-read string $viewPath The controller view path. This property is read-only.
    26|  *
    27|  * @author Qiang Xue <qiang.xue@gmail.com>
    28|  * @since 2.0
    29|  */
    30| class Generator extends \yii\gii\Generator
    31| {
    32|     public $modelClass;
    33|     public $controllerClass;
    34|     public $viewPath;
    35|     public $baseControllerClass = 'yii\web\Controller';
    36|     public $indexWidgetType = 'grid';
    37|     public $searchModelClass = '';
    38|     /**
    39|      * @var bool whether to wrap the `GridView` or `ListView` widget with the `yii\widgets\Pjax` widget
    40|      * @since 2.0.5
    41|      */
    42|     public $enablePjax = false;
    43|     /**
    44|      * @var bool whether to use strict inflection for controller IDs (insert a separator between two consecutive uppercase chars)
    45|      * @since 2.1.0


# ====================================================================
# FILE: src/generators/crud/default/controller.php
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 4-150 ---
     4|  */
     5| use yii\db\ActiveRecordInterface;
     6| use yii\helpers\StringHelper;
     7| /* @var $this yii\web\View */
     8| /* @var $generator yii\gii\generators\crud\Generator */
     9| $controllerClass = StringHelper::basename($generator->controllerClass);
    10| $modelClass = StringHelper::basename($generator->modelClass);
    11| $searchModelClass = StringHelper::basename($generator->searchModelClass);
    12| if ($modelClass === $searchModelClass) {
    13|     $searchModelAlias = $searchModelClass . 'Search';
    14| }
    15| /* @var $class ActiveRecordInterface */
    16| $class = $generator->modelClass;
    17| $pks = $class::primaryKey();
    18| $urlParams = $generator->generateUrlParams();
    19| $actionParams = $generator->generateActionParams();
    20| $actionParamComments = $generator->generateActionParamComments();
    21| echo "<?php\n";
    22| ?>
    23| namespace <?= StringHelper::dirname(ltrim($generator->controllerClass, '\\')) ?>;
    24| use <?= ltrim($generator->modelClass, '\\') ?>;
    25| <?php if (!empty($generator->searchModelClass)): ?>
    26| use <?= ltrim($generator->searchModelClass, '\\') . (isset($searchModelAlias) ? " as $searchModelAlias" : "") ?>;
    27| <?php else: ?>
    28| use yii\data\ActiveDataProvider;
    29| <?php endif; ?>
    30| use <?= ltrim($generator->baseControllerClass, '\\') ?>;
    31| use yii\web\NotFoundHttpException;
    32| use yii\filters\VerbFilter;
    33| /**
    34|  * <?= $controllerClass ?> implements the CRUD actions for <?= $modelClass ?> model.
    35|  */
    36| class <?= $controllerClass ?> extends <?= StringHelper::basename($generator->baseControllerClass) . "\n" ?>
    37| {
    38|     /**
    39|      * @inheritDoc
    40|      */
    41|     public function behaviors()
    42|     {
    43|         return array_merge(
    44|             parent::behaviors(),
    45|             [
    46|                 'verbs' => [
    47|                     'class' => VerbFilter::className(),
    48|                     'actions' => [
    49|                         'delete' => ['POST'],
    50|                     ],
    51|                 ],
    52|             ]
    53|         );
    54|     }
    55|     /**
    56|      * Lists all <?= $modelClass ?> models.
    57|      * @return mixed
    58|      */
    59|     public function actionIndex()
    60|     {
    61| <?php if (!empty($generator->searchModelClass)): ?>
    62|         $searchModel = new <?= isset($searchModelAlias) ? $searchModelAlias : $searchModelClass ?>();
    63|         $dataProvider = $searchModel->search($this->request->queryParams);
    64|         return $this->render('index', [
    65|             'searchModel' => $searchModel,
    66|             'dataProvider' => $dataProvider,
    67|         ]);
    68| <?php else: ?>
    69|         $dataProvider = new ActiveDataProvider([
    70|             'query' => <?= $modelClass ?>::find(),
    71|             /*
    72|             'pagination' => [
    73|                 'pageSize' => 50
    74|             ],
    75|             'sort' => [
    76|                 'defaultOrder' => [
    77| <?php foreach ($pks as $pk): ?>
    78|                     <?= "'$pk' => SORT_DESC,\n" ?>
    79| <?php endforeach; ?>
    80|                 ]
    81|             ],
    82|             */
    83|         ]);
    84|         return $this->render('index', [
    85|             'dataProvider' => $dataProvider,
    86|         ]);
    87| <?php endif; ?>
    88|     }
    89|     /**
    90|      * Displays a single <?= $modelClass ?> model.
    91|      * <?= implode("\n     * ", $actionParamComments) . "\n" ?>
    92|      * @return mixed
    93|      * @throws NotFoundHttpException if the model cannot be found
    94|      */
    95|     public function actionView(<?= $actionParams ?>)
    96|     {
    97|         return $this->render('view', [
    98|             'model' => $this->findModel(<?= $actionParams ?>),
    99|         ]);
   100|     }
   101|     /**
   102|      * Creates a new <?= $modelClass ?> model.
   103|      * If creation is successful, the browser will be redirected to the 'view' page.
   104|      * @return mixed
   105|      */
   106|     public function actionCreate()
   107|     {
   108|         $model = new <?= $modelClass ?>();
   109|         if ($this->request->isPost) {
   110|             if ($model->load($this->request->post()) && $model->save()) {
   111|                 return $this->redirect(['view', <?= $urlParams ?>]);
   112|             }
   113|         } else {
   114|             $model->loadDefaultValues();
   115|         }
   116|         return $this->render('create', [
   117|             'model' => $model,
   118|         ]);
   119|     }
   120|     /**
   121|      * Updates an existing <?= $modelClass ?> model.
   122|      * If update is successful, the browser will be redirected to the 'view' page.
   123|      * <?= implode("\n     * ", $actionParamComments) . "\n" ?>
   124|      * @return mixed
   125|      * @throws NotFoundHttpException if the model cannot be found
   126|      */
   127|     public function actionUpdate(<?= $actionParams ?>)
   128|     {
   129|         $model = $this->findModel(<?= $actionParams ?>);
   130|         if ($this->request->isPost && $model->load($this->request->post()) && $model->save()) {
   131|             return $this->redirect(['view', <?= $urlParams ?>]);
   132|         }
   133|         return $this->render('update', [
   134|             'model' => $model,
   135|         ]);
   136|     }
   137|     /**
   138|      * Deletes an existing <?= $modelClass ?> model.
   139|      * If deletion is successful, the browser will be redirected to the 'index' page.
   140|      * <?= implode("\n     * ", $actionParamComments) . "\n" ?>
   141|      * @return mixed
   142|      * @throws NotFoundHttpException if the model cannot be found
   143|      */
   144|     public function actionDelete(<?= $actionParams ?>)
   145|     {
   146|         $this->findModel(<?= $actionParams ?>)->delete();
   147|         return $this->redirect(['index']);
   148|     }
   149|     /**
   150|      * Finds the <?= $modelClass ?> model based on its primary key value.


# ====================================================================
# FILE: src/generators/crud/default/views/index.php
# Total hunks: 2
# ====================================================================
# --- HUNK 1: Lines 1-25 ---
     1| <?php
     2| use yii\helpers\Inflector;
     3| use yii\helpers\StringHelper;
     4| /* @var $this yii\web\View */
     5| /* @var $generator yii\gii\generators\crud\Generator */
     6| echo "<?php\n";
     7| ?>
     8| use yii\helpers\Html;
     9| use <?= $generator->indexWidgetType === 'grid' ? "yii\\grid\\GridView" : "yii\\widgets\\ListView" ?>;
    10| <?= $generator->enablePjax ? 'use yii\widgets\Pjax;' : '' ?>
    11| /* @var $this yii\web\View */
    12| <?= !empty($generator->searchModelClass) ? "/* @var \$searchModel " . ltrim($generator->searchModelClass, '\\') . " */\n" : '' ?>
    13| /* @var $dataProvider yii\data\ActiveDataProvider */
    14| $this->title = <?= $generator->generateString(Inflector::pluralize(Inflector::camel2words(StringHelper::basename($generator->modelClass)))) ?>;
    15| $this->params['breadcrumbs'][] = $this->title;
    16| ?>
    17| <div class="<?= Inflector::camel2id(StringHelper::basename($generator->modelClass)) ?>-index">
    18|     <h1><?= "<?= " ?>Html::encode($this->title) ?></h1>
    19|     <p>
    20|         <?= "<?= " ?>Html::a(<?= $generator->generateString('Create ' . Inflector::camel2words(StringHelper::basename($generator->modelClass))) ?>, ['create'], ['class' => 'btn btn-success']) ?>
    21|     </p>
    22| <?= $generator->enablePjax ? "    <?php Pjax::begin(); ?>\n" : '' ?>
    23| <?php if(!empty($generator->searchModelClass)): ?>
    24| <?= "    <?php " . ($generator->indexWidgetType === 'grid' ? "// " : "") ?>echo $this->render('_search', ['model' => $searchModel]); ?>
    25| <?php endif; ?>

# --- HUNK 2: Lines 40-65 ---
    40|     }
    41| } else {
    42|     foreach ($tableSchema->columns as $column) {
    43|         $format = $generator->generateColumnFormat($column);
    44|         if (++$count < 6) {
    45|             echo "            '" . $column->name . ($format === 'text' ? "" : ":" . $format) . "',\n";
    46|         } else {
    47|             echo "            //'" . $column->name . ($format === 'text' ? "" : ":" . $format) . "',\n";
    48|         }
    49|     }
    50| }
    51| ?>
    52|             ['class' => 'yii\grid\ActionColumn'],
    53|         ],
    54|     ]); ?>
    55| <?php else: ?>
    56|     <?= "<?= " ?>ListView::widget([
    57|         'dataProvider' => $dataProvider,
    58|         'itemOptions' => ['class' => 'item'],
    59|         'itemView' => function ($model, $key, $index, $widget) {
    60|             return Html::a(Html::encode($model-><?= $generator->getNameAttribute() ?>), ['view', <?= $generator->generateUrlParams() ?>]);
    61|         },
    62|     ]) ?>
    63| <?php endif; ?>
    64| <?= $generator->enablePjax ? "    <?php Pjax::end(); ?>\n" : '' ?>
    65| </div>


# ====================================================================
# FILE: src/generators/extension/Generator.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /**
     3|  * @link http://www.yiiframework.com/
     4|  * @copyright Copyright (c) 2008 Yii Software LLC
     5|  * @license http://www.yiiframework.com/license/
     6|  */
     7| namespace yii\gii\generators\extension;
     8| use Yii;
     9| use yii\gii\CodeFile;
    10| /**
    11|  * This generator will generate the skeleton files needed by an extension.
    12|  *
    13|  * @property-read string $keywordsArrayJson A json encoded array with the given keywords. This property is
    14|  * read-only.
    15|  * @property-read bool $outputPath The directory that contains the module class. This property is read-only.
    16|  *
    17|  * @author Tobias Munk <schmunk@usrbin.de>
    18|  * @since 2.0
    19|  */
    20| class Generator extends \yii\gii\Generator
    21| {
    22|     public $vendorName;
    23|     public $packageName = "yii2-";
    24|     public $namespace;
    25|     public $type = "yii2-extension";
    26|     public $keywords = "yii2,extension";
    27|     public $title;
    28|     public $description;
    29|     public $outputPath = "@app/runtime/tmp-extensions";
    30|     public $license;
    31|     public $authorName;
    32|     public $authorEmail;
    33|     /**
    34|      * {@inheritdoc}
    35|      */


# ====================================================================
# FILE: src/generators/form/Generator.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /**
     3|  * @link http://www.yiiframework.com/
     4|  * @copyright Copyright (c) 2008 Yii Software LLC
     5|  * @license http://www.yiiframework.com/license/
     6|  */
     7| namespace yii\gii\generators\form;
     8| use Yii;
     9| use yii\base\Model;
    10| use yii\gii\CodeFile;
    11| /**
    12|  * This generator will generate an action view file based on the specified model class.
    13|  *
    14|  * @property-read array $modelAttributes List of safe attributes of [[modelClass]]. This property is
    15|  * read-only.
    16|  *
    17|  * @author Qiang Xue <qiang.xue@gmail.com>
    18|  * @since 2.0
    19|  */
    20| class Generator extends \yii\gii\Generator
    21| {
    22|     public $modelClass;
    23|     public $viewPath = '@app/views';
    24|     public $viewName;
    25|     public $scenarioName;
    26|     /**
    27|      * {@inheritdoc}
    28|      */
    29|     public function getName()
    30|     {
    31|         return 'Form Generator';
    32|     }
    33|     /**
    34|      * {@inheritdoc}
    35|      */


# ====================================================================
# FILE: src/generators/form/default/form.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-25 ---
     1| <?php
     2| /**
     3|  * This is the template for generating an action view file.
     4|  */
     5| /* @var $this yii\web\View */
     6| /* @var $generator yii\gii\generators\form\Generator */
     7| $class = str_replace('/', '-', trim($generator->viewName, '_'));
     8| echo "<?php\n";
     9| ?>
    10| use yii\helpers\Html;
    11| use yii\widgets\ActiveForm;
    12| /* @var $this yii\web\View */
    13| /* @var $model <?= ltrim($generator->modelClass, '\\') ?> */
    14| /* @var $form ActiveForm */
    15| <?= "?>" ?>
    16| <div class="<?= $class ?>">
    17|     <?= "<?php " ?>$form = ActiveForm::begin(); ?>
    18|     <?php foreach ($generator->getModelAttributes() as $attribute): ?>
    19|     <?= "<?= " ?>$form->field($model, '<?= $attribute ?>') ?>
    20|     <?php endforeach; ?>
    21|         <div class="form-group">
    22|             <?= "<?= " ?>Html::submitButton(<?= $generator->generateString('Submit') ?>, ['class' => 'btn btn-primary']) ?>
    23|         </div>
    24|     <?= "<?php " ?>ActiveForm::end(); ?>
    25| </div><!-- <?= $class ?> -->


# ====================================================================
# FILE: src/generators/model/Generator.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 927-975 ---
   927|         $className = $tableName;
   928|         foreach ($patterns as $pattern) {
   929|             if (preg_match($pattern, $tableName, $matches)) {
   930|                 $className = $matches[1];
   931|                 break;
   932|             }
   933|         }
   934|         if ($this->standardizeCapitals) {
   935|             $schemaName = ctype_upper(preg_replace('/[_-]/', '', $schemaName)) ? strtolower($schemaName) : $schemaName;
   936|             $className = ctype_upper(preg_replace('/[_-]/', '', $className)) ? strtolower($className) : $className;
   937|             $this->classNames[$fullTableName] = Inflector::camelize(Inflector::camel2words($schemaName.$className));
   938|         } else {
   939|             $this->classNames[$fullTableName] = Inflector::id2camel($schemaName.$className, '_');
   940|         }
   941|         if ($this->singularize) {
   942|             $this->classNames[$fullTableName] = Inflector::singularize($this->classNames[$fullTableName]);
   943|         }
   944|         return $this->classNames[$fullTableName];
   945|     }
   946|     /**
   947|      * Action to generate class name.
   948|      * @return string
   949|      * @since 2.2.2
   950|      */
   951|     public function actionGenerateClassName()
   952|     {
   953|         return $this->generateClassName($this->tableName);
   954|     }
   955|     /**
   956|      * Generates a query class name from the specified model class name.
   957|      * @param string $modelClassName model class name
   958|      * @return string generated class name
   959|      */
   960|     protected function generateQueryClassName($modelClassName)
   961|     {
   962|         $queryClassName = $this->queryClass;
   963|         if (empty($queryClassName) || strpos($this->tableName, '*') !== false) {
   964|             $queryClassName = $modelClassName . 'Query';
   965|         }
   966|         return $queryClassName;
   967|     }
   968|     /**
   969|      * @return Connection the DB connection as specified by [[db]].
   970|      */
   971|     protected function getDbConnection()
   972|     {
   973|         return Yii::$app->get($this->db, false);
   974|     }
   975|     /**


# ====================================================================
# FILE: src/generators/model/form.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| use yii\gii\generators\model\Generator;
     3| use yii\helpers\Url;
     4| /* @var $this yii\web\View */
     5| /* @var $form yii\widgets\ActiveForm */
     6| /* @var $generator yii\gii\generators\model\Generator */
     7| echo $form->field($generator, 'db');
     8| echo $form->field($generator, 'useTablePrefix')->checkbox();
     9| echo $form->field($generator, 'useSchemaName')->checkbox();
    10| echo $form->field($generator, 'tableName')->textInput([
    11|     'data' => [
    12|         'table-prefix' => $generator->getTablePrefix(), 
    13|         'action' => Url::to(['default/action', 'id' => 'model', 'name' => 'GenerateClassName'])
    14|     ]
    15| ]);
    16| echo $form->field($generator, 'standardizeCapitals')->checkbox();
    17| echo $form->field($generator, 'singularize')->checkbox();
    18| echo $form->field($generator, 'modelClass');
    19| echo $form->field($generator, 'ns');
    20| echo $form->field($generator, 'baseClass');
    21| echo $form->field($generator, 'generateRelations')->dropDownList([
    22|     Generator::RELATIONS_NONE => 'No relations',
    23|     Generator::RELATIONS_ALL => 'All relations',
    24|     Generator::RELATIONS_ALL_INVERSE => 'All relations with inverse',
    25| ]);
    26| echo $form->field($generator, 'generateJunctionRelationMode')->dropDownList([
    27|     Generator::JUNCTION_RELATION_VIA_TABLE => 'Via Table',
    28|     Generator::JUNCTION_RELATION_VIA_MODEL => 'Via Model',
    29| ]);
    30| echo $form->field($generator, 'generateRelationsFromCurrentSchema')->checkbox();
    31| echo $form->field($generator, 'generateLabelsFromComments')->checkbox();
    32| echo $form->field($generator, 'generateQuery')->checkbox();
    33| echo $form->field($generator, 'queryNs');
    34| echo $form->field($generator, 'queryClass');
    35| echo $form->field($generator, 'queryBaseClass');
    36| echo $form->field($generator, 'enableI18N')->checkbox();
    37| echo $form->field($generator, 'messageCategory');


# ====================================================================
# FILE: src/generators/module/Generator.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @link http://www.yiiframework.com/
     4|  * @copyright Copyright (c) 2008 Yii Software LLC
     5|  * @license http://www.yiiframework.com/license/
     6|  */
     7| namespace yii\gii\generators\module;
     8| use yii\gii\CodeFile;
     9| use yii\helpers\Html;
    10| use Yii;
    11| use yii\helpers\StringHelper;
    12| /**
    13|  * This generator will generate the skeleton code needed by a module.
    14|  *
    15|  * @property-read string $controllerNamespace The controller namespace of the module. This property is
    16|  * read-only.
    17|  * @property-read bool $modulePath The directory that contains the module class. This property is read-only.
    18|  *
    19|  * @author Qiang Xue <qiang.xue@gmail.com>
    20|  * @since 2.0
    21|  */
    22| class Generator extends \yii\gii\Generator
    23| {
    24|     public $moduleClass;
    25|     public $moduleID;
    26|     /**
    27|      * {@inheritdoc}
    28|      */
    29|     public function getName()
    30|     {
    31|         return 'Module Generator';
    32|     }
    33|     /**
    34|      * {@inheritdoc}
    35|      */
    36|     public function getDescription()
    37|     {


# ====================================================================
# FILE: src/views/default/view/files.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 62-102 ---
    62|                     <?= Html::a(Html::encode($file->getRelativePath()), ['preview', 'id' => $id, 'file' => $file->id], ['class' => 'preview-code', 'data-title' => $file->getRelativePath()]) ?>
    63|                     <?php if ($file->operation === CodeFile::OP_OVERWRITE): ?>
    64|                         <?= Html::a('diff', ['diff', 'id' => $id, 'file' => $file->id], ['class' => 'diff-code badge badge-warning', 'data-title' => $file->getRelativePath()]) ?>
    65|                     <?php endif; ?>
    66|                 </td>
    67|                 <td class="action">
    68|                     <?php
    69|                     if ($file->operation === CodeFile::OP_SKIP) {
    70|                         echo 'unchanged';
    71|                     } else {
    72|                         echo $file->operation;
    73|                     }
    74|                     ?>
    75|                 </td>
    76|                 <?php if ($fileChangeExists): ?>
    77|                 <td class="check">
    78|                     <?php
    79|                     if ($file->operation === CodeFile::OP_SKIP) {
    80|                         echo '&nbsp;';
    81|                     } else {
    82|                         echo Html::checkbox("answers[{$file->id}]", isset($answers) ? isset($answers[$file->id]) : ($file->operation === CodeFile::OP_CREATE));
    83|                     }
    84|                     ?>
    85|                 </td>
    86|                 <?php endif; ?>
    87|             </tr>
    88|             <?php endforeach; ?>
    89|         </tbody>
    90|     </table>
    91|     <div class="modal fade" id="preview-modal" tabindex="-1" role="dialog">
    92|         <div class="modal-dialog modal-lg">
    93|             <div class="modal-content">
    94|                 <div class="modal-header" style="display: flex;">
    95|                     <div class="btn-group btn-group-sm" role="group">
    96|                         <a class="modal-previous btn btn-outline-secondary" href="#" title="Previous File (Left Arrow)">
    97|                             <span class="icon"></span>
    98|                         </a>
    99|                         <a class="modal-next btn btn-outline-secondary" href="#" title="Next File (Right Arrow)">
   100|                             <span class="icon"></span>
   101|                         </a>
   102|                         <a class="modal-refresh btn btn-outline-secondary" href="#" title="Refresh File (R)">

