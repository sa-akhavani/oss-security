# ====================================================================
# FILE: src/Import/TypeOne.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 56-99 ---
    56|         if ($cmpr === false) {
    57|             throw new FontException('Unable to compress font data');
    58|         }
    59|         fwrite($fpt, $cmpr);
    60|         fclose($fpt);
    61|     }
    62|     /**
    63|      * Extract Font information
    64|      */
    65|     protected function extractFontInfo(): void
    66|     {
    67|         if (preg_match('#/FontName[\s]*+\/([^\s]*+)#', $this->font, $matches) !== 1) {
    68|             preg_match('#/FullName[\s]*+\(([^\)]*+)#', $this->font, $matches);
    69|         }
    70|         $name = preg_replace('/[^a-zA-Z0-9_\-]/', '', $matches[1]);
    71|         if ($name === null) {
    72|             throw new FontException('Unable to extract font name');
    73|         }
    74|         $this->fdt['name'] = $name;
    75|         preg_match('#/FontBBox[\s]*+{([^}]*+)#', $this->font, $matches);
    76|         $this->fdt['bbox'] = trim($matches[1]);
    77|         $bvl = explode(' ', $this->fdt['bbox']);
    78|         $this->fdt['Ascent'] = (int) $bvl[3];
    79|         $this->fdt['Descent'] = (int) $bvl[1];
    80|         preg_match('#/ItalicAngle[\s]*+([0-9\+\-]*+)#', $this->font, $matches);
    81|         $this->fdt['italicAngle'] = (int) $matches[1];
    82|         if ($this->fdt['italicAngle'] != 0) {
    83|             $this->fdt['Flags'] |= 64;
    84|         }
    85|         preg_match('#/UnderlinePosition[\s]*+([0-9\+\-]*+)#', $this->font, $matches);
    86|         $this->fdt['underlinePosition'] = (int) $matches[1];
    87|         preg_match('#/UnderlineThickness[\s]*+([0-9\+\-]*+)#', $this->font, $matches);
    88|         $this->fdt['underlineThickness'] = (int) $matches[1];
    89|         preg_match('#/isFixedPitch[\s]*+([^\s]*+)#', $this->font, $matches);
    90|         if ($matches[1] == 'true') {
    91|             $this->fdt['Flags'] = (((int) $this->fdt['Flags']) | 1);
    92|         }
    93|         preg_match('#/Weight[\s]*+\(([^\)]*+)#', $this->font, $matches);
    94|         if (! empty($matches[1])) {
    95|             $this->fdt['weight'] = strtolower($matches[1]);
    96|         }
    97|         $this->fdt['weight'] = 'Book';
    98|         $this->fdt['Leading'] = 0;
    99|     }

