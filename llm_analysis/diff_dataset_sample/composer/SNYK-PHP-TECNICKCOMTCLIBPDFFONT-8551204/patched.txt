# ====================================================================
# FILE: src/Import/TypeOne.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 56-100 ---
    56|         if ($cmpr === false) {
    57|             throw new FontException('Unable to compress font data');
    58|         }
    59|         fwrite($fpt, $cmpr);
    60|         fclose($fpt);
    61|     }
    62|     /**
    63|      * Extract Font information
    64|      */
    65|     protected function extractFontInfo(): void
    66|     {
    67|         if (preg_match('#/FontName[\s]*+\/([^\s]*+)#', $this->font, $matches) !== 1) {
    68|             preg_match('#/FullName[\s]*+\(([^\)]*+)#', $this->font, $matches);
    69|         }
    70|         $name = preg_replace('/[^a-zA-Z0-9_\-]/', '', $matches[1]);
    71|         if ($name === null) {
    72|             throw new FontException('Unable to extract font name');
    73|         }
    74|         $this->fdt['name'] = $name;
    75|         preg_match('#/FontBBox[\s]*+{([^}]*+)#', $this->font, $matches);
    76|         $rawbvl = explode(' ', trim($matches[1]));
    77|         $bvl = [(int) $rawbvl[0], (int) $rawbvl[1], (int) $rawbvl[2], (int) $rawbvl[3]];
    78|         $this->fdt['bbox'] = implode(' ', $bvl);
    79|         $this->fdt['Ascent'] = $bvl[3];
    80|         $this->fdt['Descent'] = $bvl[1];
    81|         preg_match('#/ItalicAngle[\s]*+([0-9\+\-]*+)#', $this->font, $matches);
    82|         $this->fdt['italicAngle'] = (int) $matches[1];
    83|         if ($this->fdt['italicAngle'] != 0) {
    84|             $this->fdt['Flags'] |= 64;
    85|         }
    86|         preg_match('#/UnderlinePosition[\s]*+([0-9\+\-]*+)#', $this->font, $matches);
    87|         $this->fdt['underlinePosition'] = (int) $matches[1];
    88|         preg_match('#/UnderlineThickness[\s]*+([0-9\+\-]*+)#', $this->font, $matches);
    89|         $this->fdt['underlineThickness'] = (int) $matches[1];
    90|         preg_match('#/isFixedPitch[\s]*+([^\s]*+)#', $this->font, $matches);
    91|         if ($matches[1] == 'true') {
    92|             $this->fdt['Flags'] = (((int) $this->fdt['Flags']) | 1);
    93|         }
    94|         preg_match('#/Weight[\s]*+\(([^\)]*+)#', $this->font, $matches);
    95|         if (! empty($matches[1])) {
    96|             $this->fdt['weight'] = strtolower($matches[1]);
    97|         }
    98|         $this->fdt['weight'] = 'Book';
    99|         $this->fdt['Leading'] = 0;
   100|     }

