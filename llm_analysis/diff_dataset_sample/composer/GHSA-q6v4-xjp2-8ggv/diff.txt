--- a/example_form.ajax.php
+++ b/example_form.ajax.php
@@ -126,21 +126,21 @@
         if (sizeof($errors) == 0) {
             $time       = date('r');
             $message = "A message was submitted from the contact form.  The following information was provided.<br /><br />"
                      . "Name: $name<br />"
                      . "Email: $email<br />"
                      . "URL: $URL<br />"
                      . "Message:<br />"
                      . "<pre>$message</pre>"
                      . "<br /><br />IP Address: {$_SERVER['REMOTE_ADDR']}<br />"
                      . "Time: $time<br />"
-                     . "Browser: " . htmlspecialchars($_SERVER['HTTP_USER_AGENT']) . "<br />";
+                     . "Browser: {$_SERVER['HTTP_USER_AGENT']}<br />";
             if (isset($GLOBALS['DEBUG_MODE']) && $GLOBALS['DEBUG_MODE'] == false) {
                 mail($GLOBALS['ct_recipient'], $GLOBALS['ct_msg_subject'], $message, "From: {$GLOBALS['ct_recipient']}\r\nReply-To: {$email}\r\nContent-type: text/html; charset=ISO-8859-1\r\nMIME-Version: 1.0");
             }
             $return = array('error' => 0, 'message' => 'OK');
             die(json_encode($return));
         } else {
             $errmsg = '';
             foreach($errors as $key => $error) {
                 $errmsg .= " - {$error}\n";
             }

--- a/example_form.php
+++ b/example_form.php
@@ -138,21 +138,21 @@
     if (sizeof($errors) == 0) {
       $time       = date('r');
       $message = "A message was submitted from the contact form.  The following information was provided.<br /><br />"
                     . "<em>Name: $name</em><br />"
                     . "<em>Email: $email</em><br />"
                     . "<em>URL: $URL</em><br />"
                     . "<em>Message:</em><br />"
                     . "<pre>$message</pre>"
                     . "<br /><br /><em>IP Address:</em> {$_SERVER['REMOTE_ADDR']}<br />"
                     . "<em>Time:</em> $time<br />"
-                    . "<em>Browser:</em> " . htmlspecialchars($_SERVER['HTTP_USER_AGENT']) . "<br />";
+                    . "<em>Browser:</em> {$_SERVER['HTTP_USER_AGENT']}<br />";
       $message = wordwrap($message, 70);
       if (isset($GLOBALS['DEBUG_MODE']) && $GLOBALS['DEBUG_MODE'] == false) {
         mail($GLOBALS['ct_recipient'], $GLOBALS['ct_msg_subject'], $message, "From: {$GLOBALS['ct_recipient']}\r\nReply-To: {$email}\r\nContent-type: text/html; charset=UTF-8\r\nMIME-Version: 1.0");
       }
       $_SESSION['ctform']['timetosolve'] = $securimage->getTimeToSolve();
       $_SESSION['ctform']['error'] = false;  // no error with form
       $_SESSION['ctform']['success'] = true; // message sent
     } else {
       $_SESSION['ctform']['ct_name'] = $name;       // save name from the form submission
       $_SESSION['ctform']['ct_email'] = $email;     // save email

--- a/securimage.php
+++ b/securimage.php
@@ -1,16 +1,16 @@
 <?php
 /**
  * Project:  Securimage: A PHP class dealing with CAPTCHA images, audio, and validation
  * File:     securimage.php
  *
- * Copyright (c) 2017, Drew Phillips
+ * Copyright (c) 2016, Drew Phillips
  * All rights reserved.
  *
  * Redistribution and use in source and binary forms, with or without modification,
  * are permitted provided that the following conditions are met:
  *
  *  - Redistributions of source code must retain the above copyright notice,
  *    this list of conditions and the following disclaimer.
  *  - Redistributions in binary form must reproduce the above copyright notice,
  *    this list of conditions and the following disclaimer in the documentation
  *    and/or other materials provided with the distribution.
@@ -29,34 +29,28 @@
  *
  * Any modifications to the library should be indicated clearly in the source code
  * to inform users that the changes are not a part of the original software.
  *
  * If you found this script useful, please take a quick moment to rate it.
  * http://www.hotscripts.com/rate/49400.html  Thanks.
  *
  * @link http://www.phpcaptcha.org Securimage PHP CAPTCHA
  * @link http://www.phpcaptcha.org/latest.zip Download Latest Version
  * @link http://www.phpcaptcha.org/Securimage_Docs/ Online Documentation
- * @copyright 2017 Drew Phillips
+ * @copyright 2016 Drew Phillips
  * @author Drew Phillips <drew@drew-phillips.com>
- * @version 3.6.6 (Nov 20 2017)
+ * @version 3.6.5 (Dec 4 2016)
  * @package Securimage
  *
  */
 /**
  ChangeLog
- 3.6.6
- - Not critical: Fix potential HTML injection in example form via HTTP_USER_AGENT (CVE-2017-14077)
- 3.6.5
- - Fix regex in replaceElements in securimage.js
- - Update examples
- - Exclude certain examples from Git autogenerated archives
  3.6.4
  - Fix XSS vulnerability in example_form.ajax.php (Discovered by RedTeam. advisory rt-sa-2016-002)
  - Update example_form.ajax.php to use Securimage::getCaptchaHtml()
  3.6.3
  - Add support for multibyte wordlist files
  - Fix code generation issues with UTF-8 charsets
  - Add parameter to getCaptchaHtml() method to control display components of captcha HTML
  - Fix database audio storage issue with multiple namespaces
  3.6.2
  - Support HTTP range requests with audio playback (iOS requirement)

--- a/securimage_play.php
+++ b/securimage_play.php
@@ -21,21 +21,21 @@
  * to inform users that the changes are not a part of the original software.<br /><br />
  *
  * If you found this script useful, please take a quick moment to rate it.<br />
  * http://www.hotscripts.com/rate/49400.html  Thanks.
  *
  * @link http://www.phpcaptcha.org Securimage PHP CAPTCHA
  * @link http://www.phpcaptcha.org/latest.zip Download Latest Version
  * @link http://www.phpcaptcha.org/Securimage_Docs/ Online Documentation
  * @copyright 2012 Drew Phillips
  * @author Drew Phillips <drew@drew-phillips.com>
- * @version 3.6.6 (Nov 20 2017)
+ * @version 3.6.5 (Dec 4 2016)
  * @package Securimage
  *
  */
 require_once dirname(__FILE__) . '/securimage.php';
 $options = array(
     'use_database'    => true,
     'database_name'   => '',
     'database_user'   => '',
     'database_driver' => Securimage::SI_DRIVER_MYSQL
 );

--- a/securimage_show.php
+++ b/securimage_show.php
@@ -31,18 +31,18 @@
  * to inform users that the changes are not a part of the original software.<br /><br />
  *
  * If you found this script useful, please take a quick moment to rate it.<br />
  * http://www.hotscripts.com/rate/49400.html  Thanks.
  *
  * @link http://www.phpcaptcha.org Securimage PHP CAPTCHA
  * @link http://www.phpcaptcha.org/latest.zip Download Latest Version
  * @link http://www.phpcaptcha.org/Securimage_Docs/ Online Documentation
  * @copyright 2013 Drew Phillips
  * @author Drew Phillips <drew@drew-phillips.com>
- * @version 3.6.6 (Nov 20 2017)
+ * @version 3.6.5 (Dec 4 2016)
  * @package Securimage
  *
  */
 require_once dirname(__FILE__) . '/securimage.php';
 $img = new Securimage();
 if (!empty($_GET['namespace'])) $img->setNamespace($_GET['namespace']);
 $img->show();  // outputs the image and content headers to the browser
