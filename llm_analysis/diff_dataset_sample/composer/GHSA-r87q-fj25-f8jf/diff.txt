--- a/src/SimpleXLSXEx.php
+++ b/src/SimpleXLSXEx.php
@@ -115,24 +115,24 @@
         $this->readComments();
     }
     public function readThemeColors()
     {
         $this->themeColors = [];
         if (isset($this->xlsx->theme->themeElements->clrScheme)) {
             $colors12 = ['lt1', 'dk1', 'lt2', 'dk2','accent1','accent2','accent3','accent4','accent5',
                 'accent6','hlink','folHlink'];
             foreach ($colors12 as $c) {
                 $v = $this->xlsx->theme->themeElements->clrScheme->{$c};
-                if (isset($v->sysClr) && preg_match('/^[A-F0-9]{6}$/', (string) $v->sysClr['lastClr'])) {
-                    $this->themeColors[] = (string) $v->sysClr['lastClr'];
-                } elseif (isset($v->srgbClr) && preg_match('/^[A-F0-9]{6}$/', (string) $v->srgbClr['val'])) {
-                    $this->themeColors[] = (string) $v->srgbClr['val'];
+                if (isset($v->sysClr)) {
+                    $this->themeColors[] = substr((string) $v->sysClr['lastClr'], 0, 6);
+                } elseif (isset($v->srgbClr)) {
+                    $this->themeColors[] = substr((string) $v->srgbClr['val'], 0, 6);
                 } else {
                     $this->themeColors[] = null;
                 }
             }
         }
     }
     public function readFonts()
     {
         $this->fonts = [];
         if (isset($this->xlsx->styles->fonts->font)) {
@@ -558,21 +558,21 @@
         $r['href'] = isset($this->hyperlinks[$this->worksheetIndex][$r['name']]) ? $this->hyperlinks[$this->worksheetIndex][$r['name']] : '';
         $r['comment'] = isset($this->comments[$this->worksheetIndex][$r['name']]) ? $this->comments[$this->worksheetIndex][$r['name']] : '';
         return $r;
     }
     public function getColorValue(SimpleXMLElement $a = null, $default = '')
     {
         if ($a === null) {
             return $default;
         }
         $c = $default; // auto
-        if ($a['rgb'] !== null && preg_match('/^[A-F0-9]{8}$/', (string) $a['rgb'])) {
+        if ($a['rgb'] !== null) {
             $c = substr((string) $a['rgb'], 2, 6); // FFCCBBAA -> CCBBAA
         } elseif ($a['indexed'] !== null && isset(static::$IC[ (int) $a['indexed'] ])) {
             $c = static::$IC[ (int) $a['indexed'] ];
         } elseif ($a['theme'] !== null && isset($this->themeColors[ (int) $a['theme'] ])) {
             $c = $this->themeColors[ (int) $a['theme'] ];
         }
         if ($a['tint'] !== null) {
             list($r,$g,$b) = array_map('hexdec', str_split($c, 2));
             $tint = (float) $a['tint'];
             if ($tint > 0) {
