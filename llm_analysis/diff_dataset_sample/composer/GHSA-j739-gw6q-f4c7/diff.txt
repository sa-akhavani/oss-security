--- a/customer_email.php
+++ b/customer_email.php
@@ -121,22 +121,21 @@
 				'id' => $id
 			))->get();
 		} catch (Exception $e) {
 			\Froxlor\UI\Response::dynamic_error($e->getMessage());
 		}
 		$result = json_decode($json_result, true)['data'];
 		if (isset($result['email']) && $result['email'] != '') {
 			if (isset($_POST['send']) && $_POST['send'] == 'send') {
 				try {
 					Emails::getLocal($userinfo, array(
-						'id' => $id,
-						'delete_userfiles' => ($_POST['delete_userfiles'] ?? 0)
+						'id' => $id
 					))->delete();
 				} catch (Exception $e) {
 					\Froxlor\UI\Response::dynamic_error($e->getMessage());
 				}
 				\Froxlor\UI\Response::redirectTo($filename, array(
 					'page' => $page,
 					's' => $s
 				));
 			} else {
 				if ($result['popaccountid'] != '0') {

--- a/install/lib/class.FroxlorInstall.php
+++ b/install/lib/class.FroxlorInstall.php
@@ -418,36 +418,31 @@
 			$this->_updateSetting($upd_stmt, '/etc/nginx/sites-enabled/', 'system', 'apacheconf_vhost');
 			$this->_updateSetting($upd_stmt, '/etc/nginx/sites-enabled/', 'system', 'apacheconf_diroptions');
 			$this->_updateSetting($upd_stmt, '/etc/nginx/froxlor-htpasswd/', 'system', 'apacheconf_htpasswddir');
 			$this->_updateSetting($upd_stmt, '/etc/init.d/nginx reload', 'system', 'apachereload_command');
 			$this->_updateSetting($upd_stmt, '/etc/nginx/nginx.pem', 'system', 'ssl_cert_file');
 			$this->_updateSetting($upd_stmt, '/var/run/', 'phpfpm', 'fastcgi_ipcdir');
 			$this->_updateSetting($upd_stmt, 'error', 'system', 'errorlog_level');
 		}
 		$distros = glob(\Froxlor\FileDir::makeCorrectDir(\Froxlor\Froxlor::getInstallDir() . '/lib/configfiles/') . '*.xml');
 		foreach ($distros as $_distribution) {
-			if ($this->_data['distribution'] == str_replace(".xml", "", strtolower(basename($_distribution)))) {
+			if($this->_data['distribution'] == str_replace(".xml", "", strtolower(basename($_distribution)))) {
 				$dist = new \Froxlor\Config\ConfigParser($_distribution);
 				$defaults = $dist->getDefaults();
 				foreach ($defaults->property as $property) {
 					$this->_updateSetting($upd_stmt, $property->value, $property->settinggroup, $property->varname);
 				}
 			}
 		}
 		$this->_updateSetting($upd_stmt, $this->_data['activate_newsfeed'], 'admin', 'show_news_feed');
 		$this->_updateSetting($upd_stmt, dirname(dirname(dirname(__FILE__))), 'system', 'letsencryptchallengepath');
 		$this->_updateSetting($upd_stmt, time(), 'system', 'lastcronrun');
-		if (defined('PHP_MAJOR_VERSION') && defined('PHP_MINOR_VERSION')) {
-			$reload = "service php" . PHP_MAJOR_VERSION . "." . PHP_MINOR_VERSION . "-fpm restart";
-			$config_dir = "/etc/php/" . PHP_MAJOR_VERSION . "." . PHP_MINOR_VERSION . "/fpm/pool.d/";
-			$db->query("UPDATE `" . TABLE_PANEL_FPMDAEMONS . "` SET `reload_cmd` = '" . $reload . "', `config_dir` = '" . $config_dir . "' WHERE `id` ='1';");
-		}
 		$ts = mktime(0, 0, 0, date('m', time()), date('d', time()), date('Y', time()));
 		$db->query("UPDATE `" . TABLE_PANEL_CRONRUNS . "` SET `lastrun` = '" . $ts . "' WHERE `cronfile` ='cron_traffic';");
 		$db->query("INSERT INTO `" . TABLE_PANEL_TASKS . "` SET `type` = '99';");
 		$content .= $this->_status_message('green', 'OK');
 		return $content;
 	}
 	/**
 	 * Import froxlor.sql into database
 	 *
 	 * @param object $db_root
@@ -706,21 +701,21 @@
 		$section = $this->_lng['install']['serversettings'];
 		eval("\$formdata .= \"" . $this->_getTemplate("datasection") . "\";");
 		if (! empty($_POST['installstep']) && $this->_data['distribution'] == '') {
 			$diststyle = 'color:red;';
 		} else {
 			$diststyle = '';
 		}
 		$distros = glob(\Froxlor\FileDir::makeCorrectDir(\Froxlor\Froxlor::getInstallDir() . '/lib/configfiles/') . '*.xml');
 		foreach ($distros as $_distribution) {
 			$dist = new \Froxlor\Config\ConfigParser($_distribution);
-			$dist_display = $dist->distributionName . " " . $dist->distributionCodename . " (" . $dist->distributionVersion . ")";
+			$dist_display = $dist->distributionName." ".$dist->distributionCodename." (" . $dist->distributionVersion . ")";
 			$distributions_select_data[$dist_display] .= str_replace(".xml", "", strtolower(basename($_distribution)));
 		}
 		ksort($distributions_select_data);
 		foreach ($distributions_select_data as $dist_display => $dist_index) {
 			$distributions_select .= \Froxlor\UI\HTML::makeoption($dist_display, $dist_index, $this->_data['distribution']);
 		}
 		$formdata .= $this->_getSectionItemSelectbox('distribution', $distributions_select, $diststyle);
 		if (! empty($_POST['installstep']) && $this->_data['servername'] == '') {
 			$style = 'color:red;';
 		} else {
@@ -779,21 +774,21 @@
 		$fieldlabel = $this->_lng['install'][$fieldname];
 		$fieldvalue = htmlspecialchars($this->_data[$fieldname]);
 		if ($required) {
 			$required = ' required="required"';
 		}
 		$sectionitem = "";
 		eval("\$sectionitem .= \"" . $this->_getTemplate("dataitem") . "\";");
 		return $sectionitem;
 	}
 	/**
-	 * generate form radio field
+	 * generate form radio field 
 	 *
 	 * @param string $fieldname
 	 * @param boolean $checked
 	 * @param string $style
 	 *
 	 * @return string
 	 */
 	private function _getSectionItemCheckbox($groupname = null, $fieldname = null, $checked = false, $style = "")
 	{
 		$groupname = $this->_lng['install'][$groupname];
@@ -1078,30 +1073,26 @@
 		}
 	}
 	/**
 	 * get/guess linux distribution
 	 */
 	private function _guessDistribution()
 	{
 		if (! empty($_POST['distribution'])) {
 			$this->_data['distribution'] = $_POST['distribution'];
 		} else {
-			$os_dist = array(
-				'ID' => 'buster'
-			);
-			$os_version = array(
-				'0' => '10'
-			);
-			if (file_exists('/etc/os-release')) {
+			$os_dist = array('ID' => 'buster');
+			$os_version = array('0' => '10');
+			if(file_exists('/etc/os-release')) {
 				$os_dist = parse_ini_file('/etc/os-release', false);
-				if (is_array($os_dist) && array_key_exists('ID', $os_dist) && array_key_exists('VERSION_ID', $os_dist)) {
-					$os_version = explode('.', $os_dist['VERSION_ID'])[0];
+				if(is_array($os_dist) && array_key_exists('ID', $os_dist) && array_key_exists('VERSION_ID', $os_dist)) {
+					$os_version = explode('.',$os_dist['VERSION_ID'])[0];
 				}
 			}
 			$distros = glob(\Froxlor\FileDir::makeCorrectDir(\Froxlor\Froxlor::getInstallDir() . '/lib/configfiles/') . '*.xml');
 			foreach ($distros as $_distribution) {
 				$dist = new \Froxlor\Config\ConfigParser($_distribution);
 				$ver = explode('.', $dist->distributionVersion)[0];
 				if (strtolower($os_dist['ID']) == strtolower($dist->distributionName) && $os_version == $ver) {
 					$this->_data['distribution'] = str_replace(".xml", "", strtolower(basename($_distribution)));
 				}
 			}

--- a/install/lib/updateFunctions.php
+++ b/install/lib/updateFunctions.php
@@ -21,27 +21,27 @@
  *
  * @param
  *        	string task/status
  * @param
  *        	bool needs_status (if false, a linebreak will be added)
  *        	
  * @return string formatted output and log-entry
  */
 function showUpdateStep($task = null, $needs_status = true)
 {
-	set_time_limit(30);
 	if (! $needs_status)
 		echo "<b>";
 	echo $task;
 	if (! $needs_status) {
 		echo "</b><br />";
 	}
+	\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::ADM_ACTION, LOG_WARNING, $task);
 	\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::ADM_ACTION, LOG_WARNING, $task);
 }
 /**
  * Function lastStepStatus
  *
  * outputs [OK] (success), [??] (warning) or [!!] (failure)
  * of the last update-step
  *
  * @param
  *        	int status (0 = success, 1 = warning, 2 = failure)
@@ -64,14 +64,15 @@
 			$status_color = 'err';
 			break;
 		default:
 			$status_sign = '[unknown]';
 			$status_color = 'unknown';
 			break;
 	}
 	echo "<span class=\"update-step update-step-" . $status_color . "\">" . $status_sign . "</span><br />";
 	if ($status == - 1 || $status == 2) {
 		\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::ADM_ACTION, LOG_WARNING, 'Attention - last update task failed!!!');
+		\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::ADM_ACTION, LOG_WARNING, 'Attention - last update task failed!!!');
 	} elseif ($status == 0 || $status == 1) {
 		\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::ADM_ACTION, LOG_WARNING, 'Success');
 	}
 }

--- a/install/updates/froxlor/0.10/update_0.10.inc.php
+++ b/install/updates/froxlor/0.10/update_0.10.inc.php
@@ -552,14 +552,10 @@
 	showUpdateStep("Updating from 0.10.20 to 0.10.21", false);
 	\Froxlor\Froxlor::updateToVersion('0.10.21');
 }
 if (\Froxlor\Froxlor::isFroxlorVersion('0.10.21')) {
 	showUpdateStep("Adding settings for ssl-vhost default content if not updated from db-version 201910110", true);
 	Settings::AddNew("system.default_sslvhostconf", '');
 	lastStepStatus(0);
 	showUpdateStep("Updating from 0.10.21 to 0.10.22", false);
 	\Froxlor\Froxlor::updateToVersion('0.10.22');
 }
-if (\Froxlor\Froxlor::isFroxlorVersion('0.10.22')) {
-	showUpdateStep("Updating from 0.10.22 to 0.10.23", false);
-	\Froxlor\Froxlor::updateToVersion('0.10.23');
-}

--- a/lib/Froxlor/Api/Commands/Customers.php
+++ b/lib/Froxlor/Api/Commands/Customers.php
@@ -906,21 +906,21 @@
 					$std_domain = $this->apiCall('Domains.delete', array(
 						'id' => $result['standardsubdomain'],
 						'is_stdsubdomain' => 1
 					));
 				} catch (\Exception $e) {
 					$this->logger()->logAction(\Froxlor\FroxlorLogger::ADM_ACTION, LOG_ERR, "[API] Unable to delete standard-subdomain: " . $e->getMessage());
 				}
 				$this->logger()->logAction(\Froxlor\FroxlorLogger::ADM_ACTION, LOG_NOTICE, "[API] automatically deleted standardsubdomain for user '" . $result['loginname'] . "'");
 				\Froxlor\System\Cronjob::inserttask('1');
 			}
-			if ($phpenabled != $result['phpenabled'] || $perlenabled != $result['perlenabled'] || $email != $result['email']) {
+			if ($phpenabled != $result['phpenabled'] || $perlenabled != $result['perlenabled']) {
 				\Froxlor\System\Cronjob::inserttask('1');
 			}
 			if ($deactivated != $result['deactivated']) {
 				$yesno = ($deactivated ? 'N' : 'Y');
 				$pop3 = ($deactivated ? '0' : (int) $result['pop3']);
 				$imap = ($deactivated ? '0' : (int) $result['imap']);
 				$upd_stmt = Database::prepare("
 					UPDATE `" . TABLE_MAIL_USERS . "` SET `postfix`= :yesno, `pop3` = :pop3, `imap` = :imap WHERE `customerid` = :customerid
 				");
 				Database::pexecute($upd_stmt, array(

--- a/lib/Froxlor/Api/Commands/DomainZones.php
+++ b/lib/Froxlor/Api/Commands/DomainZones.php
@@ -242,21 +242,21 @@
 			Database::pexecute($ins_stmt, $new_entry, true, true);
 			$new_entry_id = Database::lastInsertId();
 			$new_entry['id'] = $new_entry_id;
 			$dom_entries[] = $new_entry;
 			\Froxlor\System\Cronjob::inserttask('4');
 			$result = $this->apiCall('DomainZones.get', array(
 				'id' => $id
 			));
 			return $this->response(200, "successful", $result);
 		}
-		throw new \Exception(implode("\n", $errors), 406);
+		throw new \Exception(implode("\n", $errors));
 	}
 	/**
 	 * return a domain-dns entry by either id or domainname
 	 *
 	 * @param int $id
 	 *        	optional, the domain id
 	 * @param string $domainname
 	 *        	optional, the domain name
 	 *        	
 	 * @access admin, customer

--- a/lib/Froxlor/Api/Commands/Traffic.php
+++ b/lib/Froxlor/Api/Commands/Traffic.php
@@ -47,82 +47,52 @@
 	}
 	/**
 	 * list traffic information
 	 *
 	 * @param int $year
 	 *        	optional, default empty
 	 * @param int $month
 	 *        	optional, default empty
 	 * @param int $day
 	 *        	optional, default empty
-	 * @param int $date_from
-	 *        	optional timestamp, default empty, if specified, $year, $month and $day will be ignored
-	 * @param int $date_until
-	 *        	optional timestamp, default empty, if specified, $year, $month and $day will be ignored
 	 * @param bool $customer_traffic
 	 *        	optional, admin-only, whether to output ones own traffic or all of ones customers, default is 0 (false)
 	 * @param int $customerid
 	 *        	optional, admin-only, select traffic of a specific customer by id
 	 * @param string $loginname
 	 *        	optional, admin-only, select traffic of a specific customer by loginname
 	 *        	
 	 * @access admin, customer
 	 * @throws \Exception
 	 * @return string json-encoded array count|list
 	 */
 	public function listing()
 	{
 		$year = $this->getParam('year', true, "");
 		$month = $this->getParam('month', true, "");
 		$day = $this->getParam('day', true, "");
-		$date_from = $this->getParam('date_from', true, - 1);
-		$date_until = $this->getParam('date_until', true, - 1);
 		$customer_traffic = $this->getBoolParam('customer_traffic', true, 0);
 		$customer_ids = $this->getAllowedCustomerIds();
 		$result = array();
 		$params = array();
-		if ($date_from >= 0 || $date_until >= 0) {
-			$year = "";
-			$month = "";
-			$day = "";
-			if ($date_from == $date_until) {
-				$date_until = -1;
-			}
-			if ($date_from >= 0 && $date_until >= 0 && $date_until < $date_from) {
-				$temp_ts = $date_from;
-				$date_from = $date_until;
-				$date_until = $temp_ts;
-			}
-		}
 		$where_str = "";
 		if (! empty($year) && is_numeric($year)) {
 			$where_str .= " AND `year` = :year";
 			$params['year'] = $year;
 		}
 		if (! empty($month) && is_numeric($month)) {
 			$where_str .= " AND `month` = :month";
 			$params['month'] = $month;
 		}
 		if (! empty($day) && is_numeric($day)) {
 			$where_str .= " AND `day` = :day";
 			$params['day'] = $day;
-		}
-		if ($date_from >= 0 && $date_until >= 0) {
-			$where_str .= " AND `stamp` BETWEEN :df AND :du";
-			$params['df'] = $date_from;
-			$params['du'] = $date_until;
-		} elseif ($date_from >= 0 && $date_until < 0) {
-			$where_str .= " AND `stamp` > :df";
-			$params['df'] = $date_from;
-		} elseif ($date_from < 0 && $date_until >= 0) {
-			$where_str .= " AND `stamp` < :du";
-			$params['du'] = $date_until;
 		}
 		if (! $this->isAdmin() || ($this->isAdmin() && $customer_traffic)) {
 			$result_stmt = Database::prepare("
 				SELECT * FROM `" . TABLE_PANEL_TRAFFIC . "`
 				WHERE `customerid` IN (" . implode(", ", $customer_ids) . ")" . $where_str);
 		} else {
 			$params['adminid'] = $this->getUserDetail('adminid');
 			$result_stmt = Database::prepare("
 				SELECT * FROM `" . TABLE_PANEL_TRAFFIC_ADMINS . "`
 				WHERE `adminid` = :adminid" . $where_str);

--- a/lib/Froxlor/Cron/Http/Apache.php
+++ b/lib/Froxlor/Cron/Http/Apache.php
@@ -349,24 +349,20 @@
 					}
 					if (($row_ipsandports['ssl_cert_file'] == '' || ! file_exists($row_ipsandports['ssl_cert_file'])) && (Settings::Get('system.le_froxlor_enabled') == '0' || $this->froxlorVhostHasLetsEncryptCert() == false)) {
 						$row_ipsandports['ssl_cert_file'] = Settings::Get('system.ssl_cert_file');
 						if (! file_exists($row_ipsandports['ssl_cert_file'])) {
 							$row_ipsandports['ssl_cert_file'] = "";
 							\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_DEBUG, 'System certificate file "' . Settings::Get('system.ssl_cert_file') . '" does not seem to exist. Disabling SSL-vhost for "' . Settings::Get('system.hostname') . '"');
 						}
 					}
 					if ($row_ipsandports['ssl_key_file'] == '') {
 						$row_ipsandports['ssl_key_file'] = Settings::Get('system.ssl_key_file');
-						if (! file_exists($row_ipsandports['ssl_key_file'])) {
-							$row_ipsandports['ssl_cert_file'] = "";
-							\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_DEBUG, 'System certificate key-file "' . Settings::Get('system.ssl_key_file') . '" does not seem to exist. Disabling SSL-vhost for "' . Settings::Get('system.hostname') . '"');
-						}
 					}
 					if ($row_ipsandports['ssl_ca_file'] == '') {
 						$row_ipsandports['ssl_ca_file'] = Settings::Get('system.ssl_ca_file');
 					}
 					if ($row_ipsandports['ssl_cert_chainfile'] == '') {
 						$row_ipsandports['ssl_cert_chainfile'] = Settings::Get('system.ssl_cert_chainfile');
 					}
 					$domain = array(
 						'id' => 0,
 						'domain' => Settings::Get('system.hostname'),
@@ -778,26 +774,22 @@
 			$domain['documentroot_norewrite'] = 'https://' . $domain['domain'] . $_sslport . '/';
 		}
 		if ($ssl_vhost === true && $domain['ssl'] == '1' && Settings::Get('system.use_ssl') == '1') {
 			if ($domain['ssl_cert_file'] == '' || ! file_exists($domain['ssl_cert_file'])) {
 				$domain['ssl_cert_file'] = Settings::Get('system.ssl_cert_file');
 				if (! file_exists($domain['ssl_cert_file'])) {
 					$domain['ssl_cert_file'] = "";
 					\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_DEBUG, 'System certificate file "' . Settings::Get('system.ssl_cert_file') . '" does not seem to exist. Disabling SSL-vhost for "' . $domain['domain'] . '"');
 				}
 			}
-			if ($domain['ssl_key_file'] == '' || ! file_exists($domain['ssl_key_file'])) {
+			if ($domain['ssl_key_file'] == '') {
 				$domain['ssl_key_file'] = Settings::Get('system.ssl_key_file');
-				if (! file_exists($domain['ssl_key_file'])) {
-					$domain['ssl_cert_file'] = "";
-					\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_DEBUG, 'System certificate key-file "' . Settings::Get('system.ssl_key_file') . '" does not seem to exist. Disabling SSL-vhost for "' . $domain['domain'] . '"');
-				}
 			}
 			if ($domain['ssl_ca_file'] == '') {
 				$domain['ssl_ca_file'] = Settings::Get('system.ssl_ca_file');
 			}
 			if ($domain['ssl_cert_chainfile'] == '') {
 				$domain['ssl_cert_chainfile'] = Settings::Get('system.ssl_cert_chainfile');
 			}
 			if ($domain['ssl_cert_file'] != '') {
 				$ssl_protocols = ($domain['override_tls'] == '1' && ! empty($domain['ssl_protocols'])) ? $domain['ssl_protocols'] : Settings::Get('system.ssl_protocols');
 				$ssl_cipher_list = ($domain['override_tls'] == '1' && ! empty($domain['ssl_cipher_list'])) ? $domain['ssl_cipher_list'] : Settings::Get('system.ssl_cipher_list');

--- a/lib/Froxlor/Cron/Http/DomainSSL.php
+++ b/lib/Froxlor/Cron/Http/DomainSSL.php
@@ -78,25 +78,21 @@
 			}
 			if ($dom_certs['ssl_fullchain_file'] != '') {
 				$ssl_files['ssl_fullchain_file'] = \Froxlor\FileDir::makeCorrectFile($sslcertpath . '/' . $domain['domain'] . '_fullchain.pem');
 			}
 			foreach ($ssl_files as $type => $filename) {
 				if ($filename != '') {
 					touch($filename);
 					$_fh = fopen($filename, 'w');
 					fwrite($_fh, $dom_certs[$type]);
 					fclose($_fh);
-					if ($type == 'ssl_key_file') {
-						chmod($filename, 0600);
-					} else {
-						chmod($filename, 0644);
-					}
+					chmod($filename, 0600);
 				}
 			}
 			$domain['ssl_cert_file'] = $ssl_files['ssl_cert_file'];
 			$domain['ssl_key_file'] = $ssl_files['ssl_key_file'];
 			$domain['ssl_ca_file'] = $ssl_files['ssl_ca_file'];
 			$domain['ssl_cert_chainfile'] = $ssl_files['ssl_cert_chainfile'];
 		}
 		return;
 	}
 	private function validateCertificate($dom_certs = array())

--- a/lib/Froxlor/Cron/Http/LetsEncrypt/AcmeSh.php
+++ b/lib/Froxlor/Cron/Http/LetsEncrypt/AcmeSh.php
@@ -212,36 +212,36 @@
 			}
 		}
 	}
 	/**
 	 * validate dns (A / AAAA record) of domain against known system ips
 	 *
 	 * @param array $domains
 	 * @param int $domain_id
 	 * @param FroxlorLogger $cronlog
 	 */
-	private static function validateDns(array &$domains, $domain_id, &$cronlog)
+	private static function validateDns(&$domains = array(), $domain_id, &$cronlog)
 	{
 		if (Settings::Get('system.le_domain_dnscheck') == '1' && ! empty($domains)) {
 			$loop_domains = $domains;
 			$our_ips = Domain::getIpsOfDomain($domain_id);
 			foreach ($loop_domains as $idx => $domain) {
 				$cronlog->logAction(FroxlorLogger::CRON_ACTION, LOG_INFO, "Validating DNS of " . $domain);
 				$domain_ips = PhpHelper::gethostbynamel6($domain);
 				if ($domain_ips == false || count(array_intersect($our_ips, $domain_ips)) <= 0) {
 					$cronlog->logAction(FroxlorLogger::CRON_ACTION, LOG_WARNING, "Skipping Let's Encrypt generation for " . $domain . " due to no system known IP address via DNS check");
 					unset($domains[$idx]);
 				}
 			}
 		}
 	}
-	private static function runAcmeSh(array $certrow, array $domains, &$cronlog = null, $force = false)
+	private static function runAcmeSh($certrow = array(), $domains = array(), &$cronlog = null, $force = false)
 	{
 		if (! empty($domains)) {
 			$acmesh_cmd = self::$acmesh . " --server " . self::$apiserver . " --issue -d " . implode(" -d ", $domains);
 			$acmesh_cmd .= " -w " . Settings::Get('system.letsencryptchallengepath');
 			if (Settings::Get('system.leecc') > 0) {
 				$acmesh_cmd .= " --keylength ec-" . Settings::Get('system.leecc');
 			} else {
 				$acmesh_cmd .= " --keylength " . Settings::Get('system.letsencryptkeysize');
 			}
 			if (Settings::Get('system.letsencryptreuseold') != '1') {

--- a/lib/Froxlor/Cron/Http/Nginx.php
+++ b/lib/Froxlor/Cron/Http/Nginx.php
@@ -122,24 +122,20 @@
 				if ($row_ipsandports['ssl'] == '1') {
 					if (($row_ipsandports['ssl_cert_file'] == '' || ! file_exists($row_ipsandports['ssl_cert_file'])) && (Settings::Get('system.le_froxlor_enabled') == '0' || $this->froxlorVhostHasLetsEncryptCert() == false)) {
 						$row_ipsandports['ssl_cert_file'] = Settings::Get('system.ssl_cert_file');
 						if (! file_exists($row_ipsandports['ssl_cert_file'])) {
 							$row_ipsandports['ssl_cert_file'] = "";
 							\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_DEBUG, 'System certificate file "' . Settings::Get('system.ssl_cert_file') . '" does not seem to exist. Disabling SSL-vhost for "' . Settings::Get('system.hostname') . '"');
 						}
 					}
 					if ($row_ipsandports['ssl_key_file'] == '') {
 						$row_ipsandports['ssl_key_file'] = Settings::Get('system.ssl_key_file');
-						if (! file_exists($row_ipsandports['ssl_key_file'])) {
-							$row_ipsandports['ssl_cert_file'] = "";
-							\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_DEBUG, 'System certificate key-file "' . Settings::Get('system.ssl_key_file') . '" does not seem to exist. Disabling SSL-vhost for "' . Settings::Get('system.hostname') . '"');
-						}
 					}
 					if ($row_ipsandports['ssl_ca_file'] == '') {
 						$row_ipsandports['ssl_ca_file'] = Settings::Get('system.ssl_ca_file');
 					}
 					if ($row_ipsandports['ssl_cert_file'] != '' && file_exists($row_ipsandports['ssl_cert_file'])) {
 						$ssl_vhost = true;
 					}
 					$domain = array(
 						'id' => 0,
 						'domain' => Settings::Get('system.hostname'),
@@ -509,26 +505,22 @@
 	protected function composeSslSettings($domain_or_ip)
 	{
 		$sslsettings = '';
 		if ($domain_or_ip['ssl_cert_file'] == '' || ! file_exists($domain_or_ip['ssl_cert_file'])) {
 			$domain_or_ip['ssl_cert_file'] = Settings::Get('system.ssl_cert_file');
 			if (! file_exists($domain_or_ip['ssl_cert_file'])) {
 				$domain_or_ip['ssl_cert_file'] = "";
 				\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_DEBUG, 'System certificate file "' . Settings::Get('system.ssl_cert_file') . '" does not seem to exist. Disabling SSL-vhost for "' . $domain_or_ip['domain'] . '"');
 			}
 		}
-		if ($domain_or_ip['ssl_key_file'] == '' || ! file_exists($domain_or_ip['ssl_key_file'])) {
+		if ($domain_or_ip['ssl_key_file'] == '') {
 			$domain_or_ip['ssl_key_file'] = Settings::Get('system.ssl_key_file');
-			if (! file_exists($domain_or_ip['ssl_key_file'])) {
-				$domain_or_ip['ssl_cert_file'] = "";
-				\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_DEBUG, 'System certificate key-file "' . Settings::Get('system.ssl_key_file') . '" does not seem to exist. Disabling SSL-vhost for "' . $domain_or_ip['domain'] . '"');
-			}
 		}
 		if ($domain_or_ip['ssl_ca_file'] == '') {
 			$domain_or_ip['ssl_ca_file'] = Settings::Get('system.ssl_ca_file');
 		}
 		if ($domain_or_ip['ssl_cert_chainfile'] == '') {
 			$domain_or_ip['ssl_cert_chainfile'] = Settings::Get('system.ssl_cert_chainfile');
 		}
 		if ($domain_or_ip['ssl_cert_file'] != '') {
 			if (! file_exists($domain_or_ip['ssl_cert_file'])) {
 				\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_ERR, $domain_or_ip['domain'] . ' :: certificate file "' . $domain_or_ip['ssl_cert_file'] . '" does not exist! Cannot create ssl-directives');

--- a/lib/Froxlor/Cron/Traffic/TrafficCron.php
+++ b/lib/Froxlor/Cron/Traffic/TrafficCron.php
@@ -123,25 +123,20 @@
 		if (Settings::Get('system.diskquota_enabled')) {
 			$usedquota = \Froxlor\FileDir::getFilesystemQuota();
 		}
 		/**
 		 * MAIL-Traffic
 		 */
 		if (Settings::Get("system.mailtraffic_enabled")) {
 			$mailTrafficCalc = new \Froxlor\MailLogParser(Settings::Get("system.last_traffic_run"));
 		}
 		$result_stmt = Database::query("SELECT * FROM `" . TABLE_PANEL_CUSTOMERS . "` ORDER BY `customerid` ASC");
-		$currentDate = date("Y-m-d");
-		$current_stamp = time();
-		$current_year = date('Y', $current_stamp);
-		$current_month = date('m', $current_stamp);
-		$current_day = date('d', $current_stamp);
 		while ($row = $result_stmt->fetch(\PDO::FETCH_ASSOC)) {
 			/**
 			 * HTTP-Traffic
 			 */
 			\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_INFO, 'http traffic for ' . $row['loginname'] . ' started...');
 			$httptraffic = 0;
 			if (isset($domainlist[$row['customerid']]) && is_array($domainlist[$row['customerid']]) && count($domainlist[$row['customerid']]) != 0) {
 				if ($row['standardsubdomain'] != '0') {
 					$caption = $domainlist[$row['customerid']][$row['standardsubdomain']];
 				} else {
@@ -158,21 +153,21 @@
 				if (isset($speciallogfile_domainlist[$row['customerid']]) && is_array($speciallogfile_domainlist[$row['customerid']]) && count($speciallogfile_domainlist[$row['customerid']]) != 0) {
 					reset($speciallogfile_domainlist[$row['customerid']]);
 					if (Settings::Get('system.awstats_enabled') == '0') {
 						foreach ($speciallogfile_domainlist[$row['customerid']] as $domainid => $domain) {
 							$httptraffic += floatval(self::callWebalizerGetTraffic($row['loginname'] . '-' . $domain, $row['documentroot'] . '/webalizer/' . $domain . '/', $domain, $domainlist[$row['customerid']]));
 						}
 					}
 				}
 				reset($domainlist[$row['customerid']]);
 				if (Settings::Get('system.awstats_enabled') == '1') {
-					$httptraffic += floatval(self::callAwstatsGetTraffic($row['customerid'], $row['documentroot'] . '/awstats/', $domainlist[$row['customerid']]), $current_stamp);
+					$httptraffic += floatval(self::callAwstatsGetTraffic($row['customerid'], $row['documentroot'] . '/awstats/', $domainlist[$row['customerid']]));
 				} else {
 					$httptraffic += floatval(self::callWebalizerGetTraffic($row['loginname'], $row['documentroot'] . '/webalizer/', $caption, $domainlist[$row['customerid']]));
 				}
 				\Froxlor\Http\Statistics::makeChownWithNewStats($row);
 			}
 			/**
 			 * FTP-Traffic
 			 */
 			\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_INFO, 'ftp traffic for ' . $row['loginname'] . ' started...');
 			$ftptraffic_stmt = Database::prepare("
@@ -193,20 +188,21 @@
 			");
 			Database::pexecute($upd_stmt, array(
 				'customerid' => $row['customerid']
 			));
 			/**
 			 * Mail-Traffic
 			 */
 			$mailtraffic = 0;
 			if (Settings::Get("system.mailtraffic_enabled")) {
 				\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_INFO, 'mail traffic usage for ' . $row['loginname'] . " started...");
+				$currentDate = date("Y-m-d");
 				$domains_stmt = Database::prepare("SELECT domain FROM `" . TABLE_PANEL_DOMAINS . "` WHERE `customerid` = :cid");
 				Database::pexecute($domains_stmt, array(
 					"cid" => $row['customerid']
 				));
 				while ($domainRow = $domains_stmt->fetch(\PDO::FETCH_ASSOC)) {
 					$domainMailTraffic = $mailTrafficCalc->getDomainTraffic($domainRow["domain"]);
 					if (! is_array($domainMailTraffic)) {
 						continue;
 					}
 					foreach ($domainMailTraffic as $dateTraffic => $dayTraffic) {
@@ -248,24 +244,24 @@
 			 */
 			\Froxlor\FroxlorLogger::getInstanceOf()->logAction(\Froxlor\FroxlorLogger::CRON_ACTION, LOG_INFO, 'total traffic for ' . $row['loginname'] . ' started');
 			$current_traffic = array();
 			$current_traffic['http'] = floatval($httptraffic);
 			$current_traffic['ftp_up'] = floatval(($ftptraffic['up_bytes_sum'] / 1024));
 			$current_traffic['ftp_down'] = floatval(($ftptraffic['down_bytes_sum'] / 1024));
 			$current_traffic['mail'] = floatval($mailtraffic);
 			$current_traffic['all'] = $current_traffic['http'] + $current_traffic['ftp_up'] + $current_traffic['ftp_down'] + $current_traffic['mail'];
 			$ins_data = array(
 				'customerid' => $row['customerid'],
-				'year' => $current_year,
-				'month' => $current_month,
-				'day' => $current_day,
-				'stamp' => $current_stamp,
+				'year' => date('Y', time()),
+				'month' => date('m', time()),
+				'day' => date('d', time()),
+				'stamp' => time(),
 				'http' => $current_traffic['http'],
 				'ftp_up' => $current_traffic['ftp_up'],
 				'ftp_down' => $current_traffic['ftp_down'],
 				'mail' => $current_traffic['mail']
 			);
 			$ins_stmt = Database::prepare("
 				INSERT INTO `" . TABLE_PANEL_TRAFFIC . "` SET
 				`customerid` = :customerid,
 				`year` = :year,
 				`month` = :month,
@@ -275,22 +271,22 @@
 				`ftp_up` = :ftp_up,
 				`ftp_down` = :ftp_down,
 				`mail` = :mail
 			");
 			Database::pexecute($ins_stmt, $ins_data);
 			$sum_month_traffic_stmt = Database::prepare("
 				SELECT SUM(`http`) AS `http`, SUM(`ftp_up`) AS `ftp_up`, SUM(`ftp_down`) AS `ftp_down`, SUM(`mail`) AS `mail`
 				FROM `" . TABLE_PANEL_TRAFFIC . "` WHERE `year` = :year AND `month` = :month AND `customerid` = :customerid
 			");
 			$sum_month_traffic = Database::pexecute_first($sum_month_traffic_stmt, array(
-				'year' => $current_year,
-				'month' => $current_month,
+				'year' => date('Y', time()),
+				'month' => date('m', time()),
 				'customerid' => $row['customerid']
 			));
 			$sum_month_traffic['all'] = $sum_month_traffic['http'] + $sum_month_traffic['ftp_up'] + $sum_month_traffic['ftp_down'] + $sum_month_traffic['mail'];
 			if (! isset($admin_traffic[$row['adminid']]) || ! is_array($admin_traffic[$row['adminid']])) {
 				$admin_traffic[$row['adminid']]['http'] = 0;
 				$admin_traffic[$row['adminid']]['ftp_up'] = 0;
 				$admin_traffic[$row['adminid']]['ftp_down'] = 0;
 				$admin_traffic[$row['adminid']]['mail'] = 0;
 				$admin_traffic[$row['adminid']]['all'] = 0;
 				$admin_traffic[$row['adminid']]['sum_month'] = 0;
@@ -344,24 +340,24 @@
 			if (isset($mysqlusage_all[$row['customerid']])) {
 				$mysqlusage = floatval($mysqlusage_all[$row['customerid']] / 1024);
 			}
 			$current_diskspace = array();
 			$current_diskspace['webspace'] = floatval($webspaceusage);
 			$current_diskspace['mail'] = floatval($emailusage);
 			$current_diskspace['mysql'] = floatval($mysqlusage);
 			$current_diskspace['all'] = $current_diskspace['webspace'] + $current_diskspace['mail'] + $current_diskspace['mysql'];
 			$ins_data = array(
 				'customerid' => $row['customerid'],
-				'year' => $current_year,
-				'month' => $current_month,
-				'day' => $current_day,
-				'stamp' => $current_stamp,
+				'year' => date('Y', time()),
+				'month' => date('m', time()),
+				'day' => date('d', time()),
+				'stamp' => time(),
 				'webspace' => $current_diskspace['webspace'],
 				'mail' => $current_diskspace['mail'],
 				'mysql' => $current_diskspace['mysql']
 			);
 			$ins_stmt = Database::prepare("
 				INSERT INTO `" . TABLE_PANEL_DISKSPACE . "` SET
 				`customerid` = :customerid,
 				`year` = :year,
 				`month` = :month,
 				`day` = :day,
@@ -439,24 +435,24 @@
 			}
 		}
 		/**
 		 * Admin Usage
 		 */
 		$result_stmt = Database::query("SELECT `adminid` FROM `" . TABLE_PANEL_ADMINS . "` ORDER BY `adminid` ASC");
 		while ($row = $result_stmt->fetch(\PDO::FETCH_ASSOC)) {
 			if (isset($admin_traffic[$row['adminid']])) {
 				$ins_data = array(
 					'adminid' => $row['adminid'],
-					'year' => $current_year,
-					'month' => $current_month,
-					'day' => $current_day,
-					'stamp' => $current_stamp,
+					'year' => date('Y', time()),
+					'month' => date('m', time()),
+					'day' => date('d', time()),
+					'stamp' => time(),
 					'http' => $admin_traffic[$row['adminid']]['http'],
 					'ftp_up' => $admin_traffic[$row['adminid']]['ftp_up'],
 					'ftp_down' => $admin_traffic[$row['adminid']]['ftp_down'],
 					'mail' => $admin_traffic[$row['adminid']]['mail']
 				);
 				$ins_stmt = Database::prepare("
 					INSERT INTO `" . TABLE_PANEL_TRAFFIC_ADMINS . "` SET
 					`adminid` = :adminid,
 					`year` = :year,
 					`month` = :month,
@@ -586,21 +582,21 @@
 		fwrite($awstats_nav_file, $header);
 		while (($line = fgets($awstats_nav_tpl, 4096)) !== false) {
 			if (! preg_match('/^#/', $line) && trim($line) != '') {
 				fwrite($awstats_nav_file, preg_replace($regex, $replace, $line));
 			}
 		}
 		fclose($awstats_nav_file);
 		fclose($awstats_nav_tpl);
 		return;
 	}
-	private static function callAwstatsGetTraffic($customerid, $outputdir, $usersdomainlist, $current_stamp)
+	private static function callAwstatsGetTraffic($customerid, $outputdir, $usersdomainlist)
 	{
 		$returnval = 0;
 		foreach ($usersdomainlist as $singledomain) {
 			$returnval += self::awstatsDoSingleDomain($singledomain, $outputdir);
 		}
 		/**
 		 * as of #124, awstats traffic is saved in bytes instead
 		 * of kilobytes (like webalizer does)
 		 */
 		$returnval = floatval($returnval / 1024);
@@ -611,22 +607,22 @@
 		 * (awstats overwrites the customers .html stats-files)
 		 */
 		if ($customerid !== false) {
 			$result_stmt = Database::prepare("
 				SELECT SUM(`http`) as `trafficmonth` FROM `" . TABLE_PANEL_TRAFFIC . "`
 				WHERE `customerid` = :customerid
 				AND `year` = :year AND `month` = :month
 			");
 			$result_data = array(
 				'customerid' => $customerid,
-				'year' => date('Y', $current_stamp),
-				'month' => date('m', $current_stamp)
+				'year' => date('Y', time()),
+				'month' => date('m', time())
 			);
 			$result = Database::pexecute_first($result_stmt, $result_data);
 			if (is_array($result) && isset($result['trafficmonth'])) {
 				$returnval = ($returnval - floatval($result['trafficmonth']));
 			}
 		}
 		return floatval($returnval);
 	}
 	/**
 	 * Function which make webalizer statistics and returns used traffic since last run

--- a/lib/Froxlor/Froxlor.php
+++ b/lib/Froxlor/Froxlor.php
@@ -1,16 +1,16 @@
 <?php
 namespace Froxlor;
 use Froxlor\Database\Database;
 final class Froxlor
 {
-	const VERSION = '0.10.23';
+	const VERSION = '0.10.22';
 	const DBVERSION = '202009070';
 	const BRANDING = '';
 	/**
 	 * return path to where froxlor is installed, e.g.
 	 * /var/www/froxlor/
 	 *
 	 * @return string
 	 */
 	public static function getInstallDir()
 	{

--- a/lib/Froxlor/PhpHelper.php
+++ b/lib/Froxlor/PhpHelper.php
@@ -93,21 +93,21 @@
 	 * froxlor php error handler
 	 *
 	 * @param int $errno
 	 * @param string $errstr
 	 * @param string $errfile
 	 * @param int $errline
 	 * @param array $errcontext
 	 *
 	 * @return void|boolean
 	 */
-	public static function phpErrHandler($errno, $errstr, $errfile, $errline, $errcontext = array())
+	public static function phpErrHandler($errno, $errstr, $errfile, $errline, $errcontext)
 	{
 		if (! (error_reporting() & $errno)) {
 			return;
 		}
 		if (! isset($_SERVER['SHELL']) || (isset($_SERVER['SHELL']) && $_SERVER['SHELL'] == '')) {
 			global $theme;
 			if (empty($theme)) {
 				$theme = "Sparkle";
 			}
 			$errfile = str_replace(\Froxlor\Froxlor::getInstallDir(), "", $errfile);
@@ -331,20 +331,20 @@
 		}
 		return $returnval;
 	}
 	/**
 	 * function to check a super-global passed by reference
 	 * so it gets automatically updated
 	 *
 	 * @param array $global
 	 * @param \voku\helper\AntiXSS $antiXss
 	 */
-	public static function cleanGlobal(&$global, &$antiXss)
+	public static function cleanGlobal(&$global = [], &$antiXss)
 	{
 		if (isset($global) && ! empty($global)) {
 			$tmp = $global;
 			foreach ($tmp as $index => $value) {
 				$global[$index] = $antiXss->xss_clean($value);
 			}
 		}
 	}
 }

--- a/lib/Froxlor/System/Mailer.php
+++ b/lib/Froxlor/System/Mailer.php
@@ -20,25 +20,18 @@
 			$this->SMTPAuth = Settings::Get('system.mail_smtp_auth') == '1' ? true : false;
 			$this->Username = Settings::Get('system.mail_smtp_user');
 			$this->Password = Settings::Get('system.mail_smtp_passwd');
 			if (Settings::Get('system.mail_smtp_usetls')) {
 				$this->SMTPSecure = 'tls';
 			} else {
 				$this->SMTPAutoTLS = false;
 			}
 			$this->Port = Settings::Get('system.mail_smtp_port');
 		}
-		/**
-		 * use froxlor's email-validation
-		 */
-		self::$validator = [
-			'\Froxlor\\Validate\\Validate',
-			'validateEmail'
-		];
 		if (self::ValidateAddress(Settings::Get('panel.adminmail')) !== false) {
 			$this->SetFrom(Settings::Get('panel.adminmail'), Settings::Get('panel.adminmail_defname'));
 			if (Settings::Get('panel.adminmail_return') != '') {
 				$this->AddReplyTo(Settings::Get('panel.adminmail_return'), Settings::Get('panel.adminmail_defname'));
 			}
 		}
 	}
 }

--- a/lib/Froxlor/Validate/Form/Data.php
+++ b/lib/Froxlor/Validate/Form/Data.php
@@ -19,21 +19,21 @@
 					break;
 				}
 			}
 		} else {
 			$returnvalue = false;
 			/**
 			 * don't use tabs in value-fields, #81
 			 */
 			$newfieldvalue = str_replace("\t", " ", $newfieldvalue);
 			if (isset($fielddata['string_type']) && $fielddata['string_type'] == 'mail') {
-				$returnvalue = \Froxlor\Validate\Validate::validateEmail($newfieldvalue);
+				$returnvalue = (filter_var($newfieldvalue, FILTER_VALIDATE_EMAIL) == $newfieldvalue);
 			} elseif (isset($fielddata['string_type']) && $fielddata['string_type'] == 'url') {
 				$returnvalue = \Froxlor\Validate\Validate::validateUrl($newfieldvalue);
 			} elseif (isset($fielddata['string_type']) && $fielddata['string_type'] == 'dir') {
 				if (trim($newfieldvalue) == '') {
 					$newfieldvalue = '';
 					$returnvalue = 'stringmustntbeempty';
 				} else {
 					if (substr($newfieldvalue, - 1) != '/') {
 						$newfieldvalue .= '/';
 					}
@@ -159,21 +159,21 @@
 					break;
 				}
 			}
 		} else {
 			$returnvalue = false;
 			/**
 			 * don't use tabs in value-fields, #81
 			 */
 			$newfieldvalue = str_replace("\t", " ", $newfieldvalue);
 			if (isset($fielddata['string_type']) && $fielddata['string_type'] == 'mail') {
-				$returnvalue = \Froxlor\Validate\Validate::validateEmail($newfieldvalue);
+				$returnvalue = (filter_var($newfieldvalue, FILTER_VALIDATE_EMAIL) == $newfieldvalue);
 			} elseif (isset($fielddata['string_type']) && $fielddata['string_type'] == 'url') {
 				$returnvalue = \Froxlor\Validate\Validate::validateUrl($newfieldvalue);
 			} elseif (isset($fielddata['string_type']) && $fielddata['string_type'] == 'dir') {
 				if (substr($newfieldvalue, - 1) != '/') {
 					$newfieldvalue .= '/';
 				}
 				$returnvalue = ($newfieldvalue == \Froxlor\FileDir::makeCorrectDir($newfieldvalue));
 			} elseif (isset($fielddata['string_type']) && $fielddata['string_type'] == 'file') {
 				$returnvalue = ($newfieldvalue == \Froxlor\FileDir::makeCorrectFile($newfieldvalue));
 			} elseif (isset($fielddata['string_type']) && $fielddata['string_type'] == 'filedir') {

--- a/lib/Froxlor/Validate/Validate.php
+++ b/lib/Froxlor/Validate/Validate.php
@@ -178,23 +178,23 @@
 	 * @param string $domainname
 	 *        	The domainname which should be checked.
 	 * @param bool $allow_underscore
 	 *        	optional if true, allowes the underscore character in a domain label (DKIM etc.)
 	 *        	
 	 * @return string|boolean the domain-name if the domain is valid, false otherwise
 	 */
 	public static function validateDomain($domainname, $allow_underscore = false)
 	{
 		if (is_string($domainname)) {
-			$char_validation = '([a-z\d](-*[a-z\d])*)(\.?([a-z\d](-*[a-z\d])*))*\.(xn\-\-)?([a-z\d])+';
+			$char_validation = '([a-z\d](-*[a-z\d])*)(\.?([a-z\d](-*[a-z\d])*))*\.([a-z\d])+';
 			if ($allow_underscore) {
-				$char_validation = '([a-z\d\_](-*[a-z\d\_])*)(\.([a-z\d\_](-*[a-z\d])*))*(\.?([a-z\d](-*[a-z\d])*))+\.(xn\-\-)?([a-z\d])+';
+				$char_validation = '([a-z\d\_](-*[a-z\d\_])*)(\.([a-z\d\_](-*[a-z\d])*))*(\.?([a-z\d](-*[a-z\d])*))+\.([a-z\d])+';
 			}
 			if (preg_match("/^" . $char_validation . "$/i", $domainname) && preg_match("/^.{1,253}$/", $domainname) && preg_match("/^[^\.]{1,63}(\.[^\.]{1,63})*$/", $domainname)) {
 				return $domainname;
 			}
 		}
 		return false;
 	}
 	/**
 	 * validate a local-hostname by regex
 	 *
@@ -213,23 +213,20 @@
 	/**
 	 * Returns if an emailaddress is in correct format or not
 	 *
 	 * @param string $email
 	 *        	The email address to check
 	 * @return bool Correct or not
 	 */
 	public static function validateEmail($email)
 	{
 		$email = strtolower($email);
-		if (defined('FILTER_FLAG_EMAIL_UNICODE')) {
-			return filter_var($email, FILTER_VALIDATE_EMAIL, FILTER_FLAG_EMAIL_UNICODE);
-		}
 		return filter_var($email, FILTER_VALIDATE_EMAIL);
 	}
 	/**
 	 * Returns if an username is in correct format or not.
 	 *
 	 * @param string $username
 	 *        	The username to check
 	 * @param bool $unix_names
 	 *        	optional, default true, checks whether it must be UNIX compatible
 	 * @param int $mysql_max

--- a/lng/english.lng.php
+++ b/lng/english.lng.php
@@ -1724,21 +1724,21 @@
 $lng['apikeys']['apikey_removed'] = 'The api key with the id #%s has been removed successfully';
 $lng['apikeys']['apikey_added'] = 'A new api key has been generated successfully';
 $lng['apikeys']['clicktoview'] = 'Click to view';
 $lng['apikeys']['allowed_from'] = 'Allowed from';
 $lng['apikeys']['allowed_from_help'] = 'Comma separated list of ip addresses. Default empty.<br>Specifying a subnet e.g. 192.168.1.1/24 is currently not supported.';
 $lng['apikeys']['valid_until'] = 'Valid until';
 $lng['apikeys']['valid_until_help'] = 'Date until valid, format YYYY-MM-DD';
 $lng['serversettings']['enable_api']['title'] = 'Enable external API usage';
 $lng['serversettings']['enable_api']['description'] = 'In order to use the froxlor API you need to activate this option. For more detailed information see <a href="https://api.froxlor.org/" target="_new">https://api.froxlor.org/</a>';
 $lng['serversettings']['dhparams_file']['title'] = 'DHParams file (Diffie–Hellman key exchange)';
-$lng['serversettings']['dhparams_file']['description'] = 'If a dhparams.pem file is specified here it will be included in the webserver configuration. Leave empty to disable.<br>Example: /etc/ssl/webserver/dhparams.pem<br><br>If the file does not exist, it will be created automatically with the following command: <em>openssl dhparam -out /etc/ssl/webserver/dhparams.pem 4096<em>. It is recommended to create the file prior to specifying it here as the creation takes quite a while and blocks the cronjob.';
+$lng['serversettings']['dhparams_file']['description'] = 'If a dhparams.pem file is specified here it will be included in the webserver configuration. Leave empty to disable.<br>Example: /etc/apache2/ssl/dhparams.pem<br><br>If the file does not exist, it will be created automatically with the following command: <em>openssl dhparam -out /etc/apache2/ssl/dhparams.pem 4096<em>. It is recommended to create the file prior to specifying it here as the creation takes quite a while and blocks the cronjob.';
 $lng['2fa']['2fa'] = '2FA options';
 $lng['2fa']['2fa_enabled'] = 'Activate Two-factor authentication (2FA)';
 $lng['login']['2fa'] = 'Two-factor authentication (2FA)';
 $lng['login']['2facode'] = 'Please enter 2FA code';
 $lng['2fa']['2fa_removed'] = '2FA removed successfully';
 $lng['2fa']['2fa_added'] = '2FA activated successfully<br><a href="%s?s=%s&page=2fa">View 2FA details</a>';
 $lng['2fa']['2fa_add'] = 'Activate 2FA';
 $lng['2fa']['2fa_delete'] = 'Deactivate 2FA';
 $lng['2fa']['2fa_verify'] = 'Verify code';
 $lng['mails']['2fa']['mailbody'] = 'Hello,\n\nyour 2FA login-code is: {CODE}.\n\nThis is an automatically created\ne-mail, please do not answer!\n\nYours sincerely, your administrator';

--- a/lng/german.lng.php
+++ b/lng/german.lng.php
@@ -1389,21 +1389,21 @@
 $lng['apikeys']['no_api_keys'] = 'Keine API Keys gefunden';
 $lng['apikeys']['key_add'] = 'API Key hinzufügen';
 $lng['apikeys']['apikey_removed'] = 'Der API Key mit der ID #%s wurde erfolgreich gelöscht.';
 $lng['apikeys']['allowed_from'] = 'Erlaube Zugriff von';
 $lng['apikeys']['allowed_from_help'] = 'Komma getrennte Liste von IPs. Standard ist leer.<br>Angabe von Subnetzen z.B. 192.168.1.1/24 wird derzeit nicht unterstützt.';
 $lng['apikeys']['valid_until'] = 'Gültig bis';
 $lng['apikeys']['valid_until_help'] = 'Datum Gültigkeitsende, Format JJJJ-MM-TT';
 $lng['serversettings']['enable_api']['title'] = 'Aktiviere externe API Nutzung';
 $lng['serversettings']['enable_api']['description'] = 'Um die froxlor API nutzen zu können, muss diese Option aktiviert sein. Für detaillierte Informationen siehe <a href="https://api.froxlor.org/" target="_new">https://api.froxlor.org/</a>';
 $lng['serversettings']['dhparams_file']['title'] = 'DHParams Datei (Diffie–Hellman key exchange)';
-$lng['serversettings']['dhparams_file']['description'] = 'Wird eine dhparams.pem Datei hier angegeben, wir sie in die Webserver Konfiguration mit eingefügt.<br>Beispiel: /etc/ssl/webserver/dhparams.pem<br><br>Existiert die Datei nicht, wird sie wie folgt erstellt: <em>openssl dhparam -out /etc/ssl/webserver/dhparams.pem 4096<em>. Es wird empfohlen die Datei zu erstellen, bevor sie hier angegeben wird, da die Erstellung längere Zeit in Anspruch nimmt und den Cronjob blockiert.';
+$lng['serversettings']['dhparams_file']['description'] = 'Wird eine dhparams.pem Datei hier angegeben, wir sie in die Webserver Konfiguration mit eingefügt.<br>Beispiel: /etc/apache2/ssl/dhparams.pem<br><br>Existiert die Datei nicht, wird sie wie folgt erstellt: <em>openssl dhparam -out /etc/apache2/ssl/dhparams.pem 4096<em>. Es wird empfohlen die Datei zu erstellen, bevor sie hier angegeben wird, da die Erstellung längere Zeit in Anspruch nimmt und den Cronjob blockiert.';
 $lng['2fa']['2fa'] = '2FA Optionen';
 $lng['2fa']['2fa_enabled'] = 'Aktiviere Zwei-Faktor Authentifizierung (2FA)';
 $lng['login']['2fa'] = 'Zwei-Faktor Authentifizierung (2FA)';
 $lng['login']['2facode'] = 'Bitte 2FA Code angeben';
 $lng['2fa']['2fa_removed'] = '2FA erfolgreich gelöscht';
 $lng['2fa']['2fa_added'] = '2FA erfolgreich aktiviert<br><a href="%s?s=%s&page=2fa">2FA Details öffnen</a>';
 $lng['2fa']['2fa_add'] = '2FA aktivieren';
 $lng['2fa']['2fa_delete'] = '2FA deaktivieren';
 $lng['2fa']['2fa_verify'] = 'Code verifizieren';
 $lng['mails']['2fa']['mailbody'] = 'Hallo,\n\nihr 2FA-Login Code lautet: {CODE}\n\nDies ist eine automatisch generierte\neMail, bitte antworten Sie nicht auf\ndiese Mitteilung.\n\nIhr Administrator';
