# ====================================================================
# FILE: mod/reportedcontent/actions/reportedcontent/add.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-29 ---
     1| <?php
     2| /**
     3|  * Elgg report action
     4|  */
     5| $title = get_input('title');
     6| $description = get_input('description');
     7| $address = get_input('address');
     8| $access = ACCESS_PRIVATE; //this is private and only admins can see it
     9| $fail = function () use ($address) {
    10| 	return elgg_error_response(elgg_echo('reportedcontent:failed'), $address);
    11| };
    12| if (!$title || !$address) {
    13| 	$fail();
    14| }
    15| $report = new ElggReportedContent();
    16| $report->owner_guid = elgg_get_logged_in_user_guid();
    17| $report->title = $title;
    18| $report->address = elgg_normalize_site_url($address);
    19| $report->description = $description;
    20| $report->access_id = $access;
    21| if (!$report->save()) {
    22| 	$fail();
    23| }
    24| if (!elgg_trigger_plugin_hook('reportedcontent:add', 'system', ['report' => $report], true)) {
    25| 	$report->delete();
    26| 	$fail();
    27| }
    28| $report->state = 'active';
    29| return elgg_ok_response('', elgg_echo('reportedcontent:success'), $address);

