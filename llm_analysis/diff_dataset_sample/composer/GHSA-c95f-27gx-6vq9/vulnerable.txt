# ====================================================================
# FILE: example.cli.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-28 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| include('src/whois.main.php');
    21| if (isset($argv[1]))
    22| 	$domain = $argv[1];
    23| else
    24| 	$domain = 'example.com';
    25| $whois = new Whois();
    26| $result = $whois->Lookup($domain);
    27| print_r($result);
    28| ?>


# ====================================================================
# FILE: example.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-103 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| header('Content-Type: text/html; charset=UTF-8');
    21| $out =  implode('', file('example.html'));
    22| $out = str_replace('{self}', $_SERVER['PHP_SELF'], $out);
    23| $resout = extract_block($out, 'results');
    24| if (isSet($_GET['query']))
    25| 	{
    26| 	$query = $_GET['query'];
    27| 	if (!empty($_GET['output']))
    28| 		$output = $_GET['output'];
    29| 	else
    30| 		$output = '';
    31| 	include_once('src/whois.main.php');
    32| 	include_once('src/whois.utils.php');
    33| 	$whois = new Whois();
    34| 	$allowproxy = false;
    35|  	$whois->deep_whois = empty($_GET['fast']);
    36| 	$whois->non_icann = true;
    37| 	$result = $whois->Lookup($query);
    38| 	$resout = str_replace('{query}', $query, $resout);
    39| 	$winfo = '';
    40| 	switch ($output)
    41| 		{
    42| 		case 'object':
    43| 			if ($whois->Query['status'] < 0)
    44| 				{
    45| 				$winfo = implode($whois->Query['errstr'],"\n<br></br>");
    46| 				}
    47| 			else
    48| 				{
    49| 				$utils = new utils;
    50| 				$winfo = $utils->showObject($result);
    51| 				}
    52| 			break;
    53| 		case 'nice':
    54| 			if (!empty($result['rawdata']))
    55| 				{
    56| 				$utils = new utils;
    57| 				$winfo = $utils->showHTML($result);
    58| 				}
    59| 			else
    60| 				{
    61| 				if (isset($whois->Query['errstr']))
    62| 					$winfo = implode($whois->Query['errstr'],"\n<br></br>");
    63| 				else
    64| 					$winfo = 'Unexpected error';
    65| 				}
    66| 			break;
    67| 		case 'proxy':
    68| 			if ($allowproxy)
    69| 				exit(serialize($result));
    70| 		default:
    71| 			if(!empty($result['rawdata']))
    72| 				{
    73| 				$winfo .= '<pre>'.implode($result['rawdata'],"\n").'</pre>';
    74| 				}
    75| 			else
    76| 				{
    77| 				$winfo = implode($whois->Query['errstr'],"\n<br></br>");
    78| 				}
    79| 		}
    80| 	$resout = str_replace('{result}', $winfo, $resout);
    81| 	}
    82| else
    83| 	$resout = '';
    84| $out = str_replace('{ver}',$whois->CODE_VERSION,$out);
    85| exit(str_replace('{results}', $resout, $out));
    86| function extract_block (&$plantilla,$mark,$retmark='')
    87| {
    88| $start = strpos($plantilla,'<!--'.$mark.'-->');
    89| $final = strpos($plantilla,'<!--/'.$mark.'-->');
    90| if ($start === false || $final === false) return;
    91| $ini = $start+7+strlen($mark);
    92| $ret=substr($plantilla,$ini,$final-$ini);
    93| $final+=8+strlen($mark);
    94| if ($retmark===false)
    95| 	$plantilla=substr($plantilla,0,$start).substr($plantilla,$final);
    96| else	
    97| 	{
    98| 	if ($retmark=='') $retmark=$mark;
    99| 	$plantilla=substr($plantilla,0,$start).'{'.$retmark.'}'.substr($plantilla,$final);
   100| 	}
   101| return $ret;
   102| }
   103| ?>


# ====================================================================
# FILE: handler.template.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-30 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__XX_HANDLER__'))
    21| 	define('__XX_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class xx_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		return $r;
    28| 		}
    29| 	}
    30| ?>


# ====================================================================
# FILE: src/whois.ae.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__AE_HANDLER__'))
    21| 	define('__AE_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class ae_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                     'Domain Name:'		=> 'domain.name',
    29|                     'Registrar Name:'	=> 'domain.sponsor',
    30|                     'Status:'			=> 'domain.status',
    31|                     'Registrant Contact ID:'	=> 'owner.handle',
    32|                     'Registrant Contact Name:' => 'owner.name',
    33|                     'Tech Contact Name:'		=> 'tech.name',
    34|                     'Tech Contact ID:'			=> 'tech.handle',
    35|                     'Name Server:'		=> 'domain.nserver.'
    36| 		              );
    37| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
    38| 		$r['regyinfo'] = array(
    39|                     'referrer' => 'http://www.nic.ae',
    40|                     'registrar' => 'UAENIC'
    41|                     );
    42| 		return $r;
    43| 		}
    44| 	}
    45| ?>


# ====================================================================
# FILE: src/whois.aero.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| if (!defined('__AERO_HANDLER__'))
    21| 	define('__AERO_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class aero_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, 'ymd');
    28| 		$r['regyinfo'] = array(
    29|                           'referrer' => 'http://www.nic.aero',
    30|                           'registrar' => 'Societe Internationale de Telecommunications Aeronautiques SC'
    31|                           );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.ag.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__AG_HANDLER__'))
    21| 	define('__AG_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class ag_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		$r['regyinfo'] = array(
    29|                           'referrer' => 'http://www.nic.ag',
    30|                           'registrar' => 'Nic AG'
    31|                           );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.am.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-36 ---
     1| <?php
     2| if (!defined('__AM_HANDLER__'))
     3| 	define('__AM_HANDLER__', 1);
     4| require_once('whois.parser.php');
     5| class am_handler
     6| 	{
     7| 	function parse($data_str, $query)
     8| 		{
     9| 		$items = array(
    10|                 'owner' 			=> 'Registrant:',
    11|                 'domain.name' 		=> 'Domain name:',
    12|                 'domain.created' 	=> 'Registered:',
    13|                 'domain.changed' 	=> 'Last modified:',
    14|                 'domain.nserver' 	=> 'DNS servers:',
    15|                 'domain.status'		=> 'Status:',
    16|                 'tech' 				=> 'Technical contact:',
    17|                 'admin'				=> 'Administrative contact:',
    18| 		            );
    19| 		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    20| 		if (!empty($r['regrinfo']['domain']['name']))
    21| 			{
    22| 			$r['regrinfo'] = get_contacts($r['regrinfo']);
    23| 			$r['regrinfo']['registered'] = 'yes';
    24| 			}
    25| 		else
    26| 			{
    27| 			$r = '';
    28| 			$r['regrinfo']['registered'] = 'no';
    29| 			}
    30| 		$r['regyinfo'] = array(
    31|                     'referrer' => 'http://www.isoc.am',
    32|                     'registrar' => 'ISOCAM'
    33|                     );
    34| 		return $r;
    35| 		}
    36| 	}


# ====================================================================
# FILE: src/whois.asia.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-34 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| if(!defined('__ASIA_HANDLER__')) define('__ASIA_HANDLER__',1);
    21| require_once('whois.parser.php');
    22| class asia_handler
    23| 	{
    24| 	function parse ($data_str, $query)
    25| 		{
    26| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    27| 		$r['regyinfo'] = array(
    28|                         'referrer'=>'http://www.dotasia.org/',
    29| 						'registrar' => 'DotAsia'
    30|                         );
    31| 		return $r;
    32| 		}
    33| 	}
    34| ?>


# ====================================================================
# FILE: src/whois.at.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-85 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__AT_HANDLER__'))
    21| 	define('__AT_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class at_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28| 			'fax-no' => 'fax',
    29| 			'e-mail' => 'email',
    30| 			'nic-hdl' => 'handle',
    31| 			'person' => 'name',
    32| 			'personname' => 'name',
    33| 			'street address' => 'address.street',
    34| 			'city' =>	'address.city',
    35| 			'postal code' => 'address.pcode',
    36| 			'country' => 'address.country'
    37| 			);
    38| 		$contacts = array(
    39|                     'registrant' => 'owner',
    40|                     'admin-c' => 'admin',
    41|                     'tech-c' => 'tech',
    42|                     'billing-c' => 'billing',
    43|                     'zone-c' => 'zone'
    44| 		                );
    45| 		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    46| 		if (isset($reg['domain']['remarks']))
    47| 			unset($reg['domain']['remarks']);
    48| 		if (isset($reg['domain']['descr']))
    49| 			{
    50| 			while (list($key, $val) = each($reg['domain']['descr']))
    51| 				{
    52| 				$v = trim(substr(strstr($val, ':'), 1));
    53| 				if (strstr($val, '[organization]:'))
    54| 					{
    55| 					$reg['owner']['organization'] = $v;
    56| 					continue;
    57| 					}
    58| 				if (strstr($val, '[phone]:'))
    59| 					{
    60| 					$reg['owner']['phone'] = $v;
    61| 					continue;
    62| 					}
    63| 				if (strstr($val, '[fax-no]:'))
    64| 					{
    65| 					$reg['owner']['fax'] = $v;
    66| 					continue;
    67| 					}
    68| 				if (strstr($val, '[e-mail]:'))
    69| 					{
    70| 					$reg['owner']['email'] = $v;
    71| 					continue;
    72| 					}
    73| 				$reg['owner']['address'][$key] = $v;
    74| 				}
    75| 			if (isset($reg['domain']['descr'])) unset($reg['domain']['descr']);
    76| 			}
    77| 		$r['regrinfo'] = $reg;
    78| 		$r['regyinfo'] = array(
    79|                     'referrer' => 'http://www.nic.at',
    80|                     'registrar' => 'NIC-AT'
    81|                     );
    82| 		return $r;
    83| 		}
    84| 	}
    85| ?>


# ====================================================================
# FILE: src/whois.au.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-50 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__AU_HANDLER__'))
    21| 	define('__AU_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class au_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                     'Domain Name:'		=> 'domain.name',
    29|                     'Last Modified:'	=> 'domain.changed',
    30|                     'Registrar Name:'	=> 'domain.sponsor',
    31|                     'Status:'			=> 'domain.status',
    32|                     'Domain ROID:'		=> 'domain.handle',
    33|                     'Registrant:'		=> 'owner.organization',
    34|                     'Registrant Contact ID:'	=> 'owner.handle',
    35|                     'Registrant Contact Email:' => 'owner.email',
    36|                     'Registrant Contact Name:' => 'owner.name',
    37|                     'Tech Contact Name:'		=> 'tech.name',
    38|                     'Tech Contact Email:'		=> 'tech.email',
    39|                     'Tech Contact ID:'			=> 'tech.handle',
    40|                     'Name Server:'		=> 'domain.nserver.'
    41| 		              );
    42| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
    43| 		$r['regyinfo'] = array(
    44|                     'referrer' => 'http://www.aunic.net',
    45|                     'registrar' => 'AU-NIC'
    46|                     );
    47| 		return $r;
    48| 		}
    49| 	}
    50| ?>


# ====================================================================
# FILE: src/whois.be.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-61 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__BE_HANDLER__'))
    22| 	define('__BE_HANDLER__', 1);
    23| class be_handler
    24| 	{
    25| 	function parse($data, $query)
    26| 		{
    27| 		$items = array(
    28|                 'domain.name'		=> 'Domain:',
    29|                 'domain.status'		=> 'Status:',
    30| 				'domain.nserver'	=> 'Nameservers:',
    31|                 'domain.created'	=> 'Registered:',
    32|                 'owner'				=> 'Licensee:',
    33|                 'admin'				=> 'Onsite Contacts:',
    34|                 'tech'				=> 'Registrar Technical Contacts:',
    35| 				'agent'				=> 'Registrar:',
    36| 				'agent.uri'			=> 'Website:'
    37| 				);
    38| 		$trans = array(
    39| 				'company name2:' => ''
    40| 				);
    41| 		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
    42| 		if ($r['regrinfo']['domain']['status'] == 'REGISTERED')
    43| 			{
    44| 			$r['regrinfo']['registered'] = 'yes';
    45| 			$r['regrinfo'] = get_contacts($r['regrinfo'],$trans);
    46| 			if (isset($r['regrinfo']['agent']))
    47| 				{
    48| 				$sponsor = get_contact($r['regrinfo']['agent'],$trans);
    49| 				unset($r['regrinfo']['agent']);
    50| 				$r['regrinfo']['domain']['sponsor'] = $sponsor;
    51| 				}
    52| 			$r = format_dates($r, '-mdy');
    53| 			}
    54| 		else
    55| 			$r['regrinfo']['registered'] = 'no';
    56| 		$r['regyinfo']['referrer'] = 'http://www.domain-registry.nl';
    57| 		$r['regyinfo']['registrar'] = 'DNS Belgium';
    58| 		return $r;
    59| 		}
    60| 	}
    61| ?>


# ====================================================================
# FILE: src/whois.bh.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-49 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C) 2011 Bernhard Reutner Fischer <rep.dot.nop@gmail.com>
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__BH_HANDLER__'))
    21| 	define('__BH_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class bh_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 		    'Sponsoring Registrar Name:' => 'domain.sponsor.name',
    29| 		    'Sponsoring Registrar Email:' => 'domain.sponsor.email',
    30| 		    'Sponsoring Registrar Uri:' => 'domain.sponsor.uri',
    31| 		    'Sponsoring Registrar Phone:' => 'domain.sponsor.phone'
    32| 	        );
    33| 		$i = generic_parser_b($data_str['rawdata'], $items);
    34| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    35| 		if (isset($r['regrinfo']['domain'])
    36| 		    && is_array($r['regrinfo']['domain']))
    37| 		    $r['regrinfo']['domain']['sponsor'] = $i['domain']['sponsor'];
    38| 		if (empty($r['regrinfo']['domain']['created']))
    39| 		    $r['regrinfo']['registered'] = 'no';
    40| 		else
    41| 		    $r['regrinfo']['registered'] = 'yes';
    42| 		$r['regyinfo'] = array(
    43|                     'referrer' => 'http://www.nic.bh/',
    44|                     'registrar' => 'NIC-BH'
    45|                     );
    46| 		return $r;
    47| 		}
    48| 	}
    49| ?>


# ====================================================================
# FILE: src/whois.biz.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__BIZ_HANDLER__'))
    21| 	define('__BIZ_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class biz_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, '-md--y');
    28| 		$r['regyinfo'] = array(
    29|                   'referrer' => 'http://www.neulevel.biz',
    30|                   'registrar' => 'NEULEVEL'
    31|                   );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.br.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-66 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__BR_HANDLER__'))
    22| 	define('__BR_HANDLER__', 1);
    23| class br_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28|                     'fax-no' => 'fax',
    29|                     'e-mail' => 'email',
    30|                     'nic-hdl-br' => 'handle',
    31|                     'person' => 'name',
    32|                     'netname' => 'name',
    33|                     'domain' => 'name',
    34|                     'updated' => ''
    35| 		                );
    36| 		$contacts = array(
    37|                     'owner-c' => 'owner',
    38|                     'tech-c' => 'tech',
    39|                     'admin-c' => 'admin',
    40|                     'billing-c' => 'billing'
    41| 		                );
    42| 		$r = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    43| 		if (in_array('Permission denied.', $r['disclaimer']))
    44| 			{
    45| 			$r['registered'] = 'unknown';
    46| 			return $r;
    47| 			}
    48| 		if (isset($r['domain']['nsstat'])) unset($r['domain']['nsstat']);
    49| 		if (isset($r['domain']['nslastaa'])) unset($r['domain']['nslastaa']);
    50| 		if (isset($r['domain']['owner']))
    51| 			{
    52| 			$r['owner']['organization'] = $r['domain']['owner'];
    53| 			unset($r['domain']['owner']);
    54| 			}
    55| 		if (isset($r['domain']['responsible'])) unset($r['domain']['responsible']);
    56| 		if (isset($r['domain']['address'])) unset($r['domain']['address']);
    57| 		if (isset($r['domain']['phone'])) unset($r['domain']['phone']);
    58| 		$a['regrinfo'] = $r;
    59| 		$a['regyinfo'] = array(
    60|                     'registrar' => 'BR-NIC',
    61|                     'referrer' => 'http://www.nic.br'
    62|                     );
    63| 		return $a;
    64| 		}
    65| 	}
    66| ?>


# ====================================================================
# FILE: src/whois.ca.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-61 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__CA_HANDLER__'))
    21| 	define('__CA_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class ca_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 						'owner'	=> 'Registrant:',
    29| 						'admin'	=> 'Administrative contact:',
    30| 						'tech'	=> 'Technical contact:',
    31| 						'domain.sponsor' => 'Registrar:',
    32| 						'domain.nserver' => 'Name servers:',
    33| 						'domain.status'	=> 'Domain status:',
    34| 						'domain.created' => 'Creation date:',
    35| 						'domain.expires' => 'Expiry date:',
    36| 						'domain.changed' => 'Updated date:'
    37| 						);
    38| 		$extra = array(
    39| 						'postal address:' => 'address.0',
    40| 						'job title:'	=> '',
    41| 						'number:'	=> 'handle',
    42| 						'description:'	=> 'organization'
    43| 						);
    44| 		$r['regrinfo'] = easy_parser($data_str['rawdata'],$items,'ymd',$extra);
    45| 		if (!empty($r['regrinfo']['domain']['sponsor']))
    46| 			{
    47| 			list($v,$reg) = explode(':',$r['regrinfo']['domain']['sponsor'][0]);
    48| 			$r['regrinfo']['domain']['sponsor'] = trim($reg);
    49| 			}
    50| 		if (empty($r['regrinfo']['domain']['status']) || $r['regrinfo']['domain']['status'] == 'available')
    51| 			$r['regrinfo']['registered'] = 'no';
    52| 		else
    53| 			$r['regrinfo']['registered'] = 'yes';
    54| 		$r['regyinfo'] = array(
    55|                   'registrar' => 'CIRA',
    56|                   'referrer' => 'http://www.cira.ca/'
    57|                   );
    58| 		return $r;
    59| 		}
    60| 	}
    61| ?>


# ====================================================================
# FILE: src/whois.cat.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__CAT_HANDLER__'))
    21| 	define('__CAT_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class cat_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		if (!isset($r['regrinfo']['domain']['name']))
    29| 			$r['regrinfo']['registered'] = 'no';
    30| 		$r['regyinfo']['referrer'] = 'http://www.domini.cat/';
    31| 		$r['regyinfo']['registrar'] = 'Domini punt CAT';
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.ch.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-62 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__CH_HANDLER__'))
    22| 	define('__CH_HANDLER__', 1);
    23| class ch_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'Holder of domain name:',
    29|                 'domain.name' => 'Domain name:',
    30|                 'domain.created' => 'Date of last registration:',
    31|                 'domain.changed' => 'Date of last modification:',
    32|                 'tech' => 'Technical contact:',
    33|                 'domain.nserver' => 'Name servers:',
    34|                 'domain.dnssec'	=> 'DNSSEC:'
    35| 		            );
    36| 		$trans = array(
    37| 					'contractual language:' => 'language'
    38| 					);
    39| 		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    40| 		if (!empty($r['regrinfo']['domain']['name']))
    41| 			{
    42| 			$r['regrinfo'] = get_contacts($r['regrinfo'],$trans);
    43| 			$r['regrinfo']['domain']['name'] = $r['regrinfo']['domain']['name'][0];
    44| 			if (isset($r['regrinfo']['domain']['changed'][0]))
    45| 				$r['regrinfo']['domain']['changed'] = get_date($r['regrinfo']['domain']['changed'][0], 'dmy');
    46| 			if (isset($r['regrinfo']['domain']['created'][0]))
    47| 				$r['regrinfo']['domain']['created'] = get_date($r['regrinfo']['domain']['created'][0], 'dmy');
    48| 			$r['regrinfo']['registered'] = 'yes';
    49| 			}
    50| 		else
    51| 			{
    52| 			$r = '';
    53| 			$r['regrinfo']['registered'] = 'no';
    54| 			}
    55| 		$r['regyinfo'] = array(
    56|                           'referrer' => 'http://www.nic.ch',
    57|                           'registrar' => 'SWITCH Domain Name Registration'
    58|                           );
    59| 		return $r;
    60| 		}
    61| 	}
    62| ?>


# ====================================================================
# FILE: src/whois.cl.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-44 ---
     1| ﻿<?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__CL_HANDLER__'))
    21| 	define('__CL_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class cl_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'admin' => '(Administrative Contact)',
    29|                   'tech' => 'Contacto Técnico (Technical Contact):',
    30|                   'domain.nserver' => 'Servidores de nombre (Domain servers):',
    31|                   'domain.changed' => '(Database last updated on):'
    32|                   );
    33| 		$trans = array(
    34| 					'organización:' => 'organization',
    35| 					'nombre      :' => 'name');
    36| 		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'd-m-y', $trans);
    37| 		$r['regyinfo'] = array(
    38|                     'referrer' => 'http://www.nic.cl',
    39|                     'registrar' => 'NIC Chile'
    40|                     );
    41| 		return $r;
    42| 		}
    43| 	}
    44| ?>


# ====================================================================
# FILE: src/whois.client.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-408 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| require_once('whois.ip.lib.php');
    21| class WhoisClient {
    22| 	var $gtld_recurse = false;
    23| 	var $PORT = 43;
    24| 	var $RETRY = 0;
    25| 	var $SLEEP = 2;
    26| 	var $BUFFER = 1024;
    27| 	var $STIMEOUT = 10;
    28| 	var $DATA = array(); 	
    29| 	var $Query = array(
    30| 		'tld' => '',
    31| 		'type' => 'domain',
    32| 		'query' => '',
    33| 		'status',
    34| 		'server'
    35| 		);
    36| 	var $CODE_VERSION = '4.2.2';
    37| 	var $VERSION;
    38| 	/*
    39| 	 * Constructor function
    40| 	 */
    41| 	function WhoisClient () {
    42| 		@require('whois.servers.php');		
    43| 		$this->VERSION = sprintf("phpWhois v%s-%s", $this->CODE_VERSION, $this->DATA_VERSION);
    44| 	}
    45| 	/*
    46| 	 * Perform lookup
    47| 	 */
    48| 	function GetRawData ($query) {
    49| 		$this->Query['query'] = $query;
    50| 		if (isset($this->Query['errstr'])) unset($this->Query['errstr']);
    51| 		if (!isset($this->Query['server'])) {
    52| 			$this->Query['status'] = 'error';
    53| 			$this->Query['errstr'][] = 'No server specified';
    54| 			return(array());
    55| 			}
    56| 		if (substr($this->Query['server'],0,7)=='http://' ||
    57| 			substr($this->Query['server'],0,8)=='https://')
    58| 			{
    59| 			$output = $this->httpQuery($this->Query['server']);
    60| 			if (!$output)
    61| 				{
    62| 				$this->Query['status'] = 'error';
    63| 				$this->Query['errstr'][] = 'Connect failed to: '.$this->Query['server'];
    64| 				return(array());
    65| 				}
    66| 			$this->Query['args'] = substr(strchr($this->Query['server'],'?'),1);
    67| 			$this->Query['server'] = strtok($this->Query['server'],'?');
    68| 			if (substr($this->Query['server'],0,7)=='http://')
    69| 				$this->Query['server_port'] = 80;
    70| 			else
    71| 				$this->Query['server_port'] = 483;
    72| 			}
    73| 		else
    74| 			{
    75| 			if (strpos($this->Query['server'],'?'))
    76| 				{
    77| 				$parts = explode('?',$this->Query['server']);
    78| 				$this->Query['server'] = trim($parts[0]);
    79| 				$query_args = trim($parts[1]);
    80| 				$query_args = str_replace('{query}', $query, $query_args);
    81| 				$query_args = str_replace('{version}', 'phpWhois'.$this->CODE_VERSION, $query_args);
    82| 				if (strpos($query_args,'{ip}')!==false)
    83| 					{
    84| 					$query_args = str_replace('{ip}', phpwhois_getclientip(), $query_args);
    85| 					}
    86| 				if (strpos($query_args,'{hname}')!==false)
    87| 					{
    88| 					$query_args = str_replace('{hname}', gethostbyaddr(phpwhois_getclientip()), $query_args);
    89| 					}
    90| 				}
    91| 			else
    92| 				{
    93| 				if (empty($this->Query['args']))
    94| 					$query_args = $query;
    95| 				else
    96| 					$query_args = $this->Query['args'];
    97| 				}
    98| 			$this->Query['args'] = $query_args;
    99| 			if (substr($this->Query['server'],0,9) == 'rwhois://')
   100| 				{
   101| 				$this->Query['server'] = substr($this->Query['server'],9);
   102| 				}
   103| 			if (substr($this->Query['server'],0,8) == 'whois://')
   104| 				{
   105| 				$this->Query['server'] = substr($this->Query['server'],8);
   106| 				}
   107| 			if (strpos($this->Query['server'],':'))
   108| 				{
   109| 				$parts = explode(':',$this->Query['server']);
   110| 				$this->Query['server'] = trim($parts[0]);
   111| 				$this->Query['server_port'] = trim($parts[1]);
   112| 				}
   113| 			else			
   114| 				$this->Query['server_port'] = $this->PORT;
   115| 			$ptr = $this->Connect();
   116| 			if($ptr < 0) {
   117| 				$this->Query['status'] = 'error';
   118| 				$this->Query['errstr'][] = 'Connect failed to: '.$this->Query['server'];
   119| 				return array();
   120| 				}
   121| 			stream_set_timeout($ptr,$this->STIMEOUT);
   122| 			stream_set_blocking($ptr,0);
   123| 			fputs($ptr, trim($query_args)."\r\n");
   124| 			$raw = '';
   125| 			$start = time();
   126| 			$null = NULL;
   127| 			$r = array($ptr);
   128| 			while (!feof($ptr))
   129| 				{
   130| 				if (!empty($r))
   131| 					{
   132| 					if (stream_select($r,$null,$null,$this->STIMEOUT))
   133| 						{
   134| 						$raw .= fgets($ptr, $this->BUFFER);
   135| 						}
   136| 					}
   137| 				if (time()-$start > $this->STIMEOUT)
   138| 					{
   139| 					$this->Query['status'] = 'error';
   140| 					$this->Query['errstr'][] = 'Timeout reading from '.$this->Query['server'];
   141| 					return array();
   142| 					}
   143| 				}
   144| 			if (array_key_exists($this->Query['server'],$this->NON_UTF8))
   145| 				{
   146| 				$raw = utf8_encode($raw);
   147| 				}
   148| 			$output = explode("\n", $raw);
   149| 			if (empty($output[count($output)-1]))
   150| 				unset($output[count($output)-1]);
   151| 			}
   152| 		return $output;	
   153| 	}
   154| 	/*
   155| 	 * Perform lookup. Returns an array. The 'rawdata' element contains an
   156| 	 * array of lines gathered from the whois query. If a top level domain
   157| 	 * handler class was found for the domain, other elements will have been
   158| 	 * populated too.
   159| 	 */
   160| 	function GetData ($query='', $deep_whois=true) {
   161| 		$query = !empty($query) ? $query : $this->Query['query'];
   162| 		$output = $this->GetRawData($query);
   163| 		$result = array( 'rawdata' => $output );		
   164| 		$result = $this->set_whois_info($result);
   165| 		if (empty($output)) return $result;
   166| 		if (isSet($this->Query['handler']))
   167| 			{
   168| 			$servers = $result['regyinfo']['servers'];
   169| 			unset($result['regyinfo']['servers']);
   170| 			$result = $this->Process($result,$deep_whois);
   171| 			if (isset($result['regyinfo']['servers']))
   172| 				$result['regyinfo']['servers'] = array_merge($servers,$result['regyinfo']['servers']);
   173| 			else
   174| 				$result['regyinfo']['servers'] = $servers;
   175| 			if (!isset($result['rawdata']))
   176| 				$result['rawdata'] = $output;
   177| 			}
   178| 		if (!isset($result['regyinfo']['type']))
   179| 			$result['regyinfo']['type'] = 'domain';	
   180| 		if (isset($this->Query['errstr']))
   181| 			$result['errstr'] = $this->Query['errstr'];
   182| 		if (method_exists($this,'FixResult') && $this->Query['tld'] != 'ip')
   183| 			$this->FixResult($result,$query);
   184| 		return($result);
   185| 	}
   186| 	/*
   187| 	*   Adds whois server query information to result
   188| 	*/
   189| 	function set_whois_info ($result)
   190| 		{
   191| 		$info = array(
   192| 					'server'=> $this->Query['server'],
   193| 					);
   194| 		if (!empty($this->Query['args']))
   195| 			$info['args'] = $this->Query['args'];
   196| 		else
   197| 			$info['args'] = $this->Query['query'];
   198| 		if (!empty($this->Query['server_port']))
   199| 			$info['port'] = $this->Query['server_port'];
   200| 		else
   201| 			$info['port'] = 43;
   202| 		if (isset($result['regyinfo']['whois']))
   203| 			unset($result['regyinfo']['whois']);
   204| 		if (isset($result['regyinfo']['rwhois']))
   205| 			unset($result['regyinfo']['rwhois']);
   206| 		$result['regyinfo']['servers'][] = $info;
   207| 		return $result;
   208| 		}
   209| 	/*
   210| 	*   Convert html output to plain text
   211| 	*/
   212| 	function httpQuery ($query) {
   213| 			$lines = @file($this->Query['server']);		
   214| 		if (!$lines) return false;
   215| 		$output = '';
   216| 		$pre = '';
   217| 		while (list($key, $val)=each($lines)) {
   218| 			$val = trim($val);
   219| 			$pos=strpos(strtoupper($val),'<PRE>');
   220| 			if ($pos!==false) {
   221| 				$pre = "\n";
   222| 				$output.=substr($val,0,$pos)."\n";
   223| 				$val = substr($val,$pos+5);
   224| 				}
   225| 			$pos=strpos(strtoupper($val),'</PRE>');
   226| 			if ($pos!==false) {
   227| 				$pre = '';
   228| 				$output.=substr($val,0,$pos)."\n";
   229| 				$val = substr($val,$pos+6);
   230| 				}
   231| 			$output.=$val.$pre;
   232| 			}
   233| 		$search = array (
   234| 				'<BR>', '<P>', '</TITLE>',
   235| 				'</H1>', '</H2>', '</H3>',
   236| 				'<br>', '<p>', '</title>',
   237| 				'</h1>', '</h2>', '</h3>'  );
   238| 		$output = str_replace($search,"\n",$output);
   239| 		$output = str_replace('<TD',' <td',$output);
   240| 		$output = str_replace('<td',' <td',$output);
   241| 		$output = str_replace('<tr',"\n<tr",$output);
   242| 		$output = str_replace('<TR',"\n<tr",$output);
   243| 		$output = str_replace('&nbsp;',' ',$output);
   244| 		$output = strip_tags($output);		
   245| 		$output = explode("\n",$output);
   246| 		$rawdata = array();
   247| 		$null = 0;
   248| 		while (list($key, $val)=each($output)) {
   249| 			$val=trim($val);
   250| 			if ($val=='') {
   251| 				if (++$null>2) continue;
   252| 			}
   253| 			else $null=0;
   254| 			$rawdata[]=$val;
   255| 		}
   256| 		return $rawdata;
   257| 	}
   258| 	/*
   259| 	 * Open a socket to the whois server.
   260| 	 *
   261| 	 * Returns a socket connection pointer on success, or -1 on failure.
   262| 	 */
   263| 	function Connect ($server = '') {
   264| 		if ($server == '')
   265| 			$server = $this->Query['server'];
   266| 		if($server == '')
   267| 			return(-1);
   268| 		$port = $this->Query['server_port'];
   269| 		$pos = strpos($server,'://');
   270| 		if ($pos !== false)
   271| 			$server = substr($server, $pos+3);
   272| 		$pos = strpos($server,':');
   273| 		if ($pos !== false)
   274| 			{
   275| 			$port = substr($server,$pos+1);
   276| 			$server = substr($server,0,$pos);			
   277| 			}
   278| 		$retry = 0;
   279| 		while($retry <= $this->RETRY) {
   280| 			$this->Query['status'] = 'ready';
   281| 			$ptr = @fsockopen($server, $port, $errno, $errstr, $this->STIMEOUT);
   282| 			if($ptr > 0) {
   283| 				$this->Query['status'] = 'ok';
   284| 				return($ptr);
   285| 			}
   286| 			$this->Query['status'] = 'error';
   287| 			$this->Query['error'][] = $errstr;
   288| 			$retry++;
   289| 			sleep($this->SLEEP);
   290| 		}
   291| 		return(-1);
   292| 	} 	
   293| 	/*
   294| 	 * Post-process result with handler class. On success, returns the result
   295| 	 * from the handler. On failure, returns passed result unaltered.
   296| 	 */
   297| 	function Process (&$result, $deep_whois=true) {
   298| 		$handler_name = str_replace('.','_',$this->Query['handler']);
   299| 		$HANDLER_FLAG = sprintf("__%s_HANDLER__", strtoupper($handler_name));
   300| 		if (!defined($HANDLER_FLAG))
   301| 			include($this->Query['file']);
   302| 		if (!defined($HANDLER_FLAG))
   303| 			{
   304| 			$this->Query['errstr'][] = "Can't find $handler_name handler: ".$this->Query['file'];
   305| 			return($result);
   306| 			}
   307| 		if (!$this->gtld_recurse && $this->Query['file'] == 'whois.gtld.php')
   308| 			return $result;
   309| 		$object = $handler_name.'_handler';
   310| 		$handler = new $object('');
   311| 		if(isSet($handler->Query['errstr']))
   312| 			$this->Query['errstr'][] = $handler->Query['errstr'];
   313| 		$handler->deep_whois = $deep_whois;
   314| 		$res = $handler->parse($result,$this->Query['query']);
   315| 		return $res;
   316| 	}	
   317| 	/*
   318| 	 * Does more (deeper) whois ...
   319| 	 */
   320| 	function DeepWhois ($query, $result) {
   321| 		if (!isset($result['regyinfo']['whois'])) return $result;
   322| 		$this->Query['server'] = $wserver = $result['regyinfo']['whois'];
   323| 		unset($result['regyinfo']['whois']);
   324| 		$subresult = $this->GetRawData($query);
   325| 		if (!empty($subresult))
   326| 			{
   327| 			$result = $this->set_whois_info($result);
   328| 			$result['rawdata'] = $subresult;
   329| 			if (isset($this->WHOIS_GTLD_HANDLER[$wserver]))
   330| 				$this->Query['handler'] = $this->WHOIS_GTLD_HANDLER[$wserver];
   331| 			else
   332| 				{
   333| 				$parts = explode('.',$wserver);
   334| 				$hname = strtolower($parts[1]);
   335| 				if (($fp = @fopen('whois.gtld.'.$hname.'.php', 'r', 1)) and fclose($fp))
   336| 					$this->Query['handler'] = $hname;
   337| 				}
   338| 			if (!empty($this->Query['handler']))
   339| 				{			
   340| 				$this->Query['file'] = sprintf('whois.gtld.%s.php', $this->Query['handler']);
   341| 				$regrinfo = $this->Process($subresult); //$result['rawdata']);
   342| 				$result['regrinfo'] = $this->merge_results($result['regrinfo'], $regrinfo);
   343| 				}
   344| 			}
   345| 		return $result;
   346| 	}
   347| 	/*
   348| 	 *  Merge results
   349| 	 */
   350| 	function merge_results($a1, $a2) {
   351| 		reset($a2);
   352| 		while (list($key, $val) = each($a2))
   353| 			{
   354| 			if (isset($a1[$key]))
   355| 				{
   356| 				if (is_array($val))
   357| 					{
   358| 					if ($key != 'nserver')
   359| 						$a1[$key] = $this->merge_results($a1[$key], $val);
   360| 					}
   361| 				else
   362| 					{
   363| 					$val = trim($val);
   364| 					if ($val != '')
   365| 						$a1[$key] = $val;
   366| 					}
   367| 				}
   368| 			else
   369| 				$a1[$key] = $val;
   370| 			}
   371| 		return $a1;
   372| 	}
   373| 	function FixNameServer($nserver)
   374| 		{
   375| 		$dns = array();
   376| 		foreach($nserver as $val)
   377| 			{
   378| 			$val = str_replace( array('[',']','(',')'), '', trim($val));
   379| 			$val = str_replace("\t", ' ', $val);
   380| 			$parts = explode(' ', $val);
   381| 			$host = '';
   382| 			$ip = '';
   383| 			foreach($parts as $p)
   384| 				{
   385| 				if (substr($p,-1) == '.') $p = substr($p,0,-1);
   386| 				if ((ip2long($p) == - 1) or (ip2long($p) === false))
   387| 					{
   388| 					if ($host == '' && preg_match('/^[\w\-]+(\.[\w\-]+)+$/',$p))
   389| 						{
   390| 						$host = $p;
   391| 						}
   392| 					}
   393| 				else
   394| 					$ip = $p;
   395| 				}
   396| 			if ($host == '') continue;
   397| 			if ($ip == '')
   398| 				{
   399| 				$ip = gethostbyname($host);
   400| 				if ($ip == $host) $ip = '(DOES NOT EXIST)';
   401| 				}
   402| 			if (substr($host,-1,1) == '.') $host = substr($host,0,-1);
   403| 			$dns[strtolower($host)] = $ip;
   404| 			}
   405| 		return $dns;
   406| 		}
   407| }
   408| ?>


# ====================================================================
# FILE: src/whois.cn.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-80 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__CN_HANDLER__'))
    21| 	define('__CN_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class cn_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'Domain Name:' => 'domain.name',
    29|                 'Domain Status:' => 'domain.status.',
    30|                 'ROID:' => 'domain.handle',
    31|                 'Name Server:' => 'domain.nserver.',
    32|                 'Registration Date:' => 'domain.created',
    33|                 'Expiration Date:' => 'domain.expires',
    34|                 'Sponsoring Registrar:' => 'domain.sponsor',
    35|                 'Registrant Name:' => 'owner.name',
    36|                 'Registrant Organization:' => 'owner.organization',
    37|                 'Registrant Address:' => 'owner.address.address',
    38|                 'Registrant Postal Code:' => 'owner.address.pcode',
    39|                 'Registrant City:' => 'owner.address.city',
    40|                 'Registrant Country Code:' => 'owner.address.country',
    41|                 'Registrant Email:' => 'owner.email',
    42|                 'Registrant Phone Number:' => 'owner.phone',
    43|                 'Registrant Fax:' => 'owner.fax',
    44|                 'Administrative Name:' => 'admin.name',
    45|                 'Administrative Organization:' => 'admin.organization',
    46|                 'Administrative Address:' => 'admin.address.address',
    47|                 'Administrative Postal Code:' => 'admin.address.pcode',
    48|                 'Administrative City:' => 'admin.address.city',
    49|                 'Administrative Country Code:' => 'admin.address.country',
    50|                 'Administrative Email:' => 'admin.email',
    51|                 'Administrative Phone Number:' => 'admin.phone',
    52|                 'Administrative Fax:' => 'admin.fax',
    53|                 'Technical Name:' => 'tech.name',
    54|                 'Technical Organization:' => 'tech.organization',
    55|                 'Technical Address:' => 'tech.address.address',
    56|                 'Technical Postal Code:' => 'tech.address.pcode',
    57|                 'Technical City:' => 'tech.address.city',
    58|                 'tec-country:' => 'tech.address.country',
    59|                 'Technical Email:' => 'tech.email',
    60|                 'Technical Phone Number:' => 'tech.phone',
    61|                 'Technical Fax:' => 'tech.fax',
    62|                 'Billing Name:' => 'billing.name',
    63|                 'Billing Organization:' => 'billing.organization',
    64|                 'Billing Address:' => 'billing.address.address',
    65|                 'Billing Postal Code:' => 'billing.address.pcode',
    66|                 'Billing City:' => 'billing.address.city',
    67|                 'Billing Country Code:' => 'billing.address.country',
    68|                 'Billing Email:' => 'billing.email',
    69|                 'Billing Phone Number:' => 'billing.phone',
    70|                 'Billing Fax:' => 'billing.fax'
    71| 		            );
    72| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
    73| 		$r['regyinfo'] = array(
    74|                 'referrer' => 'http://www.cnnic.net.cn',
    75|                 'registrar' => 'China NIC'
    76|                 );
    77| 		return $r;
    78| 		}
    79| 	}
    80| ?>


# ====================================================================
# FILE: src/whois.co.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-33 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__CO_HANDLER__'))
    21| 	define('__CO_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class co_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, '-md--y');
    28| 		$r['regyinfo']['referrer'] = 'http://www.cointernet.com.co/';
    29| 		$r['regyinfo']['registrar'] = '.CO Internet, S.A.S.';
    30| 		return $r;
    31| 		}
    32| 	}
    33| ?>


# ====================================================================
# FILE: src/whois.co.za.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-61 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__CO_ZA_HANDLER__'))
    21| 	define('__CO_ZA_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class co_Za_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                     '0a. lastupdate             :'	=> 'domain.changed',
    29|                     '1a. domain                 :'	=> 'domain.name',
    30|                     '2b. registrantpostaladdress:'	=> 'owner.address.address.0',
    31|                     '2f. billingaccount         :'	=> 'billing.name',
    32|                     '2g. billingemail           :'  => 'billing.email',
    33|                     '2i. invoiceaddress         :'	=> 'billing.address',
    34|                     '2j. registrantphone        :'	=> 'owner.phone',
    35|                     '2k. registrantfax          :'	=> 'owner.fax',
    36|                     '2l. registrantemail        :'	=> 'owner.email',
    37|                     '4a. admin                  :'	=> 'admin.name',
    38|                     '4c. admincompany           :'	=> 'admin.organization',
    39|                     '4d. adminpostaladdr        :'	=> 'admin.address',
    40|                     '4e. adminphone             :'	=> 'admin.phone',
    41|                     '4f. adminfax               :'	=> 'admin.fax',
    42|                     '4g. adminemail             :'	=> 'admin.email',
    43|                     '5a. tec                    :'	=> 'tech.name',
    44|                     '5c. teccompany             :'	=> 'tech.organization',
    45|                     '5d. tecpostaladdr          :'	=> 'tech.address',
    46|                     '5e. tecphone               :'	=> 'tech.phone',
    47|                     '5f. tecfax                 :'	=> 'tech.fax',
    48|                     '5g. tecemail               :'	=> 'tech.email',
    49|                     '6a. primnsfqdn             :'	=> 'domain.nserver.0',
    50|                     '6e. secns1fqdn             :'	=> 'domain.nserver.1',
    51|                     '6i. secns2fqdn             :'	=> 'domain.nserver.2',
    52|                     '6m. secns3fqdn             :'	=> 'domain.nserver.3',
    53|                     '6q. secns4fqdn             :'	=> 'domain.nserver.4'
    54| 		              );
    55| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
    56| 		$r['regyinfo']['referrer'] = 'http://www.co.za';
    57| 		$r['regyinfo']['registrar'] = 'UniForum Association';
    58| 		return $r;
    59| 		}
    60| 	}
    61| ?>


# ====================================================================
# FILE: src/whois.coop.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-86 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__COOP_HANDLER__'))
    21| 	define('__COOP_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class coop_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array (
    28| 						'owner' => 'Contact Type:            registrant',
    29| 						'admin' => 'Contact Type:            admin',
    30| 						'tech' => 'Contact Type:            tech',
    31| 						'billing' => 'Contact Type:            billing',
    32| 						'domain.name' => 'Domain Name:',
    33| 						'domain.handle' => 'Domain ID:',
    34| 						'domain.expires' => 'Expiry Date:',
    35| 						'domain.created' => 'Created:',
    36| 						'domain.changed' => 'Last updated:',
    37| 						'domain.status' => 'Domain Status:',
    38| 						'domain.sponsor' => 'Sponsoring registrar:',
    39| 						'domain.nserver.' => 'Host Name:'
    40| 						);
    41| 		$translate = array(
    42| 						'Contact ID:' => 'handle',
    43| 						'Name:' => 'name',
    44| 						'Organisation:' => 'organization',
    45| 						'Street 1:' => 'address.street.0',
    46| 						'Street 2:' => 'address.street.1',
    47| 						'Street 3:' => 'address.street.2',
    48| 						'City:' => 'address.city',
    49| 						'State/Province:' => 'address.state',
    50| 						'Postal code:' => 'address.pcode',
    51| 						'Country:' => 'address.country',
    52| 						'Voice:' => 'phone',
    53| 						'Fax:' => 'fax',
    54| 						'Email:' => 'email'
    55| 						);
    56| 		$blocks = get_blocks($data_str['rawdata'],$items);
    57| 		$r=array();
    58| 		if (isset($blocks['domain']))
    59| 			{
    60| 			$r['regrinfo']['domain'] = format_dates($blocks['domain'],'dmy');
    61| 			$r['regrinfo']['registered'] = 'yes';
    62| 			if (isset($blocks['owner']))
    63| 				{
    64| 				$r['regrinfo']['owner'] = generic_parser_b($blocks['owner'],$translate,'dmy',false);
    65| 				if (isset($blocks['tech']))
    66| 					$r['regrinfo']['tech'] = generic_parser_b($blocks['tech'],$translate,'dmy',false);
    67| 				if (isset($blocks['admin']))
    68| 					$r['regrinfo']['admin'] = generic_parser_b($blocks['admin'],$translate,'dmy',false);
    69| 				if (isset($blocks['billing']))
    70| 					$r['regrinfo']['billing'] = generic_parser_b($blocks['billing'],$translate,'dmy',false);
    71| 				}
    72| 			else
    73| 				{
    74| 				$r['regrinfo']['owner'] = generic_parser_b($data_str['rawdata'],$translate,'dmy',false);
    75| 				}
    76| 			}
    77| 		else
    78| 			$r['regrinfo']['registered'] = 'no';
    79| 		$r['regyinfo'] = array(
    80|                           'referrer' => 'http://www.nic.coop',
    81|                           'registrar' => '.coop registry'
    82|                           );
    83| 		return $r;
    84| 		}
    85| 	}
    86| ?>


# ====================================================================
# FILE: src/whois.cz.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-58 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__CZ_HANDLER__'))
    21| 	define('__CZ_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class cz_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28|                       'expire' 	=> 'expires',
    29|                       'registered' => 'created',
    30|                       'nserver' => 'nserver',
    31|                       'domain' 	=> 'name',
    32|                       'contact' => 'handle',
    33|                       'reg-c'	=> '',
    34|                       'descr'	=> 'desc',
    35|                       'e-mail'	=> 'email',
    36|                       'person'	=> 'name',
    37|                       'org'		=> 'organization',
    38|                       'fax-no'	=> 'fax'
    39| 		                  );
    40| 		$contacts = array(
    41|                       'admin-c' => 'admin',
    42|                       'tech-c' => 'tech',
    43|                       'bill-c' => 'billing',
    44|                       'registrant' => 'owner'
    45| 		                  );
    46| 		$r['regrinfo'] = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'dmy');
    47| 		$r['regyinfo'] = array(
    48|                           'referrer' => 'http://www.nic.cz',
    49|                           'registrar' => 'CZ-NIC'
    50|                           );
    51| 		if ($data_str['rawdata'][0] == 'Your connection limit exceeded. Please slow down and try again later.')
    52| 			{
    53| 			$r['regrinfo']['registered'] = 'unknown';
    54| 			}
    55| 		return $r;
    56| 		}
    57| 	}
    58| ?>


# ====================================================================
# FILE: src/whois.de.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-64 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__DE_HANDLER__'))
    21| 	define('__DE_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class de_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 			'domain.name' =>	'Domain:',
    29| 			'domain.nserver.' =>'Nserver:',
    30| 			'domain.nserver.#' =>'Nsentry:',
    31| 			'domain.status' =>	'Status:',
    32| 			'domain.changed' =>	'Changed:',
    33| 			'domain.desc.' =>	'Descr:',
    34| 			'owner' =>	'[Holder]',
    35| 			'admin' =>	'[Admin-C]',
    36| 			'tech' =>	'[Tech-C]',
    37| 			'zone' =>	'[Zone-C]'
    38| 		            );
    39| 		$extra = array(
    40| 			'city:' => 'address.city',
    41| 			'postalcode:' => 'address.pcode',
    42| 			'countrycode:' => 'address.country',
    43| 			'remarks:' => '',
    44| 			'sip:' => 'sip',
    45| 			'type:'	=> ''
    46| 		            );
    47| 		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd',$extra);
    48| 		$r['regyinfo'] = array(
    49|                   'registrar' => 'DENIC eG',
    50|                   'referrer' => 'http://www.denic.de/'
    51|                   );
    52| 		 if (!isset($r['regrinfo']['domain']['status']) || $r['regrinfo']['domain']['status'] == "free")
    53| 			{
    54|             $r['regrinfo']['registered'] = 'no';
    55|             }
    56|          else
    57| 			{
    58| 			$r['regrinfo']['domain']['changed'] = substr($r['regrinfo']['domain']['changed'], 0, 10);
    59| 			$r['regrinfo']['registered'] = 'yes';
    60| 			}
    61| 		return $r;
    62| 		}
    63| 	}
    64| ?>


# ====================================================================
# FILE: src/whois.edu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-49 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__EDU_HANDLER__'))
    21| 	define('__EDU_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class edu_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 				'domain.name' => 'Domain name:',
    29|                 'domain.sponsor' => 'Registrar:',
    30|                 'domain.nserver' => 'Name Servers:',
    31|                 'domain.changed' => 'Domain record last updated:',
    32|                 'domain.created' => 'Domain record activated:',
    33|                 'owner'	=> 'Registrant:',
    34|                 'admin' => 'Administrative Contact:',
    35|                 'tech' => 'Technical Contact:',
    36|                 'billing' => 'Billing Contact:'
    37| 		            );
    38| 		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'dmy');
    39| 		if (isset($b['tech']))
    40| 			{
    41| 			if ($r['regrinfo']['tech']['name'] == 'Same as above')
    42| 				$r['regrinfo']['tech'] = $r['regrinfo']['admin'];
    43| 			}
    44| 		$r['regyinfo']['referrer'] = 'http://whois.educause.net';
    45| 		$r['regyinfo']['registrar'] = 'EDUCASE';
    46| 		return ($r);
    47| 		}
    48| 	}
    49| ?>


# ====================================================================
# FILE: src/whois.eu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-66 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__EU_HANDLER__'))
    22| 	define('__EU_HANDLER__', 1);
    23| class eu_handler
    24| 	{
    25| 	function parse($data, $query)
    26| 		{
    27| 		$items = array(
    28|                 'domain.name'		=> 'Domain:',
    29|                 'domain.status'		=> 'Status:',
    30| 				'domain.nserver'	=> 'Name servers:',
    31|                 'domain.created'	=> 'Registered:',
    32|                 'domain.registrar'	=> 'Registrar:',
    33|                 'tech'				=> 'Registrar Technical Contacts:',
    34|                 'owner'				=> 'Registrant:',
    35|                 ''					=> 'Please visit'
    36| 				);
    37| 		$extra = array(
    38| 				'organisation:' => 'organization',
    39| 				'website:'		=> 'url'
    40| 				);
    41| 		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
    42| 		if (!empty($r['regrinfo']['domain']['status']))
    43| 			switch ($r['regrinfo']['domain']['status'])
    44| 				{
    45| 				case 'FREE':
    46| 				case 'AVAILABLE':
    47| 					$r['regrinfo']['registered'] = 'no';
    48| 					break;
    49| 				case 'APPLICATION PENDING':
    50| 					$r['regrinfo']['registered'] = 'pending';
    51| 					break;
    52| 				default:
    53| 					$r['regrinfo']['registered'] = 'unknown';
    54| 				}
    55| 		else
    56| 			$r['regrinfo']['registered'] = 'yes';
    57| 		if (isset($r['regrinfo']['tech']))
    58| 			$r['regrinfo']['tech'] = get_contact($r['regrinfo']['tech'],$extra);
    59| 		if (isset($r['regrinfo']['domain']['registrar']))
    60| 			$r['regrinfo']['domain']['registrar'] = get_contact($r['regrinfo']['domain']['registrar'],$extra);
    61| 		$r['regyinfo']['referrer'] = 'http://www.eurid.eu';
    62| 		$r['regyinfo']['registrar'] = 'EURID';
    63| 		return $r;
    64| 		}
    65| 	}
    66| ?>


# ====================================================================
# FILE: src/whois.fi.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__FI_HANDLER__'))
    21| 	define('__FI_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class fi_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'domain:' => 'domain.name',
    29|                   'created:' => 'domain.created',
    30|                   'expires:' => 'domain.expires',
    31|                   'status:' => 'domain.status',
    32|                   'nserver:' => 'domain.nserver.',
    33|                   'descr:' => 'owner.name.',
    34|                   'address:' => 'owner.address.',
    35|                   'phone:' => 'owner.phone',
    36|                     );
    37| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
    38| 		$r['regyinfo'] = array(
    39|                           'referrer' => 'https://domain.ficora.fi/',
    40|                           'registrar' => 'Finnish Communications Regulatory Authority'
    41|                           );
    42| 		return $r;
    43| 		}
    44| 	}
    45| ?>


# ====================================================================
# FILE: src/whois.fj.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__FJ_HANDLER__'))
    22| 	define('__FJ_HANDLER__', 1);
    23| class fj_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 				'owner' => 'Registrant:',
    29| 				'domain.status' => 'Status:',
    30| 				'domain.expires' => 'Expires:',
    31| 				'domain.nserver' => 'Domain servers:'
    32| 		            );
    33| 		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    34| 		if (!empty($r['regrinfo']['domain']['status']))
    35| 			{
    36| 			$r['regrinfo'] = get_contacts($r['regrinfo']);
    37| 			date_default_timezone_set("Pacific/Fiji");
    38| 			if (isset($r['regrinfo']['domain']['expires']))
    39| 				$r['regrinfo']['domain']['expires'] = strftime("%Y-%m-%d",strtotime($r['regrinfo']['domain']['expires']));
    40| 			$r['regrinfo']['registered'] = 'yes';
    41| 			}
    42| 		else
    43| 			$r['regrinfo']['registered'] = 'no';
    44| 		$r['regyinfo'] = array(
    45|                          'referrer' => 'http://www.domains.fj',
    46|                          'registrar' => 'FJ Domain Name Registry'
    47|                          );
    48| 		return $r;
    49| 		}
    50| 	}
    51| ?>


# ====================================================================
# FILE: src/whois.fm.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-64 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__FM_HANDLER__'))
    21| 	define('__FM_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class fm_handler
    24| 	{
    25| 	function parse($data, $query)
    26| 		{
    27| 		$items = array(
    28| 				  'owner' => 'Registrant',
    29|                   'admin' => 'Admin',
    30|                   'tech' => 'Technical',
    31|                   'billing' => 'Billing',
    32|                   'domain.nserver' => 'Name Servers:',
    33|                   'domain.created' => 'Created:',
    34|                   'domain.expires' => 'Expires:',
    35|                   'domain.changed' => 'Modified:',
    36|                   'domain.status' => 'Status:',
    37|                   'domain.sponsor' => 'Registrar Name:'
    38|                   );
    39| 		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
    40| 		$items = array(
    41| 						'phone number:' => 'phone',
    42| 						'email address:' => 'email',
    43| 						'fax number:' => 'fax',
    44| 						'organisation:' => 'organization'
    45| 						);
    46| 		if (!empty($r['regrinfo']['domain']['created']))
    47| 			{
    48| 			$r['regrinfo'] = get_contacts($r['regrinfo'],$items);
    49| 			if (count($r['regrinfo']['billing']['address']) > 4)
    50| 				$r['regrinfo']['billing']['address'] = array_slice($r['regrinfo']['billing']['address'],0,4);
    51| 			$r['regrinfo']['registered'] = 'yes';
    52| 			format_dates($r['regrinfo']['domain'],'dmY');
    53| 			}
    54| 		else
    55| 			{
    56| 			$r = '';
    57| 			$r['regrinfo']['registered'] = 'no';
    58| 			}
    59| 		$r['regyinfo']['referrer'] = 'http://www.dot.dm';
    60| 		$r['regyinfo']['registrar'] = 'dotFM';
    61| 		return $r;
    62| 		}
    63| 	}
    64| ?>


# ====================================================================
# FILE: src/whois.fr.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-64 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__FR_HANDLER__'))
    21| 	define('__FR_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class fr_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28| 						'fax-no' => 'fax',
    29| 						'e-mail' => 'email',
    30| 						'nic-hdl' => 'handle',
    31| 						'ns-list' => 'handle',
    32| 						'person' => 'name',
    33| 						'address' => 'address.',
    34| 						'descr' => 'desc',
    35| 						'anniversary'	=> '',
    36| 						'domain'	=> '',
    37| 						'last-update' => 'changed',
    38| 						'registered' => 'created',
    39| 						'country' => 'address.country',
    40| 						'registrar' => 'sponsor',
    41| 						'role'	=> 'organization'
    42| 		                  );
    43| 		$contacts = array(
    44| 						'admin-c' 	=> 'admin',
    45| 						'tech-c' 	=> 'tech',
    46| 						'zone-c' 	=> 'zone',
    47| 						'holder-c'	=> 'owner',
    48| 						'nsl-id'	=> 'nserver'
    49| 		                  );
    50| 		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain','dmY');
    51| 		if (isset($reg['nserver']))
    52| 			{
    53| 			$reg['domain'] = array_merge($reg['domain'],$reg['nserver']);
    54| 			unset($reg['nserver']);
    55| 			}
    56| 		$r['regrinfo'] = $reg;
    57| 		$r['regyinfo'] = array(
    58|                           'referrer' => 'http://www.nic.fr',
    59|                           'registrar' => 'AFNIC'
    60|                           );
    61| 		return $r;
    62| 		}
    63| 	}
    64| ?>


# ====================================================================
# FILE: src/whois.gtld.afternic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__AFTERNIC_HANDLER__'))
    21| 	define('__AFTERNIC_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class afternic_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'Registrant:',
    29|                 'admin' => 'Administrative Contact',
    30|                 'tech' => 'Technical Contact',
    31|                 'zone' => 'Zone Contact',
    32|                 'domain.name' => 'Domain Name:',
    33|                 'domain.changed' => 'Last updated on',
    34|                 'domain.created' => 'Domain created on',
    35|                 'domain.expires' => 'Domain expires on'
    36| 		            );
    37| 		return easy_parser($data_str, $items, 'dmy', false, false, true);
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.alldomains.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-38 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ALLDOMAINS_HANDLER__'))
    21| 	define('__ALLDOMAINS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class alldomains_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner'	=> 'Registrant:',
    29|                 'admin' => 'Administrative',
    30|                 'tech' => 'Technical',
    31|                 'domain.name' => 'Domain name:',
    32|                 'domain.sponsor' => 'Registrar:',
    33|                 'domain.nserver.' => 'Domain servers in listed order:'
    34| 		            );
    35| 		return easy_parser($data_str, $items, 'ymd');
    36| 		}
    37| 	}
    38| ?>


# ====================================================================
# FILE: src/whois.gtld.ascio.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ASCIO_HANDLER__'))
    21| 	define('__ASCIO_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class ascio_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'Registrant:',
    29|                 'admin' => 'Administrative ',
    30|                 'tech' => 'Technical ',
    31|                 'domain.name' => 'Domain name:',
    32|                 'domain.nserver.' => 'Domain servers in listed order:',
    33|                 'domain.created' => 'Record created:',
    34|                 'domain.expires' => 'Record expires:',
    35|                 'domain.changed' => 'Record last updated:'
    36| 		            );
    37| 		return easy_parser($data_str, $items, 'ymd',false,false,true);
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.assorted.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ASSORTED_HANDLER__'))
    21| 	define('__ASSORTED_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class assorted_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner'	=> 'Registrant:',
    29|                 'admin' => 'Administrative Contact:',
    30|                 'tech' => 'Technical Contact:',
    31|                 'domain.name' => 'Domain Name:',
    32|                 'domain.nserver.' => 'Domain servers in listed order:',
    33|                 'domain.created' => 'Record created on',
    34|                 'domain.expires' => 'Record expires on',
    35|                 'domain.changed' => 'Record last updated'
    36| 		            );
    37| 		return easy_parser($data_str, $items, 'ymd',false,false,true);
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.corporatedomains.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__CORPORATEDOMAINS_HANDLER__'))
    21| 	define('__CORPORATEDOMAINS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class corporatedomains_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'Registrant:',
    29|                 'admin' => 'Administrative Contact',
    30|                 'tech' => 'Technical Contact',
    31|                 'zone' => 'Zone Contact',
    32|                 'domain.name' => 'Domain Name:',
    33|                 'domain.changed' => 'Last updated on',
    34|                 'domain.created' => 'Domain created on',
    35|                 'domain.expires' => 'Domain expires on',
    36|                 'domain.sponsor' => 'Registrar Name....:',
    37|                 'domain.nserver' => 'DNS Servers:'
    38| 		            );
    39| 		return easy_parser($data_str, $items, 'dmy', false, false, true);
    40| 		}
    41| 	}
    42| ?>


# ====================================================================
# FILE: src/whois.gtld.directnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__DIRECTNIC_HANDLER__'))
    21| 	define('__DIRECTNIC_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class directnic_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|               'owner' => 'Registrant:',
    29|               'admin' => 'Administrative Contact',
    30|               'tech' => 'Technical Contact',
    31|               'domain.name' => 'Domain Name:',
    32|               'domain.sponsor' => 'Registration Service Provider:',
    33|               'domain.nserver' => 'Domain servers in listed order:',
    34|               'domain.changed' => 'Record last updated ',
    35|               'domain.created' => 'Record created on ',
    36|               'domain.expires' => 'Record expires on ',
    37|               '' => 'By submitting a WHOIS query'
    38| 		          );
    39| 		return easy_parser($data_str, $items, 'mdy',false,false,true);
    40| 		}
    41| 	}
    42| ?>


# ====================================================================
# FILE: src/whois.gtld.domaindiscover.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__DOMAINDISCOVER_HANDLER__'))
    21| 	define('__DOMAINDISCOVER_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class domaindiscover_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'Registrant:',
    29|                 'admin' => 'Administrative Contact',
    30|                 'tech' => 'Technical Contact',
    31|                 'zone' => 'Zone Contact',
    32|                 'domain.name' => 'Domain Name:',
    33|                 'domain.changed' => 'Last updated on',
    34|                 'domain.created' => 'Domain created on',
    35|                 'domain.expires' => 'Domain expires on'
    36| 		            );
    37| 		return easy_parser($data_str, $items, 'dmy', false, false, true);
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.domainpeople.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__DOMAINPEOPLE_HANDLER__'))
    21| 	define('__DOMAINPEOPLE_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class domainpeople_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant Contact:',
    29|                   'admin' => 'Administrative Contact:',
    30|                   'tech' => 'Technical Contact:',
    31|                   'domain.name' => 'Domain name:',
    32|                   'domain.sponsor' => 'Registration Service Provided By:',
    33|                   'domain.referrer' => 'Contact:',
    34|                   'domain.nserver.' => 'Name Servers:',
    35|                   'domain.created' => 'Creation date:',
    36|                   'domain.expires' => 'Expiration date:',
    37|                   'domain.status' => 'Status:'
    38| 		              );
    39| 		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
    40| 		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    41| 		$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    42| 		return $r;
    43| 		}
    44| 	}
    45| ?>


# ====================================================================
# FILE: src/whois.gtld.dotster.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__DOTSTER_HANDLER__'))
    21| 	define('__DOTSTER_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class dotster_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant:',
    29|                   'admin' => 'Administrative',
    30|                   'tech' => 'Technical',
    31|                   'domain.nserver' =>
    32|                   'Domain servers in listed order:',
    33|                   'domain.name' => 'Domain name:',
    34|                   'domain.created' => 'Created on:',
    35|                   'domain.expires' => 'Expires on:',
    36|                   'domain.changed' => 'Last Updated on:',
    37|                   'domain.sponsor' => 'Registrar:'
    38| 		              );
    39| 		return easy_parser($data_str, $items, 'dmy');
    40| 		}
    41| 	}
    42| ?>


# ====================================================================
# FILE: src/whois.gtld.dreamhost.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__DREAMHOST_HANDLER__'))
    21| 	define('__DREAMHOST_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class dreamhost_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant Contact:',
    29|                   'admin' => 'Administrative Contact:',
    30|                   'tech' => 'Technical Contact:',
    31|                   'billing' => 'Billing Contact:',
    32|                   'domain.name' => 'Domain Name:',
    33|                   'domain.nserver' => 'Domain servers in listed order:',
    34|                   'domain.created' => 'Record created on',
    35|                   'domain.expires' => 'Record expires on'
    36| 		              );
    37| 		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
    38| 		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    39| 		$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    40| 		return $r;
    41| 		}
    42| 	}
    43| ?>


# ====================================================================
# FILE: src/whois.gtld.enom.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ENOM_HANDLER__'))
    21| 	define('__ENOM_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class enom_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner#0'				=> 'Registrant Contact',
    29|                   'owner#1'				=> 'REGISTRANT Contact:',
    30|                   'admin#0'				=> 'Administrative Contact',
    31|                   'admin#1'				=> 'ADMINISTRATIVE Contact:',
    32|                   'tech#0'				=> 'Technical Contact',
    33|                   'tech#1'				=> 'TECHNICAL Contact:',
    34|                   'billing#0'			=> 'Billing Contact',
    35|                   'billing#1'			=> 'BILLING Contact:',
    36|                   'domain.nserver'		=> 'Nameservers',
    37|                   'domain.name#0'		=> 'Domain name:',
    38|                   'domain.name#1'		=> 'Domain name-',
    39|                   'domain.sponsor'		=> 'Registration Service Provided By:',
    40|                   'domain.status'		=> 'Status:',
    41|                   'domain.created#0'	=> 'Creation date:',
    42|                   'domain.expires#0'	=> 'Expiration date:',
    43|                   'domain.created#1'	=> 'Created:',
    44|                   'domain.expires#1'	=> 'Expires:',
    45|                   'domain.created#2'	=> 'Start of registration-',
    46|                   'domain.expires#2'	=> 'Registered through-'
    47|                   );
    48| 		return easy_parser($data_str, $items, 'dmy', false, false, true);
    49| 		}
    50| 	}
    51| ?>


# ====================================================================
# FILE: src/whois.gtld.fabulous.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__FABULOUS_HANDLER__'))
    21| 	define('__FABULOUS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class fabulous_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|               'owner' => 'Domain '.$query.':',
    29|               'admin' => 'Administrative contact:',
    30|               'tech' => 'Technical contact:',
    31|               'billing' => 'Billing contact:',
    32|               '' => 'Record dates:'
    33| 		          );
    34| 		$r = easy_parser($data_str, $items, 'mdy',false,false,true);
    35| 		if (!isset($r['tech'])) $r['tech'] = $r['billing'];
    36| 		if (!isset($r['admin'])) $r['admin'] = $r['tech'];
    37| 		return $r;
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.fastdomain.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-62 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__FASTDOMAIN_HANDLER__'))
    21| 	define('__FASTDOMAIN_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class fastdomain_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant Info:',
    29|                   'admin' => 'Administrative Info:',
    30|                   'tech' => 'Technical Info:',
    31|                   'domain.name' => 'Domain Name:',
    32|                   'domain.sponsor' => 'Provider Name....:',
    33|                   'domain.referrer' => 'Provider Homepage:',
    34|                   'domain.nserver' => 'Domain servers in listed order:',
    35|                   'domain.created' => 'Created on..............:',
    36|                   'domain.expires' => 'Expires on..............:',
    37|                   'domain.changed' => 'Last modified on........:',
    38|                   'domain.status' => 'Status:'
    39| 		              );
    40| 		while (list($key, $val) = each($data_str))
    41| 			{
    42| 			$faststr = strpos($val, ' (FAST-');
    43| 			if ($faststr)
    44| 				$data_str[$key] = substr($val, 0, $faststr);
    45| 			}
    46| 		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
    47| 		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    48| 		$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    49| 		if (isset($r['domain']['nserver']))
    50| 			{
    51| 			reset($r['domain']['nserver']);
    52| 			$endnserver = false;
    53| 			while (list($key, $val) = each($r['domain']['nserver']))
    54| 				{
    55| 				if ($val == '=-=-=-=')
    56| 					unset($r['domain']['nserver'][$key]);
    57| 				}
    58| 			}
    59| 		return $r;
    60| 		}
    61| 	}
    62| ?>


# ====================================================================
# FILE: src/whois.gtld.gandi.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-44 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__GANDI_HANDLER__'))
    21| 	define('__GANDI_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class gandi_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'owner-c',
    29|                   'admin' => 'admin-c',
    30|                   'tech' => 'tech-c',
    31|                   'billing' => 'bill-c'
    32| 		              );
    33| 		$trans = array(
    34| 					'nic-hdl:'	=> 'handle',
    35| 					'person:'	=> 'name',
    36| 					'zipcode:'	=> 'address.pcode',
    37| 					'city:'		=> 'address.city',
    38| 					'lastupdated:' => 'changed',
    39| 					'owner-name:' => ''
    40| 					);
    41| 		return easy_parser($data_str, $items, 'dmy', $trans);
    42| 		}
    43| 	}
    44| ?>


# ====================================================================
# FILE: src/whois.gtld.genericb.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-30 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| if (!defined('__GENERICB_HANDLER__'))
    21| 	define('__GENERICB_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class genericb_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		return generic_parser_b($data_str);
    28| 		}
    29| 	}
    30| ?>


# ====================================================================
# FILE: src/whois.gtld.godaddy.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__GODADDY_HANDLER__'))
    21| 	define('__GODADDY_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class godaddy_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant:',
    29|                   'admin' => 'Administrative Contact',
    30|                   'tech' => 'Technical Contact',
    31|                   'domain.name' => 'Domain Name:',
    32|                   'domain.nserver.' => 'Domain servers in listed order:',
    33|                   'domain.created' => 'Created on:',
    34|                   'domain.expires' => 'Expires on:',
    35|                   'domain.changed' => 'Last Updated on:',
    36|                   'domain.sponsor' => 'Registered through:'
    37| 		              );
    38| 		$r = get_blocks($data_str, $items);
    39| 		$r['owner'] = get_contact($r['owner']);
    40| 		$r['admin'] = get_contact($r['admin'],false,true);
    41| 		$r['tech'] = get_contact($r['tech'],false,true);
    42| 		return format_dates($r, 'dmy');
    43| 		}
    44| 	}
    45| ?>


# ====================================================================
# FILE: src/whois.gtld.iana.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__IANA_HANDLER__'))
    21| 	define('__IANA_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class iana_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'admin' => 'contact:      administrative',
    29|                   'tech' => 'contact:      technical',
    30|                   'domain.nserver.' => 'nserver:',
    31|                   'domain.created' => 'created:',
    32|                   'domain.changed' => 'changed:',
    33|                   'domain.source' => 'source:',
    34|                   'domain.name' => 'domain:',
    35|                   'disclaimer.' => '% '
    36| 		              );
    37| 		return easy_parser($data_str,$items,'Ymd',false,false,false,'owner');
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.interdomain.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-69 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__INTERDOMAIN_HANDLER__'))
    21| 	define('__INTERDOMAIN_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class interdomain_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                     'Domain Name................' => 'domain.name',
    29|                     'Creation Date............' => 'domain.created',
    30|                     'Expiry Date..............' => 'domain.expires',
    31|                     'Last Update Date.........' => 'domain.changed',
    32|                     'Name Server.............' => 'domain.nserver.',
    33|                     'Organization Name........' => 'owner.name',
    34|                     'Organization Org.........' => 'owner.organization',
    35|                     'Organization Street......' => 'owner.address.street',
    36|                     'Organization City........' => 'owner.address.city',
    37|                     'Organization State.......' => 'owner.address.state',
    38|                     'Organization PC..........' => 'owner.address.pcode',
    39|                     'Organization Country.....' => 'owner.address.country',
    40|                     'Organization Phone.......' => 'owner.phone',
    41|                     'Organization e-mail......' => 'owner.email',
    42|                     'Organization Contact Id....' => 'owner.handle',
    43|                     'Administrative Contact Id..' => 'admin.handle',
    44|                     'Administrative Name......' => 'admin.name',
    45|                     'Administrative Org.......' => 'admin.organization',
    46|                     'Administrative Street....' => 'admin.address.street',
    47|                     'Administrative City......' => 'admin.address.city',
    48|                     'Administrative State.....' => 'admin.address.state',
    49|                     'Administrative PC........' => 'admin.address.pcode',
    50|                     'Administrative Country...' => 'admin.address.country',
    51|                     'Administrative Phone.....' => 'admin.phone',
    52|                     'Administrative e-mail....' => 'admin.email',
    53|                     'Administrative Fax.......' => 'admin.fax',
    54|                     'Technical Contact Id.......' => 'tech.handle',
    55|                     'Technical Name...........' => 'tech.name',
    56|                     'Technical Org............' => 'tech.organization',
    57|                     'Technical Street.........' => 'tech.address.street',
    58|                     'Technical City...........' => 'tech.address.city',
    59|                     'Technical State..........' => 'tech.address.state',
    60|                     'Technical PC.............' => 'tech.address.pcode',
    61|                     'Technical Country........' => 'tech.address.country',
    62|                     'Technical Phone..........' => 'tech.phone',
    63|                     'Technical e-mail.........' => 'tech.email',
    64|                     'Technical Fax............' => 'tech.fax'
    65| 		              );
    66| 		return generic_parser_b($data_str, $items, 'dmy');
    67| 		}
    68| 	}
    69| ?>


# ====================================================================
# FILE: src/whois.gtld.itsyourdomain.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ITSYOURDOMAIN_HANDLER__'))
    21| 	define('__ITSYOURDOMAIN_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class itsyourdomain_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'Registrant',
    29|                 'admin' => 'Administrative',
    30|                 'tech' => 'Technical',
    31|                 'billing' => 'Billing',
    32|                 'domain.name' => 'Domain:',
    33|                 'domain.nserver.' => 'Domain Name Servers:',
    34|                 'domain.created' => 'Record created on ',
    35|                 'domain.expires' => 'Record expires on ',
    36|                 'domain.changed' => 'Record last updated on '
    37| 		            );
    38| 		return easy_parser($data_str, $items, 'mdy');
    39| 		}
    40| 	}
    41| ?>


# ====================================================================
# FILE: src/whois.gtld.joker.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-63 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__JOKER_HANDLER__'))
    21| 	define('__JOKER_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class joker_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28| 				'contact-hdl'	=> 'handle',
    29| 				'modified'		=> 'changed',
    30| 				'reseller' 		=> 'sponsor',
    31| 				'address' 		=> 'address.street',
    32| 				'postal-code' 	=> 'address.pcode',
    33|                 'city' 			=> 'address.city',
    34|                 'state' 		=> 'address.state',
    35| 				'country' 		=> 'address.country',
    36| 				'person'		=> 'name',
    37| 				'domain'		=> 'name'
    38| 				);
    39| 		$contacts = array(
    40| 				'admin-c' 	=> 'admin',
    41| 				'tech-c' 	=> 'tech',
    42| 				'billing-c' => 'billing'
    43| 				);
    44| 		$items = array(
    45|                 'owner' 		=> 'name',
    46| 				'organization' 	=> 'organization',
    47| 				'email'			=> 'email',
    48| 				'phone' 		=> 'phone',
    49|                 'address' 		=> 'address',
    50| 		            );
    51| 		$r = generic_parser_a($data_str, $translate, $contacts, 'domain', 'Ymd');
    52| 		foreach($items as $tag => $convert)
    53| 			{
    54| 			if (isset($r['domain'][$tag]))
    55| 				{
    56| 				$r['owner'][$convert] = $r['domain'][$tag];
    57| 				unset($r['domain'][$tag]);
    58| 				}
    59| 			}
    60| 		return $r;
    61| 		}
    62| 	}
    63| ?>


# ====================================================================
# FILE: src/whois.gtld.markmonitor.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-52 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__MARKMONITOR_HANDLER__'))
    21| 	define('__MARKMONITOR_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class markmonitor_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant:',
    29|                   'admin' => 'Administrative Contact:',
    30|                   'tech' => 'Technical Contact, Zone Contact:',
    31|                   'domain.name' => 'Domain Name:',
    32|                   'domain.sponsor' => 'Registrar Name:',
    33|                   'domain.nserver' => 'Domain servers in listed order:',
    34|                   'domain.created' => 'Created on..............:',
    35|                   'domain.expires' => 'Expires on..............:',
    36|                   'domain.changed' => 'Record last updated on..:'
    37| 		              );
    38| 		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
    39| 		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    40| 			$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    41| 		foreach($r as $key => $part)
    42| 			{
    43| 			if (isset($part['address']))
    44| 				{
    45| 				$r[$key]['organization'] = array_shift($r[$key]['address']);
    46| 				$r[$key]['address']['country'] = array_pop($r[$key]['address']);
    47| 				}
    48| 			}
    49| 		return $r;
    50| 		}
    51| 	}
    52| ?>


# ====================================================================
# FILE: src/whois.gtld.melbourneit.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-48 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__MELBOURNEIT_HANDLER__'))
    22| 	define('__MELBOURNEIT_HANDLER__', 1);
    23| class melbourneit_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'Domain Name..........' => 'domain.name',
    29|                   'Registration Date....' => 'domain.created',
    30|                   'Expiry Date..........' => 'domain.expires',
    31|                   'Organisation Name....' => 'owner.name',
    32|                   'Organisation Address.' => 'owner.address.',
    33|                   'Admin Name...........' => 'admin.name',
    34|                   'Admin Address........' => 'admin.address.',
    35|                   'Admin Email..........' => 'admin.email',
    36|                   'Admin Phone..........' => 'admin.phone',
    37|                   'Admin Fax............' => 'admin.fax',
    38|                   'Tech Name............' => 'tech.name',
    39|                   'Tech Address.........' => 'tech.address.',
    40|                   'Tech Email...........' => 'tech.email',
    41|                   'Tech Phone...........' => 'tech.phone',
    42|                   'Tech Fax.............' => 'tech.fax',
    43|                   'Name Server..........' => 'domain.nserver.'
    44| 		              );
    45| 		return generic_parser_b($data_str, $items, 'ymd');
    46| 		}
    47| 	}
    48| ?>


# ====================================================================
# FILE: src/whois.gtld.moniker.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__MONIKER_HANDLER__'))
    21| 	define('__MONIKER_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class moniker_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant',
    29|                   'admin' => 'Administrative ',
    30|                   'tech' => 'Technical ',
    31|                   'billing' => 'Billing ',
    32|                   'domain.name' => 'Domain Name:',
    33|                   'domain.nserver.' => 'Domain servers in listed order:',
    34|                   'domain.created' => 'Record created on: ',
    35|                   'domain.expires' => 'Domain Expires on: ',
    36|                   'domain.changed' => 'Database last updated on: '
    37| 		              );
    38| 		return easy_parser($data_str, $items, 'ymd');
    39| 		}
    40| 	}
    41| ?>


# ====================================================================
# FILE: src/whois.gtld.name.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-44 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NAME_HANDLER__'))
    21| 	define('__NAME_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class name_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'REGISTRANT CONTACT INFO',
    29|                 'admin' => 'ADMINISTRATIVE CONTACT INFO',
    30|                 'tech' => 'TECHNICAL CONTACT INFO',
    31|                 'billing' => 'BILLING CONTACT INFO',
    32|                 'domain.name' => 'Domain Name:',
    33|                 'domain.sponsor' => 'Registrar',
    34|                 'domain.created' => 'Creation Date',
    35|                 'domain.expires' => 'Expiration Date'
    36| 		            );
    37| 		$extra = array(
    38| 						'phone:' => 'phone',
    39| 						'email address:' => 'email'
    40| 						);
    41| 		return easy_parser($data_str, $items, 'y-m-d', $extra, false, true);
    42| 		}
    43| 	}
    44| ?>


# ====================================================================
# FILE: src/whois.gtld.nameintel.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NAMEINTEL_HANDLER__'))
    21| 	define('__NAMEINTEL_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class nameintel_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant Contact:',
    29|                   'admin' => 'Administrative Contact:',
    30|                   'tech' => 'Technical Contact',
    31|                   'domain.name' => 'Domain Name:',
    32|                   'domain.status' => 'Status:',
    33|                   'domain.nserver' => 'Name Server:',
    34|                   'domain.created' => 'Creation Date:',
    35|                   'domain.expires' => 'Expiration Date:'
    36| 		              );
    37| 		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
    38| 		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    39| 			$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    40| 		foreach($r as $key => $part)
    41| 			{
    42| 			if (isset($part['address']))
    43| 				{
    44| 				$r[$key]['organization'] = array_shift($r[$key]['address']);
    45| 				$r[$key]['address']['country'] = array_pop($r[$key]['address']);
    46| 				}
    47| 			}
    48| 		return $r;
    49| 		}
    50| 	}
    51| ?>


# ====================================================================
# FILE: src/whois.gtld.namejuice.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NAMEJUICE_HANDLER__'))
    21|         define('__NAMEJUICE_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class namejuice_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 					'owner' => 'Registrant Contact:',
    29| 					'admin' => 'Administrative Contact:',
    30| 					'tech' => 'Technical Contact:',
    31| 					'domain.name' => 'Domain name:',
    32| 					'domain.nserver.' => 'Name Servers:',
    33| 					'domain.created' => 'Creation date:',
    34| 					'domain.expires' => 'Expiration date:',
    35| 					'domain.changed' => 'Update date:',
    36| 					'domain.status' => 'Status:',
    37| 					'domain.sponsor' => 'Registration Service Provided By:'
    38| 				);
    39| 		return easy_parser($data_str, $items, 'dmy', false, true, true);
    40| 		}
    41| 	}
    42| ?>


# ====================================================================
# FILE: src/whois.gtld.nameking.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-58 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NAMEKING_HANDLER__'))
    21| 	define('__NAMEKING_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class nameking_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant',
    29|                   'admin' => 'Admin Contact',
    30|                   'tech' => 'Tech Contact',
    31|                   'billing' => 'Billing Contact',
    32|                   'domain.sponsor' => 'Registration Provided By:',
    33|                   'domain.created' => 'Creation Date:',
    34|                   'domain.expires' => 'Expiration Date:',
    35| 		              );
    36| 		$extra = array(
    37| 					'tel--' => 'phone',
    38| 					'tel:' => 'phone',
    39| 					'tel --:' => 'phone',
    40| 					'email-:' => 'email',
    41| 					'email:' => 'email',
    42| 					'mail:' => 'email',
    43| 					'name--' => 'name',
    44| 					'org:' => 'organization',
    45| 					'zipcode:' => 'address.pcode',
    46| 					'postcode:' => 'address.pcode',
    47| 					'address:' => 'address.street',
    48| 					'city:' => 'address.city',
    49| 					'province:' => 'address.city.',
    50| 					',province:' => '',
    51| 					',country:' => 'address.country',
    52| 					'organization:' => 'organization',
    53| 					'city, province, post code:' => 'address.city'
    54| 					);
    55| 		return easy_parser($data_str, $items, 'mdy', $extra, false, true);
    56| 		}
    57| 	}
    58| ?>


# ====================================================================
# FILE: src/whois.gtld.names4ever.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NAMES4EVER_HANDLER__'))
    21| 	define('__NAMES4EVER_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class names4ever_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant:',
    29|                   'admin' => 'Administrative Contact',
    30|                   'tech' => 'Technical  Contact',
    31|                   'domain.name' => 'Domain Name:',
    32|                   'domain.sponsor' => 'Registrar Name....:',
    33|                   'domain.referrer' => 'Registrar Homepage:',
    34|                   'domain.nserver' => 'DNS Servers:',
    35|                   'domain.created' => 'Record created on',
    36|                   'domain.expires' => 'Record expires on',
    37|                   'domain.changed' => 'Record last updated on',
    38|                   'domain.status' => 'Domain status:'
    39| 		              );
    40| 		return easy_parser($data_str, $items, 'dmy', false, false, true);
    41| 		}
    42| 	}
    43| ?>


# ====================================================================
# FILE: src/whois.gtld.namevault.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NAMEVAULT_HANDLER__'))
    21| 	define('__NAMEVAULT_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class namevault_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'Registrant',
    29|                 'admin' => 'Administrative Contact:',
    30|                 'tech' => 'Technical Contact:',
    31|                 'billing' => 'Billing Contact:',
    32|                 'domain.name' => 'Domain Name:',
    33|                 'domain.nserver.' => 'Name Servers',
    34| 				'domain.created' => 'Creation Date:',
    35|                 'domain.expires' =>	'Expiration Date:',
    36|                 'domain.status' => 'Status:'
    37| 		            );
    38| 		return easy_parser($data_str, $items, 'dmy', false, true, true);
    39| 		}
    40| 	}
    41| ?>


# ====================================================================
# FILE: src/whois.gtld.networksolutions.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-39 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NETWORKSOLUTIONS_HANDLER__'))
    21| 	define('__NETWORKSOLUTIONS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class networksolutions_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner'			=> 'Registrant:',
    29|                   'admin'			=> 'Administrative Contact',
    30|                   'tech'			=> 'Technical Contact',
    31|                   'domain.name'		=> 'Domain Name:',
    32|                   'domain.nserver.'	=> 'Domain servers in listed order:',
    33|                   'domain.created'	=> 'Record created on',
    34|                   'domain.expires'	=> 'Record expires on'
    35| 		              );
    36| 		return easy_parser($data_str, $items, 'dmy',false,true,true);
    37| 		}
    38| 	}
    39| ?>


# ====================================================================
# FILE: src/whois.gtld.nicco.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-50 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NICCO_HANDLER__'))
    21| 	define('__NICCO_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class nicco_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Holder Contact',
    29|                   'admin' => 'Admin Contact',
    30|                   'tech' => 'Tech. Contact',
    31|                   'domain.nserver.' => 'Nameservers',
    32|                   'domain.created' => 'Creation Date:',
    33|                   'domain.expires' => 'Expiration Date:'
    34| 		              );
    35| 		$translate = array(
    36| 					'city:'			=> 'address.city',
    37| 					'org. name:'	=> 'organization',
    38| 					'address1:'		=> 'address.street.',
    39| 					'address2:'		=> 'address.street.',
    40| 					'state:'		=> 'address.state',
    41| 					'postal code:'	=> 'address.zip'
    42| 					);
    43| 		$r = get_blocks($data_str, $items, true);
    44| 		$r['owner'] = get_contact($r['owner'],$translate);
    45| 		$r['admin'] = get_contact($r['admin'],$translate,true);
    46| 		$r['tech'] = get_contact($r['tech'],$translate,true);
    47| 		return format_dates($r, 'dmy');
    48| 		}
    49| 	}
    50| ?>


# ====================================================================
# FILE: src/whois.gtld.nicline.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NICLINE_HANDLER__'))
    21| 	define('__NICLINE_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class nicline_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 				'owner' => 'Registrant:',
    29| 				'admin' => 'Administrative contact:',
    30| 				'tech' => 'Technical contact:',
    31| 				'domain.name' => 'Domain name:',
    32| 				'domain.nserver.' => 'Domain servers in listed order:',
    33| 				'domain.created' => 'Created:',
    34| 				'domain.expires' => 'Expires:',
    35| 				'domain.changed' => 'Last updated:'
    36| 		              );
    37| 		return easy_parser($data_str, $items, 'dmy');
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.onlinenic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-69 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ONLINENIC_HANDLER__'))
    21| 	define('__ONLINENIC_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class onlinenic_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant:',
    29|                   'admin' => 'Administrator:',
    30|                   'tech' => 'Technical Contactor:',
    31|                   'billing' => 'Billing Contactor:',
    32|                   'domain.name' => 'Domain name:',
    33|                   'domain.name#' => 'Domain Name:',
    34|                   'domain.nserver' => 'Domain servers in listed order:',
    35|                   'domain.created' => 'Record created on ',
    36|                   'domain.expires' => 'Record expired on ',
    37|                   'domain.changed' => 'Record last updated at '
    38| 		              );
    39| 		$extra = array(
    40| 					'tel--' => 'phone',
    41| 					'tel:' => 'phone',
    42| 					'tel --:' => 'phone',
    43| 					'email-:' => 'email',
    44| 					'email:' => 'email',
    45| 					'mail:' => 'email',
    46| 					'name--' => 'name',
    47| 					'org:' => 'organization',
    48| 					'zipcode:' => 'address.pcode',
    49| 					'postcode:' => 'address.pcode',
    50| 					'address:' => 'address.street',
    51| 					'city:' => 'address.city',
    52| 					'province:' => '',
    53| 					',province:' => '',
    54| 					',country:' => 'address.country'
    55| 					);
    56| 		$r = easy_parser($data_str, $items, 'mdy',$extra,false,true);
    57| 		foreach($r as $key => $part)
    58| 			if (isset($part['email']))
    59| 				{
    60| 				@list($email,$phone) = explode(' ',$part['email']);
    61| 				$email = str_replace('(','',$email);
    62| 				$email = str_replace(')','',$email);
    63| 				$r[$key]['email'] = $email;
    64| 				if ($phone != '') $r[$key]['phone'] = $phone;
    65| 				}
    66| 		return $r;
    67| 		}
    68| 	}
    69| ?>


# ====================================================================
# FILE: src/whois.gtld.opensrs.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__OPENSRS_HANDLER__'))
    21| 	define('__OPENSRS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class opensrs_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner'			=> 'Registrant:',
    29|                   'admin'			=> 'Administrative Contact',
    30|                   'tech'			=> 'Technical Contact',
    31|                   'domain.name'		=> 'Domain name:',
    32|                   ''	=> 'Registration Service Provider:',
    33|                   'domain.nserver'	=> 'Domain servers in listed order:',
    34|                   'domain.changed'	=> 'Record last updated on',
    35|                   'domain.created'	=> 'Record created on',
    36|                   'domain.expires'	=> 'Record expires on',
    37|                   'domain.sponsor'	=> 'Registrar of Record:'
    38| 		              );
    39| 		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
    40| 		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    41| 			$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    42| 		return $r;
    43| 		}
    44| 	}
    45| ?>


# ====================================================================
# FILE: src/whois.gtld.ovh.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__OVH_HANDLER__'))
    21| 	define('__OVH_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class ovh_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 						'owner'	=> 'Registrant:',
    29| 						'admin'	=> 'Administrative Contact:',
    30| 						'tech'	=> 'Technical Contact:',
    31| 						'billing'	=> 'Billing Contact:',
    32| 						'domain.sponsor'	=> 'Registrar of Record:',
    33| 						'domain.changed'	=> 'Record last updated on',
    34| 						'domain.expires'	=> 'Record expires on',
    35| 						'domain.created'	=> 'Record created on'
    36|                         );
    37| 		return easy_parser($data_str, $items, 'mdy',false,false,true);
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-60 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__GTLD_HANDLER__'))
    21| 	define('__GTLD_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class gtld_handler extends WhoisClient
    24| 	{
    25| 	var $HANDLER_VERSION = '1.1';
    26| 	var $REG_FIELDS = array(
    27|                         'Domain Name:' => 'regrinfo.domain.name',
    28|                         'Registrar:' => 'regyinfo.registrar',
    29|                         'Whois Server:' => 'regyinfo.whois',
    30|                         'Referral URL:' => 'regyinfo.referrer',
    31|                         'Name Server:' => 'regrinfo.domain.nserver.',  // identical descriptors
    32| 						'Updated Date:' => 'regrinfo.domain.changed',
    33|                         'Last Updated On:' => 'regrinfo.domain.changed',
    34|                         'EPP Status:' => 'regrinfo.domain.epp_status.',
    35|                         'Status:' => 'regrinfo.domain.status.',
    36|                         'Creation Date:' => 'regrinfo.domain.created',
    37|                         'Created On:' => 'regrinfo.domain.created',
    38|                         'Expiration Date:' => 'regrinfo.domain.expires',
    39|                         'Updated Date:' => 'regrinfo.domain.changed',
    40|                         'No match for ' => 'nodomain'
    41| 	                     );
    42| 	function parse($data, $query)
    43| 		{
    44| 		$this->Query = array();
    45| 		$this->result = generic_parser_b($data['rawdata'], $this->REG_FIELDS, 'dmy');
    46| 		unset($this->result['registered']);
    47| 		if (isset($this->result['nodomain']))
    48| 			{
    49| 			unset($this->result['nodomain']);
    50| 			$this->result['regrinfo']['registered'] = 'no';
    51| 			return $this->result;
    52| 			}
    53| 		if ($this->deep_whois) $this->result = $this->DeepWhois($query,$this->result);
    54| 		if (empty($this->result['rawdata']) || count($this->result['rawdata']) < 3)
    55| 			$this->result['rawdata'] = $data['rawdata'];
    56| 		$this->result['regrinfo']['registered'] = 'yes';
    57| 		return $this->result;
    58| 		}
    59| 	}
    60| ?>


# ====================================================================
# FILE: src/whois.gtld.psiusa.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-79 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__PSIUSA_HANDLER__'))
    21| 	define('__PSIUSA_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class psiusa_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'created:' => 'domain.created',
    29|                   'last-changed:' => 'domain.changed',
    30|                   'status:' => 'domain.status',
    31|                   '[owner-c] fname:' => 'owner.name.first',
    32|                   '[owner-c] lname:' => 'owner.name.last',
    33|                   '[owner-c] org:' => 'owner.organization',
    34|                   '[owner-c] address:' => 'owner.address.street',
    35|                   '[owner-c] city:' => 'owner.address.city',
    36|                   '[owner-c] pcode:' => 'owner.address.pcode',
    37|                   '[owner-c] country:' => 'owner.address.country',
    38|                   '[owner-c] state:' => 'owner.address.state',
    39|                   '[owner-c] phone:' => 'owner.phone',
    40|                   '[owner-c] fax:' => 'owner.fax',
    41|                   '[owner-c] email:' => 'owner.email',
    42|                   '[admin-c] fname:' => 'admin.name.first',
    43|                   '[admin-c] lname:' => 'admin.name.last',
    44|                   '[admin-c] org:' => 'admin.organization',
    45|                   '[admin-c] address:' => 'admin.address.street',
    46|                   '[admin-c] city:' => 'admin.address.city',
    47|                   '[admin-c] pcode:' => 'admin.address.pcode',
    48|                   '[admin-c] country:' => 'admin.address.country',
    49|                   '[admin-c] state:' => 'admin.address.state',
    50|                   '[admin-c] phone:' => 'admin.phone',
    51|                   '[admin-c] fax:' => 'admin.fax',
    52|                   '[admin-c] email:' => 'admin.email',
    53|                   '[tech-c] fname:' => 'tech.name.first',
    54|                   '[tech-c] lname:' => 'tech.name.last',
    55|                   '[tech-c] org:' => 'tech.organization',
    56|                   '[tech-c] address:' => 'tech.address.street',
    57|                   '[tech-c] city:' => 'tech.address.city',
    58|                   '[tech-c] pcode:' => 'tech.address.pcode',
    59|                   '[tech-c] country:' => 'tech.address.country',
    60|                   '[tech-c] state:' => 'tech.address.state',
    61|                   '[tech-c] phone:' => 'tech.phone',
    62|                   '[tech-c] fax:' => 'tech.fax',
    63|                   '[tech-c] email:' => 'tech.email',
    64|                   '[zone-c] fname:' => 'zone.name.first',
    65|                   '[zone-c] lname:' => 'zone.name.last',
    66|                   '[zone-c] org:' => 'zone.organization',
    67|                   '[zone-c] address:' => 'zone.address.street',
    68|                   '[zone-c] city:' => 'zone.address.city',
    69|                   '[zone-c] pcode:' => 'zone.address.pcode',
    70|                   '[zone-c] country:' => 'zone.address.country',
    71|                   '[zone-c] state:' => 'zone.address.state',
    72|                   '[zone-c] phone:' => 'zone.phone',
    73|                   '[zone-c] fax:' => 'zone.fax',
    74|                   '[zone-c] email:' => 'zone.email',
    75| 		              );
    76| 		return generic_parser_b($data_str, $items);
    77| 		}
    78| 	}
    79| ?>


# ====================================================================
# FILE: src/whois.gtld.publicdomainregistry.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-46 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__PUBLICDOMAINREGISTRY_HANDLER__'))
    21| 	define('__PUBLICDOMAINREGISTRY_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class publicdomainregistry_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|               'owner' => 'Registrant:',
    29|               'owner#' => '(Registrant):',
    30|               'admin' => 'Administrative Contact',
    31|               'tech' => 'Technical Contact',
    32|               'billing' => 'Billing Contact',
    33|               'domain.name' => 'Domain name:',
    34|               'domain.sponsor' => 'Registration Service Provided By:',
    35|               'domain.nserver' => 'Domain servers in listed order:',
    36|               'domain.changed' => 'Record last updated ',
    37|               'domain.created' => 'Record created on',
    38|               'domain.created#' => 'Creation Date:',
    39|               'domain.expires' => 'Record expires on',
    40|               'domain.expires#' => 'Expiration Date:',
    41|               'domain.status'	=> 'Status:'
    42| 		          );
    43| 		return easy_parser($data_str, $items, 'mdy', false, true, true);
    44| 		}
    45| 	}
    46| ?>


# ====================================================================
# FILE: src/whois.gtld.register.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__REGISTER_HANDLER__'))
    21| 	define('__REGISTER_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class register_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner#0' => 'Registrant Info:',
    29|                   'owner#1' => 'Organization:',
    30|                   'owner#2' => 'Registrant:',
    31|                   'owner#3'	=> 'Registrant Contact:',
    32|                   'admin' => 'Administrative',
    33|                   'tech' => 'Technical',
    34|                   'zone' => 'Zone',
    35|                   'domain.sponsor#0' => 'Registrar Name....:',
    36|                   'domain.sponsor#1' => 'Registration Service Provided By:',
    37|                   'domain.referrer'	=> 'Registrar Homepage:',
    38|                   'domain.nserver' => 'Domain servers in listed order:',
    39|                   'domain.nserver' => 'DNS Servers:',
    40|                   'domain.name' => 'Domain name:',
    41|                   'domain.created#0' => 'Created on..............:',
    42|                   'domain.created#1' => 'Creation date:',
    43|                   'domain.expires#0' => 'Expires on..............:',
    44|                   'domain.expires#1' => 'Expiration date:',
    45|                   'domain.changed' => 'Record last updated on..:',
    46|                   'domain.status' => 'Status:'
    47| 		            );
    48| 		return easy_parser($data_str, $items, 'ymd');
    49| 		}
    50| 	}
    51| ?>


# ====================================================================
# FILE: src/whois.gtld.rrpproxy.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-81 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__RRPPROXY_HANDLER__'))
    21| 	define('__RRPPROXY_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class rrpproxy_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'created-date:' => 'domain.created',
    29|                   'updated-date:' => 'domain.changed',
    30|                   'registration-expiration-date:' => 'domain.expires',
    31|                   'RSP:' => 'domain.sponsor',
    32|                   'URL:' => 'domain.referrer',
    33|                   'owner-nom.contact:' => 'owner.handle',
    34|                   'owner-fname:' => 'owner.name.first',
    35|                   'owner-lname:' => 'owner.name.last',
    36|                   'owner-organization:' => 'owner.organization',
    37|                   'owner-street:' => 'owner.address.street',
    38|                   'owner-city:' => 'owner.address.city',
    39|                   'owner-zip:' => 'owner.address.pcode',
    40|                   'owner-country:' => 'owner.address.country',
    41|                   'owner-phone:' => 'owner.phone',
    42|                   'owner-fax:' => 'owner.fax',
    43|                   'owner-email:' => 'owner.email',
    44|                   'admin-nom.contact:' => 'admin.handle',
    45|                   'admin-fname:' => 'admin.name.first',
    46|                   'admin-lname:' => 'admin.name.last',
    47|                   'admin-organization:' => 'admin.organization',
    48|                   'admin-street:' => 'admin.address.street',
    49|                   'admin-city:' => 'admin.address.city',
    50|                   'admin-zip:' => 'admin.address.pcode',
    51|                   'admin-country:' => 'admin.address.country',
    52|                   'admin-phone:' => 'admin.phone',
    53|                   'admin-fax:' => 'admin.fax',
    54|                   'admin-email:' => 'admin.email',
    55|                   'tech-nom.contact:' => 'tech.handle',
    56|                   'tech-fname:' => 'tech.name.first',
    57|                   'tech-lname:' => 'tech.name.last',
    58|                   'tech-organization:' => 'tech.organization',
    59|                   'tech-street:' => 'tech.address.street',
    60|                   'tech-city:' => 'tech.address.city',
    61|                   'tech-zip:' => 'tech.address.pcode',
    62|                   'tech-country:' => 'tech.address.country',
    63|                   'tech-phone:' => 'tech.phone',
    64|                   'tech-fax:' => 'tech.fax',
    65|                   'tech-email:' => 'tech.email',
    66|                   'billing-nom.contact:' => 'billing.handle',
    67|                   'billing-fname:' => 'billing.name.first',
    68|                   'billing-lname:' => 'billing.name.last',
    69|                   'billing-organization:' => 'billing.organization',
    70|                   'billing-street:' => 'billing.address.street',
    71|                   'billing-city:' => 'billing.address.city',
    72|                   'billing-zip:' => 'billing.address.pcode',
    73|                   'billing-country:' => 'billing.address.country',
    74|                   'billing-phone:' => 'billing.phone',
    75|                   'billing-fax:' => 'billing.fax',
    76|                   'billing-email:' => 'billing.email'
    77| 		              );
    78| 		return generic_parser_b($data_str, $items);
    79| 		}
    80| 	}
    81| ?>


# ====================================================================
# FILE: src/whois.gtld.schlund.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-75 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__SCHLUND_HANDLER__'))
    21| 	define('__SCHLUND_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class schlund_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'created:' => 'domain.created',
    29|                   'last-changed:' => 'domain.changed',
    30|                   'status:' => 'domain.status',
    31|                   'registrant-firstname:' => 'owner.name.first',
    32|                   'registrant-lastname:' => 'owner.name.last',
    33|                   'registrant-organization:' => 'owner.organization',
    34|                   'registrant-street1:' => 'owner.address.street.',
    35|                   'registrant-street2:' => 'owner.address.street.',
    36|                   'registrant-pcode:' => 'owner.address.pcode',
    37|                   'registrant-city:' => 'owner.address.city',
    38|                   'registrant-ccode:' => 'owner.address.country',
    39|                   'registrant-phone:' => 'owner.phone',
    40|                   'registrant-email:' => 'owner.email',
    41|                   'admin-c-firstname:' => 'admin.name.first',
    42|                   'admin-c-lastname:' => 'admin.name.last',
    43|                   'admin-c-organization:' => 'admin.organization',
    44|                   'admin-c-street1:' => 'admin.address.street.',
    45|                   'admin-c-street2:' => 'admin.address.street.',
    46|                   'admin-c-pcode:' => 'admin.address.pcode',
    47|                   'admin-c-city:' => 'admin.address.city',
    48|                   'admin-c-ccode:' => 'admin.address.country',
    49|                   'admin-c-phone:' => 'admin.phone',
    50|                   'admin-c-email:' => 'admin.email',
    51|                   'tech-c-firstname:' => 'tech.name.first',
    52|                   'tech-c-lastname:' => 'tech.name.last',
    53|                   'tech-c-organization:' => 'tech.organization',
    54|                   'tech-c-street1:' => 'tech.address.street.',
    55|                   'tech-c-street2:' => 'tech.address.street.',
    56|                   'tech-c-pcode:' => 'tech.address.pcode',
    57|                   'tech-c-city:' => 'tech.address.city',
    58|                   'tech-c-ccode:' => 'tech.address.country',
    59|                   'tech-c-phone:' => 'tech.phone',
    60|                   'tech-c-email:' => 'tech.email',
    61|                   'bill-c-firstname:' => 'billing.name.first',
    62|                   'bill-c-lastname:' => 'billing.name.last',
    63|                   'bill-c-organization:' => 'billing.organization',
    64|                   'bill-c-street1:' => 'billing.address.street.',
    65|                   'bill-c-street2:' => 'billing.address.street.',
    66|                   'bill-c-pcode:' => 'billing.address.pcode',
    67|                   'bill-c-city:' => 'billing.address.city',
    68|                   'bill-c-ccode:' => 'billing.address.country',
    69|                   'bill-c-phone:' => 'billing.phone',
    70|                   'bill-c-email:' => 'billing.email'
    71| 		              );
    72| 		return generic_parser_b($data_str, $items);
    73| 		}
    74| 	}
    75| ?>


# ====================================================================
# FILE: src/whois.gtld.srsplus.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__SRSPLUS_HANDLER__'))
    21| 	define('__SRSPLUS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class srsplus_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant:',
    29|                   'admin' => 'Administrative',
    30|                   'tech' => 'Technical',
    31|                   'billing' => 'Billing',
    32|                   'domain.name' => 'Domain Name:',
    33|                   'domain.nserver' => 'Domain servers:',
    34|                   'domain.created' => 'Record created on',
    35|                   'domain.expires' => 'Record expires on'
    36| 		              );
    37| 		return easy_parser($data_str, $items, 'ymd',false,true,true);
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.gtld.tmagnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__TMAGNIC_HANDLER__'))
    21| 	define('__TMAGNIC_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class tmagnic_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|               'owner' => 'Owner Contact:',
    29|               'admin' => 'Admin Contact',
    30|               'tech' => 'Technical Contact',
    31|               'domain.name' => 'Domain Name:',
    32|               'domain.nserver.' => 'Domain servers in listed order:',
    33|               'domain.expires' => 'Record expires on: ',
    34|               'domain.changed' => 'Record last updated on: ',
    35|               '' => 'Zone Contact',
    36|               '#' => 'Punycode Name:'
    37| 		          );
    38| 		return easy_parser($data_str, $items, 'ymd',false,false,true);
    39| 		}
    40| 	}
    41| ?>


# ====================================================================
# FILE: src/whois.gtld.tvcorp.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-39 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__TVCORP_HANDLER__'))
    21| 	define('__TVCORP_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class tvcorp_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner' => 'Registrant',
    29|                 'admin' => 'Admin',
    30|                 'tech' =>	'Technical',
    31|                 'billing' => 'Billing',
    32|                 'domain.nserver.' => 'Domain servers:',
    33|                 'domain.created' => 'Record created on',
    34| 				'domain.expires' => 'Record expires on'
    35| 		            );
    36| 		return easy_parser($data_str, $items, 'mdy');
    37| 		}
    38| 	}
    39| ?>


# ====================================================================
# FILE: src/whois.gtld.wildwestdomains.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__WILDWESTDOMAINS_HANDLER__'))
    21| 	define('__WILDWESTDOMAINS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class wildwestdomains_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'owner' => 'Registrant:',
    29|                   'admin' => 'Administrative Contact:',
    30|                   'tech' => 'Technical Contact:',
    31|                   'domain.name' => 'Domain name:',
    32|                   'domain.sponsor'=> 'Registered through:',
    33|                   'domain.nserver' => 'Domain servers in listed order:',
    34|                   'domain.created' => 'Created on:',
    35|                   'domain.expires' => 'Expires on:',
    36|                   'domain.changed' => 'Last Updated on:'
    37| 		              );
    38| 		return easy_parser($data_str, $items, 'mdy');
    39| 		}
    40| 	}
    41| ?>


# ====================================================================
# FILE: src/whois.hu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| if(!defined('__HU_HANDLER__'))
    21|   define('__HU_HANDLER__',1);
    22| require_once('whois.parser.php');
    23| class hu_handler
    24| 	{
    25| 	function parse ($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 		    'domain:' => 'domain.name',
    29| 		    'record created:' => 'domain.created'
    30| 	        );
    31| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'],$items,'ymd');
    32| 		if (isset($r['regrinfo']['domain']))
    33| 		    $r['regrinfo']['registered'] = 'yes';
    34| 		else
    35| 		    $r['regrinfo']['registered'] = 'no';
    36| 		$r['regyinfo'] = array('referrer'=>'http://www.nic.hu','registrar'=>'HUNIC');
    37| 		return $r;
    38| 		}
    39| 	}
    40| ?>


# ====================================================================
# FILE: src/whois.idna.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-832 ---
     1| <?php
     2| /* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4 foldmethod=marker: */
     3| /**
     4|  * Encode/decode Internationalized Domain Names.
     5|  *
     6|  * The class allows to convert internationalized domain names
     7|  * (see RFC 3490 for details) as they can be used with various registries worldwide
     8|  * to be translated between their original (localized) form and their encoded form
     9|  * as it will be used in the DNS (Domain Name System).
    10|  *
    11|  * The class provides two public methods, encode() and decode(), which do exactly
    12|  * what you would expect them to do. You are allowed to use complete domain names,
    13|  * simple strings and complete email addresses as well. That means, that you might
    14|  * use any of the following notations:
    15|  *
    16|  * - www.nörgler.com
    17|  * - xn--nrgler-wxa
    18|  * - xn--brse-5qa.xn--knrz-1ra.info
    19|  *
    20|  * Unicode input might be given as either UTF-8 string, UCS-4 string or UCS-4
    21|  * array. Unicode output is available in the same formats.
    22|  * You can select your preferred format via {@link set_paramter()}.
    23|  *
    24|  * ACE input and output is always expected to be ASCII.
    25|  *
    26|  * @author  Matthias Sommerfeld <mso@phlylabs.de>
    27|  * @copyright 2004-2007 phlyLabs Berlin, http://phlylabs.de
    28|  * @version 0.5.1
    29|  *
    30|  */
    31| class idna_convert
    32| {
    33|     /**
    34|      * Holds all relevant mapping tables, loaded from a seperate file on construct
    35|      * See RFC3454 for details
    36|      *
    37|      * @var array
    38|      * @access private
    39|      */
    40|     var $NP = array();
    41|     var $_punycode_prefix = 'xn--';
    42|     var $_invalid_ucs =     0x80000000;
    43|     var $_max_ucs =         0x10FFFF;
    44|     var $_base =            36;
    45|     var $_tmin =            1;
    46|     var $_tmax =            26;
    47|     var $_skew =            38;
    48|     var $_damp =            700;
    49|     var $_initial_bias =    72;
    50|     var $_initial_n =       0x80;
    51|     var $_sbase =           0xAC00;
    52|     var $_lbase =           0x1100;
    53|     var $_vbase =           0x1161;
    54|     var $_tbase =           0x11A7;
    55|     var $_lcount =          19;
    56|     var $_vcount =          21;
    57|     var $_tcount =          28;
    58|     var $_ncount =          588;   // _vcount * _tcount
    59|     var $_scount =          11172; // _lcount * _tcount * _vcount
    60|     var $_error =           false;
    61|     var $_api_encoding   =  'utf8'; // Default input charset is UTF-8
    62|     var $_allow_overlong =  false;  // Overlong UTF-8 encodings are forbidden
    63|     var $_strict_mode    =  false;  // Behave strict or not
    64|     function idna_convert($options = false)
    65|     {
    66|         $this->slast = $this->_sbase + $this->_lcount * $this->_vcount * $this->_tcount;
    67|         if (function_exists('file_get_contents')) {
    68|             $this->NP = unserialize(file_get_contents(dirname(__FILE__).'/npdata.ser'));
    69|         } else {
    70|             $this->NP = unserialize(join('', file(dirname(__FILE__).'/npdata.ser')));
    71|         }
    72|         if (is_array($options)) {
    73|             return $this->set_parameter($options);
    74|         }
    75|         return true;
    76|     }
    77|     /**
    78|      * Sets a new option value. Available options and values:
    79|      * [encoding - Use either UTF-8, UCS4 as array or UCS4 as string as input ('utf8' for UTF-8,
    80|      *         'ucs4_string' and 'ucs4_array' respectively for UCS4); The output is always UTF-8]
    81|      * [overlong - Unicode does not allow unnecessarily long encodings of chars,
    82|      *             to allow this, set this parameter to true, else to false;
    83|      *             default is false.]
    84|      * [strict - true: strict mode, good for registration purposes - Causes errors
    85|      *           on failures; false: loose mode, ideal for "wildlife" applications
    86|      *           by silently ignoring errors and returning the original input instead
    87|      *
    88|      * @param    mixed     Parameter to set (string: single parameter; array of Parameter => Value pairs)
    89|      * @param    string    Value to use (if parameter 1 is a string)
    90|      * @return   boolean   true on success, false otherwise
    91|      * @access   public
    92|      */
    93|     function set_parameter($option, $value = false)
    94|     {
    95|         if (!is_array($option)) {
    96|             $option = array($option => $value);
    97|         }
    98|         foreach ($option as $k => $v) {
    99|             switch ($k) {
   100|             case 'encoding':
   101|                 switch ($v) {
   102|                 case 'utf8':
   103|                 case 'ucs4_string':
   104|                 case 'ucs4_array':
   105|                     $this->_api_encoding = $v;
   106|                     break;
   107|                 default:
   108|                     $this->_error('Set Parameter: Unknown parameter '.$v.' for option '.$k);
   109|                     return false;
   110|                 }
   111|                 break;
   112|             case 'overlong':
   113|                 $this->_allow_overlong = ($v) ? true : false;
   114|                 break;
   115|             case 'strict':
   116|                 $this->_strict_mode = ($v) ? true : false;
   117|                 break;
   118|             default:
   119|                 $this->_error('Set Parameter: Unknown option '.$k);
   120|                 return false;
   121|             }
   122|         }
   123|         return true;
   124|     }
   125|     /**
   126|      * Decode a given ACE domain name
   127|      * @param    string   Domain name (ACE string)
   128|      * [@param    string   Desired output encoding, see {@link set_parameter}]
   129|      * @return   string   Decoded Domain name (UTF-8 or UCS-4)
   130|      * @access   public
   131|      */
   132|     function decode($input, $one_time_encoding = false)
   133|     {
   134|         if ($one_time_encoding) {
   135|             switch ($one_time_encoding) {
   136|             case 'utf8':
   137|             case 'ucs4_string':
   138|             case 'ucs4_array':
   139|                 break;
   140|             default:
   141|                 $this->_error('Unknown encoding '.$one_time_encoding);
   142|                 return false;
   143|             }
   144|         }
   145|         $input = trim($input);
   146|         if (strpos($input, '@')) { // Maybe it is an email address
   147|             if ($this->_strict_mode) {
   148|                 $this->_error('Only simple domain name parts can be handled in strict mode');
   149|                 return false;
   150|             }
   151|             list ($email_pref, $input) = explode('@', $input, 2);
   152|             $arr = explode('.', $input);
   153|             foreach ($arr as $k => $v) {
   154|                 if (preg_match('!^'.preg_quote($this->_punycode_prefix, '!').'!', $v)) {
   155|                     $conv = $this->_decode($v);
   156|                     if ($conv) $arr[$k] = $conv;
   157|                 }
   158|             }
   159|             $input = join('.', $arr);
   160|             $arr = explode('.', $email_pref);
   161|             foreach ($arr as $k => $v) {
   162|                 if (preg_match('!^'.preg_quote($this->_punycode_prefix, '!').'!', $v)) {
   163|                     $conv = $this->_decode($v);
   164|                     if ($conv) $arr[$k] = $conv;
   165|                 }
   166|             }
   167|             $email_pref = join('.', $arr);
   168|             $return = $email_pref . '@' . $input;
   169|         } elseif (preg_match('![:\./]!', $input)) { // Or a complete domain name (with or without paths / parameters)
   170|             if ($this->_strict_mode) {
   171|                 $this->_error('Only simple domain name parts can be handled in strict mode');
   172|                 return false;
   173|             }
   174|             $parsed = parse_url($input);
   175|             if (isset($parsed['host'])) {
   176|                 $arr = explode('.', $parsed['host']);
   177|                 foreach ($arr as $k => $v) {
   178|                     $conv = $this->_decode($v);
   179|                     if ($conv) $arr[$k] = $conv;
   180|                 }
   181|                 $parsed['host'] = join('.', $arr);
   182|                 $return =
   183|                         (empty($parsed['scheme']) ? '' : $parsed['scheme'].(strtolower($parsed['scheme']) == 'mailto' ? ':' : '://'))
   184|                         .(empty($parsed['user']) ? '' : $parsed['user'].(empty($parsed['pass']) ? '' : ':'.$parsed['pass']).'@')
   185|                         .$parsed['host']
   186|                         .(empty($parsed['port']) ? '' : ':'.$parsed['port'])
   187|                         .(empty($parsed['path']) ? '' : $parsed['path'])
   188|                         .(empty($parsed['query']) ? '' : '?'.$parsed['query'])
   189|                         .(empty($parsed['fragment']) ? '' : '#'.$parsed['fragment']);
   190|             } else { // parse_url seems to have failed, try without it
   191|                 $arr = explode('.', $input);
   192|                 foreach ($arr as $k => $v) {
   193|                     $conv = $this->_decode($v);
   194|                     $arr[$k] = ($conv) ? $conv : $v;
   195|                 }
   196|                 $return = join('.', $arr);
   197|             }
   198|         } else { // Otherwise we consider it being a pure domain name string
   199|             $return = $this->_decode($input);
   200|             if (!$return) $return = $input;
   201|         }
   202|         switch (($one_time_encoding) ? $one_time_encoding : $this->_api_encoding) {
   203|         case 'utf8':
   204|             return $return;
   205|             break;
   206|         case 'ucs4_string':
   207|            return $this->_ucs4_to_ucs4_string($this->_utf8_to_ucs4($return));
   208|            break;
   209|         case 'ucs4_array':
   210|             return $this->_utf8_to_ucs4($return);
   211|             break;
   212|         default:
   213|             $this->_error('Unsupported output format');
   214|             return false;
   215|         }
   216|     }
   217|     /**
   218|      * Encode a given UTF-8 domain name
   219|      * @param    string   Domain name (UTF-8 or UCS-4)
   220|      * [@param    string   Desired input encoding, see {@link set_parameter}]
   221|      * @return   string   Encoded Domain name (ACE string)
   222|      * @access   public
   223|      */
   224|     function encode($decoded, $one_time_encoding = false)
   225|     {
   226|         switch ($one_time_encoding ? $one_time_encoding : $this->_api_encoding) {
   227|         case 'utf8':
   228|             $decoded = $this->_utf8_to_ucs4($decoded);
   229|             break;
   230|         case 'ucs4_string':
   231|            $decoded = $this->_ucs4_string_to_ucs4($decoded);
   232|         case 'ucs4_array':
   233|            break;
   234|         default:
   235|             $this->_error('Unsupported input format: '.($one_time_encoding ? $one_time_encoding : $this->_api_encoding));
   236|             return false;
   237|         }
   238|         if (empty($decoded)) return '';
   239|         $last_begin = 0;
   240|         $output = '';
   241|         foreach ($decoded as $k => $v) {
   242|             switch($v) {
   243|             case 0x3002:
   244|             case 0xFF0E:
   245|             case 0xFF61:
   246|                 $decoded[$k] = 0x2E;
   247|             case 0x2E:
   248|             case 0x2F:
   249|             case 0x3A:
   250|             case 0x3F:
   251|             case 0x40:
   252|                 if ($this->_strict_mode) {
   253|                    $this->_error('Neither email addresses nor URLs are allowed in strict mode.');
   254|                    return false;
   255|                 } else {
   256|                     if ($k) {
   257|                         $encoded = '';
   258|                         $encoded = $this->_encode(array_slice($decoded, $last_begin, (($k)-$last_begin)));
   259|                         if ($encoded) {
   260|                             $output .= $encoded;
   261|                         } else {
   262|                             $output .= $this->_ucs4_to_utf8(array_slice($decoded, $last_begin, (($k)-$last_begin)));
   263|                         }
   264|                         $output .= chr($decoded[$k]);
   265|                     }
   266|                     $last_begin = $k + 1;
   267|                 }
   268|             }
   269|         }
   270|         if ($last_begin) {
   271|             $inp_len = sizeof($decoded);
   272|             $encoded = '';
   273|             $encoded = $this->_encode(array_slice($decoded, $last_begin, (($inp_len)-$last_begin)));
   274|             if ($encoded) {
   275|                 $output .= $encoded;
   276|             } else {
   277|                 $output .= $this->_ucs4_to_utf8(array_slice($decoded, $last_begin, (($inp_len)-$last_begin)));
   278|             }
   279|             return $output;
   280|         } else {
   281|             if ($output = $this->_encode($decoded)) {
   282|                 return $output;
   283|             } else {
   284|                 return $this->_ucs4_to_utf8($decoded);
   285|             }
   286|         }
   287|     }
   288|     /**
   289|      * Use this method to get the last error ocurred
   290|      * @param    void
   291|      * @return   string   The last error, that occured
   292|      * @access   public
   293|      */
   294|     function get_last_error()
   295|     {
   296|         return $this->_error;
   297|     }
   298|     /**
   299|      * The actual decoding algorithm
   300|      * @access   private
   301|      */
   302|     function _decode($encoded)
   303|     {
   304|         if (!preg_match('!^'.preg_quote($this->_punycode_prefix, '!').'!', $encoded)) {
   305|             $this->_error('This is not a punycode string');
   306|             return false;
   307|         }
   308|         $encode_test = preg_replace('!^'.preg_quote($this->_punycode_prefix, '!').'!', '', $encoded);
   309|         if (!$encode_test) {
   310|             $this->_error('The given encoded string was empty');
   311|             return false;
   312|         }
   313|         $delim_pos = strrpos($encoded, '-');
   314|         if ($delim_pos > strlen($this->_punycode_prefix)) {
   315|             for ($k = strlen($this->_punycode_prefix); $k < $delim_pos; ++$k) {
   316|                 $decoded[] = ord($encoded{$k});
   317|             }
   318|         } else {
   319|             $decoded = array();
   320|         }
   321|         $deco_len = count($decoded);
   322|         $enco_len = strlen($encoded);
   323|         $is_first = true;
   324|         $bias     = $this->_initial_bias;
   325|         $idx      = 0;
   326|         $char     = $this->_initial_n;
   327|         for ($enco_idx = ($delim_pos) ? ($delim_pos + 1) : 0; $enco_idx < $enco_len; ++$deco_len) {
   328|             for ($old_idx = $idx, $w = 1, $k = $this->_base; 1 ; $k += $this->_base) {
   329|                 $digit = $this->_decode_digit($encoded{$enco_idx++});
   330|                 $idx += $digit * $w;
   331|                 $t = ($k <= $bias) ? $this->_tmin :
   332|                         (($k >= $bias + $this->_tmax) ? $this->_tmax : ($k - $bias));
   333|                 if ($digit < $t) break;
   334|                 $w = (int) ($w * ($this->_base - $t));
   335|             }
   336|             $bias = $this->_adapt($idx - $old_idx, $deco_len + 1, $is_first);
   337|             $is_first = false;
   338|             $char += (int) ($idx / ($deco_len + 1));
   339|             $idx %= ($deco_len + 1);
   340|             if ($deco_len > 0) {
   341|                 for ($i = $deco_len; $i > $idx; $i--) {
   342|                     $decoded[$i] = $decoded[($i - 1)];
   343|                 }
   344|             }
   345|             $decoded[$idx++] = $char;
   346|         }
   347|         return $this->_ucs4_to_utf8($decoded);
   348|     }
   349|     /**
   350|      * The actual encoding algorithm
   351|      * @access   private
   352|      */
   353|     function _encode($decoded)
   354|     {
   355|         $extract = strlen($this->_punycode_prefix);
   356|         $check_pref = $this->_utf8_to_ucs4($this->_punycode_prefix);
   357|         $check_deco = array_slice($decoded, 0, $extract);
   358|         if ($check_pref == $check_deco) {
   359|             $this->_error('This is already a punycode string');
   360|             return false;
   361|         }
   362|         $encodable = false;
   363|         foreach ($decoded as $k => $v) {
   364|             if ($v > 0x7a) {
   365|                 $encodable = true;
   366|                 break;
   367|             }
   368|         }
   369|         if (!$encodable) {
   370|             $this->_error('The given string does not contain encodable chars');
   371|             return false;
   372|         }
   373|         $decoded = $this->_nameprep($decoded);
   374|         if (!$decoded || !is_array($decoded)) return false; // NAMEPREP failed
   375|         $deco_len  = count($decoded);
   376|         if (!$deco_len) return false; // Empty array
   377|         $codecount = 0; // How many chars have been consumed
   378|         $encoded = '';
   379|         for ($i = 0; $i < $deco_len; ++$i) {
   380|             $test = $decoded[$i];
   381|             if ((0x2F < $test && $test < 0x40) || (0x40 < $test && $test < 0x5B)
   382|                     || (0x60 < $test && $test <= 0x7B) || (0x2D == $test)) {
   383|                 $encoded .= chr($decoded[$i]);
   384|                 $codecount++;
   385|             }
   386|         }
   387|         if ($codecount == $deco_len) return $encoded; // All codepoints were basic ones
   388|         $encoded = $this->_punycode_prefix.$encoded;
   389|         if ($codecount) $encoded .= '-';
   390|         $is_first  = true;
   391|         $cur_code  = $this->_initial_n;
   392|         $bias      = $this->_initial_bias;
   393|         $delta     = 0;
   394|         while ($codecount < $deco_len) {
   395|             for ($i = 0, $next_code = $this->_max_ucs; $i < $deco_len; $i++) {
   396|                 if ($decoded[$i] >= $cur_code && $decoded[$i] <= $next_code) {
   397|                     $next_code = $decoded[$i];
   398|                 }
   399|             }
   400|             $delta += ($next_code - $cur_code) * ($codecount + 1);
   401|             $cur_code = $next_code;
   402|             for ($i = 0; $i < $deco_len; $i++) {
   403|                 if ($decoded[$i] < $cur_code) {
   404|                     $delta++;
   405|                 } elseif ($decoded[$i] == $cur_code) {
   406|                     for ($q = $delta, $k = $this->_base; 1; $k += $this->_base) {
   407|                         $t = ($k <= $bias) ? $this->_tmin :
   408|                                 (($k >= $bias + $this->_tmax) ? $this->_tmax : $k - $bias);
   409|                         if ($q < $t) break;
   410|                         $encoded .= $this->_encode_digit(intval($t + (($q - $t) % ($this->_base - $t)))); //v0.4.5 Changed from ceil() to intval()
   411|                         $q = (int) (($q - $t) / ($this->_base - $t));
   412|                     }
   413|                     $encoded .= $this->_encode_digit($q);
   414|                     $bias = $this->_adapt($delta, $codecount+1, $is_first);
   415|                     $codecount++;
   416|                     $delta = 0;
   417|                     $is_first = false;
   418|                 }
   419|             }
   420|             $delta++;
   421|             $cur_code++;
   422|         }
   423|         return $encoded;
   424|     }
   425|     /**
   426|      * Adapt the bias according to the current code point and position
   427|      * @access   private
   428|      */
   429|     function _adapt($delta, $npoints, $is_first)
   430|     {
   431|         $delta = intval($is_first ? ($delta / $this->_damp) : ($delta / 2));
   432|         $delta += intval($delta / $npoints);
   433|         for ($k = 0; $delta > (($this->_base - $this->_tmin) * $this->_tmax) / 2; $k += $this->_base) {
   434|             $delta = intval($delta / ($this->_base - $this->_tmin));
   435|         }
   436|         return intval($k + ($this->_base - $this->_tmin + 1) * $delta / ($delta + $this->_skew));
   437|     }
   438|     /**
   439|      * Encoding a certain digit
   440|      * @access   private
   441|      */
   442|     function _encode_digit($d)
   443|     {
   444|         return chr($d + 22 + 75 * ($d < 26));
   445|     }
   446|     /**
   447|      * Decode a certain digit
   448|      * @access   private
   449|      */
   450|     function _decode_digit($cp)
   451|     {
   452|         $cp = ord($cp);
   453|         return ($cp - 48 < 10) ? $cp - 22 : (($cp - 65 < 26) ? $cp - 65 : (($cp - 97 < 26) ? $cp - 97 : $this->_base));
   454|     }
   455|     /**
   456|      * Internal error handling method
   457|      * @access   private
   458|      */
   459|     function _error($error = '')
   460|     {
   461|         $this->_error = $error;
   462|     }
   463|     /**
   464|      * Do Nameprep according to RFC3491 and RFC3454
   465|      * @param    array    Unicode Characters
   466|      * @return   string   Unicode Characters, Nameprep'd
   467|      * @access   private
   468|      */
   469|     function _nameprep($input)
   470|     {
   471|         $output = array();
   472|         $error = false;
   473|         foreach ($input as $v) {
   474|             if (in_array($v, $this->NP['map_nothing'])) continue;
   475|             if (in_array($v, $this->NP['prohibit']) || in_array($v, $this->NP['general_prohibited'])) {
   476|                 $this->_error('NAMEPREP: Prohibited input U+'.sprintf('%08X', $v));
   477|                 return false;
   478|             }
   479|             foreach ($this->NP['prohibit_ranges'] as $range) {
   480|                 if ($range[0] <= $v && $v <= $range[1]) {
   481|                     $this->_error('NAMEPREP: Prohibited input U+'.sprintf('%08X', $v));
   482|                     return false;
   483|                 }
   484|             }
   485|             if (0xAC00 <= $v && $v <= 0xD7AF) {
   486|                 foreach ($this->_hangul_decompose($v) as $out) {
   487|                     $output[] = (int) $out;
   488|                 }
   489|             } elseif (isset($this->NP['replacemaps'][$v])) {
   490|                 foreach ($this->_apply_cannonical_ordering($this->NP['replacemaps'][$v]) as $out) {
   491|                     $output[] = (int) $out;
   492|                 }
   493|             } else {
   494|                 $output[] = (int) $v;
   495|             }
   496|         }
   497|         $output = $this->_hangul_compose($output);
   498|         $last_class   = 0;
   499|         $last_starter = 0;
   500|         $out_len      = count($output);
   501|         for ($i = 0; $i < $out_len; ++$i) {
   502|             $class = $this->_get_combining_class($output[$i]);
   503|             if ((!$last_class || $last_class > $class) && $class) {
   504|                 $seq_len = $i - $last_starter;
   505|                 $out = $this->_combine(array_slice($output, $last_starter, $seq_len));
   506|                 if ($out) {
   507|                     $output[$last_starter] = $out;
   508|                     if (count($out) != $seq_len) {
   509|                         for ($j = $i+1; $j < $out_len; ++$j) {
   510|                             $output[$j-1] = $output[$j];
   511|                         }
   512|                         unset($output[$out_len]);
   513|                     }
   514|                     $i--;
   515|                     $out_len--;
   516|                     $last_class = ($i == $last_starter) ? 0 : $this->_get_combining_class($output[$i-1]);
   517|                     continue;
   518|                 }
   519|             }
   520|             if (!$class) $last_starter = $i;
   521|             $last_class = $class;
   522|         }
   523|         return $output;
   524|     }
   525|     /**
   526|      * Decomposes a Hangul syllable
   527|      * (see http://www.unicode.org/unicode/reports/tr15/#Hangul
   528|      * @param    integer  32bit UCS4 code point
   529|      * @return   array    Either Hangul Syllable decomposed or original 32bit value as one value array
   530|      * @access   private
   531|      */
   532|     function _hangul_decompose($char)
   533|     {
   534|         $sindex = (int) $char - $this->_sbase;
   535|         if ($sindex < 0 || $sindex >= $this->_scount) {
   536|             return array($char);
   537|         }
   538|         $result = array();
   539|         $result[] = (int) $this->_lbase + $sindex / $this->_ncount;
   540|         $result[] = (int) $this->_vbase + ($sindex % $this->_ncount) / $this->_tcount;
   541|         $T = intval($this->_tbase + $sindex % $this->_tcount);
   542|         if ($T != $this->_tbase) $result[] = $T;
   543|         return $result;
   544|     }
   545|     /**
   546|      * Ccomposes a Hangul syllable
   547|      * (see http://www.unicode.org/unicode/reports/tr15/#Hangul
   548|      * @param    array    Decomposed UCS4 sequence
   549|      * @return   array    UCS4 sequence with syllables composed
   550|      * @access   private
   551|      */
   552|     function _hangul_compose($input)
   553|     {
   554|         $inp_len = count($input);
   555|         if (!$inp_len) return array();
   556|         $result = array();
   557|         $last = (int) $input[0];
   558|         $result[] = $last; // copy first char from input to output
   559|         for ($i = 1; $i < $inp_len; ++$i) {
   560|             $char = (int) $input[$i];
   561|             $sindex = $last - $this->_sbase;
   562|             $lindex = $last - $this->_lbase;
   563|             $vindex = $char - $this->_vbase;
   564|             $tindex = $char - $this->_tbase;
   565|             if (0 <= $sindex && $sindex < $this->_scount && ($sindex % $this->_tcount == 0)
   566|                     && 0 <= $tindex && $tindex <= $this->_tcount) {
   567|                 $last += $tindex;
   568|                 $result[(count($result) - 1)] = $last; // reset last
   569|                 continue; // discard char
   570|             }
   571|             if (0 <= $lindex && $lindex < $this->_lcount && 0 <= $vindex && $vindex < $this->_vcount) {
   572|                 $last = (int) $this->_sbase + ($lindex * $this->_vcount + $vindex) * $this->_tcount;
   573|                 $result[(count($result) - 1)] = $last; // reset last
   574|                 continue; // discard char
   575|             }
   576|             $last = $char;
   577|             $result[] = $char;
   578|         }
   579|         return $result;
   580|     }
   581|     /**
   582|      * Returns the combining class of a certain wide char
   583|      * @param    integer    Wide char to check (32bit integer)
   584|      * @return   integer    Combining class if found, else 0
   585|      * @access   private
   586|      */
   587|     function _get_combining_class($char)
   588|     {
   589|         return isset($this->NP['norm_combcls'][$char]) ? $this->NP['norm_combcls'][$char] : 0;
   590|     }
   591|     /**
   592|      * Apllies the cannonical ordering of a decomposed UCS4 sequence
   593|      * @param    array      Decomposed UCS4 sequence
   594|      * @return   array      Ordered USC4 sequence
   595|      * @access   private
   596|      */
   597|     function _apply_cannonical_ordering($input)
   598|     {
   599|         $swap = true;
   600|         $size = count($input);
   601|         while ($swap) {
   602|             $swap = false;
   603|             $last = $this->_get_combining_class(intval($input[0]));
   604|             for ($i = 0; $i < $size-1; ++$i) {
   605|                 $next = $this->_get_combining_class(intval($input[$i+1]));
   606|                 if ($next != 0 && $last > $next) {
   607|                     for ($j = $i + 1; $j > 0; --$j) {
   608|                         if ($this->_get_combining_class(intval($input[$j-1])) <= $next) break;
   609|                         $t = intval($input[$j]);
   610|                         $input[$j] = intval($input[$j-1]);
   611|                         $input[$j-1] = $t;
   612|                         $swap = true;
   613|                     }
   614|                     $next = $last;
   615|                 }
   616|                 $last = $next;
   617|             }
   618|         }
   619|         return $input;
   620|     }
   621|     /**
   622|      * Do composition of a sequence of starter and non-starter
   623|      * @param    array      UCS4 Decomposed sequence
   624|      * @return   array      Ordered USC4 sequence
   625|      * @access   private
   626|      */
   627|     function _combine($input)
   628|     {
   629|         $inp_len = count($input);
   630|         foreach ($this->NP['replacemaps'] as $np_src => $np_target) {
   631|             if ($np_target[0] != $input[0]) continue;
   632|             if (count($np_target) != $inp_len) continue;
   633|             $hit = false;
   634|             foreach ($input as $k2 => $v2) {
   635|                 if ($v2 == $np_target[$k2]) {
   636|                     $hit = true;
   637|                 } else {
   638|                     $hit = false;
   639|                     break;
   640|                 }
   641|             }
   642|             if ($hit) return $np_src;
   643|         }
   644|         return false;
   645|     }
   646|     /**
   647|      * This converts an UTF-8 encoded string to its UCS-4 representation
   648|      * By talking about UCS-4 "strings" we mean arrays of 32bit integers representing
   649|      * each of the "chars". This is due to PHP not being able to handle strings with
   650|      * bit depth different from 8. This apllies to the reverse method _ucs4_to_utf8(), too.
   651|      * The following UTF-8 encodings are supported:
   652|      * bytes bits  representation
   653|      * 1        7  0xxxxxxx
   654|      * 2       11  110xxxxx 10xxxxxx
   655|      * 3       16  1110xxxx 10xxxxxx 10xxxxxx
   656|      * 4       21  11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
   657|      * 5       26  111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
   658|      * 6       31  1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
   659|      * Each x represents a bit that can be used to store character data.
   660|      * The five and six byte sequences are part of Annex D of ISO/IEC 10646-1:2000
   661|      * @access   private
   662|      */
   663|     function _utf8_to_ucs4($input)
   664|     {
   665|         $output = array();
   666|         $out_len = 0;
   667|         $inp_len = strlen($input);
   668|         $mode = 'next';
   669|         $test = 'none';
   670|         for ($k = 0; $k < $inp_len; ++$k) {
   671|             $v = ord($input{$k}); // Extract byte from input string
   672|             if ($v < 128) { // We found an ASCII char - put into stirng as is
   673|                 $output[$out_len] = $v;
   674|                 ++$out_len;
   675|                 if ('add' == $mode) {
   676|                     $this->_error('Conversion from UTF-8 to UCS-4 failed: malformed input at byte '.$k);
   677|                     return false;
   678|                 }
   679|                 continue;
   680|             }
   681|             if ('next' == $mode) { // Try to find the next start byte; determine the width of the Unicode char
   682|                 $start_byte = $v;
   683|                 $mode = 'add';
   684|                 $test = 'range';
   685|                 if ($v >> 5 == 6) { // &110xxxxx 10xxxxx
   686|                     $next_byte = 0; // Tells, how many times subsequent bitmasks must rotate 6bits to the left
   687|                     $v = ($v - 192) << 6;
   688|                 } elseif ($v >> 4 == 14) { // &1110xxxx 10xxxxxx 10xxxxxx
   689|                     $next_byte = 1;
   690|                     $v = ($v - 224) << 12;
   691|                 } elseif ($v >> 3 == 30) { // &11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
   692|                     $next_byte = 2;
   693|                     $v = ($v - 240) << 18;
   694|                 } elseif ($v >> 2 == 62) { // &111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
   695|                     $next_byte = 3;
   696|                     $v = ($v - 248) << 24;
   697|                 } elseif ($v >> 1 == 126) { // &1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
   698|                     $next_byte = 4;
   699|                     $v = ($v - 252) << 30;
   700|                 } else {
   701|                     $this->_error('This might be UTF-8, but I don\'t understand it at byte '.$k);
   702|                     return false;
   703|                 }
   704|                 if ('add' == $mode) {
   705|                     $output[$out_len] = (int) $v;
   706|                     ++$out_len;
   707|                     continue;
   708|                 }
   709|             }
   710|             if ('add' == $mode) {
   711|                 if (!$this->_allow_overlong && $test == 'range') {
   712|                     $test = 'none';
   713|                     if (($v < 0xA0 && $start_byte == 0xE0) || ($v < 0x90 && $start_byte == 0xF0) || ($v > 0x8F && $start_byte == 0xF4)) {
   714|                         $this->_error('Bogus UTF-8 character detected (out of legal range) at byte '.$k);
   715|                         return false;
   716|                     }
   717|                 }
   718|                 if ($v >> 6 == 2) { // Bit mask must be 10xxxxxx
   719|                     $v = ($v - 128) << ($next_byte * 6);
   720|                     $output[($out_len - 1)] += $v;
   721|                     --$next_byte;
   722|                 } else {
   723|                     $this->_error('Conversion from UTF-8 to UCS-4 failed: malformed input at byte '.$k);
   724|                     return false;
   725|                 }
   726|                 if ($next_byte < 0) {
   727|                     $mode = 'next';
   728|                 }
   729|             }
   730|         } // for
   731|         return $output;
   732|     }
   733|     /**
   734|      * Convert UCS-4 string into UTF-8 string
   735|      * See _utf8_to_ucs4() for details
   736|      * @access   private
   737|      */
   738|     function _ucs4_to_utf8($input)
   739|     {
   740|         $output = '';
   741|         $k = 0;
   742|         foreach ($input as $v) {
   743|             ++$k;
   744|             if ($v < 128) { // 7bit are transferred literally
   745|                 $output .= chr($v);
   746|             } elseif ($v < (1 << 11)) { // 2 bytes
   747|                 $output .= chr(192 + ($v >> 6)) . chr(128 + ($v & 63));
   748|             } elseif ($v < (1 << 16)) { // 3 bytes
   749|                 $output .= chr(224 + ($v >> 12)) . chr(128 + (($v >> 6) & 63)) . chr(128 + ($v & 63));
   750|             } elseif ($v < (1 << 21)) { // 4 bytes
   751|                 $output .= chr(240 + ($v >> 18)) . chr(128 + (($v >> 12) & 63))
   752|                          . chr(128 + (($v >> 6) & 63)) . chr(128 + ($v & 63));
   753|             } elseif ($v < (1 << 26)) { // 5 bytes
   754|                 $output .= chr(248 + ($v >> 24)) . chr(128 + (($v >> 18) & 63))
   755|                          . chr(128 + (($v >> 12) & 63)) . chr(128 + (($v >> 6) & 63))
   756|                          . chr(128 + ($v & 63));
   757|             } elseif ($v < (1 << 31)) { // 6 bytes
   758|                 $output .= chr(252 + ($v >> 30)) . chr(128 + (($v >> 24) & 63))
   759|                          . chr(128 + (($v >> 18) & 63)) . chr(128 + (($v >> 12) & 63))
   760|                          . chr(128 + (($v >> 6) & 63)) . chr(128 + ($v & 63));
   761|             } else {
   762|                 $this->_error('Conversion from UCS-4 to UTF-8 failed: malformed input at byte '.$k);
   763|                 return false;
   764|             }
   765|         }
   766|         return $output;
   767|     }
   768|     /**
   769|       * Convert UCS-4 array into UCS-4 string
   770|       *
   771|       * @access   private
   772|       */
   773|     function _ucs4_to_ucs4_string($input)
   774|     {
   775|         $output = '';
   776|         foreach ($input as $v) {
   777|             $output .= chr(($v >> 24) & 255).chr(($v >> 16) & 255).chr(($v >> 8) & 255).chr($v & 255);
   778|         }
   779|         return $output;
   780|     }
   781|     /**
   782|       * Convert UCS-4 strin into UCS-4 garray
   783|       *
   784|       * @access   private
   785|       */
   786|     function _ucs4_string_to_ucs4($input)
   787|     {
   788|         $output = array();
   789|         $inp_len = strlen($input);
   790|         if ($inp_len % 4) {
   791|             $this->_error('Input UCS4 string is broken');
   792|             return false;
   793|         }
   794|         if (!$inp_len) return $output;
   795|         for ($i = 0, $out_len = -1; $i < $inp_len; ++$i) {
   796|             if (!($i % 4)) {
   797|                 $out_len++;
   798|                 $output[$out_len] = 0;
   799|             }
   800|             $output[$out_len] += ord($input{$i}) << (8 * (3 - ($i % 4) ) );
   801|         }
   802|         return $output;
   803|     }
   804| }
   805| /**
   806| * Adapter class for aligning the API of idna_convert with that of Net_IDNA
   807| * @author  Matthias Sommerfeld <mso@phlylabs.de>
   808| */
   809| class Net_IDNA_php4 extends idna_convert
   810| {
   811|     /**
   812|      * Sets a new option value. Available options and values:
   813|      * [encoding - Use either UTF-8, UCS4 as array or UCS4 as string as input ('utf8' for UTF-8,
   814|      *         'ucs4_string' and 'ucs4_array' respectively for UCS4); The output is always UTF-8]
   815|      * [overlong - Unicode does not allow unnecessarily long encodings of chars,
   816|      *             to allow this, set this parameter to true, else to false;
   817|      *             default is false.]
   818|      * [strict - true: strict mode, good for registration purposes - Causes errors
   819|      *           on failures; false: loose mode, ideal for "wildlife" applications
   820|      *           by silently ignoring errors and returning the original input instead
   821|      *
   822|      * @param    mixed     Parameter to set (string: single parameter; array of Parameter => Value pairs)
   823|      * @param    string    Value to use (if parameter 1 is a string)
   824|      * @return   boolean   true on success, false otherwise
   825|      * @access   public
   826|      */
   827|     function setParams($option, $param = false)
   828|     {
   829|         return $this->IC->set_parameters($option, $param);
   830|     }
   831| }
   832| ?>


# ====================================================================
# FILE: src/whois.ie.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-50 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__IE_HANDLER__'))
    21| 	define('__IE_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class ie_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28| 			'nic-hdl' => 'handle',
    29| 			'person' => 'name',
    30| 			'renewal' => 'expires'
    31| 			);
    32| 		$contacts = array(
    33|                     'admin-c' => 'admin',
    34|                     'tech-c' => 'tech',
    35| 		                );
    36| 		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    37| 		if (isset($reg['domain']['descr']))
    38| 			{
    39| 			$reg['owner']['organization'] = $reg['domain']['descr'][0];
    40| 			unset($reg['domain']['descr']);
    41| 			}
    42| 		$r['regrinfo'] = $reg;
    43| 		$r['regyinfo'] = array(
    44|                     'referrer' => 'http://www.domainregistry.ie',
    45|                     'registrar' => 'IE Domain Registry'
    46|                     );
    47| 		return $r;
    48| 		}
    49| 	}
    50| ?>


# ====================================================================
# FILE: src/whois.il.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-87 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__IL_HANDLER__'))
    21| 	define('__IL_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class il_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28| 			'fax-no' => 'fax',
    29| 			'e-mail' => 'email',
    30| 			'nic-hdl' => 'handle',
    31| 			'person' => 'name',
    32| 			'personname' => 'name',
    33| 			'address' => 'address'/*,
    34| 			'address' => 'address.city',
    35| 			'address' => 'address.pcode',
    36| 			'address' => 'address.country'*/
    37| 			);
    38| 		$contacts = array(
    39|                     'registrant' => 'owner',
    40|                     'admin-c' => 'admin',
    41|                     'tech-c' => 'tech',
    42|                     'billing-c' => 'billing',
    43|                     'zone-c' => 'zone'
    44| 		                );
    45| array_splice($data_str['rawdata'],16,1);
    46| array_splice($data_str['rawdata'],18,1);
    47| 		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    48| 		if (isset($reg['domain']['remarks']))
    49| 			unset($reg['domain']['remarks']);
    50| 		if (isset($reg['domain']['descr:']))
    51| 			{
    52| 			while (list($key, $val) = each($reg['domain']['descr:']))
    53| 				{
    54| 				$v = trim(substr(strstr($val, ':'), 1));
    55| 				if (strstr($val, '[organization]:'))
    56| 					{
    57| 					$reg['owner']['organization'] = $v;
    58| 					continue;
    59| 					}
    60| 				if (strstr($val, '[phone]:'))
    61| 					{
    62| 					$reg['owner']['phone'] = $v;
    63| 					continue;
    64| 					}
    65| 				if (strstr($val, '[fax-no]:'))
    66| 					{
    67| 					$reg['owner']['fax'] = $v;
    68| 					continue;
    69| 					}
    70| 				if (strstr($val, '[e-mail]:'))
    71| 					{
    72| 					$reg['owner']['email'] = $v;
    73| 					continue;
    74| 					}
    75| 				$reg['owner']['address'][$key] = $v;
    76| 				}
    77| 			if (isset($reg['domain']['descr:'])) unset($reg['domain']['descr:']);
    78| 			}
    79| 		$r['regrinfo'] = $reg;
    80| 		$r['regyinfo'] = array(
    81|                     'referrer' => 'http://www.isoc.org.il/',
    82|                     'registrar' => 'ISOC-IL'
    83|                     );
    84| 		return $r;
    85| 		}
    86| 	}
    87| ?>


# ====================================================================
# FILE: src/whois.in.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__IN_HANDLER__'))
    21| 	define('__IN_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class in_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		$r['regyinfo'] = array(
    29|                           'referrer' => 'http://whois.registry.in',
    30|                           'registrar' => 'INRegistry'
    31|                           );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.info.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__INFO_HANDLER__'))
    21| 	define('__INFO_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class info_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		$r['regyinfo'] = array(
    29|                           'referrer' => 'http://whois.afilias.info',
    30|                           'registrar' => 'Afilias Global Registry Services'
    31|                           );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.int.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-34 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__INT_HANDLER__'))
    21| 	define('__INT_HANDLER__', 1);
    22| require_once('whois.gtld.iana.php');
    23| class int_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$iana = new iana_handler();
    28| 		$r['regrinfo'] = $iana->parse($data_str['rawdata'], $query);
    29| 		$r['regyinfo']['referrer'] = 'http://www.iana.org/int-dom/int.htm';
    30| 		$r['regyinfo']['registrar'] = 'Internet Assigned Numbers Authority';
    31| 		return ($r);
    32| 		}
    33| 	}
    34| ?>


# ====================================================================
# FILE: src/whois.ip.afrinic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-61 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__AFRINIC_HANDLER__'))
    22| 	define('__AFRINIC_HANDLER__', 1);
    23| class afrinic_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28|                       'fax-no' => 'fax',
    29|                       'e-mail' => 'email',
    30|                       'nic-hdl' => 'handle',
    31|                       'person' => 'name',
    32|                       'netname' => 'name',
    33|                       'organisation' => 'handle',
    34|                       'org-name' => 'organization',
    35|                       'org-type' => 'type'
    36| 		                  );
    37| 		$contacts = array(
    38|                       'admin-c' => 'admin',
    39|                       'tech-c' => 'tech',
    40|                       'org' => 'owner'
    41| 		                  );
    42| 		$r = generic_parser_a($data_str, $translate, $contacts, 'network', 'Ymd');
    43| 		if (isset($r['network']['descr']))
    44| 			{
    45| 			$r['owner']['organization'] = $r['network']['descr'];
    46| 			unset($r['network']['descr']);
    47| 			}
    48| 		if (isset($r['owner']['remarks']) && is_array($r['owner']['remarks']))
    49| 			while (list($key, $val) = each($r['owner']['remarks']))
    50| 				{
    51| 				$pos = strpos($val,'rwhois://');
    52| 				if ($pos!==false)
    53| 					$r['rwhois'] = strtok(substr($val,$pos),' ');
    54| 				}
    55| 		$r = array( 'regrinfo' => $r );
    56| 		$r['regyinfo']['type'] = 'ip';
    57| 		$r['regyinfo']['registrar'] = 'African Network Information Center';
    58| 		return $r;
    59| 		}
    60| 	}
    61| ?>


# ====================================================================
# FILE: src/whois.ip.apnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-99 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| require_once('whois.parser.php');
    21| if(!defined('__APNIC_HANDLER__'))
    22|   define('__APNIC_HANDLER__',1);
    23| class apnic_handler
    24| 	{
    25| 	function parse ($data_str, $query)
    26| 		{
    27| 		$translate = array (
    28| 							'fax-no' => 'fax',
    29| 							'e-mail' => 'email',
    30| 							'nic-hdl' => 'handle',
    31| 							'person' => 'name',
    32| 							'country' => 'address',
    33| 							'netname' => 'name',
    34| 							'descr' => 'desc',
    35| 							'aut-num' => 'handle',
    36| 							'country' => 'country'
    37| 							  );
    38| 		$contacts = array (
    39| 							  'admin-c' => 'admin',
    40| 							  'tech-c' => 'tech'
    41| 							  );
    42| 		$blocks = generic_parser_a_blocks($data_str,$translate,$disclaimer);
    43| 		if (isset($disclaimer) && is_array($disclaimer)) $r['disclaimer'] = $disclaimer;
    44| 		if (empty($blocks) || !is_array($blocks['main']))
    45| 			{
    46| 			$r['registered'] = 'no';
    47| 			}
    48| 		else
    49| 			{
    50| 			if (isset($blocks[$query]))
    51| 				{
    52| 				$as = true;
    53| 				$rb = $blocks[$query];
    54| 				}
    55| 			else
    56| 				{
    57| 				$rb = $blocks['main'];
    58| 				$as = false;
    59| 				}
    60| 			$r['registered'] = 'yes';
    61| 			while (list($key,$val) = each($contacts))
    62| 				if (isset($rb[$key]))
    63| 					{
    64| 					if (is_array($rb[$key]))
    65| 						$blk = $rb[$key][count($rb[$key])-1];
    66| 					else
    67| 						$blk = $rb[$key];
    68| 					if (isset($blocks[$blk])) $r[$val] = $blocks[$blk];
    69| 					unset($rb[$key]);
    70| 					}
    71| 			$r['network'] = $rb;
    72| 			format_dates($r,'Ymd');
    73| 			if (isset($r['network']['desc']))
    74| 				{
    75| 				if (is_array($r['network']['desc']))
    76| 					{
    77| 					$r['owner']['organization'] = array_shift($r['network']['desc']);
    78| 					$r['owner']['address'] = $r['network']['desc'];
    79| 					}
    80| 				else
    81| 					$r['owner']['organization'] = $r['network']['desc'];
    82| 				unset($r['network']['desc']);
    83| 				}
    84| 			if (isset($r['network']['address']))
    85| 				{
    86| 				if (isset($r['owner']['address']))
    87| 					$r['owner']['address'][] = $r['network']['address'];
    88| 				else
    89| 					$r['owner']['address'] = $r['network']['address'];
    90| 				unset($r['network']['address']);
    91| 				}
    92| 			}
    93| 		$r = array( 'regrinfo' => $r );
    94| 		$r['regyinfo']['type'] ='ip';
    95| 		$r['regyinfo']['registrar'] = 'Asia Pacific Network Information Centre';
    96| 		return $r;
    97| 		}
    98| }
    99| ?>


# ====================================================================
# FILE: src/whois.ip.arin.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-64 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ARIN_HANDLER__'))
    21| 	define('__ARIN_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class arin_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'OrgName:' 	=> 'owner.organization',
    29|                   'CustName:' 	=> 'owner.organization',
    30|                   'OrgId:' 		=> 'owner.handle',
    31|                   'Address:' 	=> 'owner.address.street.',
    32|                   'City:' 		=> 'owner.address.city',
    33|                   'StateProv:' 	=> 'owner.address.state',
    34|                   'PostalCode:' => 'owner.address.pcode',
    35|                   'Country:' 	=> 'owner.address.country',
    36|                   'NetRange:' 	=> 'network.inetnum',
    37|                   'NetName:' 	=> 'network.name',
    38|                   'NetHandle:' 	=> 'network.handle',
    39|                   'NetType:' 	=> 'network.status',
    40|                   'NameServer:' => 'network.nserver.',
    41|                   'Comment:' 	=> 'network.desc.',
    42|                   'RegDate:' 	=> 'network.created',
    43|                   'Updated:' 	=> 'network.changed',
    44|                   'ASHandle:' 	=> 'network.handle',
    45|                   'ASName:' 	=> 'network.name',
    46|                   'NetHandle:' 	=> 'network.handle',
    47|                   'NetName:' 	=> 'network.name',
    48|                   'TechHandle:' => 'tech.handle',
    49|                   'TechName:' 	=> 'tech.name',
    50|                   'TechPhone:' 	=> 'tech.phone',
    51|                   'TechEmail:' 	=> 'tech.email',
    52|                   'OrgAbuseName:' 	=> 'abuse.name',
    53|                   'OrgAbuseHandle:' => 'abuse.handle',
    54|                   'OrgAbusePhone:' 	=> 'abuse.phone',
    55|                   'OrgAbuseEmail:' 	=> 'abuse.email.',
    56|                   'ReferralServer:' => 'rwhois'
    57| 		              );
    58| 		$r = generic_parser_b($data_str, $items, 'ymd', false, true);
    59| 		if (@isset($r['abuse']['email']))
    60| 		    $r['abuse']['email'] = implode(',',$r['abuse']['email']);
    61| 		return array( 'regrinfo' => $r );
    62| 		}
    63| 	}
    64| ?>


# ====================================================================
# FILE: src/whois.ip.krnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-88 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__KRNIC_HANDLER__'))
    21| 	define('__KRNIC_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class krnic_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$blocks = array(
    28|                     'owner1' => '[ Organization Information ]',
    29|                     'tech1' => '[ Technical Contact Information ]',
    30|                     'owner2' => '[ ISP Organization Information ]',
    31|                     'admin2' => '[ ISP IP Admin Contact Information ]',
    32|                     'tech2' => '[ ISP IP Tech Contact Information ]',
    33|                     'admin3' => '[ ISP IPv4 Admin Contact Information ]',
    34|                     'tech3' => '[ ISP IPv4 Tech Contact Information ]',
    35|                     'abuse' => '[ ISP Network Abuse Contact Information ]',
    36|                     'network.inetnum' => 'IPv4 Address       :',
    37|                     'network.name' => 'Network Name       :',
    38|                     'network.mnt-by' => 'Connect ISP Name   :',
    39|                     'network.created' => 'Registration Date  :'
    40| 		              );
    41| 		$items = array(
    42|                     'Orgnization ID     :' => 'handle',
    43|                     'Org Name      :' => 'organization',
    44|                     'Org Name           :' => 'organization',
    45|                     'Name          :' => 'name',
    46|                     'Name               :' => 'name',
    47|                     'Org Address   :' => 'address.street',
    48|                     'Zip Code      :' => 'address.pcode',
    49|                     'State         :' => 'address.state',
    50|                     'Address            :' => 'address.street',
    51|                     'Zip Code           :' => 'address.pcode',
    52|                     'Phone         :' => 'phone',
    53|                     'Phone              :' => 'phone',
    54|                     'Fax           :' => 'fax',
    55|                     'E-Mail        :' => 'email',
    56|                     'E-Mail             :' => 'email'
    57| 		              );
    58| 		$b = get_blocks($data_str, $blocks);
    59| 		if (isset($b['network']))
    60| 			$r['network'] = $b['network'];
    61| 		if (isset($b['owner1']))
    62| 			$r['owner'] = generic_parser_b($b['owner1'], $items, 'Ymd', false);
    63| 		else
    64| 			if (isset($b['owner2']))
    65| 				$r['owner'] = generic_parser_b($b['owner2'], $items, 'Ymd', false);
    66| 		if (isset($b['admin2']))
    67| 			$r['admin'] = generic_parser_b($b['admin2'], $items, 'Ymd', false);
    68| 		else
    69| 			if (isset($b['admin3']))
    70| 				$r['admin'] = generic_parser_b($b['admin3'], $items, 'Ymd', false);
    71| 		if (isset($b['tech1']))
    72| 			$r['tech'] = generic_parser_b($b['tech1'], $items, 'Ymd', false);
    73| 		else
    74| 			if (isset($b['tech2']))
    75| 				$r['tech'] = generic_parser_b($b['tech2'], $items, 'Ymd', false);
    76| 			else
    77| 				if (isset($b['tech3']))
    78| 					$r['tech'] = generic_parser_b($b['tech3'], $items, 'Ymd', false);
    79| 		if (isset($b['abuse']))
    80| 			$r['abuse'] = generic_parser_b($b['abuse'], $items, 'Ymd', false);
    81| 		$r = format_dates($r, 'Ymd');
    82| 		$r = array( 'regrinfo' => $r );
    83| 		$r['regyinfo']['type'] ='ip';
    84| 		$r['regyinfo']['registrar'] = 'Korean Network Information Centre';
    85| 		return $r;
    86| 		}
    87| 	}
    88| ?>


# ====================================================================
# FILE: src/whois.ip.lacnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-63 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__LACNIC_HANDLER__'))
    22| 	define('__LACNIC_HANDLER__', 1);
    23| class lacnic_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28|                       'fax-no' => 'fax',
    29|                       'e-mail' => 'email',
    30|                       'nic-hdl-br' => 'handle',
    31|                       'nic-hdl' => 'handle',
    32|                       'person' => 'name',
    33|                       'netname' => 'name',
    34|                       'descr' => 'desc',
    35|                       'country' => 'address.country'
    36| 		                  );
    37| 		$contacts = array(
    38|                       'owner-c' => 'owner',
    39|                       'tech-c' => 'tech',
    40|                       'abuse-c' => 'abuse',
    41|                       'admin-c' => 'admin'
    42| 		                  );
    43| 		$r = generic_parser_a($data_str, $translate, $contacts, 'network');
    44| 		unset($r['network']['owner']);
    45| 		unset($r['network']['ownerid']);
    46| 		unset($r['network']['responsible']);
    47| 		unset($r['network']['address']);
    48| 		unset($r['network']['phone']);
    49| 		unset($r['network']['aut-num']);
    50| 		unset($r['network']['nsstat']);
    51| 		unset($r['network']['nslastaa']);
    52| 		unset($r['network']['inetrev']);
    53| 		if (!empty($r['network']['aut-num']))
    54| 			$r['network']['handle'] = $r['network']['aut-num'];
    55| 		if (isset($r['network']['nserver']))
    56| 			$r['network']['nserver'] = array_unique($r['network']['nserver']);
    57| 		$r = array( 'regrinfo' => $r );
    58| 		$r['regyinfo']['type'] ='ip';
    59| 		$r['regyinfo']['registrar'] = 'Latin American and Caribbean IP address Regional Registry';
    60| 		return $r;
    61| 		}
    62| 	}
    63| ?>


# ====================================================================
# FILE: src/whois.ip.lib.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-86 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| function phpwhois_validip($ip)
    21| {
    22| 	if (empty($ip))
    23| 		return false;
    24| 	if ((ip2long($ip) == -1) or (ip2long($ip) === false))
    25| 		return false;
    26| 	$reserved_ips = array (
    27| 			array('0.0.0.0','2.255.255.255'),
    28| 			array('10.0.0.0','10.255.255.255'),
    29| 			array('127.0.0.0','127.255.255.255'),
    30| 			array('169.254.0.0','169.254.255.255'),
    31| 			array('172.16.0.0','172.31.255.255'),
    32| 			array('192.0.2.0','192.0.2.255'),
    33| 			array('192.168.0.0','192.168.255.255'),
    34| 			array('255.255.255.0','255.255.255.255')
    35| 			);
    36| 	foreach ($reserved_ips as $r)
    37| 		{
    38| 		$min = ip2long($r[0]);
    39| 		$max = ip2long($r[1]);
    40| 		if ((ip2long($ip) >= $min) && (ip2long($ip) <= $max)) return false;
    41| 		}
    42| 	return true;
    43| }
    44| function phpwhois_getclientip()
    45| {
    46| 	if (!empty($_SERVER['HTTP_CLIENT_IP']) && phpwhois_validip($_SERVER['HTTP_CLIENT_IP']))
    47| 			return $_SERVER['HTTP_CLIENT_IP'];
    48| 	if (!empty($_SERVER['HTTP_X_FORWARDED_FOR']))
    49| 		foreach (explode(',',$_SERVER['HTTP_X_FORWARDED_FOR']) as $ip)
    50| 			if (phpwhois_validip(trim($ip)))
    51| 				return $ip;
    52|    if (!empty($_SERVER['HTTP_X_FORWARDED']) && phpwhois_validip($_SERVER['HTTP_X_FORWARDED']))
    53|        return $_SERVER['HTTP_X_FORWARDED'];
    54|    if (!empty($_SERVER['HTTP_FORWARDED_FOR']) && phpwhois_validip($_SERVER['HTTP_FORWARDED_FOR']))
    55|        return $_SERVER['HTTP_FORWARDED_FOR'];
    56|    if (!empty($_SERVER['HTTP_FORWARDED']) && phpwhois_validip($_SERVER['HTTP_FORWARDED']))
    57|        return $_SERVER['HTTP_FORWARDED'];
    58|    if (!empty($_SERVER['HTTP_X_FORWARDED']) && phpwhois_validip($_SERVER['HTTP_X_FORWARDED']))
    59|        return $_SERVER['HTTP_X_FORWARDED'];
    60|    return $_SERVER['REMOTE_ADDR'];
    61| }
    62| function phpwhois_cidr_conv($net)
    63| {
    64| 	$start = strtok($net, '/');
    65| 	$n = 3-substr_count($net, '.');
    66| 	if ($n > 0)
    67| 		{
    68| 		for ($i = $n; $i > 0; $i--)
    69| 			$start.= '.0';
    70| 		}
    71| 	$bits1 = str_pad(decbin(ip2long($start)), 32, '0', 'STR_PAD_LEFT');
    72| 	$net = pow(2, (32-substr(strstr($net, '/'), 1))) - 1;
    73| 	$bits2 = str_pad(decbin($net), 32, '0', 'STR_PAD_LEFT');
    74| 	$final = '';
    75| 	for ($i = 0; $i < 32; $i++)
    76| 		{
    77| 		if ($bits1[$i] == $bits2[$i])
    78| 			$final.= $bits1[$i];
    79| 		if ($bits1[$i] == 1 and $bits2[$i] == 0)
    80| 			$final.= $bits1[$i];
    81| 		if ($bits1[$i] == 0 and $bits2[$i] == 1)
    82| 			$final.= $bits2[$i];
    83| 		}
    84| 	return $start." - ".long2ip(bindec($final));
    85| }
    86| ?>


# ====================================================================
# FILE: src/whois.ip.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-219 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__IP_HANDLER__'))
    21| 	define('__IP_HANDLER__', 1);
    22| require_once('whois.ip.lib.php');
    23| class ip_handler extends WhoisClient
    24| 	{
    25| 	var $deep_whois = true;
    26| 	var $HANDLER_VERSION = '1.0';
    27| 	var $REGISTRARS = array(
    28|                         'European Regional Internet Registry/RIPE NCC' =>	'whois.ripe.net',
    29|                         'RIPE Network Coordination Centre' => 'whois.ripe.net',
    30|                         'Asia Pacific Network Information	Center' => 'whois.apnic.net',
    31|                         'Asia Pacific Network Information Centre' => 'whois.apnic.net',
    32|                         'Latin American and Caribbean IP address Regional Registry'	=> 'whois.lacnic.net',
    33|                         'African Network Information Center' => 'whois.afrinic.net'
    34| 	                     );
    35| 	var $HANDLERS = array(
    36| 						'whois.krnic.net' => 'krnic',
    37| 						'whois.apnic.net' => 'apnic',
    38| 						'whois.ripe.net' => 'ripe',
    39| 						'whois.arin.net' =>	'arin',
    40| 						'whois.lacnic.net' => 'lacnic',
    41| 						'whois.afrinic.net' => 'afrinic'
    42| 	                     );
    43| 	var $more_data = array();	// More queries to get more accurated data
    44| 	var $done = array();
    45| 	function parse($data, $query)
    46| 		{
    47| 		$result['regrinfo'] = array();
    48| 		$result['regyinfo'] = array();
    49| 		$result['regyinfo']['registrar'] = 'American Registry for Internet Numbers (ARIN)';
    50| 		$result['rawdata'] = array();
    51| 		if (strpos($query,'.') === false)
    52| 			$result['regyinfo']['type'] = 'AS';
    53| 		else
    54| 			$result['regyinfo']['type'] = 'ip';
    55| 		if (!$this->deep_whois) return null;
    56| 		$this->Query = array();
    57| 		$this->Query['server'] = 'whois.arin.net';
    58| 		$this->Query['query'] = $query;
    59| 		$rawdata = $data['rawdata'];
    60| 		if (empty($rawdata)) return $result;
    61| 		$presults[] = $rawdata;
    62| 		$ip = ip2long($query);
    63| 		$done = array();
    64| 		while (count($presults) > 0)
    65| 			{
    66| 			$rwdata = array_shift($presults);
    67| 			$found = false;
    68| 			foreach($rwdata as $line)
    69| 				{
    70| 				if (!strncmp($line,'American Registry for Internet Numbers',38)) continue;
    71| 				$p = strpos($line, '(NETBLK-');
    72| 				if ($p === false) $p = strpos($line, '(NET-');
    73| 				if ($p !== false)
    74| 					{
    75| 					$net = strtok(substr($line,$p+1),') ');
    76| 					list($low,$high) = explode('-',str_replace(' ','',substr($line,$p+strlen($net)+3)));
    77| 					if (!isset($done[$net]) && $ip >= ip2long($low) && $ip <= ip2long($high))
    78| 						{
    79| 						$owner = substr($line,0,$p-1);
    80| 						if (!empty($this->REGISTRARS['owner']))
    81| 							{
    82| 							$this->handle_rwhois($this->REGISTRARS['owner'],$query);
    83| 							break 2;
    84| 							}
    85| 						else
    86| 							{
    87| 							$this->Query['args'] = 'n '.$net;
    88| 							$presults[] = $this->GetRawData($net);
    89| 							$done[$net] = 1;
    90| 							}
    91| 						}
    92| 					$found = true;
    93| 					}
    94| 				}
    95| 			if (!$found)
    96| 				{
    97| 				$this->Query['file'] = 'whois.ip.arin.php';
    98| 				$this->Query['handler'] = 'arin';
    99| 				$result = $this->parse_results($result,$rwdata,$query,true);
   100| 				}
   101| 			}
   102| 		unset($this->Query['args']);
   103| 		while (count($this->more_data) > 0)
   104| 			{
   105| 			$srv_data = array_shift($this->more_data);
   106| 			$this->Query['server'] = $srv_data['server'];
   107| 			unset($this->Query['handler']);
   108| 			$rwdata = $this->GetRawData($srv_data['query']);
   109| 			if (!empty($rwdata))
   110| 				{
   111| 				if (!empty($srv_data['handler']))
   112| 					{
   113| 					$this->Query['handler'] = $srv_data['handler'];
   114| 					if (!empty($srv_data['file']))
   115| 						$this->Query['file'] = $srv_data['file'];
   116| 					else
   117| 						$this->Query['file'] = 'whois.'.$this->Query['handler'].'.php';
   118| 					}
   119| 				$result = $this->parse_results($result,$rwdata,$query,$srv_data['reset']);
   120| 				$result = $this->set_whois_info($result);
   121| 				$reset = false;
   122| 				}
   123| 			}
   124| 		if (isset($result['regrinfo']['network']['nserver']))
   125| 			{
   126| 			if (!is_array($result['regrinfo']['network']['nserver']))
   127| 				{
   128| 				unset($result['regrinfo']['network']['nserver']);
   129| 				}
   130| 			else
   131| 				$result['regrinfo']['network']['nserver'] = $this->FixNameServer($result['regrinfo']['network']['nserver']);
   132| 			}
   133| 		return $result;
   134| 		}
   135| 	function parse_results($result,$rwdata,$query,$reset)
   136| 		{
   137| 		$rwres = $this->Process($rwdata);
   138| 		if ($result['regyinfo']['type'] == 'AS' && !empty($rwres['regrinfo']['network']))
   139| 			{
   140| 			$rwres['regrinfo']['AS'] = $rwres['regrinfo']['network'];
   141| 			unset($rwres['regrinfo']['network']);
   142| 			}
   143| 		if ($reset)
   144| 			{
   145| 			$result['regrinfo'] = $rwres['regrinfo'];
   146| 			$result['rawdata'] = $rwdata;
   147| 			}
   148| 		else
   149| 			{
   150| 			$result['rawdata'][] = '';
   151| 			foreach ($rwdata as $line)
   152| 				$result['rawdata'][] = $line;
   153| 			foreach($rwres['regrinfo'] as $key => $data)
   154| 				{
   155| 				$result = $this->join_result($result,$key,$rwres);
   156| 				}
   157| 			}
   158| 		if ($this->deep_whois)
   159| 			{
   160| 			if (isset($rwres['regrinfo']['rwhois']))
   161| 				{
   162| 				$this->handle_rwhois($rwres['regrinfo']['rwhois'],$query);
   163| 				unset($result['regrinfo']['rwhois']);
   164| 				}
   165| 			else
   166| 				if (!@empty($rwres['regrinfo']['owner']['organization']))
   167| 					switch ($rwres['regrinfo']['owner']['organization'])
   168| 						{
   169| 						case 'KRNIC':
   170| 							$this->handle_rwhois('whois.krnic.net',$query);
   171| 							break;
   172| 						case 'African Network Information Center':
   173| 							$this->handle_rwhois('whois.afrinic.net',$query);
   174| 							break;
   175| 						}
   176| 			}
   177| 		if (!empty($rwres['regyinfo']))
   178| 			$result['regyinfo'] = array_merge($result['regyinfo'],$rwres['regyinfo']);
   179| 		return $result;
   180| 		}
   181| 	function handle_rwhois($server,$query)
   182| 		{
   183| 		$parts = parse_url($server);
   184| 		if (empty($parts['host']))
   185| 			$host = $parts['path'];
   186| 		else
   187| 			$host = $parts['host'];
   188| 		if (array_key_exists($host,$this->done)) return;
   189| 		$q = array (
   190| 					'query' => $query,
   191| 					'server' => $server
   192| 					);
   193| 		if (isset($this->HANDLERS[$host]))
   194| 			{
   195| 			$q['handler'] = $this->HANDLERS[$host];
   196| 			$q['file'] = sprintf('whois.ip.%s.php', $q['handler']);
   197| 			$q['reset'] = true;
   198| 			}
   199| 		else
   200| 			{
   201| 			$q['handler'] = 'rwhois';
   202| 			$q['reset'] = false;
   203| 			unset($q['file']);
   204| 			}
   205| 		$this->more_data[] = $q;
   206| 		$this->done[$host] = 1;
   207| 		}
   208| 	function join_result($result, $key, $newres)
   209| 		{
   210| 		if (isset($result['regrinfo'][$key]) && !array_key_exists(0,$result['regrinfo'][$key]))
   211| 			{
   212| 			$r = $result['regrinfo'][$key];
   213| 			$result['regrinfo'][$key] = array($r);
   214| 			}
   215| 		$result['regrinfo'][$key][] = $newres['regrinfo'][$key];
   216| 		return $result;
   217| 		}
   218| 	}
   219| ?>


# ====================================================================
# FILE: src/whois.ip.ripe.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-66 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__RIPE_HANDLER__'))
    22| 	define('__RIPE_HANDLER__', 1);
    23| class ripe_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28| 						'fax-no' => 'fax',
    29| 						'e-mail' => 'email',
    30| 						'nic-hdl' => 'handle',
    31| 						'person' => 'name',
    32| 						'netname' => 'name',
    33| 						'descr' => 'desc'
    34| 		                  );
    35| 		$contacts = array(
    36| 						'admin-c' => 'admin',
    37| 						'tech-c' => 'tech'
    38| 		                  );
    39| 		if (!empty($data_str['rawdata'])) $data_str = $data_str['rawdata'];
    40| 		$r = generic_parser_a($data_str, $translate, $contacts, 'network');
    41| 		if (isset($r['network']['desc']))
    42| 			{
    43| 			$r['owner']['organization'] = $r['network']['desc'];
    44| 			unset($r['network']['desc']);
    45| 			}
    46| 		if (isset($r['admin']['abuse-mailbox']))
    47| 			{
    48| 			$r['abuse']['email'] = $r['admin']['abuse-mailbox'];
    49| 			unset($r['admin']['abuse-mailbox']);
    50| 			}
    51| 		if (isset($r['tech']['abuse-mailbox']))
    52| 			{
    53| 			$r['abuse']['email'] = $r['tech']['abuse-mailbox'];
    54| 			unset($r['tech']['abuse-mailbox']);
    55| 			}
    56| 		if (isset($r['tech']['tech-c']))  unset($r['tech']['tech-c']);
    57| 		if (isset($r['tech']['admin-c'])) unset($r['tech']['admin-c']);
    58| 		if (isset($r['admin']['tech-c']))  unset($r['admin']['tech-c']);
    59| 		if (isset($r['admin']['admin-c'])) unset($r['admin']['admin-c']);
    60| 		$r = array( 'regrinfo' => $r );
    61| 		$r['regyinfo']['type'] ='ip';
    62| 		$r['regyinfo']['registrar'] = 'RIPE Network Coordination Centre';
    63| 		return $r;
    64| 		}
    65| 	}
    66| ?>


# ====================================================================
# FILE: src/whois.ir.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-52 ---
     1| <?php
     2| /**
     3|  * PHPWhois IR Lookup Extension - http://github.com/sepehr/phpwhois-ir
     4|  *
     5|  * An extension to PHPWhois (http://phpwhois.org) library to support IR lookups.
     6|  *
     7|  * This program is free software: you can redistribute it and/or modify
     8|  * it under the terms of the GNU General Public License as published by
     9|  * the Free Software Foundation, either version 3 of the License, or
    10|  * (at your option) any later version.
    11|  *
    12|  * This program is distributed in the hope that it will be useful,
    13|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    14|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15|  * GNU General Public License for more details.
    16|  *
    17|  * You should have received a copy of the GNU General Public License
    18|  * along with this program. If not, see <http://www.gnu.org/licenses/>.
    19|  */
    20| if (!defined('__IR_HANDLER__'))
    21|   define('__IR_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| /**
    24|  * IR Domain names lookup handler class.
    25|  */
    26| class ir_handler
    27| 	{
    28| 	function parse($data_str, $query)
    29| 		{
    30| 		$translate = array(
    31| 			'nic-hdl'	=> 'handle',
    32| 			'org'		=> 'organization',
    33| 			'e-mail'	=> 'email',
    34| 			'person'	=> 'name',
    35| 			'fax-no'	=> 'fax',
    36| 			'domain'	=> 'name'
    37| 			);
    38| 		$contacts = array(
    39|                     'admin-c'	=> 'admin',
    40|                     'tech-c'	=> 'tech',
    41|                     'holder-c'	=> 'owner'
    42| 		                );
    43| 		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    44| 		$r['regrinfo'] = $reg;
    45| 		$r['regyinfo'] = array(
    46|                     'referrer'=>'http://whois.nic.ir/',
    47| 					'registrar' => 'NIC-IR'
    48|                     );
    49| 		return $r;
    50| 		}
    51| 	}
    52| ?>


# ====================================================================
# FILE: src/whois.is.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-55 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__IS_HANDLER__'))
    21| 	define('__IS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class is_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28|                       'fax-no' => 'fax',
    29|                       'e-mail' => 'email',
    30|                       'nic-hdl' => 'handle',
    31|                       'person' => 'name'
    32| 		                  );
    33| 		$contacts = array(
    34|                       'owner-c' => 'owner',
    35|                       'admin-c' => 'admin',
    36|                       'tech-c' => 'tech',
    37|                       'billing-c' => 'billing',
    38|                       'zone-c' => 'zone'
    39| 		                  );
    40| 		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'mdy');
    41| 		if (isset($reg['domain']['descr']))
    42| 			{
    43| 			$reg['owner']['name'] = array_shift($reg['domain']['descr']);
    44| 			$reg['owner']['address'] = $reg['domain']['descr'];
    45| 			unset($reg['domain']['descr']);
    46| 			}
    47| 		$r['regrinfo'] = $reg;
    48| 		$r['regyinfo'] = array(
    49|                           'referrer' => 'http://www.isnic.is',
    50|                           'registrar' => 'ISNIC'
    51|                           );
    52| 		return $r;
    53| 		}
    54| 	}
    55| ?>


# ====================================================================
# FILE: src/whois.it.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-63 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| /*
    21| BUG
    22| - nserver -> array
    23| - ContactID in address
    24| */
    25| if (!defined('__IT_HANDLER__'))
    26| 	define('__IT_HANDLER__', 1);
    27| require_once('whois.parser.php');
    28| class it_handler
    29| 	{
    30| 	function parse($data_str, $query)
    31| 		{
    32| 		$items = array(
    33| 			'domain.name' =>	'Domain:',
    34| 			'domain.nserver' =>	'Nameservers',
    35| 			'domain.status' =>	'Status:',
    36| 			'domain.expires' =>	'Expire Date:',
    37| 			'owner' 	=>	'Registrant',
    38| 			'admin' 	=>	'Admin Contact',
    39| 			'tech' 		=>	'Technical Contacts',
    40| 			'registrar' =>	'Registrar'
    41| 		            );
    42| 		$extra = array(
    43| 			'address:' 		=> 'address.',
    44| 			'contactid:'	=> 'handle',
    45| 			'organization:' => 'organization',
    46| 			'created:'		=> 'created',
    47| 			'last update:' 	=> 'changed',
    48| 			'web:'			=> 'web'
    49| 		            );
    50| 		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd',$extra);
    51| 		if (isset($r['regrinfo']['registrar']))
    52| 			{
    53| 			$r['regrinfo']['domain']['registrar'] = $r['regrinfo']['registrar'];
    54| 			unset($r['regrinfo']['registrar']);
    55| 			}
    56| 		$r['regyinfo'] = array(
    57|                   'registrar' => 'IT-Nic',
    58|                   'referrer' => 'http://www.nic.it/'
    59|                   );
    60| 		return $r;
    61| 		}
    62| 	}
    63| ?>


# ====================================================================
# FILE: src/whois.jp.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-92 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| if (!defined('__JP_HANDLER__'))
    21| 	define('__JP_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class jp_handler extends WhoisClient
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 						'[State]' => 'domain.status',
    29| 						'[Status]' => 'domain.status',
    30| 						'[Registered Date]' => 'domain.created',
    31| 						'[Created on]' => 'domain.created',
    32| 						'[Expires on]' => 'domain.expires',
    33| 						'[Last Updated]' => 'domain.changed',
    34| 						'[Last Update]' => 'domain.changed',
    35| 						'[Organization]' => 'owner.organization',
    36| 						'[Name]' => 'owner.name',
    37| 						'[Email]' => 'owner.email',
    38| 						'[Postal code]' => 'owner.address.pcode',
    39| 						'[Postal Address]' => 'owner.address.street',
    40| 						'[Phone]' => 'owner.phone',
    41| 						'[Fax]' => 'owner.fax',
    42| 						'[Administrative Contact]' => 'admin.handle',
    43| 						'[Technical Contact]' => 'tech.handle',
    44| 						'[Name Server]' => 'domain.nserver.'
    45| 						);
    46| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
    47| 		$r['regyinfo'] = array(
    48|                           'referrer' => 'http://www.jprs.jp',
    49|                           'registrar' => 'Japan Registry Services'
    50|                           );
    51| 		if (!$this->deep_whois) return $r;
    52| 		$r['rawdata'] = $data_str['rawdata'];
    53| 		$items = array(
    54| 					'a. [JPNIC Handle]'	=> 'handle',
    55| 					'c. [Last, First]'	=> 'name',
    56| 					'd. [E-Mail]'		=> 'email',
    57| 					'g. [Organization]' => 'organization',
    58| 					'o. [TEL]'			=> 'phone',
    59| 					'p. [FAX]'			=> 'fax',
    60| 					'[Last Update]'		=> 'changed'
    61| 					);
    62| 		$this->Query['server'] = 'jp.whois-servers.net';
    63| 		if (!empty($r['regrinfo']['admin']['handle']))
    64| 			{
    65| 			$rwdata = $this->GetRawData('CONTACT '.$r['regrinfo']['admin']['handle'].'/e');
    66| 			$r['rawdata'][] = '';
    67| 			$r['rawdata'] = array_merge($r['rawdata'],$rwdata);
    68| 			$r['regrinfo']['admin'] = generic_parser_b($rwdata,$items,'ymd',false);
    69| 			$r = $this->set_whois_info($r);
    70| 			}
    71| 		if (!empty($r['regrinfo']['tech']['handle']))
    72| 			{
    73| 			if (!empty($r['regrinfo']['admin']['handle']) &&
    74| 				$r['regrinfo']['admin']['handle'] == $r['regrinfo']['tech']['handle'])
    75| 				{
    76| 				$r['regrinfo']['tech'] = $r['regrinfo']['admin'];
    77| 				}
    78| 			else
    79| 				{
    80| 				unset($this->Query);
    81| 				$this->Query['server'] = 'jp.whois-servers.net';
    82| 				$rwdata = $this->GetRawData('CONTACT '.$r['regrinfo']['tech']['handle'].'/e');
    83| 				$r['rawdata'][] = '';
    84| 				$r['rawdata'] = array_merge($r['rawdata'],$rwdata);
    85| 				$r['regrinfo']['tech'] = generic_parser_b($rwdata,$items,'ymd',false);
    86| 				$r = $this->set_whois_info($r);
    87| 				}
    88| 			}
    89| 		return $r;
    90| 		}
    91| 	}
    92| ?>


# ====================================================================
# FILE: src/whois.lt.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__LT_HANDLER__'))
    21| 	define('__LT_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class lt_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$translate = array(
    28| 					'contact nic-hdl:' => 'handle',
    29| 					'contact name:' => 'name'
    30| 					);
    31| 		$items = array(
    32| 						'admin' 			=> 'Contact type:      Admin',
    33| 						'tech'				=> 'Contact type:      Tech',
    34| 						'zone'				=> 'Contact type:      Zone',
    35| 						'owner.name'		=> 'Registrar:',
    36| 						'owner.email'		=> 'Registrar email:',
    37| 						'domain.status' 	=> 'Status:',
    38| 						'domain.created'	=> 'Registered:',
    39| 						'domain.changed'	=> 'Last updated:',
    40| 						'domain.nserver.'	=> 'NS:',
    41| 						''		=> '%'
    42| 						);
    43| 		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd', $translate);
    44| 		$r['regyinfo'] = array(
    45|                     'referrer' => 'http://www.domreg.lt',
    46|                     'registrar' => 'DOMREG.LT'
    47|                     );
    48| 		return $r;
    49| 		}
    50| 	}
    51| ?>


# ====================================================================
# FILE: src/whois.lu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-66 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__LU_HANDLER__'))
    21| 	define('__LU_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class lu_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'domainname:' => 'domain.name',
    29|                   'domaintype:' => 'domain.status',
    30|                   'nserver:' => 'domain.nserver.',
    31|                   'registered:' => 'domain.created',
    32|                   'source:' => 'domain.source',
    33|                   'ownertype:' => 'owner.type',
    34|                   'org-name:' => 'owner.organization',
    35|                   'org-address:' => 'owner.address.',
    36|                   'org-zipcode:' => 'owner.address.pcode',
    37|                   'org-city:' => 'owner.address.city',
    38|                   'org-country:' => 'owner.address.country',
    39|                   'adm-name:' => 'admin.name',
    40|                   'adm-address:' => 'admin.address.',
    41|                   'adm-zipcode:' => 'admin.address.pcode',
    42|                   'adm-city:' => 'admin.address.city',
    43|                   'adm-country:' => 'admin.address.country',
    44|                   'adm-email:' => 'admin.email',
    45|                   'tec-name:' => 'tech.name',
    46|                   'tec-address:' => 'tech.address.',
    47|                   'tec-zipcode:' => 'tech.address.pcode',
    48|                   'tec-city:' => 'tech.address.city',
    49|                   'tec-country:' => 'tech.address.country',
    50|                   'tec-email:' => 'tech.email',
    51|                   'bil-name:' => 'billing.name',
    52|                   'bil-address:' => 'billing.address.',
    53|                   'bil-zipcode:' => 'billing.address.pcode',
    54|                   'bil-city:' => 'billing.address.city',
    55|                   'bil-country:' => 'billing.address.country',
    56|                   'bil-email:' => 'billing.email'
    57| 		              );
    58| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
    59| 		$r['regyinfo'] = array(
    60|                             'referrer' => 'http://www.dns.lu',
    61|                             'registrar' => 'DNS-LU'
    62|                           );
    63| 		return $r;
    64| 		}
    65| 	}
    66| ?>


# ====================================================================
# FILE: src/whois.ly.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-58 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__LY_HANDLER__'))
    22| 	define('__LY_HANDLER__', 1);
    23| class ly_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 				'owner' => 'Registrant:',
    29| 				'admin' => 'Administrative Contact:',
    30| 				'tech' => 'Technical Contact:',
    31| 				'domain.name' => 'Domain Name:',
    32| 				'domain.status' => 'Domain Status:',
    33| 				'domain.created' => 'Created:',
    34| 				'domain.changed' => 'Updated:',
    35| 				'domain.expires' => 'Expired:',
    36| 				'domain.nserver' => 'Domain servers in listed order:'
    37| 		            );
    38| 		$extra = array( 'zip/postal code:' => 'address.pcode' );
    39| 		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    40| 		if (!empty($r['regrinfo']['domain']['name']))
    41| 			{
    42| 			$r['regrinfo'] = get_contacts($r['regrinfo'],$extra);
    43| 			$r['regrinfo']['domain']['name'] = $r['regrinfo']['domain']['name'][0];
    44| 			$r['regrinfo']['registered'] = 'yes';
    45| 			}
    46| 		else
    47| 			{
    48| 			$r = '';
    49| 			$r['regrinfo']['registered'] = 'no';
    50| 			}
    51| 		$r['regyinfo'] = array(
    52|                           'referrer' => 'http://www.nic.ly',
    53|                           'registrar' => 'Libya ccTLD'
    54|                           );
    55| 		return $r;
    56| 		}
    57| 	}
    58| ?>


# ====================================================================
# FILE: src/whois.main.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-231 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.client.php');
    21| require_once('whois.idna.php');
    22| class Whois extends WhoisClient
    23| 	{
    24| 	var $deep_whois = true;
    25| 	var $windows = false;
    26| 	var $gtld_recurse = true;
    27| 	var $non_icann = false;
    28| 	var $NSI_REGISTRY = 'whois.nsiregistry.net';
    29| 	/*
    30| 	 * Constructor function
    31| 	 */
    32| 	function Whois()
    33| 		{
    34| 		@require('whois.servers.php');
    35| 		if ( ( substr( php_uname(), 0, 7 ) == 'Windows' ) )
    36| 			$this->windows = true;
    37| 		else
    38| 			$this->windows = false;
    39| 		$this->VERSION = sprintf("phpWhois v%s-%s", $this->CODE_VERSION, $this->DATA_VERSION);
    40| 		}
    41| 	/*
    42| 	 *  Use special whois server
    43| 	 */
    44| 	function UseServer ($tld, $server)
    45| 		{
    46| 		$this->WHOIS_SPECIAL[$tld] = $server;
    47| 		}
    48| 	/*
    49| 	 *  Lookup query
    50| 	 */
    51| 	function Lookup($query = '', $is_utf = true)
    52| 		{
    53| 		$this->Query = array( 'status' => '' );
    54| 		$query = trim($query);
    55| 		$IDN = new idna_convert();
    56| 		if ($is_utf)
    57| 			$query = $IDN->encode($query);
    58| 		else
    59| 			$query = $IDN->encode(utf8_encode($query));
    60| 		if (!isSet($query) || $query == '')
    61| 			{
    62| 			$this->Query['server'] = $this->NSI_REGISTRY;
    63| 			return ;
    64| 			}
    65| 		$this->Query['query'] = $domain = strtolower($query);
    66| 		if ($query == long2ip(ip2long($query)))
    67| 			{
    68| 			$ip = @gethostbyname($query);
    69| 			if (isset($this->WHOIS_SPECIAL['ip']))
    70| 				{
    71| 				$this->Query['server'] = $this->WHOIS_SPECIAL['ip'];
    72| 				$this->Query['args'] = $ip;
    73| 				}
    74| 			else
    75| 				{
    76| 				$this->Query['server'] = 'whois.arin.net';
    77| 				$this->Query['args'] = "n $ip";
    78| 				$this->Query['file'] = 'whois.ip.php';
    79| 				$this->Query['handler'] = 'ip';
    80| 				}
    81| 			$this->Query['host_ip'] = $ip;
    82| 			$this->Query['query'] = $ip;
    83| 			$this->Query['tld'] = 'ip';
    84| 			$this->Query['host_name'] = @gethostbyaddr($ip);
    85| 			return $this->GetData('',$this->deep_whois);
    86| 			}
    87| 		if (strpos($query, ':'))
    88| 			{
    89| 			$ip = @gethostbyname($query);
    90| 			if (isset($this->WHOIS_SPECIAL['ip']))
    91| 				{
    92| 				$this->Query['server'] = $this->WHOIS_SPECIAL['ip'];
    93| 				}
    94| 			else
    95| 				{
    96| 				$this->Query['server'] = 'whois.ripe.net';
    97| 				$this->Query['file'] = 'whois.ip.ripe.php';
    98| 				$this->Query['handler'] = 'ripe';
    99| 				}
   100| 			$this->Query['query'] = $ip;
   101| 			$this->Query['tld'] = 'ip';
   102| 			return $this->GetData('',$this->deep_whois);
   103| 			}
   104| 		if (!strpos($query, '.'))
   105| 			{
   106| 			$ip = @gethostbyname($query);
   107| 			$this->Query['server'] = 'whois.arin.net';
   108| 			if (strtolower(substr($ip,0,2)) == 'as')
   109| 				$as = substr($ip,2);
   110| 			else
   111| 				$as = $ip;
   112| 			$this->Query['args'] = "a $as";
   113| 			$this->Query['file'] = 'whois.ip.php';
   114| 			$this->Query['handler'] = 'ip';
   115| 			$this->Query['query'] = $ip;
   116| 			$this->Query['tld'] = 'as';
   117| 			return $this->GetData('',$this->deep_whois);
   118| 			}
   119| 		$tld = '';
   120| 		$server = '';
   121| 		$dp = explode('.', $domain);
   122| 		$np = count($dp)-1;
   123| 		$tldtests = array();
   124| 		for ($i = 0; $i < $np; $i++)
   125| 			{
   126| 			array_shift($dp);
   127| 			$tldtests[] = implode('.', $dp);
   128| 			}
   129| 		if ($this->non_icann)
   130| 			$special_tlds = array_merge($this->WHOIS_SPECIAL,$this->WHOIS_NON_ICANN);
   131| 		else
   132| 			$special_tlds = $this->WHOIS_SPECIAL;
   133| 		foreach($tldtests as $tld)
   134| 			{
   135| 			if (isset($special_tlds[$tld]))
   136| 				{
   137| 				$val = $special_tlds[$tld];
   138| 				if ($val == '') return $this->Unknown();
   139| 				$domain = substr($query, 0,  - strlen($tld) - 1);
   140| 				$val = str_replace('{domain}', $domain, $val);
   141| 				$server = str_replace('{tld}', $tld, $val);
   142| 				break;
   143| 				}
   144| 			}
   145| 		if ($server == '')
   146| 			foreach($tldtests as $tld)
   147| 				{
   148| 				$cname = $tld.'.whois-servers.net';
   149| 				if (gethostbyname($cname) == $cname) continue;
   150| 				$server = $tld.'.whois-servers.net';
   151| 				break;
   152| 				}
   153| 		if ($tld && $server)
   154| 			{
   155| 			$this->Query['server'] = $server;
   156| 			$this->Query['tld'] = $tld;
   157| 			$handler = '';
   158| 			foreach($tldtests as $htld)
   159| 				{
   160| 				if (isSet($this->DATA[$htld]))
   161| 				    {
   162| 					$handler = $this->DATA[$htld];
   163| 					break;
   164| 					}
   165| 				if (($fp = @fopen('whois.'.$htld.'.php', 'r', 1)) and fclose($fp))
   166| 				    {
   167| 					$handler = $htld;
   168| 					break;
   169| 					}
   170| 				}
   171| 			if ($handler != '')
   172| 				{
   173| 				$this->Query['file'] = "whois.$handler.php";
   174| 				$this->Query['handler'] = $handler;
   175| 				}
   176| 			if (isset($this->WHOIS_PARAM[$server]))
   177| 				$this->Query['server'] = $this->Query['server'].'?'.str_replace('$',$domain,$this->WHOIS_PARAM[$server]);
   178| 			$result = $this->GetData('',$this->deep_whois);
   179| 			$this->Checkdns($result);
   180| 			return $result;
   181| 			}
   182| 		return $this->Unknown();
   183| 		}
   184| 	/* Unsupported domains */
   185| 	function Unknown()
   186| 		{
   187| 		unset($this->Query['server']);
   188| 		$this->Query['status'] = 'error';
   189| 		$result['rawdata'][] = $this->Query['errstr'][] = $this->Query['query'].' domain is not supported';
   190| 		$this->Checkdns($result);
   191| 		$this->FixResult($result, $this->Query['query']);
   192| 		return $result;
   193| 		}
   194| 	/* Get nameservers if missing */
   195| 	function Checkdns(&$result)
   196| 		{
   197| 		if ($this->deep_whois && empty($result['regrinfo']['domain']['nserver']) && function_exists('dns_get_record'))
   198| 			{
   199| 			$ns = @dns_get_record($this->Query['query'],DNS_NS);
   200| 			if (!is_array($ns)) return;
   201| 			$nserver = array();
   202| 			foreach($ns as $row) $nserver[] = $row['target'];
   203| 			if (count($nserver) > 0)
   204| 				$result['regrinfo']['domain']['nserver'] = $this->FixNameServer($nserver);
   205| 			}
   206| 		}
   207| 	/*
   208| 	 *  Fix and/or add name server information
   209| 	 */
   210| 	function FixResult(&$result, $domain)
   211| 		{
   212| 		$result['regrinfo']['domain']['name'] = $domain;
   213| 		if (!isset($result['regrinfo']['registered']))
   214| 			{
   215| 			if (function_exists('checkdnsrr') && checkdnsrr($domain, 'NS'))
   216| 				$result['regrinfo']['registered'] = 'yes';
   217| 			else
   218| 				$result['regrinfo']['registered'] = 'unknown';
   219| 			}
   220| 		if (isset($result['regrinfo']['domain']['nserver']))
   221| 			{
   222| 			if (!is_array($result['regrinfo']['domain']['nserver']))
   223| 				{
   224| 				unset($result['regrinfo']['domain']['nserver']);
   225| 				}
   226| 			else
   227| 				$result['regrinfo']['domain']['nserver'] = $this->FixNameServer($result['regrinfo']['domain']['nserver']);
   228| 			}
   229| 		}
   230| 	}
   231| ?>


# ====================================================================
# FILE: src/whois.me.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ME_HANDLER__'))
    21| 	define('__ME_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class me_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		$r['regyinfo'] = array(
    29|                           'referrer' => 'http://domain.me',
    30|                           'registrar' => 'doMEn'
    31|                           );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.mobi.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__MOBI_HANDLER__'))
    21| 	define('__MOBI_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class mobi_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
    29| 			$r['regrinfo']['registered'] = 'unknown';
    30| 		$r['regyinfo']['referrer'] = 'http://www.mtld.mobi/';
    31| 		$r['regyinfo']['registrar'] = 'Dot Mobi Registry';
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.museum.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| if (!defined('__MUSEUM_HANDLER__'))
    21| 	define('__MUSEUM_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class museum_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		$r['regyinfo'] = array(
    29|                           'referrer' => 'http://musedoma.museum',
    30|                           'registrar' => 'Museum Domain Management Association'
    31|                           );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.mx.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-55 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__MX_HANDLER__'))
    21| 	define('__MX_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class mx_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 						'owner'	=> 'Registrant:',
    29| 						'admin'	=> 'Administrative Contact:',
    30| 						'tech'	=> 'Technical Contact:',
    31| 						'billing' => 'Billing Contact:',
    32| 						'domain.nserver' => 'Name Servers:',
    33| 						'domain.created' => 'Created On:',
    34| 						'domain.expires' => 'Expiration Date:',
    35| 						'domain.changed' => 'Last Updated On:',
    36| 						'domain.sponsor' => 'Registrar:'
    37| 						);
    38| 		$extra = array(
    39| 						'city:' => 'address.city',
    40| 						'state:'	=> 'address.state',
    41| 						'dns:'	=> '0'
    42| 						);
    43| 		$r['regrinfo'] = easy_parser($data_str['rawdata'],$items,'dmy',$extra);
    44| 		$r['regyinfo'] = array(
    45|                   'registrar' => 'NIC Mexico',
    46|                   'referrer' => 'http://www.nic.mx/'
    47|                   );
    48| 		if (empty($r['regrinfo']['domain']['created']))
    49| 			$r['regrinfo']['registered'] = 'no';
    50| 		else
    51| 			$r['regrinfo']['registered'] = 'yes';
    52| 		return $r;
    53| 		}
    54| 	}
    55| ?>


# ====================================================================
# FILE: src/whois.name.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| if (!defined('__NAME_HANDLER__'))
    21| 	define('__NAME_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class name_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		$r['regyinfo'] = array(
    29|                           'referrer' => 'http://www.nic.name/',
    30|                           'registrar' => 'Global Name Registry'
    31|                           );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.nl.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-68 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NL_HANDLER__'))
    21| 	define('__NL_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class nl_handler
    24| 	{
    25| 	function parse($data, $query)
    26| 		{
    27| 		$items = array(
    28|                   'domain.name' => 'Domain name:',
    29|                   'domain.status' => 'Status:',
    30|                   'domain.nserver' => 'Domain nameservers:',
    31|                   'domain.created' => 'Date registered:',
    32|                   'domain.changed' => 'Record last updated:',
    33|                   'domain.sponsor' => 'Registrar:',
    34|                   'admin' => 'Administrative contact:',
    35|                   'tech' => 'Technical contact(s):'
    36| 		            );
    37| 		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
    38| 		$r['regyinfo']['referrer'] = 'http://www.domain-registry.nl';
    39| 		$r['regyinfo']['registrar'] = 'Stichting Internet Domeinregistratie NL';
    40| 		if (!isset($r['regrinfo']['domain']['status']))
    41| 			{
    42| 			$r['regrinfo']['registered'] = 'no';
    43| 			return $r;
    44| 			}
    45| 		if (isset($r['regrinfo']['tech']))
    46| 			$r['regrinfo']['tech'] = $this->get_contact($r['regrinfo']['tech']);
    47| 		if (isset($r['regrinfo']['zone']))
    48| 			$r['regrinfo']['zone'] = $this->get_contact($r['regrinfo']['zone']);
    49| 		if (isset($r['regrinfo']['admin']))
    50| 			$r['regrinfo']['admin'] = $this->get_contact($r['regrinfo']['admin']);
    51| 		if (isset($r['regrinfo']['owner']))
    52| 			$r['regrinfo']['owner'] = $this->get_contact($r['regrinfo']['owner']);
    53| 		$r['regrinfo']['registered'] = 'yes';
    54| 		format_dates($r,'dmy');
    55| 		return $r;
    56| 		}
    57| 	function get_contact($data)
    58| 		{
    59| 		$r = get_contact($data);
    60| 		if (isset($r['name']) && preg_match('/^[A-Z0-9]+-[A-Z0-9]+$/',$r['name']))
    61| 			{
    62| 			$r['handle'] = $r['name'];
    63| 			$r['name'] = array_shift ($r['address']);
    64| 			}
    65| 		return $r;
    66| 		}
    67| 	}
    68| ?>


# ====================================================================
# FILE: src/whois.nu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-73 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NU_HANDLER__'))
    21| 	define('__NU_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class nu_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'name' => 'Domain Name (UTF-8):',
    29|                   'created' => 'Record created on',
    30|                   'expires' => 'Record expires on',
    31|                   'changed' => 'Record last updated on',
    32|                   'status' => 'Record status:',
    33|                   'handle' => 'Record ID:'
    34| 		              );
    35| 		while (list($key, $val) = each($data_str['rawdata']))
    36| 			{
    37| 			$val = trim($val);
    38| 			if ($val != '')
    39| 				{
    40| 				if ($val == 'Domain servers in listed order:')
    41| 					{
    42| 					while (list($key, $val) = each($data_str['rawdata']))
    43| 						{
    44| 						$val = trim($val);
    45| 						if ($val == '')
    46| 							break;
    47| 						$r['regrinfo']['domain']['nserver'][] = $val;
    48| 						}
    49| 					break;
    50| 					}
    51| 				reset($items);
    52| 				while (list($field, $match) = each($items))
    53| 				if (strstr($val, $match))
    54| 					{
    55| 					$r['regrinfo']['domain'][$field] = trim(substr($val, strlen($match)));
    56| 					break;
    57| 					}
    58| 				}
    59| 			}
    60| 		if (isset($r['regrinfo']['domain']))
    61| 			$r['regrinfo']['registered'] = 'yes';
    62| 		else
    63| 			$r['regrinfo']['registered'] = 'no';
    64| 		$r['regyinfo'] = array(
    65|                           'whois' => 'whois.nic.nu',
    66|                           'referrer' => 'http://www.nunames.nu',
    67|                           'registrar' => '.NU Domain, Ltd'
    68| 		                      );
    69| 		format_dates($r, 'dmy');
    70| 		return $r;
    71| 		}
    72| 	}
    73| ?>


# ====================================================================
# FILE: src/whois.nz.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-87 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__NZ_HANDLER__'))
    21| 	define('__NZ_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class nz_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                     'domain_name:' 					=> 'domain.name',
    29|                     'query_status:'					=> 'domain.status',
    30| 					'ns_name_01:' 					=> 'domain.nserver.0',
    31| 					'ns_name_02:' 					=> 'domain.nserver.1',
    32| 					'ns_name_03:' 					=> 'domain.nserver.2',
    33|                     'domain_dateregistered:'		=> 'domain.created',
    34|                     'domain_datelastmodified:'		=> 'domain.changed',
    35|                     'domain_datebilleduntil:'		=> 'domain.expires',
    36|                     'registrar_name:'		 		=> 'domain.sponsor',
    37|                     'registrant_contact_name:'		=> 'owner.name',
    38|                     'registrant_contact_address1:'	=> 'owner.address.address.0',
    39|                     'registrant_contact_address2:'	=> 'owner.address.address.1',
    40|                     'registrant_contact_address3:'	=> 'owner.address.address.2',
    41|                     'registrant_contact_postalcode:'=> 'owner.address.pcode',
    42|                     'registrant_contact_city:'		=> 'owner.address.city',
    43|                     'Registrant State/Province:' 	=> 'owner.address.state',
    44|                     'registrant_contact_country:'	=> 'owner.address.country',
    45|                     'registrant_contact_phone:'		=> 'owner.phone',
    46|                     'registrant_contact_fax:'		=> 'owner.fax',
    47|                     'registrant_contact_email:'		=> 'owner.email',
    48|                     'admin_contact_name:' 			=> 'admin.name',
    49|                     'admin_contact_address1:'		=> 'admin.address.address.0',
    50|                     'admin_contact_address2:'		=> 'admin.address.address.1',
    51|                     'admin_contact_address3:'		=> 'admin.address.address.2',
    52|                     'admin_contact_postalcode:'		=> 'admin.address.pcode',
    53|                     'admin_contact_city:'			=> 'admin.address.city',
    54|                     'admin_contact_country:'		=> 'admin.address.country',
    55|                     'admin_contact_phone:'			=> 'admin.phone',
    56|                     'admin_contact_fax:'			=> 'admin.fax',
    57|                     'admin_contact_email:'			=> 'admin.email',
    58|                     'technical_contact_name:'		=> 'tech.name',
    59|                     'technical_contact_address1:'	=> 'tech.address.address.0',
    60|                     'technical_contact_address1:'	=> 'tech.address.address.1',
    61|                     'technical_contact_address1:'	=> 'tech.address.address.2',
    62|                     'technical_contact_postalcode:'	=> 'tech.address.pcode',
    63|                     'technical_contact_city:'		=> 'tech.address.city',
    64|                     'technical_contact_country:'	=> 'tech.address.country',
    65|                     'technical_contact_phone:'		=> 'tech.phone',
    66|                     'technical_contact_fax:'		=> 'tech.fax',
    67|                     'technical_contact_email:'		=> 'tech.email'
    68| 		              );
    69| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
    70| 		if (!empty($r['regrinfo']['domain']['status']))
    71| 			$domain_status = substr($r['regrinfo']['domain']['status'],0,3);
    72| 		else
    73| 			$domain_status = '';
    74| 		if ($domain_status=='200')
    75| 			$r['regrinfo']['registered']='yes';
    76| 		elseif ($domain_status=='220')
    77| 			$r['regrinfo']['registered']='no';
    78| 		else
    79| 			$r['regrinfo']['registered']='unknown';
    80| 		if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
    81| 			$r['regrinfo']['registered'] = 'unknown';
    82| 		$r['regyinfo']['referrer'] = 'http://www.dnc.org.nz';
    83| 		$r['regyinfo']['registrar'] = 'New Zealand Domain Name Registry Limited';
    84| 		return $r;
    85| 		}
    86| 	}
    87| ?>


# ====================================================================
# FILE: src/whois.org.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ORG_HANDLER__'))
    21| 	define('__ORG_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class org_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
    29| 			$r['regrinfo']['registered'] = 'unknown';
    30| 		$r['regyinfo']['referrer'] = 'http://www.pir.org/';
    31| 		$r['regyinfo']['registrar'] = 'Public Interest Registry';
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.org.za.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__ORG_ZA_HANDLER__'))
    22| 	define('__ORG_ZA_HANDLER__', 1);
    23| class org_za_handler
    24| 	{
    25| 	function parse($data, $query)
    26| 		{
    27| 		$items = array(
    28|                 'domain.status'		=> 'Status:',
    29| 				'domain.nserver'	=> 'Domain name servers in listed order:',
    30|                 'domain.changed'	=> 'Record last updated on',
    31|                 'owner'				=> 'rwhois search on',
    32|                 'admin'				=> 'Administrative Contact:',
    33|                 'tech'				=> 'Technical Contact:',
    34| 				'billing'			=> 'Billing Contact:',
    35| 				'#'					=> 'Search Again'
    36| 				);
    37| 		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
    38| 		if (isset($r['regrinfo']['domain']['status']))
    39| 			{
    40| 			$r['regrinfo']['registered'] = 'yes';
    41| 			$r['regrinfo']['domain']['handler'] = strtok(array_shift($r['regrinfo']['owner']),' ');
    42| 			$r['regrinfo'] = get_contacts($r['regrinfo']);
    43| 			}
    44| 		else
    45| 			$r['regrinfo']['registered'] = 'no';
    46| 		$r['regyinfo']['referrer'] = 'http://www.org.za';
    47| 		$r['regyinfo']['registrar'] = 'The ORG.ZA Domain';
    48| 		return $r;
    49| 		}
    50| 	}
    51| ?>


# ====================================================================
# FILE: src/whois.parser.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-725 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| function generic_parser_a ($rawdata, $translate, $contacts, $main='domain', $dateformat='dmy')
    21| {
    22| $blocks = generic_parser_a_blocks($rawdata,$translate,$disclaimer);
    23| if (isset($disclaimer) && is_array($disclaimer))
    24|     $ret['disclaimer']=$disclaimer;
    25| if (empty($blocks) || !is_array($blocks['main']))
    26|    {
    27|    $ret['registered']='no';
    28|    return $ret;
    29|    }
    30| $r = $blocks['main'];
    31| $ret['registered'] = 'yes';
    32| while (list($key,$val) = each($contacts))
    33| 	if (isset($r[$key]))
    34| 		{
    35| 		if (is_array($r[$key]))
    36| 	        $blk = $r[$key][count($r[$key])-1];
    37| 		else
    38| 			$blk = $r[$key];
    39| 		$blk = strtoupper(strtok($blk,' '));
    40| 		if (isset($blocks[$blk])) $ret[$val] = $blocks[$blk];
    41| 		unset($r[$key]);
    42| 		}
    43| if ($main) $ret[$main] = $r;
    44| format_dates($ret,$dateformat);
    45| return $ret;
    46| }
    47| function generic_parser_a_blocks ($rawdata, $translate, &$disclaimer)
    48| {
    49| $r = array();
    50| $newblock = false;
    51| $hasdata = false;
    52| $block = array();
    53| $blocks = false;
    54| $gkey = 'main';
    55| $dend = false;
    56| while (list($key,$val)=each($rawdata))
    57| 	{
    58| 	$val=trim($val);
    59| 	if ($val != '' && ($val[0] == '%' || $val[0] == '#'))
    60| 		{
    61| 		if (!$dend) $disclaimer[]=trim(substr($val,1));
    62| 		continue;
    63| 		}
    64| 	if ($val=='')
    65| 		{
    66| 		$newblock = true;
    67| 		continue;
    68| 		}
    69| 	if ($newblock && $hasdata)
    70| 		{
    71| 		$blocks[$gkey] = $block;
    72| 		$block = array();
    73| 		$gkey = '';
    74| 		}
    75| 	$dend = true;
    76| 	$newblock = false;
    77| 	$k = trim(strtok($val,':'));
    78| 	$v = trim(substr(strstr($val,':'),1));
    79| 	if ($v == '') continue;
    80| 	$hasdata = true;
    81| 	if (isset($translate[$k]))
    82| 		{
    83| 		$k=$translate[$k];
    84| 		if ($k=='') continue;
    85| 		if (strstr($k,'.'))
    86| 			{
    87| 			eval("\$block".getvarname($k)."=\$v;");
    88| 			continue;
    89| 			}
    90|            }
    91| 	else $k=strtolower($k);
    92| 	if ($k=='handle')
    93| 		{
    94| 		$v = strtok($v,' ');
    95| 		$gkey = strtoupper($v);
    96| 		}
    97| 	if (isset($block[$k]) && is_array($block[$k]))
    98| 		$block[$k][]=$v;
    99| 	else
   100| 		if (!isset($block[$k]) || $block[$k]=='')
   101| 			$block[$k]=$v;
   102| 		else
   103| 			{
   104| 			$x=$block[$k];
   105| 		    unset($block[$k]);
   106| 		    $block[$k][]=$x;
   107|             $block[$k][]=$v;
   108|             }
   109| 	}
   110| if ($hasdata) $blocks[$gkey]=$block;
   111| return $blocks;
   112| }
   113| function generic_parser_b ( $rawdata, $items = false, $dateformat='mdy', $hasreg=true, $scanall=false )
   114| {
   115| if (!$items)
   116| 	$items = array(
   117| 				'Domain Name:' => 'domain.name',
   118| 				'Domain ID:' => 'domain.handle',
   119| 				'Sponsoring Registrar:' => 'domain.sponsor',
   120| 				'Registrar ID:' => 'domain.sponsor',
   121| 				'Domain Status:' => 'domain.status.',
   122| 				'Status:' => 'domain.status.',
   123| 				'Name Server:' => 'domain.nserver.',
   124| 				'Nameservers:' => 'domain.nserver.',
   125| 				'Maintainer:' => 'domain.referer',
   126| 				'Domain Registration Date:' => 'domain.created',
   127| 				'Domain Create Date:' => 'domain.created',
   128| 				'Domain Expiration Date:' => 'domain.expires',
   129| 				'Domain Last Updated Date:' => 'domain.changed',
   130| 				'Creation Date:' => 'domain.created',
   131| 				'Last Modification Date:' => 'domain.changed',
   132| 				'Expiration Date:' => 'domain.expires',
   133| 				'Created On:' => 'domain.created',
   134|                 'Last Updated On:' => 'domain.changed',
   135|                 'Expiration Date:' => 'domain.expires',
   136| 				'Registrant ID:' => 'owner.handle',
   137| 				'Registrant Name:' => 'owner.name',
   138| 				'Registrant Organization:' => 'owner.organization',
   139| 				'Registrant Address:' => 'owner.address.street.',
   140| 				'Registrant Address1:' => 'owner.address.street.',
   141| 				'Registrant Address2:' => 'owner.address.street.',
   142| 				'Registrant Street:' => 'owner.address.street.',
   143| 				'Registrant Street1:' => 'owner.address.street.',
   144| 				'Registrant Street2:' => 'owner.address.street.',
   145| 				'Registrant Street3:' => 'owner.address.street.',
   146| 				'Registrant Postal Code:' => 'owner.address.pcode',
   147| 				'Registrant City:' => 'owner.address.city',
   148| 				'Registrant State/Province:' => 'owner.address.state',
   149| 				'Registrant Country:' => 'owner.address.country',
   150| 				'Registrant Country/Economy:' => 'owner.address.country',
   151| 				'Registrant Phone Number:' => 'owner.phone',
   152| 				'Registrant Phone:' => 'owner.phone',
   153| 				'Registrant Facsimile Number:' => 'owner.fax',
   154| 				'Registrant FAX:' => 'owner.fax',
   155| 				'Registrant Email:' => 'owner.email',
   156| 				'Registrant E-mail:' => 'owner.email',
   157| 				'Administrative Contact ID:' => 'admin.handle',
   158| 				'Administrative Contact Name:' => 'admin.name',
   159| 				'Administrative Contact Organization:' => 'admin.organization',
   160| 				'Administrative Contact Address:' => 'admin.address.street.',
   161| 				'Administrative Contact Address1:' => 'admin.address.street.',
   162| 				'Administrative Contact Address2:' => 'admin.address.street.',
   163| 				'Administrative Contact Postal Code:' => 'admin.address.pcode',
   164| 				'Administrative Contact City:' => 'admin.address.city',
   165| 				'Administrative Contact State/Province:' => 'admin.address.state',
   166| 				'Administrative Contact Country:' => 'admin.address.country',
   167| 				'Administrative Contact Phone Number:' => 'admin.phone',
   168| 				'Administrative Contact Email:' => 'admin.email',
   169| 				'Administrative Contact Facsimile Number:' => 'admin.fax',
   170| 				'Administrative Contact Tel:' => 'admin.phone',
   171| 				'Administrative Contact Fax:' => 'admin.fax',
   172| 				'Administrative ID:' => 'admin.handle',
   173| 				'Administrative Name:' => 'admin.name',
   174| 				'Administrative Organization:' => 'admin.organization',
   175| 				'Administrative Address:' => 'admin.address.street.',
   176| 				'Administrative Address1:' => 'admin.address.street.',
   177| 				'Administrative Address2:' => 'admin.address.street.',
   178| 				'Administrative Postal Code:' => 'admin.address.pcode',
   179| 				'Administrative City:' => 'admin.address.city',
   180| 				'Administrative State/Province:' => 'admin.address.state',
   181| 				'Administrative Country/Economy:' => 'admin.address.country',
   182| 				'Administrative Phone:' => 'admin.phone',
   183| 				'Administrative E-mail:' => 'admin.email',
   184| 				'Administrative Facsimile Number:' => 'admin.fax',
   185| 				'Administrative Tel:' => 'admin.phone',
   186| 				'Administrative FAX:' => 'admin.fax',
   187| 				'Admin ID:' => 'admin.handle',
   188| 				'Admin Name:' => 'admin.name',
   189| 				'Admin Organization:' => 'admin.organization',
   190| 				'Admin Street:' => 'admin.address.street.',
   191| 				'Admin Street1:' => 'admin.address.street.',
   192| 				'Admin Street2:' => 'admin.address.street.',
   193| 				'Admin Street3:' => 'admin.address.street.',
   194| 				'Admin Address:' => 'admin.address.street.',
   195| 				'Admin Address2:' => 'admin.address.street.',
   196| 				'Admin Address3:' => 'admin.address.street.',
   197| 				'Admin City:' => 'admin.address.city',
   198| 				'Admin State/Province:' => 'admin.address.state',
   199| 				'Admin Postal Code:' => 'admin.address.pcode',
   200| 				'Admin Country:' => 'admin.address.country',
   201| 				'Admin Country/Economy:' => 'admin.address.country',
   202| 				'Admin Phone:' => 'admin.phone',
   203| 				'Admin FAX:' => 'admin.fax',
   204| 				'Admin Email:' => 'admin.email',
   205| 				'Admin E-mail:' => 'admin.email',
   206| 				'Technical Contact ID:' => 'tech.handle',
   207| 				'Technical Contact Name:' => 'tech.name',
   208| 				'Technical Contact Organization:' => 'tech.organization',
   209| 				'Technical Contact Address:' => 'tech.address.street.',
   210| 				'Technical Contact Address1:' => 'tech.address.street.',
   211| 				'Technical Contact Address2:' => 'tech.address.street.',
   212| 				'Technical Contact Postal Code:' => 'tech.address.pcode',
   213| 				'Technical Contact City:' => 'tech.address.city',
   214| 				'Technical Contact State/Province:' => 'tech.address.state',
   215| 				'Technical Contact Country:' => 'tech.address.country',
   216| 				'Technical Contact Phone Number:' => 'tech.phone',
   217| 				'Technical Contact Facsimile Number:' => 'tech.fax',
   218| 				'Technical Contact Phone:' => 'tech.phone',
   219| 				'Technical Contact Fax:' => 'tech.fax',
   220| 				'Technical Contact Email:' => 'tech.email',
   221| 				'Technical ID:' => 'tech.handle',
   222| 				'Technical Name:' => 'tech.name',
   223| 				'Technical Organization:' => 'tech.organization',
   224| 				'Technical Address:' => 'tech.address.street.',
   225| 				'Technical Address1:' => 'tech.address.street.',
   226| 				'Technical Address2:' => 'tech.address.street.',
   227| 				'Technical Postal Code:' => 'tech.address.pcode',
   228| 				'Technical City:' => 'tech.address.city',
   229| 				'Technical State/Province:' => 'tech.address.state',
   230| 				'Technical Country/Economy:' => 'tech.address.country',
   231| 				'Technical Phone Number:' => 'tech.phone',
   232| 				'Technical Facsimile Number:' => 'tech.fax',
   233| 				'Technical Phone:' => 'tech.phone',
   234| 				'Technical Fax:' => 'tech.fax',
   235| 				'Technical FAX:' => 'tech.fax',
   236| 				'Technical E-mail:' => 'tech.email',
   237| 				'Tech ID:' => 'tech.handle',
   238| 				'Tech Name:' => 'tech.name',
   239| 				'Tech Organization:' => 'tech.organization',
   240| 				'Tech Address:' => 'tech.address.street.',
   241| 				'Tech Address2:' => 'tech.address.street.',
   242| 				'Tech Address3:' => 'tech.address.street.',
   243| 				'Tech Street:' => 'tech.address.street.',
   244| 				'Tech Street1:' => 'tech.address.street.',
   245| 				'Tech Street2:' => 'tech.address.street.',
   246| 				'Tech Street3:' => 'tech.address.street.',
   247| 				'Tech City:' => 'tech.address.city',
   248| 				'Tech Postal Code:' => 'tech.address.pcode',
   249| 				'Tech State/Province:' => 'tech.address.state',
   250| 				'Tech Country:' => 'tech.address.country',
   251| 				'Tech Country/Economy:' => 'tech.address.country',
   252| 				'Tech Phone:' => 'tech.phone',
   253| 				'Tech FAX:' => 'tech.fax',
   254| 				'Tech Email:' => 'tech.email',
   255| 				'Tech E-mail:' => 'tech.email',
   256| 				'Billing Contact ID:' => 'billing.handle',
   257| 				'Billing Contact Name:' => 'billing.name',
   258| 				'Billing Contact Organization:' => 'billing.organization',
   259| 				'Billing Contact Address1:' => 'billing.address.street.',
   260| 				'Billing Contact Address2:' => 'billing.address.street.',
   261| 				'Billing Contact Postal Code:' => 'billing.address.pcode',
   262| 				'Billing Contact City:' => 'billing.address.city',
   263| 				'Billing Contact State/Province:' => 'billing.address.state',
   264| 				'Billing Contact Country:' => 'billing.address.country',
   265| 				'Billing Contact Phone Number:' => 'billing.phone',
   266| 				'Billing Contact Facsimile Number:' => 'billing.fax',
   267| 				'Billing Contact Email:' => 'billing.email',
   268| 				'Billing ID:' => 'billing.handle',
   269| 				'Billing Name:' => 'billing.name',
   270| 				'Billing Organization:' => 'billing.organization',
   271| 				'Billing Address:' => 'billing.address.street.',
   272| 				'Billing Address1:' => 'billing.address.street.',
   273| 				'Billing Address2:' => 'billing.address.street.',
   274| 				'Billing Address3:' => 'billing.address.street.',
   275| 				'Billing Street:' => 'billing.address.street.',
   276| 				'Billing Street1:' => 'billing.address.street.',
   277| 				'Billing Street2:' => 'billing.address.street.',
   278| 				'Billing Street3:' => 'billing.address.street.',
   279| 				'Billing City:' => 'billing.address.city',
   280| 				'Billing Postal Code:' => 'billing.address.pcode',
   281| 				'Billing State/Province:' => 'billing.address.state',
   282| 				'Billing Country:' => 'billing.address.country',
   283| 				'Billing Country/Economy:' => 'billing.address.country',
   284| 				'Billing Phone:' => 'billing.phone',
   285| 				'Billing Fax:' => 'billing.fax',
   286| 				'Billing FAX:' => 'billing.fax',
   287| 				'Billing Email:' => 'billing.email',
   288| 				'Billing E-mail:' => 'billing.email',
   289| 				'Zone ID:' => 'zone.handle',
   290|                 'Zone Organization:' => 'zone.organization',
   291|                 'Zone Name:' => 'zone.name',
   292|                 'Zone Address:' => 'zone.address.street.',
   293|                 'Zone Address 2:' => 'zone.address.street.',
   294|                 'Zone City:' => 'zone.address.city',
   295|                 'Zone State/Province:' => 'zone.address.state',
   296|                 'Zone Postal Code:' => 'zone.address.pcode',
   297|                 'Zone Country:' => 'zone.address.country',
   298|                 'Zone Phone Number:' => 'zone.phone',
   299|                 'Zone Fax Number:' => 'zone.fax',
   300|                 'Zone Email:' => 'zone.email'
   301| 		            );
   302| $r = '';
   303| $disok = true;
   304| while (list($key,$val) = each($rawdata))
   305| 	{
   306| 	if (trim($val) != '')
   307| 		{
   308| 	     if (($val[0]=='%' || $val[0]=='#') && $disok)
   309| 			{
   310| 			$r['disclaimer'][] = trim(substr($val,1));
   311| 			$disok = true;
   312| 			continue;
   313| 			}
   314| 		$disok = false;
   315| 		reset($items);
   316| 		while (list($match, $field)=each($items))
   317| 			{
   318| 			$pos = strpos($val,$match);
   319| 			if ($pos !== false)
   320| 				{
   321| 				if ($field != '')
   322| 					{
   323| 					$var = '$r'.getvarname($field);
   324| 					$itm = trim(substr($val,$pos+strlen($match)));
   325| 					if ($itm!='')
   326| 						eval($var.'="'.str_replace('"','\"',$itm).'";');
   327| 					}
   328| 				if (!$scanall)
   329| 					break;
   330| 				}
   331| 			}
   332| 		}
   333| 	}
   334| if (empty($r))
   335| 	{
   336| 	if ($hasreg) $r['registered'] = 'no';
   337| 	}
   338| else
   339| 	{
   340| 	if ($hasreg) $r['registered'] = 'yes';
   341| 	$r = format_dates($r, $dateformat);
   342| 	}
   343| return $r;
   344| }
   345| function getvarname ( $vdef )
   346| {
   347| $parts = explode('.',$vdef);
   348| $var = '';
   349| foreach($parts as $mn)
   350| 	if ($mn == '') $var = $var.'[]';
   351| 	else $var = $var.'["'.$mn.'"]';
   352| return $var;
   353| }
   354| function get_blocks ( $rawdata, $items, $partial_match = false, $def_block = false )
   355| {
   356| $r = array();
   357| $endtag = '';
   358| while (list($key,$val) = each($rawdata))
   359| 	{
   360| 	$val = trim($val);
   361| 	if ($val == '') continue;
   362| 	$var = $found = false;
   363| 	foreach ($items as $field => $match)
   364| 		{
   365| 		$pos = strpos($val,$match);
   366| 		if ($field != '' && $pos !== false)
   367| 			{
   368| 			if ($val == $match)
   369| 				{
   370| 				$found = true;
   371| 				$endtag = '';
   372| 				$line = $val;
   373| 				break;
   374| 				}
   375| 			$last = substr($val,-1,1);
   376| 			if ($last == ':' || $last == '-' || $last == ']')
   377| 				{
   378| 				$found = true;
   379| 				$endtag = $last;
   380| 				$line = $val;
   381| 				}
   382| 			else
   383| 				{
   384| 				$var = getvarname(strtok($field,'#'));
   385| 				$itm = trim(substr($val,$pos+strlen($match)));
   386| 				eval('$r'.$var.'=$itm;');
   387| 				}
   388| 			break;
   389| 			}
   390| 		}
   391| 	if (!$found)
   392| 		{
   393| 		if (!$var && $def_block) $r[$def_block][] = $val;
   394| 		continue;
   395| 		}
   396| 	$block = array();
   397| 	while (list($key,$val) = each($rawdata))
   398| 		{
   399| 		$val = trim($val);
   400| 		if ($val == '' || $val == str_repeat($val[0],strlen($val))) continue;
   401| 		$last = substr($val,-1,1);
   402| /*
   403| 		if ($last == $endtag)
   404| 			{
   405| 			prev($rawdata);
   406| 			break;
   407| 			}
   408| 		if ($endtag == '' || $partial_match)
   409| 		*/
   410| 		if ($endtag == '' || $partial_match || $last == $endtag)
   411| 			{
   412| 			$et = false;
   413| 			foreach ($items as $field => $match)
   414| 				{
   415| 				$pos = strpos($val,$match);
   416| 				if ($pos !== false && $pos == 0)
   417| 					{
   418| 					$et = true;
   419| 					break;
   420| 					}
   421| 				}
   422| 			if ($et)
   423| 				{
   424| 				prev($rawdata);
   425| 				break;
   426| 				}
   427| 			}
   428| 		$block[] = $val;
   429| 		}
   430| 	if (empty($block)) continue;
   431| 	foreach ($items as $field => $match)
   432| 		{
   433| 		$pos = strpos($line,$match);
   434| 		if ($pos !== false)
   435| 			{
   436| 			$var = getvarname(strtok($field,'#'));
   437| 			if ($var != '[]') eval('$r'.$var.'=$block;');
   438| 			}
   439| 		}
   440| 	}
   441| return $r;
   442| }
   443| function easy_parser($data_str, $items, $date_format, $translate = false ,
   444| 					 $has_org = false, $partial_match = false,
   445| 					 $def_block = false )
   446| {
   447| $r = get_blocks($data_str, $items, $partial_match, $def_block);
   448| $r = get_contacts($r, $translate, $has_org);
   449| format_dates($r, $date_format);
   450| return $r;
   451| }
   452| function get_contacts ( $array, $extra_items='', $has_org= false )
   453| {
   454| if (isset($array['billing']))
   455| 	$array['billing'] = get_contact($array['billing'], $extra_items, $has_org);
   456| if (isset($array['tech']))
   457| 	$array['tech'] = get_contact($array['tech'], $extra_items, $has_org);
   458| if (isset($array['zone']))
   459| 	$array['zone'] = get_contact($array['zone'], $extra_items, $has_org);
   460| if (isset($array['admin']))
   461| 	$array['admin'] = get_contact($array['admin'], $extra_items, $has_org);
   462| if (isset($array['owner']))
   463| 	$array['owner'] = get_contact($array['owner'], $extra_items, $has_org);
   464| if (isset($array['registrar']))
   465| 	$array['registrar'] = get_contact($array['registrar'], $extra_items, $has_org);
   466| return $array;
   467| }
   468| function get_contact ( $array, $extra_items='', $has_org= false )
   469| {
   470| if (!is_array($array))
   471| 	return array();
   472| $items = array (
   473| 		'fax..:' => 'fax',
   474| 		'fax.' => 'fax',
   475| 		'fax-no:' => 'fax',
   476| 		'fax -' => 'fax',
   477| 		'fax-' => 'fax',
   478| 		'fax::'   => 'fax',
   479| 		'fax:'   => 'fax',
   480| 		'[fax]' => 'fax',
   481| 		'(fax)' => 'fax',
   482| 		'fax' => 'fax',
   483| 		'tel. ' => 'phone',
   484| 		'tel:' => 'phone',
   485| 		'phone::' => 'phone',
   486| 		'phone:' => 'phone',
   487| 		'phone-' => 'phone',
   488| 		'phone -' => 'phone',
   489| 		'email:' => 'email',
   490| 		'e-mail:' => 'email',
   491| 		'company name:' => 'organization',
   492| 		'organisation:' => 'organization',
   493| 		'first name:' => 'name.first',
   494| 		'last name:' => 'name.last',
   495| 		'street:' => 'address.street',
   496| 		'address:' => 'address.street.',
   497| 		'language:' => '',
   498| 		'location:' => 'address.city',
   499| 		'country:' => 'address.country',
   500| 		'name:' => 'name',
   501| 		'last modified:' => 'changed'
   502| 		);
   503| if ($extra_items)
   504| 	{
   505| 	foreach($items as $match => $field)
   506| 		if (!isset($extra_items[$match]))
   507| 		$extra_items[$match] = $field;
   508| 	$items = $extra_items;
   509| 	}
   510| while (list($key,$val)=each($array))
   511| 	{
   512| 	$ok=true;
   513| 	while ($ok)
   514| 		{
   515| 		reset($items);
   516| 		$ok = false;
   517| 		while (list($match,$field) = each($items))
   518| 			{
   519| 			$pos = strpos(strtolower($val),$match);
   520| 			if ($pos === false) continue;
   521| 			$itm = trim(substr($val,$pos+strlen($match)));
   522| 			if ($field != '' && $itm != '')
   523| 				{
   524| 				eval('$r'.getvarname($field).'=$itm;');
   525| 				}
   526| 			$val = trim(substr($val,0,$pos));
   527| 			if ($val == '')
   528| 				{
   529| 				unset($array[$key]);
   530| 				break;
   531| 				}
   532| 			else
   533| 				{
   534| 				$array[$key] = $val;
   535| 				$ok = true;
   536| 				}
   537| 			}
   538| 		if (preg_match("/([+]*[-\(\)\. x0-9]){7,}/", $val, $matches))
   539| 			{
   540| 			$phone = trim(str_replace(' ','',$matches[0]));
   541| 			if (strlen($phone) > 8 && !preg_match('/[0-9]{5}\-[0-9]{3}/',$phone))
   542| 				{
   543| 				if (isset($r['phone']))
   544| 					{
   545| 					if (isset($r['fax'])) continue;
   546| 					$r['fax'] = trim($matches[0]);
   547| 					}
   548| 				else
   549| 					{
   550| 					$r['phone'] = trim($matches[0]);
   551| 					}
   552| 				$val = str_replace($matches[0],'',$val);
   553| 				if ($val == '')
   554| 					{
   555| 					unset($array[$key]);
   556| 					continue;
   557| 					}
   558| 				else
   559| 					{
   560| 					$array[$key] = $val;
   561| 					$ok = true;
   562| 					}
   563| 				}
   564| 			}
   565| 		if (preg_match('/([-0-9a-zA-Z._+&\/=]+@([-0-9a-zA-Z]+[.])+[a-zA-Z]{2,6})/',$val, $matches))
   566| 			{
   567| 			$r['email'] = $matches[0];
   568| 			$val = str_replace($matches[0],'',$val);
   569| 			$val = trim(str_replace('()','',$val));
   570| 			if ($val == '')
   571| 				{
   572| 				unset($array[$key]);
   573| 				continue;
   574| 				}
   575| 			else
   576| 				{
   577| 				if (!isset($r['name']))
   578| 					{
   579| 					$r['name'] = $val;
   580| 					unset($array[$key]);
   581| 					}
   582| 				else
   583| 					$array[$key] = $val;
   584| 				$ok = true;
   585| 				}
   586| 			}
   587| 		}
   588| 	}
   589| if (!isset($r['name']) && count($array)>0)
   590| 	{
   591| 	$r['name'] = array_shift($array);
   592| 	}
   593| if ($has_org && count($array)>0)
   594| 	{
   595| 	$r['organization'] = array_shift($array);
   596| 	}
   597| if (isset($r['name']) && is_array($r['name']))
   598| 	{
   599| 	$r['name'] = implode($r['name'],' ');
   600| 	}
   601| if (!empty($array))
   602| 	{
   603| 	if (isset($r['address']))
   604| 		$r['address'] = array_merge($r['address'],$array);
   605| 	else
   606| 		$r['address'] = $array;
   607| 	}
   608| return $r;
   609| }
   610| function format_dates (&$res,$format='mdy')
   611| {
   612| if (!is_array($res)) return $res;
   613| foreach ($res as $key => $val)
   614| 	{
   615| 	if (is_array($val))
   616| 		{
   617| 		if (!is_numeric($key) && ($key=='expires' || $key=='created' || $key=='changed'))
   618| 			{
   619| 			$d = get_date($val[0],$format);
   620| 			if ($d) $res[$key] = $d;
   621| 			}
   622| 		else
   623| 			{
   624| 			$res[$key] = format_dates($val,$format);
   625| 			}
   626| 		}
   627| 	else
   628| 		{
   629| 		if (!is_numeric($key) && ($key=='expires' || $key=='created' || $key=='changed'))
   630| 			{
   631| 			$d = get_date($val,$format);
   632| 			if ($d) $res[$key] = $d;
   633| 			}
   634| 		}
   635| 	}
   636| return $res;
   637| }
   638| function get_date($date,$format)
   639| {
   640| $months = array( 'jan'=>1,  'ene'=>1,  'feb'=>2,  'mar'=>3, 'apr'=>4, 'abr'=>4,
   641|                  'may'=>5,  'jun'=>6,  'jul'=>7,  'aug'=>8, 'ago'=>8, 'sep'=>9,
   642|                  'oct'=>10, 'nov'=>11, 'dec'=>12, 'dic'=>12 );
   643| $parts = explode(' ',$date);
   644| if (strpos($parts[0],'@') !== false)
   645| 	{
   646| 	unset($parts[0]);
   647| 	$date = implode(' ',$parts);
   648| 	}
   649| $date = str_replace(',',' ',trim($date));
   650| $date = str_replace('.',' ',$date);
   651| $date = str_replace('-',' ',$date);
   652| $date = str_replace('/',' ',$date);
   653| $date = str_replace("\t",' ',$date);
   654| $parts = explode(' ',$date);
   655| $res = false;
   656| if ((strlen($parts[0]) == 8 || count($parts) == 1) && is_numeric($parts[0]))
   657| 	{
   658| 	$val = $parts[0];
   659| 	for ($p=$i=0; $i<3; $i++)
   660| 		{
   661| 		if ($format[$i] != 'Y')
   662| 			{
   663| 			$res[$format[$i]] = substr($val,$p,2);
   664| 			$p += 2;
   665| 			}
   666| 		else
   667| 			{
   668| 			$res['y'] = substr($val,$p,4);
   669| 			$p += 4;
   670| 			}
   671| 		}
   672| 	}
   673| else
   674| 	{
   675| 	$format = strtolower($format);
   676| 	for ($p=$i=0; $p<count($parts) && $i<strlen($format); $p++)
   677| 		{
   678| 		if (trim($parts[$p]) == '')
   679| 			continue;
   680| 		if ($format[$i] != '-')
   681| 			{
   682| 			$res[$format[$i]] = $parts[$p];
   683| 			}
   684| 		$i++;
   685| 		}
   686| 	}
   687| if (!$res) return $date;
   688| $ok = false;
   689| while (!$ok)
   690| 	{
   691| 	reset($res);
   692| 	$ok = true;
   693| 	while (list($key, $val) = each($res))
   694| 		{
   695| 		if ($val == '' || $key == '') continue;
   696| 		if (!is_numeric($val) && isset($months[substr(strtolower($val),0,3)]))
   697| 			{
   698| 			$res[$key] = $res['m'];
   699| 			$res['m'] = $months[substr(strtolower($val),0,3)];
   700| 			$ok = false;
   701| 			break;
   702| 			}
   703| 		if ($key != 'y' && $key != 'Y' && $val > 1900)
   704| 			{
   705| 			$res[$key] = $res['y'];
   706| 			$res['y'] = $val;
   707| 			$ok = false;
   708| 			break;
   709| 			}
   710| 		}
   711| 	}
   712| if ($res['m'] > 12)
   713| 	{
   714| 	$v = $res['m'];
   715| 	$res['m'] = $res['d'];
   716| 	$res['d'] = $v;
   717| 	}
   718| if ($res['y'] < 70)
   719| 	$res['y'] += 2000;
   720| else
   721| 	if ($res['y'] <= 99)
   722| 		$res['y'] += 1900;
   723| return sprintf("%.4d-%02d-%02d",$res['y'],$res['m'],$res['d']);
   724| }
   725| ?>


# ====================================================================
# FILE: src/whois.pl.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__PL_HANDLER__'))
    21| 	define('__PL_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class pl_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 	'domain.created' => 'created:',
    29|                 	'domain.changed' => 'last modified:',
    30|                 	'domain.sponsor' => 'REGISTRAR:',
    31|                 	'#' => 'WHOIS displays data with a delay not exceeding 15 minutes in relation to the .pl Registry system'
    32| 					);
    33| 		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd');
    34| 		$r['regyinfo'] = array(
    35| 			'referrer' => 'http://www.dns.pl/english/index.html',
    36| 			'registrar' => 'NASK'
    37| 			);
    38| 		return $r;
    39| 		}
    40| 	}
    41| ?>


# ====================================================================
# FILE: src/whois.pro.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-33 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| require_once('whois.parser.php');
    21| if (!defined('__PRO_HANDLER__'))
    22| 	define('__PRO_HANDLER__', 1);
    23| class pro_handler
    24| 	{
    25| 	function parse($data, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data['rawdata']);
    28| 		$r['regyinfo']['referrer'] = 'http://www.registrypro.pro';
    29| 		$r['regyinfo']['registrar'] = 'RegistryPRO';
    30| 		return $r;
    31| 		}
    32| 	}
    33| ?>


# ====================================================================
# FILE: src/whois.pt.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 18-59 ---
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| /* TODO:
    21|    - whois - converter para http://domaininfo.com/idn_conversion.asp punnycode antes de efectuar a pesquisa
    22|    - o punnycode deveria fazer parte dos resultados fazer parte dos resultados!
    23| */
    24| if (!defined('__PT_HANDLER__'))
    25| 	define('__PT_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class pt_handler
    28| 	{
    29| 	function parse($data, $query)
    30| 		{
    31| 		$items = array(
    32| 					'domain.name' 		=> ' / Domain Name:',
    33| 					'domain.created' 	=> 'Data de registo / Creation Date (dd/mm/yyyy):',
    34| 					'domain.nserver.' 	=> 'Nameserver:',
    35| 					'domain.status'	 	=> 'Estado / Status:',
    36| 					'owner'				=> 'Titular / Registrant',
    37| 					'billing'			=> 'Entidade Gestora / Billing Contact',
    38| 					'admin'				=> 'Respons�vel Administrativo / Admin Contact',
    39| 					'tech'				=> 'Respons�vel T�cnico / Tech Contact',
    40| 					'#'					=> 'Nameserver Information'
    41| 					);
    42| 		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
    43| 		if (empty($r['regrinfo']['domain']['name']))
    44| 			{
    45| 			print_r($r['regrinfo']);
    46| 			$r['regrinfo']['registered'] = 'no';
    47| 			return $r;
    48| 			}
    49| 		$r['regrinfo']['domain']['created'] = get_date($r['regrinfo']['domain']['created'], 'dmy');
    50| 		if ($r['regrinfo']['domain']['status'] == 'ACTIVE')
    51| 			{
    52| 			$r['regrinfo'] = get_contacts($r['regrinfo']);
    53| 			$r['regrinfo']['registered'] = 'yes';
    54| 			}
    55| 		else
    56| 			$r['regrinfo']['registered'] = 'no';
    57| 		$r['regyinfo'] = array(
    58| 			'referrer' => 'http://www.fccn.pt',
    59| 			'registrar' => 'FCCN'


# ====================================================================
# FILE: src/whois.ro.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-80 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| /*
    21| BUG
    22| - date on ro could be given as "mail date" (ex: updated field)
    23| - multiple person for one role, ex: news.ro
    24| - seems the only role listed is registrant
    25| */
    26| if (!defined('__RO_HANDLER__'))
    27| 	define('__RO_HANDLER__', 1);
    28| require_once('whois.parser.php');
    29| class ro_handler
    30| 	{
    31| 	function parse($data_str, $query)
    32| 		{
    33| 		$translate = array(
    34| 						'fax-no' => 'fax',
    35| 						'e-mail' => 'email',
    36| 						'nic-hdl' => 'handle',
    37| 						'person' => 'name',
    38| 						'address' => 'address.',
    39| 						'domain-name'	=> '',
    40| 						'updated' => 'changed',
    41| 						'registration-date' => 'created',
    42| 						'domain-status'	=> 'status',
    43| 						'nameserver' => 'nserver'
    44| 		                  );
    45| 		$contacts = array(
    46| 						'admin-contact' 	=> 'admin',
    47| 						'technical-contact'	=> 'tech',
    48| 						'zone-contact' 		=> 'zone',
    49| 						'billing-contact' 		=> 'billing'
    50| 		                  );
    51| 		$extra = array(
    52| 						'postal code:' => 'address.pcode'
    53| 						);
    54| 		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain','Ymd');
    55| 		if (isset($reg['domain']['description']))
    56| 			{
    57| 			$reg['owner'] = get_contact($reg['domain']['description'],$extra);
    58| 			unset($reg['domain']['description']);
    59| 			foreach($reg as $key => $item)
    60| 				{
    61| 				if (isset($item['address']))
    62| 					{
    63| 					$data = $item['address'];
    64| 					unset($reg[$key]['address']);
    65| 					$reg[$key] = array_merge($reg[$key],get_contact($data,$extra));
    66| 					}
    67| 				}
    68| 			$reg['registered'] = 'yes';
    69| 			}
    70| 		else
    71| 			$reg['registered'] = 'no';
    72| 		$r['regrinfo'] = $reg;
    73| 		$r['regyinfo'] = array(
    74|                           'referrer' => 'http://www.nic.ro',
    75|                           'registrar' => 'nic.ro'
    76|                           );
    77| 		return $r;
    78| 		}
    79| 	}
    80| ?>


# ====================================================================
# FILE: src/whois.ru.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__RU_HANDLER__'))
    21| 	define('__RU_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class ru_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'domain:' => 'domain.name',
    29|                   'registrar:' => 'domain.sponsor',
    30|                   'state:' => 'domain.status',
    31|                   'nserver:' => 'domain.nserver.',
    32|                   'source:' => 'domain.source',
    33|                   'created:' => 'domain.created',
    34|                   'paid-till:' => 'domain.expires',
    35|                   'type:' => 'owner.type',
    36|                   'org:' => 'owner.organization',
    37|                   'phone:' => 'owner.phone',
    38|                   'fax-no:' => 'owner.fax',
    39|                   'e-mail:' => 'owner.email'
    40| 		              );
    41| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
    42| 		if (empty($r['regrinfo']['domain']['status']))
    43| 			$r['regrinfo']['registered'] = 'no';
    44| 		$r['regyinfo'] = array(
    45|                             'referrer' => 'http://www.ripn.net',
    46|                             'registrar' => 'RU-CENTER-REG-RIPN'
    47|                           );
    48| 		return $r;
    49| 		}
    50| 	}
    51| ?>


# ====================================================================
# FILE: src/whois.rwhois.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-47 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__RWHOIS_HANDLER__'))
    21| 	define('__RWHOIS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class rwhois_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28| 						'network:Organization-Name:' => 'owner.name',
    29| 						'network:Organization;I:' => 'owner.organization',
    30| 						'network:Organization-City:' => 'owner.address.city',
    31| 						'network:Organization-Zip:' => 'owner.address.pcode',
    32| 						'network:Organization-Country:' => 'owner.address.country',
    33| 						'network:IP-Network-Block:' => 'network.inetnum',
    34| 						'network:IP-Network:' => 'network.inetnum',
    35| 						'network:Network-Name:' => 'network.name',
    36| 						'network:ID:' => 'network.handle',
    37| 						'network:Created:' => 'network.created',
    38| 						'network:Updated:' => 'network.changed',
    39| 						'network:Tech-Contact;I:' => 'tech.email',
    40| 						'network:Admin-Contact;I:' => 'admin.email'
    41| 						);
    42| 		$res = generic_parser_b($data_str, $items, 'Ymd', false);
    43| 		if (isset($res['disclaimer'])) unset($res['disclaimer']);
    44| 		return array( 'regrinfo' => $res );
    45| 		}
    46| 	}
    47| ?>


# ====================================================================
# FILE: src/whois.sc.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__SC_HANDLER__'))
    21| 	define('__SC_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class sc_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, 'dmy');
    28| 		$r['regyinfo'] = array(
    29|                   'referrer' => 'http://www.nic.sc',
    30|                   'registrar' => 'VCS (Pty) Limited'
    31|                   );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.se.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__SE_HANDLER__'))
    21| 	define('__SE_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class se_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                     'domain' => 'domain.name',
    29|                     'state:' => 'domain.status.',
    30|                     'status:' => 'domain.status.',
    31|                     'expires:' => 'domain.expires',
    32|                     'created:' => 'domain.created',
    33|                     'nserver:' => 'domain.nserver.',
    34|                     'holder:' => 'owner.handle'
    35|                     );
    36| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd', false);
    37| 		$r['regrinfo']['registered'] = isset($r['regrinfo']['domain']['name']) ? 'yes' : 'no';
    38| 		$r['regyinfo'] = array(
    39|                     'referrer' => 'http://www.nic-se.se',
    40|                     'registrar' => 'NIC-SE'
    41| 		                );
    42| 		return $r;
    43| 		}
    44| 	}
    45| ?>


# ====================================================================
# FILE: src/whois.servers.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-233 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| /* servers.whois	v18   Markus Welters	2004/06/25 */
    21| /* servers.whois	v17	ross golder	2003/02/09 */
    22| /* servers.whois	v16	mark jeftovic	2001/02/28 */
    23| $this->DATA_VERSION = '19';
    24| $this->DATA = array(
    25| 	'bz'		=> 'gtld',
    26| 	'com'		=> 'gtld',
    27| 	'jobs'		=> 'gtld',
    28| 	'li'		=> 'ch',
    29| 	'net'		=> 'gtld',
    30| 	'su'		=> 'ru',
    31| 	'tv'		=> 'gtld',
    32| 	'za.org'	=> 'zanet',
    33| 	'za.net'	=> 'zanet',
    34| 	'xn--p1ai' => 'ru'
    35| 	);
    36| /* Non UTF-8 servers */
    37| $this->NON_UTF8 = array(
    38| 	'br.whois-servers.net' => 1,
    39| 	'ca.whois-servers.net' => 1,
    40| 	'cl.whois-servers.net' => 1,
    41| 	'hu.whois-servers.net' => 1,
    42| 	'is.whois-servers.net' => 1,
    43| 	'pt.whois-servers.net' => 1,
    44| 	'whois.interdomain.net' => 1,
    45| 	'whois.lacnic.net' => 1,
    46| 	'whois.nicline.com' => 1,
    47| 	'whois.ripe.net' => 1
    48| 	);
    49| /* If whois Server needs any parameters, enter it here */
    50| $this->WHOIS_PARAM = array(
    51| 	'com.whois-servers.net' => 'domain =$',
    52| 	'net.whois-servers.net' => 'domain =$',
    53| 	'de.whois-servers.net'	=> '-T dn,ace $',
    54| 	'jp.whois-servers.net'	=> 'DOM $/e'
    55| 	);
    56| /* TLD's that have special whois servers or that can only be reached via HTTP */
    57| $this->WHOIS_SPECIAL = array(
    58| 		'ad'	 => '',
    59| 		'ae'	 => 'whois.aeda.net.ae',
    60| 		'af'	 => 'whois.nic.af',
    61| 		'ai'	 => 'http://whois.offshore.ai/cgi-bin/whois.pl?domain-name={domain}.ai',
    62| 		'al'	 => '',
    63| 		'az'	 => '',
    64| 		'ba'	 => '',
    65| 		'bb'	 => 'http://domains.org.bb/regsearch/getdetails.cfm?DND={domain}.bb',
    66| 		'bg'	 => 'http://www.register.bg/bg-nic/displaydomain.pl?domain={domain}.bg&search=exist',
    67| 		'bh'	 => 'whois.nic.bh',
    68| 		'bi'	 => 'whois.nic.bi',
    69| 		'bj'	 => 'whois.nic.bj',
    70| 		'by'	 => '',
    71| 		'bz'	 => 'whois2.afilias-grs.net',
    72| 		'cy'	 => '',
    73| 		'es'	 => '',
    74| 		'fj'	 => 'whois.usp.ac.fj',
    75| 		'fm'     => 'http://www.dot.fm/query_whois.cfm?domain={domain}&tld=fm',
    76| 		'jobs'	 => 'jobswhois.verisign-grs.com',
    77| 		'ke'	 => 'kenic.or.ke',
    78| 		'la'	 => 'whois.centralnic.net',
    79| 		'gr'	 => '',
    80| 		'gs'     => 'http://www.adamsnames.tc/whois/?domain={domain}.gs',
    81| 		'gt'	 => 'http://www.gt/Inscripcion/whois.php?domain={domain}.gt',
    82| 		'me'	 => 'whois.meregistry.net',
    83| 		'mobi'	 => 'whois.dotmobiregistry.net',
    84| 		'ms'     => 'http://www.adamsnames.tc/whois/?domain={domain}.ms',
    85| 		'mt'	 => 'http://www.um.edu.mt/cgi-bin/nic/whois?domain={domain}.mt',
    86| 		'nl'	 => 'whois.domain-registry.nl',
    87| 		'ly'	 => 'whois.nic.ly',
    88| 		'pe'	 => 'kero.rcp.net.pe',
    89| 		'pr'	 => 'whois.uprr.pr',
    90| 		'pro'	 => 'whois.registry.pro',
    91| 		'sc'     => 'whois2.afilias-grs.net',
    92| 		'tc'     => 'http://www.adamsnames.tc/whois/?domain={domain}.tc',
    93| 		'tf'     => 'http://www.adamsnames.tc/whois/?domain={domain}.tf',
    94| 		've'	 => 'whois.nic.ve',
    95| 		'vg'     => 'http://www.adamsnames.tc/whois/?domain={domain}.vg',
    96| 		'net.au' => 'whois.aunic.net',
    97| 		'ae.com' => 'whois.centralnic.net',
    98| 		'br.com' => 'whois.centralnic.net',
    99| 		'cn.com' => 'whois.centralnic.net',
   100| 		'de.com' => 'whois.centralnic.net',
   101| 		'eu.com' => 'whois.centralnic.net',
   102| 		'hu.com' => 'whois.centralnic.net',
   103| 		'jpn.com'=> 'whois.centralnic.net',
   104| 		'kr.com' => 'whois.centralnic.net',
   105| 		'gb.com' => 'whois.centralnic.net',
   106| 		'no.com' => 'whois.centralnic.net',
   107| 		'qc.com' => 'whois.centralnic.net',
   108| 		'ru.com' => 'whois.centralnic.net',
   109| 		'sa.com' => 'whois.centralnic.net',
   110| 		'se.com' => 'whois.centralnic.net',
   111| 		'za.com' => 'whois.centralnic.net',
   112| 		'uk.com' => 'whois.centralnic.net',
   113| 		'us.com' => 'whois.centralnic.net',
   114| 		'uy.com' => 'whois.centralnic.net',
   115| 		'gb.net' => 'whois.centralnic.net',
   116| 		'se.net' => 'whois.centralnic.net',
   117| 		'uk.net' => 'whois.centralnic.net',
   118| 		'za.net' => 'whois.za.net',
   119| 		'za.org' => 'whois.za.net',
   120| 		'co.za'  => 'http://co.za/cgi-bin/whois.sh?Domain={domain}.co.za',
   121| 		'org.za' => 'http://www.org.za/cgi-bin/rwhois?domain={domain}.org.za&format=full'
   122| 		);
   123| /* handled gTLD whois servers */
   124| $this->WHOIS_GTLD_HANDLER = array(
   125| 		'whois.bulkregister.com'			=> 'enom',
   126| 		'whois.dotregistrar.com'			=> 'dotster',
   127| 		'whois.namesdirect.com'				=> 'dotster',
   128| 		'whois.psi-usa.info'				=> 'psiusa',
   129| 		'whois.www.tv'						=> 'tvcorp',
   130| 		'whois.tucows.com'					=> 'opensrs',
   131| 		'whois.35.com'						=> 'onlinenic',
   132| 		'whois.nominalia.com'				=> 'genericb',
   133| 		'whois.encirca.com'					=> 'genericb',
   134| 		'whois.corenic.net'					=> 'genericb'
   135| 		);
   136| /* Non ICANN TLD's */
   137| $this->WHOIS_NON_ICANN = array (
   138| 		'agent'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   139| 		'agente'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   140| 		'america'	=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
   141| 		'amor'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   142| 		'amore'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   143| 		'amour'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   144| 		'arte'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   145| 		'artes'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   146| 		'arts'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   147| 		'asta'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   148| 		'auction'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   149| 		'auktion'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   150| 		'boutique'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   151| 		'chat'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   152| 		'chiesa'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   153| 		'church'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   154| 		'cia'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   155| 		'ciao'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   156| 		'cie'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   157| 		'club'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   158| 		'clube'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   159| 		'com2'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
   160| 		'deporte'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   161| 		'ditta'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   162| 		'earth'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
   163| 		'eglise'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   164| 		'enchere'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   165| 		'escola'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   166| 		'escuela'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   167| 		'esporte'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   168| 		'etc'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
   169| 		'famiglia'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   170| 		'familia'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   171| 		'familie'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   172| 		'family'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   173| 		'free'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   174| 		'hola'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   175| 		'game'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   176| 		'ges'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   177| 		'gmbh'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   178| 		'golf'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   179| 		'gratis'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   180| 		'gratuit'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   181| 		'iglesia'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   182| 		'igreja'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   183| 		'inc'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   184| 		'jeu'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   185| 		'jogo'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   186| 		'juego'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   187| 		'kids'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   188| 		'kirche'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   189| 		'krunst'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   190| 		'law'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   191| 		'legge'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   192| 		'lei'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   193| 		'leilao'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   194| 		'ley'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   195| 		'liebe'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   196| 		'lion'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
   197| 		'llc'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   198| 		'llp'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   199| 		'loi'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   200| 		'loja'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   201| 		'love'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   202| 		'ltd'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   203| 		'makler'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   204| 		'med'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   205| 		'mp3'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   206| 		'not'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
   207| 		'online'	=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
   208| 		'recht'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   209| 		'reise'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   210| 		'resto'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   211| 		'school'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   212| 		'schule'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   213| 		'scifi'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   214| 		'scuola'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   215| 		'shop'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   216| 		'soc'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   217| 		'spiel'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   218| 		'sport'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   219| 		'subasta'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   220| 		'tec'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   221| 		'tech'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   222| 		'tienda'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   223| 		'travel'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   224| 		'turismo'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   225| 		'usa' 		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
   226| 		'verein'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   227| 		'viaje'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   228| 		'viagem'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   229| 		'video'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   230| 		'voyage'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
   231| 		'z'			=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}'
   232| 		);
   233| ?>


# ====================================================================
# FILE: src/whois.si.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__SI_HANDLER__'))
    21|     define('__SI_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class si_handler
    24|     {
    25|     function parse($data_str, $query)
    26|         {
    27| 		$translate = array(
    28| 			'nic-hdl' => 'handle',
    29| 			'nameserver' => 'nserver'
    30| 			);
    31| 		$contacts = array(
    32|                     'registrant' => 'owner',
    33|                     'tech-c' => 'tech'
    34|                         );
    35| 		$r['regrinfo'] = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');		
    36| 		$r['regyinfo'] = array(
    37|                   'referrer' => 'http://www.arnes.si',
    38|                   'registrar' => 'ARNES'
    39|                   );
    40| 		return $r;
    41|         }
    42|     }
    43| ?>


# ====================================================================
# FILE: src/whois.su.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-52 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__SU_HANDLER__'))
    21| 	define('__SU_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class su_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'domain:' => 'domain.name',
    29|                   'registrar:' => 'domain.sponsor',
    30|                   'state:' => 'domain.status',
    31|                   'person:' => 'owner.name',
    32|                   'phone:' => 'owner.phone',
    33|                   'e-mail:' => 'owner.email',
    34|                   'created:' => 'domain.created',
    35|                   'paid-till:' => 'domain.expires',
    36| /*
    37|                   'nserver:' => 'domain.nserver.',
    38|                   'source:' => 'domain.source',
    39|                   'type:' => 'owner.type',
    40|                   'org:' => 'owner.organization',
    41|                   'fax-no:' => 'owner.fax',
    42| */
    43| 		              );
    44| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
    45| 		$r['regyinfo'] = array(
    46|                             'referrer' => 'http://www.ripn.net',
    47|                             'registrar' => 'RUCENTER-REG-RIPN'
    48|                           );
    49| 		return $r;
    50| 		}
    51| 	}
    52| ?>


# ====================================================================
# FILE: src/whois.tel.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__TEL_HANDLER__'))
    21| 	define('__TEL_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class tel_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, '-md--y');
    28| 		$r['regyinfo'] = array(
    29|                   'referrer' => 'http://www.telnic.org',
    30|                   'registrar' => 'Telnic'
    31|                   );
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.travel.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-33 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__TRAVEL_HANDLER__'))
    21| 	define('__TRAVEL_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class travel_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		$r['regyinfo']['referrer'] = 'http://www.nic.travel/';
    29| 		$r['regyinfo']['registrar'] = 'Tralliance Corporation';
    30| 		return $r;
    31| 		}
    32| 	}
    33| ?>


# ====================================================================
# FILE: src/whois.uk.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-66 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__UK_HANDLER__'))
    21| 	define('__UK_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class uk_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                 'owner.organization' => 'Registrant:',
    29|                 'owner.address'  => "Registrant's address:",
    30|                 'owner.type' 	 => 'Registrant type:',
    31|                 'domain.created' => 'Registered on:',
    32|  				'domain.changed' => 'Last updated:',
    33|                 'domain.expires' => 'Renewal date:',
    34|                 'domain.nserver' => 'Name servers:',
    35|                 'domain.sponsor' => 'Registrar:',
    36|                 'domain.status'	 => 'Registration status:',
    37|                 'domain.dnssec'	 => 'DNSSEC:',
    38|                 '' 				 => 'WHOIS lookup made at',
    39|                 'disclaimer'	 => '--',
    40| 		        );
    41| 		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    42| 		if (isset($r['regrinfo']['owner']))
    43| 			{
    44| 			$r['regrinfo']['owner']['organization'] = $r['regrinfo']['owner']['organization'][0];
    45| 			$r['regrinfo']['domain']['sponsor'] = $r['regrinfo']['domain']['sponsor'][0];
    46| 			$r['regrinfo']['registered'] = 'yes';
    47| 			$r = format_dates($r, 'dmy');
    48| 			}
    49| 		else
    50| 			{
    51| 			if (strpos($data_str['rawdata'][1],'Error for '))
    52| 				{
    53| 				$r['regrinfo']['registered'] = 'yes';
    54| 				$r['regrinfo']['domain']['status'] = 'invalid';
    55| 				}
    56| 			else
    57| 				$r['regrinfo']['registered'] = 'no';
    58| 			}
    59| 		$r['regyinfo'] = array(
    60|                     'referrer' => 'http://www.nominet.org.uk',
    61|                     'registrar' => 'Nominet UK'
    62| 		                );
    63| 		return $r;
    64| 		}
    65| 	}
    66| ?>


# ====================================================================
# FILE: src/whois.us.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-34 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19| */
    20| if(!defined('__US_HANDLER__')) define('__US_HANDLER__',1);
    21| require_once('whois.parser.php');
    22| class us_handler
    23| 	{
    24| 	function parse ($data_str, $query)
    25| 		{
    26| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, '-md--y');
    27| 		$r['regyinfo'] = array(
    28| 								'referrer'=>'http://www.neustar.us',
    29| 								'registrar' => 'NEUSTAR INC.'
    30| 							);
    31| 		return $r;
    32| 		}
    33| 	}
    34| ?>


# ====================================================================
# FILE: src/whois.utils.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-119 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| class utils extends Whois {
    21| 	function showObject(&$obj)
    22| 		{
    23| 		$r = $this->debugObject($obj);
    24| 		return "<pre>$r</pre>\n";
    25| 		}
    26| 	function debugObject($obj,$indent=0)
    27| 		{
    28| 		if (is_array($obj))
    29| 			{
    30| 			$return = '';
    31| 			foreach($obj as $k => $v)
    32| 				{
    33| 				$return .= str_repeat('&nbsp;',$indent);
    34| 					if (is_array($v))
    35| 						{
    36| 						$return .= $k."->Array\n";
    37| 						$return .= $this->debugObject($v,$indent+1);
    38| 						}
    39| 					else
    40| 						{
    41| 						$return .= $k."->$v\n";
    42| 						}
    43| 			}
    44| 			return $return;
    45| 		}
    46| 	}
    47| 	function ns_rr_defined($query) {
    48| 		return checkdnsrr($query,'NS');
    49| 	}
    50| 	function showHTML($result, $link_myself=true, $params='query=$0&amp;output=nice') {
    51| 		$email_regex = "/([-_\w\.]+)(@)([-_\w\.]+)\b/i";
    52| 		$html_regex = "/(?:^|\b)((((http|https|ftp):\/\/)|(www\.))([\w\.]+)([,:%#&\/?~=\w+\.-]+))(?:\b|$)/is";
    53| 		$ip_regex = "/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/i";
    54| 		$out = '';
    55| 		$lempty = true;
    56| 		foreach($result['rawdata'] as $line)
    57| 			{
    58| 			$line = trim($line);
    59| 			if ($line == '')
    60| 				{
    61| 				if ($lempty) continue;
    62| 				else $lempty = true;
    63| 				}
    64| 			else
    65| 				$lempty = false;
    66| 			$out .= $line."\n";
    67| 			}
    68| 		if ($lempty) $out = trim($out);
    69| 		$out = strip_tags($out);
    70| 		$out = preg_replace ($email_regex, '<a href="mailto:$0">$0</a>', $out);
    71| 		$out = preg_replace_callback ($html_regex, 'href_replace', $out);
    72| 		if ($link_myself)
    73| 			{
    74| 			if ($params[0] == '/')
    75| 				$link = $params;
    76| 			else
    77| 				$link = $_SERVER['PHP_SELF'].'?'.$params;
    78| 			$out = preg_replace ($ip_regex, '<a href="'.$link.'">$0</a>', $out);
    79| 			if (isset($result['regrinfo']['domain']['nserver']))
    80| 				{
    81| 				$nserver = $result['regrinfo']['domain']['nserver'];
    82| 				}
    83| 			else
    84| 				$nserver = false;
    85| 			if (isset($result['regrinfo']['network']['nserver']))
    86| 				{
    87| 				$nserver = $result['regrinfo']['network']['nserver'];
    88| 				}
    89| 			if (is_array($nserver))
    90| 				{
    91| 				reset($nserver); 
    92| 				while (list($host, $ip) = each($nserver))
    93| 					{
    94| 					$url = '<a href="'. str_replace('$0',$ip,$link)."\">$host</a>";
    95| 					$out = str_replace($host, $url, $out);
    96| 					$out = str_replace(strtoupper($host), $url, $out);
    97| 					}
    98| 				}
    99| 			}
   100| 		$out = preg_replace ("/(?m)^([-\s\.&;'\w\t\(\)\/]+:\s*)/", '<b>$1</b>', $out);
   101| 		$out = preg_replace ("/(?m)^(%.*)/", '<i>$0</i>', $out);
   102| 		return str_replace("\n","<br/>\n",$out);
   103| 	}
   104| }
   105| function href_replace($matches)
   106| {
   107| if (substr($matches[0],0,4)=='www.')
   108| 	{
   109| 	$web=$matches[0];
   110| 	$url='http://'.$web;
   111| 	}
   112| else
   113| 	{
   114| 	$web=$matches[0];
   115| 	$url=$web;
   116| 	}
   117| return '<a href="'.$url.'" target="_blank">'.$web.'</a>';
   118| }
   119| ?>


# ====================================================================
# FILE: src/whois.ve.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-60 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307,
    19| USA.
    20|  */
    21| if (!defined('__VE_HANDLER__'))
    22| 	define('__VE_HANDLER__', 1);
    23| require_once('whois.parser.php');
    24| class ve_handler
    25| 	{
    26| 	function parse($data_str, $query)
    27| 		{
    28| 		$items = array(
    29| 						'owner'				=>	'Titular:',
    30| 						'domain.name'		=>	'Nombre de Dominio:',
    31| 						'admin'				=>	'Contacto Administrativo',
    32| 						'tech'				=>	'Contacto Tecnico',
    33| 						'billing'			=>	'Contacto de Cobranza:',
    34| 						'domain.created'	=>	'Fecha de Creacion:',
    35| 						'domain.changed'	=>	'Ultima Actualizacion:',
    36| 						'domain.expires'	=>	'Fecha de Vencimiento:',
    37| 						'domain.status'		=>	'Estatus del dominio:',
    38| 						'domain.nserver'	=>	'Servidor(es) de Nombres de Dominio'
    39| 		              );
    40| 		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    41| 		if (!isset($r['regrinfo']['domain']['created']) || is_array($r['regrinfo']['domain']['created']))
    42| 			{
    43| 			$r['regrinfo'] = array ( 'registered' => 'no');
    44| 			return $r;
    45| 			}
    46| 		$dns = array();
    47| 		foreach($r['regrinfo']['domain']['nserver'] as $nserv)
    48| 			{
    49| 			if ($nserv[0] == '-') $dns[] = $nserv;
    50| 			}
    51| 		$r['regrinfo']['domain']['nserver'] = $dns;
    52| 		$r['regrinfo'] = get_contacts($r['regrinfo']);
    53| 		$r['regyinfo'] = array(
    54| 			'referrer'		=>	'http://registro.nic.ve',
    55| 			'registrar'		=>	'NIC-Venezuela - CNTI'
    56|                );
    57| 		return $r;		
    58| 		}
    59| 	}
    60| ?>


# ====================================================================
# FILE: src/whois.ws.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-60 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__WS_HANDLER__'))
    21|   define('__WS_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class ws_handler extends WhoisClient
    24|   {
    25|   function parse($data_str, $query)
    26|     {
    27|     $items = array(
    28| 				'Domain Name:' 						=> 'domain.name',
    29| 				'Registrant Name:' 					=> 'owner.organization',
    30| 				'Registrant Email:' 				=> 'owner.email',
    31| 				'Domain Created:' 					=> 'domain.created',
    32| 				'Domain Last Updated:' 				=> 'domain.changed',
    33| 				'Registrar Name:'					=> 'domain.sponsor',
    34| 				'Current Nameservers:' 				=> 'domain.nserver.',
    35| 				'Administrative Contact Email:' 	=> 'admin.email',
    36| 				'Administrative Contact Telephone:' => 'admin.phone',
    37| 				'Registrar Whois:'					=> 'rwhois'
    38| 				);
    39| 	$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
    40|     $r['regyinfo']['referrer'] = 'http://www.samoanic.ws';
    41|     $r['regyinfo']['registrar'] = 'Samoa Nic';
    42|     if (!empty($r['regrinfo']['domain']['name']))
    43| 		{
    44| 		$r['regrinfo']['registered'] = 'yes';
    45| 		if (isset($r['regrinfo']['rwhois']))
    46| 			{
    47| 			if ($this->deep_whois)
    48| 				{
    49| 				$r['regyinfo']['whois']	= $r['regrinfo']['rwhois'];
    50| 				$r = $this->DeepWhois($query,$r);
    51| 				}
    52| 			unset($r['regrinfo']['rwhois']);
    53| 			}
    54| 		}
    55|     else
    56| 		$r['regrinfo']['registered'] = 'no';
    57|     return $r;
    58|     }
    59|   }
    60| ?>


# ====================================================================
# FILE: src/whois.xxx.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__XXX_HANDLER__'))
    21| 	define('__XXX_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class xxx_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    28| 		if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
    29| 			$r['regrinfo']['registered'] = 'unknown';
    30| 		$r['regyinfo']['referrer'] = 'http://www.pir.org/';
    31| 		$r['regyinfo']['registrar'] = 'Public Interest Registry';
    32| 		return $r;
    33| 		}
    34| 	}
    35| ?>


# ====================================================================
# FILE: src/whois.zanet.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-71 ---
     1| <?php
     2| /*
     3| Whois.php        PHP classes to conduct whois queries
     4| Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5| Maintained by David Saez
     6| For the most recent version of this package visit:
     7| http://www.phpwhois.org
     8| This program is free software; you can redistribute it and/or
     9| modify it under the terms of the GNU General Public License
    10| as published by the Free Software Foundation; either version 2
    11| of the License, or (at your option) any later version.
    12| This program is distributed in the hope that it will be useful,
    13| but WITHOUT ANY WARRANTY; without even the implied warranty of
    14| MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15| GNU General Public License for more details.
    16| You should have received a copy of the GNU General Public License
    17| along with this program; if not, write to the Free Software
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| if (!defined('__ZANET_HANDLER__'))
    21| 	define('__ZANET_HANDLER__', 1);
    22| require_once('whois.parser.php');
    23| class zanet_handler
    24| 	{
    25| 	function parse($data_str, $query)
    26| 		{
    27| 		$items = array(
    28|                   'domain.name' => 'Domain Name            : ',
    29|                   'domain.created' => 'Record Created         :',
    30|                   'domain.changed' => 'Record	Last Updated    :',
    31|                   'owner.name' => 'Registered for         :',
    32|                   'admin' => 'Administrative Contact :',
    33|                   'tech' => 'Technical Contact      :',
    34|                   'domain.nserver' => 'Domain Name Servers listed in order:',
    35|                   'registered' => 'No such domain: ',
    36|                   '' => 'The ZA NiC whois'
    37| 		              );
    38| 		$rawdata = array();
    39| 		while (list($key, $line) = each($data_str['rawdata']))
    40| 			{
    41| 			if (strpos($line, ' Contact ') !== false)
    42| 				{
    43| 				$pos = strpos($line, ':');
    44| 				if ($pos !== false)
    45| 					{
    46| 					$rawdata[] = substr($line, 0, $pos + 1);
    47| 					$rawdata[] = trim(substr($line, $pos + 1));
    48| 					continue;
    49| 					}
    50| 				}
    51| 			$rawdata[] = $line;
    52| 			}
    53| 		$r['regrinfo'] = get_blocks($rawdata, $items);
    54| 		if (isset($r['regrinfo']['registered']))
    55| 			{
    56| 			$r['regrinfo']['registered'] = 'no';
    57| 			}
    58| 		else
    59| 			{
    60| 			if (isset($r['regrinfo']['admin']))
    61| 				$r['regrinfo']['admin'] = get_contact($r['regrinfo']['admin']);
    62| 			if (isset($r['regrinfo']['tech']))
    63| 				$r['regrinfo']['tech'] = get_contact($r['regrinfo']['tech']);
    64| 			}
    65| 		$r['regyinfo']['referrer'] = 'http://www.za.net/'; // or http://www.za.org
    66| 		$r['regyinfo']['registrar'] = 'ZA NiC';
    67| 		format_dates($r, 'xmdxxy');
    68| 		return $r;
    69| 		}
    70| 	}
    71| ?>

