# ====================================================================
# FILE: example/example.cli.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * phpWhois console example
     4|  *
     5|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     6|  * @license
     7|  * This program is free software; you can redistribute it and/or
     8|  * modify it under the terms of the GNU General Public License
     9|  * as published by the Free Software Foundation; either version 2
    10|  * of the License, or (at your option) any later version.
    11|  * 
    12|  * This program is distributed in the hope that it will be useful,
    13|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    14|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    15|  * GNU General Public License for more details.
    16|  * 
    17|  * You should have received a copy of the GNU General Public License
    18|  * along with this program; if not, write to the Free Software
    19|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    20|  * 
    21|  * @link http://phpwhois.pw
    22|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    23|  * @copyright Maintained by David Saez
    24|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    25|  */
    26| if (file_exists(__DIR__.'/../vendor/autoload.php')) {
    27|     require_once __DIR__.'/../vendor/autoload.php';
    28| }
    29| use phpWhois\Whois;
    30| if (!isset($argv[1])) {
    31|     echo "\nUsage:\n\nphp ".__FILE__." domainname.com\n";
    32|     exit(1);
    33| }
    34| $domain = $argv[1];
    35| $whois = new Whois();
    36| $result = $whois->lookup($domain);
    37| print_r($result);


# ====================================================================
# FILE: example/example.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-130 ---
     1| <?php
     2| /**
     3|  * phpWhois Example
     4|  * 
     5|  * This class supposed to be instantiated for using the phpWhois library
     6|  * 
     7|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     8|  * @license
     9|  * This program is free software; you can redistribute it and/or
    10|  * modify it under the terms of the GNU General Public License
    11|  * as published by the Free Software Foundation; either version 2
    12|  * of the License, or (at your option) any later version.
    13|  * 
    14|  * This program is distributed in the hope that it will be useful,
    15|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    16|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    17|  * GNU General Public License for more details.
    18|  * 
    19|  * You should have received a copy of the GNU General Public License
    20|  * along with this program; if not, write to the Free Software
    21|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    22|  * 
    23|  * @link http://phpwhois.pw
    24|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    25|  * @copyright Maintained by David Saez
    26|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    27|  */
    28| header('Content-Type: text/html; charset=UTF-8');
    29| if (file_exists(__DIR__.'/../vendor/autoload.php')) {
    30|     require_once __DIR__.'/../vendor/autoload.php';
    31| }
    32| use phpWhois\Whois;
    33| use phpWhois\Utils;
    34| $whois = new Whois();
    35| if (isset($_GET['query'])) {
    36|     $query = $_GET['query'];
    37|     if (!empty($_GET['output']))
    38|         $output = $_GET['output'];
    39|     else
    40|         $output = '';
    41|     $allowproxy = false;
    42|     $whois->deepWhois = empty($_GET['fast']);
    43|     $result = $whois->lookup($query);
    44|     $winfo = '';
    45|     switch ($output) {
    46|         case 'object':
    47|             if ($whois->query['status'] < 0) {
    48|                 $winfo = implode($whois->query['errstr'], "\n<br></br>");
    49|             } else {
    50|                 $utils = new Utils;
    51|                 $winfo = $utils->showObject($result);
    52|             }
    53|             break;
    54|         case 'nice':
    55|             if (!empty($result['rawdata'])) {
    56|                 $utils = new Utils;
    57|                 $winfo = $utils->showHTML($result);
    58|             } else {
    59|                 if (isset($whois->query['errstr']))
    60|                     $winfo = implode($whois->query['errstr'], "\n<br></br>");
    61|                 else
    62|                     $winfo = 'Unexpected error';
    63|             }
    64|             break;
    65|         case 'proxy':
    66|             if ($allowproxy)
    67|                 exit(serialize($result));
    68|         default:
    69|             if (!empty($result['rawdata'])) {
    70|                 $winfo .= '<pre>' . implode($result['rawdata'], "\n") . '</pre>';
    71|             } else {
    72|                 $winfo = implode($whois->query['errstr'], "\n<br></br>");
    73|             }
    74|     }
    75| }
    76| ?><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    77|             "http://www.w3.org/TR/html4/loose.dtd">
    78| <html lang="en">
    79| <head>
    80| <title>whois.php -base classes to do whois queries with php</title>
    81| <style type="text/css">
    82| </style>
    83| </head>
    84| <body>
    85| <center>
    86| <h1>phpWhois - base class to do whois queries with php</h1>
    87| <p>
    88| &copy; 1999 - 2011 <a href="http://www.easydns.com/">easyDNS
    89| Technologies Inc.</a> &amp; <a href="http://mark.jeftovic.net/">Mark Jeftovic</a><br/>
    90| Now maintained and hosted by David Saez at <a href="http://www.ols.es">OLS 20000</a><br/>
    91| Placed under the GPL. See the LICENSE file in the distribution.
    92| </p>
    93| <table>
    94| <tr><td bgcolor="#55aaff">
    95| <form method="get" action="">
    96| <table>
    97| <tr><td colspan="3" align="center">
    98| <b>Enter any domain name, ip address or AS handle you would like to query whois for</b>
    99| <br/><br/>
   100| <input name="query" /> <input type="submit" value="Whois" /><br/>
   101| </td></tr>
   102| <tr>
   103| <td>
   104| <input type="radio" name="output" value="normal" /> Show me regular output<br/>
   105| <input type="radio" name="output" value="nice" checked="checked" /> Show me HTMLized output<br/>
   106| <input type="radio" name="output" value="object" /> Show me the returned PHP object
   107| </td>
   108| <td align="left" valign="top">
   109| <input type="checkbox" name="fast" value="1" /> Fast lookup
   110| </td>
   111| <td align="right" valign="bottom">
   112| <a href="http://www.phpwhois.org" title="phpWhois web page">
   113| <img border="0" src="whois.icon.png" alt="phpWhois web page" /></a>
   114| </td>
   115| </tr>
   116| </table>
   117| </form>
   118| </td></tr>
   119| </table>
   120| </center>
   121| <?php if (!empty($query)):?>
   122| <?php
   123| <p><b>Results for <?php echo $query?> :</b></p>
   124| <blockquote>
   125| <?php echo $winfo ?>
   126| </blockquote>
   127| <!--/results-->
   128| <?php endif ?>
   129| </body>
   130| </html>


# ====================================================================
# FILE: handler.template.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-32 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__XX_HANDLER__'))
    25|     define('__XX_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class xx_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         return $r;
    31|     }
    32| }


# ====================================================================
# FILE: poc.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-5 ---
     1| <?php
     2| require_once __DIR__ . '/vendor/autoload.php';
     3| $whois = new phpWhois\Whois;
     4| $whois->useServer('org', '127.0.0.1:9999');
     5| print_r($whois->lookup('example.org'));


# ====================================================================
# FILE: src/Cli/CliHelper.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /**
     3|  * @copyright Copyright (c) 2020 Joshua Smith
     4|  * @license   See LICENSE file
     5|  */
     6| namespace phpWhois\Cli;
     7| class CliHelper
     8| {
     9|     /**
    10|      * @param string $filename
    11|      *
    12|      * @return string[]
    13|      */
    14|     public function loadDomainList(string $filename): array
    15|     {
    16|         $lines   = file($filename);
    17|         $domains = [];
    18|         foreach ($lines as $line) {
    19|             $pos = strpos($line, '/');
    20|             if ($pos !== false) {
    21|                 $line = substr($line, 0, $pos);
    22|             }
    23|             $line = trim($line);
    24|             if ($line === '') {
    25|                 continue;
    26|             }
    27|             $parts = explode(' ', str_replace("\t", ' ', $line));
    28|             $key   = $parts[0];
    29|             for ($i = 1, $count = count($parts); $i < $count; $i++) {
    30|                 if ($parts[$i] !== '') {
    31|                     if ($key) {
    32|                         $domains[$key] = $parts[$i];
    33|                         $key           = false;
    34|                     } else {
    35|                         $domains[] = $parts[$i];
    36|                     }
    37|                 }
    38|             }
    39|         }
    40|         return $domains;
    41|     }
    42| }


# ====================================================================
# FILE: src/Handlers/AbstractHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-71 ---
     1| <?php
     2| /**
     3|  * @copyright Copyright (c) 2020 Joshua Smith
     4|  * @license   See LICENSE file
     5|  */
     6| namespace phpWhois\Handlers;
     7| require_once __DIR__ . '/../whois.parser.php';
     8| /**
     9|  * AbstractHandler
    10|  */
    11| abstract class AbstractHandler implements HandlerInterface
    12| {
    13|     public $deepWhois;
    14|     /**
    15|      * @param string[] $lines
    16|      *
    17|      * @return string[]
    18|      */
    19|     protected function removeBlankLines(array $lines): array
    20|     {
    21|         return array_filter(
    22|             $lines,
    23|             static function ($s) {
    24|                 return !empty($s);
    25|             }
    26|         );
    27|     }
    28|     protected function easy_parser(
    29|         $data_str,
    30|         $items,
    31|         $date_format,
    32|         $translate = [],
    33|         $has_org = false,
    34|         $partial_match = false,
    35|         $def_block = false
    36|     ) {
    37|         return easy_parser(
    38|             $data_str,
    39|             $items,
    40|             $date_format,
    41|             $translate,
    42|             $has_org,
    43|             $partial_match,
    44|             $def_block
    45|         );
    46|     }
    47|     protected function format_dates(&$res, $format = 'mdy')
    48|     {
    49|         return format_dates($res, $format);
    50|     }
    51|     protected function generic_parser_b($rawdata, $items = [], $dateformat = 'mdy', $hasreg = true, $scanall = false)
    52|     {
    53|         return generic_parser_b($rawdata, $items, $dateformat, $hasreg, $scanall);
    54|     }
    55|     protected function get_blocks($rawdata, $items, $partial_match = false, $def_block = false)
    56|     {
    57|         return get_blocks($rawdata, $items, $partial_match, $def_block);
    58|     }
    59|     protected function get_contacts($array, $extra_items = [], $has_org = false)
    60|     {
    61|         return get_contacts($array, $extra_items, $has_org);
    62|     }
    63|     protected function get_contact($array, $extra_items = [], $has_org = false)
    64|     {
    65|         return get_contact($array, $extra_items, $has_org);
    66|     }
    67|     protected function generic_parser_a($rawdata, $translate, $contacts, $main = 'domain', $dateformat = 'dmy')
    68|     {
    69|         return generic_parser_a($rawdata, $translate, $contacts, $main, $dateformat);
    70|     }
    71| }


# ====================================================================
# FILE: src/Handlers/AeHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-36 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class AeHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $items = [
    15|             'Domain Name:'                     => 'domain.name',
    16|             'Registrar Name:'                  => 'domain.sponsor',
    17|             'Status:'                          => 'domain.status',
    18|             'Registrant Contact ID:'           => 'owner.handle',
    19|             'Registrant Contact Name:'         => 'owner.name',
    20|             'Registrant Contact Organisation:' => 'owner.organization',
    21|             'Tech Contact Name:'               => 'tech.name',
    22|             'Tech Contact ID:'                 => 'tech.handle',
    23|             'Tech Contact Organisation:'       => 'tech.organization',
    24|             'Name Server:'                     => 'domain.nserver.',
    25|         ];
    26|         $r = [
    27|             'regrinfo' => $this->generic_parser_b($data_str['rawdata'], $items, 'ymd'),
    28|             'regyinfo' => [
    29|                 'referrer'  => 'http://www.nic.ae',
    30|                 'registrar' => 'UAENIC',
    31|             ],
    32|             'rawdata'  => $data_str['rawdata'],
    33|         ];
    34|         return $r;
    35|     }
    36| }


# ====================================================================
# FILE: src/Handlers/AeroHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-24 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class AeroHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $r = [
    15|             'regrinfo' => $this->generic_parser_b($data_str['rawdata'], [], 'ymd'),
    16|             'regyinfo' => [
    17|                 'referrer'  => 'http://www.nic.aero',
    18|                 'registrar' => 'Societe Internationale de Telecommunications Aeronautiques SC',
    19|             ],
    20|             'rawdata'  => $data_str['rawdata'],
    21|         ];
    22|         return $r;
    23|     }
    24| }


# ====================================================================
# FILE: src/Handlers/AgHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-24 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class AgHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $r = [
    15|             'regrinfo' => $this->generic_parser_b($data_str['rawdata']),
    16|             'regyinfo' => [
    17|                 'referrer'  => 'http://www.nic.ag',
    18|                 'registrar' => 'Nic AG',
    19|             ],
    20|             'rawdata'  => $data_str['rawdata'],
    21|         ];
    22|         return $r;
    23|     }
    24| }


# ====================================================================
# FILE: src/Handlers/AmHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class AmHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $items = [
    15|             'owner'          => 'Registrant:',
    16|             'domain.name'    => 'Domain name:',
    17|             'domain.created' => 'Registered:',
    18|             'domain.changed' => 'Last modified:',
    19|             'domain.nserver' => 'DNS servers:',
    20|             'domain.status'  => 'Status:',
    21|             'tech'           => 'Technical contact:',
    22|             'admin'          => 'Administrative contact:',
    23|         ];
    24|         $rawData = $this->removeBlankLines($data_str['rawdata']);
    25|         $r = [
    26|             'regrinfo' => $this->get_blocks($rawData, $items),
    27|             'rawdata' => $data_str['rawdata'],
    28|         ];
    29|         if (!empty($r['regrinfo']['domain']['name'])) {
    30|             $r['regrinfo']               = $this->get_contacts($r['regrinfo']);
    31|             $r['regrinfo']['registered'] = 'yes';
    32|         } else {
    33|             $r                           = [];
    34|             $r['regrinfo']['registered'] = 'no';
    35|         }
    36|         $r['regyinfo'] = [
    37|             'referrer'  => 'http://www.isoc.am',
    38|             'registrar' => 'ISOCAM',
    39|         ];
    40|         return $r;
    41|     }
    42| }


# ====================================================================
# FILE: src/Handlers/AppHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-17 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (c) 2020 Joshua Smith
     5|  */
     6| namespace phpWhois\Handlers;
     7| class AppHandler extends AbstractHandler
     8| {
     9|     public function parse(array $data_str, string $query): array
    10|     {
    11|         $r = [
    12|             'regrinfo' => $this->generic_parser_b($data_str['rawdata']),
    13|             'rawdata'  => $data_str['rawdata'],
    14|         ];
    15|         return $r;
    16|     }
    17| }


# ====================================================================
# FILE: src/Handlers/AsiaHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-24 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class AsiaHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $r = [
    15|             'regrinfo' => $this->generic_parser_b($data_str['rawdata']),
    16|             'regyinfo' => [
    17|                 'referrer'  => 'http://www.dotasia.org/',
    18|                 'registrar' => 'DotAsia',
    19|             ],
    20|             'rawdata'  => $data_str['rawdata'],
    21|         ];
    22|         return $r;
    23|     }
    24| }


# ====================================================================
# FILE: src/Handlers/AtHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-69 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class AtHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $translate = [
    15|             'fax-no'         => 'fax',
    16|             'e-mail'         => 'email',
    17|             'nic-hdl'        => 'handle',
    18|             'person'         => 'name',
    19|             'personname'     => 'name',
    20|             'street address' => 'address.street',
    21|             'city'           => 'address.city',
    22|             'postal code'    => 'address.pcode',
    23|             'country'        => 'address.country',
    24|         ];
    25|         $contacts = [
    26|             'registrant' => 'owner',
    27|             'admin-c'    => 'admin',
    28|             'tech-c'     => 'tech',
    29|             'billing-c'  => 'billing',
    30|             'zone-c'     => 'zone',
    31|         ];
    32|         $reg = $this->generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    33|         if (isset($reg['domain']['remarks'])) {
    34|             unset($reg['domain']['remarks']);
    35|         }
    36|         if (isset($reg['domain']['descr'])) {
    37|             foreach ($reg['domain']['descr'] as $key => $val) {
    38|                 $v = trim(substr(strstr($val, ':'), 1));
    39|                 if (strstr($val, '[organization]:')) {
    40|                     $reg['owner']['organization'] = $v;
    41|                     continue;
    42|                 }
    43|                 if (strstr($val, '[phone]:')) {
    44|                     $reg['owner']['phone'] = $v;
    45|                     continue;
    46|                 }
    47|                 if (strstr($val, '[fax-no]:')) {
    48|                     $reg['owner']['fax'] = $v;
    49|                     continue;
    50|                 }
    51|                 if (strstr($val, '[e-mail]:')) {
    52|                     $reg['owner']['email'] = $v;
    53|                     continue;
    54|                 }
    55|                 $reg['owner']['address'][$key] = $v;
    56|             }
    57|             unset($reg['domain']['descr']);
    58|         }
    59|         $r = [
    60|             'regrinfo' => $reg,
    61|             'regyinfo' => [
    62|                 'referrer'  => 'http://www.nic.at',
    63|                 'registrar' => 'NIC-AT',
    64|             ],
    65|             'rawdata'  => $data_str['rawdata'],
    66|         ];
    67|         return $r;
    68|     }
    69| }


# ====================================================================
# FILE: src/Handlers/AuHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-39 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class AuHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $items = [
    15|             'Domain Name:'              => 'domain.name',
    16|             'Last Modified:'            => 'domain.changed',
    17|             'Registrar Name:'           => 'domain.sponsor',
    18|             'Status:'                   => 'domain.status',
    19|             'Domain ROID:'              => 'domain.handle',
    20|             'Registrant:'               => 'owner.organization',
    21|             'Registrant Contact ID:'    => 'owner.handle',
    22|             'Registrant Contact Email:' => 'owner.email',
    23|             'Registrant Contact Name:'  => 'owner.name',
    24|             'Tech Contact Name:'        => 'tech.name',
    25|             'Tech Contact Email:'       => 'tech.email',
    26|             'Tech Contact ID:'          => 'tech.handle',
    27|             'Name Server:'              => 'domain.nserver.',
    28|         ];
    29|         $r = [
    30|             'regrinfo' => $this->generic_parser_b($data_str['rawdata'], $items),
    31|             'regyinfo' => [
    32|                 'referrer'  => 'http://www.aunic.net',
    33|                 'registrar' => 'AU-NIC',
    34|             ],
    35|             'rawdata'  => $data_str['rawdata'],
    36|         ];
    37|         return $r;
    38|     }
    39| }


# ====================================================================
# FILE: src/Handlers/BeHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-52 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class BeHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $items = [
    15|             'domain.name'    => 'Domain:',
    16|             'domain.status'  => 'Status:',
    17|             'domain.nserver' => 'Nameservers:',
    18|             'domain.created' => 'Registered:',
    19|             'owner'          => 'Licensee:',
    20|             'admin'          => 'Onsite Contacts:',
    21|             'tech'           => 'Registrar Technical Contacts:',
    22|             'agent'          => 'Registrar:',
    23|             'agent.uri'      => 'Website:',
    24|         ];
    25|         $trans = [
    26|             'company name2:' => '',
    27|         ];
    28|         $rawData = $this->removeBlankLines($data_str['rawdata']);
    29|         $r       = [
    30|             'regrinfo' => $this->get_blocks($rawData, $items),
    31|             'regyinfo' => [
    32|                 'referrer'  => 'http://www.domain-registry.nl',
    33|                 'registrar' => 'DNS Belgium',
    34|             ],
    35|             'rawdata'  => $data_str['rawdata'],
    36|         ];
    37|         $domainStatus = $r['regrinfo']['domain']['status'] ;
    38|         if ($domainStatus === 'REGISTERED' || $domainStatus === 'NOT AVAILABLE') {
    39|             $r['regrinfo']['registered'] = 'yes';
    40|             $r['regrinfo'] = $this->get_contacts($r['regrinfo'], $trans);
    41|             if (isset($r['regrinfo']['agent'])) {
    42|                 $sponsor = $this->get_contact($r['regrinfo']['agent'], $trans);
    43|                 unset($r['regrinfo']['agent']);
    44|                 $r['regrinfo']['domain']['sponsor'] = $sponsor;
    45|             }
    46|             $r = $this->format_dates($r, '-mdy');
    47|         } else {
    48|             $r['regrinfo']['registered'] = 'no';
    49|         }
    50|         return $r;
    51|     }
    52| }


# ====================================================================
# FILE: src/Handlers/BhHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-29 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class BhHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $r = [
    15|             'regrinfo' => $this->generic_parser_b($data_str['rawdata']),
    16|             'rawdata'  => $data_str['rawdata'],
    17|         ];
    18|         if (empty($r['regrinfo']['domain']['created'])) {
    19|             $r['regrinfo']['registered'] = 'no';
    20|         } else {
    21|             $r['regrinfo']['registered'] = 'yes';
    22|         }
    23|         $r['regyinfo'] = [
    24|             'referrer'  => 'http://www.nic.bh/',
    25|             'registrar' => 'NIC-BH',
    26|         ];
    27|         return $r;
    28|     }
    29| }


# ====================================================================
# FILE: src/Handlers/BizHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-24 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class BizHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $r = [
    15|             'regrinfo' => $this->generic_parser_b($data_str['rawdata'], [], 'mdy'),
    16|             'regyinfo' => [
    17|                 'referrer'  => 'http://www.neulevel.biz',
    18|                 'registrar' => 'NEULEVEL',
    19|             ],
    20|             'rawdata'  => $data_str['rawdata'],
    21|         ];
    22|         return $r;
    23|     }
    24| }


# ====================================================================
# FILE: src/Handlers/BrHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-63 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class BrHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $translate = [
    15|             'fax-no'     => 'fax',
    16|             'e-mail'     => 'email',
    17|             'nic-hdl-br' => 'handle',
    18|             'person'     => 'name',
    19|             'netname'    => 'name',
    20|             'domain'     => 'name',
    21|             'updated'    => '',
    22|         ];
    23|         $contacts = [
    24|             'owner-c'   => 'owner',
    25|             'tech-c'    => 'tech',
    26|             'admin-c'   => 'admin',
    27|             'billing-c' => 'billing',
    28|         ];
    29|         $r = $this->generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    30|         if (in_array('Permission denied.', $r['disclaimer'])) {
    31|             $r['registered'] = 'unknown';
    32|             return $r;
    33|         }
    34|         if (isset($r['domain']['nsstat'])) {
    35|             unset($r['domain']['nsstat']);
    36|         }
    37|         if (isset($r['domain']['nslastaa'])) {
    38|             unset($r['domain']['nslastaa']);
    39|         }
    40|         if (isset($r['domain']['owner'])) {
    41|             $r['owner']['organization'] = $r['domain']['owner'];
    42|             unset($r['domain']['owner']);
    43|         }
    44|         if (isset($r['domain']['responsible'])) {
    45|             unset($r['domain']['responsible']);
    46|         }
    47|         if (isset($r['domain']['address'])) {
    48|             unset($r['domain']['address']);
    49|         }
    50|         if (isset($r['domain']['phone'])) {
    51|             unset($r['domain']['phone']);
    52|         }
    53|         $a = [
    54|             'regrinfo' => $r,
    55|             'regyinfo' => [
    56|                 'registrar' => 'BR-NIC',
    57|                 'referrer'  => 'http://www.nic.br',
    58|             ],
    59|             'rawdata'  => $data_str['rawdata'],
    60|         ];
    61|         return $a;
    62|     }
    63| }


# ====================================================================
# FILE: src/Handlers/ClHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class ClHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $items = [
    15|             'admin'          => '(Administrative Contact)',
    16|             'tech'           => 'Contacto Técnico (Technical Contact):',
    17|             'domain.nserver' => 'Name server:',
    18|             'domain.changed' => '(Database last updated on):',
    19|             'domain.created' => 'Creation date:',
    20|             'domain.expires' => 'Expiration date:',
    21|         ];
    22|         $trans = [
    23|             'organización:' => 'organization',
    24|             'nombre      :' => 'name',
    25|         ];
    26|         $rawData = $this->removeBlankLines($data_str['rawdata']);
    27|         $r       = [
    28|             'rawdata'  => $data_str['rawdata'],
    29|             'regrinfo' => $this->easy_parser($rawData, $items, 'd-m-y', $trans),
    30|         ];
    31|         if (!isset($r['regrinfo']['domain']['name'])) {
    32|             $r['regrinfo']['domain']['name'] = $query;
    33|         }
    34|         $r['regyinfo'] = [
    35|             'referrer'  => 'http://www.nic.cl',
    36|             'registrar' => 'NIC Chile',
    37|         ];
    38|         return $r;
    39|     }
    40| }


# ====================================================================
# FILE: src/Handlers/DeHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-53 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class DeHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $items = [
    15|             'domain.name'      => 'Domain:',
    16|             'domain.nserver.'  => 'Nserver:',
    17|             'domain.nserver.#' => 'Nsentry:',
    18|             'domain.status'    => 'Status:',
    19|             'domain.changed'   => 'Changed:',
    20|             'domain.desc.'     => 'Descr:',
    21|             'owner'            => '[Holder]',
    22|             'admin'            => '[Admin-C]',
    23|             'tech'             => '[Tech-C]',
    24|             'zone'             => '[Zone-C]',
    25|         ];
    26|         $extra = [
    27|             'city:'        => 'address.city',
    28|             'postalcode:'  => 'address.pcode',
    29|             'countrycode:' => 'address.country',
    30|             'remarks:'     => '',
    31|             'sip:'         => 'sip',
    32|             'type:'        => '',
    33|         ];
    34|         $rawData = $this->removeBlankLines($data_str['rawdata']);
    35|         $r       = [
    36|             'rawdata'  => $data_str['rawdata'],
    37|             'regrinfo' => $this->easy_parser($rawData, $items, 'ymd', $extra),
    38|             'regyinfo' => [
    39|                 'registrar' => 'DENIC eG',
    40|                 'referrer'  => 'http://www.denic.de/',
    41|             ],
    42|         ];
    43|         if (!isset($r['regrinfo']['domain']['status']) || $r['regrinfo']['domain']['status'] === 'free') {
    44|             $r['regrinfo']['registered'] = 'no';
    45|         } else {
    46|             if (isset($r['regrinfo']['domain']['changed'])) {
    47|                 $r['regrinfo']['domain']['changed'] = substr($r['regrinfo']['domain']['changed'], 0, 10);
    48|             }
    49|             $r['regrinfo']['registered'] = 'yes';
    50|         }
    51|         return $r;
    52|     }
    53| }


# ====================================================================
# FILE: src/Handlers/EduHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class EduHandler extends AbstractHandler
    11| {
    12|     public function parse(array $data_str, string $query): array
    13|     {
    14|         $items = [
    15|             'domain.name'    => 'Domain name:',
    16|             'domain.sponsor' => 'Registrar:',
    17|             'domain.nserver' => 'Name Servers:',
    18|             'domain.changed' => 'Domain record last updated:',
    19|             'domain.created' => 'Domain record activated:',
    20|             'domain.expires' => 'Domain expires:',
    21|             'owner'          => 'Registrant:',
    22|             'admin'          => 'Administrative Contact:',
    23|             'tech'           => 'Technical Contact:',
    24|             'billing'        => 'Billing Contact:',
    25|         ];
    26|         $rawData = $this->removeBlankLines($data_str['rawdata']);
    27|         $r = [
    28|             'rawdata'  => $data_str['rawdata'],
    29|             'regrinfo' => $this->easy_parser($rawData, $items, 'dmy'),
    30|         ];
    31|         if (isset($b['tech'])) {
    32|             if ($r['regrinfo']['tech']['name'] === 'Same as above') {
    33|                 $r['regrinfo']['tech'] = $r['regrinfo']['admin'];
    34|             }
    35|         }
    36|         if (!isset($r['regrinfo']['domain']['name'])) {
    37|             $r['regrinfo']['domain']['name'] = $query;
    38|         }
    39|         $r['regyinfo']['referrer']  = 'http://whois.educause.net';
    40|         $r['regyinfo']['registrar'] = 'EDUCASE';
    41|         return $r;
    42|     }
    43| }


# ====================================================================
# FILE: src/Handlers/HandlerInterface.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-19 ---
     1| <?php
     2| /**
     3|  * @copyright Copyright (c) 2020 Joshua Smith
     4|  * @license   See LICENSE file
     5|  */
     6| namespace phpWhois\Handlers;
     7| /**
     8|  * HandlerInterface
     9|  */
    10| interface HandlerInterface
    11| {
    12|     /**
    13|      * @param array $data_str
    14|      * @param string $query
    15|      *
    16|      * @return array
    17|      */
    18|     public function parse(array $data_str, string $query): array;
    19| }


# ====================================================================
# FILE: src/Handlers/UkHandler.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-60 ---
     1| <?php
     2| /**
     3|  * @license   See LICENSE file
     4|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
     5|  * @copyright Maintained by David Saez
     6|  * @copyright Copyright (c) 2014 Dmitry Lukashin
     7|  * @copyright Copyright (c) 2020 Joshua Smith
     8|  */
     9| namespace phpWhois\Handlers;
    10| class UkHandler extends AbstractHandler
    11| {
    12|     const ITEMS = [
    13|         'owner.organization' => 'Registrant:',
    14|         'owner.address'      => "Registrant's address:",
    15|         'owner.type'         => 'Registrant type:',
    16|         'domain.created'     => 'Registered on:',
    17|         'domain.changed'     => 'Last updated:',
    18|         'domain.expires'     => 'Expiry date:',
    19|         'domain.nserver'     => 'Name servers:',
    20|         'domain.sponsor'     => 'Registrar:',
    21|         'domain.status'      => 'Registration status:',
    22|         'domain.dnssec'      => 'DNSSEC:',
    23|         ''                   => 'WHOIS lookup made at',
    24|         'disclaimer'         => '--',
    25|     ];
    26|     /**
    27|      * @param array  $data_str
    28|      * @param string $query
    29|      *
    30|      * @return array
    31|      */
    32|     public function parse(array $data_str, string $query): array
    33|     {
    34|         $rawData = $this->removeBlankLines($data_str['rawdata']);
    35|         $r       = [
    36|             'regrinfo' => $this->get_blocks($rawData, static::ITEMS),
    37|         ];
    38|         if (isset($r['regrinfo']['owner'])) {
    39|             $r['regrinfo']['owner']['organization'] = $r['regrinfo']['owner']['organization'][0];
    40|             $r['regrinfo']['domain']['sponsor']     = $r['regrinfo']['domain']['sponsor'][0];
    41|             $r['regrinfo']['registered']            = 'yes';
    42|         } else {
    43|             if (strpos($data_str['rawdata'][1], 'Error for ')) {
    44|                 $r['regrinfo']['registered']       = 'yes';
    45|                 $r['regrinfo']['domain']['status'] = 'invalid';
    46|             } else {
    47|                 $r['regrinfo']['registered'] = 'no';
    48|             }
    49|         }
    50|         $r = $this->format_dates($r, 'dmy');
    51|         $r['regyinfo'] = [
    52|             'referrer'  => 'http://www.nominet.org.uk',
    53|             'registrar' => 'Nominet UK',
    54|         ];
    55|         if (!array_key_exists('rawdata', $r) && array_key_exists('rawdata', $data_str)) {
    56|             $r['rawdata'] = $data_str['rawdata'];
    57|         }
    58|         return $r;
    59|     }
    60| }


# ====================================================================
# FILE: src/IpTools.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-155 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| namespace phpWhois;
    25| /**
    26|  * Utilities for parsing ip addresses
    27|  */
    28| class IpTools
    29| {
    30|     /**
    31|      * Check if ip address is valid
    32|      *
    33|      * @param string $ip IP address for validation
    34|      * @param string $type Type of ip address. Possible value are: any, ipv4, ipv6
    35|      * @param boolean $strict If true - fail validation on reserved and private ip ranges
    36|      *
    37|      * @return boolean True if ip is valid. False otherwise
    38|      */
    39|     public function validIp($ip, $type = 'any', $strict = true)
    40|     {
    41|         switch ($type) {
    42|             case 'any':
    43|                 return $this->validIpv4($ip, $strict) || $this->validIpv6($ip, $strict);
    44|                 break;
    45|             case 'ipv4':
    46|                 return $this->validIpv4($ip, $strict);
    47|                 break;
    48|             case 'ipv6':
    49|                 return $this->validIpv6($ip, $strict);
    50|                 break;
    51|         }
    52|         return false;
    53|     }
    54|     /**
    55|      * Check if given IP is valid ipv4 address and doesn't belong to private and
    56|      * reserved ranges
    57|      *
    58|      * @param string $ip Ip address
    59|      * @param boolean $strict If true - fail validation on reserved and private ip ranges
    60|      *
    61|      * @return boolean
    62|      */
    63|     public function validIpv4($ip, $strict = true)
    64|     {
    65|         $flags = FILTER_FLAG_IPV4;
    66|         if ($strict) {
    67|             $flags = FILTER_FLAG_IPV4 | FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE;
    68|         }
    69|         if (filter_var($ip, FILTER_VALIDATE_IP, array('flags' => $flags)) !== false) {
    70|             return true;
    71|         }
    72|         return false;
    73|     }
    74|     /**
    75|      * Check if given IP is valid ipv6 address and doesn't belong to private ranges
    76|      *
    77|      * @param string $ip Ip address
    78|      * @param boolean $strict If true - fail validation on reserved and private ip ranges
    79|      *
    80|      * @return boolean
    81|      */
    82|     public function validIpv6($ip, $strict = true)
    83|     {
    84|         $flags = FILTER_FLAG_IPV6;
    85|         if ($strict) {
    86|             $flags = FILTER_FLAG_IPV6 | FILTER_FLAG_NO_PRIV_RANGE;
    87|         }
    88|         if (filter_var($ip, FILTER_VALIDATE_IP, array('flags' => $flags)) !== false) {
    89|             return true;
    90|         }
    91|         return false;
    92|     }
    93|     /**
    94|      * Try to get real IP from client web request
    95|      *
    96|      * @return string
    97|      */
    98|     public function getClientIp()
    99|     {
   100|         if (!empty($_SERVER['HTTP_CLIENT_IP']) && $this->validIp($_SERVER['HTTP_CLIENT_IP'])) {
   101|             return $_SERVER['HTTP_CLIENT_IP'];
   102|         }
   103|         if (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) {
   104|             foreach (explode(',', $_SERVER['HTTP_X_FORWARDED_FOR']) as $ip) {
   105|                 if ($this->validIp(trim($ip))) {
   106|                     return trim($ip);
   107|                 }
   108|             }
   109|         }
   110|         if (!empty($_SERVER['HTTP_X_FORWARDED']) && $this->validIp($_SERVER['HTTP_X_FORWARDED'])) {
   111|             return $_SERVER['HTTP_X_FORWARDED'];
   112|         }
   113|         if (!empty($_SERVER['HTTP_FORWARDED_FOR']) && $this->validIp($_SERVER['HTTP_FORWARDED_FOR'])) {
   114|             return $_SERVER['HTTP_FORWARDED_FOR'];
   115|         }
   116|         if (!empty($_SERVER['HTTP_FORWARDED']) && $this->validIp($_SERVER['HTTP_FORWARDED'])) {
   117|             return $_SERVER['HTTP_FORWARDED'];
   118|         }
   119|         return $_SERVER['REMOTE_ADDR'];
   120|     }
   121|     /**
   122|      * Convert CIDR to net range
   123|      *
   124|      * @TODO provide example
   125|      *
   126|      * @param string $net
   127|      * @return string
   128|      */
   129|     public function cidrConv($net)
   130|     {
   131|         $start = strtok($net, '/');
   132|         $n = 3 - substr_count($net, '.');
   133|         if ($n > 0) {
   134|             for ($i = $n; $i > 0; $i--) {
   135|                 $start .= '.0';
   136|             }
   137|         }
   138|         $bits1 = str_pad(decbin(ip2long($start)), 32, '0', 'STR_PAD_LEFT');
   139|         $net = pow(2, (32 - substr(strstr($net, '/'), 1))) - 1;
   140|         $bits2 = str_pad(decbin($net), 32, '0', 'STR_PAD_LEFT');
   141|         $final = '';
   142|         for ($i = 0; $i < 32; $i++) {
   143|             if ($bits1[$i] == $bits2[$i]) {
   144|                 $final .= $bits1[$i];
   145|             }
   146|             if ($bits1[$i] == 1 and $bits2[$i] == 0) {
   147|                 $final .= $bits1[$i];
   148|             }
   149|             if ($bits1[$i] == 0 and $bits2[$i] == 1) {
   150|                 $final .= $bits2[$i];
   151|             }
   152|         }
   153|         return $start . " - " . long2ip(bindec($final));
   154|     }
   155| }


# ====================================================================
# FILE: src/Utils.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-135 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| namespace phpWhois;
    25| /**
    26|  * Additional utils
    27|  */
    28| class Utils extends Whois
    29| {
    30|     /**
    31|      * Wrap result in <pre></pre> tags
    32|      * @param $obj
    33|      * @return string
    34|      */
    35|     public function showObject(&$obj)
    36|     {
    37|         $r = $this->debugObject($obj);
    38|         return "<pre>$r</pre>\n";
    39|     }
    40|     /**
    41|      * Return object or array as formatted string
    42|      * @param $obj
    43|      * @param int $indent
    44|      * @return string
    45|      */
    46|     public function debugObject($obj, $indent = 0)
    47|     {
    48|         if (is_array($obj)) {
    49|             $return = '';
    50|             foreach ($obj as $k => $v) {
    51|                 $return .= str_repeat('&nbsp;', $indent);
    52|                 if (is_array($v)) {
    53|                     $return .= $k . "->Array\n";
    54|                     $return .= $this->debugObject($v, $indent + 1);
    55|                 } else {
    56|                     $return .= $k . "->$v\n";
    57|                 }
    58|             }
    59|             return $return;
    60|         }
    61|     }
    62|     public function nsRrDefined($query)
    63|     {
    64|         return checkdnsrr($query, 'NS');
    65|     }
    66|     /**
    67|      * Get nice HTML output
    68|      */
    69|     public function showHTML($result, $link_myself = true, $params = 'query=$0&amp;output=nice')
    70|     {
    71|         $email_regex = "/([-_\w\.]+)(@)([-_\w\.]+)\b/i";
    72|         $html_regex = "/(?:^|\b)((((http|https|ftp):\/\/)|(www\.))([\w\.]+)([,:%#&\/?~=\w+\.-]+))(?:\b|$)/is";
    73|         $ip_regex = "/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/i";
    74|         $out = '';
    75|         $lempty = true;
    76|         foreach ($result['rawdata'] as $line) {
    77|             $line = trim($line);
    78|             if ($line == '') {
    79|                 if ($lempty) {
    80|                     continue;
    81|                 } else {
    82|                     $lempty = true;
    83|                 }
    84|             } else {
    85|                 $lempty = false;
    86|             }
    87|             $out .= $line . "\n";
    88|         }
    89|         if ($lempty) {
    90|             $out = trim($out);
    91|         }
    92|         $out = strip_tags($out);
    93|         $out = preg_replace($email_regex, '<a href="mailto:$0">$0</a>', $out);
    94|         $out = preg_replace_callback(
    95|             $html_regex,
    96|             function ($matches) {
    97|                 if (substr($matches[0], 0, 4) == 'www.') {
    98|                     $web = $matches[0];
    99|                     $url = 'http://' . $web;
   100|                 } else {
   101|                     $web = $matches[0];
   102|                     $url = $web;
   103|                 }
   104|                 return '<a href="' . $url . '" target="_blank">' . $web . '</a>';
   105|             },
   106|             $out
   107|         );
   108|         if ($link_myself) {
   109|             if ($params[0] == '/') {
   110|                 $link = $params;
   111|             } else {
   112|                 $link = $_SERVER['PHP_SELF'] . '?' . $params;
   113|             }
   114|             $out = preg_replace($ip_regex, '<a href="' . $link . '">$0</a>', $out);
   115|             if (isset($result['regrinfo']['domain']['nserver'])) {
   116|                 $nserver = $result['regrinfo']['domain']['nserver'];
   117|             } else {
   118|                 $nserver = false;
   119|             }
   120|             if (isset($result['regrinfo']['network']['nserver'])) {
   121|                 $nserver = $result['regrinfo']['network']['nserver'];
   122|             }
   123|             if (is_array($nserver)) {
   124|                 foreach ($nserver as $host => $ip) {
   125|                     $url = '<a href="' . str_replace('$0', $ip, $link) . "\">$host</a>";
   126|                     $out = str_replace($host, $url, $out);
   127|                     $out = str_replace(strtoupper($host), $url, $out);
   128|                 }
   129|             }
   130|         }
   131|         $out = preg_replace("/(?m)^([-\s\.&;'\w\t\(\)\/]+:\s*)/", '<b>$1</b>', $out);
   132|         $out = preg_replace("/(?m)^(%.*)/", '<i>$0</i>', $out);
   133|         return str_replace("\n", "<br/>\n", $out);
   134|     }
   135| }


# ====================================================================
# FILE: src/Whois.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-283 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| namespace phpWhois;
    25| use Algo26\IdnaConvert\IdnaConvert;
    26| /**
    27|  * phpWhois main class
    28|  *
    29|  * This class supposed to be instantiated for using the phpWhois library
    30|  */
    31| class Whois extends WhoisClient
    32| {
    33|     /** @var boolean Deep whois? */
    34|     public $deepWhois = true;
    35|     /** @inheritdoc */
    36|     public $gtldRecurse = true;
    37|     /** @var array Query array */
    38|     public $query = array();
    39|     /** @var string Network Solutions registry server */
    40|     public $nsiRegistry = 'whois.nsiregistry.net';
    41|     const QTYPE_UNKNOWN = 0;
    42|     const QTYPE_DOMAIN  = 1;
    43|     const QTYPE_IPV4    = 2;
    44|     const QTYPE_IPV6    = 3;
    45|     const QTYPE_AS      = 4;
    46|     /**
    47|      * Use special whois server (Populate WHOIS_SPECIAL array)
    48|      *
    49|      * @param string $tld Top-level domain
    50|      * @param string $server Server address
    51|      */
    52|     public function useServer($tld, $server)
    53|     {
    54|         $this->WHOIS_SPECIAL[$tld] = $server;
    55|     }
    56|     /**
    57|      *  Lookup query and return raw whois data
    58|      *
    59|      * @param string $query Domain name or other entity
    60|      * @param boolean $is_utf True if domain name encoding is utf-8 already, otherwise convert it with utf8_encode() first
    61|      *
    62|      */
    63|     public function whois($domain, $is_utf = true)
    64|     {
    65|         $lookup = $this->lookup($domain, $is_utf);
    66|         return implode(PHP_EOL, $lookup['rawdata']);
    67|     }
    68|     /**
    69|      *  Lookup query
    70|      *
    71|      * @param string $query Domain name or other entity
    72|      * @param boolean $is_utf True if domain name encoding is utf-8 already, otherwise convert it with utf8_encode() first
    73|      *
    74|      */
    75|     public function lookup($query = '', $is_utf = true)
    76|     {
    77|         $this->query = array('status' => '');
    78|         $query = trim($query);
    79|         $idn = new IdnaConvert();
    80|         if ($is_utf) {
    81|             $query = $idn->encode($query);
    82|         } else {
    83|             $query = $idn->encode(utf8_encode($query));
    84|         }
    85|         if (!isset($query) || $query == '') {
    86|             $this->query['server'] = $this->nsiRegistry;
    87|             return;
    88|         }
    89|         $this->query['query'] = $domain = $query = strtolower($query);
    90|         $qType = $this->getQueryType($query);
    91|         switch ($qType) {
    92|             case self::QTYPE_IPV4:
    93|                 $ip = @gethostbyname($query);
    94|                 if (isset($this->WHOIS_SPECIAL['ip'])) {
    95|                     $this->query['server'] = $this->WHOIS_SPECIAL['ip'];
    96|                     $this->query['args'] = $ip;
    97|                 } else {
    98|                     $this->query['server'] = 'whois.arin.net';
    99|                     $this->query['args'] = "n $ip";
   100|                     $this->query['file'] = 'whois.ip.php';
   101|                     $this->query['handler'] = 'ip';
   102|                 }
   103|                 $this->query['host_ip'] = $ip;
   104|                 $this->query['query'] = $ip;
   105|                 $this->query['tld'] = 'ip';
   106|                 $this->query['host_name'] = @gethostbyaddr($ip);
   107|                 return $this->getData('', $this->deepWhois);
   108|                 break;
   109|             case self::QTYPE_IPV6:
   110|                 $ip = @gethostbyname($query);
   111|                 if (isset($this->WHOIS_SPECIAL['ip'])) {
   112|                     $this->query['server'] = $this->WHOIS_SPECIAL['ip'];
   113|                 } else {
   114|                     $this->query['server'] = 'whois.ripe.net';
   115|                     $this->query['file'] = 'whois.ip.ripe.php';
   116|                     $this->query['handler'] = 'ripe';
   117|                 }
   118|                 $this->query['query'] = $ip;
   119|                 $this->query['tld'] = 'ip';
   120|                 return $this->getData('', $this->deepWhois);
   121|                 break;
   122|             case self::QTYPE_AS:
   123|                 $ip = @gethostbyname($query);
   124|                 $this->query['server'] = 'whois.arin.net';
   125|                 if (strtolower(substr($ip, 0, 2)) == 'as') {
   126|                     $as = substr($ip, 2);
   127|                 } else {
   128|                     $as = $ip;
   129|                 }
   130|                 $this->query['args'] = "a $as";
   131|                 $this->query['file'] = 'whois.ip.php';
   132|                 $this->query['handler'] = 'ip';
   133|                 $this->query['query'] = $ip;
   134|                 $this->query['tld'] = 'as';
   135|                 return $this->getData('', $this->deepWhois);
   136|                 break;
   137|         }
   138|         $tld = '';
   139|         $server = '';
   140|         $dp = explode('.', $domain);
   141|         $np = count($dp) - 1;
   142|         $tldtests = array();
   143|         for ($i = 0; $i < $np; $i++) {
   144|             array_shift($dp);
   145|             $tldtests[] = implode('.', $dp);
   146|         }
   147|         $special_tlds = $this->WHOIS_SPECIAL;
   148|         foreach ($tldtests as $tld) {
   149|             if (isset($special_tlds[$tld])) {
   150|                 $val = $special_tlds[$tld];
   151|                 if ($val == '') {
   152|                     return $this->unknown();
   153|                 }
   154|                 $domain = substr($query, 0, -strlen($tld) - 1);
   155|                 $val = str_replace('{domain}', $domain, $val);
   156|                 $server = str_replace('{tld}', $tld, $val);
   157|                 break;
   158|             }
   159|         }
   160|         if ($server == '') {
   161|             foreach ($tldtests as $tld) {
   162|                 $cname = $tld . '.whois-servers.net';
   163|                 if (gethostbyname($cname) == $cname) {
   164|                     continue;
   165|                 }
   166|                 $server = $tld . '.whois-servers.net';
   167|                 break;
   168|             }
   169|         }
   170|         if ($tld && $server) {
   171|             $this->query['server'] = $server;
   172|             $this->query['tld'] = $tld;
   173|             $handler = '';
   174|             foreach ($tldtests as $htld) {
   175|                 if (isset($this->DATA[$htld])) {
   176|                     $handler = $this->DATA[$htld];
   177|                     break;
   178|                 }
   179|                 if (file_exists(__DIR__ . '/whois.' . $htld . '.php')) {
   180|                     $handler = $htld;
   181|                     break;
   182|                 }
   183|             }
   184|             if ($handler != '') {
   185|                 $this->query['file'] = "whois.$handler.php";
   186|                 $this->query['handler'] = $handler;
   187|             }
   188|             if (isset($this->WHOIS_PARAM[$server])) {
   189|                 $param = $this->WHOIS_PARAM[$server];
   190|                 $param = str_replace('$domain', $domain, $param);
   191|                 $param = str_replace('$tld', $tld, $param);
   192|                 $this->query['server'] = $this->query['server'] . '?' . $param;
   193|             }
   194|             $result = $this->getData('', $this->deepWhois);
   195|             $this->checkDns($result);
   196|             return $result;
   197|         }
   198|         return $this->unknown();
   199|     }
   200|     /**
   201|      * Unsupported domains
   202|      */
   203|     public function unknown()
   204|     {
   205|         unset($this->query['server']);
   206|         $this->query['status'] = 'error';
   207|         $result = array('rawdata' => array());
   208|         $result['rawdata'][] = $this->query['errstr'][] = $this->query['query'] . ' domain is not supported';
   209|         $this->checkDns($result);
   210|         $this->fixResult($result, $this->query['query']);
   211|         return $result;
   212|     }
   213|     /**
   214|      * Get nameservers if missing
   215|      */
   216|     public function checkDns(&$result)
   217|     {
   218|         if ($this->deepWhois && empty($result['regrinfo']['domain']['nserver'])) {
   219|             $ns = @dns_get_record($this->query['query'], DNS_NS);
   220|             if (!is_array($ns)) {
   221|                 return;
   222|             }
   223|             $nserver = array();
   224|             foreach ($ns as $row) {
   225|                 $nserver[] = $row['target'];
   226|             }
   227|             if (count($nserver) > 0) {
   228|                 $result['regrinfo']['domain']['nserver'] = $this->fixNameServer($nserver);
   229|             }
   230|         }
   231|     }
   232|     /**
   233|      *  Fix and/or add name server information
   234|      */
   235|     public function fixResult(&$result, $domain)
   236|     {
   237|         $result['regrinfo']['domain']['name'] = $domain;
   238|         if (!isset($result['regrinfo']['registered'])) {
   239|             if (function_exists('checkdnsrr') && checkdnsrr($domain, 'NS')) {
   240|                 $result['regrinfo']['registered'] = 'yes';
   241|             } else {
   242|                 $result['regrinfo']['registered'] = 'unknown';
   243|             }
   244|         }
   245|         if (isset($result['regrinfo']['domain']['nserver'])) {
   246|             if (!is_array($result['regrinfo']['domain']['nserver'])) {
   247|                 unset($result['regrinfo']['domain']['nserver']);
   248|             } else {
   249|                 $result['regrinfo']['domain']['nserver'] = $this->fixNameServer($result['regrinfo']['domain']['nserver']);
   250|             }
   251|         }
   252|     }
   253|     /**
   254|      * Guess query type
   255|      *
   256|      * @param string $query
   257|      *
   258|      * @return int Query type
   259|      */
   260|     public function getQueryType($query)
   261|     {
   262|         $ipTools = new IpTools;
   263|         if ($ipTools->validIp($query, 'ipv4', false)) {
   264|             if ($ipTools->validIp($query, 'ipv4')) {
   265|                 return self::QTYPE_IPV4;
   266|             } else {
   267|                 return self::QTYPE_UNKNOWN;
   268|             }
   269|         } elseif ($ipTools->validIp($query, 'ipv6', false)) {
   270|             if ($ipTools->validIp($query, 'ipv6')) {
   271|                 return self::QTYPE_IPV6;
   272|             } else {
   273|                 return self::QTYPE_UNKNOWN;
   274|             }
   275|         } elseif (!empty($query) && strpos($query, '.') !== false) {
   276|             return self::QTYPE_DOMAIN;
   277|         } elseif (!empty($query) && strpos($query, '.') === false) {
   278|             return self::QTYPE_AS;
   279|         } else {
   280|             return self::QTYPE_UNKNOWN;
   281|         }
   282|     }
   283| }


# ====================================================================
# FILE: src/WhoisClient.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-536 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| namespace phpWhois;
    25| use phpWhois\IpTools;
    26| /**
    27|  * phpWhois basic class
    28|  *
    29|  * This is the basic client class
    30|  */
    31| class WhoisClient
    32| {
    33|     /** @var boolean Is recursion allowed? */
    34|     public $gtldRecurse = false;
    35|     /** @var int Default WHOIS port */
    36|     public $port = 43;
    37|     /** @var int Maximum number of retries on connection failure */
    38|     public $retry = 0;
    39|     /** @var int Time to wait between retries */
    40|     public $sleep = 2;
    41|     /** @var int Read buffer size (0 == char by char) */
    42|     public $buffer = 1024;
    43|     /** @var int Communications timeout */
    44|     public $stimeout = 10;
    45|     /** @var string[] List of servers and handlers (loaded from servers.whois) */
    46|     public $DATA = array();
    47|     /** @var string[] Non UTF-8 servers */
    48|     public $NON_UTF8 = array();
    49|     /** @var string[] List of Whois servers with special parameters */
    50|     public $WHOIS_PARAM = array();
    51|     /** @var string[] TLD's that have special whois servers or that can only be reached via HTTP */
    52|     public $WHOIS_SPECIAL = array();
    53|     /** @var string[] Handled gTLD whois servers */
    54|     public $WHOIS_GTLD_HANDLER = array();
    55|     /** @var string[] Array to contain all query publiciables */
    56|     public $query = array(
    57|         'tld' => '',
    58|         'type' => 'domain',
    59|         'query' => '',
    60|         'status',
    61|         'server'
    62|     );
    63|     /** @var string Current release of the package */
    64|     public $codeVersion = null;
    65|     /** @var string Full code and data version string (e.g. 'Whois2.php v3.01:16') */
    66|     public $version;
    67|     /**
    68|      * Constructor function
    69|      */
    70|     public function __construct()
    71|     {
    72|         $servers = require('whois.servers.php');
    73|         $this->DATA               = $servers['DATA'];
    74|         $this->NON_UTF8           = $servers['NON_UTF8'];
    75|         $this->WHOIS_PARAM        = $servers['WHOIS_PARAM'];
    76|         $this->WHOIS_SPECIAL      = $servers['WHOIS_SPECIAL'];
    77|         $this->WHOIS_GTLD_HANDLER = $servers['WHOIS_GTLD_HANDLER'];
    78|         $this->codeVersion = file_get_contents(__DIR__ . '/../VERSION');
    79|         $this->version = sprintf("phpWhois v%s", $this->codeVersion);
    80|     }
    81|     /**
    82|      * Perform lookup
    83|      *
    84|      * @return array Raw response as array separated by "\n"
    85|      */
    86|     public function getRawData($query)
    87|     {
    88|         $this->query['query'] = $query;
    89|         if (isset($this->query['errstr'])) {
    90|             unset($this->query['errstr']);
    91|         }
    92|         if (!isset($this->query['server'])) {
    93|             $this->query['status'] = 'error';
    94|             $this->query['errstr'][] = 'No server specified';
    95|             return (array());
    96|         }
    97|         if (substr($this->query['server'], 0, 7) == 'http://' ||
    98|             substr($this->query['server'], 0, 8) == 'https://'
    99|         ) {
   100|             $output = $this->httpQuery($this->query['server']);
   101|             if (!$output) {
   102|                 $this->query['status'] = 'error';
   103|                 $this->query['errstr'][] = 'Connect failed to: ' . $this->query['server'];
   104|                 return (array());
   105|             }
   106|             $this->query['args'] = substr(strchr($this->query['server'], '?'), 1);
   107|             $this->query['server'] = strtok($this->query['server'], '?');
   108|             if (substr($this->query['server'], 0, 7) == 'http://') {
   109|                 $this->query['server_port'] = 80;
   110|             } else {
   111|                 $this->query['server_port'] = 443;
   112|             }
   113|         } else {
   114|             if (strpos($this->query['server'], '?')) {
   115|                 $parts = explode('?', $this->query['server']);
   116|                 $this->query['server'] = trim($parts[0]);
   117|                 $query_args = trim($parts[1]);
   118|                 $query_args = str_replace('{query}', $query, $query_args);
   119|                 $query_args = str_replace('{version}', 'phpWhois' . $this->codeVersion, $query_args);
   120|                 $iptools = new IpTools;
   121|                 if (strpos($query_args, '{ip}') !== false) {
   122|                     $query_args = str_replace('{ip}', $iptools->getClientIp(), $query_args);
   123|                 }
   124|                 if (strpos($query_args, '{hname}') !== false) {
   125|                     $query_args = str_replace('{hname}', gethostbyaddr($iptools->getClientIp()), $query_args);
   126|                 }
   127|             } else {
   128|                 if (empty($this->query['args'])) {
   129|                     $query_args = $query;
   130|                 } else {
   131|                     $query_args = $this->query['args'];
   132|                 }
   133|             }
   134|             $this->query['args'] = $query_args;
   135|             if (substr($this->query['server'], 0, 9) == 'rwhois://') {
   136|                 $this->query['server'] = substr($this->query['server'], 9);
   137|             }
   138|             if (substr($this->query['server'], 0, 8) == 'whois://') {
   139|                 $this->query['server'] = substr($this->query['server'], 8);
   140|             }
   141|             if (strpos($this->query['server'], ':')) {
   142|                 $parts = explode(':', $this->query['server']);
   143|                 $this->query['server'] = trim($parts[0]);
   144|                 $this->query['server_port'] = trim($parts[1]);
   145|             } else {
   146|                 $this->query['server_port'] = $this->port;
   147|             }
   148|             $ptr = $this->connect();
   149|             if ($ptr === false) {
   150|                 $this->query['status'] = 'error';
   151|                 $this->query['errstr'][] = 'Connect failed to: ' . $this->query['server'];
   152|                 return array();
   153|             }
   154|             stream_set_timeout($ptr, $this->stimeout);
   155|             stream_set_blocking($ptr, 0);
   156|             fputs($ptr, trim($query_args) . "\r\n");
   157|             $raw = '';
   158|             $start = time();
   159|             $null = null;
   160|             $r = array($ptr);
   161|             while (!feof($ptr)) {
   162|                 if (!empty($r)) {
   163|                     if (stream_select($r, $null, $null, $this->stimeout)) {
   164|                         $raw .= fgets($ptr, $this->buffer);
   165|                     }
   166|                 }
   167|                 if (time() - $start > $this->stimeout) {
   168|                     $this->query['status'] = 'error';
   169|                     $this->query['errstr'][] = 'Timeout reading from ' . $this->query['server'];
   170|                     return array();
   171|                 }
   172|             }
   173|             if (array_key_exists($this->query['server'], $this->NON_UTF8)) {
   174|                 $raw = utf8_encode($raw);
   175|             }
   176|             $output = explode("\n", $raw);
   177|             if (empty($output[count($output) - 1])) {
   178|                 unset($output[count($output) - 1]);
   179|             }
   180|         }
   181|         return $output;
   182|     }
   183|     /**
   184|      * Perform lookup
   185|      *
   186|      * @return array The *rawdata* element contains an
   187|      * array of lines gathered from the whois query. If a top level domain
   188|      * handler class was found for the domain, other elements will have been
   189|      * populated too.
   190|      */
   191|     public function getData($query = '', $deep_whois = true)
   192|     {
   193|         $query = !empty($query) ? $query : $this->query['query'];
   194|         $output = $this->getRawData($query);
   195|         $result = array('rawdata' => $output);
   196|         $result = $this->setWhoisInfo($result);
   197|         if (empty($output)) {
   198|             return $result;
   199|         }
   200|         if (isset($this->query['handler'])) {
   201|             $servers = $result['regyinfo']['servers'];
   202|             unset($result['regyinfo']['servers']);
   203|             $result = $this->process($result, $deep_whois);
   204|             if (isset($result['regyinfo']['servers'])) {
   205|                 $result['regyinfo']['servers'] = array_merge($servers, $result['regyinfo']['servers']);
   206|             } else {
   207|                 $result['regyinfo']['servers'] = $servers;
   208|             }
   209|             if (!isset($result['rawdata'])) {
   210|                 $result['rawdata'] = $output;
   211|             }
   212|         }
   213|         if (!isset($result['regyinfo']['type'])) {
   214|             $result['regyinfo']['type'] = 'domain';
   215|         }
   216|         if (isset($this->query['errstr'])) {
   217|             $result['errstr'] = $this->query['errstr'];
   218|         }
   219|         if (method_exists($this, 'fixResult') && $this->query['tld'] != 'ip') {
   220|             $this->fixResult($result, $query);
   221|         }
   222|         return ($result);
   223|     }
   224|     /**
   225|      * Adds whois server query information to result
   226|      *
   227|      * @param $result array Result array
   228|      * @return array Original result array with server query information
   229|      */
   230|     public function setWhoisInfo($result)
   231|     {
   232|         $info = array(
   233|             'server' => $this->query['server'],
   234|         );
   235|         if (!empty($this->query['args'])) {
   236|             $info['args'] = $this->query['args'];
   237|         } else {
   238|             $info['args'] = $this->query['query'];
   239|         }
   240|         if (!empty($this->query['server_port'])) {
   241|             $info['port'] = $this->query['server_port'];
   242|         } else {
   243|             $info['port'] = 43;
   244|         }
   245|         if (isset($result['regyinfo']['whois'])) {
   246|             unset($result['regyinfo']['whois']);
   247|         }
   248|         if (isset($result['regyinfo']['rwhois'])) {
   249|             unset($result['regyinfo']['rwhois']);
   250|         }
   251|         $result['regyinfo']['servers'][] = $info;
   252|         return $result;
   253|     }
   254|     /**
   255|      * Convert html output to plain text
   256|      *
   257|      * @return array Rawdata
   258|      */
   259|     public function httpQuery()
   260|     {
   261|         $lines = @file($this->query['server']);
   262|         if (!$lines) {
   263|             return false;
   264|         }
   265|         $output = '';
   266|         $pre = '';
   267|         foreach ($lines as $val) {
   268|             $val = trim($val);
   269|             $pos = strpos(strtoupper($val), '<PRE>');
   270|             if ($pos !== false) {
   271|                 $pre = "\n";
   272|                 $output .= substr($val, 0, $pos) . "\n";
   273|                 $val = substr($val, $pos + 5);
   274|             }
   275|             $pos = strpos(strtoupper($val), '</PRE>');
   276|             if ($pos !== false) {
   277|                 $pre = '';
   278|                 $output .= substr($val, 0, $pos) . "\n";
   279|                 $val = substr($val, $pos + 6);
   280|             }
   281|             $output .= $val . $pre;
   282|         }
   283|         $search = array(
   284|             '<BR>', '<P>', '</TITLE>',
   285|             '</H1>', '</H2>', '</H3>',
   286|             '<br>', '<p>', '</title>',
   287|             '</h1>', '</h2>', '</h3>');
   288|         $output = str_replace($search, "\n", $output);
   289|         $output = str_replace('<TD', ' <td', $output);
   290|         $output = str_replace('<td', ' <td', $output);
   291|         $output = str_replace('<tr', "\n<tr", $output);
   292|         $output = str_replace('<TR', "\n<tr", $output);
   293|         $output = str_replace('&nbsp;', ' ', $output);
   294|         $output = strip_tags($output);
   295|         $output = explode("\n", $output);
   296|         $rawdata = array();
   297|         $null = 0;
   298|         foreach ($output as $val) {
   299|             $val = trim($val);
   300|             if ($val == '') {
   301|                 if (++$null > 2) {
   302|                     continue;
   303|                 }
   304|             } else {
   305|                 $null = 0;
   306|             }
   307|             $rawdata[] = $val;
   308|         }
   309|         return $rawdata;
   310|     }
   311|     /**
   312|      * Open a socket to the whois server.
   313|      *
   314|      * @param string|null $server Server address to connect. If null, $this->query['server'] will be used
   315|      *
   316|      * @return resource|false Returns a socket connection pointer on success, or -1 on failure
   317|      */
   318|     public function connect($server = null)
   319|     {
   320|         if (empty($server)) {
   321|             $server = $this->query['server'];
   322|         }
   323|         /** @TODO Throw an exception here */
   324|         if (empty($server)) {
   325|             return false;
   326|         }
   327|         $port = $this->query['server_port'];
   328|         $parsed = $this->parseServer($server);
   329|         $server = $parsed['host'];
   330|         if (array_key_exists('port', $parsed)) {
   331|             $port = $parsed['port'];
   332|         }
   333|         $retry = 0;
   334|         while ($retry <= $this->retry) {
   335|             $this->query['status'] = 'ready';
   336|             $ptr = @fsockopen($server, $port, $errno, $errstr, $this->stimeout);
   337|             if ($ptr > 0) {
   338|                 $this->query['status'] = 'ok';
   339|                 return $ptr;
   340|             }
   341|             $this->query['status'] = 'error';
   342|             $this->query['error'][] = $errstr;
   343|             $retry++;
   344|             sleep($this->sleep);
   345|         }
   346|         return false;
   347|     }
   348|     /**
   349|      * Post-process result with handler class.
   350|      *
   351|      * @return array On success, returns the result from the handler.
   352|      * On failure, returns passed result unaltered.
   353|      */
   354|     public function process(&$result, $deep_whois = true)
   355|     {
   356|         $handlerName = $this->loadHandler($this->query['handler']);
   357|         if ($handlerName === false) {
   358|             $handlerName = $this->loadLegacyHandler($this->query['handler'], $this->query['file']);
   359|         }
   360|         if ($handlerName === false) {
   361|             $this->query['errstr'][] = "Can't find {$this->query['handler']} handler: " . $this->query['file'];
   362|             return $result;
   363|         }
   364|         if (!$this->gtldRecurse && $this->query['file'] === 'whois.gtld.php') {
   365|             return $result;
   366|         }
   367|         $handler = new $handlerName('');
   368|         if (isset($handler->query['errstr'])) {
   369|             $this->query['errstr'][] = $handler->query['errstr'];
   370|         }
   371|         $handler->deepWhois = $deep_whois;
   372|         $res = $handler->parse($result, $this->query['query']);
   373|         return $res;
   374|     }
   375|     /**
   376|      * Does more (deeper) whois
   377|      *
   378|      * @return array Resulting array
   379|      */
   380|     public function deepWhois($query, $result)
   381|     {
   382|         if (!isset($result['regyinfo']['whois'])) {
   383|             return $result;
   384|         }
   385|         $this->query['server'] = $wserver = $result['regyinfo']['whois'];
   386|         unset($result['regyinfo']['whois']);
   387|         $subresult = $this->getRawData($query);
   388|         if (!empty($subresult)) {
   389|             $result = $this->setWhoisInfo($result);
   390|             $result['rawdata'] = $subresult;
   391|             if (isset($this->WHOIS_GTLD_HANDLER[$wserver])) {
   392|                 $this->query['handler'] = $this->WHOIS_GTLD_HANDLER[$wserver];
   393|             } else {
   394|                 $parts = explode('.', $wserver);
   395|                 $hname = strtolower($parts[1]);
   396|                 if (($fp = @fopen('whois.gtld.' . $hname . '.php', 'r', 1)) and fclose($fp)) {
   397|                     $this->query['handler'] = $hname;
   398|                 }
   399|             }
   400|             if (!empty($this->query['handler'])) {
   401|                 $this->query['file'] = sprintf('whois.gtld.%s.php', $this->query['handler']);
   402|                 $regrinfo = $this->process($subresult); //$result['rawdata']);
   403|                 $result['regrinfo'] = $this->mergeResults($result['regrinfo'], $regrinfo);
   404|             }
   405|         }
   406|         return $result;
   407|     }
   408|     /**
   409|      * Merge results
   410|      *
   411|      * @param array $a1
   412|      * @param array $a2
   413|      *
   414|      * @return array
   415|      */
   416|     public function mergeResults($a1, $a2)
   417|     {
   418|         reset($a2);
   419|         foreach ($a2 as $key => $val) {
   420|             if (isset($a1[$key])) {
   421|                 if (is_array($val)) {
   422|                     if ($key != 'nserver') {
   423|                         $a1[$key] = $this->mergeResults($a1[$key], $val);
   424|                     }
   425|                 } else {
   426|                     $val = trim($val);
   427|                     if ($val != '') {
   428|                         $a1[$key] = $val;
   429|                     }
   430|                 }
   431|             } else {
   432|                 $a1[$key] = $val;
   433|             }
   434|         }
   435|         return $a1;
   436|     }
   437|     /**
   438|      * Remove unnecessary symbols from nameserver received from whois server
   439|      *
   440|      * @param string[] $nserver List of received nameservers
   441|      *
   442|      * @return string[]
   443|      */
   444|     public function fixNameServer($nserver)
   445|     {
   446|         $dns = array();
   447|         foreach ($nserver as $val) {
   448|             $val = str_replace(array('[', ']', '(', ')'), '', trim($val));
   449|             $val = str_replace("\t", ' ', $val);
   450|             $parts = explode(' ', $val);
   451|             $host = '';
   452|             $ip = '';
   453|             foreach ($parts as $p) {
   454|                 if (substr($p, -1) == '.') {
   455|                     $p = substr($p, 0, -1);
   456|                 }
   457|                 if ((ip2long($p) == -1) or (ip2long($p) === false)) {
   458|                     if ($host == '' && preg_match('/^[\w\-]+(\.[\w\-]+)+$/', $p)) {
   459|                         $host = $p;
   460|                     }
   461|                 } else {
   462|                     $ip = $p;
   463|                 }
   464|             }
   465|             if ($host == '') {
   466|                 continue;
   467|             }
   468|             if ($ip == '') {
   469|                 $ip = gethostbyname($host);
   470|                 if ($ip == $host) {
   471|                     $ip = '(DOES NOT EXIST)';
   472|                 }
   473|             }
   474|             if (substr($host, -1, 1) == '.') {
   475|                 $host = substr($host, 0, -1);
   476|             }
   477|             $dns[strtolower($host)] = $ip;
   478|         }
   479|         return $dns;
   480|     }
   481|     /**
   482|      * Parse server string into array with host and port keys
   483|      *
   484|      * @param $server   server string in various formattes
   485|      * @return array    Array containing 'host' key with server host and 'port' if defined in original $server string
   486|      */
   487|     public function parseServer($server)
   488|     {
   489|         $server = trim($server);
   490|         $server = preg_replace('/\/$/', '', $server);
   491|         $ipTools = new IpTools;
   492|         if ($ipTools->validIpv6($server)) {
   493|             $result = array('host' => "[$server]");
   494|         } else {
   495|             $parsed = parse_url($server);
   496|             if (array_key_exists('path', $parsed) && !array_key_exists('host', $parsed)) {
   497|                 $host = preg_replace('/\//', '', $parsed['path']);
   498|                 if (preg_match('/^(\[[a-f0-9:]+\]):(\d{1,5})$/i', $host, $matches)) {
   499|                     $result = array('host' => $matches[1], 'port' => $matches[2]);
   500|                 } else {
   501|                     $result = array('host' => $host);
   502|                 }
   503|             } else {
   504|                 $result = $parsed;
   505|             }
   506|         }
   507|         return $result;
   508|     }
   509|     /**
   510|      * @return string|bool
   511|      */
   512|     protected function loadHandler(string $queryHandler)
   513|     {
   514|         $queryHandler = ucfirst($queryHandler);
   515|         $handlerName = "phpWhois\\Handlers\\{$queryHandler}Handler";
   516|         if (class_exists($handlerName)) {
   517|             return $handlerName;
   518|         }
   519|         return false;
   520|     }
   521|     /**
   522|      * @return string|bool
   523|      */
   524|     protected function loadLegacyHandler(string $queryHandler, string $queryFile)
   525|     {
   526|         $handler_name = str_replace('.', '_', $queryHandler);
   527|         $HANDLER_FLAG = sprintf("__%s_HANDLER__", strtoupper($handler_name));
   528|         if (!defined($HANDLER_FLAG)) {
   529|             include($queryFile);
   530|         }
   531|         if (!defined($HANDLER_FLAG)) {
   532|             return false;
   533|         }
   534|         return $handler_name . '_handler';
   535|     }
   536| }


# ====================================================================
# FILE: src/whois.ca.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-39 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__CA_HANDLER__'))
    25|     define('__CA_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class ca_handler {
    28|     function parse($data_str, $query) {
    29|         $r = [
    30|             'rawdata' => $data_str['rawdata'],
    31|         ];
    32|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], [], 'ymd');
    33|         $r['regyinfo'] = array(
    34|             'registrar' => 'CIRA',
    35|             'referrer' => 'http://www.cira.ca/'
    36|         );
    37|         return $r;
    38|     }
    39| }


# ====================================================================
# FILE: src/whois.cat.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__CAT_HANDLER__'))
    25|     define('__CAT_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class cat_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         if (!isset($r['regrinfo']['domain']['name']))
    32|             $r['regrinfo']['registered'] = 'no';
    33|         $r['regyinfo']['referrer'] = 'http://www.domini.cat/';
    34|         $r['regyinfo']['registrar'] = 'Domini punt CAT';
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.ch.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-61 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__CH_HANDLER__'))
    26|     define('__CH_HANDLER__', 1);
    27| class ch_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Holder of domain name:',
    31|             'domain.name' => 'Domain name:',
    32|             'domain.created' => 'Date of last registration:',
    33|             'domain.changed' => 'Date of last modification:',
    34|             'tech' => 'Technical contact:',
    35|             'domain.nserver' => 'Name servers:',
    36|             'domain.dnssec' => 'DNSSEC:'
    37|         );
    38|         $trans = array(
    39|             'contractual language:' => 'language'
    40|         );
    41|         $r = array();
    42|         $r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    43|         if (!empty($r['regrinfo']['domain']['name'])) {
    44|             $r['regrinfo'] = get_contacts($r['regrinfo'], $trans);
    45|             $r['regrinfo']['domain']['name'] = $r['regrinfo']['domain']['name'][0];
    46|             if (isset($r['regrinfo']['domain']['changed'][0]))
    47|                 $r['regrinfo']['domain']['changed'] = get_date($r['regrinfo']['domain']['changed'][0], 'dmy');
    48|             if (isset($r['regrinfo']['domain']['created'][0]))
    49|                 $r['regrinfo']['domain']['created'] = get_date($r['regrinfo']['domain']['created'][0], 'dmy');
    50|             $r['regrinfo']['registered'] = 'yes';
    51|         } else {
    52|             $r = [];
    53|             $r['regrinfo']['registered'] = 'no';
    54|         }
    55|         $r['regyinfo'] = array(
    56|             'referrer' => 'http://www.nic.ch',
    57|             'registrar' => 'SWITCH Domain Name Registration'
    58|         );
    59|         return $r;
    60|     }
    61| }


# ====================================================================
# FILE: src/whois.cn.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-82 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__CN_HANDLER__'))
    25|     define('__CN_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class cn_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'Domain Name:' => 'domain.name',
    31|             'Domain Status:' => 'domain.status.',
    32|             'ROID:' => 'domain.handle',
    33|             'Name Server:' => 'domain.nserver.',
    34|             'Registration Date:' => 'domain.created',
    35|             'Expiration Date:' => 'domain.expires',
    36|             'Sponsoring Registrar:' => 'domain.sponsor',
    37|             'Registrant Name:' => 'owner.name',
    38|             'Registrant Organization:' => 'owner.organization',
    39|             'Registrant Address:' => 'owner.address.address',
    40|             'Registrant Postal Code:' => 'owner.address.pcode',
    41|             'Registrant City:' => 'owner.address.city',
    42|             'Registrant Country Code:' => 'owner.address.country',
    43|             'Registrant Email:' => 'owner.email',
    44|             'Registrant Phone Number:' => 'owner.phone',
    45|             'Registrant Fax:' => 'owner.fax',
    46|             'Administrative Name:' => 'admin.name',
    47|             'Administrative Organization:' => 'admin.organization',
    48|             'Administrative Address:' => 'admin.address.address',
    49|             'Administrative Postal Code:' => 'admin.address.pcode',
    50|             'Administrative City:' => 'admin.address.city',
    51|             'Administrative Country Code:' => 'admin.address.country',
    52|             'Administrative Email:' => 'admin.email',
    53|             'Administrative Phone Number:' => 'admin.phone',
    54|             'Administrative Fax:' => 'admin.fax',
    55|             'Technical Name:' => 'tech.name',
    56|             'Technical Organization:' => 'tech.organization',
    57|             'Technical Address:' => 'tech.address.address',
    58|             'Technical Postal Code:' => 'tech.address.pcode',
    59|             'Technical City:' => 'tech.address.city',
    60|             'tec-country:' => 'tech.address.country',
    61|             'Technical Email:' => 'tech.email',
    62|             'Technical Phone Number:' => 'tech.phone',
    63|             'Technical Fax:' => 'tech.fax',
    64|             'Billing Name:' => 'billing.name',
    65|             'Billing Organization:' => 'billing.organization',
    66|             'Billing Address:' => 'billing.address.address',
    67|             'Billing Postal Code:' => 'billing.address.pcode',
    68|             'Billing City:' => 'billing.address.city',
    69|             'Billing Country Code:' => 'billing.address.country',
    70|             'Billing Email:' => 'billing.email',
    71|             'Billing Phone Number:' => 'billing.phone',
    72|             'Billing Fax:' => 'billing.fax'
    73|         );
    74|         $r = array();
    75|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
    76|         $r['regyinfo'] = array(
    77|             'referrer' => 'http://www.cnnic.net.cn',
    78|             'registrar' => 'China NIC'
    79|         );
    80|         return $r;
    81|     }
    82| }


# ====================================================================
# FILE: src/whois.co.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__CO_HANDLER__'))
    25|     define('__CO_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class co_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], array(), 'mdy');
    31|         $r['regyinfo']['referrer'] = 'http://www.cointernet.com.co/';
    32|         $r['regyinfo']['registrar'] = '.CO Internet, S.A.S.';
    33|         return $r;
    34|     }
    35| }


# ====================================================================
# FILE: src/whois.co.za.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-63 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__CO_ZA_HANDLER__'))
    25|     define('__CO_ZA_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class co_Za_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             '0a. lastupdate             :' => 'domain.changed',
    31|             '1a. domain                 :' => 'domain.name',
    32|             '2b. registrantpostaladdress:' => 'owner.address.address.0',
    33|             '2f. billingaccount         :' => 'billing.name',
    34|             '2g. billingemail           :' => 'billing.email',
    35|             '2i. invoiceaddress         :' => 'billing.address',
    36|             '2j. registrantphone        :' => 'owner.phone',
    37|             '2k. registrantfax          :' => 'owner.fax',
    38|             '2l. registrantemail        :' => 'owner.email',
    39|             '4a. admin                  :' => 'admin.name',
    40|             '4c. admincompany           :' => 'admin.organization',
    41|             '4d. adminpostaladdr        :' => 'admin.address',
    42|             '4e. adminphone             :' => 'admin.phone',
    43|             '4f. adminfax               :' => 'admin.fax',
    44|             '4g. adminemail             :' => 'admin.email',
    45|             '5a. tec                    :' => 'tech.name',
    46|             '5c. teccompany             :' => 'tech.organization',
    47|             '5d. tecpostaladdr          :' => 'tech.address',
    48|             '5e. tecphone               :' => 'tech.phone',
    49|             '5f. tecfax                 :' => 'tech.fax',
    50|             '5g. tecemail               :' => 'tech.email',
    51|             '6a. primnsfqdn             :' => 'domain.nserver.0',
    52|             '6e. secns1fqdn             :' => 'domain.nserver.1',
    53|             '6i. secns2fqdn             :' => 'domain.nserver.2',
    54|             '6m. secns3fqdn             :' => 'domain.nserver.3',
    55|             '6q. secns4fqdn             :' => 'domain.nserver.4'
    56|         );
    57|         $r = array();
    58|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
    59|         $r['regyinfo']['referrer'] = 'http://www.co.za';
    60|         $r['regyinfo']['registrar'] = 'UniForum Association';
    61|         return $r;
    62|     }
    63| }


# ====================================================================
# FILE: src/whois.coop.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-83 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__COOP_HANDLER__'))
    25|     define('__COOP_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class coop_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Contact Type:            registrant',
    31|             'admin' => 'Contact Type:            admin',
    32|             'tech' => 'Contact Type:            tech',
    33|             'billing' => 'Contact Type:            billing',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.handle' => 'Domain ID:',
    36|             'domain.expires' => 'Expiry Date:',
    37|             'domain.created' => 'Created:',
    38|             'domain.changed' => 'Last updated:',
    39|             'domain.status' => 'Domain Status:',
    40|             'domain.sponsor' => 'Sponsoring registrar:',
    41|             'domain.nserver.' => 'Host Name:'
    42|         );
    43|         $translate = array(
    44|             'Contact ID:' => 'handle',
    45|             'Name:' => 'name',
    46|             'Organisation:' => 'organization',
    47|             'Street 1:' => 'address.street.0',
    48|             'Street 2:' => 'address.street.1',
    49|             'Street 3:' => 'address.street.2',
    50|             'City:' => 'address.city',
    51|             'State/Province:' => 'address.state',
    52|             'Postal code:' => 'address.pcode',
    53|             'Country:' => 'address.country',
    54|             'Voice:' => 'phone',
    55|             'Fax:' => 'fax',
    56|             'Email:' => 'email'
    57|         );
    58|         $blocks = get_blocks($data_str['rawdata'], $items);
    59|         $r = array();
    60|         if (isset($blocks['domain'])) {
    61|             $r['regrinfo']['domain'] = format_dates($blocks['domain'], 'dmy');
    62|             $r['regrinfo']['registered'] = 'yes';
    63|             if (isset($blocks['owner'])) {
    64|                 $r['regrinfo']['owner'] = generic_parser_b($blocks['owner'], $translate, 'dmy', false);
    65|                 if (isset($blocks['tech']))
    66|                     $r['regrinfo']['tech'] = generic_parser_b($blocks['tech'], $translate, 'dmy', false);
    67|                 if (isset($blocks['admin']))
    68|                     $r['regrinfo']['admin'] = generic_parser_b($blocks['admin'], $translate, 'dmy', false);
    69|                 if (isset($blocks['billing']))
    70|                     $r['regrinfo']['billing'] = generic_parser_b($blocks['billing'], $translate, 'dmy', false);
    71|             }
    72|             else {
    73|                 $r['regrinfo']['owner'] = generic_parser_b($data_str['rawdata'], $translate, 'dmy', false);
    74|             }
    75|         } else
    76|             $r['regrinfo']['registered'] = 'no';
    77|         $r['regyinfo'] = array(
    78|             'referrer' => 'http://www.nic.coop',
    79|             'registrar' => '.coop registry'
    80|         );
    81|         return $r;
    82|     }
    83| }


# ====================================================================
# FILE: src/whois.cz.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-59 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__CZ_HANDLER__'))
    25|     define('__CZ_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class cz_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'expire' => 'expires',
    31|             'registered' => 'created',
    32|             'nserver' => 'nserver',
    33|             'domain' => 'name',
    34|             'contact' => 'handle',
    35|             'reg-c' => '',
    36|             'descr' => 'desc',
    37|             'e-mail' => 'email',
    38|             'person' => 'name',
    39|             'org' => 'organization',
    40|             'fax-no' => 'fax'
    41|         );
    42|         $contacts = array(
    43|             'admin-c' => 'admin',
    44|             'tech-c' => 'tech',
    45|             'bill-c' => 'billing',
    46|             'registrant' => 'owner'
    47|         );
    48|         $r = array();
    49|         $r['regrinfo'] = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'dmy');
    50|         $r['regyinfo'] = array(
    51|             'referrer' => 'http://www.nic.cz',
    52|             'registrar' => 'CZ-NIC'
    53|         );
    54|         if ($data_str['rawdata'][0] == 'Your connection limit exceeded. Please slow down and try again later.') {
    55|             $r['regrinfo']['registered'] = 'unknown';
    56|         }
    57|         return $r;
    58|     }
    59| }


# ====================================================================
# FILE: src/whois.dev.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-38 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @copyright Copyright (c) 2020 Joshua Smith
    20|  */
    21| if (!defined('__DEV_HANDLER__')) {
    22|     define('__DEV_HANDLER__', 1);
    23| }
    24| require_once('whois.parser.php');
    25| /**
    26|  * Class dev_handler
    27|  */
    28| class dev_handler
    29| {
    30|     function parse($data_str, $query)
    31|     {
    32|         $r = [
    33|             'regrinfo' => generic_parser_b($data_str['rawdata']),
    34|             'rawdata'  => $data_str['rawdata'],
    35|         ];
    36|         return $r;
    37|     }
    38| }


# ====================================================================
# FILE: src/whois.dk.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-73 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__DK_HANDLER__')) {
    25|     define('__DK_HANDLER__', 1);
    26| }
    27| require_once('whois.parser.php');
    28| class dk_handler {
    29|     function parse($data_str, $query) {
    30|         $translate = [
    31|             'Name' => 'name',
    32|             'Address' => 'address.street',
    33|             'City' => 'address.city',
    34|             'Postalcode' => 'address.pcode',
    35|             'Country' => 'address.country'
    36|         ];
    37|         $blocks = generic_parser_a_blocks($data_str['rawdata'], $translate, $disclaimer);
    38|         $reg = [];
    39|         if (isset($disclaimer) && is_array($disclaimer)) {
    40|             $reg['disclaimer'] = $disclaimer;
    41|         }
    42|         if (empty($blocks) || !is_array($blocks['main'])) {
    43|             $reg['registered'] = 'no';
    44|         } else {
    45|             $r = $blocks['main'];
    46|             $reg['registered'] = 'yes';
    47|             $ownerHandlePos = array_search('Registrant', $data_str['rawdata']) + 1;
    48|             $ownerHandle = trim(substr(strstr($data_str['rawdata'][$ownerHandlePos], ':'), 1));
    49|             $adminHandlePos = array_search('Administrator', $data_str['rawdata']) + 1;
    50|             $adminHandle = trim(substr(strstr($data_str['rawdata'][$adminHandlePos], ':'), 1));
    51|             $contacts = [
    52|                 'owner' => $ownerHandle,
    53|                 'admin' => $adminHandle,
    54|             ];
    55|             foreach ($contacts as $key => $val) {
    56|                 $blk = strtoupper(strtok($val, ' '));
    57|                 if (isset($blocks[$blk])) {
    58|                     $reg[$key] = $blocks[$blk];
    59|                 }
    60|             }
    61|             $reg['domain'] = $r;
    62|             format_dates($reg, 'Ymd');
    63|         }
    64|         $r = [];
    65|         $r['rawdata'] = $data_str['rawdata'];
    66|         $r['regrinfo'] = $reg;
    67|         $r['regyinfo'] = [
    68|             'referrer' => 'https://www.dk-hostmaster.dk/',
    69|             'registrar' => 'DK Hostmaster'
    70|         ];
    71|         return $r;
    72|     }
    73| }


# ====================================================================
# FILE: src/whois.eu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-66 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__EU_HANDLER__'))
    26|     define('__EU_HANDLER__', 1);
    27| class eu_handler {
    28|     function parse($data, $query) {
    29|         $items = array(
    30|             'domain.name' => 'Domain:',
    31|             'domain.status' => 'Status:',
    32|             'domain.nserver' => 'Name servers:',
    33|             'domain.created' => 'Registered:',
    34|             'domain.registrar' => 'Registrar:',
    35|             'tech' => 'Registrar Technical Contacts:',
    36|             'owner' => 'Registrant:',
    37|             '' => 'Please visit'
    38|         );
    39|         $extra = array(
    40|             'organisation:' => 'organization',
    41|             'website:' => 'url'
    42|         );
    43|         $r = array();
    44|         $r['regrinfo'] = get_blocks($data['rawdata'], $items);
    45|         if (!empty($r['regrinfo']['domain']['status']))
    46|             switch ($r['regrinfo']['domain']['status']) {
    47|                 case 'FREE':
    48|                 case 'AVAILABLE':
    49|                     $r['regrinfo']['registered'] = 'no';
    50|                     break;
    51|                 case 'APPLICATION PENDING':
    52|                     $r['regrinfo']['registered'] = 'pending';
    53|                     break;
    54|                 default:
    55|                     $r['regrinfo']['registered'] = 'unknown';
    56|             } else
    57|             $r['regrinfo']['registered'] = 'yes';
    58|         if (isset($r['regrinfo']['tech']))
    59|             $r['regrinfo']['tech'] = get_contact($r['regrinfo']['tech'], $extra);
    60|         if (isset($r['regrinfo']['domain']['registrar']))
    61|             $r['regrinfo']['domain']['registrar'] = get_contact($r['regrinfo']['domain']['registrar'], $extra);
    62|         $r['regyinfo']['referrer'] = 'http://www.eurid.eu';
    63|         $r['regyinfo']['registrar'] = 'EURID';
    64|         return $r;
    65|     }
    66| }


# ====================================================================
# FILE: src/whois.fi.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-47 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__FI_HANDLER__'))
    25|     define('__FI_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class fi_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'domain:' => 'domain.name',
    31|             'created:' => 'domain.created',
    32|             'expires:' => 'domain.expires',
    33|             'status:' => 'domain.status',
    34|             'nserver:' => 'domain.nserver.',
    35|             'descr:' => 'owner.name.',
    36|             'address:' => 'owner.address.',
    37|             'phone:' => 'owner.phone',
    38|         );
    39|         $r = array();
    40|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
    41|         $r['regyinfo'] = array(
    42|             'referrer' => 'https://domain.ficora.fi/',
    43|             'registrar' => 'Finnish Communications Regulatory Authority'
    44|         );
    45|         return $r;
    46|     }
    47| }


# ====================================================================
# FILE: src/whois.fj.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-52 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__FJ_HANDLER__'))
    26|     define('__FJ_HANDLER__', 1);
    27| class fj_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'domain.status' => 'Status:',
    32|             'domain.expires' => 'Expires:',
    33|             'domain.nserver' => 'Domain servers:'
    34|         );
    35|         $r = array();
    36|         $r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    37|         if (!empty($r['regrinfo']['domain']['status'])) {
    38|             $r['regrinfo'] = get_contacts($r['regrinfo']);
    39|             date_default_timezone_set("Pacific/Fiji");
    40|             if (isset($r['regrinfo']['domain']['expires']))
    41|                 $r['regrinfo']['domain']['expires'] = strftime("%Y-%m-%d", strtotime($r['regrinfo']['domain']['expires']));
    42|             $r['regrinfo']['registered'] = 'yes';
    43|         } else {
    44|             $r['regrinfo']['registered'] = 'no';
    45|         }
    46|         $r['regyinfo'] = array(
    47|             'referrer' => 'http://www.domains.fj',
    48|             'registrar' => 'FJ Domain Name Registry'
    49|         );
    50|         return $r;
    51|     }
    52| }


# ====================================================================
# FILE: src/whois.fm.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-64 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__FM_HANDLER__'))
    25|     define('__FM_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class fm_handler {
    28|     function parse($data, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant',
    31|             'admin' => 'Admin',
    32|             'tech' => 'Technical',
    33|             'billing' => 'Billing',
    34|             'domain.nserver' => 'Name Servers:',
    35|             'domain.created' => 'Created:',
    36|             'domain.expires' => 'Expires:',
    37|             'domain.changed' => 'Modified:',
    38|             'domain.status' => 'Status:',
    39|             'domain.sponsor' => 'Registrar Name:'
    40|         );
    41|         $r = array();
    42|         $r['regrinfo'] = get_blocks($data['rawdata'], $items);
    43|         $items = array(
    44|             'phone number:' => 'phone',
    45|             'email address:' => 'email',
    46|             'fax number:' => 'fax',
    47|             'organisation:' => 'organization'
    48|         );
    49|         if (!empty($r['regrinfo']['domain']['created'])) {
    50|             $r['regrinfo'] = get_contacts($r['regrinfo'], $items);
    51|             if (count($r['regrinfo']['billing']['address']) > 4)
    52|                 $r['regrinfo']['billing']['address'] = array_slice($r['regrinfo']['billing']['address'], 0, 4);
    53|             $r['regrinfo']['registered'] = 'yes';
    54|             format_dates($r['regrinfo']['domain'], 'dmY');
    55|         }
    56|         else {
    57|             $r = [];
    58|             $r['regrinfo']['registered'] = 'no';
    59|         }
    60|         $r['regyinfo']['referrer'] = 'http://www.dot.dm';
    61|         $r['regyinfo']['registrar'] = 'dotFM';
    62|         return $r;
    63|     }
    64| }


# ====================================================================
# FILE: src/whois.fr.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-65 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__FR_HANDLER__'))
    25|     define('__FR_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class fr_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'fax-no' => 'fax',
    31|             'e-mail' => 'email',
    32|             'nic-hdl' => 'handle',
    33|             'ns-list' => 'handle',
    34|             'person' => 'name',
    35|             'address' => 'address.',
    36|             'descr' => 'desc',
    37|             'anniversary' => '',
    38|             'domain' => '',
    39|             'last-update' => 'changed',
    40|             'registered' => 'created',
    41|             'country' => 'address.country',
    42|             'registrar' => 'sponsor',
    43|             'role' => 'organization'
    44|         );
    45|         $contacts = array(
    46|             'admin-c' => 'admin',
    47|             'tech-c' => 'tech',
    48|             'zone-c' => 'zone',
    49|             'holder-c' => 'owner',
    50|             'nsl-id' => 'nserver'
    51|         );
    52|         $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'dmY');
    53|         if (isset($reg['nserver'])) {
    54|             $reg['domain'] = array_merge($reg['domain'], $reg['nserver']);
    55|             unset($reg['nserver']);
    56|         }
    57|         $r = array();
    58|         $r['regrinfo'] = $reg;
    59|         $r['regyinfo'] = array(
    60|             'referrer' => 'http://www.nic.fr',
    61|             'registrar' => 'AFNIC'
    62|         );
    63|         return $r;
    64|     }
    65| }


# ====================================================================
# FILE: src/whois.gtld.afternic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__AFTERNIC_HANDLER__'))
    25|     define('__AFTERNIC_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class afternic_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact',
    32|             'tech' => 'Technical Contact',
    33|             'zone' => 'Zone Contact',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.changed' => 'Last updated on',
    36|             'domain.created' => 'Domain created on',
    37|             'domain.expires' => 'Domain expires on'
    38|         );
    39|         return easy_parser($data_str, $items, 'dmy', array(), false, true);
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.gtld.alldomains.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-39 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ALLDOMAINS_HANDLER__'))
    25|     define('__ALLDOMAINS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class alldomains_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative',
    32|             'tech' => 'Technical',
    33|             'domain.name' => 'Domain name:',
    34|             'domain.sponsor' => 'Registrar:',
    35|             'domain.nserver.' => 'Domain servers in listed order:'
    36|         );
    37|         return easy_parser($data_str, $items, 'ymd');
    38|     }
    39| }


# ====================================================================
# FILE: src/whois.gtld.ascio.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ASCIO_HANDLER__'))
    25|     define('__ASCIO_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class ascio_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative ',
    32|             'tech' => 'Technical ',
    33|             'domain.name' => 'Domain name:',
    34|             'domain.nserver.' => 'Domain servers in listed order:',
    35|             'domain.created' => 'Record created:',
    36|             'domain.expires' => 'Record expires:',
    37|             'domain.changed' => 'Record last updated:'
    38|         );
    39|         return easy_parser($data_str, $items, 'ymd', array(), false, true);
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.gtld.assorted.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ASSORTED_HANDLER__'))
    25|     define('__ASSORTED_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class assorted_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.nserver.' => 'Domain servers in listed order:',
    35|             'domain.created' => 'Record created on',
    36|             'domain.expires' => 'Record expires on',
    37|             'domain.changed' => 'Record last updated'
    38|         );
    39|         return easy_parser($data_str, $items, 'ymd', array(), false, true);
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.gtld.corporatedomains.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__CORPORATEDOMAINS_HANDLER__'))
    25|     define('__CORPORATEDOMAINS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class corporatedomains_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact',
    32|             'tech' => 'Technical Contact',
    33|             'zone' => 'Zone Contact',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.changed' => 'Last updated on',
    36|             'domain.created' => 'Domain created on',
    37|             'domain.expires' => 'Domain expires on',
    38|             'domain.sponsor' => 'Registrar Name....:',
    39|             'domain.nserver' => 'DNS Servers:'
    40|         );
    41|         return easy_parser($data_str, $items, 'dmy', array(), false, true);
    42|     }
    43| }


# ====================================================================
# FILE: src/whois.gtld.directnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__DIRECTNIC_HANDLER__'))
    25|     define('__DIRECTNIC_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class directnic_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact',
    32|             'tech' => 'Technical Contact',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.sponsor' => 'Registration Service Provider:',
    35|             'domain.nserver' => 'Domain servers in listed order:',
    36|             'domain.changed' => 'Record last updated ',
    37|             'domain.created' => 'Record created on ',
    38|             'domain.expires' => 'Record expires on ',
    39|             '' => 'By submitting a WHOIS query'
    40|         );
    41|         return easy_parser($data_str, $items, 'mdy', array(), false, true);
    42|     }
    43| }


# ====================================================================
# FILE: src/whois.gtld.domaindiscover.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__DOMAINDISCOVER_HANDLER__'))
    25|     define('__DOMAINDISCOVER_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class domaindiscover_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact',
    32|             'tech' => 'Technical Contact',
    33|             'zone' => 'Zone Contact',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.changed' => 'Last updated on',
    36|             'domain.created' => 'Domain created on',
    37|             'domain.expires' => 'Domain expires on'
    38|         );
    39|         return easy_parser($data_str, $items, 'dmy', array(), false, true);
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.gtld.domainpeople.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-46 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__DOMAINPEOPLE_HANDLER__'))
    25|     define('__DOMAINPEOPLE_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class domainpeople_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant Contact:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'domain.name' => 'Domain name:',
    34|             'domain.sponsor' => 'Registration Service Provided By:',
    35|             'domain.referrer' => 'Contact:',
    36|             'domain.nserver.' => 'Name Servers:',
    37|             'domain.created' => 'Creation date:',
    38|             'domain.expires' => 'Expiration date:',
    39|             'domain.status' => 'Status:'
    40|         );
    41|         $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
    42|         if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    43|             $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    44|         return $r;
    45|     }
    46| }


# ====================================================================
# FILE: src/whois.gtld.dotster.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__DOTSTER_HANDLER__'))
    25|     define('__DOTSTER_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class dotster_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative',
    32|             'tech' => 'Technical',
    33|             'domain.nserver' =>
    34|             'Domain servers in listed order:',
    35|             'domain.name' => 'Domain name:',
    36|             'domain.created' => 'Created on:',
    37|             'domain.expires' => 'Expires on:',
    38|             'domain.changed' => 'Last Updated on:',
    39|             'domain.sponsor' => 'Registrar:'
    40|         );
    41|         return easy_parser($data_str, $items, 'dmy');
    42|     }
    43| }


# ====================================================================
# FILE: src/whois.gtld.dreamhost.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-44 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__DREAMHOST_HANDLER__'))
    25|     define('__DREAMHOST_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class dreamhost_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant Contact:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'billing' => 'Billing Contact:',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.nserver' => 'Domain servers in listed order:',
    36|             'domain.created' => 'Record created on',
    37|             'domain.expires' => 'Record expires on'
    38|         );
    39|         $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
    40|         if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    41|             $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    42|         return $r;
    43|     }
    44| }


# ====================================================================
# FILE: src/whois.gtld.enom.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-52 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ENOM_HANDLER__'))
    25|     define('__ENOM_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class enom_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner#0' => 'Registrant Contact',
    31|             'owner#1' => 'REGISTRANT Contact:',
    32|             'admin#0' => 'Administrative Contact',
    33|             'admin#1' => 'ADMINISTRATIVE Contact:',
    34|             'tech#0' => 'Technical Contact',
    35|             'tech#1' => 'TECHNICAL Contact:',
    36|             'billing#0' => 'Billing Contact',
    37|             'billing#1' => 'BILLING Contact:',
    38|             'domain.nserver' => 'Nameservers',
    39|             'domain.name#0' => 'Domain name:',
    40|             'domain.name#1' => 'Domain name-',
    41|             'domain.sponsor' => 'Registration Service Provided By:',
    42|             'domain.status' => 'Status:',
    43|             'domain.created#0' => 'Creation date:',
    44|             'domain.expires#0' => 'Expiration date:',
    45|             'domain.created#1' => 'Created:',
    46|             'domain.expires#1' => 'Expires:',
    47|             'domain.created#2' => 'Start of registration-',
    48|             'domain.expires#2' => 'Registered through-'
    49|         );
    50|         return easy_parser($data_str, $items, 'dmy', array(), false, true);
    51|     }
    52| }


# ====================================================================
# FILE: src/whois.gtld.fabulous.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__FABULOUS_HANDLER__'))
    25|     define('__FABULOUS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class fabulous_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Domain ' . $query . ':',
    31|             'admin' => 'Administrative contact:',
    32|             'tech' => 'Technical contact:',
    33|             'billing' => 'Billing contact:',
    34|             '' => 'Record dates:'
    35|         );
    36|         $r = easy_parser($data_str, $items, 'mdy', array(), false, true);
    37|         if (!isset($r['tech']))
    38|             $r['tech'] = $r['billing'];
    39|         if (!isset($r['admin']))
    40|             $r['admin'] = $r['tech'];
    41|         return $r;
    42|     }
    43| }


# ====================================================================
# FILE: src/whois.gtld.fastdomain.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-58 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__FASTDOMAIN_HANDLER__'))
    25|     define('__FASTDOMAIN_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class fastdomain_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant Info:',
    31|             'admin' => 'Administrative Info:',
    32|             'tech' => 'Technical Info:',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.sponsor' => 'Provider Name....:',
    35|             'domain.referrer' => 'Provider Homepage:',
    36|             'domain.nserver' => 'Domain servers in listed order:',
    37|             'domain.created' => 'Created on..............:',
    38|             'domain.expires' => 'Expires on..............:',
    39|             'domain.changed' => 'Last modified on........:',
    40|             'domain.status' => 'Status:'
    41|         );
    42|         foreach ($data_str as $key => $val) {
    43|             $faststr = strpos($val, ' (FAST-');
    44|             if ($faststr)
    45|                 $data_str[$key] = substr($val, 0, $faststr);
    46|         }
    47|         $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
    48|         if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    49|             $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    50|         if (isset($r['domain']['nserver'])) {
    51|             foreach (${$r['domain']['nserver']} as $key => $val) {
    52|                 if ($val === '=-=-=-=')
    53|                     unset($r['domain']['nserver'][$key]);
    54|             }
    55|         }
    56|         return $r;
    57|     }
    58| }


# ====================================================================
# FILE: src/whois.gtld.gandi.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__GANDI_HANDLER__'))
    25|     define('__GANDI_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class gandi_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'owner-c',
    31|             'admin' => 'admin-c',
    32|             'tech' => 'tech-c',
    33|             'billing' => 'bill-c'
    34|         );
    35|         $trans = array(
    36|             'nic-hdl:' => 'handle',
    37|             'person:' => 'name',
    38|             'zipcode:' => 'address.pcode',
    39|             'city:' => 'address.city',
    40|             'lastupdated:' => 'changed',
    41|             'owner-name:' => ''
    42|         );
    43|         return easy_parser($data_str, $items, 'dmy', $trans);
    44|     }
    45| }


# ====================================================================
# FILE: src/whois.gtld.genericb.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-31 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__GENERICB_HANDLER__'))
    25|     define('__GENERICB_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class genericb_handler {
    28|     function parse($data_str, $query) {
    29|         return generic_parser_b($data_str);
    30|     }
    31| }


# ====================================================================
# FILE: src/whois.gtld.godaddy.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-46 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__GODADDY_HANDLER__'))
    25|     define('__GODADDY_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class godaddy_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact',
    32|             'tech' => 'Technical Contact',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.nserver.' => 'Domain servers in listed order:',
    35|             'domain.created' => 'Created on:',
    36|             'domain.expires' => 'Expires on:',
    37|             'domain.changed' => 'Last Updated on:',
    38|             'domain.sponsor' => 'Registered through:'
    39|         );
    40|         $r = get_blocks($data_str, $items);
    41|         $r['owner'] = get_contact($r['owner']);
    42|         $r['admin'] = get_contact($r['admin'], array(), true);
    43|         $r['tech'] = get_contact($r['tech'], array(), true);
    44|         return format_dates($r, 'dmy');
    45|     }
    46| }


# ====================================================================
# FILE: src/whois.gtld.iana.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__IANA_HANDLER__'))
    25|     define('__IANA_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class iana_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'admin' => 'contact:      administrative',
    31|             'tech' => 'contact:      technical',
    32|             'domain.nserver.' => 'nserver:',
    33|             'domain.created' => 'created:',
    34|             'domain.changed' => 'changed:',
    35|             'domain.source' => 'source:',
    36|             'domain.name' => 'domain:',
    37|             'disclaimer.' => '% '
    38|         );
    39|         return easy_parser($data_str, $items, 'Ymd', array(), false, false, 'owner');
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.gtld.interdomain.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-70 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__INTERDOMAIN_HANDLER__'))
    25|     define('__INTERDOMAIN_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class interdomain_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'Domain Name................' => 'domain.name',
    31|             'Creation Date............' => 'domain.created',
    32|             'Expiry Date..............' => 'domain.expires',
    33|             'Last Update Date.........' => 'domain.changed',
    34|             'Name Server.............' => 'domain.nserver.',
    35|             'Organization Name........' => 'owner.name',
    36|             'Organization Org.........' => 'owner.organization',
    37|             'Organization Street......' => 'owner.address.street',
    38|             'Organization City........' => 'owner.address.city',
    39|             'Organization State.......' => 'owner.address.state',
    40|             'Organization PC..........' => 'owner.address.pcode',
    41|             'Organization Country.....' => 'owner.address.country',
    42|             'Organization Phone.......' => 'owner.phone',
    43|             'Organization e-mail......' => 'owner.email',
    44|             'Organization Contact Id....' => 'owner.handle',
    45|             'Administrative Contact Id..' => 'admin.handle',
    46|             'Administrative Name......' => 'admin.name',
    47|             'Administrative Org.......' => 'admin.organization',
    48|             'Administrative Street....' => 'admin.address.street',
    49|             'Administrative City......' => 'admin.address.city',
    50|             'Administrative State.....' => 'admin.address.state',
    51|             'Administrative PC........' => 'admin.address.pcode',
    52|             'Administrative Country...' => 'admin.address.country',
    53|             'Administrative Phone.....' => 'admin.phone',
    54|             'Administrative e-mail....' => 'admin.email',
    55|             'Administrative Fax.......' => 'admin.fax',
    56|             'Technical Contact Id.......' => 'tech.handle',
    57|             'Technical Name...........' => 'tech.name',
    58|             'Technical Org............' => 'tech.organization',
    59|             'Technical Street.........' => 'tech.address.street',
    60|             'Technical City...........' => 'tech.address.city',
    61|             'Technical State..........' => 'tech.address.state',
    62|             'Technical PC.............' => 'tech.address.pcode',
    63|             'Technical Country........' => 'tech.address.country',
    64|             'Technical Phone..........' => 'tech.phone',
    65|             'Technical e-mail.........' => 'tech.email',
    66|             'Technical Fax............' => 'tech.fax'
    67|         );
    68|         return generic_parser_b($data_str, $items, 'dmy');
    69|     }
    70| }


# ====================================================================
# FILE: src/whois.gtld.itsyourdomain.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ITSYOURDOMAIN_HANDLER__'))
    25|     define('__ITSYOURDOMAIN_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class itsyourdomain_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant',
    31|             'admin' => 'Administrative',
    32|             'tech' => 'Technical',
    33|             'billing' => 'Billing',
    34|             'domain.name' => 'Domain:',
    35|             'domain.nserver.' => 'Domain Name Servers:',
    36|             'domain.created' => 'Record created on ',
    37|             'domain.expires' => 'Record expires on ',
    38|             'domain.changed' => 'Record last updated on '
    39|         );
    40|         return easy_parser($data_str, $items, 'mdy');
    41|     }
    42| }


# ====================================================================
# FILE: src/whois.gtld.joker.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-62 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__JOKER_HANDLER__'))
    25|     define('__JOKER_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class joker_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'contact-hdl' => 'handle',
    31|             'modified' => 'changed',
    32|             'reseller' => 'sponsor',
    33|             'address' => 'address.street',
    34|             'postal-code' => 'address.pcode',
    35|             'city' => 'address.city',
    36|             'state' => 'address.state',
    37|             'country' => 'address.country',
    38|             'person' => 'name',
    39|             'domain' => 'name'
    40|         );
    41|         $contacts = array(
    42|             'admin-c' => 'admin',
    43|             'tech-c' => 'tech',
    44|             'billing-c' => 'billing'
    45|         );
    46|         $items = array(
    47|             'owner' => 'name',
    48|             'organization' => 'organization',
    49|             'email' => 'email',
    50|             'phone' => 'phone',
    51|             'address' => 'address',
    52|         );
    53|         $r = generic_parser_a($data_str, $translate, $contacts, 'domain', 'Ymd');
    54|         foreach ($items as $tag => $convert) {
    55|             if (isset($r['domain'][$tag])) {
    56|                 $r['owner'][$convert] = $r['domain'][$tag];
    57|                 unset($r['domain'][$tag]);
    58|             }
    59|         }
    60|         return $r;
    61|     }
    62| }


# ====================================================================
# FILE: src/whois.gtld.markmonitor.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__MARKMONITOR_HANDLER__'))
    25|     define('__MARKMONITOR_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class markmonitor_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact, Zone Contact:',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.sponsor' => 'Registrar Name:',
    35|             'domain.nserver' => 'Domain servers in listed order:',
    36|             'domain.created' => 'Created on..............:',
    37|             'domain.expires' => 'Expires on..............:',
    38|             'domain.changed' => 'Record last updated on..:'
    39|         );
    40|         $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
    41|         if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    42|             $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    43|         foreach ($r as $key => $part) {
    44|             if (isset($part['address'])) {
    45|                 $r[$key]['organization'] = array_shift($r[$key]['address']);
    46|                 $r[$key]['address']['country'] = array_pop($r[$key]['address']);
    47|             }
    48|         }
    49|         return $r;
    50|     }
    51| }


# ====================================================================
# FILE: src/whois.gtld.melbourneit.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-49 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__MELBOURNEIT_HANDLER__'))
    26|     define('__MELBOURNEIT_HANDLER__', 1);
    27| class melbourneit_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'Domain Name..........' => 'domain.name',
    31|             'Registration Date....' => 'domain.created',
    32|             'Expiry Date..........' => 'domain.expires',
    33|             'Organisation Name....' => 'owner.name',
    34|             'Organisation Address.' => 'owner.address.',
    35|             'Admin Name...........' => 'admin.name',
    36|             'Admin Address........' => 'admin.address.',
    37|             'Admin Email..........' => 'admin.email',
    38|             'Admin Phone..........' => 'admin.phone',
    39|             'Admin Fax............' => 'admin.fax',
    40|             'Tech Name............' => 'tech.name',
    41|             'Tech Address.........' => 'tech.address.',
    42|             'Tech Email...........' => 'tech.email',
    43|             'Tech Phone...........' => 'tech.phone',
    44|             'Tech Fax.............' => 'tech.fax',
    45|             'Name Server..........' => 'domain.nserver.'
    46|         );
    47|         return generic_parser_b($data_str, $items, 'ymd');
    48|     }
    49| }


# ====================================================================
# FILE: src/whois.gtld.moniker.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__MONIKER_HANDLER__'))
    25|     define('__MONIKER_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class moniker_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant',
    31|             'admin' => 'Administrative ',
    32|             'tech' => 'Technical ',
    33|             'billing' => 'Billing ',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.nserver.' => 'Domain servers in listed order:',
    36|             'domain.created' => 'Record created on: ',
    37|             'domain.expires' => 'Domain Expires on: ',
    38|             'domain.changed' => 'Database last updated on: '
    39|         );
    40|         return easy_parser($data_str, $items, 'ymd');
    41|     }
    42| }


# ====================================================================
# FILE: src/whois.gtld.name.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NAME_HANDLER__'))
    25|     define('__NAME_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class name_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'REGISTRANT CONTACT INFO',
    31|             'admin' => 'ADMINISTRATIVE CONTACT INFO',
    32|             'tech' => 'TECHNICAL CONTACT INFO',
    33|             'billing' => 'BILLING CONTACT INFO',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.sponsor' => 'Registrar',
    36|             'domain.created' => 'Creation Date',
    37|             'domain.expires' => 'Expiration Date'
    38|         );
    39|         $extra = array(
    40|             'phone:' => 'phone',
    41|             'email address:' => 'email'
    42|         );
    43|         return easy_parser($data_str, $items, 'y-m-d', $extra, false, true);
    44|     }
    45| }


# ====================================================================
# FILE: src/whois.gtld.nameintel.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-50 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NAMEINTEL_HANDLER__'))
    25|     define('__NAMEINTEL_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class nameintel_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant Contact:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.status' => 'Status:',
    35|             'domain.nserver' => 'Name Server:',
    36|             'domain.created' => 'Creation Date:',
    37|             'domain.expires' => 'Expiration Date:'
    38|         );
    39|         $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
    40|         if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    41|             $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    42|         foreach ($r as $key => $part) {
    43|             if (isset($part['address'])) {
    44|                 $r[$key]['organization'] = array_shift($r[$key]['address']);
    45|                 $r[$key]['address']['country'] = array_pop($r[$key]['address']);
    46|             }
    47|         }
    48|         return $r;
    49|     }
    50| }


# ====================================================================
# FILE: src/whois.gtld.namejuice.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NAMEJUICE_HANDLER__'))
    25|     define('__NAMEJUICE_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class namejuice_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant Contact:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'domain.name' => 'Domain name:',
    34|             'domain.nserver.' => 'Name Servers:',
    35|             'domain.created' => 'Creation date:',
    36|             'domain.expires' => 'Expiration date:',
    37|             'domain.changed' => 'Update date:',
    38|             'domain.status' => 'Status:',
    39|             'domain.sponsor' => 'Registration Service Provided By:'
    40|         );
    41|         return easy_parser($data_str, $items, 'dmy', array(), true, true);
    42|     }
    43| }


# ====================================================================
# FILE: src/whois.gtld.nameking.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-59 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NAMEKING_HANDLER__'))
    25|     define('__NAMEKING_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class nameking_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant',
    31|             'admin' => 'Admin Contact',
    32|             'tech' => 'Tech Contact',
    33|             'billing' => 'Billing Contact',
    34|             'domain.sponsor' => 'Registration Provided By:',
    35|             'domain.created' => 'Creation Date:',
    36|             'domain.expires' => 'Expiration Date:',
    37|         );
    38|         $extra = array(
    39|             'tel--' => 'phone',
    40|             'tel:' => 'phone',
    41|             'tel --:' => 'phone',
    42|             'email-:' => 'email',
    43|             'email:' => 'email',
    44|             'mail:' => 'email',
    45|             'name--' => 'name',
    46|             'org:' => 'organization',
    47|             'zipcode:' => 'address.pcode',
    48|             'postcode:' => 'address.pcode',
    49|             'address:' => 'address.street',
    50|             'city:' => 'address.city',
    51|             'province:' => 'address.city.',
    52|             ',province:' => '',
    53|             ',country:' => 'address.country',
    54|             'organization:' => 'organization',
    55|             'city, province, post code:' => 'address.city'
    56|         );
    57|         return easy_parser($data_str, $items, 'mdy', $extra, false, true);
    58|     }
    59| }


# ====================================================================
# FILE: src/whois.gtld.names4ever.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-44 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NAMES4EVER_HANDLER__'))
    25|     define('__NAMES4EVER_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class names4ever_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact',
    32|             'tech' => 'Technical  Contact',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.sponsor' => 'Registrar Name....:',
    35|             'domain.referrer' => 'Registrar Homepage:',
    36|             'domain.nserver' => 'DNS Servers:',
    37|             'domain.created' => 'Record created on',
    38|             'domain.expires' => 'Record expires on',
    39|             'domain.changed' => 'Record last updated on',
    40|             'domain.status' => 'Domain status:'
    41|         );
    42|         return easy_parser($data_str, $items, 'dmy', array(), false, true);
    43|     }
    44| }


# ====================================================================
# FILE: src/whois.gtld.namevault.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NAMEVAULT_HANDLER__'))
    25|     define('__NAMEVAULT_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class namevault_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'billing' => 'Billing Contact:',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.nserver.' => 'Name Servers',
    36|             'domain.created' => 'Creation Date:',
    37|             'domain.expires' => 'Expiration Date:',
    38|             'domain.status' => 'Status:'
    39|         );
    40|         return easy_parser($data_str, $items, 'dmy', array(), true, true);
    41|     }
    42| }


# ====================================================================
# FILE: src/whois.gtld.networksolutions.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NETWORKSOLUTIONS_HANDLER__'))
    25|     define('__NETWORKSOLUTIONS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class networksolutions_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact',
    32|             'tech' => 'Technical Contact',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.nserver.' => 'Domain servers in listed order:',
    35|             'domain.created' => 'Record created on',
    36|             'domain.expires' => 'Record expires on'
    37|         );
    38|         return easy_parser($data_str, $items, 'dmy', array(), true, true);
    39|     }
    40| }


# ====================================================================
# FILE: src/whois.gtld.nicco.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NICCO_HANDLER__'))
    25|     define('__NICCO_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class nicco_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Holder Contact',
    31|             'admin' => 'Admin Contact',
    32|             'tech' => 'Tech. Contact',
    33|             'domain.nserver.' => 'Nameservers',
    34|             'domain.created' => 'Creation Date:',
    35|             'domain.expires' => 'Expiration Date:'
    36|         );
    37|         $translate = array(
    38|             'city:' => 'address.city',
    39|             'org. name:' => 'organization',
    40|             'address1:' => 'address.street.',
    41|             'address2:' => 'address.street.',
    42|             'state:' => 'address.state',
    43|             'postal code:' => 'address.zip'
    44|         );
    45|         $r = get_blocks($data_str, $items, true);
    46|         $r['owner'] = get_contact($r['owner'], $translate);
    47|         $r['admin'] = get_contact($r['admin'], $translate, true);
    48|         $r['tech'] = get_contact($r['tech'], $translate, true);
    49|         return format_dates($r, 'dmy');
    50|     }
    51| }


# ====================================================================
# FILE: src/whois.gtld.nicline.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NICLINE_HANDLER__'))
    25|     define('__NICLINE_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class nicline_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative contact:',
    32|             'tech' => 'Technical contact:',
    33|             'domain.name' => 'Domain name:',
    34|             'domain.nserver.' => 'Domain servers in listed order:',
    35|             'domain.created' => 'Created:',
    36|             'domain.expires' => 'Expires:',
    37|             'domain.changed' => 'Last updated:'
    38|         );
    39|         return easy_parser($data_str, $items, 'dmy');
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.gtld.onlinenic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-70 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ONLINENIC_HANDLER__'))
    25|     define('__ONLINENIC_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class onlinenic_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrator:',
    32|             'tech' => 'Technical Contactor:',
    33|             'billing' => 'Billing Contactor:',
    34|             'domain.name' => 'Domain name:',
    35|             'domain.name#' => 'Domain Name:',
    36|             'domain.nserver' => 'Domain servers in listed order:',
    37|             'domain.created' => 'Record created on ',
    38|             'domain.expires' => 'Record expired on ',
    39|             'domain.changed' => 'Record last updated at '
    40|         );
    41|         $extra = array(
    42|             'tel--' => 'phone',
    43|             'tel:' => 'phone',
    44|             'tel --:' => 'phone',
    45|             'email-:' => 'email',
    46|             'email:' => 'email',
    47|             'mail:' => 'email',
    48|             'name--' => 'name',
    49|             'org:' => 'organization',
    50|             'zipcode:' => 'address.pcode',
    51|             'postcode:' => 'address.pcode',
    52|             'address:' => 'address.street',
    53|             'city:' => 'address.city',
    54|             'province:' => '',
    55|             ',province:' => '',
    56|             ',country:' => 'address.country'
    57|         );
    58|         $r = easy_parser($data_str, $items, 'mdy', $extra, false, true);
    59|         foreach ($r as $key => $part)
    60|             if (isset($part['email'])) {
    61|                 @list($email, $phone) = explode(' ', $part['email']);
    62|                 $email = str_replace('(', '', $email);
    63|                 $email = str_replace(')', '', $email);
    64|                 $r[$key]['email'] = $email;
    65|                 if ($phone != '')
    66|                     $r[$key]['phone'] = $phone;
    67|             }
    68|         return $r;
    69|     }
    70| }


# ====================================================================
# FILE: src/whois.gtld.opensrs.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-46 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__OPENSRS_HANDLER__'))
    25|     define('__OPENSRS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class opensrs_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact',
    32|             'tech' => 'Technical Contact',
    33|             'domain.name' => 'Domain name:',
    34|             '' => 'Registration Service Provider:',
    35|             'domain.nserver' => 'Domain servers in listed order:',
    36|             'domain.changed' => 'Record last updated on',
    37|             'domain.created' => 'Record created on',
    38|             'domain.expires' => 'Record expires on',
    39|             'domain.sponsor' => 'Registrar of Record:'
    40|         );
    41|         $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
    42|         if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
    43|             $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
    44|         return $r;
    45|     }
    46| }


# ====================================================================
# FILE: src/whois.gtld.ovh.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__OVH_HANDLER__'))
    25|     define('__OVH_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class ovh_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'billing' => 'Billing Contact:',
    34|             'domain.sponsor' => 'Registrar of Record:',
    35|             'domain.changed' => 'Record last updated on',
    36|             'domain.expires' => 'Record expires on',
    37|             'domain.created' => 'Record created on'
    38|         );
    39|         return easy_parser($data_str, $items, 'mdy', array(), false, true);
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.gtld.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-76 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link      http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__GTLD_HANDLER__')) {
    25|     define('__GTLD_HANDLER__', 1);
    26| }
    27| use phpWhois\WhoisClient;
    28| require_once 'whois.parser.php';
    29| class gtld_handler extends WhoisClient
    30| {
    31|     /**
    32|      * @var array $result
    33|      */
    34|     protected $result;
    35|     const REG_FIELDS = [
    36|         'Domain Name:'          => 'regrinfo.domain.name',
    37|         'Registrar:'            => 'regyinfo.registrar',
    38|         'Whois Server:'         => 'regyinfo.whois',
    39|         'Referral URL:'         => 'regyinfo.referrer',
    40|         'Name Server:'          => 'regrinfo.domain.nserver.', // identical descriptors
    41|         'Updated Date:'         => 'regrinfo.domain.changed',
    42|         'Last Updated On:'      => 'regrinfo.domain.changed',
    43|         'EPP Status:'           => 'regrinfo.domain.epp_status.',
    44|         'Status:'               => 'regrinfo.domain.status.',
    45|         'Creation Date:'        => 'regrinfo.domain.created',
    46|         'Created On:'           => 'regrinfo.domain.created',
    47|         'Expiration Date:'      => 'regrinfo.domain.expires',
    48|         'Registry Expiry Date:' => 'regrinfo.domain.expires',
    49|         'No match for '         => 'nodomain',
    50|     ];
    51|     /**
    52|      * @param array $data
    53|      * @param string $query
    54|      *
    55|      * @return array
    56|      */
    57|     public function parse($data, $query)
    58|     {
    59|         $this->query  = [];
    60|         $this->result = generic_parser_b($data['rawdata'], self::REG_FIELDS, 'dmy');
    61|         unset($this->result['registered']);
    62|         if (isset($this->result['nodomain'])) {
    63|             unset($this->result['nodomain']);
    64|             $this->result['regrinfo']['registered'] = 'no';
    65|             return $this->result;
    66|         }
    67|         if ($this->deepWhois) {
    68|             $this->result = $this->deepWhois($query, $this->result);
    69|         }
    70|         if (empty($this->result['rawdata']) || count($this->result['rawdata']) < 3) {
    71|             $this->result['rawdata'] = $data['rawdata'];
    72|         }
    73|         $this->result['regrinfo']['registered'] = 'yes';
    74|         return $this->result;
    75|     }
    76| }


# ====================================================================
# FILE: src/whois.gtld.psiusa.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-80 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__PSIUSA_HANDLER__'))
    25|     define('__PSIUSA_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class psiusa_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'created:' => 'domain.created',
    31|             'last-changed:' => 'domain.changed',
    32|             'status:' => 'domain.status',
    33|             '[owner-c] fname:' => 'owner.name.first',
    34|             '[owner-c] lname:' => 'owner.name.last',
    35|             '[owner-c] org:' => 'owner.organization',
    36|             '[owner-c] address:' => 'owner.address.street',
    37|             '[owner-c] city:' => 'owner.address.city',
    38|             '[owner-c] pcode:' => 'owner.address.pcode',
    39|             '[owner-c] country:' => 'owner.address.country',
    40|             '[owner-c] state:' => 'owner.address.state',
    41|             '[owner-c] phone:' => 'owner.phone',
    42|             '[owner-c] fax:' => 'owner.fax',
    43|             '[owner-c] email:' => 'owner.email',
    44|             '[admin-c] fname:' => 'admin.name.first',
    45|             '[admin-c] lname:' => 'admin.name.last',
    46|             '[admin-c] org:' => 'admin.organization',
    47|             '[admin-c] address:' => 'admin.address.street',
    48|             '[admin-c] city:' => 'admin.address.city',
    49|             '[admin-c] pcode:' => 'admin.address.pcode',
    50|             '[admin-c] country:' => 'admin.address.country',
    51|             '[admin-c] state:' => 'admin.address.state',
    52|             '[admin-c] phone:' => 'admin.phone',
    53|             '[admin-c] fax:' => 'admin.fax',
    54|             '[admin-c] email:' => 'admin.email',
    55|             '[tech-c] fname:' => 'tech.name.first',
    56|             '[tech-c] lname:' => 'tech.name.last',
    57|             '[tech-c] org:' => 'tech.organization',
    58|             '[tech-c] address:' => 'tech.address.street',
    59|             '[tech-c] city:' => 'tech.address.city',
    60|             '[tech-c] pcode:' => 'tech.address.pcode',
    61|             '[tech-c] country:' => 'tech.address.country',
    62|             '[tech-c] state:' => 'tech.address.state',
    63|             '[tech-c] phone:' => 'tech.phone',
    64|             '[tech-c] fax:' => 'tech.fax',
    65|             '[tech-c] email:' => 'tech.email',
    66|             '[zone-c] fname:' => 'zone.name.first',
    67|             '[zone-c] lname:' => 'zone.name.last',
    68|             '[zone-c] org:' => 'zone.organization',
    69|             '[zone-c] address:' => 'zone.address.street',
    70|             '[zone-c] city:' => 'zone.address.city',
    71|             '[zone-c] pcode:' => 'zone.address.pcode',
    72|             '[zone-c] country:' => 'zone.address.country',
    73|             '[zone-c] state:' => 'zone.address.state',
    74|             '[zone-c] phone:' => 'zone.phone',
    75|             '[zone-c] fax:' => 'zone.fax',
    76|             '[zone-c] email:' => 'zone.email',
    77|         );
    78|         return generic_parser_b($data_str, $items);
    79|     }
    80| }


# ====================================================================
# FILE: src/whois.gtld.publicdomainregistry.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-47 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__PUBLICDOMAINREGISTRY_HANDLER__'))
    25|     define('__PUBLICDOMAINREGISTRY_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class publicdomainregistry_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'owner#' => '(Registrant):',
    32|             'admin' => 'Administrative Contact',
    33|             'tech' => 'Technical Contact',
    34|             'billing' => 'Billing Contact',
    35|             'domain.name' => 'Domain name:',
    36|             'domain.sponsor' => 'Registration Service Provided By:',
    37|             'domain.nserver' => 'Domain servers in listed order:',
    38|             'domain.changed' => 'Record last updated ',
    39|             'domain.created' => 'Record created on',
    40|             'domain.created#' => 'Creation Date:',
    41|             'domain.expires' => 'Record expires on',
    42|             'domain.expires#' => 'Expiration Date:',
    43|             'domain.status' => 'Status:'
    44|         );
    45|         return easy_parser($data_str, $items, 'mdy', array(), true, true);
    46|     }
    47| }


# ====================================================================
# FILE: src/whois.gtld.register.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-52 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__REGISTER_HANDLER__'))
    25|     define('__REGISTER_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class register_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner#0' => 'Registrant Info:',
    31|             'owner#1' => 'Organization:',
    32|             'owner#2' => 'Registrant:',
    33|             'owner#3' => 'Registrant Contact:',
    34|             'admin' => 'Administrative',
    35|             'tech' => 'Technical',
    36|             'zone' => 'Zone',
    37|             'domain.sponsor#0' => 'Registrar Name....:',
    38|             'domain.sponsor#1' => 'Registration Service Provided By:',
    39|             'domain.referrer' => 'Registrar Homepage:',
    40|             'domain.nserver' => 'Domain servers in listed order:',
    41|             'domain.nserver' => 'DNS Servers:',
    42|             'domain.name' => 'Domain name:',
    43|             'domain.created#0' => 'Created on..............:',
    44|             'domain.created#1' => 'Creation date:',
    45|             'domain.expires#0' => 'Expires on..............:',
    46|             'domain.expires#1' => 'Expiration date:',
    47|             'domain.changed' => 'Record last updated on..:',
    48|             'domain.status' => 'Status:'
    49|         );
    50|         return easy_parser($data_str, $items, 'ymd');
    51|     }
    52| }


# ====================================================================
# FILE: src/whois.gtld.rrpproxy.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-82 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__RRPPROXY_HANDLER__'))
    25|     define('__RRPPROXY_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class rrpproxy_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'created-date:' => 'domain.created',
    31|             'updated-date:' => 'domain.changed',
    32|             'registration-expiration-date:' => 'domain.expires',
    33|             'RSP:' => 'domain.sponsor',
    34|             'URL:' => 'domain.referrer',
    35|             'owner-nom.contact:' => 'owner.handle',
    36|             'owner-fname:' => 'owner.name.first',
    37|             'owner-lname:' => 'owner.name.last',
    38|             'owner-organization:' => 'owner.organization',
    39|             'owner-street:' => 'owner.address.street',
    40|             'owner-city:' => 'owner.address.city',
    41|             'owner-zip:' => 'owner.address.pcode',
    42|             'owner-country:' => 'owner.address.country',
    43|             'owner-phone:' => 'owner.phone',
    44|             'owner-fax:' => 'owner.fax',
    45|             'owner-email:' => 'owner.email',
    46|             'admin-nom.contact:' => 'admin.handle',
    47|             'admin-fname:' => 'admin.name.first',
    48|             'admin-lname:' => 'admin.name.last',
    49|             'admin-organization:' => 'admin.organization',
    50|             'admin-street:' => 'admin.address.street',
    51|             'admin-city:' => 'admin.address.city',
    52|             'admin-zip:' => 'admin.address.pcode',
    53|             'admin-country:' => 'admin.address.country',
    54|             'admin-phone:' => 'admin.phone',
    55|             'admin-fax:' => 'admin.fax',
    56|             'admin-email:' => 'admin.email',
    57|             'tech-nom.contact:' => 'tech.handle',
    58|             'tech-fname:' => 'tech.name.first',
    59|             'tech-lname:' => 'tech.name.last',
    60|             'tech-organization:' => 'tech.organization',
    61|             'tech-street:' => 'tech.address.street',
    62|             'tech-city:' => 'tech.address.city',
    63|             'tech-zip:' => 'tech.address.pcode',
    64|             'tech-country:' => 'tech.address.country',
    65|             'tech-phone:' => 'tech.phone',
    66|             'tech-fax:' => 'tech.fax',
    67|             'tech-email:' => 'tech.email',
    68|             'billing-nom.contact:' => 'billing.handle',
    69|             'billing-fname:' => 'billing.name.first',
    70|             'billing-lname:' => 'billing.name.last',
    71|             'billing-organization:' => 'billing.organization',
    72|             'billing-street:' => 'billing.address.street',
    73|             'billing-city:' => 'billing.address.city',
    74|             'billing-zip:' => 'billing.address.pcode',
    75|             'billing-country:' => 'billing.address.country',
    76|             'billing-phone:' => 'billing.phone',
    77|             'billing-fax:' => 'billing.fax',
    78|             'billing-email:' => 'billing.email'
    79|         );
    80|         return generic_parser_b($data_str, $items);
    81|     }
    82| }


# ====================================================================
# FILE: src/whois.gtld.schlund.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-76 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__SCHLUND_HANDLER__'))
    25|     define('__SCHLUND_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class schlund_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'created:' => 'domain.created',
    31|             'last-changed:' => 'domain.changed',
    32|             'status:' => 'domain.status',
    33|             'registrant-firstname:' => 'owner.name.first',
    34|             'registrant-lastname:' => 'owner.name.last',
    35|             'registrant-organization:' => 'owner.organization',
    36|             'registrant-street1:' => 'owner.address.street.',
    37|             'registrant-street2:' => 'owner.address.street.',
    38|             'registrant-pcode:' => 'owner.address.pcode',
    39|             'registrant-city:' => 'owner.address.city',
    40|             'registrant-ccode:' => 'owner.address.country',
    41|             'registrant-phone:' => 'owner.phone',
    42|             'registrant-email:' => 'owner.email',
    43|             'admin-c-firstname:' => 'admin.name.first',
    44|             'admin-c-lastname:' => 'admin.name.last',
    45|             'admin-c-organization:' => 'admin.organization',
    46|             'admin-c-street1:' => 'admin.address.street.',
    47|             'admin-c-street2:' => 'admin.address.street.',
    48|             'admin-c-pcode:' => 'admin.address.pcode',
    49|             'admin-c-city:' => 'admin.address.city',
    50|             'admin-c-ccode:' => 'admin.address.country',
    51|             'admin-c-phone:' => 'admin.phone',
    52|             'admin-c-email:' => 'admin.email',
    53|             'tech-c-firstname:' => 'tech.name.first',
    54|             'tech-c-lastname:' => 'tech.name.last',
    55|             'tech-c-organization:' => 'tech.organization',
    56|             'tech-c-street1:' => 'tech.address.street.',
    57|             'tech-c-street2:' => 'tech.address.street.',
    58|             'tech-c-pcode:' => 'tech.address.pcode',
    59|             'tech-c-city:' => 'tech.address.city',
    60|             'tech-c-ccode:' => 'tech.address.country',
    61|             'tech-c-phone:' => 'tech.phone',
    62|             'tech-c-email:' => 'tech.email',
    63|             'bill-c-firstname:' => 'billing.name.first',
    64|             'bill-c-lastname:' => 'billing.name.last',
    65|             'bill-c-organization:' => 'billing.organization',
    66|             'bill-c-street1:' => 'billing.address.street.',
    67|             'bill-c-street2:' => 'billing.address.street.',
    68|             'bill-c-pcode:' => 'billing.address.pcode',
    69|             'bill-c-city:' => 'billing.address.city',
    70|             'bill-c-ccode:' => 'billing.address.country',
    71|             'bill-c-phone:' => 'billing.phone',
    72|             'bill-c-email:' => 'billing.email'
    73|         );
    74|         return generic_parser_b($data_str, $items);
    75|     }
    76| }


# ====================================================================
# FILE: src/whois.gtld.srsplus.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__SRSPLUS_HANDLER__'))
    25|     define('__SRSPLUS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class srsplus_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative',
    32|             'tech' => 'Technical',
    33|             'billing' => 'Billing',
    34|             'domain.name' => 'Domain Name:',
    35|             'domain.nserver' => 'Domain servers:',
    36|             'domain.created' => 'Record created on',
    37|             'domain.expires' => 'Record expires on'
    38|         );
    39|         return easy_parser($data_str, $items, 'ymd', array(), true, true);
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.gtld.tmagnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__TMAGNIC_HANDLER__'))
    25|     define('__TMAGNIC_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class tmagnic_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Owner Contact:',
    31|             'admin' => 'Admin Contact',
    32|             'tech' => 'Technical Contact',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.nserver.' => 'Domain servers in listed order:',
    35|             'domain.expires' => 'Record expires on: ',
    36|             'domain.changed' => 'Record last updated on: ',
    37|             '' => 'Zone Contact',
    38|             '#' => 'Punycode Name:'
    39|         );
    40|         return easy_parser($data_str, $items, 'ymd', array(), false, true);
    41|     }
    42| }


# ====================================================================
# FILE: src/whois.gtld.tvcorp.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-40 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__TVCORP_HANDLER__'))
    25|     define('__TVCORP_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class tvcorp_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant',
    31|             'admin' => 'Admin',
    32|             'tech' => 'Technical',
    33|             'billing' => 'Billing',
    34|             'domain.nserver.' => 'Domain servers:',
    35|             'domain.created' => 'Record created on',
    36|             'domain.expires' => 'Record expires on'
    37|         );
    38|         return easy_parser($data_str, $items, 'mdy');
    39|     }
    40| }


# ====================================================================
# FILE: src/whois.gtld.wildwestdomains.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__WILDWESTDOMAINS_HANDLER__'))
    25|     define('__WILDWESTDOMAINS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class wildwestdomains_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'domain.name' => 'Domain name:',
    34|             'domain.sponsor' => 'Registered through:',
    35|             'domain.nserver' => 'Domain servers in listed order:',
    36|             'domain.created' => 'Created on:',
    37|             'domain.expires' => 'Expires on:',
    38|             'domain.changed' => 'Last Updated on:'
    39|         );
    40|         return easy_parser($data_str, $items, 'mdy');
    41|     }
    42| }


# ====================================================================
# FILE: src/whois.hu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-42 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__HU_HANDLER__'))
    25|     define('__HU_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class hu_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'domain:' => 'domain.name',
    31|             'record created:' => 'domain.created'
    32|         );
    33|         $r = array();
    34|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
    35|         if (isset($r['regrinfo']['domain']))
    36|             $r['regrinfo']['registered'] = 'yes';
    37|         else
    38|             $r['regrinfo']['registered'] = 'no';
    39|         $r['regyinfo'] = array('referrer' => 'http://www.nic.hu', 'registrar' => 'HUNIC');
    40|         return $r;
    41|     }
    42| }


# ====================================================================
# FILE: src/whois.ie.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__IE_HANDLER__'))
    25|     define('__IE_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class ie_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'nic-hdl' => 'handle',
    31|             'person' => 'name',
    32|             'renewal' => 'expires'
    33|         );
    34|         $contacts = array(
    35|             'admin-c' => 'admin',
    36|             'tech-c' => 'tech',
    37|         );
    38|         $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    39|         if (isset($reg['domain']['descr'])) {
    40|             $reg['owner']['organization'] = $reg['domain']['descr'][0];
    41|             unset($reg['domain']['descr']);
    42|         }
    43|         $r = array();
    44|         $r['regrinfo'] = $reg;
    45|         $r['regyinfo'] = array(
    46|             'referrer' => 'http://www.domainregistry.ie',
    47|             'registrar' => 'IE Domain Registry'
    48|         );
    49|         return $r;
    50|     }
    51| }


# ====================================================================
# FILE: src/whois.il.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-83 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__IL_HANDLER__'))
    25|     define('__IL_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class il_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'fax-no' => 'fax',
    31|             'e-mail' => 'email',
    32|             'nic-hdl' => 'handle',
    33|             'person' => 'name',
    34|             'personname' => 'name',
    35|             'address' => 'address'/* ,
    36|                   'address' => 'address.city',
    37|                   'address' => 'address.pcode',
    38|                   'address' => 'address.country' */
    39|         );
    40|         $contacts = array(
    41|             'registrant' => 'owner',
    42|             'admin-c' => 'admin',
    43|             'tech-c' => 'tech',
    44|             'billing-c' => 'billing',
    45|             'zone-c' => 'zone'
    46|         );
    47|         array_splice($data_str['rawdata'], 16, 1);
    48|         array_splice($data_str['rawdata'], 18, 1);
    49|         $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    50|         if (isset($reg['domain']['remarks']))
    51|             unset($reg['domain']['remarks']);
    52|         if (isset($reg['domain']['descr:'])) {
    53|             foreach ($reg['domain']['descr:'] as $key => $val) {
    54|                 $v = trim(substr(strstr($val, ':'), 1));
    55|                 if (strstr($val, '[organization]:')) {
    56|                     $reg['owner']['organization'] = $v;
    57|                     continue;
    58|                 }
    59|                 if (strstr($val, '[phone]:')) {
    60|                     $reg['owner']['phone'] = $v;
    61|                     continue;
    62|                 }
    63|                 if (strstr($val, '[fax-no]:')) {
    64|                     $reg['owner']['fax'] = $v;
    65|                     continue;
    66|                 }
    67|                 if (strstr($val, '[e-mail]:')) {
    68|                     $reg['owner']['email'] = $v;
    69|                     continue;
    70|                 }
    71|                 $reg['owner']['address'][$key] = $v;
    72|             }
    73|             unset($reg['domain']['descr:']);
    74|         }
    75|         $r = array();
    76|         $r['regrinfo'] = $reg;
    77|         $r['regyinfo'] = array(
    78|             'referrer' => 'http://www.isoc.org.il/',
    79|             'registrar' => 'ISOC-IL'
    80|         );
    81|         return $r;
    82|     }
    83| }


# ====================================================================
# FILE: src/whois.in.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__IN_HANDLER__'))
    25|     define('__IN_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class in_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         $r['regyinfo'] = array(
    32|             'referrer' => 'http://whois.registry.in',
    33|             'registrar' => 'INRegistry'
    34|         );
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.info.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__INFO_HANDLER__'))
    25|     define('__INFO_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class info_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         $r['regyinfo'] = array(
    32|             'referrer' => 'http://whois.afilias.info',
    33|             'registrar' => 'Afilias Global Registry Services'
    34|         );
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.int.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-36 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__INT_HANDLER__'))
    25|     define('__INT_HANDLER__', 1);
    26| require_once('whois.gtld.iana.php');
    27| class int_handler {
    28|     function parse($data_str, $query) {
    29|         $iana = new iana_handler();
    30|         $r = array();
    31|         $r['regrinfo'] = $iana->parse($data_str['rawdata'], $query);
    32|         $r['regyinfo']['referrer'] = 'http://www.iana.org/int-dom/int.htm';
    33|         $r['regyinfo']['registrar'] = 'Internet Assigned Numbers Authority';
    34|         return $r;
    35|     }
    36| }


# ====================================================================
# FILE: src/whois.ip.afrinic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-60 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__AFRINIC_HANDLER__'))
    26|     define('__AFRINIC_HANDLER__', 1);
    27| class afrinic_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'fax-no' => 'fax',
    31|             'e-mail' => 'email',
    32|             'nic-hdl' => 'handle',
    33|             'person' => 'name',
    34|             'netname' => 'name',
    35|             'organisation' => 'handle',
    36|             'org-name' => 'organization',
    37|             'org-type' => 'type'
    38|         );
    39|         $contacts = array(
    40|             'admin-c' => 'admin',
    41|             'tech-c' => 'tech',
    42|             'org' => 'owner'
    43|         );
    44|         $r = generic_parser_a($data_str, $translate, $contacts, 'network', 'Ymd');
    45|         if (isset($r['network']['descr'])) {
    46|             $r['owner']['organization'] = $r['network']['descr'];
    47|             unset($r['network']['descr']);
    48|         }
    49|         if (isset($r['owner']['remarks']) && is_array($r['owner']['remarks']))
    50|             foreach ($r['owner']['remarks'] as $val) {
    51|                 $pos = strpos($val, 'rwhois://');
    52|                 if ($pos !== false)
    53|                     $r['rwhois'] = strtok(substr($val, $pos), ' ');
    54|             }
    55|         $r = array('regrinfo' => $r);
    56|         $r['regyinfo']['type'] = 'ip';
    57|         $r['regyinfo']['registrar'] = 'African Network Information Center';
    58|         return $r;
    59|     }
    60| }


# ====================================================================
# FILE: src/whois.ip.apnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-95 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__APNIC_HANDLER__'))
    26|     define('__APNIC_HANDLER__', 1);
    27| class apnic_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'fax-no' => 'fax',
    31|             'e-mail' => 'email',
    32|             'nic-hdl' => 'handle',
    33|             'person' => 'name',
    34|             'country' => 'address',
    35|             'netname' => 'name',
    36|             'descr' => 'desc',
    37|             'aut-num' => 'handle',
    38|             'country' => 'country'
    39|         );
    40|         $contacts = array(
    41|             'admin-c' => 'admin',
    42|             'tech-c' => 'tech'
    43|         );
    44|         $blocks = generic_parser_a_blocks($data_str, $translate, $disclaimer);
    45|         $r = array();
    46|         if (isset($disclaimer) && is_array($disclaimer))
    47|             $r['disclaimer'] = $disclaimer;
    48|         if (empty($blocks) || !is_array($blocks['main'])) {
    49|             $r['registered'] = 'no';
    50|         } else {
    51|             if (isset($blocks[$query])) {
    52|                 $as = true;
    53|                 $rb = $blocks[$query];
    54|             } else {
    55|                 $rb = $blocks['main'];
    56|                 $as = false;
    57|             }
    58|             $r['registered'] = 'yes';
    59|             foreach ($contacts as $key => $val) {
    60|                 if (isset($rb[$key])) {
    61|                     if (is_array($rb[$key])) {
    62|                         $blk = $rb[$key][count($rb[$key]) - 1];
    63|                     } else {
    64|                         $blk = $rb[$key];
    65|                     }
    66|                     if (isset($blocks[$blk])) {
    67|                         $r[$val] = $blocks[$blk];
    68|                     }
    69|                     unset($rb[$key]);
    70|                 }
    71|             }
    72|             $r['network'] = $rb;
    73|             format_dates($r, 'Ymd');
    74|             if (isset($r['network']['desc'])) {
    75|                 if (is_array($r['network']['desc'])) {
    76|                     $r['owner']['organization'] = array_shift($r['network']['desc']);
    77|                     $r['owner']['address'] = $r['network']['desc'];
    78|                 } else
    79|                     $r['owner']['organization'] = $r['network']['desc'];
    80|                 unset($r['network']['desc']);
    81|             }
    82|             if (isset($r['network']['address'])) {
    83|                 if (isset($r['owner']['address']))
    84|                     $r['owner']['address'][] = $r['network']['address'];
    85|                 else
    86|                     $r['owner']['address'] = $r['network']['address'];
    87|                 unset($r['network']['address']);
    88|             }
    89|         }
    90|         $r = array('regrinfo' => $r);
    91|         $r['regyinfo']['type'] = 'ip';
    92|         $r['regyinfo']['registrar'] = 'Asia Pacific Network Information Centre';
    93|         return $r;
    94|     }
    95| }


# ====================================================================
# FILE: src/whois.ip.arin.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-65 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ARIN_HANDLER__'))
    25|     define('__ARIN_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class arin_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'OrgName:' => 'owner.organization',
    31|             'CustName:' => 'owner.organization',
    32|             'OrgId:' => 'owner.handle',
    33|             'Address:' => 'owner.address.street.',
    34|             'City:' => 'owner.address.city',
    35|             'StateProv:' => 'owner.address.state',
    36|             'PostalCode:' => 'owner.address.pcode',
    37|             'Country:' => 'owner.address.country',
    38|             'NetRange:' => 'network.inetnum',
    39|             'NetName:' => 'network.name',
    40|             'NetHandle:' => 'network.handle',
    41|             'NetType:' => 'network.status',
    42|             'NameServer:' => 'network.nserver.',
    43|             'Comment:' => 'network.desc.',
    44|             'RegDate:' => 'network.created',
    45|             'Updated:' => 'network.changed',
    46|             'ASHandle:' => 'network.handle',
    47|             'ASName:' => 'network.name',
    48|             'NetHandle:' => 'network.handle',
    49|             'NetName:' => 'network.name',
    50|             'TechHandle:' => 'tech.handle',
    51|             'TechName:' => 'tech.name',
    52|             'TechPhone:' => 'tech.phone',
    53|             'TechEmail:' => 'tech.email',
    54|             'OrgAbuseName:' => 'abuse.name',
    55|             'OrgAbuseHandle:' => 'abuse.handle',
    56|             'OrgAbusePhone:' => 'abuse.phone',
    57|             'OrgAbuseEmail:' => 'abuse.email.',
    58|             'ReferralServer:' => 'rwhois'
    59|         );
    60|         $r = generic_parser_b($data_str, $items, 'ymd', false, true);
    61|         if (@isset($r['abuse']['email']))
    62|             $r['abuse']['email'] = implode(',', $r['abuse']['email']);
    63|         return array('regrinfo' => $r);
    64|     }
    65| }


# ====================================================================
# FILE: src/whois.ip.krnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-91 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__KRNIC_HANDLER__'))
    25|     define('__KRNIC_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class krnic_handler {
    28|     function parse($data_str, $query) {
    29|         $blocks = array(
    30|             'owner1' => '[ Organization Information ]',
    31|             'tech1' => '[ Technical Contact Information ]',
    32|             'owner2' => '[ ISP Organization Information ]',
    33|             'admin2' => '[ ISP IP Admin Contact Information ]',
    34|             'tech2' => '[ ISP IP Tech Contact Information ]',
    35|             'admin3' => '[ ISP IPv4 Admin Contact Information ]',
    36|             'tech3' => '[ ISP IPv4 Tech Contact Information ]',
    37|             'abuse' => '[ ISP Network Abuse Contact Information ]',
    38|             'network.inetnum' => 'IPv4 Address       :',
    39|             'network.name' => 'Network Name       :',
    40|             'network.mnt-by' => 'Connect ISP Name   :',
    41|             'network.created' => 'Registration Date  :'
    42|         );
    43|         $items = array(
    44|             'Orgnization ID     :' => 'handle',
    45|             'Org Name      :' => 'organization',
    46|             'Org Name           :' => 'organization',
    47|             'Name          :' => 'name',
    48|             'Name               :' => 'name',
    49|             'Org Address   :' => 'address.street',
    50|             'Zip Code      :' => 'address.pcode',
    51|             'State         :' => 'address.state',
    52|             'Address            :' => 'address.street',
    53|             'Zip Code           :' => 'address.pcode',
    54|             'Phone         :' => 'phone',
    55|             'Phone              :' => 'phone',
    56|             'Fax           :' => 'fax',
    57|             'E-Mail        :' => 'email',
    58|             'E-Mail             :' => 'email'
    59|         );
    60|         $b = get_blocks($data_str, $blocks);
    61|         $r = array();
    62|         if (isset($b['network'])) {
    63|             $r['network'] = $b['network'];
    64|         }
    65|         if (isset($b['owner1'])) {
    66|             $r['owner'] = generic_parser_b($b['owner1'], $items, 'Ymd', false);
    67|         } elseif (isset($b['owner2'])) {
    68|             $r['owner'] = generic_parser_b($b['owner2'], $items, 'Ymd', false);
    69|         }
    70|         if (isset($b['admin2'])) {
    71|             $r['admin'] = generic_parser_b($b['admin2'], $items, 'Ymd', false);
    72|         } elseif (isset($b['admin3'])) {
    73|             $r['admin'] = generic_parser_b($b['admin3'], $items, 'Ymd', false);
    74|         }
    75|         if (isset($b['tech1'])) {
    76|             $r['tech'] = generic_parser_b($b['tech1'], $items, 'Ymd', false);
    77|         } elseif (isset($b['tech2'])) {
    78|             $r['tech'] = generic_parser_b($b['tech2'], $items, 'Ymd', false);
    79|         } elseif (isset($b['tech3'])) {
    80|             $r['tech'] = generic_parser_b($b['tech3'], $items, 'Ymd', false);
    81|         }
    82|         if (isset($b['abuse'])) {
    83|             $r['abuse'] = generic_parser_b($b['abuse'], $items, 'Ymd', false);
    84|         }
    85|         $r = format_dates($r, 'Ymd');
    86|         $r = array('regrinfo' => $r);
    87|         $r['regyinfo']['type'] = 'ip';
    88|         $r['regyinfo']['registrar'] = 'Korean Network Information Centre';
    89|         return $r;
    90|     }
    91| }


# ====================================================================
# FILE: src/whois.ip.lacnic.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-64 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__LACNIC_HANDLER__'))
    26|     define('__LACNIC_HANDLER__', 1);
    27| class lacnic_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'fax-no' => 'fax',
    31|             'e-mail' => 'email',
    32|             'nic-hdl-br' => 'handle',
    33|             'nic-hdl' => 'handle',
    34|             'person' => 'name',
    35|             'netname' => 'name',
    36|             'descr' => 'desc',
    37|             'country' => 'address.country'
    38|         );
    39|         $contacts = array(
    40|             'owner-c' => 'owner',
    41|             'tech-c' => 'tech',
    42|             'abuse-c' => 'abuse',
    43|             'admin-c' => 'admin'
    44|         );
    45|         $r = generic_parser_a($data_str, $translate, $contacts, 'network');
    46|         unset($r['network']['owner']);
    47|         unset($r['network']['ownerid']);
    48|         unset($r['network']['responsible']);
    49|         unset($r['network']['address']);
    50|         unset($r['network']['phone']);
    51|         unset($r['network']['aut-num']);
    52|         unset($r['network']['nsstat']);
    53|         unset($r['network']['nslastaa']);
    54|         unset($r['network']['inetrev']);
    55|         if (!empty($r['network']['aut-num']))
    56|             $r['network']['handle'] = $r['network']['aut-num'];
    57|         if (isset($r['network']['nserver']))
    58|             $r['network']['nserver'] = array_unique($r['network']['nserver']);
    59|         $r = array('regrinfo' => $r);
    60|         $r['regyinfo']['type'] = 'ip';
    61|         $r['regyinfo']['registrar'] = 'Latin American and Caribbean IP address Regional Registry';
    62|         return $r;
    63|     }
    64| }


# ====================================================================
# FILE: src/whois.ip.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-203 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__IP_HANDLER__'))
    25|     define('__IP_HANDLER__', 1);
    26| use phpWhois\WhoisClient;
    27| class ip_handler extends WhoisClient {
    28|     /** @var Deep whois? */
    29|     public $deepWhois = true;
    30|     public $REGISTRARS = array(
    31|         'European Regional Internet Registry/RIPE NCC' => 'whois.ripe.net',
    32|         'RIPE Network Coordination Centre' => 'whois.ripe.net',
    33|         'Asia Pacific Network Information	Center' => 'whois.apnic.net',
    34|         'Asia Pacific Network Information Centre' => 'whois.apnic.net',
    35|         'Latin American and Caribbean IP address Regional Registry' => 'whois.lacnic.net',
    36|         'African Network Information Center' => 'whois.afrinic.net'
    37|     );
    38|     public $HANDLERS = array(
    39|         'whois.krnic.net' => 'krnic',
    40|         'whois.apnic.net' => 'apnic',
    41|         'whois.ripe.net' => 'ripe',
    42|         'whois.arin.net' => 'arin',
    43|         'whois.lacnic.net' => 'lacnic',
    44|         'whois.afrinic.net' => 'afrinic'
    45|     );
    46|     public $more_data = array(); // More queries to get more accurated data
    47|     public $done = array();
    48|     public function parse($data, $query) {
    49|         $result = array(
    50|             'regrinfo' => array(),
    51|             'regyinfo' => array(),
    52|             'rawdata' => array(),
    53|         );
    54|         $result['regyinfo']['registrar'] = 'American Registry for Internet Numbers (ARIN)';
    55|         if (strpos($query, '.') === false)
    56|             $result['regyinfo']['type'] = 'AS';
    57|         else
    58|             $result['regyinfo']['type'] = 'ip';
    59|         if (!$this->deepWhois)
    60|             return null;
    61|         $this->query = array();
    62|         $this->query['server'] = 'whois.arin.net';
    63|         $this->query['query'] = $query;
    64|         $rawdata = $data['rawdata'];
    65|         if (empty($rawdata))
    66|             return $result;
    67|         $presults = array();
    68|         $presults[] = $rawdata;
    69|         $ip = ip2long($query);
    70|         $done = array();
    71|         while (count($presults) > 0) {
    72|             $rwdata = array_shift($presults);
    73|             $found = false;
    74|             foreach ($rwdata as $line) {
    75|                 if (strstr($line,'CIDR')){
    76|                 }
    77|                 if (!strncmp($line, 'American Registry for Internet Numbers', 38))
    78|                     continue;
    79|                 $p = strpos($line, '(NETBLK-');
    80|                 if ($p === false)
    81|                     $p = strpos($line, '(NET-');
    82|                 if ($p !== false) {
    83|                     $net = strtok(substr($line, $p + 1), ') ');
    84|                     $clearedLine = str_replace(' ', '', substr($line, $p + strlen($net) + 3));
    85|                     if ($clearedLine !== '') {
    86|                         list($low, $high) = explode('-', str_replace(' ', '', substr($line, $p + strlen($net) + 3)));
    87|                         if (!isset($done[$net]) && $ip >= ip2long($low) && $ip <= ip2long($high)) {
    88|                             $owner = substr($line, 0, $p - 1);
    89|                             if (!empty($this->REGISTRARS['owner'])) {
    90|                                 $this->handle_rwhois($this->REGISTRARS['owner'], $query);
    91|                                 break 2;
    92|                             } else {
    93|                                 $this->query['args'] = 'n '.$net;
    94|                                 $presults[] = $this->getRawData($net);
    95|                                 $done[$net] = 1;
    96|                             }
    97|                         }
    98|                         $found = true;
    99|                     }
   100|                 }
   101|             }
   102|             if (!$found) {
   103|                 $this->query['file'] = 'whois.ip.arin.php';
   104|                 $this->query['handler'] = 'arin';
   105|                 $result = $this->parse_results($result, $rwdata, $query, true);
   106|             }
   107|         }
   108|         unset($this->query['args']);
   109|         while (count($this->more_data) > 0) {
   110|             $srv_data = array_shift($this->more_data);
   111|             $this->query['server'] = $srv_data['server'];
   112|             unset($this->query['handler']);
   113|             $rwdata = $this->getRawData($srv_data['query']);
   114|             if (!empty($rwdata)) {
   115|                 if (!empty($srv_data['handler'])) {
   116|                     $this->query['handler'] = $srv_data['handler'];
   117|                     if (!empty($srv_data['file']))
   118|                         $this->query['file'] = $srv_data['file'];
   119|                     else
   120|                         $this->query['file'] = 'whois.' . $this->query['handler'] . '.php';
   121|                 }
   122|                 $result = $this->parse_results($result, $rwdata, $query, $srv_data['reset']);
   123|                 $result = $this->setWhoisInfo($result);
   124|                 $reset = false;
   125|             }
   126|         }
   127|         if (isset($result['regrinfo']['network']['nserver'])) {
   128|             if (!is_array($result['regrinfo']['network']['nserver'])) {
   129|                 unset($result['regrinfo']['network']['nserver']);
   130|             } else
   131|                 $result['regrinfo']['network']['nserver'] = $this->fixNameServer($result['regrinfo']['network']['nserver']);
   132|         }
   133|         return $result;
   134|     }
   135|     public function parse_results($result, $rwdata, $query, $reset) {
   136|         $rwres = $this->process($rwdata);
   137|         if ($result['regyinfo']['type'] == 'AS' && !empty($rwres['regrinfo']['network'])) {
   138|             $rwres['regrinfo']['AS'] = $rwres['regrinfo']['network'];
   139|             unset($rwres['regrinfo']['network']);
   140|         }
   141|         if ($reset) {
   142|             $result['regrinfo'] = $rwres['regrinfo'];
   143|             $result['rawdata'] = $rwdata;
   144|         } else {
   145|             $result['rawdata'][] = '';
   146|             foreach ($rwdata as $line)
   147|                 $result['rawdata'][] = $line;
   148|             foreach ($rwres['regrinfo'] as $key => $data) {
   149|                 $result = $this->join_result($result, $key, $rwres);
   150|             }
   151|         }
   152|         if ($this->deepWhois) {
   153|             if (isset($rwres['regrinfo']['rwhois'])) {
   154|                 $this->handle_rwhois($rwres['regrinfo']['rwhois'], $query);
   155|                 unset($result['regrinfo']['rwhois']);
   156|             } else
   157|             if (!@empty($rwres['regrinfo']['owner']['organization']))
   158|                 switch ($rwres['regrinfo']['owner']['organization']) {
   159|                     case 'KRNIC':
   160|                         $this->handle_rwhois('whois.krnic.net', $query);
   161|                         break;
   162|                     case 'African Network Information Center':
   163|                         $this->handle_rwhois('whois.afrinic.net', $query);
   164|                         break;
   165|                 }
   166|         }
   167|         if (!empty($rwres['regyinfo']))
   168|             $result['regyinfo'] = array_merge($result['regyinfo'], $rwres['regyinfo']);
   169|         return $result;
   170|     }
   171|     public function handle_rwhois($server, $query) {
   172|         $parts = parse_url($server);
   173|         if (empty($parts['host']))
   174|             $host = $parts['path'];
   175|         else
   176|             $host = $parts['host'];
   177|         if (array_key_exists($host, $this->done))
   178|             return;
   179|         $q = array(
   180|             'query' => $query,
   181|             'server' => $server
   182|         );
   183|         if (isset($this->HANDLERS[$host])) {
   184|             $q['handler'] = $this->HANDLERS[$host];
   185|             $q['file'] = sprintf('whois.ip.%s.php', $q['handler']);
   186|             $q['reset'] = true;
   187|         } else {
   188|             $q['handler'] = 'rwhois';
   189|             $q['reset'] = false;
   190|             unset($q['file']);
   191|         }
   192|         $this->more_data[] = $q;
   193|         $this->done[$host] = 1;
   194|     }
   195|     public function join_result($result, $key, $newres) {
   196|         if (isset($result['regrinfo'][$key]) && !array_key_exists(0, $result['regrinfo'][$key])) {
   197|             $r = $result['regrinfo'][$key];
   198|             $result['regrinfo'][$key] = array($r);
   199|         }
   200|         $result['regrinfo'][$key][] = $newres['regrinfo'][$key];
   201|         return $result;
   202|     }
   203| }


# ====================================================================
# FILE: src/whois.ip.ripe.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-69 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__RIPE_HANDLER__'))
    26|     define('__RIPE_HANDLER__', 1);
    27| class ripe_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'fax-no' => 'fax',
    31|             'e-mail' => 'email',
    32|             'nic-hdl' => 'handle',
    33|             'person' => 'name',
    34|             'netname' => 'name',
    35|             'descr' => 'desc'
    36|         );
    37|         $contacts = array(
    38|             'admin-c' => 'admin',
    39|             'tech-c' => 'tech'
    40|         );
    41|         if (!empty($data_str['rawdata']))
    42|             $data_str = $data_str['rawdata'];
    43|         $r = generic_parser_a($data_str, $translate, $contacts, 'network');
    44|         if (isset($r['network']['desc'])) {
    45|             $r['owner']['organization'] = $r['network']['desc'];
    46|             unset($r['network']['desc']);
    47|         }
    48|         if (isset($r['admin']['abuse-mailbox'])) {
    49|             $r['abuse']['email'] = $r['admin']['abuse-mailbox'];
    50|             unset($r['admin']['abuse-mailbox']);
    51|         }
    52|         if (isset($r['tech']['abuse-mailbox'])) {
    53|             $r['abuse']['email'] = $r['tech']['abuse-mailbox'];
    54|             unset($r['tech']['abuse-mailbox']);
    55|         }
    56|         if (isset($r['tech']['tech-c']))
    57|             unset($r['tech']['tech-c']);
    58|         if (isset($r['tech']['admin-c']))
    59|             unset($r['tech']['admin-c']);
    60|         if (isset($r['admin']['tech-c']))
    61|             unset($r['admin']['tech-c']);
    62|         if (isset($r['admin']['admin-c']))
    63|             unset($r['admin']['admin-c']);
    64|         $r = array('regrinfo' => $r);
    65|         $r['regyinfo']['type'] = 'ip';
    66|         $r['regyinfo']['registrar'] = 'RIPE Network Coordination Centre';
    67|         return $r;
    68|     }
    69| }


# ====================================================================
# FILE: src/whois.ir.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-54 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__IR_HANDLER__'))
    25|     define('__IR_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| /**
    28|  * IR Domain names lookup handler class.
    29|  */
    30| class ir_handler {
    31|     function parse($data_str, $query) {
    32|         $translate = array(
    33|             'nic-hdl' => 'handle',
    34|             'org' => 'organization',
    35|             'e-mail' => 'email',
    36|             'person' => 'name',
    37|             'fax-no' => 'fax',
    38|             'domain' => 'name'
    39|         );
    40|         $contacts = array(
    41|             'admin-c' => 'admin',
    42|             'tech-c' => 'tech',
    43|             'holder-c' => 'owner'
    44|         );
    45|         $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    46|         $r = array();
    47|         $r['regrinfo'] = $reg;
    48|         $r['regyinfo'] = array(
    49|             'referrer' => 'http://whois.nic.ir/',
    50|             'registrar' => 'NIC-IR'
    51|         );
    52|         return $r;
    53|     }
    54| }


# ====================================================================
# FILE: src/whois.is.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-56 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__IS_HANDLER__'))
    25|     define('__IS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class is_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'fax-no' => 'fax',
    31|             'e-mail' => 'email',
    32|             'nic-hdl' => 'handle',
    33|             'person' => 'name'
    34|         );
    35|         $contacts = array(
    36|             'owner-c' => 'owner',
    37|             'admin-c' => 'admin',
    38|             'tech-c' => 'tech',
    39|             'billing-c' => 'billing',
    40|             'zone-c' => 'zone'
    41|         );
    42|         $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'mdy');
    43|         if (isset($reg['domain']['descr'])) {
    44|             $reg['owner']['name'] = array_shift($reg['domain']['descr']);
    45|             $reg['owner']['address'] = $reg['domain']['descr'];
    46|             unset($reg['domain']['descr']);
    47|         }
    48|         $r = array();
    49|         $r['regrinfo'] = $reg;
    50|         $r['regyinfo'] = array(
    51|             'referrer' => 'http://www.isnic.is',
    52|             'registrar' => 'ISNIC'
    53|         );
    54|         return $r;
    55|     }
    56| }


# ====================================================================
# FILE: src/whois.it.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-64 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| /**
    25|  * @todo BUG
    26|  * - nserver -> array
    27|  * - ContactID in address
    28|  */
    29| if (!defined('__IT_HANDLER__'))
    30|     define('__IT_HANDLER__', 1);
    31| require_once('whois.parser.php');
    32| class it_handler {
    33|     function parse($data_str, $query) {
    34|         $items = array(
    35|             'domain.name' => 'Domain:',
    36|             'domain.nserver' => 'Nameservers',
    37|             'domain.status' => 'Status:',
    38|             'domain.expires' => 'Expire Date:',
    39|             'owner' => 'Registrant',
    40|             'admin' => 'Admin Contact',
    41|             'tech' => 'Technical Contacts',
    42|             'registrar' => 'Registrar'
    43|         );
    44|         $extra = array(
    45|             'address:' => 'address.',
    46|             'contactid:' => 'handle',
    47|             'organization:' => 'organization',
    48|             'created:' => 'created',
    49|             'last update:' => 'changed',
    50|             'web:' => 'web'
    51|         );
    52|         $r = array();
    53|         $r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd', $extra);
    54|         if (isset($r['regrinfo']['registrar'])) {
    55|             $r['regrinfo']['domain']['registrar'] = $r['regrinfo']['registrar'];
    56|             unset($r['regrinfo']['registrar']);
    57|         }
    58|         $r['regyinfo'] = array(
    59|             'registrar' => 'IT-Nic',
    60|             'referrer' => 'http://www.nic.it/'
    61|         );
    62|         return $r;
    63|     }
    64| }


# ====================================================================
# FILE: src/whois.jp.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-91 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__JP_HANDLER__'))
    25|     define('__JP_HANDLER__', 1);
    26| use phpWhois\WhoisClient;
    27| require_once('whois.parser.php');
    28| class jp_handler extends WhoisClient {
    29|     function parse($data_str, $query) {
    30|         $items = array(
    31|             '[State]' => 'domain.status',
    32|             '[Status]' => 'domain.status',
    33|             '[Registered Date]' => 'domain.created',
    34|             '[Created on]' => 'domain.created',
    35|             '[Expires on]' => 'domain.expires',
    36|             '[Last Updated]' => 'domain.changed',
    37|             '[Last Update]' => 'domain.changed',
    38|             '[Organization]' => 'owner.organization',
    39|             '[Name]' => 'owner.name',
    40|             '[Email]' => 'owner.email',
    41|             '[Postal code]' => 'owner.address.pcode',
    42|             '[Postal Address]' => 'owner.address.street',
    43|             '[Phone]' => 'owner.phone',
    44|             '[Fax]' => 'owner.fax',
    45|             '[Administrative Contact]' => 'admin.handle',
    46|             '[Technical Contact]' => 'tech.handle',
    47|             '[Name Server]' => 'domain.nserver.'
    48|         );
    49|         $r = array();
    50|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
    51|         $r['regyinfo'] = array(
    52|             'referrer' => 'http://www.jprs.jp',
    53|             'registrar' => 'Japan Registry Services'
    54|         );
    55|         if (!$this->deepWhois)
    56|             return $r;
    57|         $r['rawdata'] = $data_str['rawdata'];
    58|         $items = array(
    59|             'a. [JPNIC Handle]' => 'handle',
    60|             'c. [Last, First]' => 'name',
    61|             'd. [E-Mail]' => 'email',
    62|             'g. [Organization]' => 'organization',
    63|             'o. [TEL]' => 'phone',
    64|             'p. [FAX]' => 'fax',
    65|             '[Last Update]' => 'changed'
    66|         );
    67|         $this->query['server'] = 'jp.whois-servers.net';
    68|         if (!empty($r['regrinfo']['admin']['handle'])) {
    69|             $rwdata = $this->getRawData('CONTACT ' . $r['regrinfo']['admin']['handle'] . '/e');
    70|             $r['rawdata'][] = '';
    71|             $r['rawdata'] = array_merge($r['rawdata'], $rwdata);
    72|             $r['regrinfo']['admin'] = generic_parser_b($rwdata, $items, 'ymd', false);
    73|             $r = $this->setWhoisInfo($r);
    74|         }
    75|         if (!empty($r['regrinfo']['tech']['handle'])) {
    76|             if (!empty($r['regrinfo']['admin']['handle']) &&
    77|                     $r['regrinfo']['admin']['handle'] == $r['regrinfo']['tech']['handle']) {
    78|                 $r['regrinfo']['tech'] = $r['regrinfo']['admin'];
    79|             } else {
    80|                 unset($this->query);
    81|                 $this->query['server'] = 'jp.whois-servers.net';
    82|                 $rwdata = $this->getRawData('CONTACT ' . $r['regrinfo']['tech']['handle'] . '/e');
    83|                 $r['rawdata'][] = '';
    84|                 $r['rawdata'] = array_merge($r['rawdata'], $rwdata);
    85|                 $r['regrinfo']['tech'] = generic_parser_b($rwdata, $items, 'ymd', false);
    86|                 $r = $this->setWhoisInfo($r);
    87|             }
    88|         }
    89|         return $r;
    90|     }
    91| }


# ====================================================================
# FILE: src/whois.london.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @copyright Copyright (c) 2020 Joshua Smith
    20|  */
    21| if (!defined('__LONDON_HANDLER__')) {
    22|     define('__LONDON_HANDLER__', 1);
    23| }
    24| require_once('whois.parser.php');
    25| /**
    26|  * Class london_handler
    27|  */
    28| class london_handler
    29| {
    30|     function parse($data_str, $query)
    31|     {
    32|         $r = [
    33|             'regrinfo' => generic_parser_b($data_str['rawdata']),
    34|             'rawdata'  => $data_str['rawdata'],
    35|         ];
    36|         if (!isset($r['regrinfo']['domain']['name'])) {
    37|             $r['regrinfo']['domain']['name'] = $query;
    38|         }
    39|         return $r;
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.lt.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-53 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__LT_HANDLER__'))
    25|     define('__LT_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class lt_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'contact nic-hdl:' => 'handle',
    31|             'contact name:' => 'name'
    32|         );
    33|         $items = array(
    34|             'admin' => 'Contact type:      Admin',
    35|             'tech' => 'Contact type:      Tech',
    36|             'zone' => 'Contact type:      Zone',
    37|             'owner.name' => 'Registrar:',
    38|             'owner.email' => 'Registrar email:',
    39|             'domain.status' => 'Status:',
    40|             'domain.created' => 'Registered:',
    41|             'domain.changed' => 'Last updated:',
    42|             'domain.nserver.' => 'NS:',
    43|             '' => '%'
    44|         );
    45|         $r = array();
    46|         $r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd', $translate);
    47|         $r['regyinfo'] = array(
    48|             'referrer' => 'http://www.domreg.lt',
    49|             'registrar' => 'DOMREG.LT'
    50|         );
    51|         return $r;
    52|     }
    53| }


# ====================================================================
# FILE: src/whois.lu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-68 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__LU_HANDLER__'))
    25|     define('__LU_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class lu_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'domainname:' => 'domain.name',
    31|             'domaintype:' => 'domain.status',
    32|             'nserver:' => 'domain.nserver.',
    33|             'registered:' => 'domain.created',
    34|             'source:' => 'domain.source',
    35|             'ownertype:' => 'owner.type',
    36|             'org-name:' => 'owner.organization',
    37|             'org-address:' => 'owner.address.',
    38|             'org-zipcode:' => 'owner.address.pcode',
    39|             'org-city:' => 'owner.address.city',
    40|             'org-country:' => 'owner.address.country',
    41|             'adm-name:' => 'admin.name',
    42|             'adm-address:' => 'admin.address.',
    43|             'adm-zipcode:' => 'admin.address.pcode',
    44|             'adm-city:' => 'admin.address.city',
    45|             'adm-country:' => 'admin.address.country',
    46|             'adm-email:' => 'admin.email',
    47|             'tec-name:' => 'tech.name',
    48|             'tec-address:' => 'tech.address.',
    49|             'tec-zipcode:' => 'tech.address.pcode',
    50|             'tec-city:' => 'tech.address.city',
    51|             'tec-country:' => 'tech.address.country',
    52|             'tec-email:' => 'tech.email',
    53|             'bil-name:' => 'billing.name',
    54|             'bil-address:' => 'billing.address.',
    55|             'bil-zipcode:' => 'billing.address.pcode',
    56|             'bil-city:' => 'billing.address.city',
    57|             'bil-country:' => 'billing.address.country',
    58|             'bil-email:' => 'billing.email'
    59|         );
    60|         $r = array();
    61|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
    62|         $r['regyinfo'] = array(
    63|             'referrer' => 'http://www.dns.lu',
    64|             'registrar' => 'DNS-LU'
    65|         );
    66|         return $r;
    67|     }
    68| }


# ====================================================================
# FILE: src/whois.ly.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-57 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__LY_HANDLER__'))
    26|     define('__LY_HANDLER__', 1);
    27| class ly_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'domain.name' => 'Domain Name:',
    34|             'domain.status' => 'Domain Status:',
    35|             'domain.created' => 'Created:',
    36|             'domain.changed' => 'Updated:',
    37|             'domain.expires' => 'Expired:',
    38|             'domain.nserver' => 'Domain servers in listed order:'
    39|         );
    40|         $extra = array('zip/postal code:' => 'address.pcode');
    41|         $r = array();
    42|         $r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    43|         if (!empty($r['regrinfo']['domain']['name'])) {
    44|             $r['regrinfo'] = get_contacts($r['regrinfo'], $extra);
    45|             $r['regrinfo']['domain']['name'] = $r['regrinfo']['domain']['name'][0];
    46|             $r['regrinfo']['registered'] = 'yes';
    47|         } else {
    48|             $r = array('regrinfo' => array());
    49|             $r['regrinfo']['registered'] = 'no';
    50|         }
    51|         $r['regyinfo'] = array(
    52|             'referrer' => 'http://www.nic.ly',
    53|             'registrar' => 'Libya ccTLD'
    54|         );
    55|         return $r;
    56|     }
    57| }


# ====================================================================
# FILE: src/whois.me.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ME_HANDLER__'))
    25|     define('__ME_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class me_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         $r['regyinfo'] = array(
    32|             'referrer' => 'http://domain.me',
    33|             'registrar' => 'doMEn'
    34|         );
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.mobi.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__MOBI_HANDLER__'))
    25|     define('__MOBI_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class mobi_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
    32|             $r['regrinfo']['registered'] = 'unknown';
    33|         $r['regyinfo']['referrer'] = 'http://www.mtld.mobi/';
    34|         $r['regyinfo']['registrar'] = 'Dot Mobi Registry';
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.museum.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__MUSEUM_HANDLER__'))
    25|     define('__MUSEUM_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class museum_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         $r['regyinfo'] = array(
    32|             'referrer' => 'http://musedoma.museum',
    33|             'registrar' => 'Museum Domain Management Association'
    34|         );
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.mx.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-57 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__MX_HANDLER__'))
    25|     define('__MX_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class mx_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Registrant:',
    31|             'admin' => 'Administrative Contact:',
    32|             'tech' => 'Technical Contact:',
    33|             'billing' => 'Billing Contact:',
    34|             'domain.nserver' => 'Name Servers:',
    35|             'domain.created' => 'Created On:',
    36|             'domain.expires' => 'Expiration Date:',
    37|             'domain.changed' => 'Last Updated On:',
    38|             'domain.sponsor' => 'Registrar:'
    39|         );
    40|         $extra = array(
    41|             'city:' => 'address.city',
    42|             'state:' => 'address.state',
    43|             'dns:' => '0'
    44|         );
    45|         $r = array();
    46|         $r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'dmy', $extra);
    47|         $r['regyinfo'] = array(
    48|             'registrar' => 'NIC Mexico',
    49|             'referrer' => 'http://www.nic.mx/'
    50|         );
    51|         if (empty($r['regrinfo']['domain']['created']))
    52|             $r['regrinfo']['registered'] = 'no';
    53|         else
    54|             $r['regrinfo']['registered'] = 'yes';
    55|         return $r;
    56|     }
    57| }


# ====================================================================
# FILE: src/whois.name.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NAME_HANDLER__'))
    25|     define('__NAME_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class name_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         $r['regyinfo'] = array(
    32|             'referrer' => 'http://www.nic.name/',
    33|             'registrar' => 'Global Name Registry'
    34|         );
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.nl.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-67 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NL_HANDLER__'))
    25|     define('__NL_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class nl_handler {
    28|     function parse($data, $query) {
    29|         $items = array(
    30|             'domain.name' => 'Domain name:',
    31|             'domain.status' => 'Status:',
    32|             'domain.nserver' => 'Domain nameservers:',
    33|             'domain.created' => 'Date registered:',
    34|             'domain.changed' => 'Record last updated:',
    35|             'domain.sponsor' => 'Registrar:',
    36|             'admin' => 'Administrative contact:',
    37|             'tech' => 'Technical contact(s):'
    38|         );
    39|         $r = array();
    40|         $r['regrinfo'] = get_blocks($data['rawdata'], $items);
    41|         $r['regyinfo']['referrer'] = 'http://www.domain-registry.nl';
    42|         $r['regyinfo']['registrar'] = 'Stichting Internet Domeinregistratie NL';
    43|         if (!isset($r['regrinfo']['domain']['status'])) {
    44|             $r['regrinfo']['registered'] = 'no';
    45|             return $r;
    46|         }
    47|         if (isset($r['regrinfo']['tech']))
    48|             $r['regrinfo']['tech'] = $this->get_contact($r['regrinfo']['tech']);
    49|         if (isset($r['regrinfo']['zone']))
    50|             $r['regrinfo']['zone'] = $this->get_contact($r['regrinfo']['zone']);
    51|         if (isset($r['regrinfo']['admin']))
    52|             $r['regrinfo']['admin'] = $this->get_contact($r['regrinfo']['admin']);
    53|         if (isset($r['regrinfo']['owner']))
    54|             $r['regrinfo']['owner'] = $this->get_contact($r['regrinfo']['owner']);
    55|         $r['regrinfo']['registered'] = 'yes';
    56|         format_dates($r, 'dmy');
    57|         return $r;
    58|     }
    59|     function get_contact($data) {
    60|         $r = get_contact($data);
    61|         if (isset($r['name']) && preg_match('/^[A-Z0-9]+-[A-Z0-9]+$/', $r['name'])) {
    62|             $r['handle'] = $r['name'];
    63|             $r['name'] = array_shift($r['address']);
    64|         }
    65|         return $r;
    66|     }
    67| }


# ====================================================================
# FILE: src/whois.no.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-49 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link      http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NO_HANDLER__')) {
    25|     define('__NO_HANDLER__', 1);
    26| }
    27| require_once 'whois.parser.php';
    28| class no_handler
    29| {
    30|     public function parse($data_str, $query)
    31|     {
    32|         $items = [
    33|             'Domain Name................:' => 'domain.name',
    34|             'Created:'                     => 'domain.created',
    35|             'Last updated:'                => 'domain.changed',
    36|             'NORID Handle...............:' => 'domain.handle',
    37|         ];
    38|         $r = [
    39|             'regrinfo' => generic_parser_b($data_str['rawdata'], $items, 'ymd', false),
    40|             'regyinfo' => [
    41|                 'referrer'  => 'https://www.norid.no/en/',
    42|                 'registrar' => 'Norid',
    43|             ],
    44|             'rawdata'  => $data_str['rawdata'],
    45|         ];
    46|         $r['regrinfo']['registered'] = isset($r['regrinfo']['domain']['name']) ? 'yes' : 'no';
    47|         return $r;
    48|     }
    49| }


# ====================================================================
# FILE: src/whois.nu.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-70 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NU_HANDLER__'))
    25|     define('__NU_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class nu_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'name' => 'Domain Name (UTF-8):',
    31|             'created' => 'Record created on',
    32|             'expires' => 'Record expires on',
    33|             'changed' => 'Record last updated on',
    34|             'status' => 'Record status:',
    35|             'handle' => 'Record ID:'
    36|         );
    37|         $r = array();
    38|         foreach ($data_str['rawdata'] as $val) {
    39|             $val = trim($val);
    40|             if ($val != '') {
    41|                 if ($val == 'Domain servers in listed order:') {
    42|                     foreach ($data_str['rawdata'] as $val2) {
    43|                         $val2 = trim($val2);
    44|                         if ($val2 === '')
    45|                             break;
    46|                         $r['regrinfo']['domain']['nserver'][] = $val2;
    47|                     }
    48|                     break;
    49|                 }
    50|                 foreach ($items as $field => $match) {
    51|                     if (strstr($val, $match)) {
    52|                         $r['regrinfo']['domain'][$field] = trim(substr($val, strlen($match)));
    53|                         break;
    54|                     }
    55|                 }
    56|             }
    57|         }
    58|         if (isset($r['regrinfo']['domain']))
    59|             $r['regrinfo']['registered'] = 'yes';
    60|         else
    61|             $r['regrinfo']['registered'] = 'no';
    62|         $r['regyinfo'] = array(
    63|             'whois' => 'whois.nic.nu',
    64|             'referrer' => 'http://www.nunames.nu',
    65|             'registrar' => '.NU Domain, Ltd'
    66|         );
    67|         format_dates($r, 'dmy');
    68|         return $r;
    69|     }
    70| }


# ====================================================================
# FILE: src/whois.nz.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-89 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__NZ_HANDLER__'))
    25|     define('__NZ_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class nz_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'domain_name:' => 'domain.name',
    31|             'query_status:' => 'domain.status',
    32|             'ns_name_01:' => 'domain.nserver.0',
    33|             'ns_name_02:' => 'domain.nserver.1',
    34|             'ns_name_03:' => 'domain.nserver.2',
    35|             'domain_dateregistered:' => 'domain.created',
    36|             'domain_datelastmodified:' => 'domain.changed',
    37|             'domain_datebilleduntil:' => 'domain.expires',
    38|             'registrar_name:' => 'domain.sponsor',
    39|             'registrant_contact_name:' => 'owner.name',
    40|             'registrant_contact_address1:' => 'owner.address.address.0',
    41|             'registrant_contact_address2:' => 'owner.address.address.1',
    42|             'registrant_contact_address3:' => 'owner.address.address.2',
    43|             'registrant_contact_postalcode:' => 'owner.address.pcode',
    44|             'registrant_contact_city:' => 'owner.address.city',
    45|             'Registrant State/Province:' => 'owner.address.state',
    46|             'registrant_contact_country:' => 'owner.address.country',
    47|             'registrant_contact_phone:' => 'owner.phone',
    48|             'registrant_contact_fax:' => 'owner.fax',
    49|             'registrant_contact_email:' => 'owner.email',
    50|             'admin_contact_name:' => 'admin.name',
    51|             'admin_contact_address1:' => 'admin.address.address.0',
    52|             'admin_contact_address2:' => 'admin.address.address.1',
    53|             'admin_contact_address3:' => 'admin.address.address.2',
    54|             'admin_contact_postalcode:' => 'admin.address.pcode',
    55|             'admin_contact_city:' => 'admin.address.city',
    56|             'admin_contact_country:' => 'admin.address.country',
    57|             'admin_contact_phone:' => 'admin.phone',
    58|             'admin_contact_fax:' => 'admin.fax',
    59|             'admin_contact_email:' => 'admin.email',
    60|             'technical_contact_name:' => 'tech.name',
    61|             'technical_contact_address1:' => 'tech.address.address.0',
    62|             'technical_contact_address1:' => 'tech.address.address.1',
    63|             'technical_contact_address1:' => 'tech.address.address.2',
    64|             'technical_contact_postalcode:' => 'tech.address.pcode',
    65|             'technical_contact_city:' => 'tech.address.city',
    66|             'technical_contact_country:' => 'tech.address.country',
    67|             'technical_contact_phone:' => 'tech.phone',
    68|             'technical_contact_fax:' => 'tech.fax',
    69|             'technical_contact_email:' => 'tech.email'
    70|         );
    71|         $r = array();
    72|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
    73|         if (!empty($r['regrinfo']['domain']['status']))
    74|             $domain_status = substr($r['regrinfo']['domain']['status'], 0, 3);
    75|         else
    76|             $domain_status = '';
    77|         if ($domain_status == '200')
    78|             $r['regrinfo']['registered'] = 'yes';
    79|         elseif ($domain_status == '220')
    80|             $r['regrinfo']['registered'] = 'no';
    81|         else
    82|             $r['regrinfo']['registered'] = 'unknown';
    83|         if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
    84|             $r['regrinfo']['registered'] = 'unknown';
    85|         $r['regyinfo']['referrer'] = 'http://www.dnc.org.nz';
    86|         $r['regyinfo']['registrar'] = 'New Zealand Domain Name Registry Limited';
    87|         return $r;
    88|     }
    89| }


# ====================================================================
# FILE: src/whois.org.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link      http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ORG_HANDLER__')) {
    25|     define('__ORG_HANDLER__', 1);
    26| }
    27| require_once 'whois.parser.php';
    28| class org_handler
    29| {
    30|     /**
    31|      * @param array  $data_str
    32|      * @param string $query
    33|      *
    34|      * @return array
    35|      */
    36|     function parse($data_str, $query)
    37|     {
    38|         $r = [
    39|             'regrinfo' => generic_parser_b($data_str['rawdata']),
    40|         ];
    41|         if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20)) {
    42|             $r['regrinfo']['registered'] = 'unknown';
    43|         }
    44|         $r['regyinfo']['referrer']  = 'http://www.pir.org/';
    45|         $r['regyinfo']['registrar'] = 'Public Interest Registry';
    46|         if (!array_key_exists('rawdata', $r) && array_key_exists('rawdata', $data_str)) {
    47|             $r['rawdata'] = $data_str['rawdata'];
    48|         }
    49|         return $r;
    50|     }
    51| }


# ====================================================================
# FILE: src/whois.org.za.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__ORG_ZA_HANDLER__'))
    26|     define('__ORG_ZA_HANDLER__', 1);
    27| class org_za_handler {
    28|     function parse($data, $query) {
    29|         $items = array(
    30|             'domain.status' => 'Status:',
    31|             'domain.nserver' => 'Domain name servers in listed order:',
    32|             'domain.changed' => 'Record last updated on',
    33|             'owner' => 'rwhois search on',
    34|             'admin' => 'Administrative Contact:',
    35|             'tech' => 'Technical Contact:',
    36|             'billing' => 'Billing Contact:',
    37|             '#' => 'Search Again'
    38|         );
    39|         $r = array();
    40|         $r['regrinfo'] = get_blocks($data['rawdata'], $items);
    41|         if (isset($r['regrinfo']['domain']['status'])) {
    42|             $r['regrinfo']['registered'] = 'yes';
    43|             $r['regrinfo']['domain']['handler'] = strtok(array_shift($r['regrinfo']['owner']), ' ');
    44|             $r['regrinfo'] = get_contacts($r['regrinfo']);
    45|         } else
    46|             $r['regrinfo']['registered'] = 'no';
    47|         $r['regyinfo']['referrer'] = 'http://www.org.za';
    48|         $r['regyinfo']['registrar'] = 'The ORG.ZA Domain';
    49|         return $r;
    50|     }
    51| }


# ====================================================================
# FILE: src/whois.parser.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-836 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| /**
    25|  * @param string[] $rawdata
    26|  * @param string[] $translate
    27|  * @param string[] $contacts
    28|  * @param string   $main
    29|  * @param string   $dateformat
    30|  *
    31|  * @return array
    32|  *
    33|  * @deprecated Use AbstractHandler::generic_parser_a
    34|  */
    35| function generic_parser_a($rawdata, $translate, $contacts, $main = 'domain', $dateformat = 'dmy') {
    36|     $blocks = generic_parser_a_blocks($rawdata, $translate, $disclaimer);
    37|     $ret = array();
    38|     if (isset($disclaimer) && is_array($disclaimer))
    39|         $ret['disclaimer'] = $disclaimer;
    40|     if (empty($blocks) || !is_array($blocks['main'])) {
    41|         $ret['registered'] = 'no';
    42|         return $ret;
    43|     }
    44|     $r = $blocks['main'];
    45|     $ret['registered'] = 'yes';
    46|     foreach ($contacts as $key => $val) {
    47|         if (isset($r[$key])) {
    48|             if (is_array($r[$key])) {
    49|                 $blk = $r[$key][count($r[$key]) - 1];
    50|             } else {
    51|                 $blk = $r[$key];
    52|             }
    53|             $blk = strtoupper(strtok($blk, ' '));
    54|             if (isset($blocks[$blk])) {
    55|                 $ret[$val] = $blocks[$blk];
    56|             }
    57|             unset($r[$key]);
    58|         }
    59|     }
    60|     if ($main)
    61|         $ret[$main] = $r;
    62|     format_dates($ret, $dateformat);
    63|     return $ret;
    64| }
    65| function generic_parser_a_blocks($rawdata, $translate, &$disclaimer) {
    66|     $r = array();
    67|     $newblock = false;
    68|     $hasdata = false;
    69|     $block = array();
    70|     $blocks = false;
    71|     $gkey = 'main';
    72|     $dend = false;
    73|     foreach ($rawdata as $val) {
    74|         $val = trim($val);
    75|         if ($val != '' && ($val[0] == '%' || $val[0] == '#')) {
    76|             if (!$dend)
    77|                 $disclaimer[] = trim(substr($val, 1));
    78|             continue;
    79|         }
    80|         if ($val == '') {
    81|             $newblock = true;
    82|             continue;
    83|         }
    84|         if ($newblock && $hasdata) {
    85|             $blocks[$gkey] = $block;
    86|             $block = array();
    87|             $gkey = '';
    88|         }
    89|         $dend = true;
    90|         $newblock = false;
    91|         $k = trim(strtok($val, ':'));
    92|         $v = trim(substr(strstr($val, ':'), 1));
    93|         if ($v == '')
    94|             continue;
    95|         $hasdata = true;
    96|         if (isset($translate[$k])) {
    97|             $k = $translate[$k];
    98|             if ($k == '')
    99|                 continue;
   100|             if (strstr($k, '.')) {
   101|                 $block = assign($block, $k, $v);
   102|                 continue;
   103|             }
   104|         } else
   105|             $k = strtolower($k);
   106|         if ($k == 'handle') {
   107|             $v = strtok($v, ' ');
   108|             $gkey = strtoupper($v);
   109|         }
   110|         if (isset($block[$k]) && is_array($block[$k]))
   111|             $block[$k][] = $v;
   112|         else
   113|         if (!isset($block[$k]) || $block[$k] == '')
   114|             $block[$k] = $v;
   115|         else {
   116|             $x = $block[$k];
   117|             unset($block[$k]);
   118|             $block[$k][] = $x;
   119|             $block[$k][] = $v;
   120|         }
   121|     }
   122|     if ($hasdata)
   123|         $blocks[$gkey] = $block;
   124|     return $blocks;
   125| }
   126| /**
   127|  * @param        $rawdata
   128|  * @param array  $items
   129|  * @param string $dateformat
   130|  * @param bool   $hasreg
   131|  * @param bool   $scanall
   132|  *
   133|  * @return array
   134|  *
   135|  * @deprecated Use AbstractHandler::generic_parser_b
   136|  */
   137| function generic_parser_b($rawdata, $items = array(), $dateformat = 'mdy', $hasreg = true, $scanall = false) {
   138|     if (is_array($items) && !count($items))
   139|         $items = array(
   140|             'Domain Name:' => 'domain.name',
   141|             'Domain ID:' => 'domain.handle',
   142|             'Sponsoring Registrar:' => 'domain.sponsor',
   143|             'Registrar:' => 'domain.sponsor',
   144|             'Registrar ID:' => 'domain.sponsor',
   145|             'Domain Status:' => 'domain.status.',
   146|             'Status:' => 'domain.status.',
   147|             'Name Server:' => 'domain.nserver.',
   148|             'Nameservers:' => 'domain.nserver.',
   149|             'Maintainer:' => 'domain.referer',
   150|             'Domain Registration Date:' => 'domain.created',
   151|             'Domain Create Date:' => 'domain.created',
   152|             'Domain Expiration Date:' => 'domain.expires',
   153|             'Domain Last Updated Date:' => 'domain.changed',
   154|             'Updated Date:' => 'domain.changed',
   155|             'Creation Date:' => 'domain.created',
   156|             'Last Modification Date:' => 'domain.changed',
   157|             'Expiration Date:' => 'domain.expires',
   158|             'Created On:' => 'domain.created',
   159|             'Last Updated On:' => 'domain.changed',
   160|             'Registry Expiry Date:' => 'domain.expires',
   161|             'Registrant ID:' => 'owner.handle',
   162|             'Registrant Name:' => 'owner.name',
   163|             'Registrant Organization:' => 'owner.organization',
   164|             'Registrant Address:' => 'owner.address.street.',
   165|             'Registrant Address1:' => 'owner.address.street.',
   166|             'Registrant Address2:' => 'owner.address.street.',
   167|             'Registrant Street:' => 'owner.address.street.',
   168|             'Registrant Street1:' => 'owner.address.street.',
   169|             'Registrant Street2:' => 'owner.address.street.',
   170|             'Registrant Street3:' => 'owner.address.street.',
   171|             'Registrant Postal Code:' => 'owner.address.pcode',
   172|             'Registrant City:' => 'owner.address.city',
   173|             'Registrant State/Province:' => 'owner.address.state',
   174|             'Registrant Country:' => 'owner.address.country',
   175|             'Registrant Country/Economy:' => 'owner.address.country',
   176|             'Registrant Phone Number:' => 'owner.phone',
   177|             'Registrant Phone:' => 'owner.phone',
   178|             'Registrant Facsimile Number:' => 'owner.fax',
   179|             'Registrant FAX:' => 'owner.fax',
   180|             'Registrant Email:' => 'owner.email',
   181|             'Registrant E-mail:' => 'owner.email',
   182|             'Administrative Contact ID:' => 'admin.handle',
   183|             'Administrative Contact Name:' => 'admin.name',
   184|             'Administrative Contact Organization:' => 'admin.organization',
   185|             'Administrative Contact Address:' => 'admin.address.street.',
   186|             'Administrative Contact Address1:' => 'admin.address.street.',
   187|             'Administrative Contact Address2:' => 'admin.address.street.',
   188|             'Administrative Contact Postal Code:' => 'admin.address.pcode',
   189|             'Administrative Contact City:' => 'admin.address.city',
   190|             'Administrative Contact State/Province:' => 'admin.address.state',
   191|             'Administrative Contact Country:' => 'admin.address.country',
   192|             'Administrative Contact Phone Number:' => 'admin.phone',
   193|             'Administrative Contact Email:' => 'admin.email',
   194|             'Administrative Contact Facsimile Number:' => 'admin.fax',
   195|             'Administrative Contact Tel:' => 'admin.phone',
   196|             'Administrative Contact Fax:' => 'admin.fax',
   197|             'Administrative ID:' => 'admin.handle',
   198|             'Administrative Name:' => 'admin.name',
   199|             'Administrative Organization:' => 'admin.organization',
   200|             'Administrative Address:' => 'admin.address.street.',
   201|             'Administrative Address1:' => 'admin.address.street.',
   202|             'Administrative Address2:' => 'admin.address.street.',
   203|             'Administrative Postal Code:' => 'admin.address.pcode',
   204|             'Administrative City:' => 'admin.address.city',
   205|             'Administrative State/Province:' => 'admin.address.state',
   206|             'Administrative Country/Economy:' => 'admin.address.country',
   207|             'Administrative Phone:' => 'admin.phone',
   208|             'Administrative E-mail:' => 'admin.email',
   209|             'Administrative Facsimile Number:' => 'admin.fax',
   210|             'Administrative Tel:' => 'admin.phone',
   211|             'Administrative FAX:' => 'admin.fax',
   212|             'Admin ID:' => 'admin.handle',
   213|             'Admin Name:' => 'admin.name',
   214|             'Admin Organization:' => 'admin.organization',
   215|             'Admin Street:' => 'admin.address.street.',
   216|             'Admin Street1:' => 'admin.address.street.',
   217|             'Admin Street2:' => 'admin.address.street.',
   218|             'Admin Street3:' => 'admin.address.street.',
   219|             'Admin Address:' => 'admin.address.street.',
   220|             'Admin Address2:' => 'admin.address.street.',
   221|             'Admin Address3:' => 'admin.address.street.',
   222|             'Admin City:' => 'admin.address.city',
   223|             'Admin State/Province:' => 'admin.address.state',
   224|             'Admin Postal Code:' => 'admin.address.pcode',
   225|             'Admin Country:' => 'admin.address.country',
   226|             'Admin Country/Economy:' => 'admin.address.country',
   227|             'Admin Phone:' => 'admin.phone',
   228|             'Admin FAX:' => 'admin.fax',
   229|             'Admin Email:' => 'admin.email',
   230|             'Admin E-mail:' => 'admin.email',
   231|             'Technical Contact ID:' => 'tech.handle',
   232|             'Technical Contact Name:' => 'tech.name',
   233|             'Technical Contact Organization:' => 'tech.organization',
   234|             'Technical Contact Address:' => 'tech.address.street.',
   235|             'Technical Contact Address1:' => 'tech.address.street.',
   236|             'Technical Contact Address2:' => 'tech.address.street.',
   237|             'Technical Contact Postal Code:' => 'tech.address.pcode',
   238|             'Technical Contact City:' => 'tech.address.city',
   239|             'Technical Contact State/Province:' => 'tech.address.state',
   240|             'Technical Contact Country:' => 'tech.address.country',
   241|             'Technical Contact Phone Number:' => 'tech.phone',
   242|             'Technical Contact Facsimile Number:' => 'tech.fax',
   243|             'Technical Contact Phone:' => 'tech.phone',
   244|             'Technical Contact Fax:' => 'tech.fax',
   245|             'Technical Contact Email:' => 'tech.email',
   246|             'Technical ID:' => 'tech.handle',
   247|             'Technical Name:' => 'tech.name',
   248|             'Technical Organization:' => 'tech.organization',
   249|             'Technical Address:' => 'tech.address.street.',
   250|             'Technical Address1:' => 'tech.address.street.',
   251|             'Technical Address2:' => 'tech.address.street.',
   252|             'Technical Postal Code:' => 'tech.address.pcode',
   253|             'Technical City:' => 'tech.address.city',
   254|             'Technical State/Province:' => 'tech.address.state',
   255|             'Technical Country/Economy:' => 'tech.address.country',
   256|             'Technical Phone Number:' => 'tech.phone',
   257|             'Technical Facsimile Number:' => 'tech.fax',
   258|             'Technical Phone:' => 'tech.phone',
   259|             'Technical Fax:' => 'tech.fax',
   260|             'Technical FAX:' => 'tech.fax',
   261|             'Technical E-mail:' => 'tech.email',
   262|             'Tech ID:' => 'tech.handle',
   263|             'Tech Name:' => 'tech.name',
   264|             'Tech Organization:' => 'tech.organization',
   265|             'Tech Address:' => 'tech.address.street.',
   266|             'Tech Address2:' => 'tech.address.street.',
   267|             'Tech Address3:' => 'tech.address.street.',
   268|             'Tech Street:' => 'tech.address.street.',
   269|             'Tech Street1:' => 'tech.address.street.',
   270|             'Tech Street2:' => 'tech.address.street.',
   271|             'Tech Street3:' => 'tech.address.street.',
   272|             'Tech City:' => 'tech.address.city',
   273|             'Tech Postal Code:' => 'tech.address.pcode',
   274|             'Tech State/Province:' => 'tech.address.state',
   275|             'Tech Country:' => 'tech.address.country',
   276|             'Tech Country/Economy:' => 'tech.address.country',
   277|             'Tech Phone:' => 'tech.phone',
   278|             'Tech FAX:' => 'tech.fax',
   279|             'Tech Email:' => 'tech.email',
   280|             'Tech E-mail:' => 'tech.email',
   281|             'Billing Contact ID:' => 'billing.handle',
   282|             'Billing Contact Name:' => 'billing.name',
   283|             'Billing Contact Organization:' => 'billing.organization',
   284|             'Billing Contact Address1:' => 'billing.address.street.',
   285|             'Billing Contact Address2:' => 'billing.address.street.',
   286|             'Billing Contact Postal Code:' => 'billing.address.pcode',
   287|             'Billing Contact City:' => 'billing.address.city',
   288|             'Billing Contact State/Province:' => 'billing.address.state',
   289|             'Billing Contact Country:' => 'billing.address.country',
   290|             'Billing Contact Phone Number:' => 'billing.phone',
   291|             'Billing Contact Facsimile Number:' => 'billing.fax',
   292|             'Billing Contact Email:' => 'billing.email',
   293|             'Billing ID:' => 'billing.handle',
   294|             'Billing Name:' => 'billing.name',
   295|             'Billing Organization:' => 'billing.organization',
   296|             'Billing Address:' => 'billing.address.street.',
   297|             'Billing Address1:' => 'billing.address.street.',
   298|             'Billing Address2:' => 'billing.address.street.',
   299|             'Billing Address3:' => 'billing.address.street.',
   300|             'Billing Street:' => 'billing.address.street.',
   301|             'Billing Street1:' => 'billing.address.street.',
   302|             'Billing Street2:' => 'billing.address.street.',
   303|             'Billing Street3:' => 'billing.address.street.',
   304|             'Billing City:' => 'billing.address.city',
   305|             'Billing Postal Code:' => 'billing.address.pcode',
   306|             'Billing State/Province:' => 'billing.address.state',
   307|             'Billing Country:' => 'billing.address.country',
   308|             'Billing Country/Economy:' => 'billing.address.country',
   309|             'Billing Phone:' => 'billing.phone',
   310|             'Billing Fax:' => 'billing.fax',
   311|             'Billing FAX:' => 'billing.fax',
   312|             'Billing Email:' => 'billing.email',
   313|             'Billing E-mail:' => 'billing.email',
   314|             'Zone ID:' => 'zone.handle',
   315|             'Zone Organization:' => 'zone.organization',
   316|             'Zone Name:' => 'zone.name',
   317|             'Zone Address:' => 'zone.address.street.',
   318|             'Zone Address 2:' => 'zone.address.street.',
   319|             'Zone City:' => 'zone.address.city',
   320|             'Zone State/Province:' => 'zone.address.state',
   321|             'Zone Postal Code:' => 'zone.address.pcode',
   322|             'Zone Country:' => 'zone.address.country',
   323|             'Zone Phone Number:' => 'zone.phone',
   324|             'Zone Fax Number:' => 'zone.fax',
   325|             'Zone Email:' => 'zone.email'
   326|         );
   327|     $r = [];
   328|     $disok = true;
   329|     foreach ($rawdata as $val) {
   330|         if (trim($val) != '') {
   331|             if (($val[0] == '%' || $val[0] == '#') && $disok) {
   332|                 $r['disclaimer'][] = trim(substr($val, 1));
   333|                 $disok = true;
   334|                 continue;
   335|             }
   336|             $disok = false;
   337|             reset($items);
   338|             foreach ($items as $match => $field) {
   339|                 $pos = strpos($val, $match);
   340|                 if ($pos !== false) {
   341|                     if ($field != '') {
   342|                         $itm = trim(substr($val, $pos + strlen($match)));
   343|                         if ($itm != '') {
   344|                             $r = assign($r, $field, str_replace('"', '\"', $itm));
   345|                         }
   346|                     }
   347|                     if (!$scanall)
   348|                         break;
   349|                 }
   350|             }
   351|         }
   352|     }
   353|     if (empty($r)) {
   354|         if ($hasreg)
   355|             $r['registered'] = 'no';
   356|     }
   357|     else {
   358|         if ($hasreg)
   359|             $r['registered'] = 'yes';
   360|         $r = format_dates($r, $dateformat);
   361|     }
   362|     return $r;
   363| }
   364| /**
   365|  * @param array    $array The array to populate
   366|  * @param string[] $parts
   367|  * @param mixed    $value The value to be assigned to the $vDef key
   368|  *
   369|  * @return array The updated array
   370|  * @see https://github.com/sparc/phpWhois.org/compare/18849d1a98b992190612cdb2561e7b4492c505f5...8c6a18686775b25f05592dd67d7706e47167a498#diff-b8adbe1292f8abca1f943aa844db52aa Original fix by David Saez PAdros sparc
   371|  */
   372| function assign_recursive(array $array, array $parts, $value)
   373| {
   374|     $key = array_shift($parts);
   375|     if (count($parts) === 0) {
   376|         if (!$key) {
   377|             $array[] = $value;
   378|         } else {
   379|             $array[$key] = $value;
   380|         }
   381|     } else {
   382|         if (!isset($array[$key])) {
   383|             $array[$key] = [];
   384|         }
   385|         $array[$key] = assign_recursive($array[$key], $parts, $value);
   386|     }
   387|     return $array;
   388| }
   389| /**
   390|  * @param array  $array The array to populate
   391|  * @param string $vDef  A period-separated string of nested array keys
   392|  * @param mixed  $value The value to be assigned to the $vDef key
   393|  *
   394|  * @return array The updated array
   395|  * @see https://github.com/sparc/phpWhois.org/compare/18849d1a98b992190612cdb2561e7b4492c505f5...8c6a18686775b25f05592dd67d7706e47167a498#diff-b8adbe1292f8abca1f943aa844db52aa Original fix by David Saez PAdros sparc
   396|  */
   397| function assign(array $array, string $vDef, $value)
   398| {
   399|     return assign_recursive($array, explode('.', $vDef), $value);
   400| }
   401| /**
   402|  * @param string[] $rawdata
   403|  * @param string[] $items
   404|  * @param bool     $partial_match
   405|  * @param bool     $def_block
   406|  *
   407|  * @return array
   408|  *
   409|  * @deprecated Use AbstractHandler::get_blocks
   410|  */
   411| function get_blocks($rawdata, $items, $partial_match = false, $def_block = false) {
   412|     $r = array();
   413|     $endtag = '';
   414|     while ($val = current($rawdata)) {
   415|         next($rawdata);
   416|         $val = trim($val);
   417|         if ($val == '')
   418|             continue;
   419|         $var = $found = false;
   420|         foreach ($items as $field => $match) {
   421|             $pos = strpos($val, $match);
   422|             if ($field != '' && $pos !== false) {
   423|                 if ($val == $match) {
   424|                     $found = true;
   425|                     $endtag = '';
   426|                     $line = $val;
   427|                     break;
   428|                 }
   429|                 $last = substr($val, -1, 1);
   430|                 if ($last == ':' || $last == '-' || $last == ']') {
   431|                     $found = true;
   432|                     $endtag = $last;
   433|                     $line = $val;
   434|                 } else {
   435|                     $var = strtok($field, '#');
   436|                     $r   = assign($r, $var, trim(substr($val, $pos + strlen($match))));
   437|                 }
   438|                 break;
   439|             }
   440|         }
   441|         if (!$found) {
   442|             if (!$var && $def_block)
   443|                 $r[$def_block][] = $val;
   444|             continue;
   445|         }
   446|         $block = array();
   447|         while ($val = current($rawdata)) {
   448|             next($rawdata);
   449|             $val = trim($val);
   450|             if ($val == '' || $val == str_repeat($val[0], strlen($val)))
   451|                 continue;
   452|             $last = substr($val, -1, 1);
   453|             /*
   454|               if ($last == $endtag)
   455|               {
   456|               prev($rawdata);
   457|               break;
   458|               }
   459|               if ($endtag == '' || $partial_match)
   460|              */
   461|             if ($endtag == '' || $partial_match || $last == $endtag) {
   462|                 $et = false;
   463|                 foreach ($items as $field => $match) {
   464|                     $pos = strpos($val, $match);
   465|                     if ($pos !== false && $pos == 0) {
   466|                         $et = true;
   467|                         break;
   468|                     }
   469|                 }
   470|                 if ($et) {
   471|                     prev($rawdata);
   472|                     break;
   473|                 }
   474|             }
   475|             $block[] = $val;
   476|         }
   477|         if (empty($block))
   478|             continue;
   479|         foreach ($items as $field => $match) {
   480|             $pos = strpos($line, $match);
   481|             if ($pos !== false) {
   482|                 $var = strtok($field, '#');
   483|                 if ($var != '[]') {
   484|                     $r = assign($r, $var, $block);
   485|                 }
   486|             }
   487|         }
   488|     }
   489|     return $r;
   490| }
   491| /**
   492|  * @param       $data_str
   493|  * @param       $items
   494|  * @param       $date_format
   495|  * @param array $translate
   496|  * @param bool  $has_org
   497|  * @param bool  $partial_match
   498|  * @param bool  $def_block
   499|  *
   500|  * @return mixed
   501|  *
   502|  * @deprecated Use AbstractHandler::easy_parser
   503|  */
   504| function easy_parser($data_str, $items, $date_format, $translate = array(), $has_org = false, $partial_match = false, $def_block = false) {
   505|     $r = get_blocks($data_str, $items, $partial_match, $def_block);
   506|     $r = get_contacts($r, $translate, $has_org);
   507|     format_dates($r, $date_format);
   508|     return $r;
   509| }
   510| /**
   511|  * @param       $array
   512|  * @param array $extra_items
   513|  * @param bool  $has_org
   514|  *
   515|  * @return mixed
   516|  *
   517|  * @deprecated Use AbstractHandler::get_contacts
   518|  */
   519| function get_contacts($array, $extra_items = array(), $has_org = false) {
   520|     if (isset($array['billing']))
   521|         $array['billing'] = get_contact($array['billing'], $extra_items, $has_org);
   522|     if (isset($array['tech']))
   523|         $array['tech'] = get_contact($array['tech'], $extra_items, $has_org);
   524|     if (isset($array['zone']))
   525|         $array['zone'] = get_contact($array['zone'], $extra_items, $has_org);
   526|     if (isset($array['admin']))
   527|         $array['admin'] = get_contact($array['admin'], $extra_items, $has_org);
   528|     if (isset($array['owner']))
   529|         $array['owner'] = get_contact($array['owner'], $extra_items, $has_org);
   530|     if (isset($array['registrar']))
   531|         $array['registrar'] = get_contact($array['registrar'], $extra_items, $has_org);
   532|     return $array;
   533| }
   534| /**
   535|  * @param       $array
   536|  * @param array $extra_items
   537|  * @param bool  $has_org
   538|  *
   539|  * @return array
   540|  *
   541|  * @deprecated Use AbstractHandler::get_contact
   542|  */
   543| function get_contact($array, $extra_items = array(), $has_org = false) {
   544|     if (!is_array($array))
   545|         return array();
   546|     $items = array(
   547|         'fax..:' => 'fax',
   548|         'fax.' => 'fax',
   549|         'fax-no:' => 'fax',
   550|         'fax -' => 'fax',
   551|         'fax-' => 'fax',
   552|         'fax::' => 'fax',
   553|         'fax:' => 'fax',
   554|         '[fax]' => 'fax',
   555|         '(fax)' => 'fax',
   556|         'fax' => 'fax',
   557|         'tel. ' => 'phone',
   558|         'tel:' => 'phone',
   559|         'phone::' => 'phone',
   560|         'phone:' => 'phone',
   561|         'phone-' => 'phone',
   562|         'phone -' => 'phone',
   563|         'email:' => 'email',
   564|         'e-mail:' => 'email',
   565|         'company name:' => 'organization',
   566|         'organisation:' => 'organization',
   567|         'first name:' => 'name.first',
   568|         'last name:' => 'name.last',
   569|         'street:' => 'address.street',
   570|         'address:' => 'address.street.',
   571|         'language:' => '',
   572|         'location:' => 'address.city',
   573|         'country:' => 'address.country',
   574|         'name:' => 'name',
   575|         'last modified:' => 'changed'
   576|     );
   577|     if (is_array($extra_items) && count($extra_items)) {
   578|         foreach ($items as $match => $field)
   579|             if (!isset($extra_items[$match]))
   580|                 $extra_items[$match] = $field;
   581|         $items = $extra_items;
   582|     }
   583|     $r = [];
   584|     foreach ($array as $key => $val) {
   585|         $ok = true;
   586|         while ($ok) {
   587|             reset($items);
   588|             $ok = false;
   589|             foreach ($items as $match => $field) {
   590|                 $pos = strpos(strtolower($val), $match);
   591|                 if ($pos === false)
   592|                     continue;
   593|                 $itm = trim(substr($val, $pos + strlen($match)));
   594|                 if ($field != '' && $itm != '') {
   595|                     $r = assign($r, $field, $itm);
   596|                 }
   597|                 $val = trim(substr($val, 0, $pos));
   598|                 if ($val == '') {
   599|                     unset($array[$key]);
   600|                     break;
   601|                 } else {
   602|                     $array[$key] = $val;
   603|                     $ok = true;
   604|                 }
   605|             }
   606|             if (preg_match("/([+]*[-\(\)\. x0-9]){7,}/", $val, $matches)) {
   607|                 $phone = trim(str_replace(' ', '', $matches[0]));
   608|                 if (strlen($phone) > 8 && !preg_match('/[0-9]{5}\-[0-9]{3}/', $phone)) {
   609|                     if (isset($r['phone'])) {
   610|                         if (isset($r['fax']))
   611|                             continue;
   612|                         $r['fax'] = trim($matches[0]);
   613|                     }
   614|                     else {
   615|                         $r['phone'] = trim($matches[0]);
   616|                     }
   617|                     $val = str_replace($matches[0], '', $val);
   618|                     if ($val == '') {
   619|                         unset($array[$key]);
   620|                         continue;
   621|                     } else {
   622|                         $array[$key] = $val;
   623|                         $ok = true;
   624|                     }
   625|                 }
   626|             }
   627|             if (preg_match('/([-0-9a-zA-Z._+&\/=]+@([-0-9a-zA-Z]+[.])+[a-zA-Z]{2,6})/', $val, $matches)) {
   628|                 $r['email'] = $matches[0];
   629|                 $val = str_replace($matches[0], '', $val);
   630|                 $val = trim(str_replace('()', '', $val));
   631|                 if ($val == '') {
   632|                     unset($array[$key]);
   633|                     continue;
   634|                 } else {
   635|                     if (!isset($r['name'])) {
   636|                         $r['name'] = $val;
   637|                         unset($array[$key]);
   638|                     } else
   639|                         $array[$key] = $val;
   640|                     $ok = true;
   641|                 }
   642|             }
   643|         }
   644|     }
   645|     if (!isset($r['name']) && count($array) > 0) {
   646|         $r['name'] = array_shift($array);
   647|     }
   648|     if ($has_org && count($array) > 0) {
   649|         $r['organization'] = array_shift($array);
   650|     }
   651|     if (isset($r['name']) && is_array($r['name'])) {
   652|         $r['name'] = implode($r['name'], ' ');
   653|     }
   654|     if (!empty($array)) {
   655|         if (isset($r['address']))
   656|             $r['address'] = array_merge($r['address'], $array);
   657|         else
   658|             $r['address'] = $array;
   659|     }
   660|     return $r;
   661| }
   662| /**
   663|  * @param        $res
   664|  * @param string $format
   665|  *
   666|  * @return array
   667|  *
   668|  * @deprecated Use AbstractHandler::format_dates
   669|  */
   670| function format_dates(&$res, $format = 'mdy') {
   671|     if (!is_array($res))
   672|         return $res;
   673|     foreach ($res as $key => $val) {
   674|         if (is_array($val)) {
   675|             if (!is_numeric($key) && ($key == 'expires' || $key == 'created' || $key == 'changed')) {
   676|                 $d = get_date($val[0], $format);
   677|                 if ($d)
   678|                     $res[$key] = $d;
   679|             }
   680|             else {
   681|                 $res[$key] = format_dates($val, $format);
   682|             }
   683|         } else {
   684|             if (!is_numeric($key) && ($key == 'expires' || $key == 'created' || $key == 'changed')) {
   685|                 $d = get_date($val, $format);
   686|                 if ($d)
   687|                     $res[$key] = $d;
   688|             }
   689|         }
   690|     }
   691|     return $res;
   692| }
   693| /**
   694|  * @param $date
   695|  * @param $format
   696|  *
   697|  * @return string|string[]
   698|  *
   699|  * @deprecated Use AbstractHandler::get_date
   700|  */
   701| function get_date($date, $format)
   702| {
   703|     $parsedDate = parseStandardDate($date);
   704|     if ($parsedDate instanceof DateTime) {
   705|         return $parsedDate->format('Y-m-d');
   706|     }
   707|     $months = [
   708|         'jan' => 1,
   709|         'ene' => 1,
   710|         'feb' => 2,
   711|         'mar' => 3,
   712|         'apr' => 4,
   713|         'abr' => 4,
   714|         'may' => 5,
   715|         'jun' => 6,
   716|         'jul' => 7,
   717|         'aug' => 8,
   718|         'ago' => 8,
   719|         'sep' => 9,
   720|         'oct' => 10,
   721|         'nov' => 11,
   722|         'dec' => 12,
   723|         'dic' => 12,
   724|     ];
   725|     $parts = explode(' ', $date);
   726|     if (strpos($parts[0], '@') !== false) {
   727|         unset($parts[0]);
   728|         $date = implode(' ', $parts);
   729|     }
   730|     $date = str_replace([',', '.', '-', '/', "\t"], ' ', trim($date));
   731|     $parts = explode(' ', $date);
   732|     $res   = [];
   733|     if ((strlen($parts[0]) === 8 || count($parts) === 1) && is_numeric($parts[0])) {
   734|         $val = $parts[0];
   735|         for ($p = $i = 0; $i < 3; $i++) {
   736|             if ($format[$i] !== 'Y') {
   737|                 $res[$format[$i]] = substr($val, $p, 2);
   738|                 $p                += 2;
   739|             } else {
   740|                 $res['y'] = substr($val, $p, 4);
   741|                 $p        += 4;
   742|             }
   743|         }
   744|     } else {
   745|         $format = strtolower($format);
   746|         for ($p = $i = 0; $p < count($parts) && $i < strlen($format); $p++) {
   747|             if (trim($parts[$p]) === '') {
   748|                 continue;
   749|             }
   750|             if ($format[$i] !== '-') {
   751|                 $res[$format[$i]] = $parts[$p];
   752|             }
   753|             $i++;
   754|         }
   755|     }
   756|     if (!$res) {
   757|         return $date;
   758|     }
   759|     $ok = false;
   760|     while (!$ok) {
   761|         $ok = true;
   762|         foreach ($res as $key => $val) {
   763|             if ($val === '' || $key === '') {
   764|                 continue;
   765|             }
   766|             if (!is_numeric($val) && isset($months[strtolower(substr($val, 0, 3))])) {
   767|                 $res[$key] = $res['m'];
   768|                 $res['m']  = $months[strtolower(substr($val, 0, 3))];
   769|                 $ok        = false;
   770|                 break;
   771|             }
   772|             if ($key !== 'y' && $key !== 'Y' && $val > 1900) {
   773|                 $res[$key] = $res['y'];
   774|                 $res['y']  = $val;
   775|                 $ok        = false;
   776|                 break;
   777|             }
   778|         }
   779|     }
   780|     if ($res['m'] > 12) {
   781|         $v = $res['m'];
   782|         $res['m'] = $res['d'];
   783|         $res['d'] = $v;
   784|     }
   785|     if ($res['y'] < 70)
   786|         $res['y'] += 2000;
   787|     else
   788|     if ($res['y'] <= 99)
   789|         $res['y'] += 1900;
   790|     return sprintf('%.4d-%02d-%02d', $res['y'], $res['m'], $res['d']);
   791| }
   792| /**
   793|  * @param string $date
   794|  *
   795|  * @return false|DateTime
   796|  */
   797| function parseStandardDate(string $date)
   798| {
   799|     $date = trim($date);
   800|     $pattern = '/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}).\d(Z)$/';
   801|     if (preg_match($pattern, $date, $matches)) {
   802|         if (PHP_VERSION_ID >= 70300) {
   803|             $dateTimeFormat = 'Y-m-d\TH:i:s.vT';
   804|             return Datetime::createFromFormat($dateTimeFormat, $date);
   805|         }
   806|         $date = $matches[1] . $matches[2];
   807|     }
   808|     $pattern = '/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/';
   809|     if (preg_match($pattern, $date)) {
   810|         $dateTimeFormat = 'Y-m-d\TH:i:sT';
   811|         return Datetime::createFromFormat($dateTimeFormat, $date);
   812|     }
   813|     $pattern = '/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/';
   814|     if (preg_match($pattern, $date)) {
   815|         $dateTimeFormat = 'Y-m-d\TH:i:s';
   816|         $utc = new DateTimeZone('UTC');
   817|         return Datetime::createFromFormat($dateTimeFormat, $date, $utc);
   818|     }
   819|     $pattern = '/^\d{2}-[a-zA-Z]{3}-\d{4}$/';
   820|     if (preg_match($pattern, $date)) {
   821|         $dateTimeFormat = 'd-M-Y';
   822|         $utc = new DateTimeZone('UTC');
   823|         return Datetime::createFromFormat($dateTimeFormat, $date, $utc);
   824|     }
   825|     $pattern = '/^(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})(?: \w+)?$/';
   826|     if (preg_match($pattern, $date, $matches)) {
   827|         $dateTimeFormat = 'Y-m-d H:i:s T';
   828|         $parsedDate = DateTime::createFromFormat($dateTimeFormat, $date);
   829|         if ($parsedDate instanceof DateTime) {
   830|             return $parsedDate;
   831|         }
   832|         $dateTimeFormat = 'Y-m-d H:i:s';
   833|         return DateTime::createFromFormat($dateTimeFormat, $matches[1]);
   834|     }
   835|     return false;
   836| }


# ====================================================================
# FILE: src/whois.ph.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-47 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @copyright Copyright (c) 2020 Joshua Smith
    20|  */
    21| if (!defined('__PH_HANDLER__')) {
    22|     define('__PH_HANDLER__', 1);
    23| }
    24| require_once('whois.parser.php');
    25| /**
    26|  * Class ph_handler
    27|  */
    28| class ph_handler
    29| {
    30|     function parse($data_str, $query)
    31|     {
    32|         $items = [
    33|             'created:' => 'domain.created',
    34|             'changed:' => 'domain.changed',
    35|             'status:' => 'domain.status',
    36|             'nserver:' => 'domain.nserver.'
    37|         ];
    38|         $r = [
    39|             'regrinfo' => generic_parser_b($data_str['rawdata'], $items),
    40|             'rawdata'  => $data_str['rawdata'],
    41|         ];
    42|         if (!isset($r['regrinfo']['domain']['name'])) {
    43|             $r['regrinfo']['domain']['name'] = $query;
    44|         }
    45|         return $r;
    46|     }
    47| }


# ====================================================================
# FILE: src/whois.pl.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-43 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__PL_HANDLER__'))
    25|     define('__PL_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class pl_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'domain.created' => 'created:',
    31|             'domain.changed' => 'last modified:',
    32|             'domain.sponsor' => 'REGISTRAR:',
    33|             '#' => 'WHOIS displays data with a delay not exceeding 15 minutes in relation to the .pl Registry system'
    34|         );
    35|         $r = array();
    36|         $r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd');
    37|         $r['regyinfo'] = array(
    38|             'referrer' => 'http://www.dns.pl/english/index.html',
    39|             'registrar' => 'NASK'
    40|         );
    41|         return $r;
    42|     }
    43| }


# ====================================================================
# FILE: src/whois.pro.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| require_once('whois.parser.php');
    25| if (!defined('__PRO_HANDLER__'))
    26|     define('__PRO_HANDLER__', 1);
    27| class pro_handler {
    28|     function parse($data, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data['rawdata']);
    31|         $r['regyinfo']['referrer'] = 'http://www.registrypro.pro';
    32|         $r['regyinfo']['registrar'] = 'RegistryPRO';
    33|         return $r;
    34|     }
    35| }


# ====================================================================
# FILE: src/whois.pt.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 18-59 ---
    18| Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    19|  */
    20| /* TODO:
    21|    - whois - converter para http://domaininfo.com/idn_conversion.asp punnycode antes de efectuar a pesquisa
    22|    - o punnycode deveria fazer parte dos resultados fazer parte dos resultados!
    23| */
    24| if (!defined('__PT_HANDLER__'))
    25| 	define('__PT_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class pt_handler
    28| 	{
    29| 	function parse($data, $query)
    30| 		{
    31| 		$items = array(
    32| 					'domain.name' 		=> ' / Domain Name:',
    33| 					'domain.created' 	=> 'Data de registo / Creation Date (dd/mm/yyyy):',
    34| 					'domain.nserver.' 	=> 'Nameserver:',
    35| 					'domain.status'	 	=> 'Estado / Status:',
    36| 					'owner'				=> 'Titular / Registrant',
    37| 					'billing'			=> 'Entidade Gestora / Billing Contact',
    38| 					'admin'				=> 'Responsável Administrativo / Admin Contact',
    39| 					'tech'				=> 'Responsável Técnico / Tech Contact',
    40| 					'#'					=> 'Nameserver Information'
    41| 					);
    42| 		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
    43| 		if (empty($r['regrinfo']['domain']['name']))
    44| 			{
    45| 			print_r($r['regrinfo']);
    46| 			$r['regrinfo']['registered'] = 'no';
    47| 			return $r;
    48| 			}
    49| 		$r['regrinfo']['domain']['created'] = get_date($r['regrinfo']['domain']['created'], 'dmy');
    50| 		if ($r['regrinfo']['domain']['status'] == 'ACTIVE')
    51| 			{
    52| 			$r['regrinfo'] = get_contacts($r['regrinfo']);
    53| 			$r['regrinfo']['registered'] = 'yes';
    54| 			}
    55| 		else
    56| 			$r['regrinfo']['registered'] = 'no';
    57| 		$r['regyinfo'] = array(
    58| 			'referrer' => 'http://www.fccn.pt',
    59| 			'registrar' => 'FCCN'


# ====================================================================
# FILE: src/whois.ro.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-78 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__RO_HANDLER__'))
    25|     define('__RO_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| /**
    28|  * @TODO BUG
    29|  * - date on ro could be given as "mail date" (ex: updated field)
    30|  * - multiple person for one role, ex: news.ro
    31|  * - seems the only role listed is registrant
    32|  */
    33| class ro_handler {
    34|     function parse($data_str, $query) {
    35|         $translate = array(
    36|             'fax-no' => 'fax',
    37|             'e-mail' => 'email',
    38|             'nic-hdl' => 'handle',
    39|             'person' => 'name',
    40|             'address' => 'address.',
    41|             'domain-name' => '',
    42|             'updated' => 'changed',
    43|             'registration-date' => 'created',
    44|             'domain-status' => 'status',
    45|             'nameserver' => 'nserver'
    46|         );
    47|         $contacts = array(
    48|             'admin-contact' => 'admin',
    49|             'technical-contact' => 'tech',
    50|             'zone-contact' => 'zone',
    51|             'billing-contact' => 'billing'
    52|         );
    53|         $extra = array(
    54|             'postal code:' => 'address.pcode'
    55|         );
    56|         $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    57|         if (isset($reg['domain']['description'])) {
    58|             $reg['owner'] = get_contact($reg['domain']['description'], $extra);
    59|             unset($reg['domain']['description']);
    60|             foreach ($reg as $key => $item) {
    61|                 if (isset($item['address'])) {
    62|                     $data = $item['address'];
    63|                     unset($reg[$key]['address']);
    64|                     $reg[$key] = array_merge($reg[$key], get_contact($data, $extra));
    65|                 }
    66|             }
    67|             $reg['registered'] = 'yes';
    68|         } else
    69|             $reg['registered'] = 'no';
    70|         $r = array();
    71|         $r['regrinfo'] = $reg;
    72|         $r['regyinfo'] = array(
    73|             'referrer' => 'http://www.nic.ro',
    74|             'registrar' => 'nic.ro'
    75|         );
    76|         return $r;
    77|     }
    78| }


# ====================================================================
# FILE: src/whois.ru.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-53 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__RU_HANDLER__'))
    25|     define('__RU_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class ru_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'domain:' => 'domain.name',
    31|             'registrar:' => 'domain.sponsor',
    32|             'state:' => 'domain.status',
    33|             'nserver:' => 'domain.nserver.',
    34|             'source:' => 'domain.source',
    35|             'created:' => 'domain.created',
    36|             'paid-till:' => 'domain.expires',
    37|             'type:' => 'owner.type',
    38|             'org:' => 'owner.organization',
    39|             'phone:' => 'owner.phone',
    40|             'fax-no:' => 'owner.fax',
    41|             'e-mail:' => 'owner.email'
    42|         );
    43|         $r = array();
    44|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
    45|         if (empty($r['regrinfo']['domain']['status']))
    46|             $r['regrinfo']['registered'] = 'no';
    47|         $r['regyinfo'] = array(
    48|             'referrer' => 'http://www.ripn.net',
    49|             'registrar' => 'RU-CENTER-REG-RIPN'
    50|         );
    51|         return $r;
    52|     }
    53| }


# ====================================================================
# FILE: src/whois.rwhois.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-49 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__RWHOIS_HANDLER__'))
    25|     define('__RWHOIS_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class rwhois_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'network:Organization-Name:' => 'owner.name',
    31|             'network:Organization;I:' => 'owner.organization',
    32|             'network:Organization-City:' => 'owner.address.city',
    33|             'network:Organization-Zip:' => 'owner.address.pcode',
    34|             'network:Organization-Country:' => 'owner.address.country',
    35|             'network:IP-Network-Block:' => 'network.inetnum',
    36|             'network:IP-Network:' => 'network.inetnum',
    37|             'network:Network-Name:' => 'network.name',
    38|             'network:ID:' => 'network.handle',
    39|             'network:Created:' => 'network.created',
    40|             'network:Updated:' => 'network.changed',
    41|             'network:Tech-Contact;I:' => 'tech.email',
    42|             'network:Admin-Contact;I:' => 'admin.email'
    43|         );
    44|         $res = generic_parser_b($data_str, $items, 'Ymd', false);
    45|         if (isset($res['disclaimer']))
    46|             unset($res['disclaimer']);
    47|         return array('regrinfo' => $res);
    48|     }
    49| }


# ====================================================================
# FILE: src/whois.sc.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__SC_HANDLER__'))
    25|     define('__SC_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class sc_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], array(), 'dmy');
    31|         $r['regyinfo'] = array(
    32|             'referrer' => 'http://www.nic.sc',
    33|             'registrar' => 'VCS (Pty) Limited'
    34|         );
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.se.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-51 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__SE_HANDLER__')) {
    25|     define('__SE_HANDLER__', 1);
    26| }
    27| require_once('whois.parser.php');
    28| class se_handler {
    29|     function parse($data_str, $query) {
    30|         $items = [
    31|             'domain:' => 'domain.name',
    32|             'state:' => 'domain.status.',
    33|             'status:' => 'domain.status.',
    34|             'expires:' => 'domain.expires',
    35|             'created:' => 'domain.created',
    36|             'modified:' => 'domain.changed',
    37|             'nserver:' => 'domain.nserver.',
    38|             'registrar:' => 'domain.sponsor',
    39|             'holder:' => 'owner.handle',
    40|         ];
    41|         $r = [];
    42|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd', false);
    43|         $r['regrinfo']['registered'] = isset($r['regrinfo']['domain']['name']) ? 'yes' : 'no';
    44|         $r['regyinfo'] = [
    45|             'referrer' => 'http://www.nic-se.se',
    46|             'registrar' => 'NIC-SE'
    47|         ];
    48|         $r['rawdata'] = $data_str['rawdata'];
    49|         return $r;
    50|     }
    51| }


# ====================================================================
# FILE: src/whois.servers.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-643 ---
     1| <?php
     2| /**
     3|  * Whois servers list
     4|  * 
     5|  * This class supposed to be instantiated for using the phpWhois library
     6|  * 
     7|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     8|  * @license
     9|  * This program is free software; you can redistribute it and/or
    10|  * modify it under the terms of the GNU General Public License
    11|  * as published by the Free Software Foundation; either version 2
    12|  * of the License, or (at your option) any later version.
    13|  * 
    14|  * This program is distributed in the hope that it will be useful,
    15|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    16|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    17|  * GNU General Public License for more details.
    18|  * 
    19|  * You should have received a copy of the GNU General Public License
    20|  * along with this program; if not, write to the Free Software
    21|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    22|  * 
    23|  * @link http://phpwhois.pw
    24|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    25|  * @copyright Maintained by David Saez
    26|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    27|  */
    28| return array(
    29| 'DATA' => array(
    30|     'bz'       => 'gtld',
    31|     'com'      => 'gtld',
    32|     'jobs'     => 'gtld',
    33|     'li'       => 'ch',
    34|     'net'      => 'gtld',
    35|     'su'       => 'ru',
    36|     'tv'       => 'gtld',
    37|     'za.org'   => 'zanet',
    38|     'za.net'   => 'zanet',
    39|     'xn--p1ai' => 'ru',
    40| ),
    41| /* Non UTF-8 servers */
    42| 'NON_UTF8' => array(
    43|     'br.whois-servers.net'  => 1,
    44|     'ca.whois-servers.net'  => 1,
    45|     'cl.whois-servers.net'  => 1,
    46|     'hu.whois-servers.net'  => 1,
    47|     'is.whois-servers.net'  => 1,
    48|     'pt.whois-servers.net'  => 1,
    49|     'whois.interdomain.net' => 1,
    50|     'whois.lacnic.net'      => 1,
    51|     'whois.nicline.com'     => 1,
    52|     'whois.ripe.net'        => 1,
    53| ),
    54| /* If whois Server needs any parameters, enter it here */
    55| 'WHOIS_PARAM' => array(
    56|     'com.whois-servers.net' => 'domain =$domain',
    57|     'net.whois-servers.net' => 'domain =$domain',
    58|     'de.whois-servers.net'  => '-T dn,ace $domain',
    59|     'jp.whois-servers.net'  => 'DOM $domain/e',
    60|     'whois.denic.de'        => '-T dn,ace $domain.$tld',
    61|     'whois.dk-hostmaster.dk' => '--show-handles --charset=utf8 $domain.$tld',
    62| ),
    63| /* TLD's that have special whois servers or that can only be reached via HTTP */
    64| 'WHOIS_SPECIAL' => array(
    65|     'ac'                     => 'whois.nic.ac',
    66|     'academy'                => 'whois.donuts.co',
    67|     'accountants'            => 'whois.donuts.co',
    68|     'active'                 => 'whois.afilias-srs.net',
    69|     'actor'                  => 'whois.unitedtld.com',
    70|     'ad'                     => '',
    71|     'ae'                     => 'whois.aeda.net.ae',
    72|     'aero'                   => 'whois.aero',
    73|     'af'                     => 'whois.nic.af',
    74|     'ag'                     => 'whois.nic.ag',
    75|     'agency'                 => 'whois.donuts.co',
    76|     'ai'                     => 'whois.ai',
    77|     'airforce'               => 'whois.unitedtld.com',
    78|     'al'                     => '',
    79|     'am'                     => 'whois.amnic.net',
    80|     'app'                    => 'whois.nic.google',
    81|     'archi'                  => 'whois.ksregistry.net',
    82|     'army'                   => 'whois.rightside.co',
    83|     'arpa'                   => 'whois.iana.org',
    84|     'as'                     => 'whois.nic.as',
    85|     'asia'                   => 'whois.nic.asia',
    86|     'associates'             => 'whois.donuts.co',
    87|     'at'                     => 'whois.nic.at',
    88|     'attorney'               => 'whois.rightside.co',
    89|     'au'                     => 'whois.audns.net.au',
    90|     'auction'                => 'whois.donuts.co',
    91|     'audio'                  => 'whois.uniregistry.net',
    92|     'autos'                  => 'whois.afilias-srs.net',
    93|     'aw'                     => 'whois.nic.aw',
    94|     'ax'                     => 'whois.ax',
    95|     'az'                     => '',
    96|     'ba'                     => '',
    97|     'bar'                    => 'whois.nic.bar',
    98|     'bargains'               => 'whois.donuts.co',
    99|     'bayern'                 => 'whois-dub.mm-registry.com',
   100|     'bb'                     => 'http://domains.org.bb/regsearch/getdetails.cfm?DND={domain}.bb',
   101|     'be'                     => 'whois.dns.be',
   102|     'beer'                   => 'whois-dub.mm-registry.com',
   103|     'berlin'                 => 'whois.nic.berlin',
   104|     'best'                   => 'whois.nic.best',
   105|     'bg'                     => 'whois.register.bg',
   106|     'bh'                     => 'whois.nic.bh',
   107|     'bi'                     => 'whois1.nic.bi',
   108|     'bid'                    => 'whois.nic.bid',
   109|     'bike'                   => 'whois.donuts.co',
   110|     'bio'                    => 'whois.ksregistry.net',
   111|     'biz'                    => 'whois.biz',
   112|     'bj'                     => 'whois.nic.bj',
   113|     'black'                  => 'whois.afilias.net',
   114|     'blackfriday'            => 'whois.uniregistry.net',
   115|     'blue'                   => 'whois.afilias.net',
   116|     'bmw'                    => 'whois.ksregistry.net',
   117|     'bn'                     => 'whois.bn',
   118|     'bo'                     => 'whois.nic.bo',
   119|     'boutique'               => 'whois.donuts.co',
   120|     'br'                     => 'whois.registro.br',
   121|     'brussels'               => 'whois.nic.brussels',
   122|     'build'                  => 'whois.nic.build',
   123|     'builders'               => 'whois.donuts.co',
   124|     'buzz'                   => 'whois.nic.buzz',
   125|     'bw'                     => 'whois.nic.net.bw',
   126|     'by'                     => 'whois.cctld.by',
   127|     'bzh'                    => 'whois-bzh.nic.fr',
   128|     'ca'                     => 'whois.cira.ca',
   129|     'cab'                    => 'whois.donuts.co',
   130|     'camera'                 => 'whois.donuts.co',
   131|     'camp'                   => 'whois.donuts.co',
   132|     'cancerresearch'         => 'whois.nic.cancerresearch',
   133|     'capetown'               => 'capetown-whois.registry.net.za',
   134|     'capital'                => 'whois.donuts.co',
   135|     'cards'                  => 'whois.donuts.co',
   136|     'care'                   => 'whois.donuts.co',
   137|     'career'                 => 'whois.nic.career',
   138|     'careers'                => 'whois.donuts.co',
   139|     'cash'                   => 'whois.donuts.co',
   140|     'cat'                    => 'whois.cat',
   141|     'catering'               => 'whois.donuts.co',
   142|     'cc'                     => 'ccwhois.verisign-grs.com',
   143|     'center'                 => 'whois.donuts.co',
   144|     'ceo'                    => 'whois.nic.ceo',
   145|     'cf'                     => 'whois.dot.cf',
   146|     'ch'                     => 'whois.nic.ch',
   147|     'cheap'                  => 'whois.donuts.co',
   148|     'christmas'              => 'whois.uniregistry.net',
   149|     'church'                 => 'whois.donuts.co',
   150|     'ci'                     => 'whois.nic.ci',
   151|     'city'                   => 'whois.donuts.co',
   152|     'cl'                     => 'whois.nic.cl',
   153|     'claims'                 => 'whois.donuts.co',
   154|     'cleaning'               => 'whois.donuts.co',
   155|     'clinic'                 => 'whois.donuts.co',
   156|     'clothing'               => 'whois.donuts.co',
   157|     'club'                   => 'whois.nic.club',
   158|     'cn'                     => 'whois.cnnic.cn',
   159|     'co'                     => 'whois.nic.co',
   160|     'codes'                  => 'whois.donuts.co',
   161|     'coffee'                 => 'whois.donuts.co',
   162|     'college'                => 'whois.centralnic.com',
   163|     'cologne'                => 'whois-fe1.pdt.cologne.tango.knipp.de',
   164|     'community'              => 'whois.donuts.co',
   165|     'company'                => 'whois.donuts.co',
   166|     'computer'               => 'whois.donuts.co',
   167|     'condos'                 => 'whois.donuts.co',
   168|     'construction'           => 'whois.donuts.co',
   169|     'consulting'             => 'whois.unitedtld.com',
   170|     'contractors'            => 'whois.donuts.co',
   171|     'cooking'                => 'whois-dub.mm-registry.com',
   172|     'cool'                   => 'whois.donuts.co',
   173|     'coop'                   => 'whois.nic.coop',
   174|     'country'                => 'whois-dub.mm-registry.com',
   175|     'credit'                 => 'whois.donuts.co',
   176|     'creditcard'             => 'whois.donuts.co',
   177|     'cruises'                => 'whois.donuts.co',
   178|     'cuisinella'             => 'whois.nic.cuisinella',
   179|     'cx'                     => 'whois.nic.cx',
   180|     'cy'                     => '',
   181|     'cz'                     => 'whois.nic.cz',
   182|     'dance'                  => 'whois.unitedtld.com',
   183|     'dating'                 => 'whois.donuts.co',
   184|     'de'                     => 'whois.denic.de',
   185|     'deals'                  => 'whois.donuts.co',
   186|     'degree'                 => 'whois.rightside.co',
   187|     'democrat'               => 'whois.unitedtld.com',
   188|     'dental'                 => 'whois.donuts.co',
   189|     'dentist'                => 'whois.rightside.co',
   190|     'desi'                   => 'whois.ksregistry.net',
   191|     'dev'                    => 'whois.nic.google',
   192|     'diamonds'               => 'whois.donuts.co',
   193|     'digital'                => 'whois.donuts.co',
   194|     'direct'                 => 'whois.donuts.co',
   195|     'directory'              => 'whois.donuts.co',
   196|     'discount'               => 'whois.donuts.co',
   197|     'dk'                     => 'whois.dk-hostmaster.dk',
   198|     'dm'                     => 'whois.nic.dm',
   199|     'domains'                => 'whois.donuts.co',
   200|     'durban'                 => 'durban-whois.registry.net.za',
   201|     'dz'                     => 'whois.nic.dz',
   202|     'ec'                     => 'whois.nic.ec',
   203|     'edu'                    => 'whois.educause.edu',
   204|     'education'              => 'whois.donuts.co',
   205|     'ee'                     => 'whois.tld.ee',
   206|     'email'                  => 'whois.donuts.co',
   207|     'engineer'               => 'whois.rightside.co',
   208|     'engineering'            => 'whois.donuts.co',
   209|     'enterprises'            => 'whois.donuts.co',
   210|     'equipment'              => 'whois.donuts.co',
   211|     'es'                     => 'whois.nic.es',
   212|     'estate'                 => 'whois.donuts.co',
   213|     'eu'                     => 'whois.eu',
   214|     'eus'                    => 'whois.eus.coreregistry.net',
   215|     'events'                 => 'whois.donuts.co',
   216|     'exchange'               => 'whois.donuts.co',
   217|     'expert'                 => 'whois.donuts.co',
   218|     'exposed'                => 'whois.donuts.co',
   219|     'fail'                   => 'whois.donuts.co',
   220|     'farm'                   => 'whois.donuts.co',
   221|     'feedback'               => 'whois.centralnic.com',
   222|     'fi'                     => 'whois.fi',
   223|     'finance'                => 'whois.donuts.co',
   224|     'financial'              => 'whois.donuts.co',
   225|     'fish'                   => 'whois.donuts.co',
   226|     'fishing'                => 'whois-dub.mm-registry.com',
   227|     'fitness'                => 'whois.donuts.co',
   228|     'fj'                     => 'whois.usp.ac.fj',
   229|     'flights'                => 'whois.donuts.co',
   230|     'florist'                => 'whois.donuts.co',
   231|     'fm'                     => 'http://www.dot.fm/query_whois.cfm?domain={domain}&tld=fm',
   232|     'fo'                     => 'whois.nic.fo',
   233|     'foo'                    => 'domain-registry-whois.l.google.com',
   234|     'foundation'             => 'whois.donuts.co',
   235|     'fr'                     => 'whois.nic.fr',
   236|     'frogans'                => 'whois-frogans.nic.fr',
   237|     'fund'                   => 'whois.donuts.co',
   238|     'furniture'              => 'whois.donuts.co',
   239|     'futbol'                 => 'whois.unitedtld.com',
   240|     'gal'                    => 'whois.gal.coreregistry.net',
   241|     'gallery'                => 'whois.donuts.co',
   242|     'gd'                     => 'whois.nic.gd',
   243|     'gent'                   => 'whois.nic.gent',
   244|     'gg'                     => 'whois.gg',
   245|     'gi'                     => 'whois2.afilias-grs.net',
   246|     'gift'                   => 'whois.uniregistry.net',
   247|     'gives'                  => 'whois.rightside.co',
   248|     'gl'                     => 'whois.nic.gl',
   249|     'glass'                  => 'whois.donuts.co',
   250|     'global'                 => 'whois.afilias-srs.net',
   251|     'globo'                  => 'whois.gtlds.nic.br',
   252|     'gop'                    => 'whois-cl01.mm-registry.com',
   253|     'gov'                    => 'whois.dotgov.gov',
   254|     'gr'                     => '',
   255|     'graphics'               => 'whois.donuts.co',
   256|     'gratis'                 => 'whois.donuts.co',
   257|     'green'                  => 'whois.afilias.net',
   258|     'gripe'                  => 'whois.donuts.co',
   259|     'gs'                     => 'whois.nic.gs',
   260|     'gt'                     => 'http://www.gt/Inscripcion/whois.php?domain={domain}.gt',
   261|     'guide'                  => 'whois.donuts.co',
   262|     'guitars'                => 'whois.uniregistry.net',
   263|     'guru'                   => 'whois.donuts.co',
   264|     'gy'                     => 'whois.registry.gy',
   265|     'hamburg'                => 'whois.nic.hamburg',
   266|     'haus'                   => 'whois.unitedtld.com',
   267|     'hiphop'                 => 'whois.uniregistry.net',
   268|     'hiv'                    => 'whois.afilias-srs.net',
   269|     'hk'                     => 'whois.hkirc.hk',
   270|     'hn'                     => 'whois.nic.hn',
   271|     'holdings'               => 'whois.donuts.co',
   272|     'holiday'                => 'whois.donuts.co',
   273|     'homes'                  => 'whois.afilias-srs.net',
   274|     'horse'                  => 'whois-dub.mm-registry.com',
   275|     'host'                   => 'whois.centralnic.com',
   276|     'house'                  => 'whois.donuts.co',
   277|     'hr'                     => 'whois.dns.hr',
   278|     'ht'                     => 'whois.nic.ht',
   279|     'hu'                     => 'whois.nic.hu',
   280|     'id'                     => 'whois.pandi.or.id',
   281|     'ie'                     => 'whois.domainregistry.ie',
   282|     'il'                     => 'whois.isoc.org.il',
   283|     'im'                     => 'whois.nic.im',
   284|     'immobilien'             => 'whois.unitedtld.com',
   285|     'in'                     => 'whois.inregistry.net',
   286|     'industries'             => 'whois.donuts.co',
   287|     'info'                   => 'whois.afilias.net',
   288|     'ink'                    => 'whois.centralnic.com',
   289|     'institute'              => 'whois.donuts.co',
   290|     'insure'                 => 'whois.donuts.co',
   291|     'int'                    => 'whois.iana.org',
   292|     'international'          => 'whois.donuts.co',
   293|     'investments'            => 'whois.donuts.co',
   294|     'io'                     => 'whois.nic.io',
   295|     'iq'                     => 'whois.cmc.iq',
   296|     'ir'                     => 'whois.nic.ir',
   297|     'is'                     => 'whois.isnic.is',
   298|     'it'                     => 'whois.nic.it',
   299|     'je'                     => 'whois.je',
   300|     'jetzt'                  => 'whois.nic.jetzt',
   301|     'joburg'                 => 'joburg-whois.registry.net.za',
   302|     'jp'                     => 'whois.jprs.jp',
   303|     'juegos'                 => 'whois.uniregistry.net',
   304|     'kaufen'                 => 'whois.unitedtld.com',
   305|     'ke'                     => 'whois.kenic.or.ke',
   306|     'kg'                     => 'whois.domain.kg',
   307|     'ki'                     => 'whois.nic.ki',
   308|     'kim'                    => 'whois.afilias.net',
   309|     'kitchen'                => 'whois.donuts.co',
   310|     'kiwi'                   => 'whois.dot-kiwi.com',
   311|     'koeln'                  => 'whois-fe1.pdt.koeln.tango.knipp.de',
   312|     'kr'                     => 'whois.kr',
   313|     'krd'                    => 'whois.aridnrs.net.au',
   314|     'kred'                   => 'whois.nic.kred',
   315|     'kz'                     => 'whois.nic.kz',
   316|     'la'                     => 'whois.nic.la',
   317|     'lacaixa'                => 'whois.nic.lacaixa',
   318|     'land'                   => 'whois.donuts.co',
   319|     'lawyer'                 => 'whois.rightside.co',
   320|     'lease'                  => 'whois.donuts.co',
   321|     'lgbt'                   => 'whois.afilias.net',
   322|     'life'                   => 'whois.donuts.co',
   323|     'lighting'               => 'whois.donuts.co',
   324|     'limited'                => 'whois.donuts.co',
   325|     'limo'                   => 'whois.donuts.co',
   326|     'link'                   => 'whois.uniregistry.net',
   327|     'loans'                  => 'whois.donuts.co',
   328|     'london'                 => 'whois.nic.london',
   329|     'lotto'                  => 'whois.afilias.net',
   330|     'lt'                     => 'whois.domreg.lt',
   331|     'lu'                     => 'whois.dns.lu',
   332|     'luxe'                   => 'whois-dub.mm-registry.com',
   333|     'luxury'                 => 'whois.nic.luxury',
   334|     'lv'                     => 'whois.nic.lv',
   335|     'ly'                     => 'whois.nic.ly',
   336|     'ma'                     => 'whois.iam.net.ma',
   337|     'maison'                 => 'whois.donuts.co',
   338|     'management'             => 'whois.donuts.co',
   339|     'mango'                  => 'whois.mango.coreregistry.net',
   340|     'market'                 => 'whois.rightside.co',
   341|     'marketing'              => 'whois.donuts.co',
   342|     'md'                     => 'whois.nic.md',
   343|     'me'                     => 'whois.nic.me',
   344|     'media'                  => 'whois.donuts.co',
   345|     'meet'                   => 'whois.afilias.net',
   346|     'melbourne'              => 'whois.aridnrs.net.au',
   347|     'menu'                   => 'whois.nic.menu',
   348|     'mg'                     => 'whois.nic.mg',
   349|     'miami'                  => 'whois-dub.mm-registry.com',
   350|     'mini'                   => 'whois.ksregistry.net',
   351|     'mk'                     => 'whois.marnet.mk',
   352|     'ml'                     => 'whois.dot.ml',
   353|     'mn'                     => 'whois.nic.mn',
   354|     'mo'                     => 'whois.monic.mo',
   355|     'mobi'                   => 'whois.dotmobiregistry.net',
   356|     'moda'                   => 'whois.unitedtld.com',
   357|     'monash'                 => 'whois.nic.monash',
   358|     'mortgage'               => 'whois.rightside.co',
   359|     'moscow'                 => 'whois.nic.moscow',
   360|     'motorcycles'            => 'whois.afilias-srs.net',
   361|     'mp'                     => 'whois.nic.mp',
   362|     'ms'                     => 'whois.nic.ms',
   363|     'mt'                     => 'http://www.um.edu.mt/cgi-bin/nic/whois?domain={domain}.mt',
   364|     'mu'                     => 'whois.nic.mu',
   365|     'museum'                 => 'whois.museum',
   366|     'mx'                     => 'whois.mx',
   367|     'my'                     => 'whois.mynic.my',
   368|     'na'                     => 'whois.na-nic.com.na',
   369|     'nagoya'                 => 'whois.gmoregistry.net',
   370|     'name'                   => 'whois.nic.name',
   371|     'navy'                   => 'whois.rightside.co',
   372|     'nc'                     => 'whois.nc',
   373|     'nf'                     => 'whois.nic.nf',
   374|     'ng'                     => 'whois.nic.net.ng',
   375|     'ngo'                    => 'whois.publicinterestregistry.net',
   376|     'ninja'                  => 'whois.unitedtld.com',
   377|     'nl'                     => 'whois.domain-registry.nl',
   378|     'no'                     => 'whois.norid.no',
   379|     'nra'                    => 'whois.afilias-srs.net',
   380|     'nrw'                    => 'whois-fe1.pdt.nrw.tango.knipp.de',
   381|     'nu'                     => 'whois.iis.nu',
   382|     'nyc'                    => 'whois.nic.nyc',
   383|     'nz'                     => 'whois.srs.net.nz',
   384|     'okinawa'                => 'whois.gmoregistry.ne',
   385|     'om'                     => 'whois.registry.om',
   386|     'onl'                    => 'whois.afilias-srs.net',
   387|     'org'                    => 'whois.pir.org',
   388|     'organic'                => 'whois.afilias.net',
   389|     'ovh'                    => 'whois-ovh.nic.fr',
   390|     'paris'                  => 'whois-paris.nic.fr',
   391|     'partners'               => 'whois.donuts.co',
   392|     'parts'                  => 'whois.donuts.co',
   393|     'pe'                     => 'kero.yachay.pe',
   394|     'pf'                     => 'whois.registry.pf',
   395|     'photo'                  => 'whois.uniregistry.net',
   396|     'photography'            => 'whois.donuts.co',
   397|     'photos'                 => 'whois.donuts.co',
   398|     'ph'                     => 'whois.iana.org',
   399|     'physio'                 => 'whois.nic.physio',
   400|     'pics'                   => 'whois.uniregistry.net',
   401|     'pictures'               => 'whois.donuts.co',
   402|     'pink'                   => 'whois.afilias.net',
   403|     'pl'                     => 'whois.dns.pl',
   404|     'place'                  => 'whois.donuts.co',
   405|     'plumbing'               => 'whois.donuts.co',
   406|     'pm'                     => 'whois.nic.pm',
   407|     'post'                   => 'whois.dotpostregistry.net',
   408|     'pr'                     => 'whois.nic.pr',
   409|     'press'                  => 'whois.centralnic.com',
   410|     'pro'                    => 'whois.dotproregistry.net',
   411|     'productions'            => 'whois.donuts.co',
   412|     'properties'             => 'whois.donuts.co',
   413|     'pt'                     => 'whois.dns.pt',
   414|     'pub'                    => 'whois.unitedtld.com',
   415|     'pw'                     => 'whois.nic.pw',
   416|     'qa'                     => 'whois.registry.qa',
   417|     'qpon'                   => 'whois.nic.qpon',
   418|     'quebec'                 => 'whois.quebec.rs.corenic.net',
   419|     're'                     => 'whois.nic.re',
   420|     'recipes'                => 'whois.donuts.co',
   421|     'red'                    => 'whois.afilias.net',
   422|     'rehab'                  => 'whois.rightside.co',
   423|     'reise'                  => 'whois.nic.reise',
   424|     'reisen'                 => 'whois.donuts.co',
   425|     'rentals'                => 'whois.donuts.co',
   426|     'repair'                 => 'whois.donuts.co',
   427|     'report'                 => 'whois.donuts.co',
   428|     'republican'             => 'whois.rightside.co',
   429|     'rest'                   => 'whois.centralnic.com',
   430|     'reviews'                => 'whois.unitedtld.com',
   431|     'rich'                   => 'whois.afilias-srs.net',
   432|     'rio'                    => 'whois.gtlds.nic.br',
   433|     'ro'                     => 'whois.rotld.ro',
   434|     'rocks'                  => 'whois.unitedtld.com',
   435|     'rodeo'                  => 'whois-dub.mm-registry.com',
   436|     'rs'                     => 'whois.rnids.rs',
   437|     'ru'                     => 'whois.tcinet.ru',
   438|     'ruhr'                   => 'whois.nic.ruhr',
   439|     'sa'                     => 'whois.nic.net.sa',
   440|     'saarland'               => 'whois.ksregistry.net',
   441|     'sb'                     => 'whois.nic.net.sb',
   442|     'sc'                     => 'whois2.afilias-grs.net',
   443|     'scb'                    => 'whois.nic.scb',
   444|     'schmidt'                => 'whois.nic.schmidt',
   445|     'schule'                 => 'whois.donuts.co',
   446|     'scot'                   => 'whois.scot.coreregistry.net',
   447|     'se'                     => 'whois.iis.se',
   448|     'services'               => 'whois.donuts.co',
   449|     'sexy'                   => 'whois.uniregistry.net',
   450|     'sg'                     => 'whois.sgnic.sg',
   451|     'sh'                     => 'whois.nic.sh',
   452|     'shiksha'                => 'whois.afilias.net',
   453|     'shoes'                  => 'whois.donuts.co',
   454|     'si'                     => 'whois.arnes.si',
   455|     'singles'                => 'whois.donuts.co',
   456|     'sk'                     => 'whois.sk-nic.sk',
   457|     'sm'                     => 'whois.nic.sm',
   458|     'sn'                     => 'whois.nic.sn',
   459|     'so'                     => 'whois.nic.so',
   460|     'social'                 => 'whois.unitedtld.com',
   461|     'software'               => 'whois.rightside.co',
   462|     'sohu'                   => 'whois.gtld.knet.cn',
   463|     'solar'                  => 'whois.donuts.co',
   464|     'solutions'              => 'whois.donuts.co',
   465|     'soy'                    => 'domain-registry-whois.l.google.com',
   466|     'space'                  => 'whois.nic.space',
   467|     'spiegel'                => 'whois.ksregistry.net',
   468|     'st'                     => 'whois.nic.st',
   469|     'su'                     => 'whois.tcinet.ru',
   470|     'supplies'               => 'whois.donuts.co',
   471|     'supply'                 => 'whois.donuts.co',
   472|     'support'                => 'whois.donuts.co',
   473|     'surf'                   => 'whois-dub.mm-registry.com',
   474|     'surgery'                => 'whois.donuts.co',
   475|     'sx'                     => 'whois.sx',
   476|     'sy'                     => 'whois.tld.sy',
   477|     'systems'                => 'whois.donuts.co',
   478|     'tattoo'                 => 'whois.uniregistry.net',
   479|     'tax'                    => 'whois.donuts.co',
   480|     'tc'                     => 'whois.meridiantld.net',
   481|     'technology'             => 'whois.donuts.co',
   482|     'tel'                    => 'whois.nic.tel',
   483|     'tf'                     => 'whois.nic.tf',
   484|     'th'                     => 'whois.thnic.co.th',
   485|     'tienda'                 => 'whois.donuts.co',
   486|     'tips'                   => 'whois.donuts.co',
   487|     'tirol'                  => 'whois.nic.tirol',
   488|     'tk'                     => 'whois.dot.tk',
   489|     'tl'                     => 'whois.nic.tl',
   490|     'tm'                     => 'whois.nic.tm',
   491|     'tn'                     => 'whois.ati.tn',
   492|     'to'                     => 'whois.tonic.to',
   493|     'today'                  => 'whois.donuts.co',
   494|     'tokyo'                  => 'whois.nic.tokyo',
   495|     'tools'                  => 'whois.donuts.co',
   496|     'town'                   => 'whois.donuts.co',
   497|     'toys'                   => 'whois.donuts.co',
   498|     'tr'                     => 'whois.nic.tr',
   499|     'trade'                  => 'whois.nic.trade',
   500|     'training'               => 'whois.donuts.co',
   501|     'travel'                 => 'whois.nic.travel',
   502|     'tw'                     => 'whois.twnic.net.tw',
   503|     'tz'                     => 'whois.tznic.or.tz',
   504|     'ua'                     => 'whois.ua',
   505|     'ug'                     => 'whois.co.ug',
   506|     'uk'                     => 'whois.nic.uk',
   507|     'university'             => 'whois.donuts.co',
   508|     'uno'                    => 'whois.nic.uno',
   509|     'us'                     => 'whois.nic.us',
   510|     'uy'                     => 'whois.nic.org.uy',
   511|     'uz'                     => 'whois.cctld.uz',
   512|     'vacations'              => 'whois.donuts.co',
   513|     'vc'                     => 'whois2.afilias-grs.net',
   514|     've'                     => 'whois.nic.ve',
   515|     'vegas'                  => 'whois.afilias-srs.net',
   516|     'ventures'               => 'whois.donuts.co',
   517|     'versicherung'           => 'whois.nic.versicherung',
   518|     'vet'                    => 'whois.rightside.co',
   519|     'vg'                     => 'ccwhois.ksregistry.net',
   520|     'viajes'                 => 'whois.donuts.co',
   521|     'villas'                 => 'whois.donuts.co',
   522|     'vision'                 => 'whois.donuts.co',
   523|     'vlaanderen'             => 'whois.nic.vlaanderen',
   524|     'vodka'                  => 'whois-dub.mm-registry.com',
   525|     'vote'                   => 'whois.afilias.net',
   526|     'voting'                 => 'whois.voting.tld-box.at',
   527|     'voto'                   => 'whois.afilias.net',
   528|     'voyage'                 => 'whois.donuts.co',
   529|     'vu'                     => 'vunic.vu',
   530|     'wang'                   => 'whois.gtld.knet.cn',
   531|     'watch'                  => 'whois.donuts.co',
   532|     'webcam'                 => 'whois.nic.webcam',
   533|     'website'                => 'whois.nic.website',
   534|     'wed'                    => 'whois.nic.wed',
   535|     'wf'                     => 'whois.nic.wf',
   536|     'wien'                   => 'whois.nic.wien',
   537|     'wiki'                   => 'whois.nic.wiki',
   538|     'works'                  => 'whois.donuts.co',
   539|     'ws'                     => 'whois.website.ws',
   540|     'wtc'                    => 'whois.nic.wtc',
   541|     'wtf'                    => 'whois.donuts.co',
   542|     'xxx'                    => 'whois.nic.xxx',
   543|     'xyz'                    => 'whois.nic.xyz',
   544|     'yachts'                 => 'whois.afilias-srs.net',
   545|     'yt'                     => 'whois.nic.yt',
   546|     'zip'                    => 'domain-registry-whois.l.google.com',
   547|     'zm'                     => 'whois.nic.zm',
   548|     'zone'                   => 'whois.donuts.co',
   549|     'net.au'                 => 'whois.aunic.net',
   550|     'ae.com'                 => 'whois.centralnic.net',
   551|     'br.com'                 => 'whois.centralnic.net',
   552|     'cn.com'                 => 'whois.centralnic.net',
   553|     'de.com'                 => 'whois.centralnic.net',
   554|     'eu.com'                 => 'whois.centralnic.net',
   555|     'gb.com'                 => 'whois.centralnic.net',
   556|     'hu.com'                 => 'whois.centralnic.net',
   557|     'jpn.com'                => 'whois.centralnic.net',
   558|     'kr.com'                 => 'whois.centralnic.net',
   559|     'no.com'                 => 'whois.centralnic.net',
   560|     'qc.com'                 => 'whois.centralnic.net',
   561|     'ru.com'                 => 'whois.centralnic.net',
   562|     'sa.com'                 => 'whois.centralnic.net',
   563|     'se.com'                 => 'whois.centralnic.net',
   564|     'uk.com'                 => 'whois.centralnic.net',
   565|     'us.com'                 => 'whois.centralnic.net',
   566|     'uy.com'                 => 'whois.centralnic.net',
   567|     'za.com'                 => 'whois.centralnic.net',
   568|     'com.my'                 => 'whois.mynic.net.my',
   569|     'gb.net'                 => 'whois.centralnic.net',
   570|     'se.net'                 => 'whois.centralnic.net',
   571|     'uk.net'                 => 'whois.centralnic.net',
   572|     'za.net'                 => 'http://www.za.net/cgi-bin/whois.cgi?domain={domain}.za.net',
   573|     'za.org'                 => 'http://www.za.net/cgi-bin/whois.cgi?domain={domain}.za.org',
   574|     'com.ru'                 => 'whois.nic.ru',
   575|     'msk.ru'                 => 'whois.nic.ru',
   576|     'net.ru'                 => 'whois.nic.ru',
   577|     'org.ru'                 => 'whois.nic.ru',
   578|     'pp.ru'                  => 'whois.nic.ru',
   579|     'sochi.su'               => 'whois.nic.ru',
   580|     'co.za'                  => 'http://co.za/cgi-bin/whois.sh?Domain={domain}.co.za',
   581|     'org.za'                 => 'http://www.org.za/cgi-bin/rwhois?domain={domain}.org.za&format=full',
   582|     'xn--3bst00m'            => 'whois.gtld.knet.cn',
   583|     'xn--3ds443g'            => 'whois.afilias-srs.net',
   584|     'xn--3e0b707e'           => 'whois.kr',
   585|     'xn--4gbrim'             => 'whois.afilias-srs.net',
   586|     'xn--55qw42g'            => 'whois.conac.cn',
   587|     'xn--55qx5d'             => 'whois.ngtld.cn',
   588|     'xn--6frz82g'            => 'whois.afilias.net',
   589|     'xn--6qq986b3xl'         => 'whois.gtld.knet.cn',
   590|     'xn--80adxhks'           => 'whois.nic.xn--80adxhks',
   591|     'xn--80ao21a'            => 'whois.nic.kz',
   592|     'xn--80asehdb'           => 'whois.online.rs.corenic.net',
   593|     'xn--80aswg'             => 'whois.site.rs.corenic.net',
   594|     'xn--c1avg'              => 'whois.publicinterestregistry.net',
   595|     'xn--cg4bki'             => 'whois.kr',
   596|     'xn--clchc0ea0b2g2a9gcd' => 'whois.sgnic.sg',
   597|     'xn--czru2d'             => 'whois.gtld.knet.cn',
   598|     'xn--d1acj3b'            => 'whois.nic.xn--d1acj3b',
   599|     'xn--fiq228c5hs'         => 'whois.afilias-srs.net',
   600|     'xn--fiq64b'             => 'whois.gtld.knet.cn',
   601|     'xn--fiqs8s'             => 'cwhois.cnnic.cn',
   602|     'xn--fiqz9s'             => 'cwhois.cnnic.cn',
   603|     'xn--i1b6b1a6a2e'        => 'whois.publicinterestregistry.net',
   604|     'xn--io0a7i'             => 'whois.ngtld.cn',
   605|     'xn--j1amh'              => 'whois.dotukr.com',
   606|     'xn--j6w193g'            => 'whois.hkirc.hk',
   607|     'xn--kprw13d'            => 'whois.twnic.net.tw',
   608|     'xn--kpry57d'            => 'whois.twnic.net.tw',
   609|     'xn--lgbbat1ad8j'        => 'whois.nic.dz',
   610|     'xn--mgb9awbf'           => 'whois.registry.om',
   611|     'xn--mgba3a4f16a'        => 'whois.nic.ir',
   612|     'xn--mgbaam7a8h'         => 'whois.aeda.net.ae',
   613|     'xn--mgbab2bd'           => 'whois.bazaar.coreregistry.net',
   614|     'xn--mgberp4a5d4ar'      => 'whois.nic.net.sa',
   615|     'xn--mgbx4cd0ab'         => 'whois.mynic.my',
   616|     'xn--ngbc5azd'           => 'whois.nic.xn--ngbc5azd',
   617|     'xn--nqv7f'              => 'whois.publicinterestregistry.net',
   618|     'xn--nqv7fs00ema'        => 'whois.publicinterestregistry.net',
   619|     'xn--o3cw4h'             => 'whois.thnic.co.th',
   620|     'xn--ogbpf8fl'           => 'whois.tld.sy',
   621|     'xn--p1ai'               => 'whois.tcinet.ru',
   622|     'xn--q9jyb4c'            => 'domain-registry-whois.l.google.com',
   623|     'xn--rhqv96g'            => 'whois.nic.xn--rhqv96g',
   624|     'xn--unup4y'             => 'whois.donuts.co',
   625|     'xn--wgbl6a'             => 'whois.registry.qa',
   626|     'xn--yfro4i67o'          => 'whois.sgnic.sg',
   627|     'xn--ygbi2ammx'          => 'whois.pnina.ps',
   628|     'xn--zfr164b'            => 'whois.conac.cn',
   629| ),
   630| /* handled gTLD whois servers */
   631| 'WHOIS_GTLD_HANDLER' => array(
   632|     'whois.bulkregister.com' => 'enom',
   633|     'whois.dotregistrar.com' => 'dotster',
   634|     'whois.namesdirect.com'  => 'dotster',
   635|     'whois.psi-usa.info'     => 'psiusa',
   636|     'whois.www.tv'           => 'tvcorp',
   637|     'whois.tucows.com'       => 'opensrs',
   638|     'whois.35.com'           => 'onlinenic',
   639|     'whois.nominalia.com'    => 'genericb',
   640|     'whois.encirca.com'      => 'genericb',
   641|     'whois.corenic.net'      => 'genericb'
   642| ),
   643| );


# ====================================================================
# FILE: src/whois.si.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-45 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__SI_HANDLER__'))
    25|     define('__SI_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class si_handler {
    28|     function parse($data_str, $query) {
    29|         $translate = array(
    30|             'nic-hdl' => 'handle',
    31|             'nameserver' => 'nserver'
    32|         );
    33|         $contacts = array(
    34|             'registrant' => 'owner',
    35|             'tech-c' => 'tech'
    36|         );
    37|         $r = array();
    38|         $r['regrinfo'] = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
    39|         $r['regyinfo'] = array(
    40|             'referrer' => 'http://www.arnes.si',
    41|             'registrar' => 'ARNES'
    42|         );
    43|         return $r;
    44|     }
    45| }


# ====================================================================
# FILE: src/whois.su.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-54 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__SU_HANDLER__'))
    25|     define('__SU_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class su_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'domain:' => 'domain.name',
    31|             'registrar:' => 'domain.sponsor',
    32|             'state:' => 'domain.status',
    33|             'person:' => 'owner.name',
    34|             'phone:' => 'owner.phone',
    35|             'e-mail:' => 'owner.email',
    36|             'created:' => 'domain.created',
    37|             'paid-till:' => 'domain.expires',
    38|                 /*
    39|                   'nserver:' => 'domain.nserver.',
    40|                   'source:' => 'domain.source',
    41|                   'type:' => 'owner.type',
    42|                   'org:' => 'owner.organization',
    43|                   'fax-no:' => 'owner.fax',
    44|                  */
    45|         );
    46|         $r = array();
    47|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
    48|         $r['regyinfo'] = array(
    49|             'referrer' => 'http://www.ripn.net',
    50|             'registrar' => 'RUCENTER-REG-RIPN'
    51|         );
    52|         return $r;
    53|     }
    54| }


# ====================================================================
# FILE: src/whois.tel.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__TEL_HANDLER__'))
    25|     define('__TEL_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class tel_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], array(), 'mdy');
    31|         $r['regyinfo'] = array(
    32|             'referrer' => 'http://www.telnic.org',
    33|             'registrar' => 'Telnic'
    34|         );
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.today.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-41 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @copyright Copyright (c) 2020 Joshua Smith
    20|  */
    21| if (!defined('__TODAY_HANDLER__')) {
    22|     define('__TODAY_HANDLER__', 1);
    23| }
    24| require_once('whois.parser.php');
    25| /**
    26|  * Class today_handler
    27|  */
    28| class today_handler
    29| {
    30|     function parse($data_str, $query)
    31|     {
    32|         $r = [
    33|             'regrinfo' => generic_parser_b($data_str['rawdata']),
    34|             'rawdata'  => $data_str['rawdata'],
    35|         ];
    36|         if (!isset($r['regrinfo']['domain']['name'])) {
    37|             $r['regrinfo']['domain']['name'] = $query;
    38|         }
    39|         return $r;
    40|     }
    41| }


# ====================================================================
# FILE: src/whois.travel.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-35 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__TRAVEL_HANDLER__'))
    25|     define('__TRAVEL_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class travel_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         $r['regyinfo']['referrer'] = 'http://www.nic.travel/';
    32|         $r['regyinfo']['registrar'] = 'Tralliance Corporation';
    33|         return $r;
    34|     }
    35| }


# ====================================================================
# FILE: src/whois.us.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-48 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link      http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__US_HANDLER__')) {
    25|     define('__US_HANDLER__', 1);
    26| }
    27| require_once('whois.parser.php');
    28| class us_handler
    29| {
    30|     /**
    31|      * @param array  $data_str
    32|      * @param string $query
    33|      *
    34|      * @return array
    35|      */
    36|     function parse($data_str, $query)
    37|     {
    38|         $r = [
    39|             'regrinfo' => generic_parser_b($data_str['rawdata'], [], 'ymd'),
    40|             'regyinfo' => [
    41|                 'referrer'  => 'http://www.neustar.us',
    42|                 'registrar' => 'NEUSTAR INC.',
    43|             ],
    44|             'rawdata'  => $data_str['rawdata'],
    45|         ];
    46|         return $r;
    47|     }
    48| }


# ====================================================================
# FILE: src/whois.ve.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-60 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__VE_HANDLER__'))
    25|     define('__VE_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class ve_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'owner' => 'Titular:',
    31|             'domain.name' => 'Nombre de Dominio:',
    32|             'admin' => 'Contacto Administrativo',
    33|             'tech' => 'Contacto Tecnico',
    34|             'billing' => 'Contacto de Cobranza:',
    35|             'domain.created' => 'Fecha de Creacion:',
    36|             'domain.changed' => 'Ultima Actualizacion:',
    37|             'domain.expires' => 'Fecha de Vencimiento:',
    38|             'domain.status' => 'Estatus del dominio:',
    39|             'domain.nserver' => 'Servidor(es) de Nombres de Dominio'
    40|         );
    41|         $r = array();
    42|         $r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
    43|         if (!isset($r['regrinfo']['domain']['created']) || is_array($r['regrinfo']['domain']['created'])) {
    44|             $r['regrinfo'] = array('registered' => 'no');
    45|             return $r;
    46|         }
    47|         $dns = array();
    48|         foreach ($r['regrinfo']['domain']['nserver'] as $nserv) {
    49|             if ($nserv[0] == '-')
    50|                 $dns[] = $nserv;
    51|         }
    52|         $r['regrinfo']['domain']['nserver'] = $dns;
    53|         $r['regrinfo'] = get_contacts($r['regrinfo']);
    54|         $r['regyinfo'] = array(
    55|             'referrer' => 'http://registro.nic.ve',
    56|             'registrar' => 'NIC-Venezuela - CNTI'
    57|         );
    58|         return $r;
    59|     }
    60| }


# ====================================================================
# FILE: src/whois.ws.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-59 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__WS_HANDLER__'))
    25|     define('__WS_HANDLER__', 1);
    26| use phpWhois\WhoisClient;
    27| require_once('whois.parser.php');
    28| class ws_handler extends WhoisClient {
    29|     function parse($data_str, $query) {
    30|         $items = array(
    31|             'Domain Name:' => 'domain.name',
    32|             'Registrant Name:' => 'owner.organization',
    33|             'Registrant Email:' => 'owner.email',
    34|             'Domain Created:' => 'domain.created',
    35|             'Domain Last Updated:' => 'domain.changed',
    36|             'Registrar Name:' => 'domain.sponsor',
    37|             'Current Nameservers:' => 'domain.nserver.',
    38|             'Administrative Contact Email:' => 'admin.email',
    39|             'Administrative Contact Telephone:' => 'admin.phone',
    40|             'Registrar Whois:' => 'rwhois'
    41|         );
    42|         $r = array();
    43|         $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
    44|         $r['regyinfo']['referrer'] = 'http://www.samoanic.ws';
    45|         $r['regyinfo']['registrar'] = 'Samoa Nic';
    46|         if (!empty($r['regrinfo']['domain']['name'])) {
    47|             $r['regrinfo']['registered'] = 'yes';
    48|             if (isset($r['regrinfo']['rwhois'])) {
    49|                 if ($this->deepWhois) {
    50|                     $r['regyinfo']['whois'] = $r['regrinfo']['rwhois'];
    51|                     $r = $this->deepWhois($query, $r);
    52|                 }
    53|                 unset($r['regrinfo']['rwhois']);
    54|             }
    55|         } else
    56|             $r['regrinfo']['registered'] = 'no';
    57|         return $r;
    58|     }
    59| }


# ====================================================================
# FILE: src/whois.xxx.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-37 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__XXX_HANDLER__'))
    25|     define('__XXX_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class xxx_handler {
    28|     function parse($data_str, $query) {
    29|         $r = array();
    30|         $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
    31|         if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
    32|             $r['regrinfo']['registered'] = 'unknown';
    33|         $r['regyinfo']['referrer'] = 'http://www.pir.org/';
    34|         $r['regyinfo']['registrar'] = 'Public Interest Registry';
    35|         return $r;
    36|     }
    37| }


# ====================================================================
# FILE: src/whois.zanet.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-67 ---
     1| <?php
     2| /**
     3|  * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  * 
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  * 
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  * 
    19|  * @link http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (!defined('__ZANET_HANDLER__'))
    25|     define('__ZANET_HANDLER__', 1);
    26| require_once('whois.parser.php');
    27| class zanet_handler {
    28|     function parse($data_str, $query) {
    29|         $items = array(
    30|             'domain.name' => 'Domain Name            : ',
    31|             'domain.created' => 'Record Created         :',
    32|             'domain.changed' => 'Record	Last Updated    :',
    33|             'owner.name' => 'Registered for         :',
    34|             'admin' => 'Administrative Contact :',
    35|             'tech' => 'Technical Contact      :',
    36|             'domain.nserver' => 'Domain Name Servers listed in order:',
    37|             'registered' => 'No such domain: ',
    38|             '' => 'The ZA NiC whois'
    39|         );
    40|         $rawdata = array();
    41|         foreach ($data_str['rawdata'] as $line) {
    42|             if (strpos($line, ' Contact ') !== false) {
    43|                 $pos = strpos($line, ':');
    44|                 if ($pos !== false) {
    45|                     $rawdata[] = substr($line, 0, $pos + 1);
    46|                     $rawdata[] = trim(substr($line, $pos + 1));
    47|                     continue;
    48|                 }
    49|             }
    50|             $rawdata[] = $line;
    51|         }
    52|         $r = array();
    53|         $r['regrinfo'] = get_blocks($rawdata, $items);
    54|         if (isset($r['regrinfo']['registered'])) {
    55|             $r['regrinfo']['registered'] = 'no';
    56|         } else {
    57|             if (isset($r['regrinfo']['admin']))
    58|                 $r['regrinfo']['admin'] = get_contact($r['regrinfo']['admin']);
    59|             if (isset($r['regrinfo']['tech']))
    60|                 $r['regrinfo']['tech'] = get_contact($r['regrinfo']['tech']);
    61|         }
    62|         $r['regyinfo']['referrer'] = 'http://www.za.net/'; // or http://www.za.org
    63|         $r['regyinfo']['registrar'] = 'ZA NiC';
    64|         format_dates($r, 'xmdxxy');
    65|         return $r;
    66|     }
    67| }


# ====================================================================
# FILE: update-fixtures.php
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-55 ---
     1| <?php
     2| /**
     3|  * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
     4|  * @license
     5|  * This program is free software; you can redistribute it and/or
     6|  * modify it under the terms of the GNU General Public License
     7|  * as published by the Free Software Foundation; either version 2
     8|  * of the License, or (at your option) any later version.
     9|  *
    10|  * This program is distributed in the hope that it will be useful,
    11|  * but WITHOUT ANY WARRANTY; without even the implied warranty of
    12|  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    13|  * GNU General Public License for more details.
    14|  *
    15|  * You should have received a copy of the GNU General Public License
    16|  * along with this program; if not, write to the Free Software
    17|  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
    18|  *
    19|  * @link      http://phpwhois.pw
    20|  * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
    21|  * @copyright Maintained by David Saez
    22|  * @copyright Copyright (c) 2014 Dmitry Lukashin
    23|  */
    24| if (file_exists(__DIR__ . '/vendor/autoload.php')) {
    25|     require_once __DIR__ . '/vendor/autoload.php';
    26| }
    27| use phpWhois\Cli\CliHelper;
    28| use phpWhois\Whois;
    29| $fixturePath = 'tests/fixtures/';
    30| $cliHelper = new CliHelper();
    31| $domains   = $cliHelper->loadDomainList('./test.txt');
    32| if (!empty($argv[1]) && isset($domains[$argv[1]])) {
    33|     $domains = [$domains[$argv[1]]];
    34| }
    35| $whois = new Whois();
    36| stream_set_write_buffer(STDIN, 0);
    37| $domainCount = count($domains);
    38| $ndx         = 1;
    39| foreach ($domains as $domain) {
    40|     try {
    41|         echo "[$ndx/$domainCount] Creating fixture for `$domain`\n";
    42|         $result = $whois->whois($domain);
    43|         $safeDomain = makePathSafe($domain);
    44|         file_put_contents("{$fixturePath}/{$safeDomain}.txt", $result);
    45|         $ndx += 1;
    46|     } catch (Exception $exception) {
    47|         echo "  Exception: {$error->getMessage()}\n";
    48|     } catch (Error $error) {
    49|         echo "  Err: {$error->getMessage()}\n";
    50|     }
    51| }
    52| function makePathSafe(string $filename): string
    53| {
    54|     return str_replace(":", '-', $filename);
    55| }

