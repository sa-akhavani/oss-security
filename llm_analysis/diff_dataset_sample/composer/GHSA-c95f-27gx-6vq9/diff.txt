--- a//dev/null
+++ b/example.cli.php
@@ -0,0 +1,28 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+include('src/whois.main.php');
+if (isset($argv[1]))
+	$domain = $argv[1];
+else
+	$domain = 'example.com';
+$whois = new Whois();
+$result = $whois->Lookup($domain);
+print_r($result);
+?>

--- a//dev/null
+++ b/example.php
@@ -0,0 +1,103 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+header('Content-Type: text/html; charset=UTF-8');
+$out =  implode('', file('example.html'));
+$out = str_replace('{self}', $_SERVER['PHP_SELF'], $out);
+$resout = extract_block($out, 'results');
+if (isSet($_GET['query']))
+	{
+	$query = $_GET['query'];
+	if (!empty($_GET['output']))
+		$output = $_GET['output'];
+	else
+		$output = '';
+	include_once('src/whois.main.php');
+	include_once('src/whois.utils.php');
+	$whois = new Whois();
+	$allowproxy = false;
+ 	$whois->deep_whois = empty($_GET['fast']);
+	$whois->non_icann = true;
+	$result = $whois->Lookup($query);
+	$resout = str_replace('{query}', $query, $resout);
+	$winfo = '';
+	switch ($output)
+		{
+		case 'object':
+			if ($whois->Query['status'] < 0)
+				{
+				$winfo = implode($whois->Query['errstr'],"\n<br></br>");
+				}
+			else
+				{
+				$utils = new utils;
+				$winfo = $utils->showObject($result);
+				}
+			break;
+		case 'nice':
+			if (!empty($result['rawdata']))
+				{
+				$utils = new utils;
+				$winfo = $utils->showHTML($result);
+				}
+			else
+				{
+				if (isset($whois->Query['errstr']))
+					$winfo = implode($whois->Query['errstr'],"\n<br></br>");
+				else
+					$winfo = 'Unexpected error';
+				}
+			break;
+		case 'proxy':
+			if ($allowproxy)
+				exit(serialize($result));
+		default:
+			if(!empty($result['rawdata']))
+				{
+				$winfo .= '<pre>'.implode($result['rawdata'],"\n").'</pre>';
+				}
+			else
+				{
+				$winfo = implode($whois->Query['errstr'],"\n<br></br>");
+				}
+		}
+	$resout = str_replace('{result}', $winfo, $resout);
+	}
+else
+	$resout = '';
+$out = str_replace('{ver}',$whois->CODE_VERSION,$out);
+exit(str_replace('{results}', $resout, $out));
+function extract_block (&$plantilla,$mark,$retmark='')
+{
+$start = strpos($plantilla,'<!--'.$mark.'-->');
+$final = strpos($plantilla,'<!--/'.$mark.'-->');
+if ($start === false || $final === false) return;
+$ini = $start+7+strlen($mark);
+$ret=substr($plantilla,$ini,$final-$ini);
+$final+=8+strlen($mark);
+if ($retmark===false)
+	$plantilla=substr($plantilla,0,$start).substr($plantilla,$final);
+else	
+	{
+	if ($retmark=='') $retmark=$mark;
+	$plantilla=substr($plantilla,0,$start).'{'.$retmark.'}'.substr($plantilla,$final);
+	}
+return $ret;
+}
+?>

--- a/example/example.cli.php
+++ b//dev/null
@@ -1,37 +0,0 @@
-<?php
-/**
- * phpWhois console example
- *
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-if (file_exists(__DIR__.'/../vendor/autoload.php')) {
-    require_once __DIR__.'/../vendor/autoload.php';
-}
-use phpWhois\Whois;
-if (!isset($argv[1])) {
-    echo "\nUsage:\n\nphp ".__FILE__." domainname.com\n";
-    exit(1);
-}
-$domain = $argv[1];
-$whois = new Whois();
-$result = $whois->lookup($domain);
-print_r($result);

--- a/example/example.php
+++ b//dev/null
@@ -1,130 +0,0 @@
-<?php
-/**
- * phpWhois Example
- * 
- * This class supposed to be instantiated for using the phpWhois library
- * 
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-header('Content-Type: text/html; charset=UTF-8');
-if (file_exists(__DIR__.'/../vendor/autoload.php')) {
-    require_once __DIR__.'/../vendor/autoload.php';
-}
-use phpWhois\Whois;
-use phpWhois\Utils;
-$whois = new Whois();
-if (isset($_GET['query'])) {
-    $query = $_GET['query'];
-    if (!empty($_GET['output']))
-        $output = $_GET['output'];
-    else
-        $output = '';
-    $allowproxy = false;
-    $whois->deepWhois = empty($_GET['fast']);
-    $result = $whois->lookup($query);
-    $winfo = '';
-    switch ($output) {
-        case 'object':
-            if ($whois->query['status'] < 0) {
-                $winfo = implode($whois->query['errstr'], "\n<br></br>");
-            } else {
-                $utils = new Utils;
-                $winfo = $utils->showObject($result);
-            }
-            break;
-        case 'nice':
-            if (!empty($result['rawdata'])) {
-                $utils = new Utils;
-                $winfo = $utils->showHTML($result);
-            } else {
-                if (isset($whois->query['errstr']))
-                    $winfo = implode($whois->query['errstr'], "\n<br></br>");
-                else
-                    $winfo = 'Unexpected error';
-            }
-            break;
-        case 'proxy':
-            if ($allowproxy)
-                exit(serialize($result));
-        default:
-            if (!empty($result['rawdata'])) {
-                $winfo .= '<pre>' . implode($result['rawdata'], "\n") . '</pre>';
-            } else {
-                $winfo = implode($whois->query['errstr'], "\n<br></br>");
-            }
-    }
-}
-?><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
-            "http://www.w3.org/TR/html4/loose.dtd">
-<html lang="en">
-<head>
-<title>whois.php -base classes to do whois queries with php</title>
-<style type="text/css">
-</style>
-</head>
-<body>
-<center>
-<h1>phpWhois - base class to do whois queries with php</h1>
-<p>
-&copy; 1999 - 2011 <a href="http://www.easydns.com/">easyDNS
-Technologies Inc.</a> &amp; <a href="http://mark.jeftovic.net/">Mark Jeftovic</a><br/>
-Now maintained and hosted by David Saez at <a href="http://www.ols.es">OLS 20000</a><br/>
-Placed under the GPL. See the LICENSE file in the distribution.
-</p>
-<table>
-<tr><td bgcolor="#55aaff">
-<form method="get" action="">
-<table>
-<tr><td colspan="3" align="center">
-<b>Enter any domain name, ip address or AS handle you would like to query whois for</b>
-<br/><br/>
-<input name="query" /> <input type="submit" value="Whois" /><br/>
-</td></tr>
-<tr>
-<td>
-<input type="radio" name="output" value="normal" /> Show me regular output<br/>
-<input type="radio" name="output" value="nice" checked="checked" /> Show me HTMLized output<br/>
-<input type="radio" name="output" value="object" /> Show me the returned PHP object
-</td>
-<td align="left" valign="top">
-<input type="checkbox" name="fast" value="1" /> Fast lookup
-</td>
-<td align="right" valign="bottom">
-<a href="http://www.phpwhois.org" title="phpWhois web page">
-<img border="0" src="whois.icon.png" alt="phpWhois web page" /></a>
-</td>
-</tr>
-</table>
-</form>
-</td></tr>
-</table>
-</center>
-<?php if (!empty($query)):?>
-<?php
-<p><b>Results for <?php echo $query?> :</b></p>
-<blockquote>
-<?php echo $winfo ?>
-</blockquote>
-<!--/results-->
-<?php endif ?>
-</body>
-</html>

--- a/handler.template.php
+++ b/handler.template.php
@@ -1,32 +1,30 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__XX_HANDLER__'))
-    define('__XX_HANDLER__', 1);
+	define('__XX_HANDLER__', 1);
 require_once('whois.parser.php');
-class xx_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        return $r;
-    }
-}
+class xx_handler
+	{
+	function parse($data_str, $query)
+		{
+		return $r;
+		}
+	}
+?>

--- a/poc.php
+++ b//dev/null
@@ -1,5 +0,0 @@
-<?php
-require_once __DIR__ . '/vendor/autoload.php';
-$whois = new phpWhois\Whois;
-$whois->useServer('org', '127.0.0.1:9999');
-print_r($whois->lookup('example.org'));

--- a/src/Cli/CliHelper.php
+++ b//dev/null
@@ -1,42 +0,0 @@
-<?php
-/**
- * @copyright Copyright (c) 2020 Joshua Smith
- * @license   See LICENSE file
- */
-namespace phpWhois\Cli;
-class CliHelper
-{
-    /**
-     * @param string $filename
-     *
-     * @return string[]
-     */
-    public function loadDomainList(string $filename): array
-    {
-        $lines   = file($filename);
-        $domains = [];
-        foreach ($lines as $line) {
-            $pos = strpos($line, '/');
-            if ($pos !== false) {
-                $line = substr($line, 0, $pos);
-            }
-            $line = trim($line);
-            if ($line === '') {
-                continue;
-            }
-            $parts = explode(' ', str_replace("\t", ' ', $line));
-            $key   = $parts[0];
-            for ($i = 1, $count = count($parts); $i < $count; $i++) {
-                if ($parts[$i] !== '') {
-                    if ($key) {
-                        $domains[$key] = $parts[$i];
-                        $key           = false;
-                    } else {
-                        $domains[] = $parts[$i];
-                    }
-                }
-            }
-        }
-        return $domains;
-    }
-}

--- a/src/Handlers/AbstractHandler.php
+++ b//dev/null
@@ -1,71 +0,0 @@
-<?php
-/**
- * @copyright Copyright (c) 2020 Joshua Smith
- * @license   See LICENSE file
- */
-namespace phpWhois\Handlers;
-require_once __DIR__ . '/../whois.parser.php';
-/**
- * AbstractHandler
- */
-abstract class AbstractHandler implements HandlerInterface
-{
-    public $deepWhois;
-    /**
-     * @param string[] $lines
-     *
-     * @return string[]
-     */
-    protected function removeBlankLines(array $lines): array
-    {
-        return array_filter(
-            $lines,
-            static function ($s) {
-                return !empty($s);
-            }
-        );
-    }
-    protected function easy_parser(
-        $data_str,
-        $items,
-        $date_format,
-        $translate = [],
-        $has_org = false,
-        $partial_match = false,
-        $def_block = false
-    ) {
-        return easy_parser(
-            $data_str,
-            $items,
-            $date_format,
-            $translate,
-            $has_org,
-            $partial_match,
-            $def_block
-        );
-    }
-    protected function format_dates(&$res, $format = 'mdy')
-    {
-        return format_dates($res, $format);
-    }
-    protected function generic_parser_b($rawdata, $items = [], $dateformat = 'mdy', $hasreg = true, $scanall = false)
-    {
-        return generic_parser_b($rawdata, $items, $dateformat, $hasreg, $scanall);
-    }
-    protected function get_blocks($rawdata, $items, $partial_match = false, $def_block = false)
-    {
-        return get_blocks($rawdata, $items, $partial_match, $def_block);
-    }
-    protected function get_contacts($array, $extra_items = [], $has_org = false)
-    {
-        return get_contacts($array, $extra_items, $has_org);
-    }
-    protected function get_contact($array, $extra_items = [], $has_org = false)
-    {
-        return get_contact($array, $extra_items, $has_org);
-    }
-    protected function generic_parser_a($rawdata, $translate, $contacts, $main = 'domain', $dateformat = 'dmy')
-    {
-        return generic_parser_a($rawdata, $translate, $contacts, $main, $dateformat);
-    }
-}

--- a/src/Handlers/AeHandler.php
+++ b//dev/null
@@ -1,36 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class AeHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $items = [
-            'Domain Name:'                     => 'domain.name',
-            'Registrar Name:'                  => 'domain.sponsor',
-            'Status:'                          => 'domain.status',
-            'Registrant Contact ID:'           => 'owner.handle',
-            'Registrant Contact Name:'         => 'owner.name',
-            'Registrant Contact Organisation:' => 'owner.organization',
-            'Tech Contact Name:'               => 'tech.name',
-            'Tech Contact ID:'                 => 'tech.handle',
-            'Tech Contact Organisation:'       => 'tech.organization',
-            'Name Server:'                     => 'domain.nserver.',
-        ];
-        $r = [
-            'regrinfo' => $this->generic_parser_b($data_str['rawdata'], $items, 'ymd'),
-            'regyinfo' => [
-                'referrer'  => 'http://www.nic.ae',
-                'registrar' => 'UAENIC',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/AeroHandler.php
+++ b//dev/null
@@ -1,24 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class AeroHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $r = [
-            'regrinfo' => $this->generic_parser_b($data_str['rawdata'], [], 'ymd'),
-            'regyinfo' => [
-                'referrer'  => 'http://www.nic.aero',
-                'registrar' => 'Societe Internationale de Telecommunications Aeronautiques SC',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/AgHandler.php
+++ b//dev/null
@@ -1,24 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class AgHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $r = [
-            'regrinfo' => $this->generic_parser_b($data_str['rawdata']),
-            'regyinfo' => [
-                'referrer'  => 'http://www.nic.ag',
-                'registrar' => 'Nic AG',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/AmHandler.php
+++ b//dev/null
@@ -1,42 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class AmHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $items = [
-            'owner'          => 'Registrant:',
-            'domain.name'    => 'Domain name:',
-            'domain.created' => 'Registered:',
-            'domain.changed' => 'Last modified:',
-            'domain.nserver' => 'DNS servers:',
-            'domain.status'  => 'Status:',
-            'tech'           => 'Technical contact:',
-            'admin'          => 'Administrative contact:',
-        ];
-        $rawData = $this->removeBlankLines($data_str['rawdata']);
-        $r = [
-            'regrinfo' => $this->get_blocks($rawData, $items),
-            'rawdata' => $data_str['rawdata'],
-        ];
-        if (!empty($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo']               = $this->get_contacts($r['regrinfo']);
-            $r['regrinfo']['registered'] = 'yes';
-        } else {
-            $r                           = [];
-            $r['regrinfo']['registered'] = 'no';
-        }
-        $r['regyinfo'] = [
-            'referrer'  => 'http://www.isoc.am',
-            'registrar' => 'ISOCAM',
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/AppHandler.php
+++ b//dev/null
@@ -1,17 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class AppHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $r = [
-            'regrinfo' => $this->generic_parser_b($data_str['rawdata']),
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/AsiaHandler.php
+++ b//dev/null
@@ -1,24 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class AsiaHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $r = [
-            'regrinfo' => $this->generic_parser_b($data_str['rawdata']),
-            'regyinfo' => [
-                'referrer'  => 'http://www.dotasia.org/',
-                'registrar' => 'DotAsia',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/AtHandler.php
+++ b//dev/null
@@ -1,69 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class AtHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $translate = [
-            'fax-no'         => 'fax',
-            'e-mail'         => 'email',
-            'nic-hdl'        => 'handle',
-            'person'         => 'name',
-            'personname'     => 'name',
-            'street address' => 'address.street',
-            'city'           => 'address.city',
-            'postal code'    => 'address.pcode',
-            'country'        => 'address.country',
-        ];
-        $contacts = [
-            'registrant' => 'owner',
-            'admin-c'    => 'admin',
-            'tech-c'     => 'tech',
-            'billing-c'  => 'billing',
-            'zone-c'     => 'zone',
-        ];
-        $reg = $this->generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
-        if (isset($reg['domain']['remarks'])) {
-            unset($reg['domain']['remarks']);
-        }
-        if (isset($reg['domain']['descr'])) {
-            foreach ($reg['domain']['descr'] as $key => $val) {
-                $v = trim(substr(strstr($val, ':'), 1));
-                if (strstr($val, '[organization]:')) {
-                    $reg['owner']['organization'] = $v;
-                    continue;
-                }
-                if (strstr($val, '[phone]:')) {
-                    $reg['owner']['phone'] = $v;
-                    continue;
-                }
-                if (strstr($val, '[fax-no]:')) {
-                    $reg['owner']['fax'] = $v;
-                    continue;
-                }
-                if (strstr($val, '[e-mail]:')) {
-                    $reg['owner']['email'] = $v;
-                    continue;
-                }
-                $reg['owner']['address'][$key] = $v;
-            }
-            unset($reg['domain']['descr']);
-        }
-        $r = [
-            'regrinfo' => $reg,
-            'regyinfo' => [
-                'referrer'  => 'http://www.nic.at',
-                'registrar' => 'NIC-AT',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/AuHandler.php
+++ b//dev/null
@@ -1,39 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class AuHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $items = [
-            'Domain Name:'              => 'domain.name',
-            'Last Modified:'            => 'domain.changed',
-            'Registrar Name:'           => 'domain.sponsor',
-            'Status:'                   => 'domain.status',
-            'Domain ROID:'              => 'domain.handle',
-            'Registrant:'               => 'owner.organization',
-            'Registrant Contact ID:'    => 'owner.handle',
-            'Registrant Contact Email:' => 'owner.email',
-            'Registrant Contact Name:'  => 'owner.name',
-            'Tech Contact Name:'        => 'tech.name',
-            'Tech Contact Email:'       => 'tech.email',
-            'Tech Contact ID:'          => 'tech.handle',
-            'Name Server:'              => 'domain.nserver.',
-        ];
-        $r = [
-            'regrinfo' => $this->generic_parser_b($data_str['rawdata'], $items),
-            'regyinfo' => [
-                'referrer'  => 'http://www.aunic.net',
-                'registrar' => 'AU-NIC',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/BeHandler.php
+++ b//dev/null
@@ -1,52 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class BeHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $items = [
-            'domain.name'    => 'Domain:',
-            'domain.status'  => 'Status:',
-            'domain.nserver' => 'Nameservers:',
-            'domain.created' => 'Registered:',
-            'owner'          => 'Licensee:',
-            'admin'          => 'Onsite Contacts:',
-            'tech'           => 'Registrar Technical Contacts:',
-            'agent'          => 'Registrar:',
-            'agent.uri'      => 'Website:',
-        ];
-        $trans = [
-            'company name2:' => '',
-        ];
-        $rawData = $this->removeBlankLines($data_str['rawdata']);
-        $r       = [
-            'regrinfo' => $this->get_blocks($rawData, $items),
-            'regyinfo' => [
-                'referrer'  => 'http://www.domain-registry.nl',
-                'registrar' => 'DNS Belgium',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        $domainStatus = $r['regrinfo']['domain']['status'] ;
-        if ($domainStatus === 'REGISTERED' || $domainStatus === 'NOT AVAILABLE') {
-            $r['regrinfo']['registered'] = 'yes';
-            $r['regrinfo'] = $this->get_contacts($r['regrinfo'], $trans);
-            if (isset($r['regrinfo']['agent'])) {
-                $sponsor = $this->get_contact($r['regrinfo']['agent'], $trans);
-                unset($r['regrinfo']['agent']);
-                $r['regrinfo']['domain']['sponsor'] = $sponsor;
-            }
-            $r = $this->format_dates($r, '-mdy');
-        } else {
-            $r['regrinfo']['registered'] = 'no';
-        }
-        return $r;
-    }
-}

--- a/src/Handlers/BhHandler.php
+++ b//dev/null
@@ -1,29 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class BhHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $r = [
-            'regrinfo' => $this->generic_parser_b($data_str['rawdata']),
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        if (empty($r['regrinfo']['domain']['created'])) {
-            $r['regrinfo']['registered'] = 'no';
-        } else {
-            $r['regrinfo']['registered'] = 'yes';
-        }
-        $r['regyinfo'] = [
-            'referrer'  => 'http://www.nic.bh/',
-            'registrar' => 'NIC-BH',
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/BizHandler.php
+++ b//dev/null
@@ -1,24 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class BizHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $r = [
-            'regrinfo' => $this->generic_parser_b($data_str['rawdata'], [], 'mdy'),
-            'regyinfo' => [
-                'referrer'  => 'http://www.neulevel.biz',
-                'registrar' => 'NEULEVEL',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/BrHandler.php
+++ b//dev/null
@@ -1,63 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class BrHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $translate = [
-            'fax-no'     => 'fax',
-            'e-mail'     => 'email',
-            'nic-hdl-br' => 'handle',
-            'person'     => 'name',
-            'netname'    => 'name',
-            'domain'     => 'name',
-            'updated'    => '',
-        ];
-        $contacts = [
-            'owner-c'   => 'owner',
-            'tech-c'    => 'tech',
-            'admin-c'   => 'admin',
-            'billing-c' => 'billing',
-        ];
-        $r = $this->generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
-        if (in_array('Permission denied.', $r['disclaimer'])) {
-            $r['registered'] = 'unknown';
-            return $r;
-        }
-        if (isset($r['domain']['nsstat'])) {
-            unset($r['domain']['nsstat']);
-        }
-        if (isset($r['domain']['nslastaa'])) {
-            unset($r['domain']['nslastaa']);
-        }
-        if (isset($r['domain']['owner'])) {
-            $r['owner']['organization'] = $r['domain']['owner'];
-            unset($r['domain']['owner']);
-        }
-        if (isset($r['domain']['responsible'])) {
-            unset($r['domain']['responsible']);
-        }
-        if (isset($r['domain']['address'])) {
-            unset($r['domain']['address']);
-        }
-        if (isset($r['domain']['phone'])) {
-            unset($r['domain']['phone']);
-        }
-        $a = [
-            'regrinfo' => $r,
-            'regyinfo' => [
-                'registrar' => 'BR-NIC',
-                'referrer'  => 'http://www.nic.br',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $a;
-    }
-}

--- a/src/Handlers/ClHandler.php
+++ b//dev/null
@@ -1,40 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class ClHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $items = [
-            'admin'          => '(Administrative Contact)',
-            'tech'           => 'Contacto Técnico (Technical Contact):',
-            'domain.nserver' => 'Name server:',
-            'domain.changed' => '(Database last updated on):',
-            'domain.created' => 'Creation date:',
-            'domain.expires' => 'Expiration date:',
-        ];
-        $trans = [
-            'organización:' => 'organization',
-            'nombre      :' => 'name',
-        ];
-        $rawData = $this->removeBlankLines($data_str['rawdata']);
-        $r       = [
-            'rawdata'  => $data_str['rawdata'],
-            'regrinfo' => $this->easy_parser($rawData, $items, 'd-m-y', $trans),
-        ];
-        if (!isset($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo']['domain']['name'] = $query;
-        }
-        $r['regyinfo'] = [
-            'referrer'  => 'http://www.nic.cl',
-            'registrar' => 'NIC Chile',
-        ];
-        return $r;
-    }
-}

--- a/src/Handlers/DeHandler.php
+++ b//dev/null
@@ -1,53 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class DeHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $items = [
-            'domain.name'      => 'Domain:',
-            'domain.nserver.'  => 'Nserver:',
-            'domain.nserver.#' => 'Nsentry:',
-            'domain.status'    => 'Status:',
-            'domain.changed'   => 'Changed:',
-            'domain.desc.'     => 'Descr:',
-            'owner'            => '[Holder]',
-            'admin'            => '[Admin-C]',
-            'tech'             => '[Tech-C]',
-            'zone'             => '[Zone-C]',
-        ];
-        $extra = [
-            'city:'        => 'address.city',
-            'postalcode:'  => 'address.pcode',
-            'countrycode:' => 'address.country',
-            'remarks:'     => '',
-            'sip:'         => 'sip',
-            'type:'        => '',
-        ];
-        $rawData = $this->removeBlankLines($data_str['rawdata']);
-        $r       = [
-            'rawdata'  => $data_str['rawdata'],
-            'regrinfo' => $this->easy_parser($rawData, $items, 'ymd', $extra),
-            'regyinfo' => [
-                'registrar' => 'DENIC eG',
-                'referrer'  => 'http://www.denic.de/',
-            ],
-        ];
-        if (!isset($r['regrinfo']['domain']['status']) || $r['regrinfo']['domain']['status'] === 'free') {
-            $r['regrinfo']['registered'] = 'no';
-        } else {
-            if (isset($r['regrinfo']['domain']['changed'])) {
-                $r['regrinfo']['domain']['changed'] = substr($r['regrinfo']['domain']['changed'], 0, 10);
-            }
-            $r['regrinfo']['registered'] = 'yes';
-        }
-        return $r;
-    }
-}

--- a/src/Handlers/EduHandler.php
+++ b//dev/null
@@ -1,43 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class EduHandler extends AbstractHandler
-{
-    public function parse(array $data_str, string $query): array
-    {
-        $items = [
-            'domain.name'    => 'Domain name:',
-            'domain.sponsor' => 'Registrar:',
-            'domain.nserver' => 'Name Servers:',
-            'domain.changed' => 'Domain record last updated:',
-            'domain.created' => 'Domain record activated:',
-            'domain.expires' => 'Domain expires:',
-            'owner'          => 'Registrant:',
-            'admin'          => 'Administrative Contact:',
-            'tech'           => 'Technical Contact:',
-            'billing'        => 'Billing Contact:',
-        ];
-        $rawData = $this->removeBlankLines($data_str['rawdata']);
-        $r = [
-            'rawdata'  => $data_str['rawdata'],
-            'regrinfo' => $this->easy_parser($rawData, $items, 'dmy'),
-        ];
-        if (isset($b['tech'])) {
-            if ($r['regrinfo']['tech']['name'] === 'Same as above') {
-                $r['regrinfo']['tech'] = $r['regrinfo']['admin'];
-            }
-        }
-        if (!isset($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo']['domain']['name'] = $query;
-        }
-        $r['regyinfo']['referrer']  = 'http://whois.educause.net';
-        $r['regyinfo']['registrar'] = 'EDUCASE';
-        return $r;
-    }
-}

--- a/src/Handlers/HandlerInterface.php
+++ b//dev/null
@@ -1,19 +0,0 @@
-<?php
-/**
- * @copyright Copyright (c) 2020 Joshua Smith
- * @license   See LICENSE file
- */
-namespace phpWhois\Handlers;
-/**
- * HandlerInterface
- */
-interface HandlerInterface
-{
-    /**
-     * @param array $data_str
-     * @param string $query
-     *
-     * @return array
-     */
-    public function parse(array $data_str, string $query): array;
-}

--- a/src/Handlers/UkHandler.php
+++ b//dev/null
@@ -1,60 +0,0 @@
-<?php
-/**
- * @license   See LICENSE file
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-namespace phpWhois\Handlers;
-class UkHandler extends AbstractHandler
-{
-    const ITEMS = [
-        'owner.organization' => 'Registrant:',
-        'owner.address'      => "Registrant's address:",
-        'owner.type'         => 'Registrant type:',
-        'domain.created'     => 'Registered on:',
-        'domain.changed'     => 'Last updated:',
-        'domain.expires'     => 'Expiry date:',
-        'domain.nserver'     => 'Name servers:',
-        'domain.sponsor'     => 'Registrar:',
-        'domain.status'      => 'Registration status:',
-        'domain.dnssec'      => 'DNSSEC:',
-        ''                   => 'WHOIS lookup made at',
-        'disclaimer'         => '--',
-    ];
-    /**
-     * @param array  $data_str
-     * @param string $query
-     *
-     * @return array
-     */
-    public function parse(array $data_str, string $query): array
-    {
-        $rawData = $this->removeBlankLines($data_str['rawdata']);
-        $r       = [
-            'regrinfo' => $this->get_blocks($rawData, static::ITEMS),
-        ];
-        if (isset($r['regrinfo']['owner'])) {
-            $r['regrinfo']['owner']['organization'] = $r['regrinfo']['owner']['organization'][0];
-            $r['regrinfo']['domain']['sponsor']     = $r['regrinfo']['domain']['sponsor'][0];
-            $r['regrinfo']['registered']            = 'yes';
-        } else {
-            if (strpos($data_str['rawdata'][1], 'Error for ')) {
-                $r['regrinfo']['registered']       = 'yes';
-                $r['regrinfo']['domain']['status'] = 'invalid';
-            } else {
-                $r['regrinfo']['registered'] = 'no';
-            }
-        }
-        $r = $this->format_dates($r, 'dmy');
-        $r['regyinfo'] = [
-            'referrer'  => 'http://www.nominet.org.uk',
-            'registrar' => 'Nominet UK',
-        ];
-        if (!array_key_exists('rawdata', $r) && array_key_exists('rawdata', $data_str)) {
-            $r['rawdata'] = $data_str['rawdata'];
-        }
-        return $r;
-    }
-}

--- a/src/IpTools.php
+++ b//dev/null
@@ -1,155 +0,0 @@
-<?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-namespace phpWhois;
-/**
- * Utilities for parsing ip addresses
- */
-class IpTools
-{
-    /**
-     * Check if ip address is valid
-     *
-     * @param string $ip IP address for validation
-     * @param string $type Type of ip address. Possible value are: any, ipv4, ipv6
-     * @param boolean $strict If true - fail validation on reserved and private ip ranges
-     *
-     * @return boolean True if ip is valid. False otherwise
-     */
-    public function validIp($ip, $type = 'any', $strict = true)
-    {
-        switch ($type) {
-            case 'any':
-                return $this->validIpv4($ip, $strict) || $this->validIpv6($ip, $strict);
-                break;
-            case 'ipv4':
-                return $this->validIpv4($ip, $strict);
-                break;
-            case 'ipv6':
-                return $this->validIpv6($ip, $strict);
-                break;
-        }
-        return false;
-    }
-    /**
-     * Check if given IP is valid ipv4 address and doesn't belong to private and
-     * reserved ranges
-     *
-     * @param string $ip Ip address
-     * @param boolean $strict If true - fail validation on reserved and private ip ranges
-     *
-     * @return boolean
-     */
-    public function validIpv4($ip, $strict = true)
-    {
-        $flags = FILTER_FLAG_IPV4;
-        if ($strict) {
-            $flags = FILTER_FLAG_IPV4 | FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE;
-        }
-        if (filter_var($ip, FILTER_VALIDATE_IP, array('flags' => $flags)) !== false) {
-            return true;
-        }
-        return false;
-    }
-    /**
-     * Check if given IP is valid ipv6 address and doesn't belong to private ranges
-     *
-     * @param string $ip Ip address
-     * @param boolean $strict If true - fail validation on reserved and private ip ranges
-     *
-     * @return boolean
-     */
-    public function validIpv6($ip, $strict = true)
-    {
-        $flags = FILTER_FLAG_IPV6;
-        if ($strict) {
-            $flags = FILTER_FLAG_IPV6 | FILTER_FLAG_NO_PRIV_RANGE;
-        }
-        if (filter_var($ip, FILTER_VALIDATE_IP, array('flags' => $flags)) !== false) {
-            return true;
-        }
-        return false;
-    }
-    /**
-     * Try to get real IP from client web request
-     *
-     * @return string
-     */
-    public function getClientIp()
-    {
-        if (!empty($_SERVER['HTTP_CLIENT_IP']) && $this->validIp($_SERVER['HTTP_CLIENT_IP'])) {
-            return $_SERVER['HTTP_CLIENT_IP'];
-        }
-        if (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) {
-            foreach (explode(',', $_SERVER['HTTP_X_FORWARDED_FOR']) as $ip) {
-                if ($this->validIp(trim($ip))) {
-                    return trim($ip);
-                }
-            }
-        }
-        if (!empty($_SERVER['HTTP_X_FORWARDED']) && $this->validIp($_SERVER['HTTP_X_FORWARDED'])) {
-            return $_SERVER['HTTP_X_FORWARDED'];
-        }
-        if (!empty($_SERVER['HTTP_FORWARDED_FOR']) && $this->validIp($_SERVER['HTTP_FORWARDED_FOR'])) {
-            return $_SERVER['HTTP_FORWARDED_FOR'];
-        }
-        if (!empty($_SERVER['HTTP_FORWARDED']) && $this->validIp($_SERVER['HTTP_FORWARDED'])) {
-            return $_SERVER['HTTP_FORWARDED'];
-        }
-        return $_SERVER['REMOTE_ADDR'];
-    }
-    /**
-     * Convert CIDR to net range
-     *
-     * @TODO provide example
-     *
-     * @param string $net
-     * @return string
-     */
-    public function cidrConv($net)
-    {
-        $start = strtok($net, '/');
-        $n = 3 - substr_count($net, '.');
-        if ($n > 0) {
-            for ($i = $n; $i > 0; $i--) {
-                $start .= '.0';
-            }
-        }
-        $bits1 = str_pad(decbin(ip2long($start)), 32, '0', 'STR_PAD_LEFT');
-        $net = pow(2, (32 - substr(strstr($net, '/'), 1))) - 1;
-        $bits2 = str_pad(decbin($net), 32, '0', 'STR_PAD_LEFT');
-        $final = '';
-        for ($i = 0; $i < 32; $i++) {
-            if ($bits1[$i] == $bits2[$i]) {
-                $final .= $bits1[$i];
-            }
-            if ($bits1[$i] == 1 and $bits2[$i] == 0) {
-                $final .= $bits1[$i];
-            }
-            if ($bits1[$i] == 0 and $bits2[$i] == 1) {
-                $final .= $bits2[$i];
-            }
-        }
-        return $start . " - " . long2ip(bindec($final));
-    }
-}

--- a/src/Utils.php
+++ b//dev/null
@@ -1,135 +0,0 @@
-<?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-namespace phpWhois;
-/**
- * Additional utils
- */
-class Utils extends Whois
-{
-    /**
-     * Wrap result in <pre></pre> tags
-     * @param $obj
-     * @return string
-     */
-    public function showObject(&$obj)
-    {
-        $r = $this->debugObject($obj);
-        return "<pre>$r</pre>\n";
-    }
-    /**
-     * Return object or array as formatted string
-     * @param $obj
-     * @param int $indent
-     * @return string
-     */
-    public function debugObject($obj, $indent = 0)
-    {
-        if (is_array($obj)) {
-            $return = '';
-            foreach ($obj as $k => $v) {
-                $return .= str_repeat('&nbsp;', $indent);
-                if (is_array($v)) {
-                    $return .= $k . "->Array\n";
-                    $return .= $this->debugObject($v, $indent + 1);
-                } else {
-                    $return .= $k . "->$v\n";
-                }
-            }
-            return $return;
-        }
-    }
-    public function nsRrDefined($query)
-    {
-        return checkdnsrr($query, 'NS');
-    }
-    /**
-     * Get nice HTML output
-     */
-    public function showHTML($result, $link_myself = true, $params = 'query=$0&amp;output=nice')
-    {
-        $email_regex = "/([-_\w\.]+)(@)([-_\w\.]+)\b/i";
-        $html_regex = "/(?:^|\b)((((http|https|ftp):\/\/)|(www\.))([\w\.]+)([,:%#&\/?~=\w+\.-]+))(?:\b|$)/is";
-        $ip_regex = "/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/i";
-        $out = '';
-        $lempty = true;
-        foreach ($result['rawdata'] as $line) {
-            $line = trim($line);
-            if ($line == '') {
-                if ($lempty) {
-                    continue;
-                } else {
-                    $lempty = true;
-                }
-            } else {
-                $lempty = false;
-            }
-            $out .= $line . "\n";
-        }
-        if ($lempty) {
-            $out = trim($out);
-        }
-        $out = strip_tags($out);
-        $out = preg_replace($email_regex, '<a href="mailto:$0">$0</a>', $out);
-        $out = preg_replace_callback(
-            $html_regex,
-            function ($matches) {
-                if (substr($matches[0], 0, 4) == 'www.') {
-                    $web = $matches[0];
-                    $url = 'http://' . $web;
-                } else {
-                    $web = $matches[0];
-                    $url = $web;
-                }
-                return '<a href="' . $url . '" target="_blank">' . $web . '</a>';
-            },
-            $out
-        );
-        if ($link_myself) {
-            if ($params[0] == '/') {
-                $link = $params;
-            } else {
-                $link = $_SERVER['PHP_SELF'] . '?' . $params;
-            }
-            $out = preg_replace($ip_regex, '<a href="' . $link . '">$0</a>', $out);
-            if (isset($result['regrinfo']['domain']['nserver'])) {
-                $nserver = $result['regrinfo']['domain']['nserver'];
-            } else {
-                $nserver = false;
-            }
-            if (isset($result['regrinfo']['network']['nserver'])) {
-                $nserver = $result['regrinfo']['network']['nserver'];
-            }
-            if (is_array($nserver)) {
-                foreach ($nserver as $host => $ip) {
-                    $url = '<a href="' . str_replace('$0', $ip, $link) . "\">$host</a>";
-                    $out = str_replace($host, $url, $out);
-                    $out = str_replace(strtoupper($host), $url, $out);
-                }
-            }
-        }
-        $out = preg_replace("/(?m)^([-\s\.&;'\w\t\(\)\/]+:\s*)/", '<b>$1</b>', $out);
-        $out = preg_replace("/(?m)^(%.*)/", '<i>$0</i>', $out);
-        return str_replace("\n", "<br/>\n", $out);
-    }
-}

--- a/src/Whois.php
+++ b//dev/null
@@ -1,283 +0,0 @@
-<?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-namespace phpWhois;
-use Algo26\IdnaConvert\IdnaConvert;
-/**
- * phpWhois main class
- *
- * This class supposed to be instantiated for using the phpWhois library
- */
-class Whois extends WhoisClient
-{
-    /** @var boolean Deep whois? */
-    public $deepWhois = true;
-    /** @inheritdoc */
-    public $gtldRecurse = true;
-    /** @var array Query array */
-    public $query = array();
-    /** @var string Network Solutions registry server */
-    public $nsiRegistry = 'whois.nsiregistry.net';
-    const QTYPE_UNKNOWN = 0;
-    const QTYPE_DOMAIN  = 1;
-    const QTYPE_IPV4    = 2;
-    const QTYPE_IPV6    = 3;
-    const QTYPE_AS      = 4;
-    /**
-     * Use special whois server (Populate WHOIS_SPECIAL array)
-     *
-     * @param string $tld Top-level domain
-     * @param string $server Server address
-     */
-    public function useServer($tld, $server)
-    {
-        $this->WHOIS_SPECIAL[$tld] = $server;
-    }
-    /**
-     *  Lookup query and return raw whois data
-     *
-     * @param string $query Domain name or other entity
-     * @param boolean $is_utf True if domain name encoding is utf-8 already, otherwise convert it with utf8_encode() first
-     *
-     */
-    public function whois($domain, $is_utf = true)
-    {
-        $lookup = $this->lookup($domain, $is_utf);
-        return implode(PHP_EOL, $lookup['rawdata']);
-    }
-    /**
-     *  Lookup query
-     *
-     * @param string $query Domain name or other entity
-     * @param boolean $is_utf True if domain name encoding is utf-8 already, otherwise convert it with utf8_encode() first
-     *
-     */
-    public function lookup($query = '', $is_utf = true)
-    {
-        $this->query = array('status' => '');
-        $query = trim($query);
-        $idn = new IdnaConvert();
-        if ($is_utf) {
-            $query = $idn->encode($query);
-        } else {
-            $query = $idn->encode(utf8_encode($query));
-        }
-        if (!isset($query) || $query == '') {
-            $this->query['server'] = $this->nsiRegistry;
-            return;
-        }
-        $this->query['query'] = $domain = $query = strtolower($query);
-        $qType = $this->getQueryType($query);
-        switch ($qType) {
-            case self::QTYPE_IPV4:
-                $ip = @gethostbyname($query);
-                if (isset($this->WHOIS_SPECIAL['ip'])) {
-                    $this->query['server'] = $this->WHOIS_SPECIAL['ip'];
-                    $this->query['args'] = $ip;
-                } else {
-                    $this->query['server'] = 'whois.arin.net';
-                    $this->query['args'] = "n $ip";
-                    $this->query['file'] = 'whois.ip.php';
-                    $this->query['handler'] = 'ip';
-                }
-                $this->query['host_ip'] = $ip;
-                $this->query['query'] = $ip;
-                $this->query['tld'] = 'ip';
-                $this->query['host_name'] = @gethostbyaddr($ip);
-                return $this->getData('', $this->deepWhois);
-                break;
-            case self::QTYPE_IPV6:
-                $ip = @gethostbyname($query);
-                if (isset($this->WHOIS_SPECIAL['ip'])) {
-                    $this->query['server'] = $this->WHOIS_SPECIAL['ip'];
-                } else {
-                    $this->query['server'] = 'whois.ripe.net';
-                    $this->query['file'] = 'whois.ip.ripe.php';
-                    $this->query['handler'] = 'ripe';
-                }
-                $this->query['query'] = $ip;
-                $this->query['tld'] = 'ip';
-                return $this->getData('', $this->deepWhois);
-                break;
-            case self::QTYPE_AS:
-                $ip = @gethostbyname($query);
-                $this->query['server'] = 'whois.arin.net';
-                if (strtolower(substr($ip, 0, 2)) == 'as') {
-                    $as = substr($ip, 2);
-                } else {
-                    $as = $ip;
-                }
-                $this->query['args'] = "a $as";
-                $this->query['file'] = 'whois.ip.php';
-                $this->query['handler'] = 'ip';
-                $this->query['query'] = $ip;
-                $this->query['tld'] = 'as';
-                return $this->getData('', $this->deepWhois);
-                break;
-        }
-        $tld = '';
-        $server = '';
-        $dp = explode('.', $domain);
-        $np = count($dp) - 1;
-        $tldtests = array();
-        for ($i = 0; $i < $np; $i++) {
-            array_shift($dp);
-            $tldtests[] = implode('.', $dp);
-        }
-        $special_tlds = $this->WHOIS_SPECIAL;
-        foreach ($tldtests as $tld) {
-            if (isset($special_tlds[$tld])) {
-                $val = $special_tlds[$tld];
-                if ($val == '') {
-                    return $this->unknown();
-                }
-                $domain = substr($query, 0, -strlen($tld) - 1);
-                $val = str_replace('{domain}', $domain, $val);
-                $server = str_replace('{tld}', $tld, $val);
-                break;
-            }
-        }
-        if ($server == '') {
-            foreach ($tldtests as $tld) {
-                $cname = $tld . '.whois-servers.net';
-                if (gethostbyname($cname) == $cname) {
-                    continue;
-                }
-                $server = $tld . '.whois-servers.net';
-                break;
-            }
-        }
-        if ($tld && $server) {
-            $this->query['server'] = $server;
-            $this->query['tld'] = $tld;
-            $handler = '';
-            foreach ($tldtests as $htld) {
-                if (isset($this->DATA[$htld])) {
-                    $handler = $this->DATA[$htld];
-                    break;
-                }
-                if (file_exists(__DIR__ . '/whois.' . $htld . '.php')) {
-                    $handler = $htld;
-                    break;
-                }
-            }
-            if ($handler != '') {
-                $this->query['file'] = "whois.$handler.php";
-                $this->query['handler'] = $handler;
-            }
-            if (isset($this->WHOIS_PARAM[$server])) {
-                $param = $this->WHOIS_PARAM[$server];
-                $param = str_replace('$domain', $domain, $param);
-                $param = str_replace('$tld', $tld, $param);
-                $this->query['server'] = $this->query['server'] . '?' . $param;
-            }
-            $result = $this->getData('', $this->deepWhois);
-            $this->checkDns($result);
-            return $result;
-        }
-        return $this->unknown();
-    }
-    /**
-     * Unsupported domains
-     */
-    public function unknown()
-    {
-        unset($this->query['server']);
-        $this->query['status'] = 'error';
-        $result = array('rawdata' => array());
-        $result['rawdata'][] = $this->query['errstr'][] = $this->query['query'] . ' domain is not supported';
-        $this->checkDns($result);
-        $this->fixResult($result, $this->query['query']);
-        return $result;
-    }
-    /**
-     * Get nameservers if missing
-     */
-    public function checkDns(&$result)
-    {
-        if ($this->deepWhois && empty($result['regrinfo']['domain']['nserver'])) {
-            $ns = @dns_get_record($this->query['query'], DNS_NS);
-            if (!is_array($ns)) {
-                return;
-            }
-            $nserver = array();
-            foreach ($ns as $row) {
-                $nserver[] = $row['target'];
-            }
-            if (count($nserver) > 0) {
-                $result['regrinfo']['domain']['nserver'] = $this->fixNameServer($nserver);
-            }
-        }
-    }
-    /**
-     *  Fix and/or add name server information
-     */
-    public function fixResult(&$result, $domain)
-    {
-        $result['regrinfo']['domain']['name'] = $domain;
-        if (!isset($result['regrinfo']['registered'])) {
-            if (function_exists('checkdnsrr') && checkdnsrr($domain, 'NS')) {
-                $result['regrinfo']['registered'] = 'yes';
-            } else {
-                $result['regrinfo']['registered'] = 'unknown';
-            }
-        }
-        if (isset($result['regrinfo']['domain']['nserver'])) {
-            if (!is_array($result['regrinfo']['domain']['nserver'])) {
-                unset($result['regrinfo']['domain']['nserver']);
-            } else {
-                $result['regrinfo']['domain']['nserver'] = $this->fixNameServer($result['regrinfo']['domain']['nserver']);
-            }
-        }
-    }
-    /**
-     * Guess query type
-     *
-     * @param string $query
-     *
-     * @return int Query type
-     */
-    public function getQueryType($query)
-    {
-        $ipTools = new IpTools;
-        if ($ipTools->validIp($query, 'ipv4', false)) {
-            if ($ipTools->validIp($query, 'ipv4')) {
-                return self::QTYPE_IPV4;
-            } else {
-                return self::QTYPE_UNKNOWN;
-            }
-        } elseif ($ipTools->validIp($query, 'ipv6', false)) {
-            if ($ipTools->validIp($query, 'ipv6')) {
-                return self::QTYPE_IPV6;
-            } else {
-                return self::QTYPE_UNKNOWN;
-            }
-        } elseif (!empty($query) && strpos($query, '.') !== false) {
-            return self::QTYPE_DOMAIN;
-        } elseif (!empty($query) && strpos($query, '.') === false) {
-            return self::QTYPE_AS;
-        } else {
-            return self::QTYPE_UNKNOWN;
-        }
-    }
-}

--- a/src/WhoisClient.php
+++ b//dev/null
@@ -1,536 +0,0 @@
-<?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-namespace phpWhois;
-use phpWhois\IpTools;
-/**
- * phpWhois basic class
- *
- * This is the basic client class
- */
-class WhoisClient
-{
-    /** @var boolean Is recursion allowed? */
-    public $gtldRecurse = false;
-    /** @var int Default WHOIS port */
-    public $port = 43;
-    /** @var int Maximum number of retries on connection failure */
-    public $retry = 0;
-    /** @var int Time to wait between retries */
-    public $sleep = 2;
-    /** @var int Read buffer size (0 == char by char) */
-    public $buffer = 1024;
-    /** @var int Communications timeout */
-    public $stimeout = 10;
-    /** @var string[] List of servers and handlers (loaded from servers.whois) */
-    public $DATA = array();
-    /** @var string[] Non UTF-8 servers */
-    public $NON_UTF8 = array();
-    /** @var string[] List of Whois servers with special parameters */
-    public $WHOIS_PARAM = array();
-    /** @var string[] TLD's that have special whois servers or that can only be reached via HTTP */
-    public $WHOIS_SPECIAL = array();
-    /** @var string[] Handled gTLD whois servers */
-    public $WHOIS_GTLD_HANDLER = array();
-    /** @var string[] Array to contain all query publiciables */
-    public $query = array(
-        'tld' => '',
-        'type' => 'domain',
-        'query' => '',
-        'status',
-        'server'
-    );
-    /** @var string Current release of the package */
-    public $codeVersion = null;
-    /** @var string Full code and data version string (e.g. 'Whois2.php v3.01:16') */
-    public $version;
-    /**
-     * Constructor function
-     */
-    public function __construct()
-    {
-        $servers = require('whois.servers.php');
-        $this->DATA               = $servers['DATA'];
-        $this->NON_UTF8           = $servers['NON_UTF8'];
-        $this->WHOIS_PARAM        = $servers['WHOIS_PARAM'];
-        $this->WHOIS_SPECIAL      = $servers['WHOIS_SPECIAL'];
-        $this->WHOIS_GTLD_HANDLER = $servers['WHOIS_GTLD_HANDLER'];
-        $this->codeVersion = file_get_contents(__DIR__ . '/../VERSION');
-        $this->version = sprintf("phpWhois v%s", $this->codeVersion);
-    }
-    /**
-     * Perform lookup
-     *
-     * @return array Raw response as array separated by "\n"
-     */
-    public function getRawData($query)
-    {
-        $this->query['query'] = $query;
-        if (isset($this->query['errstr'])) {
-            unset($this->query['errstr']);
-        }
-        if (!isset($this->query['server'])) {
-            $this->query['status'] = 'error';
-            $this->query['errstr'][] = 'No server specified';
-            return (array());
-        }
-        if (substr($this->query['server'], 0, 7) == 'http://' ||
-            substr($this->query['server'], 0, 8) == 'https://'
-        ) {
-            $output = $this->httpQuery($this->query['server']);
-            if (!$output) {
-                $this->query['status'] = 'error';
-                $this->query['errstr'][] = 'Connect failed to: ' . $this->query['server'];
-                return (array());
-            }
-            $this->query['args'] = substr(strchr($this->query['server'], '?'), 1);
-            $this->query['server'] = strtok($this->query['server'], '?');
-            if (substr($this->query['server'], 0, 7) == 'http://') {
-                $this->query['server_port'] = 80;
-            } else {
-                $this->query['server_port'] = 443;
-            }
-        } else {
-            if (strpos($this->query['server'], '?')) {
-                $parts = explode('?', $this->query['server']);
-                $this->query['server'] = trim($parts[0]);
-                $query_args = trim($parts[1]);
-                $query_args = str_replace('{query}', $query, $query_args);
-                $query_args = str_replace('{version}', 'phpWhois' . $this->codeVersion, $query_args);
-                $iptools = new IpTools;
-                if (strpos($query_args, '{ip}') !== false) {
-                    $query_args = str_replace('{ip}', $iptools->getClientIp(), $query_args);
-                }
-                if (strpos($query_args, '{hname}') !== false) {
-                    $query_args = str_replace('{hname}', gethostbyaddr($iptools->getClientIp()), $query_args);
-                }
-            } else {
-                if (empty($this->query['args'])) {
-                    $query_args = $query;
-                } else {
-                    $query_args = $this->query['args'];
-                }
-            }
-            $this->query['args'] = $query_args;
-            if (substr($this->query['server'], 0, 9) == 'rwhois://') {
-                $this->query['server'] = substr($this->query['server'], 9);
-            }
-            if (substr($this->query['server'], 0, 8) == 'whois://') {
-                $this->query['server'] = substr($this->query['server'], 8);
-            }
-            if (strpos($this->query['server'], ':')) {
-                $parts = explode(':', $this->query['server']);
-                $this->query['server'] = trim($parts[0]);
-                $this->query['server_port'] = trim($parts[1]);
-            } else {
-                $this->query['server_port'] = $this->port;
-            }
-            $ptr = $this->connect();
-            if ($ptr === false) {
-                $this->query['status'] = 'error';
-                $this->query['errstr'][] = 'Connect failed to: ' . $this->query['server'];
-                return array();
-            }
-            stream_set_timeout($ptr, $this->stimeout);
-            stream_set_blocking($ptr, 0);
-            fputs($ptr, trim($query_args) . "\r\n");
-            $raw = '';
-            $start = time();
-            $null = null;
-            $r = array($ptr);
-            while (!feof($ptr)) {
-                if (!empty($r)) {
-                    if (stream_select($r, $null, $null, $this->stimeout)) {
-                        $raw .= fgets($ptr, $this->buffer);
-                    }
-                }
-                if (time() - $start > $this->stimeout) {
-                    $this->query['status'] = 'error';
-                    $this->query['errstr'][] = 'Timeout reading from ' . $this->query['server'];
-                    return array();
-                }
-            }
-            if (array_key_exists($this->query['server'], $this->NON_UTF8)) {
-                $raw = utf8_encode($raw);
-            }
-            $output = explode("\n", $raw);
-            if (empty($output[count($output) - 1])) {
-                unset($output[count($output) - 1]);
-            }
-        }
-        return $output;
-    }
-    /**
-     * Perform lookup
-     *
-     * @return array The *rawdata* element contains an
-     * array of lines gathered from the whois query. If a top level domain
-     * handler class was found for the domain, other elements will have been
-     * populated too.
-     */
-    public function getData($query = '', $deep_whois = true)
-    {
-        $query = !empty($query) ? $query : $this->query['query'];
-        $output = $this->getRawData($query);
-        $result = array('rawdata' => $output);
-        $result = $this->setWhoisInfo($result);
-        if (empty($output)) {
-            return $result;
-        }
-        if (isset($this->query['handler'])) {
-            $servers = $result['regyinfo']['servers'];
-            unset($result['regyinfo']['servers']);
-            $result = $this->process($result, $deep_whois);
-            if (isset($result['regyinfo']['servers'])) {
-                $result['regyinfo']['servers'] = array_merge($servers, $result['regyinfo']['servers']);
-            } else {
-                $result['regyinfo']['servers'] = $servers;
-            }
-            if (!isset($result['rawdata'])) {
-                $result['rawdata'] = $output;
-            }
-        }
-        if (!isset($result['regyinfo']['type'])) {
-            $result['regyinfo']['type'] = 'domain';
-        }
-        if (isset($this->query['errstr'])) {
-            $result['errstr'] = $this->query['errstr'];
-        }
-        if (method_exists($this, 'fixResult') && $this->query['tld'] != 'ip') {
-            $this->fixResult($result, $query);
-        }
-        return ($result);
-    }
-    /**
-     * Adds whois server query information to result
-     *
-     * @param $result array Result array
-     * @return array Original result array with server query information
-     */
-    public function setWhoisInfo($result)
-    {
-        $info = array(
-            'server' => $this->query['server'],
-        );
-        if (!empty($this->query['args'])) {
-            $info['args'] = $this->query['args'];
-        } else {
-            $info['args'] = $this->query['query'];
-        }
-        if (!empty($this->query['server_port'])) {
-            $info['port'] = $this->query['server_port'];
-        } else {
-            $info['port'] = 43;
-        }
-        if (isset($result['regyinfo']['whois'])) {
-            unset($result['regyinfo']['whois']);
-        }
-        if (isset($result['regyinfo']['rwhois'])) {
-            unset($result['regyinfo']['rwhois']);
-        }
-        $result['regyinfo']['servers'][] = $info;
-        return $result;
-    }
-    /**
-     * Convert html output to plain text
-     *
-     * @return array Rawdata
-     */
-    public function httpQuery()
-    {
-        $lines = @file($this->query['server']);
-        if (!$lines) {
-            return false;
-        }
-        $output = '';
-        $pre = '';
-        foreach ($lines as $val) {
-            $val = trim($val);
-            $pos = strpos(strtoupper($val), '<PRE>');
-            if ($pos !== false) {
-                $pre = "\n";
-                $output .= substr($val, 0, $pos) . "\n";
-                $val = substr($val, $pos + 5);
-            }
-            $pos = strpos(strtoupper($val), '</PRE>');
-            if ($pos !== false) {
-                $pre = '';
-                $output .= substr($val, 0, $pos) . "\n";
-                $val = substr($val, $pos + 6);
-            }
-            $output .= $val . $pre;
-        }
-        $search = array(
-            '<BR>', '<P>', '</TITLE>',
-            '</H1>', '</H2>', '</H3>',
-            '<br>', '<p>', '</title>',
-            '</h1>', '</h2>', '</h3>');
-        $output = str_replace($search, "\n", $output);
-        $output = str_replace('<TD', ' <td', $output);
-        $output = str_replace('<td', ' <td', $output);
-        $output = str_replace('<tr', "\n<tr", $output);
-        $output = str_replace('<TR', "\n<tr", $output);
-        $output = str_replace('&nbsp;', ' ', $output);
-        $output = strip_tags($output);
-        $output = explode("\n", $output);
-        $rawdata = array();
-        $null = 0;
-        foreach ($output as $val) {
-            $val = trim($val);
-            if ($val == '') {
-                if (++$null > 2) {
-                    continue;
-                }
-            } else {
-                $null = 0;
-            }
-            $rawdata[] = $val;
-        }
-        return $rawdata;
-    }
-    /**
-     * Open a socket to the whois server.
-     *
-     * @param string|null $server Server address to connect. If null, $this->query['server'] will be used
-     *
-     * @return resource|false Returns a socket connection pointer on success, or -1 on failure
-     */
-    public function connect($server = null)
-    {
-        if (empty($server)) {
-            $server = $this->query['server'];
-        }
-        /** @TODO Throw an exception here */
-        if (empty($server)) {
-            return false;
-        }
-        $port = $this->query['server_port'];
-        $parsed = $this->parseServer($server);
-        $server = $parsed['host'];
-        if (array_key_exists('port', $parsed)) {
-            $port = $parsed['port'];
-        }
-        $retry = 0;
-        while ($retry <= $this->retry) {
-            $this->query['status'] = 'ready';
-            $ptr = @fsockopen($server, $port, $errno, $errstr, $this->stimeout);
-            if ($ptr > 0) {
-                $this->query['status'] = 'ok';
-                return $ptr;
-            }
-            $this->query['status'] = 'error';
-            $this->query['error'][] = $errstr;
-            $retry++;
-            sleep($this->sleep);
-        }
-        return false;
-    }
-    /**
-     * Post-process result with handler class.
-     *
-     * @return array On success, returns the result from the handler.
-     * On failure, returns passed result unaltered.
-     */
-    public function process(&$result, $deep_whois = true)
-    {
-        $handlerName = $this->loadHandler($this->query['handler']);
-        if ($handlerName === false) {
-            $handlerName = $this->loadLegacyHandler($this->query['handler'], $this->query['file']);
-        }
-        if ($handlerName === false) {
-            $this->query['errstr'][] = "Can't find {$this->query['handler']} handler: " . $this->query['file'];
-            return $result;
-        }
-        if (!$this->gtldRecurse && $this->query['file'] === 'whois.gtld.php') {
-            return $result;
-        }
-        $handler = new $handlerName('');
-        if (isset($handler->query['errstr'])) {
-            $this->query['errstr'][] = $handler->query['errstr'];
-        }
-        $handler->deepWhois = $deep_whois;
-        $res = $handler->parse($result, $this->query['query']);
-        return $res;
-    }
-    /**
-     * Does more (deeper) whois
-     *
-     * @return array Resulting array
-     */
-    public function deepWhois($query, $result)
-    {
-        if (!isset($result['regyinfo']['whois'])) {
-            return $result;
-        }
-        $this->query['server'] = $wserver = $result['regyinfo']['whois'];
-        unset($result['regyinfo']['whois']);
-        $subresult = $this->getRawData($query);
-        if (!empty($subresult)) {
-            $result = $this->setWhoisInfo($result);
-            $result['rawdata'] = $subresult;
-            if (isset($this->WHOIS_GTLD_HANDLER[$wserver])) {
-                $this->query['handler'] = $this->WHOIS_GTLD_HANDLER[$wserver];
-            } else {
-                $parts = explode('.', $wserver);
-                $hname = strtolower($parts[1]);
-                if (($fp = @fopen('whois.gtld.' . $hname . '.php', 'r', 1)) and fclose($fp)) {
-                    $this->query['handler'] = $hname;
-                }
-            }
-            if (!empty($this->query['handler'])) {
-                $this->query['file'] = sprintf('whois.gtld.%s.php', $this->query['handler']);
-                $regrinfo = $this->process($subresult); //$result['rawdata']);
-                $result['regrinfo'] = $this->mergeResults($result['regrinfo'], $regrinfo);
-            }
-        }
-        return $result;
-    }
-    /**
-     * Merge results
-     *
-     * @param array $a1
-     * @param array $a2
-     *
-     * @return array
-     */
-    public function mergeResults($a1, $a2)
-    {
-        reset($a2);
-        foreach ($a2 as $key => $val) {
-            if (isset($a1[$key])) {
-                if (is_array($val)) {
-                    if ($key != 'nserver') {
-                        $a1[$key] = $this->mergeResults($a1[$key], $val);
-                    }
-                } else {
-                    $val = trim($val);
-                    if ($val != '') {
-                        $a1[$key] = $val;
-                    }
-                }
-            } else {
-                $a1[$key] = $val;
-            }
-        }
-        return $a1;
-    }
-    /**
-     * Remove unnecessary symbols from nameserver received from whois server
-     *
-     * @param string[] $nserver List of received nameservers
-     *
-     * @return string[]
-     */
-    public function fixNameServer($nserver)
-    {
-        $dns = array();
-        foreach ($nserver as $val) {
-            $val = str_replace(array('[', ']', '(', ')'), '', trim($val));
-            $val = str_replace("\t", ' ', $val);
-            $parts = explode(' ', $val);
-            $host = '';
-            $ip = '';
-            foreach ($parts as $p) {
-                if (substr($p, -1) == '.') {
-                    $p = substr($p, 0, -1);
-                }
-                if ((ip2long($p) == -1) or (ip2long($p) === false)) {
-                    if ($host == '' && preg_match('/^[\w\-]+(\.[\w\-]+)+$/', $p)) {
-                        $host = $p;
-                    }
-                } else {
-                    $ip = $p;
-                }
-            }
-            if ($host == '') {
-                continue;
-            }
-            if ($ip == '') {
-                $ip = gethostbyname($host);
-                if ($ip == $host) {
-                    $ip = '(DOES NOT EXIST)';
-                }
-            }
-            if (substr($host, -1, 1) == '.') {
-                $host = substr($host, 0, -1);
-            }
-            $dns[strtolower($host)] = $ip;
-        }
-        return $dns;
-    }
-    /**
-     * Parse server string into array with host and port keys
-     *
-     * @param $server   server string in various formattes
-     * @return array    Array containing 'host' key with server host and 'port' if defined in original $server string
-     */
-    public function parseServer($server)
-    {
-        $server = trim($server);
-        $server = preg_replace('/\/$/', '', $server);
-        $ipTools = new IpTools;
-        if ($ipTools->validIpv6($server)) {
-            $result = array('host' => "[$server]");
-        } else {
-            $parsed = parse_url($server);
-            if (array_key_exists('path', $parsed) && !array_key_exists('host', $parsed)) {
-                $host = preg_replace('/\//', '', $parsed['path']);
-                if (preg_match('/^(\[[a-f0-9:]+\]):(\d{1,5})$/i', $host, $matches)) {
-                    $result = array('host' => $matches[1], 'port' => $matches[2]);
-                } else {
-                    $result = array('host' => $host);
-                }
-            } else {
-                $result = $parsed;
-            }
-        }
-        return $result;
-    }
-    /**
-     * @return string|bool
-     */
-    protected function loadHandler(string $queryHandler)
-    {
-        $queryHandler = ucfirst($queryHandler);
-        $handlerName = "phpWhois\\Handlers\\{$queryHandler}Handler";
-        if (class_exists($handlerName)) {
-            return $handlerName;
-        }
-        return false;
-    }
-    /**
-     * @return string|bool
-     */
-    protected function loadLegacyHandler(string $queryHandler, string $queryFile)
-    {
-        $handler_name = str_replace('.', '_', $queryHandler);
-        $HANDLER_FLAG = sprintf("__%s_HANDLER__", strtoupper($handler_name));
-        if (!defined($HANDLER_FLAG)) {
-            include($queryFile);
-        }
-        if (!defined($HANDLER_FLAG)) {
-            return false;
-        }
-        return $handler_name . '_handler';
-    }
-}

--- a//dev/null
+++ b/src/whois.ae.php
@@ -0,0 +1,45 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__AE_HANDLER__'))
+	define('__AE_HANDLER__', 1);
+require_once('whois.parser.php');
+class ae_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                    'Domain Name:'		=> 'domain.name',
+                    'Registrar Name:'	=> 'domain.sponsor',
+                    'Status:'			=> 'domain.status',
+                    'Registrant Contact ID:'	=> 'owner.handle',
+                    'Registrant Contact Name:' => 'owner.name',
+                    'Tech Contact Name:'		=> 'tech.name',
+                    'Tech Contact ID:'			=> 'tech.handle',
+                    'Name Server:'		=> 'domain.nserver.'
+		              );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.nic.ae',
+                    'registrar' => 'UAENIC'
+                    );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.aero.php
@@ -0,0 +1,35 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+if (!defined('__AERO_HANDLER__'))
+	define('__AERO_HANDLER__', 1);
+require_once('whois.parser.php');
+class aero_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, 'ymd');
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.aero',
+                          'registrar' => 'Societe Internationale de Telecommunications Aeronautiques SC'
+                          );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.ag.php
@@ -0,0 +1,35 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__AG_HANDLER__'))
+	define('__AG_HANDLER__', 1);
+require_once('whois.parser.php');
+class ag_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.ag',
+                          'registrar' => 'Nic AG'
+                          );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.am.php
@@ -0,0 +1,36 @@
+<?php
+if (!defined('__AM_HANDLER__'))
+	define('__AM_HANDLER__', 1);
+require_once('whois.parser.php');
+class am_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' 			=> 'Registrant:',
+                'domain.name' 		=> 'Domain name:',
+                'domain.created' 	=> 'Registered:',
+                'domain.changed' 	=> 'Last modified:',
+                'domain.nserver' 	=> 'DNS servers:',
+                'domain.status'		=> 'Status:',
+                'tech' 				=> 'Technical contact:',
+                'admin'				=> 'Administrative contact:',
+		            );
+		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
+		if (!empty($r['regrinfo']['domain']['name']))
+			{
+			$r['regrinfo'] = get_contacts($r['regrinfo']);
+			$r['regrinfo']['registered'] = 'yes';
+			}
+		else
+			{
+			$r = '';
+			$r['regrinfo']['registered'] = 'no';
+			}
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.isoc.am',
+                    'registrar' => 'ISOCAM'
+                    );
+		return $r;
+		}
+	}

--- a//dev/null
+++ b/src/whois.asia.php
@@ -0,0 +1,34 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+if(!defined('__ASIA_HANDLER__')) define('__ASIA_HANDLER__',1);
+require_once('whois.parser.php');
+class asia_handler
+	{
+	function parse ($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		$r['regyinfo'] = array(
+                        'referrer'=>'http://www.dotasia.org/',
+						'registrar' => 'DotAsia'
+                        );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.at.php
@@ -0,0 +1,85 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__AT_HANDLER__'))
+	define('__AT_HANDLER__', 1);
+require_once('whois.parser.php');
+class at_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+			'fax-no' => 'fax',
+			'e-mail' => 'email',
+			'nic-hdl' => 'handle',
+			'person' => 'name',
+			'personname' => 'name',
+			'street address' => 'address.street',
+			'city' =>	'address.city',
+			'postal code' => 'address.pcode',
+			'country' => 'address.country'
+			);
+		$contacts = array(
+                    'registrant' => 'owner',
+                    'admin-c' => 'admin',
+                    'tech-c' => 'tech',
+                    'billing-c' => 'billing',
+                    'zone-c' => 'zone'
+		                );
+		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
+		if (isset($reg['domain']['remarks']))
+			unset($reg['domain']['remarks']);
+		if (isset($reg['domain']['descr']))
+			{
+			while (list($key, $val) = each($reg['domain']['descr']))
+				{
+				$v = trim(substr(strstr($val, ':'), 1));
+				if (strstr($val, '[organization]:'))
+					{
+					$reg['owner']['organization'] = $v;
+					continue;
+					}
+				if (strstr($val, '[phone]:'))
+					{
+					$reg['owner']['phone'] = $v;
+					continue;
+					}
+				if (strstr($val, '[fax-no]:'))
+					{
+					$reg['owner']['fax'] = $v;
+					continue;
+					}
+				if (strstr($val, '[e-mail]:'))
+					{
+					$reg['owner']['email'] = $v;
+					continue;
+					}
+				$reg['owner']['address'][$key] = $v;
+				}
+			if (isset($reg['domain']['descr'])) unset($reg['domain']['descr']);
+			}
+		$r['regrinfo'] = $reg;
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.nic.at',
+                    'registrar' => 'NIC-AT'
+                    );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.au.php
@@ -0,0 +1,50 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__AU_HANDLER__'))
+	define('__AU_HANDLER__', 1);
+require_once('whois.parser.php');
+class au_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                    'Domain Name:'		=> 'domain.name',
+                    'Last Modified:'	=> 'domain.changed',
+                    'Registrar Name:'	=> 'domain.sponsor',
+                    'Status:'			=> 'domain.status',
+                    'Domain ROID:'		=> 'domain.handle',
+                    'Registrant:'		=> 'owner.organization',
+                    'Registrant Contact ID:'	=> 'owner.handle',
+                    'Registrant Contact Email:' => 'owner.email',
+                    'Registrant Contact Name:' => 'owner.name',
+                    'Tech Contact Name:'		=> 'tech.name',
+                    'Tech Contact Email:'		=> 'tech.email',
+                    'Tech Contact ID:'			=> 'tech.handle',
+                    'Name Server:'		=> 'domain.nserver.'
+		              );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.aunic.net',
+                    'registrar' => 'AU-NIC'
+                    );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.be.php
@@ -0,0 +1,61 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+require_once('whois.parser.php');
+if (!defined('__BE_HANDLER__'))
+	define('__BE_HANDLER__', 1);
+class be_handler
+	{
+	function parse($data, $query)
+		{
+		$items = array(
+                'domain.name'		=> 'Domain:',
+                'domain.status'		=> 'Status:',
+				'domain.nserver'	=> 'Nameservers:',
+                'domain.created'	=> 'Registered:',
+                'owner'				=> 'Licensee:',
+                'admin'				=> 'Onsite Contacts:',
+                'tech'				=> 'Registrar Technical Contacts:',
+				'agent'				=> 'Registrar:',
+				'agent.uri'			=> 'Website:'
+				);
+		$trans = array(
+				'company name2:' => ''
+				);
+		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
+		if ($r['regrinfo']['domain']['status'] == 'REGISTERED')
+			{
+			$r['regrinfo']['registered'] = 'yes';
+			$r['regrinfo'] = get_contacts($r['regrinfo'],$trans);
+			if (isset($r['regrinfo']['agent']))
+				{
+				$sponsor = get_contact($r['regrinfo']['agent'],$trans);
+				unset($r['regrinfo']['agent']);
+				$r['regrinfo']['domain']['sponsor'] = $sponsor;
+				}
+			$r = format_dates($r, '-mdy');
+			}
+		else
+			$r['regrinfo']['registered'] = 'no';
+		$r['regyinfo']['referrer'] = 'http://www.domain-registry.nl';
+		$r['regyinfo']['registrar'] = 'DNS Belgium';
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.bh.php
@@ -0,0 +1,49 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C) 2011 Bernhard Reutner Fischer <rep.dot.nop@gmail.com>
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__BH_HANDLER__'))
+	define('__BH_HANDLER__', 1);
+require_once('whois.parser.php');
+class bh_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+		    'Sponsoring Registrar Name:' => 'domain.sponsor.name',
+		    'Sponsoring Registrar Email:' => 'domain.sponsor.email',
+		    'Sponsoring Registrar Uri:' => 'domain.sponsor.uri',
+		    'Sponsoring Registrar Phone:' => 'domain.sponsor.phone'
+	        );
+		$i = generic_parser_b($data_str['rawdata'], $items);
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		if (isset($r['regrinfo']['domain'])
+		    && is_array($r['regrinfo']['domain']))
+		    $r['regrinfo']['domain']['sponsor'] = $i['domain']['sponsor'];
+		if (empty($r['regrinfo']['domain']['created']))
+		    $r['regrinfo']['registered'] = 'no';
+		else
+		    $r['regrinfo']['registered'] = 'yes';
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.nic.bh/',
+                    'registrar' => 'NIC-BH'
+                    );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.biz.php
@@ -0,0 +1,35 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__BIZ_HANDLER__'))
+	define('__BIZ_HANDLER__', 1);
+require_once('whois.parser.php');
+class biz_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, '-md--y');
+		$r['regyinfo'] = array(
+                  'referrer' => 'http://www.neulevel.biz',
+                  'registrar' => 'NEULEVEL'
+                  );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.br.php
@@ -0,0 +1,66 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+require_once('whois.parser.php');
+if (!defined('__BR_HANDLER__'))
+	define('__BR_HANDLER__', 1);
+class br_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+                    'fax-no' => 'fax',
+                    'e-mail' => 'email',
+                    'nic-hdl-br' => 'handle',
+                    'person' => 'name',
+                    'netname' => 'name',
+                    'domain' => 'name',
+                    'updated' => ''
+		                );
+		$contacts = array(
+                    'owner-c' => 'owner',
+                    'tech-c' => 'tech',
+                    'admin-c' => 'admin',
+                    'billing-c' => 'billing'
+		                );
+		$r = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
+		if (in_array('Permission denied.', $r['disclaimer']))
+			{
+			$r['registered'] = 'unknown';
+			return $r;
+			}
+		if (isset($r['domain']['nsstat'])) unset($r['domain']['nsstat']);
+		if (isset($r['domain']['nslastaa'])) unset($r['domain']['nslastaa']);
+		if (isset($r['domain']['owner']))
+			{
+			$r['owner']['organization'] = $r['domain']['owner'];
+			unset($r['domain']['owner']);
+			}
+		if (isset($r['domain']['responsible'])) unset($r['domain']['responsible']);
+		if (isset($r['domain']['address'])) unset($r['domain']['address']);
+		if (isset($r['domain']['phone'])) unset($r['domain']['phone']);
+		$a['regrinfo'] = $r;
+		$a['regyinfo'] = array(
+                    'registrar' => 'BR-NIC',
+                    'referrer' => 'http://www.nic.br'
+                    );
+		return $a;
+		}
+	}
+?>

--- a/src/whois.ca.php
+++ b/src/whois.ca.php
@@ -1,39 +1,61 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__CA_HANDLER__'))
-    define('__CA_HANDLER__', 1);
+	define('__CA_HANDLER__', 1);
 require_once('whois.parser.php');
-class ca_handler {
-    function parse($data_str, $query) {
-        $r = [
-            'rawdata' => $data_str['rawdata'],
-        ];
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], [], 'ymd');
-        $r['regyinfo'] = array(
-            'registrar' => 'CIRA',
-            'referrer' => 'http://www.cira.ca/'
-        );
-        return $r;
-    }
-}
+class ca_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+						'owner'	=> 'Registrant:',
+						'admin'	=> 'Administrative contact:',
+						'tech'	=> 'Technical contact:',
+						'domain.sponsor' => 'Registrar:',
+						'domain.nserver' => 'Name servers:',
+						'domain.status'	=> 'Domain status:',
+						'domain.created' => 'Creation date:',
+						'domain.expires' => 'Expiry date:',
+						'domain.changed' => 'Updated date:'
+						);
+		$extra = array(
+						'postal address:' => 'address.0',
+						'job title:'	=> '',
+						'number:'	=> 'handle',
+						'description:'	=> 'organization'
+						);
+		$r['regrinfo'] = easy_parser($data_str['rawdata'],$items,'ymd',$extra);
+		if (!empty($r['regrinfo']['domain']['sponsor']))
+			{
+			list($v,$reg) = explode(':',$r['regrinfo']['domain']['sponsor'][0]);
+			$r['regrinfo']['domain']['sponsor'] = trim($reg);
+			}
+		if (empty($r['regrinfo']['domain']['status']) || $r['regrinfo']['domain']['status'] == 'available')
+			$r['regrinfo']['registered'] = 'no';
+		else
+			$r['regrinfo']['registered'] = 'yes';
+		$r['regyinfo'] = array(
+                  'registrar' => 'CIRA',
+                  'referrer' => 'http://www.cira.ca/'
+                  );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.cat.php
+++ b/src/whois.cat.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__CAT_HANDLER__'))
-    define('__CAT_HANDLER__', 1);
+	define('__CAT_HANDLER__', 1);
 require_once('whois.parser.php');
-class cat_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        if (!isset($r['regrinfo']['domain']['name']))
-            $r['regrinfo']['registered'] = 'no';
-        $r['regyinfo']['referrer'] = 'http://www.domini.cat/';
-        $r['regyinfo']['registrar'] = 'Domini punt CAT';
-        return $r;
-    }
-}
+class cat_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		if (!isset($r['regrinfo']['domain']['name']))
+			$r['regrinfo']['registered'] = 'no';
+		$r['regyinfo']['referrer'] = 'http://www.domini.cat/';
+		$r['regyinfo']['registrar'] = 'Domini punt CAT';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.ch.php
+++ b/src/whois.ch.php
@@ -1,61 +1,62 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__CH_HANDLER__'))
-    define('__CH_HANDLER__', 1);
-class ch_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Holder of domain name:',
-            'domain.name' => 'Domain name:',
-            'domain.created' => 'Date of last registration:',
-            'domain.changed' => 'Date of last modification:',
-            'tech' => 'Technical contact:',
-            'domain.nserver' => 'Name servers:',
-            'domain.dnssec' => 'DNSSEC:'
-        );
-        $trans = array(
-            'contractual language:' => 'language'
-        );
-        $r = array();
-        $r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
-        if (!empty($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo'] = get_contacts($r['regrinfo'], $trans);
-            $r['regrinfo']['domain']['name'] = $r['regrinfo']['domain']['name'][0];
-            if (isset($r['regrinfo']['domain']['changed'][0]))
-                $r['regrinfo']['domain']['changed'] = get_date($r['regrinfo']['domain']['changed'][0], 'dmy');
-            if (isset($r['regrinfo']['domain']['created'][0]))
-                $r['regrinfo']['domain']['created'] = get_date($r['regrinfo']['domain']['created'][0], 'dmy');
-            $r['regrinfo']['registered'] = 'yes';
-        } else {
-            $r = [];
-            $r['regrinfo']['registered'] = 'no';
-        }
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.nic.ch',
-            'registrar' => 'SWITCH Domain Name Registration'
-        );
-        return $r;
-    }
-}
+	define('__CH_HANDLER__', 1);
+class ch_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'Holder of domain name:',
+                'domain.name' => 'Domain name:',
+                'domain.created' => 'Date of last registration:',
+                'domain.changed' => 'Date of last modification:',
+                'tech' => 'Technical contact:',
+                'domain.nserver' => 'Name servers:',
+                'domain.dnssec'	=> 'DNSSEC:'
+		            );
+		$trans = array(
+					'contractual language:' => 'language'
+					);
+		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
+		if (!empty($r['regrinfo']['domain']['name']))
+			{
+			$r['regrinfo'] = get_contacts($r['regrinfo'],$trans);
+			$r['regrinfo']['domain']['name'] = $r['regrinfo']['domain']['name'][0];
+			if (isset($r['regrinfo']['domain']['changed'][0]))
+				$r['regrinfo']['domain']['changed'] = get_date($r['regrinfo']['domain']['changed'][0], 'dmy');
+			if (isset($r['regrinfo']['domain']['created'][0]))
+				$r['regrinfo']['domain']['created'] = get_date($r['regrinfo']['domain']['created'][0], 'dmy');
+			$r['regrinfo']['registered'] = 'yes';
+			}
+		else
+			{
+			$r = '';
+			$r['regrinfo']['registered'] = 'no';
+			}
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.ch',
+                          'registrar' => 'SWITCH Domain Name Registration'
+                          );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.cl.php
@@ -0,0 +1,44 @@
+﻿<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__CL_HANDLER__'))
+	define('__CL_HANDLER__', 1);
+require_once('whois.parser.php');
+class cl_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'admin' => '(Administrative Contact)',
+                  'tech' => 'Contacto Técnico (Technical Contact):',
+                  'domain.nserver' => 'Servidores de nombre (Domain servers):',
+                  'domain.changed' => '(Database last updated on):'
+                  );
+		$trans = array(
+					'organización:' => 'organization',
+					'nombre      :' => 'name');
+		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'd-m-y', $trans);
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.nic.cl',
+                    'registrar' => 'NIC Chile'
+                    );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.client.php
@@ -0,0 +1,408 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+require_once('whois.ip.lib.php');
+class WhoisClient {
+	var $gtld_recurse = false;
+	var $PORT = 43;
+	var $RETRY = 0;
+	var $SLEEP = 2;
+	var $BUFFER = 1024;
+	var $STIMEOUT = 10;
+	var $DATA = array(); 	
+	var $Query = array(
+		'tld' => '',
+		'type' => 'domain',
+		'query' => '',
+		'status',
+		'server'
+		);
+	var $CODE_VERSION = '4.2.2';
+	var $VERSION;
+	/*
+	 * Constructor function
+	 */
+	function WhoisClient () {
+		@require('whois.servers.php');		
+		$this->VERSION = sprintf("phpWhois v%s-%s", $this->CODE_VERSION, $this->DATA_VERSION);
+	}
+	/*
+	 * Perform lookup
+	 */
+	function GetRawData ($query) {
+		$this->Query['query'] = $query;
+		if (isset($this->Query['errstr'])) unset($this->Query['errstr']);
+		if (!isset($this->Query['server'])) {
+			$this->Query['status'] = 'error';
+			$this->Query['errstr'][] = 'No server specified';
+			return(array());
+			}
+		if (substr($this->Query['server'],0,7)=='http://' ||
+			substr($this->Query['server'],0,8)=='https://')
+			{
+			$output = $this->httpQuery($this->Query['server']);
+			if (!$output)
+				{
+				$this->Query['status'] = 'error';
+				$this->Query['errstr'][] = 'Connect failed to: '.$this->Query['server'];
+				return(array());
+				}
+			$this->Query['args'] = substr(strchr($this->Query['server'],'?'),1);
+			$this->Query['server'] = strtok($this->Query['server'],'?');
+			if (substr($this->Query['server'],0,7)=='http://')
+				$this->Query['server_port'] = 80;
+			else
+				$this->Query['server_port'] = 483;
+			}
+		else
+			{
+			if (strpos($this->Query['server'],'?'))
+				{
+				$parts = explode('?',$this->Query['server']);
+				$this->Query['server'] = trim($parts[0]);
+				$query_args = trim($parts[1]);
+				$query_args = str_replace('{query}', $query, $query_args);
+				$query_args = str_replace('{version}', 'phpWhois'.$this->CODE_VERSION, $query_args);
+				if (strpos($query_args,'{ip}')!==false)
+					{
+					$query_args = str_replace('{ip}', phpwhois_getclientip(), $query_args);
+					}
+				if (strpos($query_args,'{hname}')!==false)
+					{
+					$query_args = str_replace('{hname}', gethostbyaddr(phpwhois_getclientip()), $query_args);
+					}
+				}
+			else
+				{
+				if (empty($this->Query['args']))
+					$query_args = $query;
+				else
+					$query_args = $this->Query['args'];
+				}
+			$this->Query['args'] = $query_args;
+			if (substr($this->Query['server'],0,9) == 'rwhois://')
+				{
+				$this->Query['server'] = substr($this->Query['server'],9);
+				}
+			if (substr($this->Query['server'],0,8) == 'whois://')
+				{
+				$this->Query['server'] = substr($this->Query['server'],8);
+				}
+			if (strpos($this->Query['server'],':'))
+				{
+				$parts = explode(':',$this->Query['server']);
+				$this->Query['server'] = trim($parts[0]);
+				$this->Query['server_port'] = trim($parts[1]);
+				}
+			else			
+				$this->Query['server_port'] = $this->PORT;
+			$ptr = $this->Connect();
+			if($ptr < 0) {
+				$this->Query['status'] = 'error';
+				$this->Query['errstr'][] = 'Connect failed to: '.$this->Query['server'];
+				return array();
+				}
+			stream_set_timeout($ptr,$this->STIMEOUT);
+			stream_set_blocking($ptr,0);
+			fputs($ptr, trim($query_args)."\r\n");
+			$raw = '';
+			$start = time();
+			$null = NULL;
+			$r = array($ptr);
+			while (!feof($ptr))
+				{
+				if (!empty($r))
+					{
+					if (stream_select($r,$null,$null,$this->STIMEOUT))
+						{
+						$raw .= fgets($ptr, $this->BUFFER);
+						}
+					}
+				if (time()-$start > $this->STIMEOUT)
+					{
+					$this->Query['status'] = 'error';
+					$this->Query['errstr'][] = 'Timeout reading from '.$this->Query['server'];
+					return array();
+					}
+				}
+			if (array_key_exists($this->Query['server'],$this->NON_UTF8))
+				{
+				$raw = utf8_encode($raw);
+				}
+			$output = explode("\n", $raw);
+			if (empty($output[count($output)-1]))
+				unset($output[count($output)-1]);
+			}
+		return $output;	
+	}
+	/*
+	 * Perform lookup. Returns an array. The 'rawdata' element contains an
+	 * array of lines gathered from the whois query. If a top level domain
+	 * handler class was found for the domain, other elements will have been
+	 * populated too.
+	 */
+	function GetData ($query='', $deep_whois=true) {
+		$query = !empty($query) ? $query : $this->Query['query'];
+		$output = $this->GetRawData($query);
+		$result = array( 'rawdata' => $output );		
+		$result = $this->set_whois_info($result);
+		if (empty($output)) return $result;
+		if (isSet($this->Query['handler']))
+			{
+			$servers = $result['regyinfo']['servers'];
+			unset($result['regyinfo']['servers']);
+			$result = $this->Process($result,$deep_whois);
+			if (isset($result['regyinfo']['servers']))
+				$result['regyinfo']['servers'] = array_merge($servers,$result['regyinfo']['servers']);
+			else
+				$result['regyinfo']['servers'] = $servers;
+			if (!isset($result['rawdata']))
+				$result['rawdata'] = $output;
+			}
+		if (!isset($result['regyinfo']['type']))
+			$result['regyinfo']['type'] = 'domain';	
+		if (isset($this->Query['errstr']))
+			$result['errstr'] = $this->Query['errstr'];
+		if (method_exists($this,'FixResult') && $this->Query['tld'] != 'ip')
+			$this->FixResult($result,$query);
+		return($result);
+	}
+	/*
+	*   Adds whois server query information to result
+	*/
+	function set_whois_info ($result)
+		{
+		$info = array(
+					'server'=> $this->Query['server'],
+					);
+		if (!empty($this->Query['args']))
+			$info['args'] = $this->Query['args'];
+		else
+			$info['args'] = $this->Query['query'];
+		if (!empty($this->Query['server_port']))
+			$info['port'] = $this->Query['server_port'];
+		else
+			$info['port'] = 43;
+		if (isset($result['regyinfo']['whois']))
+			unset($result['regyinfo']['whois']);
+		if (isset($result['regyinfo']['rwhois']))
+			unset($result['regyinfo']['rwhois']);
+		$result['regyinfo']['servers'][] = $info;
+		return $result;
+		}
+	/*
+	*   Convert html output to plain text
+	*/
+	function httpQuery ($query) {
+			$lines = @file($this->Query['server']);		
+		if (!$lines) return false;
+		$output = '';
+		$pre = '';
+		while (list($key, $val)=each($lines)) {
+			$val = trim($val);
+			$pos=strpos(strtoupper($val),'<PRE>');
+			if ($pos!==false) {
+				$pre = "\n";
+				$output.=substr($val,0,$pos)."\n";
+				$val = substr($val,$pos+5);
+				}
+			$pos=strpos(strtoupper($val),'</PRE>');
+			if ($pos!==false) {
+				$pre = '';
+				$output.=substr($val,0,$pos)."\n";
+				$val = substr($val,$pos+6);
+				}
+			$output.=$val.$pre;
+			}
+		$search = array (
+				'<BR>', '<P>', '</TITLE>',
+				'</H1>', '</H2>', '</H3>',
+				'<br>', '<p>', '</title>',
+				'</h1>', '</h2>', '</h3>'  );
+		$output = str_replace($search,"\n",$output);
+		$output = str_replace('<TD',' <td',$output);
+		$output = str_replace('<td',' <td',$output);
+		$output = str_replace('<tr',"\n<tr",$output);
+		$output = str_replace('<TR',"\n<tr",$output);
+		$output = str_replace('&nbsp;',' ',$output);
+		$output = strip_tags($output);		
+		$output = explode("\n",$output);
+		$rawdata = array();
+		$null = 0;
+		while (list($key, $val)=each($output)) {
+			$val=trim($val);
+			if ($val=='') {
+				if (++$null>2) continue;
+			}
+			else $null=0;
+			$rawdata[]=$val;
+		}
+		return $rawdata;
+	}
+	/*
+	 * Open a socket to the whois server.
+	 *
+	 * Returns a socket connection pointer on success, or -1 on failure.
+	 */
+	function Connect ($server = '') {
+		if ($server == '')
+			$server = $this->Query['server'];
+		if($server == '')
+			return(-1);
+		$port = $this->Query['server_port'];
+		$pos = strpos($server,'://');
+		if ($pos !== false)
+			$server = substr($server, $pos+3);
+		$pos = strpos($server,':');
+		if ($pos !== false)
+			{
+			$port = substr($server,$pos+1);
+			$server = substr($server,0,$pos);			
+			}
+		$retry = 0;
+		while($retry <= $this->RETRY) {
+			$this->Query['status'] = 'ready';
+			$ptr = @fsockopen($server, $port, $errno, $errstr, $this->STIMEOUT);
+			if($ptr > 0) {
+				$this->Query['status'] = 'ok';
+				return($ptr);
+			}
+			$this->Query['status'] = 'error';
+			$this->Query['error'][] = $errstr;
+			$retry++;
+			sleep($this->SLEEP);
+		}
+		return(-1);
+	} 	
+	/*
+	 * Post-process result with handler class. On success, returns the result
+	 * from the handler. On failure, returns passed result unaltered.
+	 */
+	function Process (&$result, $deep_whois=true) {
+		$handler_name = str_replace('.','_',$this->Query['handler']);
+		$HANDLER_FLAG = sprintf("__%s_HANDLER__", strtoupper($handler_name));
+		if (!defined($HANDLER_FLAG))
+			include($this->Query['file']);
+		if (!defined($HANDLER_FLAG))
+			{
+			$this->Query['errstr'][] = "Can't find $handler_name handler: ".$this->Query['file'];
+			return($result);
+			}
+		if (!$this->gtld_recurse && $this->Query['file'] == 'whois.gtld.php')
+			return $result;
+		$object = $handler_name.'_handler';
+		$handler = new $object('');
+		if(isSet($handler->Query['errstr']))
+			$this->Query['errstr'][] = $handler->Query['errstr'];
+		$handler->deep_whois = $deep_whois;
+		$res = $handler->parse($result,$this->Query['query']);
+		return $res;
+	}	
+	/*
+	 * Does more (deeper) whois ...
+	 */
+	function DeepWhois ($query, $result) {
+		if (!isset($result['regyinfo']['whois'])) return $result;
+		$this->Query['server'] = $wserver = $result['regyinfo']['whois'];
+		unset($result['regyinfo']['whois']);
+		$subresult = $this->GetRawData($query);
+		if (!empty($subresult))
+			{
+			$result = $this->set_whois_info($result);
+			$result['rawdata'] = $subresult;
+			if (isset($this->WHOIS_GTLD_HANDLER[$wserver]))
+				$this->Query['handler'] = $this->WHOIS_GTLD_HANDLER[$wserver];
+			else
+				{
+				$parts = explode('.',$wserver);
+				$hname = strtolower($parts[1]);
+				if (($fp = @fopen('whois.gtld.'.$hname.'.php', 'r', 1)) and fclose($fp))
+					$this->Query['handler'] = $hname;
+				}
+			if (!empty($this->Query['handler']))
+				{			
+				$this->Query['file'] = sprintf('whois.gtld.%s.php', $this->Query['handler']);
+				$regrinfo = $this->Process($subresult); //$result['rawdata']);
+				$result['regrinfo'] = $this->merge_results($result['regrinfo'], $regrinfo);
+				}
+			}
+		return $result;
+	}
+	/*
+	 *  Merge results
+	 */
+	function merge_results($a1, $a2) {
+		reset($a2);
+		while (list($key, $val) = each($a2))
+			{
+			if (isset($a1[$key]))
+				{
+				if (is_array($val))
+					{
+					if ($key != 'nserver')
+						$a1[$key] = $this->merge_results($a1[$key], $val);
+					}
+				else
+					{
+					$val = trim($val);
+					if ($val != '')
+						$a1[$key] = $val;
+					}
+				}
+			else
+				$a1[$key] = $val;
+			}
+		return $a1;
+	}
+	function FixNameServer($nserver)
+		{
+		$dns = array();
+		foreach($nserver as $val)
+			{
+			$val = str_replace( array('[',']','(',')'), '', trim($val));
+			$val = str_replace("\t", ' ', $val);
+			$parts = explode(' ', $val);
+			$host = '';
+			$ip = '';
+			foreach($parts as $p)
+				{
+				if (substr($p,-1) == '.') $p = substr($p,0,-1);
+				if ((ip2long($p) == - 1) or (ip2long($p) === false))
+					{
+					if ($host == '' && preg_match('/^[\w\-]+(\.[\w\-]+)+$/',$p))
+						{
+						$host = $p;
+						}
+					}
+				else
+					$ip = $p;
+				}
+			if ($host == '') continue;
+			if ($ip == '')
+				{
+				$ip = gethostbyname($host);
+				if ($ip == $host) $ip = '(DOES NOT EXIST)';
+				}
+			if (substr($host,-1,1) == '.') $host = substr($host,0,-1);
+			$dns[strtolower($host)] = $ip;
+			}
+		return $dns;
+		}
+}
+?>

--- a/src/whois.cn.php
+++ b/src/whois.cn.php
@@ -1,82 +1,80 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__CN_HANDLER__'))
-    define('__CN_HANDLER__', 1);
+	define('__CN_HANDLER__', 1);
 require_once('whois.parser.php');
-class cn_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'Domain Name:' => 'domain.name',
-            'Domain Status:' => 'domain.status.',
-            'ROID:' => 'domain.handle',
-            'Name Server:' => 'domain.nserver.',
-            'Registration Date:' => 'domain.created',
-            'Expiration Date:' => 'domain.expires',
-            'Sponsoring Registrar:' => 'domain.sponsor',
-            'Registrant Name:' => 'owner.name',
-            'Registrant Organization:' => 'owner.organization',
-            'Registrant Address:' => 'owner.address.address',
-            'Registrant Postal Code:' => 'owner.address.pcode',
-            'Registrant City:' => 'owner.address.city',
-            'Registrant Country Code:' => 'owner.address.country',
-            'Registrant Email:' => 'owner.email',
-            'Registrant Phone Number:' => 'owner.phone',
-            'Registrant Fax:' => 'owner.fax',
-            'Administrative Name:' => 'admin.name',
-            'Administrative Organization:' => 'admin.organization',
-            'Administrative Address:' => 'admin.address.address',
-            'Administrative Postal Code:' => 'admin.address.pcode',
-            'Administrative City:' => 'admin.address.city',
-            'Administrative Country Code:' => 'admin.address.country',
-            'Administrative Email:' => 'admin.email',
-            'Administrative Phone Number:' => 'admin.phone',
-            'Administrative Fax:' => 'admin.fax',
-            'Technical Name:' => 'tech.name',
-            'Technical Organization:' => 'tech.organization',
-            'Technical Address:' => 'tech.address.address',
-            'Technical Postal Code:' => 'tech.address.pcode',
-            'Technical City:' => 'tech.address.city',
-            'tec-country:' => 'tech.address.country',
-            'Technical Email:' => 'tech.email',
-            'Technical Phone Number:' => 'tech.phone',
-            'Technical Fax:' => 'tech.fax',
-            'Billing Name:' => 'billing.name',
-            'Billing Organization:' => 'billing.organization',
-            'Billing Address:' => 'billing.address.address',
-            'Billing Postal Code:' => 'billing.address.pcode',
-            'Billing City:' => 'billing.address.city',
-            'Billing Country Code:' => 'billing.address.country',
-            'Billing Email:' => 'billing.email',
-            'Billing Phone Number:' => 'billing.phone',
-            'Billing Fax:' => 'billing.fax'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.cnnic.net.cn',
-            'registrar' => 'China NIC'
-        );
-        return $r;
-    }
-}
+class cn_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'Domain Name:' => 'domain.name',
+                'Domain Status:' => 'domain.status.',
+                'ROID:' => 'domain.handle',
+                'Name Server:' => 'domain.nserver.',
+                'Registration Date:' => 'domain.created',
+                'Expiration Date:' => 'domain.expires',
+                'Sponsoring Registrar:' => 'domain.sponsor',
+                'Registrant Name:' => 'owner.name',
+                'Registrant Organization:' => 'owner.organization',
+                'Registrant Address:' => 'owner.address.address',
+                'Registrant Postal Code:' => 'owner.address.pcode',
+                'Registrant City:' => 'owner.address.city',
+                'Registrant Country Code:' => 'owner.address.country',
+                'Registrant Email:' => 'owner.email',
+                'Registrant Phone Number:' => 'owner.phone',
+                'Registrant Fax:' => 'owner.fax',
+                'Administrative Name:' => 'admin.name',
+                'Administrative Organization:' => 'admin.organization',
+                'Administrative Address:' => 'admin.address.address',
+                'Administrative Postal Code:' => 'admin.address.pcode',
+                'Administrative City:' => 'admin.address.city',
+                'Administrative Country Code:' => 'admin.address.country',
+                'Administrative Email:' => 'admin.email',
+                'Administrative Phone Number:' => 'admin.phone',
+                'Administrative Fax:' => 'admin.fax',
+                'Technical Name:' => 'tech.name',
+                'Technical Organization:' => 'tech.organization',
+                'Technical Address:' => 'tech.address.address',
+                'Technical Postal Code:' => 'tech.address.pcode',
+                'Technical City:' => 'tech.address.city',
+                'tec-country:' => 'tech.address.country',
+                'Technical Email:' => 'tech.email',
+                'Technical Phone Number:' => 'tech.phone',
+                'Technical Fax:' => 'tech.fax',
+                'Billing Name:' => 'billing.name',
+                'Billing Organization:' => 'billing.organization',
+                'Billing Address:' => 'billing.address.address',
+                'Billing Postal Code:' => 'billing.address.pcode',
+                'Billing City:' => 'billing.address.city',
+                'Billing Country Code:' => 'billing.address.country',
+                'Billing Email:' => 'billing.email',
+                'Billing Phone Number:' => 'billing.phone',
+                'Billing Fax:' => 'billing.fax'
+		            );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
+		$r['regyinfo'] = array(
+                'referrer' => 'http://www.cnnic.net.cn',
+                'registrar' => 'China NIC'
+                );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.co.php
+++ b/src/whois.co.php
@@ -1,35 +1,33 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__CO_HANDLER__'))
-    define('__CO_HANDLER__', 1);
+	define('__CO_HANDLER__', 1);
 require_once('whois.parser.php');
-class co_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], array(), 'mdy');
-        $r['regyinfo']['referrer'] = 'http://www.cointernet.com.co/';
-        $r['regyinfo']['registrar'] = '.CO Internet, S.A.S.';
-        return $r;
-    }
-}
+class co_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, '-md--y');
+		$r['regyinfo']['referrer'] = 'http://www.cointernet.com.co/';
+		$r['regyinfo']['registrar'] = '.CO Internet, S.A.S.';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.co.za.php
+++ b/src/whois.co.za.php
@@ -1,63 +1,61 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__CO_ZA_HANDLER__'))
-    define('__CO_ZA_HANDLER__', 1);
+	define('__CO_ZA_HANDLER__', 1);
 require_once('whois.parser.php');
-class co_Za_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            '0a. lastupdate             :' => 'domain.changed',
-            '1a. domain                 :' => 'domain.name',
-            '2b. registrantpostaladdress:' => 'owner.address.address.0',
-            '2f. billingaccount         :' => 'billing.name',
-            '2g. billingemail           :' => 'billing.email',
-            '2i. invoiceaddress         :' => 'billing.address',
-            '2j. registrantphone        :' => 'owner.phone',
-            '2k. registrantfax          :' => 'owner.fax',
-            '2l. registrantemail        :' => 'owner.email',
-            '4a. admin                  :' => 'admin.name',
-            '4c. admincompany           :' => 'admin.organization',
-            '4d. adminpostaladdr        :' => 'admin.address',
-            '4e. adminphone             :' => 'admin.phone',
-            '4f. adminfax               :' => 'admin.fax',
-            '4g. adminemail             :' => 'admin.email',
-            '5a. tec                    :' => 'tech.name',
-            '5c. teccompany             :' => 'tech.organization',
-            '5d. tecpostaladdr          :' => 'tech.address',
-            '5e. tecphone               :' => 'tech.phone',
-            '5f. tecfax                 :' => 'tech.fax',
-            '5g. tecemail               :' => 'tech.email',
-            '6a. primnsfqdn             :' => 'domain.nserver.0',
-            '6e. secns1fqdn             :' => 'domain.nserver.1',
-            '6i. secns2fqdn             :' => 'domain.nserver.2',
-            '6m. secns3fqdn             :' => 'domain.nserver.3',
-            '6q. secns4fqdn             :' => 'domain.nserver.4'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
-        $r['regyinfo']['referrer'] = 'http://www.co.za';
-        $r['regyinfo']['registrar'] = 'UniForum Association';
-        return $r;
-    }
-}
+class co_Za_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                    '0a. lastupdate             :'	=> 'domain.changed',
+                    '1a. domain                 :'	=> 'domain.name',
+                    '2b. registrantpostaladdress:'	=> 'owner.address.address.0',
+                    '2f. billingaccount         :'	=> 'billing.name',
+                    '2g. billingemail           :'  => 'billing.email',
+                    '2i. invoiceaddress         :'	=> 'billing.address',
+                    '2j. registrantphone        :'	=> 'owner.phone',
+                    '2k. registrantfax          :'	=> 'owner.fax',
+                    '2l. registrantemail        :'	=> 'owner.email',
+                    '4a. admin                  :'	=> 'admin.name',
+                    '4c. admincompany           :'	=> 'admin.organization',
+                    '4d. adminpostaladdr        :'	=> 'admin.address',
+                    '4e. adminphone             :'	=> 'admin.phone',
+                    '4f. adminfax               :'	=> 'admin.fax',
+                    '4g. adminemail             :'	=> 'admin.email',
+                    '5a. tec                    :'	=> 'tech.name',
+                    '5c. teccompany             :'	=> 'tech.organization',
+                    '5d. tecpostaladdr          :'	=> 'tech.address',
+                    '5e. tecphone               :'	=> 'tech.phone',
+                    '5f. tecfax                 :'	=> 'tech.fax',
+                    '5g. tecemail               :'	=> 'tech.email',
+                    '6a. primnsfqdn             :'	=> 'domain.nserver.0',
+                    '6e. secns1fqdn             :'	=> 'domain.nserver.1',
+                    '6i. secns2fqdn             :'	=> 'domain.nserver.2',
+                    '6m. secns3fqdn             :'	=> 'domain.nserver.3',
+                    '6q. secns4fqdn             :'	=> 'domain.nserver.4'
+		              );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
+		$r['regyinfo']['referrer'] = 'http://www.co.za';
+		$r['regyinfo']['registrar'] = 'UniForum Association';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.coop.php
+++ b/src/whois.coop.php
@@ -1,83 +1,86 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__COOP_HANDLER__'))
-    define('__COOP_HANDLER__', 1);
+	define('__COOP_HANDLER__', 1);
 require_once('whois.parser.php');
-class coop_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Contact Type:            registrant',
-            'admin' => 'Contact Type:            admin',
-            'tech' => 'Contact Type:            tech',
-            'billing' => 'Contact Type:            billing',
-            'domain.name' => 'Domain Name:',
-            'domain.handle' => 'Domain ID:',
-            'domain.expires' => 'Expiry Date:',
-            'domain.created' => 'Created:',
-            'domain.changed' => 'Last updated:',
-            'domain.status' => 'Domain Status:',
-            'domain.sponsor' => 'Sponsoring registrar:',
-            'domain.nserver.' => 'Host Name:'
-        );
-        $translate = array(
-            'Contact ID:' => 'handle',
-            'Name:' => 'name',
-            'Organisation:' => 'organization',
-            'Street 1:' => 'address.street.0',
-            'Street 2:' => 'address.street.1',
-            'Street 3:' => 'address.street.2',
-            'City:' => 'address.city',
-            'State/Province:' => 'address.state',
-            'Postal code:' => 'address.pcode',
-            'Country:' => 'address.country',
-            'Voice:' => 'phone',
-            'Fax:' => 'fax',
-            'Email:' => 'email'
-        );
-        $blocks = get_blocks($data_str['rawdata'], $items);
-        $r = array();
-        if (isset($blocks['domain'])) {
-            $r['regrinfo']['domain'] = format_dates($blocks['domain'], 'dmy');
-            $r['regrinfo']['registered'] = 'yes';
-            if (isset($blocks['owner'])) {
-                $r['regrinfo']['owner'] = generic_parser_b($blocks['owner'], $translate, 'dmy', false);
-                if (isset($blocks['tech']))
-                    $r['regrinfo']['tech'] = generic_parser_b($blocks['tech'], $translate, 'dmy', false);
-                if (isset($blocks['admin']))
-                    $r['regrinfo']['admin'] = generic_parser_b($blocks['admin'], $translate, 'dmy', false);
-                if (isset($blocks['billing']))
-                    $r['regrinfo']['billing'] = generic_parser_b($blocks['billing'], $translate, 'dmy', false);
-            }
-            else {
-                $r['regrinfo']['owner'] = generic_parser_b($data_str['rawdata'], $translate, 'dmy', false);
-            }
-        } else
-            $r['regrinfo']['registered'] = 'no';
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.nic.coop',
-            'registrar' => '.coop registry'
-        );
-        return $r;
-    }
-}
+class coop_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array (
+						'owner' => 'Contact Type:            registrant',
+						'admin' => 'Contact Type:            admin',
+						'tech' => 'Contact Type:            tech',
+						'billing' => 'Contact Type:            billing',
+						'domain.name' => 'Domain Name:',
+						'domain.handle' => 'Domain ID:',
+						'domain.expires' => 'Expiry Date:',
+						'domain.created' => 'Created:',
+						'domain.changed' => 'Last updated:',
+						'domain.status' => 'Domain Status:',
+						'domain.sponsor' => 'Sponsoring registrar:',
+						'domain.nserver.' => 'Host Name:'
+						);
+		$translate = array(
+						'Contact ID:' => 'handle',
+						'Name:' => 'name',
+						'Organisation:' => 'organization',
+						'Street 1:' => 'address.street.0',
+						'Street 2:' => 'address.street.1',
+						'Street 3:' => 'address.street.2',
+						'City:' => 'address.city',
+						'State/Province:' => 'address.state',
+						'Postal code:' => 'address.pcode',
+						'Country:' => 'address.country',
+						'Voice:' => 'phone',
+						'Fax:' => 'fax',
+						'Email:' => 'email'
+						);
+		$blocks = get_blocks($data_str['rawdata'],$items);
+		$r=array();
+		if (isset($blocks['domain']))
+			{
+			$r['regrinfo']['domain'] = format_dates($blocks['domain'],'dmy');
+			$r['regrinfo']['registered'] = 'yes';
+			if (isset($blocks['owner']))
+				{
+				$r['regrinfo']['owner'] = generic_parser_b($blocks['owner'],$translate,'dmy',false);
+				if (isset($blocks['tech']))
+					$r['regrinfo']['tech'] = generic_parser_b($blocks['tech'],$translate,'dmy',false);
+				if (isset($blocks['admin']))
+					$r['regrinfo']['admin'] = generic_parser_b($blocks['admin'],$translate,'dmy',false);
+				if (isset($blocks['billing']))
+					$r['regrinfo']['billing'] = generic_parser_b($blocks['billing'],$translate,'dmy',false);
+				}
+			else
+				{
+				$r['regrinfo']['owner'] = generic_parser_b($data_str['rawdata'],$translate,'dmy',false);
+				}
+			}
+		else
+			$r['regrinfo']['registered'] = 'no';
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.coop',
+                          'registrar' => '.coop registry'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.cz.php
+++ b/src/whois.cz.php
@@ -1,59 +1,58 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__CZ_HANDLER__'))
-    define('__CZ_HANDLER__', 1);
+	define('__CZ_HANDLER__', 1);
 require_once('whois.parser.php');
-class cz_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'expire' => 'expires',
-            'registered' => 'created',
-            'nserver' => 'nserver',
-            'domain' => 'name',
-            'contact' => 'handle',
-            'reg-c' => '',
-            'descr' => 'desc',
-            'e-mail' => 'email',
-            'person' => 'name',
-            'org' => 'organization',
-            'fax-no' => 'fax'
-        );
-        $contacts = array(
-            'admin-c' => 'admin',
-            'tech-c' => 'tech',
-            'bill-c' => 'billing',
-            'registrant' => 'owner'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'dmy');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.nic.cz',
-            'registrar' => 'CZ-NIC'
-        );
-        if ($data_str['rawdata'][0] == 'Your connection limit exceeded. Please slow down and try again later.') {
-            $r['regrinfo']['registered'] = 'unknown';
-        }
-        return $r;
-    }
-}
+class cz_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+                      'expire' 	=> 'expires',
+                      'registered' => 'created',
+                      'nserver' => 'nserver',
+                      'domain' 	=> 'name',
+                      'contact' => 'handle',
+                      'reg-c'	=> '',
+                      'descr'	=> 'desc',
+                      'e-mail'	=> 'email',
+                      'person'	=> 'name',
+                      'org'		=> 'organization',
+                      'fax-no'	=> 'fax'
+		                  );
+		$contacts = array(
+                      'admin-c' => 'admin',
+                      'tech-c' => 'tech',
+                      'bill-c' => 'billing',
+                      'registrant' => 'owner'
+		                  );
+		$r['regrinfo'] = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'dmy');
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.cz',
+                          'registrar' => 'CZ-NIC'
+                          );
+		if ($data_str['rawdata'][0] == 'Your connection limit exceeded. Please slow down and try again later.')
+			{
+			$r['regrinfo']['registered'] = 'unknown';
+			}
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.de.php
@@ -0,0 +1,64 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__DE_HANDLER__'))
+	define('__DE_HANDLER__', 1);
+require_once('whois.parser.php');
+class de_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+			'domain.name' =>	'Domain:',
+			'domain.nserver.' =>'Nserver:',
+			'domain.nserver.#' =>'Nsentry:',
+			'domain.status' =>	'Status:',
+			'domain.changed' =>	'Changed:',
+			'domain.desc.' =>	'Descr:',
+			'owner' =>	'[Holder]',
+			'admin' =>	'[Admin-C]',
+			'tech' =>	'[Tech-C]',
+			'zone' =>	'[Zone-C]'
+		            );
+		$extra = array(
+			'city:' => 'address.city',
+			'postalcode:' => 'address.pcode',
+			'countrycode:' => 'address.country',
+			'remarks:' => '',
+			'sip:' => 'sip',
+			'type:'	=> ''
+		            );
+		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd',$extra);
+		$r['regyinfo'] = array(
+                  'registrar' => 'DENIC eG',
+                  'referrer' => 'http://www.denic.de/'
+                  );
+		 if (!isset($r['regrinfo']['domain']['status']) || $r['regrinfo']['domain']['status'] == "free")
+			{
+            $r['regrinfo']['registered'] = 'no';
+            }
+         else
+			{
+			$r['regrinfo']['domain']['changed'] = substr($r['regrinfo']['domain']['changed'], 0, 10);
+			$r['regrinfo']['registered'] = 'yes';
+			}
+		return $r;
+		}
+	}
+?>

--- a/src/whois.dev.php
+++ b//dev/null
@@ -1,38 +0,0 @@
-<?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-if (!defined('__DEV_HANDLER__')) {
-    define('__DEV_HANDLER__', 1);
-}
-require_once('whois.parser.php');
-/**
- * Class dev_handler
- */
-class dev_handler
-{
-    function parse($data_str, $query)
-    {
-        $r = [
-            'regrinfo' => generic_parser_b($data_str['rawdata']),
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}

--- a/src/whois.dk.php
+++ b//dev/null
@@ -1,73 +0,0 @@
-<?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-if (!defined('__DK_HANDLER__')) {
-    define('__DK_HANDLER__', 1);
-}
-require_once('whois.parser.php');
-class dk_handler {
-    function parse($data_str, $query) {
-        $translate = [
-            'Name' => 'name',
-            'Address' => 'address.street',
-            'City' => 'address.city',
-            'Postalcode' => 'address.pcode',
-            'Country' => 'address.country'
-        ];
-        $blocks = generic_parser_a_blocks($data_str['rawdata'], $translate, $disclaimer);
-        $reg = [];
-        if (isset($disclaimer) && is_array($disclaimer)) {
-            $reg['disclaimer'] = $disclaimer;
-        }
-        if (empty($blocks) || !is_array($blocks['main'])) {
-            $reg['registered'] = 'no';
-        } else {
-            $r = $blocks['main'];
-            $reg['registered'] = 'yes';
-            $ownerHandlePos = array_search('Registrant', $data_str['rawdata']) + 1;
-            $ownerHandle = trim(substr(strstr($data_str['rawdata'][$ownerHandlePos], ':'), 1));
-            $adminHandlePos = array_search('Administrator', $data_str['rawdata']) + 1;
-            $adminHandle = trim(substr(strstr($data_str['rawdata'][$adminHandlePos], ':'), 1));
-            $contacts = [
-                'owner' => $ownerHandle,
-                'admin' => $adminHandle,
-            ];
-            foreach ($contacts as $key => $val) {
-                $blk = strtoupper(strtok($val, ' '));
-                if (isset($blocks[$blk])) {
-                    $reg[$key] = $blocks[$blk];
-                }
-            }
-            $reg['domain'] = $r;
-            format_dates($reg, 'Ymd');
-        }
-        $r = [];
-        $r['rawdata'] = $data_str['rawdata'];
-        $r['regrinfo'] = $reg;
-        $r['regyinfo'] = [
-            'referrer' => 'https://www.dk-hostmaster.dk/',
-            'registrar' => 'DK Hostmaster'
-        ];
-        return $r;
-    }
-}

--- a//dev/null
+++ b/src/whois.edu.php
@@ -0,0 +1,49 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__EDU_HANDLER__'))
+	define('__EDU_HANDLER__', 1);
+require_once('whois.parser.php');
+class edu_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+				'domain.name' => 'Domain name:',
+                'domain.sponsor' => 'Registrar:',
+                'domain.nserver' => 'Name Servers:',
+                'domain.changed' => 'Domain record last updated:',
+                'domain.created' => 'Domain record activated:',
+                'owner'	=> 'Registrant:',
+                'admin' => 'Administrative Contact:',
+                'tech' => 'Technical Contact:',
+                'billing' => 'Billing Contact:'
+		            );
+		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'dmy');
+		if (isset($b['tech']))
+			{
+			if ($r['regrinfo']['tech']['name'] == 'Same as above')
+				$r['regrinfo']['tech'] = $r['regrinfo']['admin'];
+			}
+		$r['regyinfo']['referrer'] = 'http://whois.educause.net';
+		$r['regyinfo']['registrar'] = 'EDUCASE';
+		return ($r);
+		}
+	}
+?>

--- a/src/whois.eu.php
+++ b/src/whois.eu.php
@@ -1,66 +1,66 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__EU_HANDLER__'))
-    define('__EU_HANDLER__', 1);
-class eu_handler {
-    function parse($data, $query) {
-        $items = array(
-            'domain.name' => 'Domain:',
-            'domain.status' => 'Status:',
-            'domain.nserver' => 'Name servers:',
-            'domain.created' => 'Registered:',
-            'domain.registrar' => 'Registrar:',
-            'tech' => 'Registrar Technical Contacts:',
-            'owner' => 'Registrant:',
-            '' => 'Please visit'
-        );
-        $extra = array(
-            'organisation:' => 'organization',
-            'website:' => 'url'
-        );
-        $r = array();
-        $r['regrinfo'] = get_blocks($data['rawdata'], $items);
-        if (!empty($r['regrinfo']['domain']['status']))
-            switch ($r['regrinfo']['domain']['status']) {
-                case 'FREE':
-                case 'AVAILABLE':
-                    $r['regrinfo']['registered'] = 'no';
-                    break;
-                case 'APPLICATION PENDING':
-                    $r['regrinfo']['registered'] = 'pending';
-                    break;
-                default:
-                    $r['regrinfo']['registered'] = 'unknown';
-            } else
-            $r['regrinfo']['registered'] = 'yes';
-        if (isset($r['regrinfo']['tech']))
-            $r['regrinfo']['tech'] = get_contact($r['regrinfo']['tech'], $extra);
-        if (isset($r['regrinfo']['domain']['registrar']))
-            $r['regrinfo']['domain']['registrar'] = get_contact($r['regrinfo']['domain']['registrar'], $extra);
-        $r['regyinfo']['referrer'] = 'http://www.eurid.eu';
-        $r['regyinfo']['registrar'] = 'EURID';
-        return $r;
-    }
-}
+	define('__EU_HANDLER__', 1);
+class eu_handler
+	{
+	function parse($data, $query)
+		{
+		$items = array(
+                'domain.name'		=> 'Domain:',
+                'domain.status'		=> 'Status:',
+				'domain.nserver'	=> 'Name servers:',
+                'domain.created'	=> 'Registered:',
+                'domain.registrar'	=> 'Registrar:',
+                'tech'				=> 'Registrar Technical Contacts:',
+                'owner'				=> 'Registrant:',
+                ''					=> 'Please visit'
+				);
+		$extra = array(
+				'organisation:' => 'organization',
+				'website:'		=> 'url'
+				);
+		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
+		if (!empty($r['regrinfo']['domain']['status']))
+			switch ($r['regrinfo']['domain']['status'])
+				{
+				case 'FREE':
+				case 'AVAILABLE':
+					$r['regrinfo']['registered'] = 'no';
+					break;
+				case 'APPLICATION PENDING':
+					$r['regrinfo']['registered'] = 'pending';
+					break;
+				default:
+					$r['regrinfo']['registered'] = 'unknown';
+				}
+		else
+			$r['regrinfo']['registered'] = 'yes';
+		if (isset($r['regrinfo']['tech']))
+			$r['regrinfo']['tech'] = get_contact($r['regrinfo']['tech'],$extra);
+		if (isset($r['regrinfo']['domain']['registrar']))
+			$r['regrinfo']['domain']['registrar'] = get_contact($r['regrinfo']['domain']['registrar'],$extra);
+		$r['regyinfo']['referrer'] = 'http://www.eurid.eu';
+		$r['regyinfo']['registrar'] = 'EURID';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.fi.php
+++ b/src/whois.fi.php
@@ -1,47 +1,45 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__FI_HANDLER__'))
-    define('__FI_HANDLER__', 1);
+	define('__FI_HANDLER__', 1);
 require_once('whois.parser.php');
-class fi_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domain:' => 'domain.name',
-            'created:' => 'domain.created',
-            'expires:' => 'domain.expires',
-            'status:' => 'domain.status',
-            'nserver:' => 'domain.nserver.',
-            'descr:' => 'owner.name.',
-            'address:' => 'owner.address.',
-            'phone:' => 'owner.phone',
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
-        $r['regyinfo'] = array(
-            'referrer' => 'https://domain.ficora.fi/',
-            'registrar' => 'Finnish Communications Regulatory Authority'
-        );
-        return $r;
-    }
-}
+class fi_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'domain:' => 'domain.name',
+                  'created:' => 'domain.created',
+                  'expires:' => 'domain.expires',
+                  'status:' => 'domain.status',
+                  'nserver:' => 'domain.nserver.',
+                  'descr:' => 'owner.name.',
+                  'address:' => 'owner.address.',
+                  'phone:' => 'owner.phone',
+                    );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
+		$r['regyinfo'] = array(
+                          'referrer' => 'https://domain.ficora.fi/',
+                          'registrar' => 'Finnish Communications Regulatory Authority'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.fj.php
+++ b/src/whois.fj.php
@@ -1,52 +1,51 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__FJ_HANDLER__'))
-    define('__FJ_HANDLER__', 1);
-class fj_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'domain.status' => 'Status:',
-            'domain.expires' => 'Expires:',
-            'domain.nserver' => 'Domain servers:'
-        );
-        $r = array();
-        $r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
-        if (!empty($r['regrinfo']['domain']['status'])) {
-            $r['regrinfo'] = get_contacts($r['regrinfo']);
-            date_default_timezone_set("Pacific/Fiji");
-            if (isset($r['regrinfo']['domain']['expires']))
-                $r['regrinfo']['domain']['expires'] = strftime("%Y-%m-%d", strtotime($r['regrinfo']['domain']['expires']));
-            $r['regrinfo']['registered'] = 'yes';
-        } else {
-            $r['regrinfo']['registered'] = 'no';
-        }
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.domains.fj',
-            'registrar' => 'FJ Domain Name Registry'
-        );
-        return $r;
-    }
-}
+	define('__FJ_HANDLER__', 1);
+class fj_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+				'owner' => 'Registrant:',
+				'domain.status' => 'Status:',
+				'domain.expires' => 'Expires:',
+				'domain.nserver' => 'Domain servers:'
+		            );
+		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
+		if (!empty($r['regrinfo']['domain']['status']))
+			{
+			$r['regrinfo'] = get_contacts($r['regrinfo']);
+			date_default_timezone_set("Pacific/Fiji");
+			if (isset($r['regrinfo']['domain']['expires']))
+				$r['regrinfo']['domain']['expires'] = strftime("%Y-%m-%d",strtotime($r['regrinfo']['domain']['expires']));
+			$r['regrinfo']['registered'] = 'yes';
+			}
+		else
+			$r['regrinfo']['registered'] = 'no';
+		$r['regyinfo'] = array(
+                         'referrer' => 'http://www.domains.fj',
+                         'registrar' => 'FJ Domain Name Registry'
+                         );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.fm.php
+++ b/src/whois.fm.php
@@ -1,64 +1,64 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__FM_HANDLER__'))
-    define('__FM_HANDLER__', 1);
+	define('__FM_HANDLER__', 1);
 require_once('whois.parser.php');
-class fm_handler {
-    function parse($data, $query) {
-        $items = array(
-            'owner' => 'Registrant',
-            'admin' => 'Admin',
-            'tech' => 'Technical',
-            'billing' => 'Billing',
-            'domain.nserver' => 'Name Servers:',
-            'domain.created' => 'Created:',
-            'domain.expires' => 'Expires:',
-            'domain.changed' => 'Modified:',
-            'domain.status' => 'Status:',
-            'domain.sponsor' => 'Registrar Name:'
-        );
-        $r = array();
-        $r['regrinfo'] = get_blocks($data['rawdata'], $items);
-        $items = array(
-            'phone number:' => 'phone',
-            'email address:' => 'email',
-            'fax number:' => 'fax',
-            'organisation:' => 'organization'
-        );
-        if (!empty($r['regrinfo']['domain']['created'])) {
-            $r['regrinfo'] = get_contacts($r['regrinfo'], $items);
-            if (count($r['regrinfo']['billing']['address']) > 4)
-                $r['regrinfo']['billing']['address'] = array_slice($r['regrinfo']['billing']['address'], 0, 4);
-            $r['regrinfo']['registered'] = 'yes';
-            format_dates($r['regrinfo']['domain'], 'dmY');
-        }
-        else {
-            $r = [];
-            $r['regrinfo']['registered'] = 'no';
-        }
-        $r['regyinfo']['referrer'] = 'http://www.dot.dm';
-        $r['regyinfo']['registrar'] = 'dotFM';
-        return $r;
-    }
-}
+class fm_handler
+	{
+	function parse($data, $query)
+		{
+		$items = array(
+				  'owner' => 'Registrant',
+                  'admin' => 'Admin',
+                  'tech' => 'Technical',
+                  'billing' => 'Billing',
+                  'domain.nserver' => 'Name Servers:',
+                  'domain.created' => 'Created:',
+                  'domain.expires' => 'Expires:',
+                  'domain.changed' => 'Modified:',
+                  'domain.status' => 'Status:',
+                  'domain.sponsor' => 'Registrar Name:'
+                  );
+		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
+		$items = array(
+						'phone number:' => 'phone',
+						'email address:' => 'email',
+						'fax number:' => 'fax',
+						'organisation:' => 'organization'
+						);
+		if (!empty($r['regrinfo']['domain']['created']))
+			{
+			$r['regrinfo'] = get_contacts($r['regrinfo'],$items);
+			if (count($r['regrinfo']['billing']['address']) > 4)
+				$r['regrinfo']['billing']['address'] = array_slice($r['regrinfo']['billing']['address'],0,4);
+			$r['regrinfo']['registered'] = 'yes';
+			format_dates($r['regrinfo']['domain'],'dmY');
+			}
+		else
+			{
+			$r = '';
+			$r['regrinfo']['registered'] = 'no';
+			}
+		$r['regyinfo']['referrer'] = 'http://www.dot.dm';
+		$r['regyinfo']['registrar'] = 'dotFM';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.fr.php
+++ b/src/whois.fr.php
@@ -1,65 +1,64 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__FR_HANDLER__'))
-    define('__FR_HANDLER__', 1);
+	define('__FR_HANDLER__', 1);
 require_once('whois.parser.php');
-class fr_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'fax-no' => 'fax',
-            'e-mail' => 'email',
-            'nic-hdl' => 'handle',
-            'ns-list' => 'handle',
-            'person' => 'name',
-            'address' => 'address.',
-            'descr' => 'desc',
-            'anniversary' => '',
-            'domain' => '',
-            'last-update' => 'changed',
-            'registered' => 'created',
-            'country' => 'address.country',
-            'registrar' => 'sponsor',
-            'role' => 'organization'
-        );
-        $contacts = array(
-            'admin-c' => 'admin',
-            'tech-c' => 'tech',
-            'zone-c' => 'zone',
-            'holder-c' => 'owner',
-            'nsl-id' => 'nserver'
-        );
-        $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'dmY');
-        if (isset($reg['nserver'])) {
-            $reg['domain'] = array_merge($reg['domain'], $reg['nserver']);
-            unset($reg['nserver']);
-        }
-        $r = array();
-        $r['regrinfo'] = $reg;
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.nic.fr',
-            'registrar' => 'AFNIC'
-        );
-        return $r;
-    }
-}
+class fr_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+						'fax-no' => 'fax',
+						'e-mail' => 'email',
+						'nic-hdl' => 'handle',
+						'ns-list' => 'handle',
+						'person' => 'name',
+						'address' => 'address.',
+						'descr' => 'desc',
+						'anniversary'	=> '',
+						'domain'	=> '',
+						'last-update' => 'changed',
+						'registered' => 'created',
+						'country' => 'address.country',
+						'registrar' => 'sponsor',
+						'role'	=> 'organization'
+		                  );
+		$contacts = array(
+						'admin-c' 	=> 'admin',
+						'tech-c' 	=> 'tech',
+						'zone-c' 	=> 'zone',
+						'holder-c'	=> 'owner',
+						'nsl-id'	=> 'nserver'
+		                  );
+		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain','dmY');
+		if (isset($reg['nserver']))
+			{
+			$reg['domain'] = array_merge($reg['domain'],$reg['nserver']);
+			unset($reg['nserver']);
+			}
+		$r['regrinfo'] = $reg;
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.fr',
+                          'registrar' => 'AFNIC'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.afternic.php
+++ b/src/whois.gtld.afternic.php
@@ -1,41 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__AFTERNIC_HANDLER__'))
-    define('__AFTERNIC_HANDLER__', 1);
+	define('__AFTERNIC_HANDLER__', 1);
 require_once('whois.parser.php');
-class afternic_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical Contact',
-            'zone' => 'Zone Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.changed' => 'Last updated on',
-            'domain.created' => 'Domain created on',
-            'domain.expires' => 'Domain expires on'
-        );
-        return easy_parser($data_str, $items, 'dmy', array(), false, true);
-    }
-}
+class afternic_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'Registrant:',
+                'admin' => 'Administrative Contact',
+                'tech' => 'Technical Contact',
+                'zone' => 'Zone Contact',
+                'domain.name' => 'Domain Name:',
+                'domain.changed' => 'Last updated on',
+                'domain.created' => 'Domain created on',
+                'domain.expires' => 'Domain expires on'
+		            );
+		return easy_parser($data_str, $items, 'dmy', false, false, true);
+		}
+	}
+?>

--- a/src/whois.gtld.alldomains.php
+++ b/src/whois.gtld.alldomains.php
@@ -1,39 +1,38 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ALLDOMAINS_HANDLER__'))
-    define('__ALLDOMAINS_HANDLER__', 1);
+	define('__ALLDOMAINS_HANDLER__', 1);
 require_once('whois.parser.php');
-class alldomains_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative',
-            'tech' => 'Technical',
-            'domain.name' => 'Domain name:',
-            'domain.sponsor' => 'Registrar:',
-            'domain.nserver.' => 'Domain servers in listed order:'
-        );
-        return easy_parser($data_str, $items, 'ymd');
-    }
-}
+class alldomains_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner'	=> 'Registrant:',
+                'admin' => 'Administrative',
+                'tech' => 'Technical',
+                'domain.name' => 'Domain name:',
+                'domain.sponsor' => 'Registrar:',
+                'domain.nserver.' => 'Domain servers in listed order:'
+		            );
+		return easy_parser($data_str, $items, 'ymd');
+		}
+	}
+?>

--- a/src/whois.gtld.ascio.php
+++ b/src/whois.gtld.ascio.php
@@ -1,41 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ASCIO_HANDLER__'))
-    define('__ASCIO_HANDLER__', 1);
+	define('__ASCIO_HANDLER__', 1);
 require_once('whois.parser.php');
-class ascio_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative ',
-            'tech' => 'Technical ',
-            'domain.name' => 'Domain name:',
-            'domain.nserver.' => 'Domain servers in listed order:',
-            'domain.created' => 'Record created:',
-            'domain.expires' => 'Record expires:',
-            'domain.changed' => 'Record last updated:'
-        );
-        return easy_parser($data_str, $items, 'ymd', array(), false, true);
-    }
-}
+class ascio_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'Registrant:',
+                'admin' => 'Administrative ',
+                'tech' => 'Technical ',
+                'domain.name' => 'Domain name:',
+                'domain.nserver.' => 'Domain servers in listed order:',
+                'domain.created' => 'Record created:',
+                'domain.expires' => 'Record expires:',
+                'domain.changed' => 'Record last updated:'
+		            );
+		return easy_parser($data_str, $items, 'ymd',false,false,true);
+		}
+	}
+?>

--- a/src/whois.gtld.assorted.php
+++ b/src/whois.gtld.assorted.php
@@ -1,41 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ASSORTED_HANDLER__'))
-    define('__ASSORTED_HANDLER__', 1);
+	define('__ASSORTED_HANDLER__', 1);
 require_once('whois.parser.php');
-class assorted_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'domain.name' => 'Domain Name:',
-            'domain.nserver.' => 'Domain servers in listed order:',
-            'domain.created' => 'Record created on',
-            'domain.expires' => 'Record expires on',
-            'domain.changed' => 'Record last updated'
-        );
-        return easy_parser($data_str, $items, 'ymd', array(), false, true);
-    }
-}
+class assorted_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner'	=> 'Registrant:',
+                'admin' => 'Administrative Contact:',
+                'tech' => 'Technical Contact:',
+                'domain.name' => 'Domain Name:',
+                'domain.nserver.' => 'Domain servers in listed order:',
+                'domain.created' => 'Record created on',
+                'domain.expires' => 'Record expires on',
+                'domain.changed' => 'Record last updated'
+		            );
+		return easy_parser($data_str, $items, 'ymd',false,false,true);
+		}
+	}
+?>

--- a/src/whois.gtld.corporatedomains.php
+++ b/src/whois.gtld.corporatedomains.php
@@ -1,43 +1,42 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__CORPORATEDOMAINS_HANDLER__'))
-    define('__CORPORATEDOMAINS_HANDLER__', 1);
+	define('__CORPORATEDOMAINS_HANDLER__', 1);
 require_once('whois.parser.php');
-class corporatedomains_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical Contact',
-            'zone' => 'Zone Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.changed' => 'Last updated on',
-            'domain.created' => 'Domain created on',
-            'domain.expires' => 'Domain expires on',
-            'domain.sponsor' => 'Registrar Name....:',
-            'domain.nserver' => 'DNS Servers:'
-        );
-        return easy_parser($data_str, $items, 'dmy', array(), false, true);
-    }
-}
+class corporatedomains_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'Registrant:',
+                'admin' => 'Administrative Contact',
+                'tech' => 'Technical Contact',
+                'zone' => 'Zone Contact',
+                'domain.name' => 'Domain Name:',
+                'domain.changed' => 'Last updated on',
+                'domain.created' => 'Domain created on',
+                'domain.expires' => 'Domain expires on',
+                'domain.sponsor' => 'Registrar Name....:',
+                'domain.nserver' => 'DNS Servers:'
+		            );
+		return easy_parser($data_str, $items, 'dmy', false, false, true);
+		}
+	}
+?>

--- a/src/whois.gtld.directnic.php
+++ b/src/whois.gtld.directnic.php
@@ -1,43 +1,42 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__DIRECTNIC_HANDLER__'))
-    define('__DIRECTNIC_HANDLER__', 1);
+	define('__DIRECTNIC_HANDLER__', 1);
 require_once('whois.parser.php');
-class directnic_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.sponsor' => 'Registration Service Provider:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.changed' => 'Record last updated ',
-            'domain.created' => 'Record created on ',
-            'domain.expires' => 'Record expires on ',
-            '' => 'By submitting a WHOIS query'
-        );
-        return easy_parser($data_str, $items, 'mdy', array(), false, true);
-    }
-}
+class directnic_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+              'owner' => 'Registrant:',
+              'admin' => 'Administrative Contact',
+              'tech' => 'Technical Contact',
+              'domain.name' => 'Domain Name:',
+              'domain.sponsor' => 'Registration Service Provider:',
+              'domain.nserver' => 'Domain servers in listed order:',
+              'domain.changed' => 'Record last updated ',
+              'domain.created' => 'Record created on ',
+              'domain.expires' => 'Record expires on ',
+              '' => 'By submitting a WHOIS query'
+		          );
+		return easy_parser($data_str, $items, 'mdy',false,false,true);
+		}
+	}
+?>

--- a/src/whois.gtld.domaindiscover.php
+++ b/src/whois.gtld.domaindiscover.php
@@ -1,41 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__DOMAINDISCOVER_HANDLER__'))
-    define('__DOMAINDISCOVER_HANDLER__', 1);
+	define('__DOMAINDISCOVER_HANDLER__', 1);
 require_once('whois.parser.php');
-class domaindiscover_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical Contact',
-            'zone' => 'Zone Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.changed' => 'Last updated on',
-            'domain.created' => 'Domain created on',
-            'domain.expires' => 'Domain expires on'
-        );
-        return easy_parser($data_str, $items, 'dmy', array(), false, true);
-    }
-}
+class domaindiscover_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'Registrant:',
+                'admin' => 'Administrative Contact',
+                'tech' => 'Technical Contact',
+                'zone' => 'Zone Contact',
+                'domain.name' => 'Domain Name:',
+                'domain.changed' => 'Last updated on',
+                'domain.created' => 'Domain created on',
+                'domain.expires' => 'Domain expires on'
+		            );
+		return easy_parser($data_str, $items, 'dmy', false, false, true);
+		}
+	}
+?>

--- a/src/whois.gtld.domainpeople.php
+++ b/src/whois.gtld.domainpeople.php
@@ -1,46 +1,45 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__DOMAINPEOPLE_HANDLER__'))
-    define('__DOMAINPEOPLE_HANDLER__', 1);
+	define('__DOMAINPEOPLE_HANDLER__', 1);
 require_once('whois.parser.php');
-class domainpeople_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant Contact:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'domain.name' => 'Domain name:',
-            'domain.sponsor' => 'Registration Service Provided By:',
-            'domain.referrer' => 'Contact:',
-            'domain.nserver.' => 'Name Servers:',
-            'domain.created' => 'Creation date:',
-            'domain.expires' => 'Expiration date:',
-            'domain.status' => 'Status:'
-        );
-        $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
-        if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
-            $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
-        return $r;
-    }
-}
+class domainpeople_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant Contact:',
+                  'admin' => 'Administrative Contact:',
+                  'tech' => 'Technical Contact:',
+                  'domain.name' => 'Domain name:',
+                  'domain.sponsor' => 'Registration Service Provided By:',
+                  'domain.referrer' => 'Contact:',
+                  'domain.nserver.' => 'Name Servers:',
+                  'domain.created' => 'Creation date:',
+                  'domain.expires' => 'Expiration date:',
+                  'domain.status' => 'Status:'
+		              );
+		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
+		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
+		$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.dotster.php
+++ b/src/whois.gtld.dotster.php
@@ -1,43 +1,42 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__DOTSTER_HANDLER__'))
-    define('__DOTSTER_HANDLER__', 1);
+	define('__DOTSTER_HANDLER__', 1);
 require_once('whois.parser.php');
-class dotster_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative',
-            'tech' => 'Technical',
-            'domain.nserver' =>
-            'Domain servers in listed order:',
-            'domain.name' => 'Domain name:',
-            'domain.created' => 'Created on:',
-            'domain.expires' => 'Expires on:',
-            'domain.changed' => 'Last Updated on:',
-            'domain.sponsor' => 'Registrar:'
-        );
-        return easy_parser($data_str, $items, 'dmy');
-    }
-}
+class dotster_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant:',
+                  'admin' => 'Administrative',
+                  'tech' => 'Technical',
+                  'domain.nserver' =>
+                  'Domain servers in listed order:',
+                  'domain.name' => 'Domain name:',
+                  'domain.created' => 'Created on:',
+                  'domain.expires' => 'Expires on:',
+                  'domain.changed' => 'Last Updated on:',
+                  'domain.sponsor' => 'Registrar:'
+		              );
+		return easy_parser($data_str, $items, 'dmy');
+		}
+	}
+?>

--- a/src/whois.gtld.dreamhost.php
+++ b/src/whois.gtld.dreamhost.php
@@ -1,44 +1,43 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__DREAMHOST_HANDLER__'))
-    define('__DREAMHOST_HANDLER__', 1);
+	define('__DREAMHOST_HANDLER__', 1);
 require_once('whois.parser.php');
-class dreamhost_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant Contact:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'billing' => 'Billing Contact:',
-            'domain.name' => 'Domain Name:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.created' => 'Record created on',
-            'domain.expires' => 'Record expires on'
-        );
-        $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
-        if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
-            $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
-        return $r;
-    }
-}
+class dreamhost_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant Contact:',
+                  'admin' => 'Administrative Contact:',
+                  'tech' => 'Technical Contact:',
+                  'billing' => 'Billing Contact:',
+                  'domain.name' => 'Domain Name:',
+                  'domain.nserver' => 'Domain servers in listed order:',
+                  'domain.created' => 'Record created on',
+                  'domain.expires' => 'Record expires on'
+		              );
+		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
+		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
+		$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.enom.php
+++ b/src/whois.gtld.enom.php
@@ -1,52 +1,51 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ENOM_HANDLER__'))
-    define('__ENOM_HANDLER__', 1);
+	define('__ENOM_HANDLER__', 1);
 require_once('whois.parser.php');
-class enom_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner#0' => 'Registrant Contact',
-            'owner#1' => 'REGISTRANT Contact:',
-            'admin#0' => 'Administrative Contact',
-            'admin#1' => 'ADMINISTRATIVE Contact:',
-            'tech#0' => 'Technical Contact',
-            'tech#1' => 'TECHNICAL Contact:',
-            'billing#0' => 'Billing Contact',
-            'billing#1' => 'BILLING Contact:',
-            'domain.nserver' => 'Nameservers',
-            'domain.name#0' => 'Domain name:',
-            'domain.name#1' => 'Domain name-',
-            'domain.sponsor' => 'Registration Service Provided By:',
-            'domain.status' => 'Status:',
-            'domain.created#0' => 'Creation date:',
-            'domain.expires#0' => 'Expiration date:',
-            'domain.created#1' => 'Created:',
-            'domain.expires#1' => 'Expires:',
-            'domain.created#2' => 'Start of registration-',
-            'domain.expires#2' => 'Registered through-'
-        );
-        return easy_parser($data_str, $items, 'dmy', array(), false, true);
-    }
-}
+class enom_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner#0'				=> 'Registrant Contact',
+                  'owner#1'				=> 'REGISTRANT Contact:',
+                  'admin#0'				=> 'Administrative Contact',
+                  'admin#1'				=> 'ADMINISTRATIVE Contact:',
+                  'tech#0'				=> 'Technical Contact',
+                  'tech#1'				=> 'TECHNICAL Contact:',
+                  'billing#0'			=> 'Billing Contact',
+                  'billing#1'			=> 'BILLING Contact:',
+                  'domain.nserver'		=> 'Nameservers',
+                  'domain.name#0'		=> 'Domain name:',
+                  'domain.name#1'		=> 'Domain name-',
+                  'domain.sponsor'		=> 'Registration Service Provided By:',
+                  'domain.status'		=> 'Status:',
+                  'domain.created#0'	=> 'Creation date:',
+                  'domain.expires#0'	=> 'Expiration date:',
+                  'domain.created#1'	=> 'Created:',
+                  'domain.expires#1'	=> 'Expires:',
+                  'domain.created#2'	=> 'Start of registration-',
+                  'domain.expires#2'	=> 'Registered through-'
+                  );
+		return easy_parser($data_str, $items, 'dmy', false, false, true);
+		}
+	}
+?>

--- a/src/whois.gtld.fabulous.php
+++ b/src/whois.gtld.fabulous.php
@@ -1,43 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__FABULOUS_HANDLER__'))
-    define('__FABULOUS_HANDLER__', 1);
+	define('__FABULOUS_HANDLER__', 1);
 require_once('whois.parser.php');
-class fabulous_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Domain ' . $query . ':',
-            'admin' => 'Administrative contact:',
-            'tech' => 'Technical contact:',
-            'billing' => 'Billing contact:',
-            '' => 'Record dates:'
-        );
-        $r = easy_parser($data_str, $items, 'mdy', array(), false, true);
-        if (!isset($r['tech']))
-            $r['tech'] = $r['billing'];
-        if (!isset($r['admin']))
-            $r['admin'] = $r['tech'];
-        return $r;
-    }
-}
+class fabulous_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+              'owner' => 'Domain '.$query.':',
+              'admin' => 'Administrative contact:',
+              'tech' => 'Technical contact:',
+              'billing' => 'Billing contact:',
+              '' => 'Record dates:'
+		          );
+		$r = easy_parser($data_str, $items, 'mdy',false,false,true);
+		if (!isset($r['tech'])) $r['tech'] = $r['billing'];
+		if (!isset($r['admin'])) $r['admin'] = $r['tech'];
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.fastdomain.php
+++ b/src/whois.gtld.fastdomain.php
@@ -1,58 +1,62 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__FASTDOMAIN_HANDLER__'))
-    define('__FASTDOMAIN_HANDLER__', 1);
+	define('__FASTDOMAIN_HANDLER__', 1);
 require_once('whois.parser.php');
-class fastdomain_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant Info:',
-            'admin' => 'Administrative Info:',
-            'tech' => 'Technical Info:',
-            'domain.name' => 'Domain Name:',
-            'domain.sponsor' => 'Provider Name....:',
-            'domain.referrer' => 'Provider Homepage:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.created' => 'Created on..............:',
-            'domain.expires' => 'Expires on..............:',
-            'domain.changed' => 'Last modified on........:',
-            'domain.status' => 'Status:'
-        );
-        foreach ($data_str as $key => $val) {
-            $faststr = strpos($val, ' (FAST-');
-            if ($faststr)
-                $data_str[$key] = substr($val, 0, $faststr);
-        }
-        $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
-        if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
-            $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
-        if (isset($r['domain']['nserver'])) {
-            foreach (${$r['domain']['nserver']} as $key => $val) {
-                if ($val === '=-=-=-=')
-                    unset($r['domain']['nserver'][$key]);
-            }
-        }
-        return $r;
-    }
-}
+class fastdomain_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant Info:',
+                  'admin' => 'Administrative Info:',
+                  'tech' => 'Technical Info:',
+                  'domain.name' => 'Domain Name:',
+                  'domain.sponsor' => 'Provider Name....:',
+                  'domain.referrer' => 'Provider Homepage:',
+                  'domain.nserver' => 'Domain servers in listed order:',
+                  'domain.created' => 'Created on..............:',
+                  'domain.expires' => 'Expires on..............:',
+                  'domain.changed' => 'Last modified on........:',
+                  'domain.status' => 'Status:'
+		              );
+		while (list($key, $val) = each($data_str))
+			{
+			$faststr = strpos($val, ' (FAST-');
+			if ($faststr)
+				$data_str[$key] = substr($val, 0, $faststr);
+			}
+		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
+		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
+		$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
+		if (isset($r['domain']['nserver']))
+			{
+			reset($r['domain']['nserver']);
+			$endnserver = false;
+			while (list($key, $val) = each($r['domain']['nserver']))
+				{
+				if ($val == '=-=-=-=')
+					unset($r['domain']['nserver'][$key]);
+				}
+			}
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.gandi.php
+++ b/src/whois.gtld.gandi.php
@@ -1,45 +1,44 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__GANDI_HANDLER__'))
-    define('__GANDI_HANDLER__', 1);
+	define('__GANDI_HANDLER__', 1);
 require_once('whois.parser.php');
-class gandi_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'owner-c',
-            'admin' => 'admin-c',
-            'tech' => 'tech-c',
-            'billing' => 'bill-c'
-        );
-        $trans = array(
-            'nic-hdl:' => 'handle',
-            'person:' => 'name',
-            'zipcode:' => 'address.pcode',
-            'city:' => 'address.city',
-            'lastupdated:' => 'changed',
-            'owner-name:' => ''
-        );
-        return easy_parser($data_str, $items, 'dmy', $trans);
-    }
-}
+class gandi_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'owner-c',
+                  'admin' => 'admin-c',
+                  'tech' => 'tech-c',
+                  'billing' => 'bill-c'
+		              );
+		$trans = array(
+					'nic-hdl:'	=> 'handle',
+					'person:'	=> 'name',
+					'zipcode:'	=> 'address.pcode',
+					'city:'		=> 'address.city',
+					'lastupdated:' => 'changed',
+					'owner-name:' => ''
+					);
+		return easy_parser($data_str, $items, 'dmy', $trans);
+		}
+	}
+?>

--- a/src/whois.gtld.genericb.php
+++ b/src/whois.gtld.genericb.php
@@ -1,31 +1,30 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
 if (!defined('__GENERICB_HANDLER__'))
-    define('__GENERICB_HANDLER__', 1);
+	define('__GENERICB_HANDLER__', 1);
 require_once('whois.parser.php');
-class genericb_handler {
-    function parse($data_str, $query) {
-        return generic_parser_b($data_str);
-    }
-}
+class genericb_handler
+	{
+	function parse($data_str, $query)
+		{
+		return generic_parser_b($data_str);
+		}
+	}
+?>

--- a/src/whois.gtld.godaddy.php
+++ b/src/whois.gtld.godaddy.php
@@ -1,46 +1,45 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__GODADDY_HANDLER__'))
-    define('__GODADDY_HANDLER__', 1);
+	define('__GODADDY_HANDLER__', 1);
 require_once('whois.parser.php');
-class godaddy_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.nserver.' => 'Domain servers in listed order:',
-            'domain.created' => 'Created on:',
-            'domain.expires' => 'Expires on:',
-            'domain.changed' => 'Last Updated on:',
-            'domain.sponsor' => 'Registered through:'
-        );
-        $r = get_blocks($data_str, $items);
-        $r['owner'] = get_contact($r['owner']);
-        $r['admin'] = get_contact($r['admin'], array(), true);
-        $r['tech'] = get_contact($r['tech'], array(), true);
-        return format_dates($r, 'dmy');
-    }
-}
+class godaddy_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant:',
+                  'admin' => 'Administrative Contact',
+                  'tech' => 'Technical Contact',
+                  'domain.name' => 'Domain Name:',
+                  'domain.nserver.' => 'Domain servers in listed order:',
+                  'domain.created' => 'Created on:',
+                  'domain.expires' => 'Expires on:',
+                  'domain.changed' => 'Last Updated on:',
+                  'domain.sponsor' => 'Registered through:'
+		              );
+		$r = get_blocks($data_str, $items);
+		$r['owner'] = get_contact($r['owner']);
+		$r['admin'] = get_contact($r['admin'],false,true);
+		$r['tech'] = get_contact($r['tech'],false,true);
+		return format_dates($r, 'dmy');
+		}
+	}
+?>

--- a/src/whois.gtld.iana.php
+++ b/src/whois.gtld.iana.php
@@ -1,41 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__IANA_HANDLER__'))
-    define('__IANA_HANDLER__', 1);
+	define('__IANA_HANDLER__', 1);
 require_once('whois.parser.php');
-class iana_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'admin' => 'contact:      administrative',
-            'tech' => 'contact:      technical',
-            'domain.nserver.' => 'nserver:',
-            'domain.created' => 'created:',
-            'domain.changed' => 'changed:',
-            'domain.source' => 'source:',
-            'domain.name' => 'domain:',
-            'disclaimer.' => '% '
-        );
-        return easy_parser($data_str, $items, 'Ymd', array(), false, false, 'owner');
-    }
-}
+class iana_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'admin' => 'contact:      administrative',
+                  'tech' => 'contact:      technical',
+                  'domain.nserver.' => 'nserver:',
+                  'domain.created' => 'created:',
+                  'domain.changed' => 'changed:',
+                  'domain.source' => 'source:',
+                  'domain.name' => 'domain:',
+                  'disclaimer.' => '% '
+		              );
+		return easy_parser($data_str,$items,'Ymd',false,false,false,'owner');
+		}
+	}
+?>

--- a/src/whois.gtld.interdomain.php
+++ b/src/whois.gtld.interdomain.php
@@ -1,70 +1,69 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__INTERDOMAIN_HANDLER__'))
-    define('__INTERDOMAIN_HANDLER__', 1);
+	define('__INTERDOMAIN_HANDLER__', 1);
 require_once('whois.parser.php');
-class interdomain_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'Domain Name................' => 'domain.name',
-            'Creation Date............' => 'domain.created',
-            'Expiry Date..............' => 'domain.expires',
-            'Last Update Date.........' => 'domain.changed',
-            'Name Server.............' => 'domain.nserver.',
-            'Organization Name........' => 'owner.name',
-            'Organization Org.........' => 'owner.organization',
-            'Organization Street......' => 'owner.address.street',
-            'Organization City........' => 'owner.address.city',
-            'Organization State.......' => 'owner.address.state',
-            'Organization PC..........' => 'owner.address.pcode',
-            'Organization Country.....' => 'owner.address.country',
-            'Organization Phone.......' => 'owner.phone',
-            'Organization e-mail......' => 'owner.email',
-            'Organization Contact Id....' => 'owner.handle',
-            'Administrative Contact Id..' => 'admin.handle',
-            'Administrative Name......' => 'admin.name',
-            'Administrative Org.......' => 'admin.organization',
-            'Administrative Street....' => 'admin.address.street',
-            'Administrative City......' => 'admin.address.city',
-            'Administrative State.....' => 'admin.address.state',
-            'Administrative PC........' => 'admin.address.pcode',
-            'Administrative Country...' => 'admin.address.country',
-            'Administrative Phone.....' => 'admin.phone',
-            'Administrative e-mail....' => 'admin.email',
-            'Administrative Fax.......' => 'admin.fax',
-            'Technical Contact Id.......' => 'tech.handle',
-            'Technical Name...........' => 'tech.name',
-            'Technical Org............' => 'tech.organization',
-            'Technical Street.........' => 'tech.address.street',
-            'Technical City...........' => 'tech.address.city',
-            'Technical State..........' => 'tech.address.state',
-            'Technical PC.............' => 'tech.address.pcode',
-            'Technical Country........' => 'tech.address.country',
-            'Technical Phone..........' => 'tech.phone',
-            'Technical e-mail.........' => 'tech.email',
-            'Technical Fax............' => 'tech.fax'
-        );
-        return generic_parser_b($data_str, $items, 'dmy');
-    }
-}
+class interdomain_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                    'Domain Name................' => 'domain.name',
+                    'Creation Date............' => 'domain.created',
+                    'Expiry Date..............' => 'domain.expires',
+                    'Last Update Date.........' => 'domain.changed',
+                    'Name Server.............' => 'domain.nserver.',
+                    'Organization Name........' => 'owner.name',
+                    'Organization Org.........' => 'owner.organization',
+                    'Organization Street......' => 'owner.address.street',
+                    'Organization City........' => 'owner.address.city',
+                    'Organization State.......' => 'owner.address.state',
+                    'Organization PC..........' => 'owner.address.pcode',
+                    'Organization Country.....' => 'owner.address.country',
+                    'Organization Phone.......' => 'owner.phone',
+                    'Organization e-mail......' => 'owner.email',
+                    'Organization Contact Id....' => 'owner.handle',
+                    'Administrative Contact Id..' => 'admin.handle',
+                    'Administrative Name......' => 'admin.name',
+                    'Administrative Org.......' => 'admin.organization',
+                    'Administrative Street....' => 'admin.address.street',
+                    'Administrative City......' => 'admin.address.city',
+                    'Administrative State.....' => 'admin.address.state',
+                    'Administrative PC........' => 'admin.address.pcode',
+                    'Administrative Country...' => 'admin.address.country',
+                    'Administrative Phone.....' => 'admin.phone',
+                    'Administrative e-mail....' => 'admin.email',
+                    'Administrative Fax.......' => 'admin.fax',
+                    'Technical Contact Id.......' => 'tech.handle',
+                    'Technical Name...........' => 'tech.name',
+                    'Technical Org............' => 'tech.organization',
+                    'Technical Street.........' => 'tech.address.street',
+                    'Technical City...........' => 'tech.address.city',
+                    'Technical State..........' => 'tech.address.state',
+                    'Technical PC.............' => 'tech.address.pcode',
+                    'Technical Country........' => 'tech.address.country',
+                    'Technical Phone..........' => 'tech.phone',
+                    'Technical e-mail.........' => 'tech.email',
+                    'Technical Fax............' => 'tech.fax'
+		              );
+		return generic_parser_b($data_str, $items, 'dmy');
+		}
+	}
+?>

--- a/src/whois.gtld.itsyourdomain.php
+++ b/src/whois.gtld.itsyourdomain.php
@@ -1,42 +1,41 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ITSYOURDOMAIN_HANDLER__'))
-    define('__ITSYOURDOMAIN_HANDLER__', 1);
+	define('__ITSYOURDOMAIN_HANDLER__', 1);
 require_once('whois.parser.php');
-class itsyourdomain_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant',
-            'admin' => 'Administrative',
-            'tech' => 'Technical',
-            'billing' => 'Billing',
-            'domain.name' => 'Domain:',
-            'domain.nserver.' => 'Domain Name Servers:',
-            'domain.created' => 'Record created on ',
-            'domain.expires' => 'Record expires on ',
-            'domain.changed' => 'Record last updated on '
-        );
-        return easy_parser($data_str, $items, 'mdy');
-    }
-}
+class itsyourdomain_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'Registrant',
+                'admin' => 'Administrative',
+                'tech' => 'Technical',
+                'billing' => 'Billing',
+                'domain.name' => 'Domain:',
+                'domain.nserver.' => 'Domain Name Servers:',
+                'domain.created' => 'Record created on ',
+                'domain.expires' => 'Record expires on ',
+                'domain.changed' => 'Record last updated on '
+		            );
+		return easy_parser($data_str, $items, 'mdy');
+		}
+	}
+?>

--- a/src/whois.gtld.joker.php
+++ b/src/whois.gtld.joker.php
@@ -1,62 +1,63 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__JOKER_HANDLER__'))
-    define('__JOKER_HANDLER__', 1);
+	define('__JOKER_HANDLER__', 1);
 require_once('whois.parser.php');
-class joker_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'contact-hdl' => 'handle',
-            'modified' => 'changed',
-            'reseller' => 'sponsor',
-            'address' => 'address.street',
-            'postal-code' => 'address.pcode',
-            'city' => 'address.city',
-            'state' => 'address.state',
-            'country' => 'address.country',
-            'person' => 'name',
-            'domain' => 'name'
-        );
-        $contacts = array(
-            'admin-c' => 'admin',
-            'tech-c' => 'tech',
-            'billing-c' => 'billing'
-        );
-        $items = array(
-            'owner' => 'name',
-            'organization' => 'organization',
-            'email' => 'email',
-            'phone' => 'phone',
-            'address' => 'address',
-        );
-        $r = generic_parser_a($data_str, $translate, $contacts, 'domain', 'Ymd');
-        foreach ($items as $tag => $convert) {
-            if (isset($r['domain'][$tag])) {
-                $r['owner'][$convert] = $r['domain'][$tag];
-                unset($r['domain'][$tag]);
-            }
-        }
-        return $r;
-    }
-}
+class joker_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+				'contact-hdl'	=> 'handle',
+				'modified'		=> 'changed',
+				'reseller' 		=> 'sponsor',
+				'address' 		=> 'address.street',
+				'postal-code' 	=> 'address.pcode',
+                'city' 			=> 'address.city',
+                'state' 		=> 'address.state',
+				'country' 		=> 'address.country',
+				'person'		=> 'name',
+				'domain'		=> 'name'
+				);
+		$contacts = array(
+				'admin-c' 	=> 'admin',
+				'tech-c' 	=> 'tech',
+				'billing-c' => 'billing'
+				);
+		$items = array(
+                'owner' 		=> 'name',
+				'organization' 	=> 'organization',
+				'email'			=> 'email',
+				'phone' 		=> 'phone',
+                'address' 		=> 'address',
+		            );
+		$r = generic_parser_a($data_str, $translate, $contacts, 'domain', 'Ymd');
+		foreach($items as $tag => $convert)
+			{
+			if (isset($r['domain'][$tag]))
+				{
+				$r['owner'][$convert] = $r['domain'][$tag];
+				unset($r['domain'][$tag]);
+				}
+			}
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.markmonitor.php
+++ b/src/whois.gtld.markmonitor.php
@@ -1,51 +1,52 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__MARKMONITOR_HANDLER__'))
-    define('__MARKMONITOR_HANDLER__', 1);
+	define('__MARKMONITOR_HANDLER__', 1);
 require_once('whois.parser.php');
-class markmonitor_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact, Zone Contact:',
-            'domain.name' => 'Domain Name:',
-            'domain.sponsor' => 'Registrar Name:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.created' => 'Created on..............:',
-            'domain.expires' => 'Expires on..............:',
-            'domain.changed' => 'Record last updated on..:'
-        );
-        $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
-        if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
-            $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
-        foreach ($r as $key => $part) {
-            if (isset($part['address'])) {
-                $r[$key]['organization'] = array_shift($r[$key]['address']);
-                $r[$key]['address']['country'] = array_pop($r[$key]['address']);
-            }
-        }
-        return $r;
-    }
-}
+class markmonitor_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant:',
+                  'admin' => 'Administrative Contact:',
+                  'tech' => 'Technical Contact, Zone Contact:',
+                  'domain.name' => 'Domain Name:',
+                  'domain.sponsor' => 'Registrar Name:',
+                  'domain.nserver' => 'Domain servers in listed order:',
+                  'domain.created' => 'Created on..............:',
+                  'domain.expires' => 'Expires on..............:',
+                  'domain.changed' => 'Record last updated on..:'
+		              );
+		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
+		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
+			$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
+		foreach($r as $key => $part)
+			{
+			if (isset($part['address']))
+				{
+				$r[$key]['organization'] = array_shift($r[$key]['address']);
+				$r[$key]['address']['country'] = array_pop($r[$key]['address']);
+				}
+			}
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.melbourneit.php
+++ b/src/whois.gtld.melbourneit.php
@@ -1,49 +1,48 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__MELBOURNEIT_HANDLER__'))
-    define('__MELBOURNEIT_HANDLER__', 1);
-class melbourneit_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'Domain Name..........' => 'domain.name',
-            'Registration Date....' => 'domain.created',
-            'Expiry Date..........' => 'domain.expires',
-            'Organisation Name....' => 'owner.name',
-            'Organisation Address.' => 'owner.address.',
-            'Admin Name...........' => 'admin.name',
-            'Admin Address........' => 'admin.address.',
-            'Admin Email..........' => 'admin.email',
-            'Admin Phone..........' => 'admin.phone',
-            'Admin Fax............' => 'admin.fax',
-            'Tech Name............' => 'tech.name',
-            'Tech Address.........' => 'tech.address.',
-            'Tech Email...........' => 'tech.email',
-            'Tech Phone...........' => 'tech.phone',
-            'Tech Fax.............' => 'tech.fax',
-            'Name Server..........' => 'domain.nserver.'
-        );
-        return generic_parser_b($data_str, $items, 'ymd');
-    }
-}
+	define('__MELBOURNEIT_HANDLER__', 1);
+class melbourneit_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'Domain Name..........' => 'domain.name',
+                  'Registration Date....' => 'domain.created',
+                  'Expiry Date..........' => 'domain.expires',
+                  'Organisation Name....' => 'owner.name',
+                  'Organisation Address.' => 'owner.address.',
+                  'Admin Name...........' => 'admin.name',
+                  'Admin Address........' => 'admin.address.',
+                  'Admin Email..........' => 'admin.email',
+                  'Admin Phone..........' => 'admin.phone',
+                  'Admin Fax............' => 'admin.fax',
+                  'Tech Name............' => 'tech.name',
+                  'Tech Address.........' => 'tech.address.',
+                  'Tech Email...........' => 'tech.email',
+                  'Tech Phone...........' => 'tech.phone',
+                  'Tech Fax.............' => 'tech.fax',
+                  'Name Server..........' => 'domain.nserver.'
+		              );
+		return generic_parser_b($data_str, $items, 'ymd');
+		}
+	}
+?>

--- a/src/whois.gtld.moniker.php
+++ b/src/whois.gtld.moniker.php
@@ -1,42 +1,41 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__MONIKER_HANDLER__'))
-    define('__MONIKER_HANDLER__', 1);
+	define('__MONIKER_HANDLER__', 1);
 require_once('whois.parser.php');
-class moniker_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant',
-            'admin' => 'Administrative ',
-            'tech' => 'Technical ',
-            'billing' => 'Billing ',
-            'domain.name' => 'Domain Name:',
-            'domain.nserver.' => 'Domain servers in listed order:',
-            'domain.created' => 'Record created on: ',
-            'domain.expires' => 'Domain Expires on: ',
-            'domain.changed' => 'Database last updated on: '
-        );
-        return easy_parser($data_str, $items, 'ymd');
-    }
-}
+class moniker_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant',
+                  'admin' => 'Administrative ',
+                  'tech' => 'Technical ',
+                  'billing' => 'Billing ',
+                  'domain.name' => 'Domain Name:',
+                  'domain.nserver.' => 'Domain servers in listed order:',
+                  'domain.created' => 'Record created on: ',
+                  'domain.expires' => 'Domain Expires on: ',
+                  'domain.changed' => 'Database last updated on: '
+		              );
+		return easy_parser($data_str, $items, 'ymd');
+		}
+	}
+?>

--- a/src/whois.gtld.name.php
+++ b/src/whois.gtld.name.php
@@ -1,45 +1,44 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NAME_HANDLER__'))
-    define('__NAME_HANDLER__', 1);
+	define('__NAME_HANDLER__', 1);
 require_once('whois.parser.php');
-class name_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'REGISTRANT CONTACT INFO',
-            'admin' => 'ADMINISTRATIVE CONTACT INFO',
-            'tech' => 'TECHNICAL CONTACT INFO',
-            'billing' => 'BILLING CONTACT INFO',
-            'domain.name' => 'Domain Name:',
-            'domain.sponsor' => 'Registrar',
-            'domain.created' => 'Creation Date',
-            'domain.expires' => 'Expiration Date'
-        );
-        $extra = array(
-            'phone:' => 'phone',
-            'email address:' => 'email'
-        );
-        return easy_parser($data_str, $items, 'y-m-d', $extra, false, true);
-    }
-}
+class name_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'REGISTRANT CONTACT INFO',
+                'admin' => 'ADMINISTRATIVE CONTACT INFO',
+                'tech' => 'TECHNICAL CONTACT INFO',
+                'billing' => 'BILLING CONTACT INFO',
+                'domain.name' => 'Domain Name:',
+                'domain.sponsor' => 'Registrar',
+                'domain.created' => 'Creation Date',
+                'domain.expires' => 'Expiration Date'
+		            );
+		$extra = array(
+						'phone:' => 'phone',
+						'email address:' => 'email'
+						);
+		return easy_parser($data_str, $items, 'y-m-d', $extra, false, true);
+		}
+	}
+?>

--- a/src/whois.gtld.nameintel.php
+++ b/src/whois.gtld.nameintel.php
@@ -1,50 +1,51 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NAMEINTEL_HANDLER__'))
-    define('__NAMEINTEL_HANDLER__', 1);
+	define('__NAMEINTEL_HANDLER__', 1);
 require_once('whois.parser.php');
-class nameintel_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant Contact:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.status' => 'Status:',
-            'domain.nserver' => 'Name Server:',
-            'domain.created' => 'Creation Date:',
-            'domain.expires' => 'Expiration Date:'
-        );
-        $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
-        if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
-            $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
-        foreach ($r as $key => $part) {
-            if (isset($part['address'])) {
-                $r[$key]['organization'] = array_shift($r[$key]['address']);
-                $r[$key]['address']['country'] = array_pop($r[$key]['address']);
-            }
-        }
-        return $r;
-    }
-}
+class nameintel_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant Contact:',
+                  'admin' => 'Administrative Contact:',
+                  'tech' => 'Technical Contact',
+                  'domain.name' => 'Domain Name:',
+                  'domain.status' => 'Status:',
+                  'domain.nserver' => 'Name Server:',
+                  'domain.created' => 'Creation Date:',
+                  'domain.expires' => 'Expiration Date:'
+		              );
+		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
+		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
+			$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
+		foreach($r as $key => $part)
+			{
+			if (isset($part['address']))
+				{
+				$r[$key]['organization'] = array_shift($r[$key]['address']);
+				$r[$key]['address']['country'] = array_pop($r[$key]['address']);
+				}
+			}
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.namejuice.php
+++ b/src/whois.gtld.namejuice.php
@@ -1,43 +1,42 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NAMEJUICE_HANDLER__'))
-    define('__NAMEJUICE_HANDLER__', 1);
+        define('__NAMEJUICE_HANDLER__', 1);
 require_once('whois.parser.php');
-class namejuice_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant Contact:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'domain.name' => 'Domain name:',
-            'domain.nserver.' => 'Name Servers:',
-            'domain.created' => 'Creation date:',
-            'domain.expires' => 'Expiration date:',
-            'domain.changed' => 'Update date:',
-            'domain.status' => 'Status:',
-            'domain.sponsor' => 'Registration Service Provided By:'
-        );
-        return easy_parser($data_str, $items, 'dmy', array(), true, true);
-    }
-}
+class namejuice_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+					'owner' => 'Registrant Contact:',
+					'admin' => 'Administrative Contact:',
+					'tech' => 'Technical Contact:',
+					'domain.name' => 'Domain name:',
+					'domain.nserver.' => 'Name Servers:',
+					'domain.created' => 'Creation date:',
+					'domain.expires' => 'Expiration date:',
+					'domain.changed' => 'Update date:',
+					'domain.status' => 'Status:',
+					'domain.sponsor' => 'Registration Service Provided By:'
+				);
+		return easy_parser($data_str, $items, 'dmy', false, true, true);
+		}
+	}
+?>

--- a/src/whois.gtld.nameking.php
+++ b/src/whois.gtld.nameking.php
@@ -1,59 +1,58 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NAMEKING_HANDLER__'))
-    define('__NAMEKING_HANDLER__', 1);
+	define('__NAMEKING_HANDLER__', 1);
 require_once('whois.parser.php');
-class nameking_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant',
-            'admin' => 'Admin Contact',
-            'tech' => 'Tech Contact',
-            'billing' => 'Billing Contact',
-            'domain.sponsor' => 'Registration Provided By:',
-            'domain.created' => 'Creation Date:',
-            'domain.expires' => 'Expiration Date:',
-        );
-        $extra = array(
-            'tel--' => 'phone',
-            'tel:' => 'phone',
-            'tel --:' => 'phone',
-            'email-:' => 'email',
-            'email:' => 'email',
-            'mail:' => 'email',
-            'name--' => 'name',
-            'org:' => 'organization',
-            'zipcode:' => 'address.pcode',
-            'postcode:' => 'address.pcode',
-            'address:' => 'address.street',
-            'city:' => 'address.city',
-            'province:' => 'address.city.',
-            ',province:' => '',
-            ',country:' => 'address.country',
-            'organization:' => 'organization',
-            'city, province, post code:' => 'address.city'
-        );
-        return easy_parser($data_str, $items, 'mdy', $extra, false, true);
-    }
-}
+class nameking_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant',
+                  'admin' => 'Admin Contact',
+                  'tech' => 'Tech Contact',
+                  'billing' => 'Billing Contact',
+                  'domain.sponsor' => 'Registration Provided By:',
+                  'domain.created' => 'Creation Date:',
+                  'domain.expires' => 'Expiration Date:',
+		              );
+		$extra = array(
+					'tel--' => 'phone',
+					'tel:' => 'phone',
+					'tel --:' => 'phone',
+					'email-:' => 'email',
+					'email:' => 'email',
+					'mail:' => 'email',
+					'name--' => 'name',
+					'org:' => 'organization',
+					'zipcode:' => 'address.pcode',
+					'postcode:' => 'address.pcode',
+					'address:' => 'address.street',
+					'city:' => 'address.city',
+					'province:' => 'address.city.',
+					',province:' => '',
+					',country:' => 'address.country',
+					'organization:' => 'organization',
+					'city, province, post code:' => 'address.city'
+					);
+		return easy_parser($data_str, $items, 'mdy', $extra, false, true);
+		}
+	}
+?>

--- a/src/whois.gtld.names4ever.php
+++ b/src/whois.gtld.names4ever.php
@@ -1,44 +1,43 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NAMES4EVER_HANDLER__'))
-    define('__NAMES4EVER_HANDLER__', 1);
+	define('__NAMES4EVER_HANDLER__', 1);
 require_once('whois.parser.php');
-class names4ever_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical  Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.sponsor' => 'Registrar Name....:',
-            'domain.referrer' => 'Registrar Homepage:',
-            'domain.nserver' => 'DNS Servers:',
-            'domain.created' => 'Record created on',
-            'domain.expires' => 'Record expires on',
-            'domain.changed' => 'Record last updated on',
-            'domain.status' => 'Domain status:'
-        );
-        return easy_parser($data_str, $items, 'dmy', array(), false, true);
-    }
-}
+class names4ever_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant:',
+                  'admin' => 'Administrative Contact',
+                  'tech' => 'Technical  Contact',
+                  'domain.name' => 'Domain Name:',
+                  'domain.sponsor' => 'Registrar Name....:',
+                  'domain.referrer' => 'Registrar Homepage:',
+                  'domain.nserver' => 'DNS Servers:',
+                  'domain.created' => 'Record created on',
+                  'domain.expires' => 'Record expires on',
+                  'domain.changed' => 'Record last updated on',
+                  'domain.status' => 'Domain status:'
+		              );
+		return easy_parser($data_str, $items, 'dmy', false, false, true);
+		}
+	}
+?>

--- a/src/whois.gtld.namevault.php
+++ b/src/whois.gtld.namevault.php
@@ -1,42 +1,41 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NAMEVAULT_HANDLER__'))
-    define('__NAMEVAULT_HANDLER__', 1);
+	define('__NAMEVAULT_HANDLER__', 1);
 require_once('whois.parser.php');
-class namevault_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'billing' => 'Billing Contact:',
-            'domain.name' => 'Domain Name:',
-            'domain.nserver.' => 'Name Servers',
-            'domain.created' => 'Creation Date:',
-            'domain.expires' => 'Expiration Date:',
-            'domain.status' => 'Status:'
-        );
-        return easy_parser($data_str, $items, 'dmy', array(), true, true);
-    }
-}
+class namevault_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'Registrant',
+                'admin' => 'Administrative Contact:',
+                'tech' => 'Technical Contact:',
+                'billing' => 'Billing Contact:',
+                'domain.name' => 'Domain Name:',
+                'domain.nserver.' => 'Name Servers',
+				'domain.created' => 'Creation Date:',
+                'domain.expires' =>	'Expiration Date:',
+                'domain.status' => 'Status:'
+		            );
+		return easy_parser($data_str, $items, 'dmy', false, true, true);
+		}
+	}
+?>

--- a/src/whois.gtld.networksolutions.php
+++ b/src/whois.gtld.networksolutions.php
@@ -1,40 +1,39 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NETWORKSOLUTIONS_HANDLER__'))
-    define('__NETWORKSOLUTIONS_HANDLER__', 1);
+	define('__NETWORKSOLUTIONS_HANDLER__', 1);
 require_once('whois.parser.php');
-class networksolutions_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.nserver.' => 'Domain servers in listed order:',
-            'domain.created' => 'Record created on',
-            'domain.expires' => 'Record expires on'
-        );
-        return easy_parser($data_str, $items, 'dmy', array(), true, true);
-    }
-}
+class networksolutions_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner'			=> 'Registrant:',
+                  'admin'			=> 'Administrative Contact',
+                  'tech'			=> 'Technical Contact',
+                  'domain.name'		=> 'Domain Name:',
+                  'domain.nserver.'	=> 'Domain servers in listed order:',
+                  'domain.created'	=> 'Record created on',
+                  'domain.expires'	=> 'Record expires on'
+		              );
+		return easy_parser($data_str, $items, 'dmy',false,true,true);
+		}
+	}
+?>

--- a/src/whois.gtld.nicco.php
+++ b/src/whois.gtld.nicco.php
@@ -1,51 +1,50 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NICCO_HANDLER__'))
-    define('__NICCO_HANDLER__', 1);
+	define('__NICCO_HANDLER__', 1);
 require_once('whois.parser.php');
-class nicco_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Holder Contact',
-            'admin' => 'Admin Contact',
-            'tech' => 'Tech. Contact',
-            'domain.nserver.' => 'Nameservers',
-            'domain.created' => 'Creation Date:',
-            'domain.expires' => 'Expiration Date:'
-        );
-        $translate = array(
-            'city:' => 'address.city',
-            'org. name:' => 'organization',
-            'address1:' => 'address.street.',
-            'address2:' => 'address.street.',
-            'state:' => 'address.state',
-            'postal code:' => 'address.zip'
-        );
-        $r = get_blocks($data_str, $items, true);
-        $r['owner'] = get_contact($r['owner'], $translate);
-        $r['admin'] = get_contact($r['admin'], $translate, true);
-        $r['tech'] = get_contact($r['tech'], $translate, true);
-        return format_dates($r, 'dmy');
-    }
-}
+class nicco_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Holder Contact',
+                  'admin' => 'Admin Contact',
+                  'tech' => 'Tech. Contact',
+                  'domain.nserver.' => 'Nameservers',
+                  'domain.created' => 'Creation Date:',
+                  'domain.expires' => 'Expiration Date:'
+		              );
+		$translate = array(
+					'city:'			=> 'address.city',
+					'org. name:'	=> 'organization',
+					'address1:'		=> 'address.street.',
+					'address2:'		=> 'address.street.',
+					'state:'		=> 'address.state',
+					'postal code:'	=> 'address.zip'
+					);
+		$r = get_blocks($data_str, $items, true);
+		$r['owner'] = get_contact($r['owner'],$translate);
+		$r['admin'] = get_contact($r['admin'],$translate,true);
+		$r['tech'] = get_contact($r['tech'],$translate,true);
+		return format_dates($r, 'dmy');
+		}
+	}
+?>

--- a/src/whois.gtld.nicline.php
+++ b/src/whois.gtld.nicline.php
@@ -1,41 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NICLINE_HANDLER__'))
-    define('__NICLINE_HANDLER__', 1);
+	define('__NICLINE_HANDLER__', 1);
 require_once('whois.parser.php');
-class nicline_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative contact:',
-            'tech' => 'Technical contact:',
-            'domain.name' => 'Domain name:',
-            'domain.nserver.' => 'Domain servers in listed order:',
-            'domain.created' => 'Created:',
-            'domain.expires' => 'Expires:',
-            'domain.changed' => 'Last updated:'
-        );
-        return easy_parser($data_str, $items, 'dmy');
-    }
-}
+class nicline_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+				'owner' => 'Registrant:',
+				'admin' => 'Administrative contact:',
+				'tech' => 'Technical contact:',
+				'domain.name' => 'Domain name:',
+				'domain.nserver.' => 'Domain servers in listed order:',
+				'domain.created' => 'Created:',
+				'domain.expires' => 'Expires:',
+				'domain.changed' => 'Last updated:'
+		              );
+		return easy_parser($data_str, $items, 'dmy');
+		}
+	}
+?>

--- a/src/whois.gtld.onlinenic.php
+++ b/src/whois.gtld.onlinenic.php
@@ -1,70 +1,69 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ONLINENIC_HANDLER__'))
-    define('__ONLINENIC_HANDLER__', 1);
+	define('__ONLINENIC_HANDLER__', 1);
 require_once('whois.parser.php');
-class onlinenic_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrator:',
-            'tech' => 'Technical Contactor:',
-            'billing' => 'Billing Contactor:',
-            'domain.name' => 'Domain name:',
-            'domain.name#' => 'Domain Name:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.created' => 'Record created on ',
-            'domain.expires' => 'Record expired on ',
-            'domain.changed' => 'Record last updated at '
-        );
-        $extra = array(
-            'tel--' => 'phone',
-            'tel:' => 'phone',
-            'tel --:' => 'phone',
-            'email-:' => 'email',
-            'email:' => 'email',
-            'mail:' => 'email',
-            'name--' => 'name',
-            'org:' => 'organization',
-            'zipcode:' => 'address.pcode',
-            'postcode:' => 'address.pcode',
-            'address:' => 'address.street',
-            'city:' => 'address.city',
-            'province:' => '',
-            ',province:' => '',
-            ',country:' => 'address.country'
-        );
-        $r = easy_parser($data_str, $items, 'mdy', $extra, false, true);
-        foreach ($r as $key => $part)
-            if (isset($part['email'])) {
-                @list($email, $phone) = explode(' ', $part['email']);
-                $email = str_replace('(', '', $email);
-                $email = str_replace(')', '', $email);
-                $r[$key]['email'] = $email;
-                if ($phone != '')
-                    $r[$key]['phone'] = $phone;
-            }
-        return $r;
-    }
-}
+class onlinenic_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant:',
+                  'admin' => 'Administrator:',
+                  'tech' => 'Technical Contactor:',
+                  'billing' => 'Billing Contactor:',
+                  'domain.name' => 'Domain name:',
+                  'domain.name#' => 'Domain Name:',
+                  'domain.nserver' => 'Domain servers in listed order:',
+                  'domain.created' => 'Record created on ',
+                  'domain.expires' => 'Record expired on ',
+                  'domain.changed' => 'Record last updated at '
+		              );
+		$extra = array(
+					'tel--' => 'phone',
+					'tel:' => 'phone',
+					'tel --:' => 'phone',
+					'email-:' => 'email',
+					'email:' => 'email',
+					'mail:' => 'email',
+					'name--' => 'name',
+					'org:' => 'organization',
+					'zipcode:' => 'address.pcode',
+					'postcode:' => 'address.pcode',
+					'address:' => 'address.street',
+					'city:' => 'address.city',
+					'province:' => '',
+					',province:' => '',
+					',country:' => 'address.country'
+					);
+		$r = easy_parser($data_str, $items, 'mdy',$extra,false,true);
+		foreach($r as $key => $part)
+			if (isset($part['email']))
+				{
+				@list($email,$phone) = explode(' ',$part['email']);
+				$email = str_replace('(','',$email);
+				$email = str_replace(')','',$email);
+				$r[$key]['email'] = $email;
+				if ($phone != '') $r[$key]['phone'] = $phone;
+				}
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.opensrs.php
+++ b/src/whois.gtld.opensrs.php
@@ -1,46 +1,45 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__OPENSRS_HANDLER__'))
-    define('__OPENSRS_HANDLER__', 1);
+	define('__OPENSRS_HANDLER__', 1);
 require_once('whois.parser.php');
-class opensrs_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical Contact',
-            'domain.name' => 'Domain name:',
-            '' => 'Registration Service Provider:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.changed' => 'Record last updated on',
-            'domain.created' => 'Record created on',
-            'domain.expires' => 'Record expires on',
-            'domain.sponsor' => 'Registrar of Record:'
-        );
-        $r = easy_parser($data_str, $items, 'dmy', array(), false, true);
-        if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
-            $r['domain']['sponsor'] = $r['domain']['sponsor'][0];
-        return $r;
-    }
-}
+class opensrs_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner'			=> 'Registrant:',
+                  'admin'			=> 'Administrative Contact',
+                  'tech'			=> 'Technical Contact',
+                  'domain.name'		=> 'Domain name:',
+                  ''	=> 'Registration Service Provider:',
+                  'domain.nserver'	=> 'Domain servers in listed order:',
+                  'domain.changed'	=> 'Record last updated on',
+                  'domain.created'	=> 'Record created on',
+                  'domain.expires'	=> 'Record expires on',
+                  'domain.sponsor'	=> 'Registrar of Record:'
+		              );
+		$r = easy_parser($data_str, $items, 'dmy', false, false, true);
+		if (isset($r['domain']['sponsor']) && is_array($r['domain']['sponsor']))
+			$r['domain']['sponsor'] = $r['domain']['sponsor'][0];
+		return $r;
+		}
+	}
+?>

--- a/src/whois.gtld.ovh.php
+++ b/src/whois.gtld.ovh.php
@@ -1,41 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__OVH_HANDLER__'))
-    define('__OVH_HANDLER__', 1);
+	define('__OVH_HANDLER__', 1);
 require_once('whois.parser.php');
-class ovh_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'billing' => 'Billing Contact:',
-            'domain.sponsor' => 'Registrar of Record:',
-            'domain.changed' => 'Record last updated on',
-            'domain.expires' => 'Record expires on',
-            'domain.created' => 'Record created on'
-        );
-        return easy_parser($data_str, $items, 'mdy', array(), false, true);
-    }
-}
+class ovh_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+						'owner'	=> 'Registrant:',
+						'admin'	=> 'Administrative Contact:',
+						'tech'	=> 'Technical Contact:',
+						'billing'	=> 'Billing Contact:',
+						'domain.sponsor'	=> 'Registrar of Record:',
+						'domain.changed'	=> 'Record last updated on',
+						'domain.expires'	=> 'Record expires on',
+						'domain.created'	=> 'Record created on'
+                        );
+		return easy_parser($data_str, $items, 'mdy',false,false,true);
+		}
+	}
+?>

--- a/src/whois.gtld.php
+++ b/src/whois.gtld.php
@@ -1,76 +1,60 @@
 <?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link      http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
-if (!defined('__GTLD_HANDLER__')) {
-    define('__GTLD_HANDLER__', 1);
-}
-use phpWhois\WhoisClient;
-require_once 'whois.parser.php';
+if (!defined('__GTLD_HANDLER__'))
+	define('__GTLD_HANDLER__', 1);
+require_once('whois.parser.php');
 class gtld_handler extends WhoisClient
-{
-    /**
-     * @var array $result
-     */
-    protected $result;
-    const REG_FIELDS = [
-        'Domain Name:'          => 'regrinfo.domain.name',
-        'Registrar:'            => 'regyinfo.registrar',
-        'Whois Server:'         => 'regyinfo.whois',
-        'Referral URL:'         => 'regyinfo.referrer',
-        'Name Server:'          => 'regrinfo.domain.nserver.', // identical descriptors
-        'Updated Date:'         => 'regrinfo.domain.changed',
-        'Last Updated On:'      => 'regrinfo.domain.changed',
-        'EPP Status:'           => 'regrinfo.domain.epp_status.',
-        'Status:'               => 'regrinfo.domain.status.',
-        'Creation Date:'        => 'regrinfo.domain.created',
-        'Created On:'           => 'regrinfo.domain.created',
-        'Expiration Date:'      => 'regrinfo.domain.expires',
-        'Registry Expiry Date:' => 'regrinfo.domain.expires',
-        'No match for '         => 'nodomain',
-    ];
-    /**
-     * @param array $data
-     * @param string $query
-     *
-     * @return array
-     */
-    public function parse($data, $query)
-    {
-        $this->query  = [];
-        $this->result = generic_parser_b($data['rawdata'], self::REG_FIELDS, 'dmy');
-        unset($this->result['registered']);
-        if (isset($this->result['nodomain'])) {
-            unset($this->result['nodomain']);
-            $this->result['regrinfo']['registered'] = 'no';
-            return $this->result;
-        }
-        if ($this->deepWhois) {
-            $this->result = $this->deepWhois($query, $this->result);
-        }
-        if (empty($this->result['rawdata']) || count($this->result['rawdata']) < 3) {
-            $this->result['rawdata'] = $data['rawdata'];
-        }
-        $this->result['regrinfo']['registered'] = 'yes';
-        return $this->result;
-    }
-}
+	{
+	var $HANDLER_VERSION = '1.1';
+	var $REG_FIELDS = array(
+                        'Domain Name:' => 'regrinfo.domain.name',
+                        'Registrar:' => 'regyinfo.registrar',
+                        'Whois Server:' => 'regyinfo.whois',
+                        'Referral URL:' => 'regyinfo.referrer',
+                        'Name Server:' => 'regrinfo.domain.nserver.',  // identical descriptors
+						'Updated Date:' => 'regrinfo.domain.changed',
+                        'Last Updated On:' => 'regrinfo.domain.changed',
+                        'EPP Status:' => 'regrinfo.domain.epp_status.',
+                        'Status:' => 'regrinfo.domain.status.',
+                        'Creation Date:' => 'regrinfo.domain.created',
+                        'Created On:' => 'regrinfo.domain.created',
+                        'Expiration Date:' => 'regrinfo.domain.expires',
+                        'Updated Date:' => 'regrinfo.domain.changed',
+                        'No match for ' => 'nodomain'
+	                     );
+	function parse($data, $query)
+		{
+		$this->Query = array();
+		$this->result = generic_parser_b($data['rawdata'], $this->REG_FIELDS, 'dmy');
+		unset($this->result['registered']);
+		if (isset($this->result['nodomain']))
+			{
+			unset($this->result['nodomain']);
+			$this->result['regrinfo']['registered'] = 'no';
+			return $this->result;
+			}
+		if ($this->deep_whois) $this->result = $this->DeepWhois($query,$this->result);
+		if (empty($this->result['rawdata']) || count($this->result['rawdata']) < 3)
+			$this->result['rawdata'] = $data['rawdata'];
+		$this->result['regrinfo']['registered'] = 'yes';
+		return $this->result;
+		}
+	}
+?>

--- a/src/whois.gtld.psiusa.php
+++ b/src/whois.gtld.psiusa.php
@@ -1,80 +1,79 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__PSIUSA_HANDLER__'))
-    define('__PSIUSA_HANDLER__', 1);
+	define('__PSIUSA_HANDLER__', 1);
 require_once('whois.parser.php');
-class psiusa_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'created:' => 'domain.created',
-            'last-changed:' => 'domain.changed',
-            'status:' => 'domain.status',
-            '[owner-c] fname:' => 'owner.name.first',
-            '[owner-c] lname:' => 'owner.name.last',
-            '[owner-c] org:' => 'owner.organization',
-            '[owner-c] address:' => 'owner.address.street',
-            '[owner-c] city:' => 'owner.address.city',
-            '[owner-c] pcode:' => 'owner.address.pcode',
-            '[owner-c] country:' => 'owner.address.country',
-            '[owner-c] state:' => 'owner.address.state',
-            '[owner-c] phone:' => 'owner.phone',
-            '[owner-c] fax:' => 'owner.fax',
-            '[owner-c] email:' => 'owner.email',
-            '[admin-c] fname:' => 'admin.name.first',
-            '[admin-c] lname:' => 'admin.name.last',
-            '[admin-c] org:' => 'admin.organization',
-            '[admin-c] address:' => 'admin.address.street',
-            '[admin-c] city:' => 'admin.address.city',
-            '[admin-c] pcode:' => 'admin.address.pcode',
-            '[admin-c] country:' => 'admin.address.country',
-            '[admin-c] state:' => 'admin.address.state',
-            '[admin-c] phone:' => 'admin.phone',
-            '[admin-c] fax:' => 'admin.fax',
-            '[admin-c] email:' => 'admin.email',
-            '[tech-c] fname:' => 'tech.name.first',
-            '[tech-c] lname:' => 'tech.name.last',
-            '[tech-c] org:' => 'tech.organization',
-            '[tech-c] address:' => 'tech.address.street',
-            '[tech-c] city:' => 'tech.address.city',
-            '[tech-c] pcode:' => 'tech.address.pcode',
-            '[tech-c] country:' => 'tech.address.country',
-            '[tech-c] state:' => 'tech.address.state',
-            '[tech-c] phone:' => 'tech.phone',
-            '[tech-c] fax:' => 'tech.fax',
-            '[tech-c] email:' => 'tech.email',
-            '[zone-c] fname:' => 'zone.name.first',
-            '[zone-c] lname:' => 'zone.name.last',
-            '[zone-c] org:' => 'zone.organization',
-            '[zone-c] address:' => 'zone.address.street',
-            '[zone-c] city:' => 'zone.address.city',
-            '[zone-c] pcode:' => 'zone.address.pcode',
-            '[zone-c] country:' => 'zone.address.country',
-            '[zone-c] state:' => 'zone.address.state',
-            '[zone-c] phone:' => 'zone.phone',
-            '[zone-c] fax:' => 'zone.fax',
-            '[zone-c] email:' => 'zone.email',
-        );
-        return generic_parser_b($data_str, $items);
-    }
-}
+class psiusa_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'created:' => 'domain.created',
+                  'last-changed:' => 'domain.changed',
+                  'status:' => 'domain.status',
+                  '[owner-c] fname:' => 'owner.name.first',
+                  '[owner-c] lname:' => 'owner.name.last',
+                  '[owner-c] org:' => 'owner.organization',
+                  '[owner-c] address:' => 'owner.address.street',
+                  '[owner-c] city:' => 'owner.address.city',
+                  '[owner-c] pcode:' => 'owner.address.pcode',
+                  '[owner-c] country:' => 'owner.address.country',
+                  '[owner-c] state:' => 'owner.address.state',
+                  '[owner-c] phone:' => 'owner.phone',
+                  '[owner-c] fax:' => 'owner.fax',
+                  '[owner-c] email:' => 'owner.email',
+                  '[admin-c] fname:' => 'admin.name.first',
+                  '[admin-c] lname:' => 'admin.name.last',
+                  '[admin-c] org:' => 'admin.organization',
+                  '[admin-c] address:' => 'admin.address.street',
+                  '[admin-c] city:' => 'admin.address.city',
+                  '[admin-c] pcode:' => 'admin.address.pcode',
+                  '[admin-c] country:' => 'admin.address.country',
+                  '[admin-c] state:' => 'admin.address.state',
+                  '[admin-c] phone:' => 'admin.phone',
+                  '[admin-c] fax:' => 'admin.fax',
+                  '[admin-c] email:' => 'admin.email',
+                  '[tech-c] fname:' => 'tech.name.first',
+                  '[tech-c] lname:' => 'tech.name.last',
+                  '[tech-c] org:' => 'tech.organization',
+                  '[tech-c] address:' => 'tech.address.street',
+                  '[tech-c] city:' => 'tech.address.city',
+                  '[tech-c] pcode:' => 'tech.address.pcode',
+                  '[tech-c] country:' => 'tech.address.country',
+                  '[tech-c] state:' => 'tech.address.state',
+                  '[tech-c] phone:' => 'tech.phone',
+                  '[tech-c] fax:' => 'tech.fax',
+                  '[tech-c] email:' => 'tech.email',
+                  '[zone-c] fname:' => 'zone.name.first',
+                  '[zone-c] lname:' => 'zone.name.last',
+                  '[zone-c] org:' => 'zone.organization',
+                  '[zone-c] address:' => 'zone.address.street',
+                  '[zone-c] city:' => 'zone.address.city',
+                  '[zone-c] pcode:' => 'zone.address.pcode',
+                  '[zone-c] country:' => 'zone.address.country',
+                  '[zone-c] state:' => 'zone.address.state',
+                  '[zone-c] phone:' => 'zone.phone',
+                  '[zone-c] fax:' => 'zone.fax',
+                  '[zone-c] email:' => 'zone.email',
+		              );
+		return generic_parser_b($data_str, $items);
+		}
+	}
+?>

--- a/src/whois.gtld.publicdomainregistry.php
+++ b/src/whois.gtld.publicdomainregistry.php
@@ -1,47 +1,46 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__PUBLICDOMAINREGISTRY_HANDLER__'))
-    define('__PUBLICDOMAINREGISTRY_HANDLER__', 1);
+	define('__PUBLICDOMAINREGISTRY_HANDLER__', 1);
 require_once('whois.parser.php');
-class publicdomainregistry_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'owner#' => '(Registrant):',
-            'admin' => 'Administrative Contact',
-            'tech' => 'Technical Contact',
-            'billing' => 'Billing Contact',
-            'domain.name' => 'Domain name:',
-            'domain.sponsor' => 'Registration Service Provided By:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.changed' => 'Record last updated ',
-            'domain.created' => 'Record created on',
-            'domain.created#' => 'Creation Date:',
-            'domain.expires' => 'Record expires on',
-            'domain.expires#' => 'Expiration Date:',
-            'domain.status' => 'Status:'
-        );
-        return easy_parser($data_str, $items, 'mdy', array(), true, true);
-    }
-}
+class publicdomainregistry_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+              'owner' => 'Registrant:',
+              'owner#' => '(Registrant):',
+              'admin' => 'Administrative Contact',
+              'tech' => 'Technical Contact',
+              'billing' => 'Billing Contact',
+              'domain.name' => 'Domain name:',
+              'domain.sponsor' => 'Registration Service Provided By:',
+              'domain.nserver' => 'Domain servers in listed order:',
+              'domain.changed' => 'Record last updated ',
+              'domain.created' => 'Record created on',
+              'domain.created#' => 'Creation Date:',
+              'domain.expires' => 'Record expires on',
+              'domain.expires#' => 'Expiration Date:',
+              'domain.status'	=> 'Status:'
+		          );
+		return easy_parser($data_str, $items, 'mdy', false, true, true);
+		}
+	}
+?>

--- a/src/whois.gtld.register.php
+++ b/src/whois.gtld.register.php
@@ -1,52 +1,51 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__REGISTER_HANDLER__'))
-    define('__REGISTER_HANDLER__', 1);
+	define('__REGISTER_HANDLER__', 1);
 require_once('whois.parser.php');
-class register_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner#0' => 'Registrant Info:',
-            'owner#1' => 'Organization:',
-            'owner#2' => 'Registrant:',
-            'owner#3' => 'Registrant Contact:',
-            'admin' => 'Administrative',
-            'tech' => 'Technical',
-            'zone' => 'Zone',
-            'domain.sponsor#0' => 'Registrar Name....:',
-            'domain.sponsor#1' => 'Registration Service Provided By:',
-            'domain.referrer' => 'Registrar Homepage:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.nserver' => 'DNS Servers:',
-            'domain.name' => 'Domain name:',
-            'domain.created#0' => 'Created on..............:',
-            'domain.created#1' => 'Creation date:',
-            'domain.expires#0' => 'Expires on..............:',
-            'domain.expires#1' => 'Expiration date:',
-            'domain.changed' => 'Record last updated on..:',
-            'domain.status' => 'Status:'
-        );
-        return easy_parser($data_str, $items, 'ymd');
-    }
-}
+class register_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner#0' => 'Registrant Info:',
+                  'owner#1' => 'Organization:',
+                  'owner#2' => 'Registrant:',
+                  'owner#3'	=> 'Registrant Contact:',
+                  'admin' => 'Administrative',
+                  'tech' => 'Technical',
+                  'zone' => 'Zone',
+                  'domain.sponsor#0' => 'Registrar Name....:',
+                  'domain.sponsor#1' => 'Registration Service Provided By:',
+                  'domain.referrer'	=> 'Registrar Homepage:',
+                  'domain.nserver' => 'Domain servers in listed order:',
+                  'domain.nserver' => 'DNS Servers:',
+                  'domain.name' => 'Domain name:',
+                  'domain.created#0' => 'Created on..............:',
+                  'domain.created#1' => 'Creation date:',
+                  'domain.expires#0' => 'Expires on..............:',
+                  'domain.expires#1' => 'Expiration date:',
+                  'domain.changed' => 'Record last updated on..:',
+                  'domain.status' => 'Status:'
+		            );
+		return easy_parser($data_str, $items, 'ymd');
+		}
+	}
+?>

--- a/src/whois.gtld.rrpproxy.php
+++ b/src/whois.gtld.rrpproxy.php
@@ -1,82 +1,81 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__RRPPROXY_HANDLER__'))
-    define('__RRPPROXY_HANDLER__', 1);
+	define('__RRPPROXY_HANDLER__', 1);
 require_once('whois.parser.php');
-class rrpproxy_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'created-date:' => 'domain.created',
-            'updated-date:' => 'domain.changed',
-            'registration-expiration-date:' => 'domain.expires',
-            'RSP:' => 'domain.sponsor',
-            'URL:' => 'domain.referrer',
-            'owner-nom.contact:' => 'owner.handle',
-            'owner-fname:' => 'owner.name.first',
-            'owner-lname:' => 'owner.name.last',
-            'owner-organization:' => 'owner.organization',
-            'owner-street:' => 'owner.address.street',
-            'owner-city:' => 'owner.address.city',
-            'owner-zip:' => 'owner.address.pcode',
-            'owner-country:' => 'owner.address.country',
-            'owner-phone:' => 'owner.phone',
-            'owner-fax:' => 'owner.fax',
-            'owner-email:' => 'owner.email',
-            'admin-nom.contact:' => 'admin.handle',
-            'admin-fname:' => 'admin.name.first',
-            'admin-lname:' => 'admin.name.last',
-            'admin-organization:' => 'admin.organization',
-            'admin-street:' => 'admin.address.street',
-            'admin-city:' => 'admin.address.city',
-            'admin-zip:' => 'admin.address.pcode',
-            'admin-country:' => 'admin.address.country',
-            'admin-phone:' => 'admin.phone',
-            'admin-fax:' => 'admin.fax',
-            'admin-email:' => 'admin.email',
-            'tech-nom.contact:' => 'tech.handle',
-            'tech-fname:' => 'tech.name.first',
-            'tech-lname:' => 'tech.name.last',
-            'tech-organization:' => 'tech.organization',
-            'tech-street:' => 'tech.address.street',
-            'tech-city:' => 'tech.address.city',
-            'tech-zip:' => 'tech.address.pcode',
-            'tech-country:' => 'tech.address.country',
-            'tech-phone:' => 'tech.phone',
-            'tech-fax:' => 'tech.fax',
-            'tech-email:' => 'tech.email',
-            'billing-nom.contact:' => 'billing.handle',
-            'billing-fname:' => 'billing.name.first',
-            'billing-lname:' => 'billing.name.last',
-            'billing-organization:' => 'billing.organization',
-            'billing-street:' => 'billing.address.street',
-            'billing-city:' => 'billing.address.city',
-            'billing-zip:' => 'billing.address.pcode',
-            'billing-country:' => 'billing.address.country',
-            'billing-phone:' => 'billing.phone',
-            'billing-fax:' => 'billing.fax',
-            'billing-email:' => 'billing.email'
-        );
-        return generic_parser_b($data_str, $items);
-    }
-}
+class rrpproxy_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'created-date:' => 'domain.created',
+                  'updated-date:' => 'domain.changed',
+                  'registration-expiration-date:' => 'domain.expires',
+                  'RSP:' => 'domain.sponsor',
+                  'URL:' => 'domain.referrer',
+                  'owner-nom.contact:' => 'owner.handle',
+                  'owner-fname:' => 'owner.name.first',
+                  'owner-lname:' => 'owner.name.last',
+                  'owner-organization:' => 'owner.organization',
+                  'owner-street:' => 'owner.address.street',
+                  'owner-city:' => 'owner.address.city',
+                  'owner-zip:' => 'owner.address.pcode',
+                  'owner-country:' => 'owner.address.country',
+                  'owner-phone:' => 'owner.phone',
+                  'owner-fax:' => 'owner.fax',
+                  'owner-email:' => 'owner.email',
+                  'admin-nom.contact:' => 'admin.handle',
+                  'admin-fname:' => 'admin.name.first',
+                  'admin-lname:' => 'admin.name.last',
+                  'admin-organization:' => 'admin.organization',
+                  'admin-street:' => 'admin.address.street',
+                  'admin-city:' => 'admin.address.city',
+                  'admin-zip:' => 'admin.address.pcode',
+                  'admin-country:' => 'admin.address.country',
+                  'admin-phone:' => 'admin.phone',
+                  'admin-fax:' => 'admin.fax',
+                  'admin-email:' => 'admin.email',
+                  'tech-nom.contact:' => 'tech.handle',
+                  'tech-fname:' => 'tech.name.first',
+                  'tech-lname:' => 'tech.name.last',
+                  'tech-organization:' => 'tech.organization',
+                  'tech-street:' => 'tech.address.street',
+                  'tech-city:' => 'tech.address.city',
+                  'tech-zip:' => 'tech.address.pcode',
+                  'tech-country:' => 'tech.address.country',
+                  'tech-phone:' => 'tech.phone',
+                  'tech-fax:' => 'tech.fax',
+                  'tech-email:' => 'tech.email',
+                  'billing-nom.contact:' => 'billing.handle',
+                  'billing-fname:' => 'billing.name.first',
+                  'billing-lname:' => 'billing.name.last',
+                  'billing-organization:' => 'billing.organization',
+                  'billing-street:' => 'billing.address.street',
+                  'billing-city:' => 'billing.address.city',
+                  'billing-zip:' => 'billing.address.pcode',
+                  'billing-country:' => 'billing.address.country',
+                  'billing-phone:' => 'billing.phone',
+                  'billing-fax:' => 'billing.fax',
+                  'billing-email:' => 'billing.email'
+		              );
+		return generic_parser_b($data_str, $items);
+		}
+	}
+?>

--- a/src/whois.gtld.schlund.php
+++ b/src/whois.gtld.schlund.php
@@ -1,76 +1,75 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__SCHLUND_HANDLER__'))
-    define('__SCHLUND_HANDLER__', 1);
+	define('__SCHLUND_HANDLER__', 1);
 require_once('whois.parser.php');
-class schlund_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'created:' => 'domain.created',
-            'last-changed:' => 'domain.changed',
-            'status:' => 'domain.status',
-            'registrant-firstname:' => 'owner.name.first',
-            'registrant-lastname:' => 'owner.name.last',
-            'registrant-organization:' => 'owner.organization',
-            'registrant-street1:' => 'owner.address.street.',
-            'registrant-street2:' => 'owner.address.street.',
-            'registrant-pcode:' => 'owner.address.pcode',
-            'registrant-city:' => 'owner.address.city',
-            'registrant-ccode:' => 'owner.address.country',
-            'registrant-phone:' => 'owner.phone',
-            'registrant-email:' => 'owner.email',
-            'admin-c-firstname:' => 'admin.name.first',
-            'admin-c-lastname:' => 'admin.name.last',
-            'admin-c-organization:' => 'admin.organization',
-            'admin-c-street1:' => 'admin.address.street.',
-            'admin-c-street2:' => 'admin.address.street.',
-            'admin-c-pcode:' => 'admin.address.pcode',
-            'admin-c-city:' => 'admin.address.city',
-            'admin-c-ccode:' => 'admin.address.country',
-            'admin-c-phone:' => 'admin.phone',
-            'admin-c-email:' => 'admin.email',
-            'tech-c-firstname:' => 'tech.name.first',
-            'tech-c-lastname:' => 'tech.name.last',
-            'tech-c-organization:' => 'tech.organization',
-            'tech-c-street1:' => 'tech.address.street.',
-            'tech-c-street2:' => 'tech.address.street.',
-            'tech-c-pcode:' => 'tech.address.pcode',
-            'tech-c-city:' => 'tech.address.city',
-            'tech-c-ccode:' => 'tech.address.country',
-            'tech-c-phone:' => 'tech.phone',
-            'tech-c-email:' => 'tech.email',
-            'bill-c-firstname:' => 'billing.name.first',
-            'bill-c-lastname:' => 'billing.name.last',
-            'bill-c-organization:' => 'billing.organization',
-            'bill-c-street1:' => 'billing.address.street.',
-            'bill-c-street2:' => 'billing.address.street.',
-            'bill-c-pcode:' => 'billing.address.pcode',
-            'bill-c-city:' => 'billing.address.city',
-            'bill-c-ccode:' => 'billing.address.country',
-            'bill-c-phone:' => 'billing.phone',
-            'bill-c-email:' => 'billing.email'
-        );
-        return generic_parser_b($data_str, $items);
-    }
-}
+class schlund_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'created:' => 'domain.created',
+                  'last-changed:' => 'domain.changed',
+                  'status:' => 'domain.status',
+                  'registrant-firstname:' => 'owner.name.first',
+                  'registrant-lastname:' => 'owner.name.last',
+                  'registrant-organization:' => 'owner.organization',
+                  'registrant-street1:' => 'owner.address.street.',
+                  'registrant-street2:' => 'owner.address.street.',
+                  'registrant-pcode:' => 'owner.address.pcode',
+                  'registrant-city:' => 'owner.address.city',
+                  'registrant-ccode:' => 'owner.address.country',
+                  'registrant-phone:' => 'owner.phone',
+                  'registrant-email:' => 'owner.email',
+                  'admin-c-firstname:' => 'admin.name.first',
+                  'admin-c-lastname:' => 'admin.name.last',
+                  'admin-c-organization:' => 'admin.organization',
+                  'admin-c-street1:' => 'admin.address.street.',
+                  'admin-c-street2:' => 'admin.address.street.',
+                  'admin-c-pcode:' => 'admin.address.pcode',
+                  'admin-c-city:' => 'admin.address.city',
+                  'admin-c-ccode:' => 'admin.address.country',
+                  'admin-c-phone:' => 'admin.phone',
+                  'admin-c-email:' => 'admin.email',
+                  'tech-c-firstname:' => 'tech.name.first',
+                  'tech-c-lastname:' => 'tech.name.last',
+                  'tech-c-organization:' => 'tech.organization',
+                  'tech-c-street1:' => 'tech.address.street.',
+                  'tech-c-street2:' => 'tech.address.street.',
+                  'tech-c-pcode:' => 'tech.address.pcode',
+                  'tech-c-city:' => 'tech.address.city',
+                  'tech-c-ccode:' => 'tech.address.country',
+                  'tech-c-phone:' => 'tech.phone',
+                  'tech-c-email:' => 'tech.email',
+                  'bill-c-firstname:' => 'billing.name.first',
+                  'bill-c-lastname:' => 'billing.name.last',
+                  'bill-c-organization:' => 'billing.organization',
+                  'bill-c-street1:' => 'billing.address.street.',
+                  'bill-c-street2:' => 'billing.address.street.',
+                  'bill-c-pcode:' => 'billing.address.pcode',
+                  'bill-c-city:' => 'billing.address.city',
+                  'bill-c-ccode:' => 'billing.address.country',
+                  'bill-c-phone:' => 'billing.phone',
+                  'bill-c-email:' => 'billing.email'
+		              );
+		return generic_parser_b($data_str, $items);
+		}
+	}
+?>

--- a/src/whois.gtld.srsplus.php
+++ b/src/whois.gtld.srsplus.php
@@ -1,41 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__SRSPLUS_HANDLER__'))
-    define('__SRSPLUS_HANDLER__', 1);
+	define('__SRSPLUS_HANDLER__', 1);
 require_once('whois.parser.php');
-class srsplus_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative',
-            'tech' => 'Technical',
-            'billing' => 'Billing',
-            'domain.name' => 'Domain Name:',
-            'domain.nserver' => 'Domain servers:',
-            'domain.created' => 'Record created on',
-            'domain.expires' => 'Record expires on'
-        );
-        return easy_parser($data_str, $items, 'ymd', array(), true, true);
-    }
-}
+class srsplus_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant:',
+                  'admin' => 'Administrative',
+                  'tech' => 'Technical',
+                  'billing' => 'Billing',
+                  'domain.name' => 'Domain Name:',
+                  'domain.nserver' => 'Domain servers:',
+                  'domain.created' => 'Record created on',
+                  'domain.expires' => 'Record expires on'
+		              );
+		return easy_parser($data_str, $items, 'ymd',false,true,true);
+		}
+	}
+?>

--- a/src/whois.gtld.tmagnic.php
+++ b/src/whois.gtld.tmagnic.php
@@ -1,42 +1,41 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__TMAGNIC_HANDLER__'))
-    define('__TMAGNIC_HANDLER__', 1);
+	define('__TMAGNIC_HANDLER__', 1);
 require_once('whois.parser.php');
-class tmagnic_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Owner Contact:',
-            'admin' => 'Admin Contact',
-            'tech' => 'Technical Contact',
-            'domain.name' => 'Domain Name:',
-            'domain.nserver.' => 'Domain servers in listed order:',
-            'domain.expires' => 'Record expires on: ',
-            'domain.changed' => 'Record last updated on: ',
-            '' => 'Zone Contact',
-            '#' => 'Punycode Name:'
-        );
-        return easy_parser($data_str, $items, 'ymd', array(), false, true);
-    }
-}
+class tmagnic_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+              'owner' => 'Owner Contact:',
+              'admin' => 'Admin Contact',
+              'tech' => 'Technical Contact',
+              'domain.name' => 'Domain Name:',
+              'domain.nserver.' => 'Domain servers in listed order:',
+              'domain.expires' => 'Record expires on: ',
+              'domain.changed' => 'Record last updated on: ',
+              '' => 'Zone Contact',
+              '#' => 'Punycode Name:'
+		          );
+		return easy_parser($data_str, $items, 'ymd',false,false,true);
+		}
+	}
+?>

--- a/src/whois.gtld.tvcorp.php
+++ b/src/whois.gtld.tvcorp.php
@@ -1,40 +1,39 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__TVCORP_HANDLER__'))
-    define('__TVCORP_HANDLER__', 1);
+	define('__TVCORP_HANDLER__', 1);
 require_once('whois.parser.php');
-class tvcorp_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant',
-            'admin' => 'Admin',
-            'tech' => 'Technical',
-            'billing' => 'Billing',
-            'domain.nserver.' => 'Domain servers:',
-            'domain.created' => 'Record created on',
-            'domain.expires' => 'Record expires on'
-        );
-        return easy_parser($data_str, $items, 'mdy');
-    }
-}
+class tvcorp_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner' => 'Registrant',
+                'admin' => 'Admin',
+                'tech' =>	'Technical',
+                'billing' => 'Billing',
+                'domain.nserver.' => 'Domain servers:',
+                'domain.created' => 'Record created on',
+				'domain.expires' => 'Record expires on'
+		            );
+		return easy_parser($data_str, $items, 'mdy');
+		}
+	}
+?>

--- a/src/whois.gtld.wildwestdomains.php
+++ b/src/whois.gtld.wildwestdomains.php
@@ -1,42 +1,41 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__WILDWESTDOMAINS_HANDLER__'))
-    define('__WILDWESTDOMAINS_HANDLER__', 1);
+	define('__WILDWESTDOMAINS_HANDLER__', 1);
 require_once('whois.parser.php');
-class wildwestdomains_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'domain.name' => 'Domain name:',
-            'domain.sponsor' => 'Registered through:',
-            'domain.nserver' => 'Domain servers in listed order:',
-            'domain.created' => 'Created on:',
-            'domain.expires' => 'Expires on:',
-            'domain.changed' => 'Last Updated on:'
-        );
-        return easy_parser($data_str, $items, 'mdy');
-    }
-}
+class wildwestdomains_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'owner' => 'Registrant:',
+                  'admin' => 'Administrative Contact:',
+                  'tech' => 'Technical Contact:',
+                  'domain.name' => 'Domain name:',
+                  'domain.sponsor'=> 'Registered through:',
+                  'domain.nserver' => 'Domain servers in listed order:',
+                  'domain.created' => 'Created on:',
+                  'domain.expires' => 'Expires on:',
+                  'domain.changed' => 'Last Updated on:'
+		              );
+		return easy_parser($data_str, $items, 'mdy');
+		}
+	}
+?>

--- a/src/whois.hu.php
+++ b/src/whois.hu.php
@@ -1,42 +1,40 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-if (!defined('__HU_HANDLER__'))
-    define('__HU_HANDLER__', 1);
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+if(!defined('__HU_HANDLER__'))
+  define('__HU_HANDLER__',1);
 require_once('whois.parser.php');
-class hu_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domain:' => 'domain.name',
-            'record created:' => 'domain.created'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
-        if (isset($r['regrinfo']['domain']))
-            $r['regrinfo']['registered'] = 'yes';
-        else
-            $r['regrinfo']['registered'] = 'no';
-        $r['regyinfo'] = array('referrer' => 'http://www.nic.hu', 'registrar' => 'HUNIC');
-        return $r;
-    }
-}
+class hu_handler
+	{
+	function parse ($data_str, $query)
+		{
+		$items = array(
+		    'domain:' => 'domain.name',
+		    'record created:' => 'domain.created'
+	        );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'],$items,'ymd');
+		if (isset($r['regrinfo']['domain']))
+		    $r['regrinfo']['registered'] = 'yes';
+		else
+		    $r['regrinfo']['registered'] = 'no';
+		$r['regyinfo'] = array('referrer'=>'http://www.nic.hu','registrar'=>'HUNIC');
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.idna.php
@@ -0,0 +1,832 @@
+<?php
+/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4 foldmethod=marker: */
+/**
+ * Encode/decode Internationalized Domain Names.
+ *
+ * The class allows to convert internationalized domain names
+ * (see RFC 3490 for details) as they can be used with various registries worldwide
+ * to be translated between their original (localized) form and their encoded form
+ * as it will be used in the DNS (Domain Name System).
+ *
+ * The class provides two public methods, encode() and decode(), which do exactly
+ * what you would expect them to do. You are allowed to use complete domain names,
+ * simple strings and complete email addresses as well. That means, that you might
+ * use any of the following notations:
+ *
+ * - www.nörgler.com
+ * - xn--nrgler-wxa
+ * - xn--brse-5qa.xn--knrz-1ra.info
+ *
+ * Unicode input might be given as either UTF-8 string, UCS-4 string or UCS-4
+ * array. Unicode output is available in the same formats.
+ * You can select your preferred format via {@link set_paramter()}.
+ *
+ * ACE input and output is always expected to be ASCII.
+ *
+ * @author  Matthias Sommerfeld <mso@phlylabs.de>
+ * @copyright 2004-2007 phlyLabs Berlin, http://phlylabs.de
+ * @version 0.5.1
+ *
+ */
+class idna_convert
+{
+    /**
+     * Holds all relevant mapping tables, loaded from a seperate file on construct
+     * See RFC3454 for details
+     *
+     * @var array
+     * @access private
+     */
+    var $NP = array();
+    var $_punycode_prefix = 'xn--';
+    var $_invalid_ucs =     0x80000000;
+    var $_max_ucs =         0x10FFFF;
+    var $_base =            36;
+    var $_tmin =            1;
+    var $_tmax =            26;
+    var $_skew =            38;
+    var $_damp =            700;
+    var $_initial_bias =    72;
+    var $_initial_n =       0x80;
+    var $_sbase =           0xAC00;
+    var $_lbase =           0x1100;
+    var $_vbase =           0x1161;
+    var $_tbase =           0x11A7;
+    var $_lcount =          19;
+    var $_vcount =          21;
+    var $_tcount =          28;
+    var $_ncount =          588;   // _vcount * _tcount
+    var $_scount =          11172; // _lcount * _tcount * _vcount
+    var $_error =           false;
+    var $_api_encoding   =  'utf8'; // Default input charset is UTF-8
+    var $_allow_overlong =  false;  // Overlong UTF-8 encodings are forbidden
+    var $_strict_mode    =  false;  // Behave strict or not
+    function idna_convert($options = false)
+    {
+        $this->slast = $this->_sbase + $this->_lcount * $this->_vcount * $this->_tcount;
+        if (function_exists('file_get_contents')) {
+            $this->NP = unserialize(file_get_contents(dirname(__FILE__).'/npdata.ser'));
+        } else {
+            $this->NP = unserialize(join('', file(dirname(__FILE__).'/npdata.ser')));
+        }
+        if (is_array($options)) {
+            return $this->set_parameter($options);
+        }
+        return true;
+    }
+    /**
+     * Sets a new option value. Available options and values:
+     * [encoding - Use either UTF-8, UCS4 as array or UCS4 as string as input ('utf8' for UTF-8,
+     *         'ucs4_string' and 'ucs4_array' respectively for UCS4); The output is always UTF-8]
+     * [overlong - Unicode does not allow unnecessarily long encodings of chars,
+     *             to allow this, set this parameter to true, else to false;
+     *             default is false.]
+     * [strict - true: strict mode, good for registration purposes - Causes errors
+     *           on failures; false: loose mode, ideal for "wildlife" applications
+     *           by silently ignoring errors and returning the original input instead
+     *
+     * @param    mixed     Parameter to set (string: single parameter; array of Parameter => Value pairs)
+     * @param    string    Value to use (if parameter 1 is a string)
+     * @return   boolean   true on success, false otherwise
+     * @access   public
+     */
+    function set_parameter($option, $value = false)
+    {
+        if (!is_array($option)) {
+            $option = array($option => $value);
+        }
+        foreach ($option as $k => $v) {
+            switch ($k) {
+            case 'encoding':
+                switch ($v) {
+                case 'utf8':
+                case 'ucs4_string':
+                case 'ucs4_array':
+                    $this->_api_encoding = $v;
+                    break;
+                default:
+                    $this->_error('Set Parameter: Unknown parameter '.$v.' for option '.$k);
+                    return false;
+                }
+                break;
+            case 'overlong':
+                $this->_allow_overlong = ($v) ? true : false;
+                break;
+            case 'strict':
+                $this->_strict_mode = ($v) ? true : false;
+                break;
+            default:
+                $this->_error('Set Parameter: Unknown option '.$k);
+                return false;
+            }
+        }
+        return true;
+    }
+    /**
+     * Decode a given ACE domain name
+     * @param    string   Domain name (ACE string)
+     * [@param    string   Desired output encoding, see {@link set_parameter}]
+     * @return   string   Decoded Domain name (UTF-8 or UCS-4)
+     * @access   public
+     */
+    function decode($input, $one_time_encoding = false)
+    {
+        if ($one_time_encoding) {
+            switch ($one_time_encoding) {
+            case 'utf8':
+            case 'ucs4_string':
+            case 'ucs4_array':
+                break;
+            default:
+                $this->_error('Unknown encoding '.$one_time_encoding);
+                return false;
+            }
+        }
+        $input = trim($input);
+        if (strpos($input, '@')) { // Maybe it is an email address
+            if ($this->_strict_mode) {
+                $this->_error('Only simple domain name parts can be handled in strict mode');
+                return false;
+            }
+            list ($email_pref, $input) = explode('@', $input, 2);
+            $arr = explode('.', $input);
+            foreach ($arr as $k => $v) {
+                if (preg_match('!^'.preg_quote($this->_punycode_prefix, '!').'!', $v)) {
+                    $conv = $this->_decode($v);
+                    if ($conv) $arr[$k] = $conv;
+                }
+            }
+            $input = join('.', $arr);
+            $arr = explode('.', $email_pref);
+            foreach ($arr as $k => $v) {
+                if (preg_match('!^'.preg_quote($this->_punycode_prefix, '!').'!', $v)) {
+                    $conv = $this->_decode($v);
+                    if ($conv) $arr[$k] = $conv;
+                }
+            }
+            $email_pref = join('.', $arr);
+            $return = $email_pref . '@' . $input;
+        } elseif (preg_match('![:\./]!', $input)) { // Or a complete domain name (with or without paths / parameters)
+            if ($this->_strict_mode) {
+                $this->_error('Only simple domain name parts can be handled in strict mode');
+                return false;
+            }
+            $parsed = parse_url($input);
+            if (isset($parsed['host'])) {
+                $arr = explode('.', $parsed['host']);
+                foreach ($arr as $k => $v) {
+                    $conv = $this->_decode($v);
+                    if ($conv) $arr[$k] = $conv;
+                }
+                $parsed['host'] = join('.', $arr);
+                $return =
+                        (empty($parsed['scheme']) ? '' : $parsed['scheme'].(strtolower($parsed['scheme']) == 'mailto' ? ':' : '://'))
+                        .(empty($parsed['user']) ? '' : $parsed['user'].(empty($parsed['pass']) ? '' : ':'.$parsed['pass']).'@')
+                        .$parsed['host']
+                        .(empty($parsed['port']) ? '' : ':'.$parsed['port'])
+                        .(empty($parsed['path']) ? '' : $parsed['path'])
+                        .(empty($parsed['query']) ? '' : '?'.$parsed['query'])
+                        .(empty($parsed['fragment']) ? '' : '#'.$parsed['fragment']);
+            } else { // parse_url seems to have failed, try without it
+                $arr = explode('.', $input);
+                foreach ($arr as $k => $v) {
+                    $conv = $this->_decode($v);
+                    $arr[$k] = ($conv) ? $conv : $v;
+                }
+                $return = join('.', $arr);
+            }
+        } else { // Otherwise we consider it being a pure domain name string
+            $return = $this->_decode($input);
+            if (!$return) $return = $input;
+        }
+        switch (($one_time_encoding) ? $one_time_encoding : $this->_api_encoding) {
+        case 'utf8':
+            return $return;
+            break;
+        case 'ucs4_string':
+           return $this->_ucs4_to_ucs4_string($this->_utf8_to_ucs4($return));
+           break;
+        case 'ucs4_array':
+            return $this->_utf8_to_ucs4($return);
+            break;
+        default:
+            $this->_error('Unsupported output format');
+            return false;
+        }
+    }
+    /**
+     * Encode a given UTF-8 domain name
+     * @param    string   Domain name (UTF-8 or UCS-4)
+     * [@param    string   Desired input encoding, see {@link set_parameter}]
+     * @return   string   Encoded Domain name (ACE string)
+     * @access   public
+     */
+    function encode($decoded, $one_time_encoding = false)
+    {
+        switch ($one_time_encoding ? $one_time_encoding : $this->_api_encoding) {
+        case 'utf8':
+            $decoded = $this->_utf8_to_ucs4($decoded);
+            break;
+        case 'ucs4_string':
+           $decoded = $this->_ucs4_string_to_ucs4($decoded);
+        case 'ucs4_array':
+           break;
+        default:
+            $this->_error('Unsupported input format: '.($one_time_encoding ? $one_time_encoding : $this->_api_encoding));
+            return false;
+        }
+        if (empty($decoded)) return '';
+        $last_begin = 0;
+        $output = '';
+        foreach ($decoded as $k => $v) {
+            switch($v) {
+            case 0x3002:
+            case 0xFF0E:
+            case 0xFF61:
+                $decoded[$k] = 0x2E;
+            case 0x2E:
+            case 0x2F:
+            case 0x3A:
+            case 0x3F:
+            case 0x40:
+                if ($this->_strict_mode) {
+                   $this->_error('Neither email addresses nor URLs are allowed in strict mode.');
+                   return false;
+                } else {
+                    if ($k) {
+                        $encoded = '';
+                        $encoded = $this->_encode(array_slice($decoded, $last_begin, (($k)-$last_begin)));
+                        if ($encoded) {
+                            $output .= $encoded;
+                        } else {
+                            $output .= $this->_ucs4_to_utf8(array_slice($decoded, $last_begin, (($k)-$last_begin)));
+                        }
+                        $output .= chr($decoded[$k]);
+                    }
+                    $last_begin = $k + 1;
+                }
+            }
+        }
+        if ($last_begin) {
+            $inp_len = sizeof($decoded);
+            $encoded = '';
+            $encoded = $this->_encode(array_slice($decoded, $last_begin, (($inp_len)-$last_begin)));
+            if ($encoded) {
+                $output .= $encoded;
+            } else {
+                $output .= $this->_ucs4_to_utf8(array_slice($decoded, $last_begin, (($inp_len)-$last_begin)));
+            }
+            return $output;
+        } else {
+            if ($output = $this->_encode($decoded)) {
+                return $output;
+            } else {
+                return $this->_ucs4_to_utf8($decoded);
+            }
+        }
+    }
+    /**
+     * Use this method to get the last error ocurred
+     * @param    void
+     * @return   string   The last error, that occured
+     * @access   public
+     */
+    function get_last_error()
+    {
+        return $this->_error;
+    }
+    /**
+     * The actual decoding algorithm
+     * @access   private
+     */
+    function _decode($encoded)
+    {
+        if (!preg_match('!^'.preg_quote($this->_punycode_prefix, '!').'!', $encoded)) {
+            $this->_error('This is not a punycode string');
+            return false;
+        }
+        $encode_test = preg_replace('!^'.preg_quote($this->_punycode_prefix, '!').'!', '', $encoded);
+        if (!$encode_test) {
+            $this->_error('The given encoded string was empty');
+            return false;
+        }
+        $delim_pos = strrpos($encoded, '-');
+        if ($delim_pos > strlen($this->_punycode_prefix)) {
+            for ($k = strlen($this->_punycode_prefix); $k < $delim_pos; ++$k) {
+                $decoded[] = ord($encoded{$k});
+            }
+        } else {
+            $decoded = array();
+        }
+        $deco_len = count($decoded);
+        $enco_len = strlen($encoded);
+        $is_first = true;
+        $bias     = $this->_initial_bias;
+        $idx      = 0;
+        $char     = $this->_initial_n;
+        for ($enco_idx = ($delim_pos) ? ($delim_pos + 1) : 0; $enco_idx < $enco_len; ++$deco_len) {
+            for ($old_idx = $idx, $w = 1, $k = $this->_base; 1 ; $k += $this->_base) {
+                $digit = $this->_decode_digit($encoded{$enco_idx++});
+                $idx += $digit * $w;
+                $t = ($k <= $bias) ? $this->_tmin :
+                        (($k >= $bias + $this->_tmax) ? $this->_tmax : ($k - $bias));
+                if ($digit < $t) break;
+                $w = (int) ($w * ($this->_base - $t));
+            }
+            $bias = $this->_adapt($idx - $old_idx, $deco_len + 1, $is_first);
+            $is_first = false;
+            $char += (int) ($idx / ($deco_len + 1));
+            $idx %= ($deco_len + 1);
+            if ($deco_len > 0) {
+                for ($i = $deco_len; $i > $idx; $i--) {
+                    $decoded[$i] = $decoded[($i - 1)];
+                }
+            }
+            $decoded[$idx++] = $char;
+        }
+        return $this->_ucs4_to_utf8($decoded);
+    }
+    /**
+     * The actual encoding algorithm
+     * @access   private
+     */
+    function _encode($decoded)
+    {
+        $extract = strlen($this->_punycode_prefix);
+        $check_pref = $this->_utf8_to_ucs4($this->_punycode_prefix);
+        $check_deco = array_slice($decoded, 0, $extract);
+        if ($check_pref == $check_deco) {
+            $this->_error('This is already a punycode string');
+            return false;
+        }
+        $encodable = false;
+        foreach ($decoded as $k => $v) {
+            if ($v > 0x7a) {
+                $encodable = true;
+                break;
+            }
+        }
+        if (!$encodable) {
+            $this->_error('The given string does not contain encodable chars');
+            return false;
+        }
+        $decoded = $this->_nameprep($decoded);
+        if (!$decoded || !is_array($decoded)) return false; // NAMEPREP failed
+        $deco_len  = count($decoded);
+        if (!$deco_len) return false; // Empty array
+        $codecount = 0; // How many chars have been consumed
+        $encoded = '';
+        for ($i = 0; $i < $deco_len; ++$i) {
+            $test = $decoded[$i];
+            if ((0x2F < $test && $test < 0x40) || (0x40 < $test && $test < 0x5B)
+                    || (0x60 < $test && $test <= 0x7B) || (0x2D == $test)) {
+                $encoded .= chr($decoded[$i]);
+                $codecount++;
+            }
+        }
+        if ($codecount == $deco_len) return $encoded; // All codepoints were basic ones
+        $encoded = $this->_punycode_prefix.$encoded;
+        if ($codecount) $encoded .= '-';
+        $is_first  = true;
+        $cur_code  = $this->_initial_n;
+        $bias      = $this->_initial_bias;
+        $delta     = 0;
+        while ($codecount < $deco_len) {
+            for ($i = 0, $next_code = $this->_max_ucs; $i < $deco_len; $i++) {
+                if ($decoded[$i] >= $cur_code && $decoded[$i] <= $next_code) {
+                    $next_code = $decoded[$i];
+                }
+            }
+            $delta += ($next_code - $cur_code) * ($codecount + 1);
+            $cur_code = $next_code;
+            for ($i = 0; $i < $deco_len; $i++) {
+                if ($decoded[$i] < $cur_code) {
+                    $delta++;
+                } elseif ($decoded[$i] == $cur_code) {
+                    for ($q = $delta, $k = $this->_base; 1; $k += $this->_base) {
+                        $t = ($k <= $bias) ? $this->_tmin :
+                                (($k >= $bias + $this->_tmax) ? $this->_tmax : $k - $bias);
+                        if ($q < $t) break;
+                        $encoded .= $this->_encode_digit(intval($t + (($q - $t) % ($this->_base - $t)))); //v0.4.5 Changed from ceil() to intval()
+                        $q = (int) (($q - $t) / ($this->_base - $t));
+                    }
+                    $encoded .= $this->_encode_digit($q);
+                    $bias = $this->_adapt($delta, $codecount+1, $is_first);
+                    $codecount++;
+                    $delta = 0;
+                    $is_first = false;
+                }
+            }
+            $delta++;
+            $cur_code++;
+        }
+        return $encoded;
+    }
+    /**
+     * Adapt the bias according to the current code point and position
+     * @access   private
+     */
+    function _adapt($delta, $npoints, $is_first)
+    {
+        $delta = intval($is_first ? ($delta / $this->_damp) : ($delta / 2));
+        $delta += intval($delta / $npoints);
+        for ($k = 0; $delta > (($this->_base - $this->_tmin) * $this->_tmax) / 2; $k += $this->_base) {
+            $delta = intval($delta / ($this->_base - $this->_tmin));
+        }
+        return intval($k + ($this->_base - $this->_tmin + 1) * $delta / ($delta + $this->_skew));
+    }
+    /**
+     * Encoding a certain digit
+     * @access   private
+     */
+    function _encode_digit($d)
+    {
+        return chr($d + 22 + 75 * ($d < 26));
+    }
+    /**
+     * Decode a certain digit
+     * @access   private
+     */
+    function _decode_digit($cp)
+    {
+        $cp = ord($cp);
+        return ($cp - 48 < 10) ? $cp - 22 : (($cp - 65 < 26) ? $cp - 65 : (($cp - 97 < 26) ? $cp - 97 : $this->_base));
+    }
+    /**
+     * Internal error handling method
+     * @access   private
+     */
+    function _error($error = '')
+    {
+        $this->_error = $error;
+    }
+    /**
+     * Do Nameprep according to RFC3491 and RFC3454
+     * @param    array    Unicode Characters
+     * @return   string   Unicode Characters, Nameprep'd
+     * @access   private
+     */
+    function _nameprep($input)
+    {
+        $output = array();
+        $error = false;
+        foreach ($input as $v) {
+            if (in_array($v, $this->NP['map_nothing'])) continue;
+            if (in_array($v, $this->NP['prohibit']) || in_array($v, $this->NP['general_prohibited'])) {
+                $this->_error('NAMEPREP: Prohibited input U+'.sprintf('%08X', $v));
+                return false;
+            }
+            foreach ($this->NP['prohibit_ranges'] as $range) {
+                if ($range[0] <= $v && $v <= $range[1]) {
+                    $this->_error('NAMEPREP: Prohibited input U+'.sprintf('%08X', $v));
+                    return false;
+                }
+            }
+            if (0xAC00 <= $v && $v <= 0xD7AF) {
+                foreach ($this->_hangul_decompose($v) as $out) {
+                    $output[] = (int) $out;
+                }
+            } elseif (isset($this->NP['replacemaps'][$v])) {
+                foreach ($this->_apply_cannonical_ordering($this->NP['replacemaps'][$v]) as $out) {
+                    $output[] = (int) $out;
+                }
+            } else {
+                $output[] = (int) $v;
+            }
+        }
+        $output = $this->_hangul_compose($output);
+        $last_class   = 0;
+        $last_starter = 0;
+        $out_len      = count($output);
+        for ($i = 0; $i < $out_len; ++$i) {
+            $class = $this->_get_combining_class($output[$i]);
+            if ((!$last_class || $last_class > $class) && $class) {
+                $seq_len = $i - $last_starter;
+                $out = $this->_combine(array_slice($output, $last_starter, $seq_len));
+                if ($out) {
+                    $output[$last_starter] = $out;
+                    if (count($out) != $seq_len) {
+                        for ($j = $i+1; $j < $out_len; ++$j) {
+                            $output[$j-1] = $output[$j];
+                        }
+                        unset($output[$out_len]);
+                    }
+                    $i--;
+                    $out_len--;
+                    $last_class = ($i == $last_starter) ? 0 : $this->_get_combining_class($output[$i-1]);
+                    continue;
+                }
+            }
+            if (!$class) $last_starter = $i;
+            $last_class = $class;
+        }
+        return $output;
+    }
+    /**
+     * Decomposes a Hangul syllable
+     * (see http://www.unicode.org/unicode/reports/tr15/#Hangul
+     * @param    integer  32bit UCS4 code point
+     * @return   array    Either Hangul Syllable decomposed or original 32bit value as one value array
+     * @access   private
+     */
+    function _hangul_decompose($char)
+    {
+        $sindex = (int) $char - $this->_sbase;
+        if ($sindex < 0 || $sindex >= $this->_scount) {
+            return array($char);
+        }
+        $result = array();
+        $result[] = (int) $this->_lbase + $sindex / $this->_ncount;
+        $result[] = (int) $this->_vbase + ($sindex % $this->_ncount) / $this->_tcount;
+        $T = intval($this->_tbase + $sindex % $this->_tcount);
+        if ($T != $this->_tbase) $result[] = $T;
+        return $result;
+    }
+    /**
+     * Ccomposes a Hangul syllable
+     * (see http://www.unicode.org/unicode/reports/tr15/#Hangul
+     * @param    array    Decomposed UCS4 sequence
+     * @return   array    UCS4 sequence with syllables composed
+     * @access   private
+     */
+    function _hangul_compose($input)
+    {
+        $inp_len = count($input);
+        if (!$inp_len) return array();
+        $result = array();
+        $last = (int) $input[0];
+        $result[] = $last; // copy first char from input to output
+        for ($i = 1; $i < $inp_len; ++$i) {
+            $char = (int) $input[$i];
+            $sindex = $last - $this->_sbase;
+            $lindex = $last - $this->_lbase;
+            $vindex = $char - $this->_vbase;
+            $tindex = $char - $this->_tbase;
+            if (0 <= $sindex && $sindex < $this->_scount && ($sindex % $this->_tcount == 0)
+                    && 0 <= $tindex && $tindex <= $this->_tcount) {
+                $last += $tindex;
+                $result[(count($result) - 1)] = $last; // reset last
+                continue; // discard char
+            }
+            if (0 <= $lindex && $lindex < $this->_lcount && 0 <= $vindex && $vindex < $this->_vcount) {
+                $last = (int) $this->_sbase + ($lindex * $this->_vcount + $vindex) * $this->_tcount;
+                $result[(count($result) - 1)] = $last; // reset last
+                continue; // discard char
+            }
+            $last = $char;
+            $result[] = $char;
+        }
+        return $result;
+    }
+    /**
+     * Returns the combining class of a certain wide char
+     * @param    integer    Wide char to check (32bit integer)
+     * @return   integer    Combining class if found, else 0
+     * @access   private
+     */
+    function _get_combining_class($char)
+    {
+        return isset($this->NP['norm_combcls'][$char]) ? $this->NP['norm_combcls'][$char] : 0;
+    }
+    /**
+     * Apllies the cannonical ordering of a decomposed UCS4 sequence
+     * @param    array      Decomposed UCS4 sequence
+     * @return   array      Ordered USC4 sequence
+     * @access   private
+     */
+    function _apply_cannonical_ordering($input)
+    {
+        $swap = true;
+        $size = count($input);
+        while ($swap) {
+            $swap = false;
+            $last = $this->_get_combining_class(intval($input[0]));
+            for ($i = 0; $i < $size-1; ++$i) {
+                $next = $this->_get_combining_class(intval($input[$i+1]));
+                if ($next != 0 && $last > $next) {
+                    for ($j = $i + 1; $j > 0; --$j) {
+                        if ($this->_get_combining_class(intval($input[$j-1])) <= $next) break;
+                        $t = intval($input[$j]);
+                        $input[$j] = intval($input[$j-1]);
+                        $input[$j-1] = $t;
+                        $swap = true;
+                    }
+                    $next = $last;
+                }
+                $last = $next;
+            }
+        }
+        return $input;
+    }
+    /**
+     * Do composition of a sequence of starter and non-starter
+     * @param    array      UCS4 Decomposed sequence
+     * @return   array      Ordered USC4 sequence
+     * @access   private
+     */
+    function _combine($input)
+    {
+        $inp_len = count($input);
+        foreach ($this->NP['replacemaps'] as $np_src => $np_target) {
+            if ($np_target[0] != $input[0]) continue;
+            if (count($np_target) != $inp_len) continue;
+            $hit = false;
+            foreach ($input as $k2 => $v2) {
+                if ($v2 == $np_target[$k2]) {
+                    $hit = true;
+                } else {
+                    $hit = false;
+                    break;
+                }
+            }
+            if ($hit) return $np_src;
+        }
+        return false;
+    }
+    /**
+     * This converts an UTF-8 encoded string to its UCS-4 representation
+     * By talking about UCS-4 "strings" we mean arrays of 32bit integers representing
+     * each of the "chars". This is due to PHP not being able to handle strings with
+     * bit depth different from 8. This apllies to the reverse method _ucs4_to_utf8(), too.
+     * The following UTF-8 encodings are supported:
+     * bytes bits  representation
+     * 1        7  0xxxxxxx
+     * 2       11  110xxxxx 10xxxxxx
+     * 3       16  1110xxxx 10xxxxxx 10xxxxxx
+     * 4       21  11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
+     * 5       26  111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
+     * 6       31  1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
+     * Each x represents a bit that can be used to store character data.
+     * The five and six byte sequences are part of Annex D of ISO/IEC 10646-1:2000
+     * @access   private
+     */
+    function _utf8_to_ucs4($input)
+    {
+        $output = array();
+        $out_len = 0;
+        $inp_len = strlen($input);
+        $mode = 'next';
+        $test = 'none';
+        for ($k = 0; $k < $inp_len; ++$k) {
+            $v = ord($input{$k}); // Extract byte from input string
+            if ($v < 128) { // We found an ASCII char - put into stirng as is
+                $output[$out_len] = $v;
+                ++$out_len;
+                if ('add' == $mode) {
+                    $this->_error('Conversion from UTF-8 to UCS-4 failed: malformed input at byte '.$k);
+                    return false;
+                }
+                continue;
+            }
+            if ('next' == $mode) { // Try to find the next start byte; determine the width of the Unicode char
+                $start_byte = $v;
+                $mode = 'add';
+                $test = 'range';
+                if ($v >> 5 == 6) { // &110xxxxx 10xxxxx
+                    $next_byte = 0; // Tells, how many times subsequent bitmasks must rotate 6bits to the left
+                    $v = ($v - 192) << 6;
+                } elseif ($v >> 4 == 14) { // &1110xxxx 10xxxxxx 10xxxxxx
+                    $next_byte = 1;
+                    $v = ($v - 224) << 12;
+                } elseif ($v >> 3 == 30) { // &11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
+                    $next_byte = 2;
+                    $v = ($v - 240) << 18;
+                } elseif ($v >> 2 == 62) { // &111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
+                    $next_byte = 3;
+                    $v = ($v - 248) << 24;
+                } elseif ($v >> 1 == 126) { // &1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
+                    $next_byte = 4;
+                    $v = ($v - 252) << 30;
+                } else {
+                    $this->_error('This might be UTF-8, but I don\'t understand it at byte '.$k);
+                    return false;
+                }
+                if ('add' == $mode) {
+                    $output[$out_len] = (int) $v;
+                    ++$out_len;
+                    continue;
+                }
+            }
+            if ('add' == $mode) {
+                if (!$this->_allow_overlong && $test == 'range') {
+                    $test = 'none';
+                    if (($v < 0xA0 && $start_byte == 0xE0) || ($v < 0x90 && $start_byte == 0xF0) || ($v > 0x8F && $start_byte == 0xF4)) {
+                        $this->_error('Bogus UTF-8 character detected (out of legal range) at byte '.$k);
+                        return false;
+                    }
+                }
+                if ($v >> 6 == 2) { // Bit mask must be 10xxxxxx
+                    $v = ($v - 128) << ($next_byte * 6);
+                    $output[($out_len - 1)] += $v;
+                    --$next_byte;
+                } else {
+                    $this->_error('Conversion from UTF-8 to UCS-4 failed: malformed input at byte '.$k);
+                    return false;
+                }
+                if ($next_byte < 0) {
+                    $mode = 'next';
+                }
+            }
+        } // for
+        return $output;
+    }
+    /**
+     * Convert UCS-4 string into UTF-8 string
+     * See _utf8_to_ucs4() for details
+     * @access   private
+     */
+    function _ucs4_to_utf8($input)
+    {
+        $output = '';
+        $k = 0;
+        foreach ($input as $v) {
+            ++$k;
+            if ($v < 128) { // 7bit are transferred literally
+                $output .= chr($v);
+            } elseif ($v < (1 << 11)) { // 2 bytes
+                $output .= chr(192 + ($v >> 6)) . chr(128 + ($v & 63));
+            } elseif ($v < (1 << 16)) { // 3 bytes
+                $output .= chr(224 + ($v >> 12)) . chr(128 + (($v >> 6) & 63)) . chr(128 + ($v & 63));
+            } elseif ($v < (1 << 21)) { // 4 bytes
+                $output .= chr(240 + ($v >> 18)) . chr(128 + (($v >> 12) & 63))
+                         . chr(128 + (($v >> 6) & 63)) . chr(128 + ($v & 63));
+            } elseif ($v < (1 << 26)) { // 5 bytes
+                $output .= chr(248 + ($v >> 24)) . chr(128 + (($v >> 18) & 63))
+                         . chr(128 + (($v >> 12) & 63)) . chr(128 + (($v >> 6) & 63))
+                         . chr(128 + ($v & 63));
+            } elseif ($v < (1 << 31)) { // 6 bytes
+                $output .= chr(252 + ($v >> 30)) . chr(128 + (($v >> 24) & 63))
+                         . chr(128 + (($v >> 18) & 63)) . chr(128 + (($v >> 12) & 63))
+                         . chr(128 + (($v >> 6) & 63)) . chr(128 + ($v & 63));
+            } else {
+                $this->_error('Conversion from UCS-4 to UTF-8 failed: malformed input at byte '.$k);
+                return false;
+            }
+        }
+        return $output;
+    }
+    /**
+      * Convert UCS-4 array into UCS-4 string
+      *
+      * @access   private
+      */
+    function _ucs4_to_ucs4_string($input)
+    {
+        $output = '';
+        foreach ($input as $v) {
+            $output .= chr(($v >> 24) & 255).chr(($v >> 16) & 255).chr(($v >> 8) & 255).chr($v & 255);
+        }
+        return $output;
+    }
+    /**
+      * Convert UCS-4 strin into UCS-4 garray
+      *
+      * @access   private
+      */
+    function _ucs4_string_to_ucs4($input)
+    {
+        $output = array();
+        $inp_len = strlen($input);
+        if ($inp_len % 4) {
+            $this->_error('Input UCS4 string is broken');
+            return false;
+        }
+        if (!$inp_len) return $output;
+        for ($i = 0, $out_len = -1; $i < $inp_len; ++$i) {
+            if (!($i % 4)) {
+                $out_len++;
+                $output[$out_len] = 0;
+            }
+            $output[$out_len] += ord($input{$i}) << (8 * (3 - ($i % 4) ) );
+        }
+        return $output;
+    }
+}
+/**
+* Adapter class for aligning the API of idna_convert with that of Net_IDNA
+* @author  Matthias Sommerfeld <mso@phlylabs.de>
+*/
+class Net_IDNA_php4 extends idna_convert
+{
+    /**
+     * Sets a new option value. Available options and values:
+     * [encoding - Use either UTF-8, UCS4 as array or UCS4 as string as input ('utf8' for UTF-8,
+     *         'ucs4_string' and 'ucs4_array' respectively for UCS4); The output is always UTF-8]
+     * [overlong - Unicode does not allow unnecessarily long encodings of chars,
+     *             to allow this, set this parameter to true, else to false;
+     *             default is false.]
+     * [strict - true: strict mode, good for registration purposes - Causes errors
+     *           on failures; false: loose mode, ideal for "wildlife" applications
+     *           by silently ignoring errors and returning the original input instead
+     *
+     * @param    mixed     Parameter to set (string: single parameter; array of Parameter => Value pairs)
+     * @param    string    Value to use (if parameter 1 is a string)
+     * @return   boolean   true on success, false otherwise
+     * @access   public
+     */
+    function setParams($option, $param = false)
+    {
+        return $this->IC->set_parameters($option, $param);
+    }
+}
+?>

--- a/src/whois.ie.php
+++ b/src/whois.ie.php
@@ -1,51 +1,50 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__IE_HANDLER__'))
-    define('__IE_HANDLER__', 1);
+	define('__IE_HANDLER__', 1);
 require_once('whois.parser.php');
-class ie_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'nic-hdl' => 'handle',
-            'person' => 'name',
-            'renewal' => 'expires'
-        );
-        $contacts = array(
-            'admin-c' => 'admin',
-            'tech-c' => 'tech',
-        );
-        $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
-        if (isset($reg['domain']['descr'])) {
-            $reg['owner']['organization'] = $reg['domain']['descr'][0];
-            unset($reg['domain']['descr']);
-        }
-        $r = array();
-        $r['regrinfo'] = $reg;
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.domainregistry.ie',
-            'registrar' => 'IE Domain Registry'
-        );
-        return $r;
-    }
-}
+class ie_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+			'nic-hdl' => 'handle',
+			'person' => 'name',
+			'renewal' => 'expires'
+			);
+		$contacts = array(
+                    'admin-c' => 'admin',
+                    'tech-c' => 'tech',
+		                );
+		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
+		if (isset($reg['domain']['descr']))
+			{
+			$reg['owner']['organization'] = $reg['domain']['descr'][0];
+			unset($reg['domain']['descr']);
+			}
+		$r['regrinfo'] = $reg;
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.domainregistry.ie',
+                    'registrar' => 'IE Domain Registry'
+                    );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.il.php
+++ b/src/whois.il.php
@@ -1,83 +1,87 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__IL_HANDLER__'))
-    define('__IL_HANDLER__', 1);
+	define('__IL_HANDLER__', 1);
 require_once('whois.parser.php');
-class il_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'fax-no' => 'fax',
-            'e-mail' => 'email',
-            'nic-hdl' => 'handle',
-            'person' => 'name',
-            'personname' => 'name',
-            'address' => 'address'/* ,
-                  'address' => 'address.city',
-                  'address' => 'address.pcode',
-                  'address' => 'address.country' */
-        );
-        $contacts = array(
-            'registrant' => 'owner',
-            'admin-c' => 'admin',
-            'tech-c' => 'tech',
-            'billing-c' => 'billing',
-            'zone-c' => 'zone'
-        );
-        array_splice($data_str['rawdata'], 16, 1);
-        array_splice($data_str['rawdata'], 18, 1);
-        $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
-        if (isset($reg['domain']['remarks']))
-            unset($reg['domain']['remarks']);
-        if (isset($reg['domain']['descr:'])) {
-            foreach ($reg['domain']['descr:'] as $key => $val) {
-                $v = trim(substr(strstr($val, ':'), 1));
-                if (strstr($val, '[organization]:')) {
-                    $reg['owner']['organization'] = $v;
-                    continue;
-                }
-                if (strstr($val, '[phone]:')) {
-                    $reg['owner']['phone'] = $v;
-                    continue;
-                }
-                if (strstr($val, '[fax-no]:')) {
-                    $reg['owner']['fax'] = $v;
-                    continue;
-                }
-                if (strstr($val, '[e-mail]:')) {
-                    $reg['owner']['email'] = $v;
-                    continue;
-                }
-                $reg['owner']['address'][$key] = $v;
-            }
-            unset($reg['domain']['descr:']);
-        }
-        $r = array();
-        $r['regrinfo'] = $reg;
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.isoc.org.il/',
-            'registrar' => 'ISOC-IL'
-        );
-        return $r;
-    }
-}
+class il_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+			'fax-no' => 'fax',
+			'e-mail' => 'email',
+			'nic-hdl' => 'handle',
+			'person' => 'name',
+			'personname' => 'name',
+			'address' => 'address'/*,
+			'address' => 'address.city',
+			'address' => 'address.pcode',
+			'address' => 'address.country'*/
+			);
+		$contacts = array(
+                    'registrant' => 'owner',
+                    'admin-c' => 'admin',
+                    'tech-c' => 'tech',
+                    'billing-c' => 'billing',
+                    'zone-c' => 'zone'
+		                );
+array_splice($data_str['rawdata'],16,1);
+array_splice($data_str['rawdata'],18,1);
+		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
+		if (isset($reg['domain']['remarks']))
+			unset($reg['domain']['remarks']);
+		if (isset($reg['domain']['descr:']))
+			{
+			while (list($key, $val) = each($reg['domain']['descr:']))
+				{
+				$v = trim(substr(strstr($val, ':'), 1));
+				if (strstr($val, '[organization]:'))
+					{
+					$reg['owner']['organization'] = $v;
+					continue;
+					}
+				if (strstr($val, '[phone]:'))
+					{
+					$reg['owner']['phone'] = $v;
+					continue;
+					}
+				if (strstr($val, '[fax-no]:'))
+					{
+					$reg['owner']['fax'] = $v;
+					continue;
+					}
+				if (strstr($val, '[e-mail]:'))
+					{
+					$reg['owner']['email'] = $v;
+					continue;
+					}
+				$reg['owner']['address'][$key] = $v;
+				}
+			if (isset($reg['domain']['descr:'])) unset($reg['domain']['descr:']);
+			}
+		$r['regrinfo'] = $reg;
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.isoc.org.il/',
+                    'registrar' => 'ISOC-IL'
+                    );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.in.php
+++ b/src/whois.in.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__IN_HANDLER__'))
-    define('__IN_HANDLER__', 1);
+	define('__IN_HANDLER__', 1);
 require_once('whois.parser.php');
-class in_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        $r['regyinfo'] = array(
-            'referrer' => 'http://whois.registry.in',
-            'registrar' => 'INRegistry'
-        );
-        return $r;
-    }
-}
+class in_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://whois.registry.in',
+                          'registrar' => 'INRegistry'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.info.php
+++ b/src/whois.info.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__INFO_HANDLER__'))
-    define('__INFO_HANDLER__', 1);
+	define('__INFO_HANDLER__', 1);
 require_once('whois.parser.php');
-class info_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        $r['regyinfo'] = array(
-            'referrer' => 'http://whois.afilias.info',
-            'registrar' => 'Afilias Global Registry Services'
-        );
-        return $r;
-    }
-}
+class info_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://whois.afilias.info',
+                          'registrar' => 'Afilias Global Registry Services'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.int.php
+++ b/src/whois.int.php
@@ -1,36 +1,34 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__INT_HANDLER__'))
-    define('__INT_HANDLER__', 1);
+	define('__INT_HANDLER__', 1);
 require_once('whois.gtld.iana.php');
-class int_handler {
-    function parse($data_str, $query) {
-        $iana = new iana_handler();
-        $r = array();
-        $r['regrinfo'] = $iana->parse($data_str['rawdata'], $query);
-        $r['regyinfo']['referrer'] = 'http://www.iana.org/int-dom/int.htm';
-        $r['regyinfo']['registrar'] = 'Internet Assigned Numbers Authority';
-        return $r;
-    }
-}
+class int_handler
+	{
+	function parse($data_str, $query)
+		{
+		$iana = new iana_handler();
+		$r['regrinfo'] = $iana->parse($data_str['rawdata'], $query);
+		$r['regyinfo']['referrer'] = 'http://www.iana.org/int-dom/int.htm';
+		$r['regyinfo']['registrar'] = 'Internet Assigned Numbers Authority';
+		return ($r);
+		}
+	}
+?>

--- a/src/whois.ip.afrinic.php
+++ b/src/whois.ip.afrinic.php
@@ -1,60 +1,61 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__AFRINIC_HANDLER__'))
-    define('__AFRINIC_HANDLER__', 1);
-class afrinic_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'fax-no' => 'fax',
-            'e-mail' => 'email',
-            'nic-hdl' => 'handle',
-            'person' => 'name',
-            'netname' => 'name',
-            'organisation' => 'handle',
-            'org-name' => 'organization',
-            'org-type' => 'type'
-        );
-        $contacts = array(
-            'admin-c' => 'admin',
-            'tech-c' => 'tech',
-            'org' => 'owner'
-        );
-        $r = generic_parser_a($data_str, $translate, $contacts, 'network', 'Ymd');
-        if (isset($r['network']['descr'])) {
-            $r['owner']['organization'] = $r['network']['descr'];
-            unset($r['network']['descr']);
-        }
-        if (isset($r['owner']['remarks']) && is_array($r['owner']['remarks']))
-            foreach ($r['owner']['remarks'] as $val) {
-                $pos = strpos($val, 'rwhois://');
-                if ($pos !== false)
-                    $r['rwhois'] = strtok(substr($val, $pos), ' ');
-            }
-        $r = array('regrinfo' => $r);
-        $r['regyinfo']['type'] = 'ip';
-        $r['regyinfo']['registrar'] = 'African Network Information Center';
-        return $r;
-    }
-}
+	define('__AFRINIC_HANDLER__', 1);
+class afrinic_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+                      'fax-no' => 'fax',
+                      'e-mail' => 'email',
+                      'nic-hdl' => 'handle',
+                      'person' => 'name',
+                      'netname' => 'name',
+                      'organisation' => 'handle',
+                      'org-name' => 'organization',
+                      'org-type' => 'type'
+		                  );
+		$contacts = array(
+                      'admin-c' => 'admin',
+                      'tech-c' => 'tech',
+                      'org' => 'owner'
+		                  );
+		$r = generic_parser_a($data_str, $translate, $contacts, 'network', 'Ymd');
+		if (isset($r['network']['descr']))
+			{
+			$r['owner']['organization'] = $r['network']['descr'];
+			unset($r['network']['descr']);
+			}
+		if (isset($r['owner']['remarks']) && is_array($r['owner']['remarks']))
+			while (list($key, $val) = each($r['owner']['remarks']))
+				{
+				$pos = strpos($val,'rwhois://');
+				if ($pos!==false)
+					$r['rwhois'] = strtok(substr($val,$pos),' ');
+				}
+		$r = array( 'regrinfo' => $r );
+		$r['regyinfo']['type'] = 'ip';
+		$r['regyinfo']['registrar'] = 'African Network Information Center';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.ip.apnic.php
+++ b/src/whois.ip.apnic.php
@@ -1,95 +1,99 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
 require_once('whois.parser.php');
-if (!defined('__APNIC_HANDLER__'))
-    define('__APNIC_HANDLER__', 1);
-class apnic_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'fax-no' => 'fax',
-            'e-mail' => 'email',
-            'nic-hdl' => 'handle',
-            'person' => 'name',
-            'country' => 'address',
-            'netname' => 'name',
-            'descr' => 'desc',
-            'aut-num' => 'handle',
-            'country' => 'country'
-        );
-        $contacts = array(
-            'admin-c' => 'admin',
-            'tech-c' => 'tech'
-        );
-        $blocks = generic_parser_a_blocks($data_str, $translate, $disclaimer);
-        $r = array();
-        if (isset($disclaimer) && is_array($disclaimer))
-            $r['disclaimer'] = $disclaimer;
-        if (empty($blocks) || !is_array($blocks['main'])) {
-            $r['registered'] = 'no';
-        } else {
-            if (isset($blocks[$query])) {
-                $as = true;
-                $rb = $blocks[$query];
-            } else {
-                $rb = $blocks['main'];
-                $as = false;
-            }
-            $r['registered'] = 'yes';
-            foreach ($contacts as $key => $val) {
-                if (isset($rb[$key])) {
-                    if (is_array($rb[$key])) {
-                        $blk = $rb[$key][count($rb[$key]) - 1];
-                    } else {
-                        $blk = $rb[$key];
-                    }
-                    if (isset($blocks[$blk])) {
-                        $r[$val] = $blocks[$blk];
-                    }
-                    unset($rb[$key]);
-                }
-            }
-            $r['network'] = $rb;
-            format_dates($r, 'Ymd');
-            if (isset($r['network']['desc'])) {
-                if (is_array($r['network']['desc'])) {
-                    $r['owner']['organization'] = array_shift($r['network']['desc']);
-                    $r['owner']['address'] = $r['network']['desc'];
-                } else
-                    $r['owner']['organization'] = $r['network']['desc'];
-                unset($r['network']['desc']);
-            }
-            if (isset($r['network']['address'])) {
-                if (isset($r['owner']['address']))
-                    $r['owner']['address'][] = $r['network']['address'];
-                else
-                    $r['owner']['address'] = $r['network']['address'];
-                unset($r['network']['address']);
-            }
-        }
-        $r = array('regrinfo' => $r);
-        $r['regyinfo']['type'] = 'ip';
-        $r['regyinfo']['registrar'] = 'Asia Pacific Network Information Centre';
-        return $r;
-    }
+if(!defined('__APNIC_HANDLER__'))
+  define('__APNIC_HANDLER__',1);
+class apnic_handler
+	{
+	function parse ($data_str, $query)
+		{
+		$translate = array (
+							'fax-no' => 'fax',
+							'e-mail' => 'email',
+							'nic-hdl' => 'handle',
+							'person' => 'name',
+							'country' => 'address',
+							'netname' => 'name',
+							'descr' => 'desc',
+							'aut-num' => 'handle',
+							'country' => 'country'
+							  );
+		$contacts = array (
+							  'admin-c' => 'admin',
+							  'tech-c' => 'tech'
+							  );
+		$blocks = generic_parser_a_blocks($data_str,$translate,$disclaimer);
+		if (isset($disclaimer) && is_array($disclaimer)) $r['disclaimer'] = $disclaimer;
+		if (empty($blocks) || !is_array($blocks['main']))
+			{
+			$r['registered'] = 'no';
+			}
+		else
+			{
+			if (isset($blocks[$query]))
+				{
+				$as = true;
+				$rb = $blocks[$query];
+				}
+			else
+				{
+				$rb = $blocks['main'];
+				$as = false;
+				}
+			$r['registered'] = 'yes';
+			while (list($key,$val) = each($contacts))
+				if (isset($rb[$key]))
+					{
+					if (is_array($rb[$key]))
+						$blk = $rb[$key][count($rb[$key])-1];
+					else
+						$blk = $rb[$key];
+					if (isset($blocks[$blk])) $r[$val] = $blocks[$blk];
+					unset($rb[$key]);
+					}
+			$r['network'] = $rb;
+			format_dates($r,'Ymd');
+			if (isset($r['network']['desc']))
+				{
+				if (is_array($r['network']['desc']))
+					{
+					$r['owner']['organization'] = array_shift($r['network']['desc']);
+					$r['owner']['address'] = $r['network']['desc'];
+					}
+				else
+					$r['owner']['organization'] = $r['network']['desc'];
+				unset($r['network']['desc']);
+				}
+			if (isset($r['network']['address']))
+				{
+				if (isset($r['owner']['address']))
+					$r['owner']['address'][] = $r['network']['address'];
+				else
+					$r['owner']['address'] = $r['network']['address'];
+				unset($r['network']['address']);
+				}
+			}
+		$r = array( 'regrinfo' => $r );
+		$r['regyinfo']['type'] ='ip';
+		$r['regyinfo']['registrar'] = 'Asia Pacific Network Information Centre';
+		return $r;
+		}
 }
+?>

--- a/src/whois.ip.arin.php
+++ b/src/whois.ip.arin.php
@@ -1,65 +1,64 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ARIN_HANDLER__'))
-    define('__ARIN_HANDLER__', 1);
+	define('__ARIN_HANDLER__', 1);
 require_once('whois.parser.php');
-class arin_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'OrgName:' => 'owner.organization',
-            'CustName:' => 'owner.organization',
-            'OrgId:' => 'owner.handle',
-            'Address:' => 'owner.address.street.',
-            'City:' => 'owner.address.city',
-            'StateProv:' => 'owner.address.state',
-            'PostalCode:' => 'owner.address.pcode',
-            'Country:' => 'owner.address.country',
-            'NetRange:' => 'network.inetnum',
-            'NetName:' => 'network.name',
-            'NetHandle:' => 'network.handle',
-            'NetType:' => 'network.status',
-            'NameServer:' => 'network.nserver.',
-            'Comment:' => 'network.desc.',
-            'RegDate:' => 'network.created',
-            'Updated:' => 'network.changed',
-            'ASHandle:' => 'network.handle',
-            'ASName:' => 'network.name',
-            'NetHandle:' => 'network.handle',
-            'NetName:' => 'network.name',
-            'TechHandle:' => 'tech.handle',
-            'TechName:' => 'tech.name',
-            'TechPhone:' => 'tech.phone',
-            'TechEmail:' => 'tech.email',
-            'OrgAbuseName:' => 'abuse.name',
-            'OrgAbuseHandle:' => 'abuse.handle',
-            'OrgAbusePhone:' => 'abuse.phone',
-            'OrgAbuseEmail:' => 'abuse.email.',
-            'ReferralServer:' => 'rwhois'
-        );
-        $r = generic_parser_b($data_str, $items, 'ymd', false, true);
-        if (@isset($r['abuse']['email']))
-            $r['abuse']['email'] = implode(',', $r['abuse']['email']);
-        return array('regrinfo' => $r);
-    }
-}
+class arin_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'OrgName:' 	=> 'owner.organization',
+                  'CustName:' 	=> 'owner.organization',
+                  'OrgId:' 		=> 'owner.handle',
+                  'Address:' 	=> 'owner.address.street.',
+                  'City:' 		=> 'owner.address.city',
+                  'StateProv:' 	=> 'owner.address.state',
+                  'PostalCode:' => 'owner.address.pcode',
+                  'Country:' 	=> 'owner.address.country',
+                  'NetRange:' 	=> 'network.inetnum',
+                  'NetName:' 	=> 'network.name',
+                  'NetHandle:' 	=> 'network.handle',
+                  'NetType:' 	=> 'network.status',
+                  'NameServer:' => 'network.nserver.',
+                  'Comment:' 	=> 'network.desc.',
+                  'RegDate:' 	=> 'network.created',
+                  'Updated:' 	=> 'network.changed',
+                  'ASHandle:' 	=> 'network.handle',
+                  'ASName:' 	=> 'network.name',
+                  'NetHandle:' 	=> 'network.handle',
+                  'NetName:' 	=> 'network.name',
+                  'TechHandle:' => 'tech.handle',
+                  'TechName:' 	=> 'tech.name',
+                  'TechPhone:' 	=> 'tech.phone',
+                  'TechEmail:' 	=> 'tech.email',
+                  'OrgAbuseName:' 	=> 'abuse.name',
+                  'OrgAbuseHandle:' => 'abuse.handle',
+                  'OrgAbusePhone:' 	=> 'abuse.phone',
+                  'OrgAbuseEmail:' 	=> 'abuse.email.',
+                  'ReferralServer:' => 'rwhois'
+		              );
+		$r = generic_parser_b($data_str, $items, 'ymd', false, true);
+		if (@isset($r['abuse']['email']))
+		    $r['abuse']['email'] = implode(',',$r['abuse']['email']);
+		return array( 'regrinfo' => $r );
+		}
+	}
+?>

--- a/src/whois.ip.krnic.php
+++ b/src/whois.ip.krnic.php
@@ -1,91 +1,88 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__KRNIC_HANDLER__'))
-    define('__KRNIC_HANDLER__', 1);
+	define('__KRNIC_HANDLER__', 1);
 require_once('whois.parser.php');
-class krnic_handler {
-    function parse($data_str, $query) {
-        $blocks = array(
-            'owner1' => '[ Organization Information ]',
-            'tech1' => '[ Technical Contact Information ]',
-            'owner2' => '[ ISP Organization Information ]',
-            'admin2' => '[ ISP IP Admin Contact Information ]',
-            'tech2' => '[ ISP IP Tech Contact Information ]',
-            'admin3' => '[ ISP IPv4 Admin Contact Information ]',
-            'tech3' => '[ ISP IPv4 Tech Contact Information ]',
-            'abuse' => '[ ISP Network Abuse Contact Information ]',
-            'network.inetnum' => 'IPv4 Address       :',
-            'network.name' => 'Network Name       :',
-            'network.mnt-by' => 'Connect ISP Name   :',
-            'network.created' => 'Registration Date  :'
-        );
-        $items = array(
-            'Orgnization ID     :' => 'handle',
-            'Org Name      :' => 'organization',
-            'Org Name           :' => 'organization',
-            'Name          :' => 'name',
-            'Name               :' => 'name',
-            'Org Address   :' => 'address.street',
-            'Zip Code      :' => 'address.pcode',
-            'State         :' => 'address.state',
-            'Address            :' => 'address.street',
-            'Zip Code           :' => 'address.pcode',
-            'Phone         :' => 'phone',
-            'Phone              :' => 'phone',
-            'Fax           :' => 'fax',
-            'E-Mail        :' => 'email',
-            'E-Mail             :' => 'email'
-        );
-        $b = get_blocks($data_str, $blocks);
-        $r = array();
-        if (isset($b['network'])) {
-            $r['network'] = $b['network'];
-        }
-        if (isset($b['owner1'])) {
-            $r['owner'] = generic_parser_b($b['owner1'], $items, 'Ymd', false);
-        } elseif (isset($b['owner2'])) {
-            $r['owner'] = generic_parser_b($b['owner2'], $items, 'Ymd', false);
-        }
-        if (isset($b['admin2'])) {
-            $r['admin'] = generic_parser_b($b['admin2'], $items, 'Ymd', false);
-        } elseif (isset($b['admin3'])) {
-            $r['admin'] = generic_parser_b($b['admin3'], $items, 'Ymd', false);
-        }
-        if (isset($b['tech1'])) {
-            $r['tech'] = generic_parser_b($b['tech1'], $items, 'Ymd', false);
-        } elseif (isset($b['tech2'])) {
-            $r['tech'] = generic_parser_b($b['tech2'], $items, 'Ymd', false);
-        } elseif (isset($b['tech3'])) {
-            $r['tech'] = generic_parser_b($b['tech3'], $items, 'Ymd', false);
-        }
-        if (isset($b['abuse'])) {
-            $r['abuse'] = generic_parser_b($b['abuse'], $items, 'Ymd', false);
-        }
-        $r = format_dates($r, 'Ymd');
-        $r = array('regrinfo' => $r);
-        $r['regyinfo']['type'] = 'ip';
-        $r['regyinfo']['registrar'] = 'Korean Network Information Centre';
-        return $r;
-    }
-}
+class krnic_handler
+	{
+	function parse($data_str, $query)
+		{
+		$blocks = array(
+                    'owner1' => '[ Organization Information ]',
+                    'tech1' => '[ Technical Contact Information ]',
+                    'owner2' => '[ ISP Organization Information ]',
+                    'admin2' => '[ ISP IP Admin Contact Information ]',
+                    'tech2' => '[ ISP IP Tech Contact Information ]',
+                    'admin3' => '[ ISP IPv4 Admin Contact Information ]',
+                    'tech3' => '[ ISP IPv4 Tech Contact Information ]',
+                    'abuse' => '[ ISP Network Abuse Contact Information ]',
+                    'network.inetnum' => 'IPv4 Address       :',
+                    'network.name' => 'Network Name       :',
+                    'network.mnt-by' => 'Connect ISP Name   :',
+                    'network.created' => 'Registration Date  :'
+		              );
+		$items = array(
+                    'Orgnization ID     :' => 'handle',
+                    'Org Name      :' => 'organization',
+                    'Org Name           :' => 'organization',
+                    'Name          :' => 'name',
+                    'Name               :' => 'name',
+                    'Org Address   :' => 'address.street',
+                    'Zip Code      :' => 'address.pcode',
+                    'State         :' => 'address.state',
+                    'Address            :' => 'address.street',
+                    'Zip Code           :' => 'address.pcode',
+                    'Phone         :' => 'phone',
+                    'Phone              :' => 'phone',
+                    'Fax           :' => 'fax',
+                    'E-Mail        :' => 'email',
+                    'E-Mail             :' => 'email'
+		              );
+		$b = get_blocks($data_str, $blocks);
+		if (isset($b['network']))
+			$r['network'] = $b['network'];
+		if (isset($b['owner1']))
+			$r['owner'] = generic_parser_b($b['owner1'], $items, 'Ymd', false);
+		else
+			if (isset($b['owner2']))
+				$r['owner'] = generic_parser_b($b['owner2'], $items, 'Ymd', false);
+		if (isset($b['admin2']))
+			$r['admin'] = generic_parser_b($b['admin2'], $items, 'Ymd', false);
+		else
+			if (isset($b['admin3']))
+				$r['admin'] = generic_parser_b($b['admin3'], $items, 'Ymd', false);
+		if (isset($b['tech1']))
+			$r['tech'] = generic_parser_b($b['tech1'], $items, 'Ymd', false);
+		else
+			if (isset($b['tech2']))
+				$r['tech'] = generic_parser_b($b['tech2'], $items, 'Ymd', false);
+			else
+				if (isset($b['tech3']))
+					$r['tech'] = generic_parser_b($b['tech3'], $items, 'Ymd', false);
+		if (isset($b['abuse']))
+			$r['abuse'] = generic_parser_b($b['abuse'], $items, 'Ymd', false);
+		$r = format_dates($r, 'Ymd');
+		$r = array( 'regrinfo' => $r );
+		$r['regyinfo']['type'] ='ip';
+		$r['regyinfo']['registrar'] = 'Korean Network Information Centre';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.ip.lacnic.php
+++ b/src/whois.ip.lacnic.php
@@ -1,64 +1,63 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__LACNIC_HANDLER__'))
-    define('__LACNIC_HANDLER__', 1);
-class lacnic_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'fax-no' => 'fax',
-            'e-mail' => 'email',
-            'nic-hdl-br' => 'handle',
-            'nic-hdl' => 'handle',
-            'person' => 'name',
-            'netname' => 'name',
-            'descr' => 'desc',
-            'country' => 'address.country'
-        );
-        $contacts = array(
-            'owner-c' => 'owner',
-            'tech-c' => 'tech',
-            'abuse-c' => 'abuse',
-            'admin-c' => 'admin'
-        );
-        $r = generic_parser_a($data_str, $translate, $contacts, 'network');
-        unset($r['network']['owner']);
-        unset($r['network']['ownerid']);
-        unset($r['network']['responsible']);
-        unset($r['network']['address']);
-        unset($r['network']['phone']);
-        unset($r['network']['aut-num']);
-        unset($r['network']['nsstat']);
-        unset($r['network']['nslastaa']);
-        unset($r['network']['inetrev']);
-        if (!empty($r['network']['aut-num']))
-            $r['network']['handle'] = $r['network']['aut-num'];
-        if (isset($r['network']['nserver']))
-            $r['network']['nserver'] = array_unique($r['network']['nserver']);
-        $r = array('regrinfo' => $r);
-        $r['regyinfo']['type'] = 'ip';
-        $r['regyinfo']['registrar'] = 'Latin American and Caribbean IP address Regional Registry';
-        return $r;
-    }
-}
+	define('__LACNIC_HANDLER__', 1);
+class lacnic_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+                      'fax-no' => 'fax',
+                      'e-mail' => 'email',
+                      'nic-hdl-br' => 'handle',
+                      'nic-hdl' => 'handle',
+                      'person' => 'name',
+                      'netname' => 'name',
+                      'descr' => 'desc',
+                      'country' => 'address.country'
+		                  );
+		$contacts = array(
+                      'owner-c' => 'owner',
+                      'tech-c' => 'tech',
+                      'abuse-c' => 'abuse',
+                      'admin-c' => 'admin'
+		                  );
+		$r = generic_parser_a($data_str, $translate, $contacts, 'network');
+		unset($r['network']['owner']);
+		unset($r['network']['ownerid']);
+		unset($r['network']['responsible']);
+		unset($r['network']['address']);
+		unset($r['network']['phone']);
+		unset($r['network']['aut-num']);
+		unset($r['network']['nsstat']);
+		unset($r['network']['nslastaa']);
+		unset($r['network']['inetrev']);
+		if (!empty($r['network']['aut-num']))
+			$r['network']['handle'] = $r['network']['aut-num'];
+		if (isset($r['network']['nserver']))
+			$r['network']['nserver'] = array_unique($r['network']['nserver']);
+		$r = array( 'regrinfo' => $r );
+		$r['regyinfo']['type'] ='ip';
+		$r['regyinfo']['registrar'] = 'Latin American and Caribbean IP address Regional Registry';
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.ip.lib.php
@@ -0,0 +1,86 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+function phpwhois_validip($ip)
+{
+	if (empty($ip))
+		return false;
+	if ((ip2long($ip) == -1) or (ip2long($ip) === false))
+		return false;
+	$reserved_ips = array (
+			array('0.0.0.0','2.255.255.255'),
+			array('10.0.0.0','10.255.255.255'),
+			array('127.0.0.0','127.255.255.255'),
+			array('169.254.0.0','169.254.255.255'),
+			array('172.16.0.0','172.31.255.255'),
+			array('192.0.2.0','192.0.2.255'),
+			array('192.168.0.0','192.168.255.255'),
+			array('255.255.255.0','255.255.255.255')
+			);
+	foreach ($reserved_ips as $r)
+		{
+		$min = ip2long($r[0]);
+		$max = ip2long($r[1]);
+		if ((ip2long($ip) >= $min) && (ip2long($ip) <= $max)) return false;
+		}
+	return true;
+}
+function phpwhois_getclientip()
+{
+	if (!empty($_SERVER['HTTP_CLIENT_IP']) && phpwhois_validip($_SERVER['HTTP_CLIENT_IP']))
+			return $_SERVER['HTTP_CLIENT_IP'];
+	if (!empty($_SERVER['HTTP_X_FORWARDED_FOR']))
+		foreach (explode(',',$_SERVER['HTTP_X_FORWARDED_FOR']) as $ip)
+			if (phpwhois_validip(trim($ip)))
+				return $ip;
+   if (!empty($_SERVER['HTTP_X_FORWARDED']) && phpwhois_validip($_SERVER['HTTP_X_FORWARDED']))
+       return $_SERVER['HTTP_X_FORWARDED'];
+   if (!empty($_SERVER['HTTP_FORWARDED_FOR']) && phpwhois_validip($_SERVER['HTTP_FORWARDED_FOR']))
+       return $_SERVER['HTTP_FORWARDED_FOR'];
+   if (!empty($_SERVER['HTTP_FORWARDED']) && phpwhois_validip($_SERVER['HTTP_FORWARDED']))
+       return $_SERVER['HTTP_FORWARDED'];
+   if (!empty($_SERVER['HTTP_X_FORWARDED']) && phpwhois_validip($_SERVER['HTTP_X_FORWARDED']))
+       return $_SERVER['HTTP_X_FORWARDED'];
+   return $_SERVER['REMOTE_ADDR'];
+}
+function phpwhois_cidr_conv($net)
+{
+	$start = strtok($net, '/');
+	$n = 3-substr_count($net, '.');
+	if ($n > 0)
+		{
+		for ($i = $n; $i > 0; $i--)
+			$start.= '.0';
+		}
+	$bits1 = str_pad(decbin(ip2long($start)), 32, '0', 'STR_PAD_LEFT');
+	$net = pow(2, (32-substr(strstr($net, '/'), 1))) - 1;
+	$bits2 = str_pad(decbin($net), 32, '0', 'STR_PAD_LEFT');
+	$final = '';
+	for ($i = 0; $i < 32; $i++)
+		{
+		if ($bits1[$i] == $bits2[$i])
+			$final.= $bits1[$i];
+		if ($bits1[$i] == 1 and $bits2[$i] == 0)
+			$final.= $bits1[$i];
+		if ($bits1[$i] == 0 and $bits2[$i] == 1)
+			$final.= $bits2[$i];
+		}
+	return $start." - ".long2ip(bindec($final));
+}
+?>

--- a/src/whois.ip.php
+++ b/src/whois.ip.php
@@ -1,203 +1,219 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__IP_HANDLER__'))
-    define('__IP_HANDLER__', 1);
-use phpWhois\WhoisClient;
-class ip_handler extends WhoisClient {
-    /** @var Deep whois? */
-    public $deepWhois = true;
-    public $REGISTRARS = array(
-        'European Regional Internet Registry/RIPE NCC' => 'whois.ripe.net',
-        'RIPE Network Coordination Centre' => 'whois.ripe.net',
-        'Asia Pacific Network Information	Center' => 'whois.apnic.net',
-        'Asia Pacific Network Information Centre' => 'whois.apnic.net',
-        'Latin American and Caribbean IP address Regional Registry' => 'whois.lacnic.net',
-        'African Network Information Center' => 'whois.afrinic.net'
-    );
-    public $HANDLERS = array(
-        'whois.krnic.net' => 'krnic',
-        'whois.apnic.net' => 'apnic',
-        'whois.ripe.net' => 'ripe',
-        'whois.arin.net' => 'arin',
-        'whois.lacnic.net' => 'lacnic',
-        'whois.afrinic.net' => 'afrinic'
-    );
-    public $more_data = array(); // More queries to get more accurated data
-    public $done = array();
-    public function parse($data, $query) {
-        $result = array(
-            'regrinfo' => array(),
-            'regyinfo' => array(),
-            'rawdata' => array(),
-        );
-        $result['regyinfo']['registrar'] = 'American Registry for Internet Numbers (ARIN)';
-        if (strpos($query, '.') === false)
-            $result['regyinfo']['type'] = 'AS';
-        else
-            $result['regyinfo']['type'] = 'ip';
-        if (!$this->deepWhois)
-            return null;
-        $this->query = array();
-        $this->query['server'] = 'whois.arin.net';
-        $this->query['query'] = $query;
-        $rawdata = $data['rawdata'];
-        if (empty($rawdata))
-            return $result;
-        $presults = array();
-        $presults[] = $rawdata;
-        $ip = ip2long($query);
-        $done = array();
-        while (count($presults) > 0) {
-            $rwdata = array_shift($presults);
-            $found = false;
-            foreach ($rwdata as $line) {
-                if (strstr($line,'CIDR')){
-                }
-                if (!strncmp($line, 'American Registry for Internet Numbers', 38))
-                    continue;
-                $p = strpos($line, '(NETBLK-');
-                if ($p === false)
-                    $p = strpos($line, '(NET-');
-                if ($p !== false) {
-                    $net = strtok(substr($line, $p + 1), ') ');
-                    $clearedLine = str_replace(' ', '', substr($line, $p + strlen($net) + 3));
-                    if ($clearedLine !== '') {
-                        list($low, $high) = explode('-', str_replace(' ', '', substr($line, $p + strlen($net) + 3)));
-                        if (!isset($done[$net]) && $ip >= ip2long($low) && $ip <= ip2long($high)) {
-                            $owner = substr($line, 0, $p - 1);
-                            if (!empty($this->REGISTRARS['owner'])) {
-                                $this->handle_rwhois($this->REGISTRARS['owner'], $query);
-                                break 2;
-                            } else {
-                                $this->query['args'] = 'n '.$net;
-                                $presults[] = $this->getRawData($net);
-                                $done[$net] = 1;
-                            }
-                        }
-                        $found = true;
-                    }
-                }
-            }
-            if (!$found) {
-                $this->query['file'] = 'whois.ip.arin.php';
-                $this->query['handler'] = 'arin';
-                $result = $this->parse_results($result, $rwdata, $query, true);
-            }
-        }
-        unset($this->query['args']);
-        while (count($this->more_data) > 0) {
-            $srv_data = array_shift($this->more_data);
-            $this->query['server'] = $srv_data['server'];
-            unset($this->query['handler']);
-            $rwdata = $this->getRawData($srv_data['query']);
-            if (!empty($rwdata)) {
-                if (!empty($srv_data['handler'])) {
-                    $this->query['handler'] = $srv_data['handler'];
-                    if (!empty($srv_data['file']))
-                        $this->query['file'] = $srv_data['file'];
-                    else
-                        $this->query['file'] = 'whois.' . $this->query['handler'] . '.php';
-                }
-                $result = $this->parse_results($result, $rwdata, $query, $srv_data['reset']);
-                $result = $this->setWhoisInfo($result);
-                $reset = false;
-            }
-        }
-        if (isset($result['regrinfo']['network']['nserver'])) {
-            if (!is_array($result['regrinfo']['network']['nserver'])) {
-                unset($result['regrinfo']['network']['nserver']);
-            } else
-                $result['regrinfo']['network']['nserver'] = $this->fixNameServer($result['regrinfo']['network']['nserver']);
-        }
-        return $result;
-    }
-    public function parse_results($result, $rwdata, $query, $reset) {
-        $rwres = $this->process($rwdata);
-        if ($result['regyinfo']['type'] == 'AS' && !empty($rwres['regrinfo']['network'])) {
-            $rwres['regrinfo']['AS'] = $rwres['regrinfo']['network'];
-            unset($rwres['regrinfo']['network']);
-        }
-        if ($reset) {
-            $result['regrinfo'] = $rwres['regrinfo'];
-            $result['rawdata'] = $rwdata;
-        } else {
-            $result['rawdata'][] = '';
-            foreach ($rwdata as $line)
-                $result['rawdata'][] = $line;
-            foreach ($rwres['regrinfo'] as $key => $data) {
-                $result = $this->join_result($result, $key, $rwres);
-            }
-        }
-        if ($this->deepWhois) {
-            if (isset($rwres['regrinfo']['rwhois'])) {
-                $this->handle_rwhois($rwres['regrinfo']['rwhois'], $query);
-                unset($result['regrinfo']['rwhois']);
-            } else
-            if (!@empty($rwres['regrinfo']['owner']['organization']))
-                switch ($rwres['regrinfo']['owner']['organization']) {
-                    case 'KRNIC':
-                        $this->handle_rwhois('whois.krnic.net', $query);
-                        break;
-                    case 'African Network Information Center':
-                        $this->handle_rwhois('whois.afrinic.net', $query);
-                        break;
-                }
-        }
-        if (!empty($rwres['regyinfo']))
-            $result['regyinfo'] = array_merge($result['regyinfo'], $rwres['regyinfo']);
-        return $result;
-    }
-    public function handle_rwhois($server, $query) {
-        $parts = parse_url($server);
-        if (empty($parts['host']))
-            $host = $parts['path'];
-        else
-            $host = $parts['host'];
-        if (array_key_exists($host, $this->done))
-            return;
-        $q = array(
-            'query' => $query,
-            'server' => $server
-        );
-        if (isset($this->HANDLERS[$host])) {
-            $q['handler'] = $this->HANDLERS[$host];
-            $q['file'] = sprintf('whois.ip.%s.php', $q['handler']);
-            $q['reset'] = true;
-        } else {
-            $q['handler'] = 'rwhois';
-            $q['reset'] = false;
-            unset($q['file']);
-        }
-        $this->more_data[] = $q;
-        $this->done[$host] = 1;
-    }
-    public function join_result($result, $key, $newres) {
-        if (isset($result['regrinfo'][$key]) && !array_key_exists(0, $result['regrinfo'][$key])) {
-            $r = $result['regrinfo'][$key];
-            $result['regrinfo'][$key] = array($r);
-        }
-        $result['regrinfo'][$key][] = $newres['regrinfo'][$key];
-        return $result;
-    }
-}
+	define('__IP_HANDLER__', 1);
+require_once('whois.ip.lib.php');
+class ip_handler extends WhoisClient
+	{
+	var $deep_whois = true;
+	var $HANDLER_VERSION = '1.0';
+	var $REGISTRARS = array(
+                        'European Regional Internet Registry/RIPE NCC' =>	'whois.ripe.net',
+                        'RIPE Network Coordination Centre' => 'whois.ripe.net',
+                        'Asia Pacific Network Information	Center' => 'whois.apnic.net',
+                        'Asia Pacific Network Information Centre' => 'whois.apnic.net',
+                        'Latin American and Caribbean IP address Regional Registry'	=> 'whois.lacnic.net',
+                        'African Network Information Center' => 'whois.afrinic.net'
+	                     );
+	var $HANDLERS = array(
+						'whois.krnic.net' => 'krnic',
+						'whois.apnic.net' => 'apnic',
+						'whois.ripe.net' => 'ripe',
+						'whois.arin.net' =>	'arin',
+						'whois.lacnic.net' => 'lacnic',
+						'whois.afrinic.net' => 'afrinic'
+	                     );
+	var $more_data = array();	// More queries to get more accurated data
+	var $done = array();
+	function parse($data, $query)
+		{
+		$result['regrinfo'] = array();
+		$result['regyinfo'] = array();
+		$result['regyinfo']['registrar'] = 'American Registry for Internet Numbers (ARIN)';
+		$result['rawdata'] = array();
+		if (strpos($query,'.') === false)
+			$result['regyinfo']['type'] = 'AS';
+		else
+			$result['regyinfo']['type'] = 'ip';
+		if (!$this->deep_whois) return null;
+		$this->Query = array();
+		$this->Query['server'] = 'whois.arin.net';
+		$this->Query['query'] = $query;
+		$rawdata = $data['rawdata'];
+		if (empty($rawdata)) return $result;
+		$presults[] = $rawdata;
+		$ip = ip2long($query);
+		$done = array();
+		while (count($presults) > 0)
+			{
+			$rwdata = array_shift($presults);
+			$found = false;
+			foreach($rwdata as $line)
+				{
+				if (!strncmp($line,'American Registry for Internet Numbers',38)) continue;
+				$p = strpos($line, '(NETBLK-');
+				if ($p === false) $p = strpos($line, '(NET-');
+				if ($p !== false)
+					{
+					$net = strtok(substr($line,$p+1),') ');
+					list($low,$high) = explode('-',str_replace(' ','',substr($line,$p+strlen($net)+3)));
+					if (!isset($done[$net]) && $ip >= ip2long($low) && $ip <= ip2long($high))
+						{
+						$owner = substr($line,0,$p-1);
+						if (!empty($this->REGISTRARS['owner']))
+							{
+							$this->handle_rwhois($this->REGISTRARS['owner'],$query);
+							break 2;
+							}
+						else
+							{
+							$this->Query['args'] = 'n '.$net;
+							$presults[] = $this->GetRawData($net);
+							$done[$net] = 1;
+							}
+						}
+					$found = true;
+					}
+				}
+			if (!$found)
+				{
+				$this->Query['file'] = 'whois.ip.arin.php';
+				$this->Query['handler'] = 'arin';
+				$result = $this->parse_results($result,$rwdata,$query,true);
+				}
+			}
+		unset($this->Query['args']);
+		while (count($this->more_data) > 0)
+			{
+			$srv_data = array_shift($this->more_data);
+			$this->Query['server'] = $srv_data['server'];
+			unset($this->Query['handler']);
+			$rwdata = $this->GetRawData($srv_data['query']);
+			if (!empty($rwdata))
+				{
+				if (!empty($srv_data['handler']))
+					{
+					$this->Query['handler'] = $srv_data['handler'];
+					if (!empty($srv_data['file']))
+						$this->Query['file'] = $srv_data['file'];
+					else
+						$this->Query['file'] = 'whois.'.$this->Query['handler'].'.php';
+					}
+				$result = $this->parse_results($result,$rwdata,$query,$srv_data['reset']);
+				$result = $this->set_whois_info($result);
+				$reset = false;
+				}
+			}
+		if (isset($result['regrinfo']['network']['nserver']))
+			{
+			if (!is_array($result['regrinfo']['network']['nserver']))
+				{
+				unset($result['regrinfo']['network']['nserver']);
+				}
+			else
+				$result['regrinfo']['network']['nserver'] = $this->FixNameServer($result['regrinfo']['network']['nserver']);
+			}
+		return $result;
+		}
+	function parse_results($result,$rwdata,$query,$reset)
+		{
+		$rwres = $this->Process($rwdata);
+		if ($result['regyinfo']['type'] == 'AS' && !empty($rwres['regrinfo']['network']))
+			{
+			$rwres['regrinfo']['AS'] = $rwres['regrinfo']['network'];
+			unset($rwres['regrinfo']['network']);
+			}
+		if ($reset)
+			{
+			$result['regrinfo'] = $rwres['regrinfo'];
+			$result['rawdata'] = $rwdata;
+			}
+		else
+			{
+			$result['rawdata'][] = '';
+			foreach ($rwdata as $line)
+				$result['rawdata'][] = $line;
+			foreach($rwres['regrinfo'] as $key => $data)
+				{
+				$result = $this->join_result($result,$key,$rwres);
+				}
+			}
+		if ($this->deep_whois)
+			{
+			if (isset($rwres['regrinfo']['rwhois']))
+				{
+				$this->handle_rwhois($rwres['regrinfo']['rwhois'],$query);
+				unset($result['regrinfo']['rwhois']);
+				}
+			else
+				if (!@empty($rwres['regrinfo']['owner']['organization']))
+					switch ($rwres['regrinfo']['owner']['organization'])
+						{
+						case 'KRNIC':
+							$this->handle_rwhois('whois.krnic.net',$query);
+							break;
+						case 'African Network Information Center':
+							$this->handle_rwhois('whois.afrinic.net',$query);
+							break;
+						}
+			}
+		if (!empty($rwres['regyinfo']))
+			$result['regyinfo'] = array_merge($result['regyinfo'],$rwres['regyinfo']);
+		return $result;
+		}
+	function handle_rwhois($server,$query)
+		{
+		$parts = parse_url($server);
+		if (empty($parts['host']))
+			$host = $parts['path'];
+		else
+			$host = $parts['host'];
+		if (array_key_exists($host,$this->done)) return;
+		$q = array (
+					'query' => $query,
+					'server' => $server
+					);
+		if (isset($this->HANDLERS[$host]))
+			{
+			$q['handler'] = $this->HANDLERS[$host];
+			$q['file'] = sprintf('whois.ip.%s.php', $q['handler']);
+			$q['reset'] = true;
+			}
+		else
+			{
+			$q['handler'] = 'rwhois';
+			$q['reset'] = false;
+			unset($q['file']);
+			}
+		$this->more_data[] = $q;
+		$this->done[$host] = 1;
+		}
+	function join_result($result, $key, $newres)
+		{
+		if (isset($result['regrinfo'][$key]) && !array_key_exists(0,$result['regrinfo'][$key]))
+			{
+			$r = $result['regrinfo'][$key];
+			$result['regrinfo'][$key] = array($r);
+			}
+		$result['regrinfo'][$key][] = $newres['regrinfo'][$key];
+		return $result;
+		}
+	}
+?>

--- a/src/whois.ip.ripe.php
+++ b/src/whois.ip.ripe.php
@@ -1,69 +1,66 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__RIPE_HANDLER__'))
-    define('__RIPE_HANDLER__', 1);
-class ripe_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'fax-no' => 'fax',
-            'e-mail' => 'email',
-            'nic-hdl' => 'handle',
-            'person' => 'name',
-            'netname' => 'name',
-            'descr' => 'desc'
-        );
-        $contacts = array(
-            'admin-c' => 'admin',
-            'tech-c' => 'tech'
-        );
-        if (!empty($data_str['rawdata']))
-            $data_str = $data_str['rawdata'];
-        $r = generic_parser_a($data_str, $translate, $contacts, 'network');
-        if (isset($r['network']['desc'])) {
-            $r['owner']['organization'] = $r['network']['desc'];
-            unset($r['network']['desc']);
-        }
-        if (isset($r['admin']['abuse-mailbox'])) {
-            $r['abuse']['email'] = $r['admin']['abuse-mailbox'];
-            unset($r['admin']['abuse-mailbox']);
-        }
-        if (isset($r['tech']['abuse-mailbox'])) {
-            $r['abuse']['email'] = $r['tech']['abuse-mailbox'];
-            unset($r['tech']['abuse-mailbox']);
-        }
-        if (isset($r['tech']['tech-c']))
-            unset($r['tech']['tech-c']);
-        if (isset($r['tech']['admin-c']))
-            unset($r['tech']['admin-c']);
-        if (isset($r['admin']['tech-c']))
-            unset($r['admin']['tech-c']);
-        if (isset($r['admin']['admin-c']))
-            unset($r['admin']['admin-c']);
-        $r = array('regrinfo' => $r);
-        $r['regyinfo']['type'] = 'ip';
-        $r['regyinfo']['registrar'] = 'RIPE Network Coordination Centre';
-        return $r;
-    }
-}
+	define('__RIPE_HANDLER__', 1);
+class ripe_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+						'fax-no' => 'fax',
+						'e-mail' => 'email',
+						'nic-hdl' => 'handle',
+						'person' => 'name',
+						'netname' => 'name',
+						'descr' => 'desc'
+		                  );
+		$contacts = array(
+						'admin-c' => 'admin',
+						'tech-c' => 'tech'
+		                  );
+		if (!empty($data_str['rawdata'])) $data_str = $data_str['rawdata'];
+		$r = generic_parser_a($data_str, $translate, $contacts, 'network');
+		if (isset($r['network']['desc']))
+			{
+			$r['owner']['organization'] = $r['network']['desc'];
+			unset($r['network']['desc']);
+			}
+		if (isset($r['admin']['abuse-mailbox']))
+			{
+			$r['abuse']['email'] = $r['admin']['abuse-mailbox'];
+			unset($r['admin']['abuse-mailbox']);
+			}
+		if (isset($r['tech']['abuse-mailbox']))
+			{
+			$r['abuse']['email'] = $r['tech']['abuse-mailbox'];
+			unset($r['tech']['abuse-mailbox']);
+			}
+		if (isset($r['tech']['tech-c']))  unset($r['tech']['tech-c']);
+		if (isset($r['tech']['admin-c'])) unset($r['tech']['admin-c']);
+		if (isset($r['admin']['tech-c']))  unset($r['admin']['tech-c']);
+		if (isset($r['admin']['admin-c'])) unset($r['admin']['admin-c']);
+		$r = array( 'regrinfo' => $r );
+		$r['regyinfo']['type'] ='ip';
+		$r['regyinfo']['registrar'] = 'RIPE Network Coordination Centre';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.ir.php
+++ b/src/whois.ir.php
@@ -1,54 +1,52 @@
 <?php
 /**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
+ * PHPWhois IR Lookup Extension - http://github.com/sepehr/phpwhois-ir
+ *
+ * An extension to PHPWhois (http://phpwhois.org) library to support IR lookups.
+ *
+ * This program is free software: you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation, either version 3 of the License, or
+ * (at your option) any later version.
+ *
  * This program is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  * GNU General Public License for more details.
- * 
+ *
  * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+ * along with this program. If not, see <http://www.gnu.org/licenses/>.
  */
 if (!defined('__IR_HANDLER__'))
-    define('__IR_HANDLER__', 1);
+  define('__IR_HANDLER__', 1);
 require_once('whois.parser.php');
 /**
  * IR Domain names lookup handler class.
  */
-class ir_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'nic-hdl' => 'handle',
-            'org' => 'organization',
-            'e-mail' => 'email',
-            'person' => 'name',
-            'fax-no' => 'fax',
-            'domain' => 'name'
-        );
-        $contacts = array(
-            'admin-c' => 'admin',
-            'tech-c' => 'tech',
-            'holder-c' => 'owner'
-        );
-        $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
-        $r = array();
-        $r['regrinfo'] = $reg;
-        $r['regyinfo'] = array(
-            'referrer' => 'http://whois.nic.ir/',
-            'registrar' => 'NIC-IR'
-        );
-        return $r;
-    }
-}
+class ir_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+			'nic-hdl'	=> 'handle',
+			'org'		=> 'organization',
+			'e-mail'	=> 'email',
+			'person'	=> 'name',
+			'fax-no'	=> 'fax',
+			'domain'	=> 'name'
+			);
+		$contacts = array(
+                    'admin-c'	=> 'admin',
+                    'tech-c'	=> 'tech',
+                    'holder-c'	=> 'owner'
+		                );
+		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
+		$r['regrinfo'] = $reg;
+		$r['regyinfo'] = array(
+                    'referrer'=>'http://whois.nic.ir/',
+					'registrar' => 'NIC-IR'
+                    );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.is.php
+++ b/src/whois.is.php
@@ -1,56 +1,55 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__IS_HANDLER__'))
-    define('__IS_HANDLER__', 1);
+	define('__IS_HANDLER__', 1);
 require_once('whois.parser.php');
-class is_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'fax-no' => 'fax',
-            'e-mail' => 'email',
-            'nic-hdl' => 'handle',
-            'person' => 'name'
-        );
-        $contacts = array(
-            'owner-c' => 'owner',
-            'admin-c' => 'admin',
-            'tech-c' => 'tech',
-            'billing-c' => 'billing',
-            'zone-c' => 'zone'
-        );
-        $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'mdy');
-        if (isset($reg['domain']['descr'])) {
-            $reg['owner']['name'] = array_shift($reg['domain']['descr']);
-            $reg['owner']['address'] = $reg['domain']['descr'];
-            unset($reg['domain']['descr']);
-        }
-        $r = array();
-        $r['regrinfo'] = $reg;
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.isnic.is',
-            'registrar' => 'ISNIC'
-        );
-        return $r;
-    }
-}
+class is_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+                      'fax-no' => 'fax',
+                      'e-mail' => 'email',
+                      'nic-hdl' => 'handle',
+                      'person' => 'name'
+		                  );
+		$contacts = array(
+                      'owner-c' => 'owner',
+                      'admin-c' => 'admin',
+                      'tech-c' => 'tech',
+                      'billing-c' => 'billing',
+                      'zone-c' => 'zone'
+		                  );
+		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'mdy');
+		if (isset($reg['domain']['descr']))
+			{
+			$reg['owner']['name'] = array_shift($reg['domain']['descr']);
+			$reg['owner']['address'] = $reg['domain']['descr'];
+			unset($reg['domain']['descr']);
+			}
+		$r['regrinfo'] = $reg;
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.isnic.is',
+                          'registrar' => 'ISNIC'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.it.php
+++ b/src/whois.it.php
@@ -1,64 +1,63 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
-/**
- * @todo BUG
- * - nserver -> array
- * - ContactID in address
- */
+/*
+BUG
+- nserver -> array
+- ContactID in address
+*/
 if (!defined('__IT_HANDLER__'))
-    define('__IT_HANDLER__', 1);
+	define('__IT_HANDLER__', 1);
 require_once('whois.parser.php');
-class it_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domain.name' => 'Domain:',
-            'domain.nserver' => 'Nameservers',
-            'domain.status' => 'Status:',
-            'domain.expires' => 'Expire Date:',
-            'owner' => 'Registrant',
-            'admin' => 'Admin Contact',
-            'tech' => 'Technical Contacts',
-            'registrar' => 'Registrar'
-        );
-        $extra = array(
-            'address:' => 'address.',
-            'contactid:' => 'handle',
-            'organization:' => 'organization',
-            'created:' => 'created',
-            'last update:' => 'changed',
-            'web:' => 'web'
-        );
-        $r = array();
-        $r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd', $extra);
-        if (isset($r['regrinfo']['registrar'])) {
-            $r['regrinfo']['domain']['registrar'] = $r['regrinfo']['registrar'];
-            unset($r['regrinfo']['registrar']);
-        }
-        $r['regyinfo'] = array(
-            'registrar' => 'IT-Nic',
-            'referrer' => 'http://www.nic.it/'
-        );
-        return $r;
-    }
-}
+class it_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+			'domain.name' =>	'Domain:',
+			'domain.nserver' =>	'Nameservers',
+			'domain.status' =>	'Status:',
+			'domain.expires' =>	'Expire Date:',
+			'owner' 	=>	'Registrant',
+			'admin' 	=>	'Admin Contact',
+			'tech' 		=>	'Technical Contacts',
+			'registrar' =>	'Registrar'
+		            );
+		$extra = array(
+			'address:' 		=> 'address.',
+			'contactid:'	=> 'handle',
+			'organization:' => 'organization',
+			'created:'		=> 'created',
+			'last update:' 	=> 'changed',
+			'web:'			=> 'web'
+		            );
+		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd',$extra);
+		if (isset($r['regrinfo']['registrar']))
+			{
+			$r['regrinfo']['domain']['registrar'] = $r['regrinfo']['registrar'];
+			unset($r['regrinfo']['registrar']);
+			}
+		$r['regyinfo'] = array(
+                  'registrar' => 'IT-Nic',
+                  'referrer' => 'http://www.nic.it/'
+                  );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.jp.php
+++ b/src/whois.jp.php
@@ -1,91 +1,92 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
 if (!defined('__JP_HANDLER__'))
-    define('__JP_HANDLER__', 1);
-use phpWhois\WhoisClient;
+	define('__JP_HANDLER__', 1);
 require_once('whois.parser.php');
-class jp_handler extends WhoisClient {
-    function parse($data_str, $query) {
-        $items = array(
-            '[State]' => 'domain.status',
-            '[Status]' => 'domain.status',
-            '[Registered Date]' => 'domain.created',
-            '[Created on]' => 'domain.created',
-            '[Expires on]' => 'domain.expires',
-            '[Last Updated]' => 'domain.changed',
-            '[Last Update]' => 'domain.changed',
-            '[Organization]' => 'owner.organization',
-            '[Name]' => 'owner.name',
-            '[Email]' => 'owner.email',
-            '[Postal code]' => 'owner.address.pcode',
-            '[Postal Address]' => 'owner.address.street',
-            '[Phone]' => 'owner.phone',
-            '[Fax]' => 'owner.fax',
-            '[Administrative Contact]' => 'admin.handle',
-            '[Technical Contact]' => 'tech.handle',
-            '[Name Server]' => 'domain.nserver.'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.jprs.jp',
-            'registrar' => 'Japan Registry Services'
-        );
-        if (!$this->deepWhois)
-            return $r;
-        $r['rawdata'] = $data_str['rawdata'];
-        $items = array(
-            'a. [JPNIC Handle]' => 'handle',
-            'c. [Last, First]' => 'name',
-            'd. [E-Mail]' => 'email',
-            'g. [Organization]' => 'organization',
-            'o. [TEL]' => 'phone',
-            'p. [FAX]' => 'fax',
-            '[Last Update]' => 'changed'
-        );
-        $this->query['server'] = 'jp.whois-servers.net';
-        if (!empty($r['regrinfo']['admin']['handle'])) {
-            $rwdata = $this->getRawData('CONTACT ' . $r['regrinfo']['admin']['handle'] . '/e');
-            $r['rawdata'][] = '';
-            $r['rawdata'] = array_merge($r['rawdata'], $rwdata);
-            $r['regrinfo']['admin'] = generic_parser_b($rwdata, $items, 'ymd', false);
-            $r = $this->setWhoisInfo($r);
-        }
-        if (!empty($r['regrinfo']['tech']['handle'])) {
-            if (!empty($r['regrinfo']['admin']['handle']) &&
-                    $r['regrinfo']['admin']['handle'] == $r['regrinfo']['tech']['handle']) {
-                $r['regrinfo']['tech'] = $r['regrinfo']['admin'];
-            } else {
-                unset($this->query);
-                $this->query['server'] = 'jp.whois-servers.net';
-                $rwdata = $this->getRawData('CONTACT ' . $r['regrinfo']['tech']['handle'] . '/e');
-                $r['rawdata'][] = '';
-                $r['rawdata'] = array_merge($r['rawdata'], $rwdata);
-                $r['regrinfo']['tech'] = generic_parser_b($rwdata, $items, 'ymd', false);
-                $r = $this->setWhoisInfo($r);
-            }
-        }
-        return $r;
-    }
-}
+class jp_handler extends WhoisClient
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+						'[State]' => 'domain.status',
+						'[Status]' => 'domain.status',
+						'[Registered Date]' => 'domain.created',
+						'[Created on]' => 'domain.created',
+						'[Expires on]' => 'domain.expires',
+						'[Last Updated]' => 'domain.changed',
+						'[Last Update]' => 'domain.changed',
+						'[Organization]' => 'owner.organization',
+						'[Name]' => 'owner.name',
+						'[Email]' => 'owner.email',
+						'[Postal code]' => 'owner.address.pcode',
+						'[Postal Address]' => 'owner.address.street',
+						'[Phone]' => 'owner.phone',
+						'[Fax]' => 'owner.fax',
+						'[Administrative Contact]' => 'admin.handle',
+						'[Technical Contact]' => 'tech.handle',
+						'[Name Server]' => 'domain.nserver.'
+						);
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.jprs.jp',
+                          'registrar' => 'Japan Registry Services'
+                          );
+		if (!$this->deep_whois) return $r;
+		$r['rawdata'] = $data_str['rawdata'];
+		$items = array(
+					'a. [JPNIC Handle]'	=> 'handle',
+					'c. [Last, First]'	=> 'name',
+					'd. [E-Mail]'		=> 'email',
+					'g. [Organization]' => 'organization',
+					'o. [TEL]'			=> 'phone',
+					'p. [FAX]'			=> 'fax',
+					'[Last Update]'		=> 'changed'
+					);
+		$this->Query['server'] = 'jp.whois-servers.net';
+		if (!empty($r['regrinfo']['admin']['handle']))
+			{
+			$rwdata = $this->GetRawData('CONTACT '.$r['regrinfo']['admin']['handle'].'/e');
+			$r['rawdata'][] = '';
+			$r['rawdata'] = array_merge($r['rawdata'],$rwdata);
+			$r['regrinfo']['admin'] = generic_parser_b($rwdata,$items,'ymd',false);
+			$r = $this->set_whois_info($r);
+			}
+		if (!empty($r['regrinfo']['tech']['handle']))
+			{
+			if (!empty($r['regrinfo']['admin']['handle']) &&
+				$r['regrinfo']['admin']['handle'] == $r['regrinfo']['tech']['handle'])
+				{
+				$r['regrinfo']['tech'] = $r['regrinfo']['admin'];
+				}
+			else
+				{
+				unset($this->Query);
+				$this->Query['server'] = 'jp.whois-servers.net';
+				$rwdata = $this->GetRawData('CONTACT '.$r['regrinfo']['tech']['handle'].'/e');
+				$r['rawdata'][] = '';
+				$r['rawdata'] = array_merge($r['rawdata'],$rwdata);
+				$r['regrinfo']['tech'] = generic_parser_b($rwdata,$items,'ymd',false);
+				$r = $this->set_whois_info($r);
+				}
+			}
+		return $r;
+		}
+	}
+?>

--- a/src/whois.london.php
+++ b//dev/null
@@ -1,41 +0,0 @@
-<?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-if (!defined('__LONDON_HANDLER__')) {
-    define('__LONDON_HANDLER__', 1);
-}
-require_once('whois.parser.php');
-/**
- * Class london_handler
- */
-class london_handler
-{
-    function parse($data_str, $query)
-    {
-        $r = [
-            'regrinfo' => generic_parser_b($data_str['rawdata']),
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        if (!isset($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo']['domain']['name'] = $query;
-        }
-        return $r;
-    }
-}

--- a/src/whois.lt.php
+++ b/src/whois.lt.php
@@ -1,53 +1,51 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__LT_HANDLER__'))
-    define('__LT_HANDLER__', 1);
+	define('__LT_HANDLER__', 1);
 require_once('whois.parser.php');
-class lt_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'contact nic-hdl:' => 'handle',
-            'contact name:' => 'name'
-        );
-        $items = array(
-            'admin' => 'Contact type:      Admin',
-            'tech' => 'Contact type:      Tech',
-            'zone' => 'Contact type:      Zone',
-            'owner.name' => 'Registrar:',
-            'owner.email' => 'Registrar email:',
-            'domain.status' => 'Status:',
-            'domain.created' => 'Registered:',
-            'domain.changed' => 'Last updated:',
-            'domain.nserver.' => 'NS:',
-            '' => '%'
-        );
-        $r = array();
-        $r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd', $translate);
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.domreg.lt',
-            'registrar' => 'DOMREG.LT'
-        );
-        return $r;
-    }
-}
+class lt_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+					'contact nic-hdl:' => 'handle',
+					'contact name:' => 'name'
+					);
+		$items = array(
+						'admin' 			=> 'Contact type:      Admin',
+						'tech'				=> 'Contact type:      Tech',
+						'zone'				=> 'Contact type:      Zone',
+						'owner.name'		=> 'Registrar:',
+						'owner.email'		=> 'Registrar email:',
+						'domain.status' 	=> 'Status:',
+						'domain.created'	=> 'Registered:',
+						'domain.changed'	=> 'Last updated:',
+						'domain.nserver.'	=> 'NS:',
+						''		=> '%'
+						);
+		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd', $translate);
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.domreg.lt',
+                    'registrar' => 'DOMREG.LT'
+                    );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.lu.php
+++ b/src/whois.lu.php
@@ -1,68 +1,66 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__LU_HANDLER__'))
-    define('__LU_HANDLER__', 1);
+	define('__LU_HANDLER__', 1);
 require_once('whois.parser.php');
-class lu_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domainname:' => 'domain.name',
-            'domaintype:' => 'domain.status',
-            'nserver:' => 'domain.nserver.',
-            'registered:' => 'domain.created',
-            'source:' => 'domain.source',
-            'ownertype:' => 'owner.type',
-            'org-name:' => 'owner.organization',
-            'org-address:' => 'owner.address.',
-            'org-zipcode:' => 'owner.address.pcode',
-            'org-city:' => 'owner.address.city',
-            'org-country:' => 'owner.address.country',
-            'adm-name:' => 'admin.name',
-            'adm-address:' => 'admin.address.',
-            'adm-zipcode:' => 'admin.address.pcode',
-            'adm-city:' => 'admin.address.city',
-            'adm-country:' => 'admin.address.country',
-            'adm-email:' => 'admin.email',
-            'tec-name:' => 'tech.name',
-            'tec-address:' => 'tech.address.',
-            'tec-zipcode:' => 'tech.address.pcode',
-            'tec-city:' => 'tech.address.city',
-            'tec-country:' => 'tech.address.country',
-            'tec-email:' => 'tech.email',
-            'bil-name:' => 'billing.name',
-            'bil-address:' => 'billing.address.',
-            'bil-zipcode:' => 'billing.address.pcode',
-            'bil-city:' => 'billing.address.city',
-            'bil-country:' => 'billing.address.country',
-            'bil-email:' => 'billing.email'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.dns.lu',
-            'registrar' => 'DNS-LU'
-        );
-        return $r;
-    }
-}
+class lu_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'domainname:' => 'domain.name',
+                  'domaintype:' => 'domain.status',
+                  'nserver:' => 'domain.nserver.',
+                  'registered:' => 'domain.created',
+                  'source:' => 'domain.source',
+                  'ownertype:' => 'owner.type',
+                  'org-name:' => 'owner.organization',
+                  'org-address:' => 'owner.address.',
+                  'org-zipcode:' => 'owner.address.pcode',
+                  'org-city:' => 'owner.address.city',
+                  'org-country:' => 'owner.address.country',
+                  'adm-name:' => 'admin.name',
+                  'adm-address:' => 'admin.address.',
+                  'adm-zipcode:' => 'admin.address.pcode',
+                  'adm-city:' => 'admin.address.city',
+                  'adm-country:' => 'admin.address.country',
+                  'adm-email:' => 'admin.email',
+                  'tec-name:' => 'tech.name',
+                  'tec-address:' => 'tech.address.',
+                  'tec-zipcode:' => 'tech.address.pcode',
+                  'tec-city:' => 'tech.address.city',
+                  'tec-country:' => 'tech.address.country',
+                  'tec-email:' => 'tech.email',
+                  'bil-name:' => 'billing.name',
+                  'bil-address:' => 'billing.address.',
+                  'bil-zipcode:' => 'billing.address.pcode',
+                  'bil-city:' => 'billing.address.city',
+                  'bil-country:' => 'billing.address.country',
+                  'bil-email:' => 'billing.email'
+		              );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
+		$r['regyinfo'] = array(
+                            'referrer' => 'http://www.dns.lu',
+                            'registrar' => 'DNS-LU'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.ly.php
+++ b/src/whois.ly.php
@@ -1,57 +1,58 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__LY_HANDLER__'))
-    define('__LY_HANDLER__', 1);
-class ly_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'domain.name' => 'Domain Name:',
-            'domain.status' => 'Domain Status:',
-            'domain.created' => 'Created:',
-            'domain.changed' => 'Updated:',
-            'domain.expires' => 'Expired:',
-            'domain.nserver' => 'Domain servers in listed order:'
-        );
-        $extra = array('zip/postal code:' => 'address.pcode');
-        $r = array();
-        $r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
-        if (!empty($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo'] = get_contacts($r['regrinfo'], $extra);
-            $r['regrinfo']['domain']['name'] = $r['regrinfo']['domain']['name'][0];
-            $r['regrinfo']['registered'] = 'yes';
-        } else {
-            $r = array('regrinfo' => array());
-            $r['regrinfo']['registered'] = 'no';
-        }
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.nic.ly',
-            'registrar' => 'Libya ccTLD'
-        );
-        return $r;
-    }
-}
+	define('__LY_HANDLER__', 1);
+class ly_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+				'owner' => 'Registrant:',
+				'admin' => 'Administrative Contact:',
+				'tech' => 'Technical Contact:',
+				'domain.name' => 'Domain Name:',
+				'domain.status' => 'Domain Status:',
+				'domain.created' => 'Created:',
+				'domain.changed' => 'Updated:',
+				'domain.expires' => 'Expired:',
+				'domain.nserver' => 'Domain servers in listed order:'
+		            );
+		$extra = array( 'zip/postal code:' => 'address.pcode' );
+		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
+		if (!empty($r['regrinfo']['domain']['name']))
+			{
+			$r['regrinfo'] = get_contacts($r['regrinfo'],$extra);
+			$r['regrinfo']['domain']['name'] = $r['regrinfo']['domain']['name'][0];
+			$r['regrinfo']['registered'] = 'yes';
+			}
+		else
+			{
+			$r = '';
+			$r['regrinfo']['registered'] = 'no';
+			}
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.ly',
+                          'registrar' => 'Libya ccTLD'
+                          );
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.main.php
@@ -0,0 +1,231 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+require_once('whois.client.php');
+require_once('whois.idna.php');
+class Whois extends WhoisClient
+	{
+	var $deep_whois = true;
+	var $windows = false;
+	var $gtld_recurse = true;
+	var $non_icann = false;
+	var $NSI_REGISTRY = 'whois.nsiregistry.net';
+	/*
+	 * Constructor function
+	 */
+	function Whois()
+		{
+		@require('whois.servers.php');
+		if ( ( substr( php_uname(), 0, 7 ) == 'Windows' ) )
+			$this->windows = true;
+		else
+			$this->windows = false;
+		$this->VERSION = sprintf("phpWhois v%s-%s", $this->CODE_VERSION, $this->DATA_VERSION);
+		}
+	/*
+	 *  Use special whois server
+	 */
+	function UseServer ($tld, $server)
+		{
+		$this->WHOIS_SPECIAL[$tld] = $server;
+		}
+	/*
+	 *  Lookup query
+	 */
+	function Lookup($query = '', $is_utf = true)
+		{
+		$this->Query = array( 'status' => '' );
+		$query = trim($query);
+		$IDN = new idna_convert();
+		if ($is_utf)
+			$query = $IDN->encode($query);
+		else
+			$query = $IDN->encode(utf8_encode($query));
+		if (!isSet($query) || $query == '')
+			{
+			$this->Query['server'] = $this->NSI_REGISTRY;
+			return ;
+			}
+		$this->Query['query'] = $domain = strtolower($query);
+		if ($query == long2ip(ip2long($query)))
+			{
+			$ip = @gethostbyname($query);
+			if (isset($this->WHOIS_SPECIAL['ip']))
+				{
+				$this->Query['server'] = $this->WHOIS_SPECIAL['ip'];
+				$this->Query['args'] = $ip;
+				}
+			else
+				{
+				$this->Query['server'] = 'whois.arin.net';
+				$this->Query['args'] = "n $ip";
+				$this->Query['file'] = 'whois.ip.php';
+				$this->Query['handler'] = 'ip';
+				}
+			$this->Query['host_ip'] = $ip;
+			$this->Query['query'] = $ip;
+			$this->Query['tld'] = 'ip';
+			$this->Query['host_name'] = @gethostbyaddr($ip);
+			return $this->GetData('',$this->deep_whois);
+			}
+		if (strpos($query, ':'))
+			{
+			$ip = @gethostbyname($query);
+			if (isset($this->WHOIS_SPECIAL['ip']))
+				{
+				$this->Query['server'] = $this->WHOIS_SPECIAL['ip'];
+				}
+			else
+				{
+				$this->Query['server'] = 'whois.ripe.net';
+				$this->Query['file'] = 'whois.ip.ripe.php';
+				$this->Query['handler'] = 'ripe';
+				}
+			$this->Query['query'] = $ip;
+			$this->Query['tld'] = 'ip';
+			return $this->GetData('',$this->deep_whois);
+			}
+		if (!strpos($query, '.'))
+			{
+			$ip = @gethostbyname($query);
+			$this->Query['server'] = 'whois.arin.net';
+			if (strtolower(substr($ip,0,2)) == 'as')
+				$as = substr($ip,2);
+			else
+				$as = $ip;
+			$this->Query['args'] = "a $as";
+			$this->Query['file'] = 'whois.ip.php';
+			$this->Query['handler'] = 'ip';
+			$this->Query['query'] = $ip;
+			$this->Query['tld'] = 'as';
+			return $this->GetData('',$this->deep_whois);
+			}
+		$tld = '';
+		$server = '';
+		$dp = explode('.', $domain);
+		$np = count($dp)-1;
+		$tldtests = array();
+		for ($i = 0; $i < $np; $i++)
+			{
+			array_shift($dp);
+			$tldtests[] = implode('.', $dp);
+			}
+		if ($this->non_icann)
+			$special_tlds = array_merge($this->WHOIS_SPECIAL,$this->WHOIS_NON_ICANN);
+		else
+			$special_tlds = $this->WHOIS_SPECIAL;
+		foreach($tldtests as $tld)
+			{
+			if (isset($special_tlds[$tld]))
+				{
+				$val = $special_tlds[$tld];
+				if ($val == '') return $this->Unknown();
+				$domain = substr($query, 0,  - strlen($tld) - 1);
+				$val = str_replace('{domain}', $domain, $val);
+				$server = str_replace('{tld}', $tld, $val);
+				break;
+				}
+			}
+		if ($server == '')
+			foreach($tldtests as $tld)
+				{
+				$cname = $tld.'.whois-servers.net';
+				if (gethostbyname($cname) == $cname) continue;
+				$server = $tld.'.whois-servers.net';
+				break;
+				}
+		if ($tld && $server)
+			{
+			$this->Query['server'] = $server;
+			$this->Query['tld'] = $tld;
+			$handler = '';
+			foreach($tldtests as $htld)
+				{
+				if (isSet($this->DATA[$htld]))
+				    {
+					$handler = $this->DATA[$htld];
+					break;
+					}
+				if (($fp = @fopen('whois.'.$htld.'.php', 'r', 1)) and fclose($fp))
+				    {
+					$handler = $htld;
+					break;
+					}
+				}
+			if ($handler != '')
+				{
+				$this->Query['file'] = "whois.$handler.php";
+				$this->Query['handler'] = $handler;
+				}
+			if (isset($this->WHOIS_PARAM[$server]))
+				$this->Query['server'] = $this->Query['server'].'?'.str_replace('$',$domain,$this->WHOIS_PARAM[$server]);
+			$result = $this->GetData('',$this->deep_whois);
+			$this->Checkdns($result);
+			return $result;
+			}
+		return $this->Unknown();
+		}
+	/* Unsupported domains */
+	function Unknown()
+		{
+		unset($this->Query['server']);
+		$this->Query['status'] = 'error';
+		$result['rawdata'][] = $this->Query['errstr'][] = $this->Query['query'].' domain is not supported';
+		$this->Checkdns($result);
+		$this->FixResult($result, $this->Query['query']);
+		return $result;
+		}
+	/* Get nameservers if missing */
+	function Checkdns(&$result)
+		{
+		if ($this->deep_whois && empty($result['regrinfo']['domain']['nserver']) && function_exists('dns_get_record'))
+			{
+			$ns = @dns_get_record($this->Query['query'],DNS_NS);
+			if (!is_array($ns)) return;
+			$nserver = array();
+			foreach($ns as $row) $nserver[] = $row['target'];
+			if (count($nserver) > 0)
+				$result['regrinfo']['domain']['nserver'] = $this->FixNameServer($nserver);
+			}
+		}
+	/*
+	 *  Fix and/or add name server information
+	 */
+	function FixResult(&$result, $domain)
+		{
+		$result['regrinfo']['domain']['name'] = $domain;
+		if (!isset($result['regrinfo']['registered']))
+			{
+			if (function_exists('checkdnsrr') && checkdnsrr($domain, 'NS'))
+				$result['regrinfo']['registered'] = 'yes';
+			else
+				$result['regrinfo']['registered'] = 'unknown';
+			}
+		if (isset($result['regrinfo']['domain']['nserver']))
+			{
+			if (!is_array($result['regrinfo']['domain']['nserver']))
+				{
+				unset($result['regrinfo']['domain']['nserver']);
+				}
+			else
+				$result['regrinfo']['domain']['nserver'] = $this->FixNameServer($result['regrinfo']['domain']['nserver']);
+			}
+		}
+	}
+?>

--- a/src/whois.me.php
+++ b/src/whois.me.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ME_HANDLER__'))
-    define('__ME_HANDLER__', 1);
+	define('__ME_HANDLER__', 1);
 require_once('whois.parser.php');
-class me_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        $r['regyinfo'] = array(
-            'referrer' => 'http://domain.me',
-            'registrar' => 'doMEn'
-        );
-        return $r;
-    }
-}
+class me_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://domain.me',
+                          'registrar' => 'doMEn'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.mobi.php
+++ b/src/whois.mobi.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__MOBI_HANDLER__'))
-    define('__MOBI_HANDLER__', 1);
+	define('__MOBI_HANDLER__', 1);
 require_once('whois.parser.php');
-class mobi_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
-            $r['regrinfo']['registered'] = 'unknown';
-        $r['regyinfo']['referrer'] = 'http://www.mtld.mobi/';
-        $r['regyinfo']['registrar'] = 'Dot Mobi Registry';
-        return $r;
-    }
-}
+class mobi_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
+			$r['regrinfo']['registered'] = 'unknown';
+		$r['regyinfo']['referrer'] = 'http://www.mtld.mobi/';
+		$r['regyinfo']['registrar'] = 'Dot Mobi Registry';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.museum.php
+++ b/src/whois.museum.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
 if (!defined('__MUSEUM_HANDLER__'))
-    define('__MUSEUM_HANDLER__', 1);
+	define('__MUSEUM_HANDLER__', 1);
 require_once('whois.parser.php');
-class museum_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        $r['regyinfo'] = array(
-            'referrer' => 'http://musedoma.museum',
-            'registrar' => 'Museum Domain Management Association'
-        );
-        return $r;
-    }
-}
+class museum_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://musedoma.museum',
+                          'registrar' => 'Museum Domain Management Association'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.mx.php
+++ b/src/whois.mx.php
@@ -1,57 +1,55 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__MX_HANDLER__'))
-    define('__MX_HANDLER__', 1);
+	define('__MX_HANDLER__', 1);
 require_once('whois.parser.php');
-class mx_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Registrant:',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'billing' => 'Billing Contact:',
-            'domain.nserver' => 'Name Servers:',
-            'domain.created' => 'Created On:',
-            'domain.expires' => 'Expiration Date:',
-            'domain.changed' => 'Last Updated On:',
-            'domain.sponsor' => 'Registrar:'
-        );
-        $extra = array(
-            'city:' => 'address.city',
-            'state:' => 'address.state',
-            'dns:' => '0'
-        );
-        $r = array();
-        $r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'dmy', $extra);
-        $r['regyinfo'] = array(
-            'registrar' => 'NIC Mexico',
-            'referrer' => 'http://www.nic.mx/'
-        );
-        if (empty($r['regrinfo']['domain']['created']))
-            $r['regrinfo']['registered'] = 'no';
-        else
-            $r['regrinfo']['registered'] = 'yes';
-        return $r;
-    }
-}
+class mx_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+						'owner'	=> 'Registrant:',
+						'admin'	=> 'Administrative Contact:',
+						'tech'	=> 'Technical Contact:',
+						'billing' => 'Billing Contact:',
+						'domain.nserver' => 'Name Servers:',
+						'domain.created' => 'Created On:',
+						'domain.expires' => 'Expiration Date:',
+						'domain.changed' => 'Last Updated On:',
+						'domain.sponsor' => 'Registrar:'
+						);
+		$extra = array(
+						'city:' => 'address.city',
+						'state:'	=> 'address.state',
+						'dns:'	=> '0'
+						);
+		$r['regrinfo'] = easy_parser($data_str['rawdata'],$items,'dmy',$extra);
+		$r['regyinfo'] = array(
+                  'registrar' => 'NIC Mexico',
+                  'referrer' => 'http://www.nic.mx/'
+                  );
+		if (empty($r['regrinfo']['domain']['created']))
+			$r['regrinfo']['registered'] = 'no';
+		else
+			$r['regrinfo']['registered'] = 'yes';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.name.php
+++ b/src/whois.name.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
 if (!defined('__NAME_HANDLER__'))
-    define('__NAME_HANDLER__', 1);
+	define('__NAME_HANDLER__', 1);
 require_once('whois.parser.php');
-class name_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.nic.name/',
-            'registrar' => 'Global Name Registry'
-        );
-        return $r;
-    }
-}
+class name_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.name/',
+                          'registrar' => 'Global Name Registry'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.nl.php
+++ b/src/whois.nl.php
@@ -1,67 +1,68 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NL_HANDLER__'))
-    define('__NL_HANDLER__', 1);
+	define('__NL_HANDLER__', 1);
 require_once('whois.parser.php');
-class nl_handler {
-    function parse($data, $query) {
-        $items = array(
-            'domain.name' => 'Domain name:',
-            'domain.status' => 'Status:',
-            'domain.nserver' => 'Domain nameservers:',
-            'domain.created' => 'Date registered:',
-            'domain.changed' => 'Record last updated:',
-            'domain.sponsor' => 'Registrar:',
-            'admin' => 'Administrative contact:',
-            'tech' => 'Technical contact(s):'
-        );
-        $r = array();
-        $r['regrinfo'] = get_blocks($data['rawdata'], $items);
-        $r['regyinfo']['referrer'] = 'http://www.domain-registry.nl';
-        $r['regyinfo']['registrar'] = 'Stichting Internet Domeinregistratie NL';
-        if (!isset($r['regrinfo']['domain']['status'])) {
-            $r['regrinfo']['registered'] = 'no';
-            return $r;
-        }
-        if (isset($r['regrinfo']['tech']))
-            $r['regrinfo']['tech'] = $this->get_contact($r['regrinfo']['tech']);
-        if (isset($r['regrinfo']['zone']))
-            $r['regrinfo']['zone'] = $this->get_contact($r['regrinfo']['zone']);
-        if (isset($r['regrinfo']['admin']))
-            $r['regrinfo']['admin'] = $this->get_contact($r['regrinfo']['admin']);
-        if (isset($r['regrinfo']['owner']))
-            $r['regrinfo']['owner'] = $this->get_contact($r['regrinfo']['owner']);
-        $r['regrinfo']['registered'] = 'yes';
-        format_dates($r, 'dmy');
-        return $r;
-    }
-    function get_contact($data) {
-        $r = get_contact($data);
-        if (isset($r['name']) && preg_match('/^[A-Z0-9]+-[A-Z0-9]+$/', $r['name'])) {
-            $r['handle'] = $r['name'];
-            $r['name'] = array_shift($r['address']);
-        }
-        return $r;
-    }
-}
+class nl_handler
+	{
+	function parse($data, $query)
+		{
+		$items = array(
+                  'domain.name' => 'Domain name:',
+                  'domain.status' => 'Status:',
+                  'domain.nserver' => 'Domain nameservers:',
+                  'domain.created' => 'Date registered:',
+                  'domain.changed' => 'Record last updated:',
+                  'domain.sponsor' => 'Registrar:',
+                  'admin' => 'Administrative contact:',
+                  'tech' => 'Technical contact(s):'
+		            );
+		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
+		$r['regyinfo']['referrer'] = 'http://www.domain-registry.nl';
+		$r['regyinfo']['registrar'] = 'Stichting Internet Domeinregistratie NL';
+		if (!isset($r['regrinfo']['domain']['status']))
+			{
+			$r['regrinfo']['registered'] = 'no';
+			return $r;
+			}
+		if (isset($r['regrinfo']['tech']))
+			$r['regrinfo']['tech'] = $this->get_contact($r['regrinfo']['tech']);
+		if (isset($r['regrinfo']['zone']))
+			$r['regrinfo']['zone'] = $this->get_contact($r['regrinfo']['zone']);
+		if (isset($r['regrinfo']['admin']))
+			$r['regrinfo']['admin'] = $this->get_contact($r['regrinfo']['admin']);
+		if (isset($r['regrinfo']['owner']))
+			$r['regrinfo']['owner'] = $this->get_contact($r['regrinfo']['owner']);
+		$r['regrinfo']['registered'] = 'yes';
+		format_dates($r,'dmy');
+		return $r;
+		}
+	function get_contact($data)
+		{
+		$r = get_contact($data);
+		if (isset($r['name']) && preg_match('/^[A-Z0-9]+-[A-Z0-9]+$/',$r['name']))
+			{
+			$r['handle'] = $r['name'];
+			$r['name'] = array_shift ($r['address']);
+			}
+		return $r;
+		}
+	}
+?>

--- a/src/whois.no.php
+++ b//dev/null
@@ -1,49 +0,0 @@
-<?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link      http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-if (!defined('__NO_HANDLER__')) {
-    define('__NO_HANDLER__', 1);
-}
-require_once 'whois.parser.php';
-class no_handler
-{
-    public function parse($data_str, $query)
-    {
-        $items = [
-            'Domain Name................:' => 'domain.name',
-            'Created:'                     => 'domain.created',
-            'Last updated:'                => 'domain.changed',
-            'NORID Handle...............:' => 'domain.handle',
-        ];
-        $r = [
-            'regrinfo' => generic_parser_b($data_str['rawdata'], $items, 'ymd', false),
-            'regyinfo' => [
-                'referrer'  => 'https://www.norid.no/en/',
-                'registrar' => 'Norid',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        $r['regrinfo']['registered'] = isset($r['regrinfo']['domain']['name']) ? 'yes' : 'no';
-        return $r;
-    }
-}

--- a/src/whois.nu.php
+++ b/src/whois.nu.php
@@ -1,70 +1,73 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NU_HANDLER__'))
-    define('__NU_HANDLER__', 1);
+	define('__NU_HANDLER__', 1);
 require_once('whois.parser.php');
-class nu_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'name' => 'Domain Name (UTF-8):',
-            'created' => 'Record created on',
-            'expires' => 'Record expires on',
-            'changed' => 'Record last updated on',
-            'status' => 'Record status:',
-            'handle' => 'Record ID:'
-        );
-        $r = array();
-        foreach ($data_str['rawdata'] as $val) {
-            $val = trim($val);
-            if ($val != '') {
-                if ($val == 'Domain servers in listed order:') {
-                    foreach ($data_str['rawdata'] as $val2) {
-                        $val2 = trim($val2);
-                        if ($val2 === '')
-                            break;
-                        $r['regrinfo']['domain']['nserver'][] = $val2;
-                    }
-                    break;
-                }
-                foreach ($items as $field => $match) {
-                    if (strstr($val, $match)) {
-                        $r['regrinfo']['domain'][$field] = trim(substr($val, strlen($match)));
-                        break;
-                    }
-                }
-            }
-        }
-        if (isset($r['regrinfo']['domain']))
-            $r['regrinfo']['registered'] = 'yes';
-        else
-            $r['regrinfo']['registered'] = 'no';
-        $r['regyinfo'] = array(
-            'whois' => 'whois.nic.nu',
-            'referrer' => 'http://www.nunames.nu',
-            'registrar' => '.NU Domain, Ltd'
-        );
-        format_dates($r, 'dmy');
-        return $r;
-    }
-}
+class nu_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'name' => 'Domain Name (UTF-8):',
+                  'created' => 'Record created on',
+                  'expires' => 'Record expires on',
+                  'changed' => 'Record last updated on',
+                  'status' => 'Record status:',
+                  'handle' => 'Record ID:'
+		              );
+		while (list($key, $val) = each($data_str['rawdata']))
+			{
+			$val = trim($val);
+			if ($val != '')
+				{
+				if ($val == 'Domain servers in listed order:')
+					{
+					while (list($key, $val) = each($data_str['rawdata']))
+						{
+						$val = trim($val);
+						if ($val == '')
+							break;
+						$r['regrinfo']['domain']['nserver'][] = $val;
+						}
+					break;
+					}
+				reset($items);
+				while (list($field, $match) = each($items))
+				if (strstr($val, $match))
+					{
+					$r['regrinfo']['domain'][$field] = trim(substr($val, strlen($match)));
+					break;
+					}
+				}
+			}
+		if (isset($r['regrinfo']['domain']))
+			$r['regrinfo']['registered'] = 'yes';
+		else
+			$r['regrinfo']['registered'] = 'no';
+		$r['regyinfo'] = array(
+                          'whois' => 'whois.nic.nu',
+                          'referrer' => 'http://www.nunames.nu',
+                          'registrar' => '.NU Domain, Ltd'
+		                      );
+		format_dates($r, 'dmy');
+		return $r;
+		}
+	}
+?>

--- a/src/whois.nz.php
+++ b/src/whois.nz.php
@@ -1,89 +1,87 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__NZ_HANDLER__'))
-    define('__NZ_HANDLER__', 1);
+	define('__NZ_HANDLER__', 1);
 require_once('whois.parser.php');
-class nz_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domain_name:' => 'domain.name',
-            'query_status:' => 'domain.status',
-            'ns_name_01:' => 'domain.nserver.0',
-            'ns_name_02:' => 'domain.nserver.1',
-            'ns_name_03:' => 'domain.nserver.2',
-            'domain_dateregistered:' => 'domain.created',
-            'domain_datelastmodified:' => 'domain.changed',
-            'domain_datebilleduntil:' => 'domain.expires',
-            'registrar_name:' => 'domain.sponsor',
-            'registrant_contact_name:' => 'owner.name',
-            'registrant_contact_address1:' => 'owner.address.address.0',
-            'registrant_contact_address2:' => 'owner.address.address.1',
-            'registrant_contact_address3:' => 'owner.address.address.2',
-            'registrant_contact_postalcode:' => 'owner.address.pcode',
-            'registrant_contact_city:' => 'owner.address.city',
-            'Registrant State/Province:' => 'owner.address.state',
-            'registrant_contact_country:' => 'owner.address.country',
-            'registrant_contact_phone:' => 'owner.phone',
-            'registrant_contact_fax:' => 'owner.fax',
-            'registrant_contact_email:' => 'owner.email',
-            'admin_contact_name:' => 'admin.name',
-            'admin_contact_address1:' => 'admin.address.address.0',
-            'admin_contact_address2:' => 'admin.address.address.1',
-            'admin_contact_address3:' => 'admin.address.address.2',
-            'admin_contact_postalcode:' => 'admin.address.pcode',
-            'admin_contact_city:' => 'admin.address.city',
-            'admin_contact_country:' => 'admin.address.country',
-            'admin_contact_phone:' => 'admin.phone',
-            'admin_contact_fax:' => 'admin.fax',
-            'admin_contact_email:' => 'admin.email',
-            'technical_contact_name:' => 'tech.name',
-            'technical_contact_address1:' => 'tech.address.address.0',
-            'technical_contact_address1:' => 'tech.address.address.1',
-            'technical_contact_address1:' => 'tech.address.address.2',
-            'technical_contact_postalcode:' => 'tech.address.pcode',
-            'technical_contact_city:' => 'tech.address.city',
-            'technical_contact_country:' => 'tech.address.country',
-            'technical_contact_phone:' => 'tech.phone',
-            'technical_contact_fax:' => 'tech.fax',
-            'technical_contact_email:' => 'tech.email'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
-        if (!empty($r['regrinfo']['domain']['status']))
-            $domain_status = substr($r['regrinfo']['domain']['status'], 0, 3);
-        else
-            $domain_status = '';
-        if ($domain_status == '200')
-            $r['regrinfo']['registered'] = 'yes';
-        elseif ($domain_status == '220')
-            $r['regrinfo']['registered'] = 'no';
-        else
-            $r['regrinfo']['registered'] = 'unknown';
-        if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
-            $r['regrinfo']['registered'] = 'unknown';
-        $r['regyinfo']['referrer'] = 'http://www.dnc.org.nz';
-        $r['regyinfo']['registrar'] = 'New Zealand Domain Name Registry Limited';
-        return $r;
-    }
-}
+class nz_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                    'domain_name:' 					=> 'domain.name',
+                    'query_status:'					=> 'domain.status',
+					'ns_name_01:' 					=> 'domain.nserver.0',
+					'ns_name_02:' 					=> 'domain.nserver.1',
+					'ns_name_03:' 					=> 'domain.nserver.2',
+                    'domain_dateregistered:'		=> 'domain.created',
+                    'domain_datelastmodified:'		=> 'domain.changed',
+                    'domain_datebilleduntil:'		=> 'domain.expires',
+                    'registrar_name:'		 		=> 'domain.sponsor',
+                    'registrant_contact_name:'		=> 'owner.name',
+                    'registrant_contact_address1:'	=> 'owner.address.address.0',
+                    'registrant_contact_address2:'	=> 'owner.address.address.1',
+                    'registrant_contact_address3:'	=> 'owner.address.address.2',
+                    'registrant_contact_postalcode:'=> 'owner.address.pcode',
+                    'registrant_contact_city:'		=> 'owner.address.city',
+                    'Registrant State/Province:' 	=> 'owner.address.state',
+                    'registrant_contact_country:'	=> 'owner.address.country',
+                    'registrant_contact_phone:'		=> 'owner.phone',
+                    'registrant_contact_fax:'		=> 'owner.fax',
+                    'registrant_contact_email:'		=> 'owner.email',
+                    'admin_contact_name:' 			=> 'admin.name',
+                    'admin_contact_address1:'		=> 'admin.address.address.0',
+                    'admin_contact_address2:'		=> 'admin.address.address.1',
+                    'admin_contact_address3:'		=> 'admin.address.address.2',
+                    'admin_contact_postalcode:'		=> 'admin.address.pcode',
+                    'admin_contact_city:'			=> 'admin.address.city',
+                    'admin_contact_country:'		=> 'admin.address.country',
+                    'admin_contact_phone:'			=> 'admin.phone',
+                    'admin_contact_fax:'			=> 'admin.fax',
+                    'admin_contact_email:'			=> 'admin.email',
+                    'technical_contact_name:'		=> 'tech.name',
+                    'technical_contact_address1:'	=> 'tech.address.address.0',
+                    'technical_contact_address1:'	=> 'tech.address.address.1',
+                    'technical_contact_address1:'	=> 'tech.address.address.2',
+                    'technical_contact_postalcode:'	=> 'tech.address.pcode',
+                    'technical_contact_city:'		=> 'tech.address.city',
+                    'technical_contact_country:'	=> 'tech.address.country',
+                    'technical_contact_phone:'		=> 'tech.phone',
+                    'technical_contact_fax:'		=> 'tech.fax',
+                    'technical_contact_email:'		=> 'tech.email'
+		              );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items);
+		if (!empty($r['regrinfo']['domain']['status']))
+			$domain_status = substr($r['regrinfo']['domain']['status'],0,3);
+		else
+			$domain_status = '';
+		if ($domain_status=='200')
+			$r['regrinfo']['registered']='yes';
+		elseif ($domain_status=='220')
+			$r['regrinfo']['registered']='no';
+		else
+			$r['regrinfo']['registered']='unknown';
+		if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
+			$r['regrinfo']['registered'] = 'unknown';
+		$r['regyinfo']['referrer'] = 'http://www.dnc.org.nz';
+		$r['regyinfo']['registrar'] = 'New Zealand Domain Name Registry Limited';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.org.php
+++ b/src/whois.org.php
@@ -1,51 +1,35 @@
 <?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link      http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
-if (!defined('__ORG_HANDLER__')) {
-    define('__ORG_HANDLER__', 1);
-}
-require_once 'whois.parser.php';
+if (!defined('__ORG_HANDLER__'))
+	define('__ORG_HANDLER__', 1);
+require_once('whois.parser.php');
 class org_handler
-{
-    /**
-     * @param array  $data_str
-     * @param string $query
-     *
-     * @return array
-     */
-    function parse($data_str, $query)
-    {
-        $r = [
-            'regrinfo' => generic_parser_b($data_str['rawdata']),
-        ];
-        if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20)) {
-            $r['regrinfo']['registered'] = 'unknown';
-        }
-        $r['regyinfo']['referrer']  = 'http://www.pir.org/';
-        $r['regyinfo']['registrar'] = 'Public Interest Registry';
-        if (!array_key_exists('rawdata', $r) && array_key_exists('rawdata', $data_str)) {
-            $r['rawdata'] = $data_str['rawdata'];
-        }
-        return $r;
-    }
-}
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
+			$r['regrinfo']['registered'] = 'unknown';
+		$r['regyinfo']['referrer'] = 'http://www.pir.org/';
+		$r['regyinfo']['registrar'] = 'Public Interest Registry';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.org.za.php
+++ b/src/whois.org.za.php
@@ -1,51 +1,51 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__ORG_ZA_HANDLER__'))
-    define('__ORG_ZA_HANDLER__', 1);
-class org_za_handler {
-    function parse($data, $query) {
-        $items = array(
-            'domain.status' => 'Status:',
-            'domain.nserver' => 'Domain name servers in listed order:',
-            'domain.changed' => 'Record last updated on',
-            'owner' => 'rwhois search on',
-            'admin' => 'Administrative Contact:',
-            'tech' => 'Technical Contact:',
-            'billing' => 'Billing Contact:',
-            '#' => 'Search Again'
-        );
-        $r = array();
-        $r['regrinfo'] = get_blocks($data['rawdata'], $items);
-        if (isset($r['regrinfo']['domain']['status'])) {
-            $r['regrinfo']['registered'] = 'yes';
-            $r['regrinfo']['domain']['handler'] = strtok(array_shift($r['regrinfo']['owner']), ' ');
-            $r['regrinfo'] = get_contacts($r['regrinfo']);
-        } else
-            $r['regrinfo']['registered'] = 'no';
-        $r['regyinfo']['referrer'] = 'http://www.org.za';
-        $r['regyinfo']['registrar'] = 'The ORG.ZA Domain';
-        return $r;
-    }
-}
+	define('__ORG_ZA_HANDLER__', 1);
+class org_za_handler
+	{
+	function parse($data, $query)
+		{
+		$items = array(
+                'domain.status'		=> 'Status:',
+				'domain.nserver'	=> 'Domain name servers in listed order:',
+                'domain.changed'	=> 'Record last updated on',
+                'owner'				=> 'rwhois search on',
+                'admin'				=> 'Administrative Contact:',
+                'tech'				=> 'Technical Contact:',
+				'billing'			=> 'Billing Contact:',
+				'#'					=> 'Search Again'
+				);
+		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
+		if (isset($r['regrinfo']['domain']['status']))
+			{
+			$r['regrinfo']['registered'] = 'yes';
+			$r['regrinfo']['domain']['handler'] = strtok(array_shift($r['regrinfo']['owner']),' ');
+			$r['regrinfo'] = get_contacts($r['regrinfo']);
+			}
+		else
+			$r['regrinfo']['registered'] = 'no';
+		$r['regyinfo']['referrer'] = 'http://www.org.za';
+		$r['regyinfo']['registrar'] = 'The ORG.ZA Domain';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.parser.php
+++ b/src/whois.parser.php
@@ -1,836 +1,725 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-/**
- * @param string[] $rawdata
- * @param string[] $translate
- * @param string[] $contacts
- * @param string   $main
- * @param string   $dateformat
- *
- * @return array
- *
- * @deprecated Use AbstractHandler::generic_parser_a
- */
-function generic_parser_a($rawdata, $translate, $contacts, $main = 'domain', $dateformat = 'dmy') {
-    $blocks = generic_parser_a_blocks($rawdata, $translate, $disclaimer);
-    $ret = array();
-    if (isset($disclaimer) && is_array($disclaimer))
-        $ret['disclaimer'] = $disclaimer;
-    if (empty($blocks) || !is_array($blocks['main'])) {
-        $ret['registered'] = 'no';
-        return $ret;
-    }
-    $r = $blocks['main'];
-    $ret['registered'] = 'yes';
-    foreach ($contacts as $key => $val) {
-        if (isset($r[$key])) {
-            if (is_array($r[$key])) {
-                $blk = $r[$key][count($r[$key]) - 1];
-            } else {
-                $blk = $r[$key];
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+function generic_parser_a ($rawdata, $translate, $contacts, $main='domain', $dateformat='dmy')
+{
+$blocks = generic_parser_a_blocks($rawdata,$translate,$disclaimer);
+if (isset($disclaimer) && is_array($disclaimer))
+    $ret['disclaimer']=$disclaimer;
+if (empty($blocks) || !is_array($blocks['main']))
+   {
+   $ret['registered']='no';
+   return $ret;
+   }
+$r = $blocks['main'];
+$ret['registered'] = 'yes';
+while (list($key,$val) = each($contacts))
+	if (isset($r[$key]))
+		{
+		if (is_array($r[$key]))
+	        $blk = $r[$key][count($r[$key])-1];
+		else
+			$blk = $r[$key];
+		$blk = strtoupper(strtok($blk,' '));
+		if (isset($blocks[$blk])) $ret[$val] = $blocks[$blk];
+		unset($r[$key]);
+		}
+if ($main) $ret[$main] = $r;
+format_dates($ret,$dateformat);
+return $ret;
+}
+function generic_parser_a_blocks ($rawdata, $translate, &$disclaimer)
+{
+$r = array();
+$newblock = false;
+$hasdata = false;
+$block = array();
+$blocks = false;
+$gkey = 'main';
+$dend = false;
+while (list($key,$val)=each($rawdata))
+	{
+	$val=trim($val);
+	if ($val != '' && ($val[0] == '%' || $val[0] == '#'))
+		{
+		if (!$dend) $disclaimer[]=trim(substr($val,1));
+		continue;
+		}
+	if ($val=='')
+		{
+		$newblock = true;
+		continue;
+		}
+	if ($newblock && $hasdata)
+		{
+		$blocks[$gkey] = $block;
+		$block = array();
+		$gkey = '';
+		}
+	$dend = true;
+	$newblock = false;
+	$k = trim(strtok($val,':'));
+	$v = trim(substr(strstr($val,':'),1));
+	if ($v == '') continue;
+	$hasdata = true;
+	if (isset($translate[$k]))
+		{
+		$k=$translate[$k];
+		if ($k=='') continue;
+		if (strstr($k,'.'))
+			{
+			eval("\$block".getvarname($k)."=\$v;");
+			continue;
+			}
+           }
+	else $k=strtolower($k);
+	if ($k=='handle')
+		{
+		$v = strtok($v,' ');
+		$gkey = strtoupper($v);
+		}
+	if (isset($block[$k]) && is_array($block[$k]))
+		$block[$k][]=$v;
+	else
+		if (!isset($block[$k]) || $block[$k]=='')
+			$block[$k]=$v;
+		else
+			{
+			$x=$block[$k];
+		    unset($block[$k]);
+		    $block[$k][]=$x;
+            $block[$k][]=$v;
             }
-            $blk = strtoupper(strtok($blk, ' '));
-            if (isset($blocks[$blk])) {
-                $ret[$val] = $blocks[$blk];
-            }
-            unset($r[$key]);
-        }
-    }
-    if ($main)
-        $ret[$main] = $r;
-    format_dates($ret, $dateformat);
-    return $ret;
-}
-function generic_parser_a_blocks($rawdata, $translate, &$disclaimer) {
-    $r = array();
-    $newblock = false;
-    $hasdata = false;
-    $block = array();
-    $blocks = false;
-    $gkey = 'main';
-    $dend = false;
-    foreach ($rawdata as $val) {
-        $val = trim($val);
-        if ($val != '' && ($val[0] == '%' || $val[0] == '#')) {
-            if (!$dend)
-                $disclaimer[] = trim(substr($val, 1));
-            continue;
-        }
-        if ($val == '') {
-            $newblock = true;
-            continue;
-        }
-        if ($newblock && $hasdata) {
-            $blocks[$gkey] = $block;
-            $block = array();
-            $gkey = '';
-        }
-        $dend = true;
-        $newblock = false;
-        $k = trim(strtok($val, ':'));
-        $v = trim(substr(strstr($val, ':'), 1));
-        if ($v == '')
-            continue;
-        $hasdata = true;
-        if (isset($translate[$k])) {
-            $k = $translate[$k];
-            if ($k == '')
-                continue;
-            if (strstr($k, '.')) {
-                $block = assign($block, $k, $v);
-                continue;
-            }
-        } else
-            $k = strtolower($k);
-        if ($k == 'handle') {
-            $v = strtok($v, ' ');
-            $gkey = strtoupper($v);
-        }
-        if (isset($block[$k]) && is_array($block[$k]))
-            $block[$k][] = $v;
-        else
-        if (!isset($block[$k]) || $block[$k] == '')
-            $block[$k] = $v;
-        else {
-            $x = $block[$k];
-            unset($block[$k]);
-            $block[$k][] = $x;
-            $block[$k][] = $v;
-        }
-    }
-    if ($hasdata)
-        $blocks[$gkey] = $block;
-    return $blocks;
-}
-/**
- * @param        $rawdata
- * @param array  $items
- * @param string $dateformat
- * @param bool   $hasreg
- * @param bool   $scanall
- *
- * @return array
- *
- * @deprecated Use AbstractHandler::generic_parser_b
- */
-function generic_parser_b($rawdata, $items = array(), $dateformat = 'mdy', $hasreg = true, $scanall = false) {
-    if (is_array($items) && !count($items))
-        $items = array(
-            'Domain Name:' => 'domain.name',
-            'Domain ID:' => 'domain.handle',
-            'Sponsoring Registrar:' => 'domain.sponsor',
-            'Registrar:' => 'domain.sponsor',
-            'Registrar ID:' => 'domain.sponsor',
-            'Domain Status:' => 'domain.status.',
-            'Status:' => 'domain.status.',
-            'Name Server:' => 'domain.nserver.',
-            'Nameservers:' => 'domain.nserver.',
-            'Maintainer:' => 'domain.referer',
-            'Domain Registration Date:' => 'domain.created',
-            'Domain Create Date:' => 'domain.created',
-            'Domain Expiration Date:' => 'domain.expires',
-            'Domain Last Updated Date:' => 'domain.changed',
-            'Updated Date:' => 'domain.changed',
-            'Creation Date:' => 'domain.created',
-            'Last Modification Date:' => 'domain.changed',
-            'Expiration Date:' => 'domain.expires',
-            'Created On:' => 'domain.created',
-            'Last Updated On:' => 'domain.changed',
-            'Registry Expiry Date:' => 'domain.expires',
-            'Registrant ID:' => 'owner.handle',
-            'Registrant Name:' => 'owner.name',
-            'Registrant Organization:' => 'owner.organization',
-            'Registrant Address:' => 'owner.address.street.',
-            'Registrant Address1:' => 'owner.address.street.',
-            'Registrant Address2:' => 'owner.address.street.',
-            'Registrant Street:' => 'owner.address.street.',
-            'Registrant Street1:' => 'owner.address.street.',
-            'Registrant Street2:' => 'owner.address.street.',
-            'Registrant Street3:' => 'owner.address.street.',
-            'Registrant Postal Code:' => 'owner.address.pcode',
-            'Registrant City:' => 'owner.address.city',
-            'Registrant State/Province:' => 'owner.address.state',
-            'Registrant Country:' => 'owner.address.country',
-            'Registrant Country/Economy:' => 'owner.address.country',
-            'Registrant Phone Number:' => 'owner.phone',
-            'Registrant Phone:' => 'owner.phone',
-            'Registrant Facsimile Number:' => 'owner.fax',
-            'Registrant FAX:' => 'owner.fax',
-            'Registrant Email:' => 'owner.email',
-            'Registrant E-mail:' => 'owner.email',
-            'Administrative Contact ID:' => 'admin.handle',
-            'Administrative Contact Name:' => 'admin.name',
-            'Administrative Contact Organization:' => 'admin.organization',
-            'Administrative Contact Address:' => 'admin.address.street.',
-            'Administrative Contact Address1:' => 'admin.address.street.',
-            'Administrative Contact Address2:' => 'admin.address.street.',
-            'Administrative Contact Postal Code:' => 'admin.address.pcode',
-            'Administrative Contact City:' => 'admin.address.city',
-            'Administrative Contact State/Province:' => 'admin.address.state',
-            'Administrative Contact Country:' => 'admin.address.country',
-            'Administrative Contact Phone Number:' => 'admin.phone',
-            'Administrative Contact Email:' => 'admin.email',
-            'Administrative Contact Facsimile Number:' => 'admin.fax',
-            'Administrative Contact Tel:' => 'admin.phone',
-            'Administrative Contact Fax:' => 'admin.fax',
-            'Administrative ID:' => 'admin.handle',
-            'Administrative Name:' => 'admin.name',
-            'Administrative Organization:' => 'admin.organization',
-            'Administrative Address:' => 'admin.address.street.',
-            'Administrative Address1:' => 'admin.address.street.',
-            'Administrative Address2:' => 'admin.address.street.',
-            'Administrative Postal Code:' => 'admin.address.pcode',
-            'Administrative City:' => 'admin.address.city',
-            'Administrative State/Province:' => 'admin.address.state',
-            'Administrative Country/Economy:' => 'admin.address.country',
-            'Administrative Phone:' => 'admin.phone',
-            'Administrative E-mail:' => 'admin.email',
-            'Administrative Facsimile Number:' => 'admin.fax',
-            'Administrative Tel:' => 'admin.phone',
-            'Administrative FAX:' => 'admin.fax',
-            'Admin ID:' => 'admin.handle',
-            'Admin Name:' => 'admin.name',
-            'Admin Organization:' => 'admin.organization',
-            'Admin Street:' => 'admin.address.street.',
-            'Admin Street1:' => 'admin.address.street.',
-            'Admin Street2:' => 'admin.address.street.',
-            'Admin Street3:' => 'admin.address.street.',
-            'Admin Address:' => 'admin.address.street.',
-            'Admin Address2:' => 'admin.address.street.',
-            'Admin Address3:' => 'admin.address.street.',
-            'Admin City:' => 'admin.address.city',
-            'Admin State/Province:' => 'admin.address.state',
-            'Admin Postal Code:' => 'admin.address.pcode',
-            'Admin Country:' => 'admin.address.country',
-            'Admin Country/Economy:' => 'admin.address.country',
-            'Admin Phone:' => 'admin.phone',
-            'Admin FAX:' => 'admin.fax',
-            'Admin Email:' => 'admin.email',
-            'Admin E-mail:' => 'admin.email',
-            'Technical Contact ID:' => 'tech.handle',
-            'Technical Contact Name:' => 'tech.name',
-            'Technical Contact Organization:' => 'tech.organization',
-            'Technical Contact Address:' => 'tech.address.street.',
-            'Technical Contact Address1:' => 'tech.address.street.',
-            'Technical Contact Address2:' => 'tech.address.street.',
-            'Technical Contact Postal Code:' => 'tech.address.pcode',
-            'Technical Contact City:' => 'tech.address.city',
-            'Technical Contact State/Province:' => 'tech.address.state',
-            'Technical Contact Country:' => 'tech.address.country',
-            'Technical Contact Phone Number:' => 'tech.phone',
-            'Technical Contact Facsimile Number:' => 'tech.fax',
-            'Technical Contact Phone:' => 'tech.phone',
-            'Technical Contact Fax:' => 'tech.fax',
-            'Technical Contact Email:' => 'tech.email',
-            'Technical ID:' => 'tech.handle',
-            'Technical Name:' => 'tech.name',
-            'Technical Organization:' => 'tech.organization',
-            'Technical Address:' => 'tech.address.street.',
-            'Technical Address1:' => 'tech.address.street.',
-            'Technical Address2:' => 'tech.address.street.',
-            'Technical Postal Code:' => 'tech.address.pcode',
-            'Technical City:' => 'tech.address.city',
-            'Technical State/Province:' => 'tech.address.state',
-            'Technical Country/Economy:' => 'tech.address.country',
-            'Technical Phone Number:' => 'tech.phone',
-            'Technical Facsimile Number:' => 'tech.fax',
-            'Technical Phone:' => 'tech.phone',
-            'Technical Fax:' => 'tech.fax',
-            'Technical FAX:' => 'tech.fax',
-            'Technical E-mail:' => 'tech.email',
-            'Tech ID:' => 'tech.handle',
-            'Tech Name:' => 'tech.name',
-            'Tech Organization:' => 'tech.organization',
-            'Tech Address:' => 'tech.address.street.',
-            'Tech Address2:' => 'tech.address.street.',
-            'Tech Address3:' => 'tech.address.street.',
-            'Tech Street:' => 'tech.address.street.',
-            'Tech Street1:' => 'tech.address.street.',
-            'Tech Street2:' => 'tech.address.street.',
-            'Tech Street3:' => 'tech.address.street.',
-            'Tech City:' => 'tech.address.city',
-            'Tech Postal Code:' => 'tech.address.pcode',
-            'Tech State/Province:' => 'tech.address.state',
-            'Tech Country:' => 'tech.address.country',
-            'Tech Country/Economy:' => 'tech.address.country',
-            'Tech Phone:' => 'tech.phone',
-            'Tech FAX:' => 'tech.fax',
-            'Tech Email:' => 'tech.email',
-            'Tech E-mail:' => 'tech.email',
-            'Billing Contact ID:' => 'billing.handle',
-            'Billing Contact Name:' => 'billing.name',
-            'Billing Contact Organization:' => 'billing.organization',
-            'Billing Contact Address1:' => 'billing.address.street.',
-            'Billing Contact Address2:' => 'billing.address.street.',
-            'Billing Contact Postal Code:' => 'billing.address.pcode',
-            'Billing Contact City:' => 'billing.address.city',
-            'Billing Contact State/Province:' => 'billing.address.state',
-            'Billing Contact Country:' => 'billing.address.country',
-            'Billing Contact Phone Number:' => 'billing.phone',
-            'Billing Contact Facsimile Number:' => 'billing.fax',
-            'Billing Contact Email:' => 'billing.email',
-            'Billing ID:' => 'billing.handle',
-            'Billing Name:' => 'billing.name',
-            'Billing Organization:' => 'billing.organization',
-            'Billing Address:' => 'billing.address.street.',
-            'Billing Address1:' => 'billing.address.street.',
-            'Billing Address2:' => 'billing.address.street.',
-            'Billing Address3:' => 'billing.address.street.',
-            'Billing Street:' => 'billing.address.street.',
-            'Billing Street1:' => 'billing.address.street.',
-            'Billing Street2:' => 'billing.address.street.',
-            'Billing Street3:' => 'billing.address.street.',
-            'Billing City:' => 'billing.address.city',
-            'Billing Postal Code:' => 'billing.address.pcode',
-            'Billing State/Province:' => 'billing.address.state',
-            'Billing Country:' => 'billing.address.country',
-            'Billing Country/Economy:' => 'billing.address.country',
-            'Billing Phone:' => 'billing.phone',
-            'Billing Fax:' => 'billing.fax',
-            'Billing FAX:' => 'billing.fax',
-            'Billing Email:' => 'billing.email',
-            'Billing E-mail:' => 'billing.email',
-            'Zone ID:' => 'zone.handle',
-            'Zone Organization:' => 'zone.organization',
-            'Zone Name:' => 'zone.name',
-            'Zone Address:' => 'zone.address.street.',
-            'Zone Address 2:' => 'zone.address.street.',
-            'Zone City:' => 'zone.address.city',
-            'Zone State/Province:' => 'zone.address.state',
-            'Zone Postal Code:' => 'zone.address.pcode',
-            'Zone Country:' => 'zone.address.country',
-            'Zone Phone Number:' => 'zone.phone',
-            'Zone Fax Number:' => 'zone.fax',
-            'Zone Email:' => 'zone.email'
-        );
-    $r = [];
-    $disok = true;
-    foreach ($rawdata as $val) {
-        if (trim($val) != '') {
-            if (($val[0] == '%' || $val[0] == '#') && $disok) {
-                $r['disclaimer'][] = trim(substr($val, 1));
-                $disok = true;
-                continue;
-            }
-            $disok = false;
-            reset($items);
-            foreach ($items as $match => $field) {
-                $pos = strpos($val, $match);
-                if ($pos !== false) {
-                    if ($field != '') {
-                        $itm = trim(substr($val, $pos + strlen($match)));
-                        if ($itm != '') {
-                            $r = assign($r, $field, str_replace('"', '\"', $itm));
-                        }
-                    }
-                    if (!$scanall)
-                        break;
-                }
-            }
-        }
-    }
-    if (empty($r)) {
-        if ($hasreg)
-            $r['registered'] = 'no';
-    }
-    else {
-        if ($hasreg)
-            $r['registered'] = 'yes';
-        $r = format_dates($r, $dateformat);
-    }
-    return $r;
-}
-/**
- * @param array    $array The array to populate
- * @param string[] $parts
- * @param mixed    $value The value to be assigned to the $vDef key
- *
- * @return array The updated array
- * @see https://github.com/sparc/phpWhois.org/compare/18849d1a98b992190612cdb2561e7b4492c505f5...8c6a18686775b25f05592dd67d7706e47167a498#diff-b8adbe1292f8abca1f943aa844db52aa Original fix by David Saez PAdros sparc
- */
-function assign_recursive(array $array, array $parts, $value)
-{
-    $key = array_shift($parts);
-    if (count($parts) === 0) {
-        if (!$key) {
-            $array[] = $value;
-        } else {
-            $array[$key] = $value;
-        }
-    } else {
-        if (!isset($array[$key])) {
-            $array[$key] = [];
-        }
-        $array[$key] = assign_recursive($array[$key], $parts, $value);
-    }
-    return $array;
-}
-/**
- * @param array  $array The array to populate
- * @param string $vDef  A period-separated string of nested array keys
- * @param mixed  $value The value to be assigned to the $vDef key
- *
- * @return array The updated array
- * @see https://github.com/sparc/phpWhois.org/compare/18849d1a98b992190612cdb2561e7b4492c505f5...8c6a18686775b25f05592dd67d7706e47167a498#diff-b8adbe1292f8abca1f943aa844db52aa Original fix by David Saez PAdros sparc
- */
-function assign(array $array, string $vDef, $value)
-{
-    return assign_recursive($array, explode('.', $vDef), $value);
-}
-/**
- * @param string[] $rawdata
- * @param string[] $items
- * @param bool     $partial_match
- * @param bool     $def_block
- *
- * @return array
- *
- * @deprecated Use AbstractHandler::get_blocks
- */
-function get_blocks($rawdata, $items, $partial_match = false, $def_block = false) {
-    $r = array();
-    $endtag = '';
-    while ($val = current($rawdata)) {
-        next($rawdata);
-        $val = trim($val);
-        if ($val == '')
-            continue;
-        $var = $found = false;
-        foreach ($items as $field => $match) {
-            $pos = strpos($val, $match);
-            if ($field != '' && $pos !== false) {
-                if ($val == $match) {
-                    $found = true;
-                    $endtag = '';
-                    $line = $val;
-                    break;
-                }
-                $last = substr($val, -1, 1);
-                if ($last == ':' || $last == '-' || $last == ']') {
-                    $found = true;
-                    $endtag = $last;
-                    $line = $val;
-                } else {
-                    $var = strtok($field, '#');
-                    $r   = assign($r, $var, trim(substr($val, $pos + strlen($match))));
-                }
-                break;
-            }
-        }
-        if (!$found) {
-            if (!$var && $def_block)
-                $r[$def_block][] = $val;
-            continue;
-        }
-        $block = array();
-        while ($val = current($rawdata)) {
-            next($rawdata);
-            $val = trim($val);
-            if ($val == '' || $val == str_repeat($val[0], strlen($val)))
-                continue;
-            $last = substr($val, -1, 1);
-            /*
-              if ($last == $endtag)
-              {
-              prev($rawdata);
-              break;
-              }
-              if ($endtag == '' || $partial_match)
-             */
-            if ($endtag == '' || $partial_match || $last == $endtag) {
-                $et = false;
-                foreach ($items as $field => $match) {
-                    $pos = strpos($val, $match);
-                    if ($pos !== false && $pos == 0) {
-                        $et = true;
-                        break;
-                    }
-                }
-                if ($et) {
-                    prev($rawdata);
-                    break;
-                }
-            }
-            $block[] = $val;
-        }
-        if (empty($block))
-            continue;
-        foreach ($items as $field => $match) {
-            $pos = strpos($line, $match);
-            if ($pos !== false) {
-                $var = strtok($field, '#');
-                if ($var != '[]') {
-                    $r = assign($r, $var, $block);
-                }
-            }
-        }
-    }
-    return $r;
-}
-/**
- * @param       $data_str
- * @param       $items
- * @param       $date_format
- * @param array $translate
- * @param bool  $has_org
- * @param bool  $partial_match
- * @param bool  $def_block
- *
- * @return mixed
- *
- * @deprecated Use AbstractHandler::easy_parser
- */
-function easy_parser($data_str, $items, $date_format, $translate = array(), $has_org = false, $partial_match = false, $def_block = false) {
-    $r = get_blocks($data_str, $items, $partial_match, $def_block);
-    $r = get_contacts($r, $translate, $has_org);
-    format_dates($r, $date_format);
-    return $r;
-}
-/**
- * @param       $array
- * @param array $extra_items
- * @param bool  $has_org
- *
- * @return mixed
- *
- * @deprecated Use AbstractHandler::get_contacts
- */
-function get_contacts($array, $extra_items = array(), $has_org = false) {
-    if (isset($array['billing']))
-        $array['billing'] = get_contact($array['billing'], $extra_items, $has_org);
-    if (isset($array['tech']))
-        $array['tech'] = get_contact($array['tech'], $extra_items, $has_org);
-    if (isset($array['zone']))
-        $array['zone'] = get_contact($array['zone'], $extra_items, $has_org);
-    if (isset($array['admin']))
-        $array['admin'] = get_contact($array['admin'], $extra_items, $has_org);
-    if (isset($array['owner']))
-        $array['owner'] = get_contact($array['owner'], $extra_items, $has_org);
-    if (isset($array['registrar']))
-        $array['registrar'] = get_contact($array['registrar'], $extra_items, $has_org);
-    return $array;
-}
-/**
- * @param       $array
- * @param array $extra_items
- * @param bool  $has_org
- *
- * @return array
- *
- * @deprecated Use AbstractHandler::get_contact
- */
-function get_contact($array, $extra_items = array(), $has_org = false) {
-    if (!is_array($array))
-        return array();
-    $items = array(
-        'fax..:' => 'fax',
-        'fax.' => 'fax',
-        'fax-no:' => 'fax',
-        'fax -' => 'fax',
-        'fax-' => 'fax',
-        'fax::' => 'fax',
-        'fax:' => 'fax',
-        '[fax]' => 'fax',
-        '(fax)' => 'fax',
-        'fax' => 'fax',
-        'tel. ' => 'phone',
-        'tel:' => 'phone',
-        'phone::' => 'phone',
-        'phone:' => 'phone',
-        'phone-' => 'phone',
-        'phone -' => 'phone',
-        'email:' => 'email',
-        'e-mail:' => 'email',
-        'company name:' => 'organization',
-        'organisation:' => 'organization',
-        'first name:' => 'name.first',
-        'last name:' => 'name.last',
-        'street:' => 'address.street',
-        'address:' => 'address.street.',
-        'language:' => '',
-        'location:' => 'address.city',
-        'country:' => 'address.country',
-        'name:' => 'name',
-        'last modified:' => 'changed'
-    );
-    if (is_array($extra_items) && count($extra_items)) {
-        foreach ($items as $match => $field)
-            if (!isset($extra_items[$match]))
-                $extra_items[$match] = $field;
-        $items = $extra_items;
-    }
-    $r = [];
-    foreach ($array as $key => $val) {
-        $ok = true;
-        while ($ok) {
-            reset($items);
-            $ok = false;
-            foreach ($items as $match => $field) {
-                $pos = strpos(strtolower($val), $match);
-                if ($pos === false)
-                    continue;
-                $itm = trim(substr($val, $pos + strlen($match)));
-                if ($field != '' && $itm != '') {
-                    $r = assign($r, $field, $itm);
-                }
-                $val = trim(substr($val, 0, $pos));
-                if ($val == '') {
-                    unset($array[$key]);
-                    break;
-                } else {
-                    $array[$key] = $val;
-                    $ok = true;
-                }
-            }
-            if (preg_match("/([+]*[-\(\)\. x0-9]){7,}/", $val, $matches)) {
-                $phone = trim(str_replace(' ', '', $matches[0]));
-                if (strlen($phone) > 8 && !preg_match('/[0-9]{5}\-[0-9]{3}/', $phone)) {
-                    if (isset($r['phone'])) {
-                        if (isset($r['fax']))
-                            continue;
-                        $r['fax'] = trim($matches[0]);
-                    }
-                    else {
-                        $r['phone'] = trim($matches[0]);
-                    }
-                    $val = str_replace($matches[0], '', $val);
-                    if ($val == '') {
-                        unset($array[$key]);
-                        continue;
-                    } else {
-                        $array[$key] = $val;
-                        $ok = true;
-                    }
-                }
-            }
-            if (preg_match('/([-0-9a-zA-Z._+&\/=]+@([-0-9a-zA-Z]+[.])+[a-zA-Z]{2,6})/', $val, $matches)) {
-                $r['email'] = $matches[0];
-                $val = str_replace($matches[0], '', $val);
-                $val = trim(str_replace('()', '', $val));
-                if ($val == '') {
-                    unset($array[$key]);
-                    continue;
-                } else {
-                    if (!isset($r['name'])) {
-                        $r['name'] = $val;
-                        unset($array[$key]);
-                    } else
-                        $array[$key] = $val;
-                    $ok = true;
-                }
-            }
-        }
-    }
-    if (!isset($r['name']) && count($array) > 0) {
-        $r['name'] = array_shift($array);
-    }
-    if ($has_org && count($array) > 0) {
-        $r['organization'] = array_shift($array);
-    }
-    if (isset($r['name']) && is_array($r['name'])) {
-        $r['name'] = implode($r['name'], ' ');
-    }
-    if (!empty($array)) {
-        if (isset($r['address']))
-            $r['address'] = array_merge($r['address'], $array);
-        else
-            $r['address'] = $array;
-    }
-    return $r;
-}
-/**
- * @param        $res
- * @param string $format
- *
- * @return array
- *
- * @deprecated Use AbstractHandler::format_dates
- */
-function format_dates(&$res, $format = 'mdy') {
-    if (!is_array($res))
-        return $res;
-    foreach ($res as $key => $val) {
-        if (is_array($val)) {
-            if (!is_numeric($key) && ($key == 'expires' || $key == 'created' || $key == 'changed')) {
-                $d = get_date($val[0], $format);
-                if ($d)
-                    $res[$key] = $d;
-            }
-            else {
-                $res[$key] = format_dates($val, $format);
-            }
-        } else {
-            if (!is_numeric($key) && ($key == 'expires' || $key == 'created' || $key == 'changed')) {
-                $d = get_date($val, $format);
-                if ($d)
-                    $res[$key] = $d;
-            }
-        }
-    }
-    return $res;
-}
-/**
- * @param $date
- * @param $format
- *
- * @return string|string[]
- *
- * @deprecated Use AbstractHandler::get_date
- */
-function get_date($date, $format)
-{
-    $parsedDate = parseStandardDate($date);
-    if ($parsedDate instanceof DateTime) {
-        return $parsedDate->format('Y-m-d');
-    }
-    $months = [
-        'jan' => 1,
-        'ene' => 1,
-        'feb' => 2,
-        'mar' => 3,
-        'apr' => 4,
-        'abr' => 4,
-        'may' => 5,
-        'jun' => 6,
-        'jul' => 7,
-        'aug' => 8,
-        'ago' => 8,
-        'sep' => 9,
-        'oct' => 10,
-        'nov' => 11,
-        'dec' => 12,
-        'dic' => 12,
-    ];
-    $parts = explode(' ', $date);
-    if (strpos($parts[0], '@') !== false) {
-        unset($parts[0]);
-        $date = implode(' ', $parts);
-    }
-    $date = str_replace([',', '.', '-', '/', "\t"], ' ', trim($date));
-    $parts = explode(' ', $date);
-    $res   = [];
-    if ((strlen($parts[0]) === 8 || count($parts) === 1) && is_numeric($parts[0])) {
-        $val = $parts[0];
-        for ($p = $i = 0; $i < 3; $i++) {
-            if ($format[$i] !== 'Y') {
-                $res[$format[$i]] = substr($val, $p, 2);
-                $p                += 2;
-            } else {
-                $res['y'] = substr($val, $p, 4);
-                $p        += 4;
-            }
-        }
-    } else {
-        $format = strtolower($format);
-        for ($p = $i = 0; $p < count($parts) && $i < strlen($format); $p++) {
-            if (trim($parts[$p]) === '') {
-                continue;
-            }
-            if ($format[$i] !== '-') {
-                $res[$format[$i]] = $parts[$p];
-            }
-            $i++;
-        }
-    }
-    if (!$res) {
-        return $date;
-    }
-    $ok = false;
-    while (!$ok) {
-        $ok = true;
-        foreach ($res as $key => $val) {
-            if ($val === '' || $key === '') {
-                continue;
-            }
-            if (!is_numeric($val) && isset($months[strtolower(substr($val, 0, 3))])) {
-                $res[$key] = $res['m'];
-                $res['m']  = $months[strtolower(substr($val, 0, 3))];
-                $ok        = false;
-                break;
-            }
-            if ($key !== 'y' && $key !== 'Y' && $val > 1900) {
-                $res[$key] = $res['y'];
-                $res['y']  = $val;
-                $ok        = false;
-                break;
-            }
-        }
-    }
-    if ($res['m'] > 12) {
-        $v = $res['m'];
-        $res['m'] = $res['d'];
-        $res['d'] = $v;
-    }
-    if ($res['y'] < 70)
-        $res['y'] += 2000;
-    else
-    if ($res['y'] <= 99)
-        $res['y'] += 1900;
-    return sprintf('%.4d-%02d-%02d', $res['y'], $res['m'], $res['d']);
-}
-/**
- * @param string $date
- *
- * @return false|DateTime
- */
-function parseStandardDate(string $date)
-{
-    $date = trim($date);
-    $pattern = '/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}).\d(Z)$/';
-    if (preg_match($pattern, $date, $matches)) {
-        if (PHP_VERSION_ID >= 70300) {
-            $dateTimeFormat = 'Y-m-d\TH:i:s.vT';
-            return Datetime::createFromFormat($dateTimeFormat, $date);
-        }
-        $date = $matches[1] . $matches[2];
-    }
-    $pattern = '/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/';
-    if (preg_match($pattern, $date)) {
-        $dateTimeFormat = 'Y-m-d\TH:i:sT';
-        return Datetime::createFromFormat($dateTimeFormat, $date);
-    }
-    $pattern = '/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}$/';
-    if (preg_match($pattern, $date)) {
-        $dateTimeFormat = 'Y-m-d\TH:i:s';
-        $utc = new DateTimeZone('UTC');
-        return Datetime::createFromFormat($dateTimeFormat, $date, $utc);
-    }
-    $pattern = '/^\d{2}-[a-zA-Z]{3}-\d{4}$/';
-    if (preg_match($pattern, $date)) {
-        $dateTimeFormat = 'd-M-Y';
-        $utc = new DateTimeZone('UTC');
-        return Datetime::createFromFormat($dateTimeFormat, $date, $utc);
-    }
-    $pattern = '/^(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})(?: \w+)?$/';
-    if (preg_match($pattern, $date, $matches)) {
-        $dateTimeFormat = 'Y-m-d H:i:s T';
-        $parsedDate = DateTime::createFromFormat($dateTimeFormat, $date);
-        if ($parsedDate instanceof DateTime) {
-            return $parsedDate;
-        }
-        $dateTimeFormat = 'Y-m-d H:i:s';
-        return DateTime::createFromFormat($dateTimeFormat, $matches[1]);
-    }
-    return false;
-}
+	}
+if ($hasdata) $blocks[$gkey]=$block;
+return $blocks;
+}
+function generic_parser_b ( $rawdata, $items = false, $dateformat='mdy', $hasreg=true, $scanall=false )
+{
+if (!$items)
+	$items = array(
+				'Domain Name:' => 'domain.name',
+				'Domain ID:' => 'domain.handle',
+				'Sponsoring Registrar:' => 'domain.sponsor',
+				'Registrar ID:' => 'domain.sponsor',
+				'Domain Status:' => 'domain.status.',
+				'Status:' => 'domain.status.',
+				'Name Server:' => 'domain.nserver.',
+				'Nameservers:' => 'domain.nserver.',
+				'Maintainer:' => 'domain.referer',
+				'Domain Registration Date:' => 'domain.created',
+				'Domain Create Date:' => 'domain.created',
+				'Domain Expiration Date:' => 'domain.expires',
+				'Domain Last Updated Date:' => 'domain.changed',
+				'Creation Date:' => 'domain.created',
+				'Last Modification Date:' => 'domain.changed',
+				'Expiration Date:' => 'domain.expires',
+				'Created On:' => 'domain.created',
+                'Last Updated On:' => 'domain.changed',
+                'Expiration Date:' => 'domain.expires',
+				'Registrant ID:' => 'owner.handle',
+				'Registrant Name:' => 'owner.name',
+				'Registrant Organization:' => 'owner.organization',
+				'Registrant Address:' => 'owner.address.street.',
+				'Registrant Address1:' => 'owner.address.street.',
+				'Registrant Address2:' => 'owner.address.street.',
+				'Registrant Street:' => 'owner.address.street.',
+				'Registrant Street1:' => 'owner.address.street.',
+				'Registrant Street2:' => 'owner.address.street.',
+				'Registrant Street3:' => 'owner.address.street.',
+				'Registrant Postal Code:' => 'owner.address.pcode',
+				'Registrant City:' => 'owner.address.city',
+				'Registrant State/Province:' => 'owner.address.state',
+				'Registrant Country:' => 'owner.address.country',
+				'Registrant Country/Economy:' => 'owner.address.country',
+				'Registrant Phone Number:' => 'owner.phone',
+				'Registrant Phone:' => 'owner.phone',
+				'Registrant Facsimile Number:' => 'owner.fax',
+				'Registrant FAX:' => 'owner.fax',
+				'Registrant Email:' => 'owner.email',
+				'Registrant E-mail:' => 'owner.email',
+				'Administrative Contact ID:' => 'admin.handle',
+				'Administrative Contact Name:' => 'admin.name',
+				'Administrative Contact Organization:' => 'admin.organization',
+				'Administrative Contact Address:' => 'admin.address.street.',
+				'Administrative Contact Address1:' => 'admin.address.street.',
+				'Administrative Contact Address2:' => 'admin.address.street.',
+				'Administrative Contact Postal Code:' => 'admin.address.pcode',
+				'Administrative Contact City:' => 'admin.address.city',
+				'Administrative Contact State/Province:' => 'admin.address.state',
+				'Administrative Contact Country:' => 'admin.address.country',
+				'Administrative Contact Phone Number:' => 'admin.phone',
+				'Administrative Contact Email:' => 'admin.email',
+				'Administrative Contact Facsimile Number:' => 'admin.fax',
+				'Administrative Contact Tel:' => 'admin.phone',
+				'Administrative Contact Fax:' => 'admin.fax',
+				'Administrative ID:' => 'admin.handle',
+				'Administrative Name:' => 'admin.name',
+				'Administrative Organization:' => 'admin.organization',
+				'Administrative Address:' => 'admin.address.street.',
+				'Administrative Address1:' => 'admin.address.street.',
+				'Administrative Address2:' => 'admin.address.street.',
+				'Administrative Postal Code:' => 'admin.address.pcode',
+				'Administrative City:' => 'admin.address.city',
+				'Administrative State/Province:' => 'admin.address.state',
+				'Administrative Country/Economy:' => 'admin.address.country',
+				'Administrative Phone:' => 'admin.phone',
+				'Administrative E-mail:' => 'admin.email',
+				'Administrative Facsimile Number:' => 'admin.fax',
+				'Administrative Tel:' => 'admin.phone',
+				'Administrative FAX:' => 'admin.fax',
+				'Admin ID:' => 'admin.handle',
+				'Admin Name:' => 'admin.name',
+				'Admin Organization:' => 'admin.organization',
+				'Admin Street:' => 'admin.address.street.',
+				'Admin Street1:' => 'admin.address.street.',
+				'Admin Street2:' => 'admin.address.street.',
+				'Admin Street3:' => 'admin.address.street.',
+				'Admin Address:' => 'admin.address.street.',
+				'Admin Address2:' => 'admin.address.street.',
+				'Admin Address3:' => 'admin.address.street.',
+				'Admin City:' => 'admin.address.city',
+				'Admin State/Province:' => 'admin.address.state',
+				'Admin Postal Code:' => 'admin.address.pcode',
+				'Admin Country:' => 'admin.address.country',
+				'Admin Country/Economy:' => 'admin.address.country',
+				'Admin Phone:' => 'admin.phone',
+				'Admin FAX:' => 'admin.fax',
+				'Admin Email:' => 'admin.email',
+				'Admin E-mail:' => 'admin.email',
+				'Technical Contact ID:' => 'tech.handle',
+				'Technical Contact Name:' => 'tech.name',
+				'Technical Contact Organization:' => 'tech.organization',
+				'Technical Contact Address:' => 'tech.address.street.',
+				'Technical Contact Address1:' => 'tech.address.street.',
+				'Technical Contact Address2:' => 'tech.address.street.',
+				'Technical Contact Postal Code:' => 'tech.address.pcode',
+				'Technical Contact City:' => 'tech.address.city',
+				'Technical Contact State/Province:' => 'tech.address.state',
+				'Technical Contact Country:' => 'tech.address.country',
+				'Technical Contact Phone Number:' => 'tech.phone',
+				'Technical Contact Facsimile Number:' => 'tech.fax',
+				'Technical Contact Phone:' => 'tech.phone',
+				'Technical Contact Fax:' => 'tech.fax',
+				'Technical Contact Email:' => 'tech.email',
+				'Technical ID:' => 'tech.handle',
+				'Technical Name:' => 'tech.name',
+				'Technical Organization:' => 'tech.organization',
+				'Technical Address:' => 'tech.address.street.',
+				'Technical Address1:' => 'tech.address.street.',
+				'Technical Address2:' => 'tech.address.street.',
+				'Technical Postal Code:' => 'tech.address.pcode',
+				'Technical City:' => 'tech.address.city',
+				'Technical State/Province:' => 'tech.address.state',
+				'Technical Country/Economy:' => 'tech.address.country',
+				'Technical Phone Number:' => 'tech.phone',
+				'Technical Facsimile Number:' => 'tech.fax',
+				'Technical Phone:' => 'tech.phone',
+				'Technical Fax:' => 'tech.fax',
+				'Technical FAX:' => 'tech.fax',
+				'Technical E-mail:' => 'tech.email',
+				'Tech ID:' => 'tech.handle',
+				'Tech Name:' => 'tech.name',
+				'Tech Organization:' => 'tech.organization',
+				'Tech Address:' => 'tech.address.street.',
+				'Tech Address2:' => 'tech.address.street.',
+				'Tech Address3:' => 'tech.address.street.',
+				'Tech Street:' => 'tech.address.street.',
+				'Tech Street1:' => 'tech.address.street.',
+				'Tech Street2:' => 'tech.address.street.',
+				'Tech Street3:' => 'tech.address.street.',
+				'Tech City:' => 'tech.address.city',
+				'Tech Postal Code:' => 'tech.address.pcode',
+				'Tech State/Province:' => 'tech.address.state',
+				'Tech Country:' => 'tech.address.country',
+				'Tech Country/Economy:' => 'tech.address.country',
+				'Tech Phone:' => 'tech.phone',
+				'Tech FAX:' => 'tech.fax',
+				'Tech Email:' => 'tech.email',
+				'Tech E-mail:' => 'tech.email',
+				'Billing Contact ID:' => 'billing.handle',
+				'Billing Contact Name:' => 'billing.name',
+				'Billing Contact Organization:' => 'billing.organization',
+				'Billing Contact Address1:' => 'billing.address.street.',
+				'Billing Contact Address2:' => 'billing.address.street.',
+				'Billing Contact Postal Code:' => 'billing.address.pcode',
+				'Billing Contact City:' => 'billing.address.city',
+				'Billing Contact State/Province:' => 'billing.address.state',
+				'Billing Contact Country:' => 'billing.address.country',
+				'Billing Contact Phone Number:' => 'billing.phone',
+				'Billing Contact Facsimile Number:' => 'billing.fax',
+				'Billing Contact Email:' => 'billing.email',
+				'Billing ID:' => 'billing.handle',
+				'Billing Name:' => 'billing.name',
+				'Billing Organization:' => 'billing.organization',
+				'Billing Address:' => 'billing.address.street.',
+				'Billing Address1:' => 'billing.address.street.',
+				'Billing Address2:' => 'billing.address.street.',
+				'Billing Address3:' => 'billing.address.street.',
+				'Billing Street:' => 'billing.address.street.',
+				'Billing Street1:' => 'billing.address.street.',
+				'Billing Street2:' => 'billing.address.street.',
+				'Billing Street3:' => 'billing.address.street.',
+				'Billing City:' => 'billing.address.city',
+				'Billing Postal Code:' => 'billing.address.pcode',
+				'Billing State/Province:' => 'billing.address.state',
+				'Billing Country:' => 'billing.address.country',
+				'Billing Country/Economy:' => 'billing.address.country',
+				'Billing Phone:' => 'billing.phone',
+				'Billing Fax:' => 'billing.fax',
+				'Billing FAX:' => 'billing.fax',
+				'Billing Email:' => 'billing.email',
+				'Billing E-mail:' => 'billing.email',
+				'Zone ID:' => 'zone.handle',
+                'Zone Organization:' => 'zone.organization',
+                'Zone Name:' => 'zone.name',
+                'Zone Address:' => 'zone.address.street.',
+                'Zone Address 2:' => 'zone.address.street.',
+                'Zone City:' => 'zone.address.city',
+                'Zone State/Province:' => 'zone.address.state',
+                'Zone Postal Code:' => 'zone.address.pcode',
+                'Zone Country:' => 'zone.address.country',
+                'Zone Phone Number:' => 'zone.phone',
+                'Zone Fax Number:' => 'zone.fax',
+                'Zone Email:' => 'zone.email'
+		            );
+$r = '';
+$disok = true;
+while (list($key,$val) = each($rawdata))
+	{
+	if (trim($val) != '')
+		{
+	     if (($val[0]=='%' || $val[0]=='#') && $disok)
+			{
+			$r['disclaimer'][] = trim(substr($val,1));
+			$disok = true;
+			continue;
+			}
+		$disok = false;
+		reset($items);
+		while (list($match, $field)=each($items))
+			{
+			$pos = strpos($val,$match);
+			if ($pos !== false)
+				{
+				if ($field != '')
+					{
+					$var = '$r'.getvarname($field);
+					$itm = trim(substr($val,$pos+strlen($match)));
+					if ($itm!='')
+						eval($var.'="'.str_replace('"','\"',$itm).'";');
+					}
+				if (!$scanall)
+					break;
+				}
+			}
+		}
+	}
+if (empty($r))
+	{
+	if ($hasreg) $r['registered'] = 'no';
+	}
+else
+	{
+	if ($hasreg) $r['registered'] = 'yes';
+	$r = format_dates($r, $dateformat);
+	}
+return $r;
+}
+function getvarname ( $vdef )
+{
+$parts = explode('.',$vdef);
+$var = '';
+foreach($parts as $mn)
+	if ($mn == '') $var = $var.'[]';
+	else $var = $var.'["'.$mn.'"]';
+return $var;
+}
+function get_blocks ( $rawdata, $items, $partial_match = false, $def_block = false )
+{
+$r = array();
+$endtag = '';
+while (list($key,$val) = each($rawdata))
+	{
+	$val = trim($val);
+	if ($val == '') continue;
+	$var = $found = false;
+	foreach ($items as $field => $match)
+		{
+		$pos = strpos($val,$match);
+		if ($field != '' && $pos !== false)
+			{
+			if ($val == $match)
+				{
+				$found = true;
+				$endtag = '';
+				$line = $val;
+				break;
+				}
+			$last = substr($val,-1,1);
+			if ($last == ':' || $last == '-' || $last == ']')
+				{
+				$found = true;
+				$endtag = $last;
+				$line = $val;
+				}
+			else
+				{
+				$var = getvarname(strtok($field,'#'));
+				$itm = trim(substr($val,$pos+strlen($match)));
+				eval('$r'.$var.'=$itm;');
+				}
+			break;
+			}
+		}
+	if (!$found)
+		{
+		if (!$var && $def_block) $r[$def_block][] = $val;
+		continue;
+		}
+	$block = array();
+	while (list($key,$val) = each($rawdata))
+		{
+		$val = trim($val);
+		if ($val == '' || $val == str_repeat($val[0],strlen($val))) continue;
+		$last = substr($val,-1,1);
+/*
+		if ($last == $endtag)
+			{
+			prev($rawdata);
+			break;
+			}
+		if ($endtag == '' || $partial_match)
+		*/
+		if ($endtag == '' || $partial_match || $last == $endtag)
+			{
+			$et = false;
+			foreach ($items as $field => $match)
+				{
+				$pos = strpos($val,$match);
+				if ($pos !== false && $pos == 0)
+					{
+					$et = true;
+					break;
+					}
+				}
+			if ($et)
+				{
+				prev($rawdata);
+				break;
+				}
+			}
+		$block[] = $val;
+		}
+	if (empty($block)) continue;
+	foreach ($items as $field => $match)
+		{
+		$pos = strpos($line,$match);
+		if ($pos !== false)
+			{
+			$var = getvarname(strtok($field,'#'));
+			if ($var != '[]') eval('$r'.$var.'=$block;');
+			}
+		}
+	}
+return $r;
+}
+function easy_parser($data_str, $items, $date_format, $translate = false ,
+					 $has_org = false, $partial_match = false,
+					 $def_block = false )
+{
+$r = get_blocks($data_str, $items, $partial_match, $def_block);
+$r = get_contacts($r, $translate, $has_org);
+format_dates($r, $date_format);
+return $r;
+}
+function get_contacts ( $array, $extra_items='', $has_org= false )
+{
+if (isset($array['billing']))
+	$array['billing'] = get_contact($array['billing'], $extra_items, $has_org);
+if (isset($array['tech']))
+	$array['tech'] = get_contact($array['tech'], $extra_items, $has_org);
+if (isset($array['zone']))
+	$array['zone'] = get_contact($array['zone'], $extra_items, $has_org);
+if (isset($array['admin']))
+	$array['admin'] = get_contact($array['admin'], $extra_items, $has_org);
+if (isset($array['owner']))
+	$array['owner'] = get_contact($array['owner'], $extra_items, $has_org);
+if (isset($array['registrar']))
+	$array['registrar'] = get_contact($array['registrar'], $extra_items, $has_org);
+return $array;
+}
+function get_contact ( $array, $extra_items='', $has_org= false )
+{
+if (!is_array($array))
+	return array();
+$items = array (
+		'fax..:' => 'fax',
+		'fax.' => 'fax',
+		'fax-no:' => 'fax',
+		'fax -' => 'fax',
+		'fax-' => 'fax',
+		'fax::'   => 'fax',
+		'fax:'   => 'fax',
+		'[fax]' => 'fax',
+		'(fax)' => 'fax',
+		'fax' => 'fax',
+		'tel. ' => 'phone',
+		'tel:' => 'phone',
+		'phone::' => 'phone',
+		'phone:' => 'phone',
+		'phone-' => 'phone',
+		'phone -' => 'phone',
+		'email:' => 'email',
+		'e-mail:' => 'email',
+		'company name:' => 'organization',
+		'organisation:' => 'organization',
+		'first name:' => 'name.first',
+		'last name:' => 'name.last',
+		'street:' => 'address.street',
+		'address:' => 'address.street.',
+		'language:' => '',
+		'location:' => 'address.city',
+		'country:' => 'address.country',
+		'name:' => 'name',
+		'last modified:' => 'changed'
+		);
+if ($extra_items)
+	{
+	foreach($items as $match => $field)
+		if (!isset($extra_items[$match]))
+		$extra_items[$match] = $field;
+	$items = $extra_items;
+	}
+while (list($key,$val)=each($array))
+	{
+	$ok=true;
+	while ($ok)
+		{
+		reset($items);
+		$ok = false;
+		while (list($match,$field) = each($items))
+			{
+			$pos = strpos(strtolower($val),$match);
+			if ($pos === false) continue;
+			$itm = trim(substr($val,$pos+strlen($match)));
+			if ($field != '' && $itm != '')
+				{
+				eval('$r'.getvarname($field).'=$itm;');
+				}
+			$val = trim(substr($val,0,$pos));
+			if ($val == '')
+				{
+				unset($array[$key]);
+				break;
+				}
+			else
+				{
+				$array[$key] = $val;
+				$ok = true;
+				}
+			}
+		if (preg_match("/([+]*[-\(\)\. x0-9]){7,}/", $val, $matches))
+			{
+			$phone = trim(str_replace(' ','',$matches[0]));
+			if (strlen($phone) > 8 && !preg_match('/[0-9]{5}\-[0-9]{3}/',$phone))
+				{
+				if (isset($r['phone']))
+					{
+					if (isset($r['fax'])) continue;
+					$r['fax'] = trim($matches[0]);
+					}
+				else
+					{
+					$r['phone'] = trim($matches[0]);
+					}
+				$val = str_replace($matches[0],'',$val);
+				if ($val == '')
+					{
+					unset($array[$key]);
+					continue;
+					}
+				else
+					{
+					$array[$key] = $val;
+					$ok = true;
+					}
+				}
+			}
+		if (preg_match('/([-0-9a-zA-Z._+&\/=]+@([-0-9a-zA-Z]+[.])+[a-zA-Z]{2,6})/',$val, $matches))
+			{
+			$r['email'] = $matches[0];
+			$val = str_replace($matches[0],'',$val);
+			$val = trim(str_replace('()','',$val));
+			if ($val == '')
+				{
+				unset($array[$key]);
+				continue;
+				}
+			else
+				{
+				if (!isset($r['name']))
+					{
+					$r['name'] = $val;
+					unset($array[$key]);
+					}
+				else
+					$array[$key] = $val;
+				$ok = true;
+				}
+			}
+		}
+	}
+if (!isset($r['name']) && count($array)>0)
+	{
+	$r['name'] = array_shift($array);
+	}
+if ($has_org && count($array)>0)
+	{
+	$r['organization'] = array_shift($array);
+	}
+if (isset($r['name']) && is_array($r['name']))
+	{
+	$r['name'] = implode($r['name'],' ');
+	}
+if (!empty($array))
+	{
+	if (isset($r['address']))
+		$r['address'] = array_merge($r['address'],$array);
+	else
+		$r['address'] = $array;
+	}
+return $r;
+}
+function format_dates (&$res,$format='mdy')
+{
+if (!is_array($res)) return $res;
+foreach ($res as $key => $val)
+	{
+	if (is_array($val))
+		{
+		if (!is_numeric($key) && ($key=='expires' || $key=='created' || $key=='changed'))
+			{
+			$d = get_date($val[0],$format);
+			if ($d) $res[$key] = $d;
+			}
+		else
+			{
+			$res[$key] = format_dates($val,$format);
+			}
+		}
+	else
+		{
+		if (!is_numeric($key) && ($key=='expires' || $key=='created' || $key=='changed'))
+			{
+			$d = get_date($val,$format);
+			if ($d) $res[$key] = $d;
+			}
+		}
+	}
+return $res;
+}
+function get_date($date,$format)
+{
+$months = array( 'jan'=>1,  'ene'=>1,  'feb'=>2,  'mar'=>3, 'apr'=>4, 'abr'=>4,
+                 'may'=>5,  'jun'=>6,  'jul'=>7,  'aug'=>8, 'ago'=>8, 'sep'=>9,
+                 'oct'=>10, 'nov'=>11, 'dec'=>12, 'dic'=>12 );
+$parts = explode(' ',$date);
+if (strpos($parts[0],'@') !== false)
+	{
+	unset($parts[0]);
+	$date = implode(' ',$parts);
+	}
+$date = str_replace(',',' ',trim($date));
+$date = str_replace('.',' ',$date);
+$date = str_replace('-',' ',$date);
+$date = str_replace('/',' ',$date);
+$date = str_replace("\t",' ',$date);
+$parts = explode(' ',$date);
+$res = false;
+if ((strlen($parts[0]) == 8 || count($parts) == 1) && is_numeric($parts[0]))
+	{
+	$val = $parts[0];
+	for ($p=$i=0; $i<3; $i++)
+		{
+		if ($format[$i] != 'Y')
+			{
+			$res[$format[$i]] = substr($val,$p,2);
+			$p += 2;
+			}
+		else
+			{
+			$res['y'] = substr($val,$p,4);
+			$p += 4;
+			}
+		}
+	}
+else
+	{
+	$format = strtolower($format);
+	for ($p=$i=0; $p<count($parts) && $i<strlen($format); $p++)
+		{
+		if (trim($parts[$p]) == '')
+			continue;
+		if ($format[$i] != '-')
+			{
+			$res[$format[$i]] = $parts[$p];
+			}
+		$i++;
+		}
+	}
+if (!$res) return $date;
+$ok = false;
+while (!$ok)
+	{
+	reset($res);
+	$ok = true;
+	while (list($key, $val) = each($res))
+		{
+		if ($val == '' || $key == '') continue;
+		if (!is_numeric($val) && isset($months[substr(strtolower($val),0,3)]))
+			{
+			$res[$key] = $res['m'];
+			$res['m'] = $months[substr(strtolower($val),0,3)];
+			$ok = false;
+			break;
+			}
+		if ($key != 'y' && $key != 'Y' && $val > 1900)
+			{
+			$res[$key] = $res['y'];
+			$res['y'] = $val;
+			$ok = false;
+			break;
+			}
+		}
+	}
+if ($res['m'] > 12)
+	{
+	$v = $res['m'];
+	$res['m'] = $res['d'];
+	$res['d'] = $v;
+	}
+if ($res['y'] < 70)
+	$res['y'] += 2000;
+else
+	if ($res['y'] <= 99)
+		$res['y'] += 1900;
+return sprintf("%.4d-%02d-%02d",$res['y'],$res['m'],$res['d']);
+}
+?>

--- a/src/whois.ph.php
+++ b//dev/null
@@ -1,47 +0,0 @@
-<?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-if (!defined('__PH_HANDLER__')) {
-    define('__PH_HANDLER__', 1);
-}
-require_once('whois.parser.php');
-/**
- * Class ph_handler
- */
-class ph_handler
-{
-    function parse($data_str, $query)
-    {
-        $items = [
-            'created:' => 'domain.created',
-            'changed:' => 'domain.changed',
-            'status:' => 'domain.status',
-            'nserver:' => 'domain.nserver.'
-        ];
-        $r = [
-            'regrinfo' => generic_parser_b($data_str['rawdata'], $items),
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        if (!isset($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo']['domain']['name'] = $query;
-        }
-        return $r;
-    }
-}

--- a/src/whois.pl.php
+++ b/src/whois.pl.php
@@ -1,43 +1,41 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__PL_HANDLER__'))
-    define('__PL_HANDLER__', 1);
+	define('__PL_HANDLER__', 1);
 require_once('whois.parser.php');
-class pl_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domain.created' => 'created:',
-            'domain.changed' => 'last modified:',
-            'domain.sponsor' => 'REGISTRAR:',
-            '#' => 'WHOIS displays data with a delay not exceeding 15 minutes in relation to the .pl Registry system'
-        );
-        $r = array();
-        $r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.dns.pl/english/index.html',
-            'registrar' => 'NASK'
-        );
-        return $r;
-    }
-}
+class pl_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                	'domain.created' => 'created:',
+                	'domain.changed' => 'last modified:',
+                	'domain.sponsor' => 'REGISTRAR:',
+                	'#' => 'WHOIS displays data with a delay not exceeding 15 minutes in relation to the .pl Registry system'
+					);
+		$r['regrinfo'] = easy_parser($data_str['rawdata'], $items, 'ymd');
+		$r['regyinfo'] = array(
+			'referrer' => 'http://www.dns.pl/english/index.html',
+			'registrar' => 'NASK'
+			);
+		return $r;
+		}
+	}
+?>

--- a/src/whois.pro.php
+++ b/src/whois.pro.php
@@ -1,35 +1,33 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 require_once('whois.parser.php');
 if (!defined('__PRO_HANDLER__'))
-    define('__PRO_HANDLER__', 1);
-class pro_handler {
-    function parse($data, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data['rawdata']);
-        $r['regyinfo']['referrer'] = 'http://www.registrypro.pro';
-        $r['regyinfo']['registrar'] = 'RegistryPRO';
-        return $r;
-    }
-}
+	define('__PRO_HANDLER__', 1);
+class pro_handler
+	{
+	function parse($data, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data['rawdata']);
+		$r['regyinfo']['referrer'] = 'http://www.registrypro.pro';
+		$r['regyinfo']['registrar'] = 'RegistryPRO';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.pt.php
+++ b/src/whois.pt.php
@@ -28,22 +28,22 @@
 	{
 	function parse($data, $query)
 		{
 		$items = array(
 					'domain.name' 		=> ' / Domain Name:',
 					'domain.created' 	=> 'Data de registo / Creation Date (dd/mm/yyyy):',
 					'domain.nserver.' 	=> 'Nameserver:',
 					'domain.status'	 	=> 'Estado / Status:',
 					'owner'				=> 'Titular / Registrant',
 					'billing'			=> 'Entidade Gestora / Billing Contact',
-					'admin'				=> 'Responsável Administrativo / Admin Contact',
-					'tech'				=> 'Responsável Técnico / Tech Contact',
+					'admin'				=> 'Respons�vel Administrativo / Admin Contact',
+					'tech'				=> 'Respons�vel T�cnico / Tech Contact',
 					'#'					=> 'Nameserver Information'
 					);
 		$r['regrinfo'] = get_blocks($data['rawdata'], $items);
 		if (empty($r['regrinfo']['domain']['name']))
 			{
 			print_r($r['regrinfo']);
 			$r['regrinfo']['registered'] = 'no';
 			return $r;
 			}
 		$r['regrinfo']['domain']['created'] = get_date($r['regrinfo']['domain']['created'], 'dmy');

--- a/src/whois.ro.php
+++ b/src/whois.ro.php
@@ -1,78 +1,80 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
+/*
+BUG
+- date on ro could be given as "mail date" (ex: updated field)
+- multiple person for one role, ex: news.ro
+- seems the only role listed is registrant
+*/
 if (!defined('__RO_HANDLER__'))
-    define('__RO_HANDLER__', 1);
+	define('__RO_HANDLER__', 1);
 require_once('whois.parser.php');
-/**
- * @TODO BUG
- * - date on ro could be given as "mail date" (ex: updated field)
- * - multiple person for one role, ex: news.ro
- * - seems the only role listed is registrant
- */
-class ro_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'fax-no' => 'fax',
-            'e-mail' => 'email',
-            'nic-hdl' => 'handle',
-            'person' => 'name',
-            'address' => 'address.',
-            'domain-name' => '',
-            'updated' => 'changed',
-            'registration-date' => 'created',
-            'domain-status' => 'status',
-            'nameserver' => 'nserver'
-        );
-        $contacts = array(
-            'admin-contact' => 'admin',
-            'technical-contact' => 'tech',
-            'zone-contact' => 'zone',
-            'billing-contact' => 'billing'
-        );
-        $extra = array(
-            'postal code:' => 'address.pcode'
-        );
-        $reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
-        if (isset($reg['domain']['description'])) {
-            $reg['owner'] = get_contact($reg['domain']['description'], $extra);
-            unset($reg['domain']['description']);
-            foreach ($reg as $key => $item) {
-                if (isset($item['address'])) {
-                    $data = $item['address'];
-                    unset($reg[$key]['address']);
-                    $reg[$key] = array_merge($reg[$key], get_contact($data, $extra));
-                }
-            }
-            $reg['registered'] = 'yes';
-        } else
-            $reg['registered'] = 'no';
-        $r = array();
-        $r['regrinfo'] = $reg;
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.nic.ro',
-            'registrar' => 'nic.ro'
-        );
-        return $r;
-    }
-}
+class ro_handler
+	{
+	function parse($data_str, $query)
+		{
+		$translate = array(
+						'fax-no' => 'fax',
+						'e-mail' => 'email',
+						'nic-hdl' => 'handle',
+						'person' => 'name',
+						'address' => 'address.',
+						'domain-name'	=> '',
+						'updated' => 'changed',
+						'registration-date' => 'created',
+						'domain-status'	=> 'status',
+						'nameserver' => 'nserver'
+		                  );
+		$contacts = array(
+						'admin-contact' 	=> 'admin',
+						'technical-contact'	=> 'tech',
+						'zone-contact' 		=> 'zone',
+						'billing-contact' 		=> 'billing'
+		                  );
+		$extra = array(
+						'postal code:' => 'address.pcode'
+						);
+		$reg = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain','Ymd');
+		if (isset($reg['domain']['description']))
+			{
+			$reg['owner'] = get_contact($reg['domain']['description'],$extra);
+			unset($reg['domain']['description']);
+			foreach($reg as $key => $item)
+				{
+				if (isset($item['address']))
+					{
+					$data = $item['address'];
+					unset($reg[$key]['address']);
+					$reg[$key] = array_merge($reg[$key],get_contact($data,$extra));
+					}
+				}
+			$reg['registered'] = 'yes';
+			}
+		else
+			$reg['registered'] = 'no';
+		$r['regrinfo'] = $reg;
+		$r['regyinfo'] = array(
+                          'referrer' => 'http://www.nic.ro',
+                          'registrar' => 'nic.ro'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.ru.php
+++ b/src/whois.ru.php
@@ -1,53 +1,51 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__RU_HANDLER__'))
-    define('__RU_HANDLER__', 1);
+	define('__RU_HANDLER__', 1);
 require_once('whois.parser.php');
-class ru_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domain:' => 'domain.name',
-            'registrar:' => 'domain.sponsor',
-            'state:' => 'domain.status',
-            'nserver:' => 'domain.nserver.',
-            'source:' => 'domain.source',
-            'created:' => 'domain.created',
-            'paid-till:' => 'domain.expires',
-            'type:' => 'owner.type',
-            'org:' => 'owner.organization',
-            'phone:' => 'owner.phone',
-            'fax-no:' => 'owner.fax',
-            'e-mail:' => 'owner.email'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
-        if (empty($r['regrinfo']['domain']['status']))
-            $r['regrinfo']['registered'] = 'no';
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.ripn.net',
-            'registrar' => 'RU-CENTER-REG-RIPN'
-        );
-        return $r;
-    }
-}
+class ru_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'domain:' => 'domain.name',
+                  'registrar:' => 'domain.sponsor',
+                  'state:' => 'domain.status',
+                  'nserver:' => 'domain.nserver.',
+                  'source:' => 'domain.source',
+                  'created:' => 'domain.created',
+                  'paid-till:' => 'domain.expires',
+                  'type:' => 'owner.type',
+                  'org:' => 'owner.organization',
+                  'phone:' => 'owner.phone',
+                  'fax-no:' => 'owner.fax',
+                  'e-mail:' => 'owner.email'
+		              );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
+		if (empty($r['regrinfo']['domain']['status']))
+			$r['regrinfo']['registered'] = 'no';
+		$r['regyinfo'] = array(
+                            'referrer' => 'http://www.ripn.net',
+                            'registrar' => 'RU-CENTER-REG-RIPN'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.rwhois.php
+++ b/src/whois.rwhois.php
@@ -1,49 +1,47 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__RWHOIS_HANDLER__'))
-    define('__RWHOIS_HANDLER__', 1);
+	define('__RWHOIS_HANDLER__', 1);
 require_once('whois.parser.php');
-class rwhois_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'network:Organization-Name:' => 'owner.name',
-            'network:Organization;I:' => 'owner.organization',
-            'network:Organization-City:' => 'owner.address.city',
-            'network:Organization-Zip:' => 'owner.address.pcode',
-            'network:Organization-Country:' => 'owner.address.country',
-            'network:IP-Network-Block:' => 'network.inetnum',
-            'network:IP-Network:' => 'network.inetnum',
-            'network:Network-Name:' => 'network.name',
-            'network:ID:' => 'network.handle',
-            'network:Created:' => 'network.created',
-            'network:Updated:' => 'network.changed',
-            'network:Tech-Contact;I:' => 'tech.email',
-            'network:Admin-Contact;I:' => 'admin.email'
-        );
-        $res = generic_parser_b($data_str, $items, 'Ymd', false);
-        if (isset($res['disclaimer']))
-            unset($res['disclaimer']);
-        return array('regrinfo' => $res);
-    }
-}
+class rwhois_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+						'network:Organization-Name:' => 'owner.name',
+						'network:Organization;I:' => 'owner.organization',
+						'network:Organization-City:' => 'owner.address.city',
+						'network:Organization-Zip:' => 'owner.address.pcode',
+						'network:Organization-Country:' => 'owner.address.country',
+						'network:IP-Network-Block:' => 'network.inetnum',
+						'network:IP-Network:' => 'network.inetnum',
+						'network:Network-Name:' => 'network.name',
+						'network:ID:' => 'network.handle',
+						'network:Created:' => 'network.created',
+						'network:Updated:' => 'network.changed',
+						'network:Tech-Contact;I:' => 'tech.email',
+						'network:Admin-Contact;I:' => 'admin.email'
+						);
+		$res = generic_parser_b($data_str, $items, 'Ymd', false);
+		if (isset($res['disclaimer'])) unset($res['disclaimer']);
+		return array( 'regrinfo' => $res );
+		}
+	}
+?>

--- a/src/whois.sc.php
+++ b/src/whois.sc.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__SC_HANDLER__'))
-    define('__SC_HANDLER__', 1);
+	define('__SC_HANDLER__', 1);
 require_once('whois.parser.php');
-class sc_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], array(), 'dmy');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.nic.sc',
-            'registrar' => 'VCS (Pty) Limited'
-        );
-        return $r;
-    }
-}
+class sc_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, 'dmy');
+		$r['regyinfo'] = array(
+                  'referrer' => 'http://www.nic.sc',
+                  'registrar' => 'VCS (Pty) Limited'
+                  );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.se.php
+++ b/src/whois.se.php
@@ -1,51 +1,45 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
-if (!defined('__SE_HANDLER__')) {
-    define('__SE_HANDLER__', 1);
-}
+if (!defined('__SE_HANDLER__'))
+	define('__SE_HANDLER__', 1);
 require_once('whois.parser.php');
-class se_handler {
-    function parse($data_str, $query) {
-        $items = [
-            'domain:' => 'domain.name',
-            'state:' => 'domain.status.',
-            'status:' => 'domain.status.',
-            'expires:' => 'domain.expires',
-            'created:' => 'domain.created',
-            'modified:' => 'domain.changed',
-            'nserver:' => 'domain.nserver.',
-            'registrar:' => 'domain.sponsor',
-            'holder:' => 'owner.handle',
-        ];
-        $r = [];
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd', false);
-        $r['regrinfo']['registered'] = isset($r['regrinfo']['domain']['name']) ? 'yes' : 'no';
-        $r['regyinfo'] = [
-            'referrer' => 'http://www.nic-se.se',
-            'registrar' => 'NIC-SE'
-        ];
-        $r['rawdata'] = $data_str['rawdata'];
-        return $r;
-    }
-}
+class se_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                    'domain' => 'domain.name',
+                    'state:' => 'domain.status.',
+                    'status:' => 'domain.status.',
+                    'expires:' => 'domain.expires',
+                    'created:' => 'domain.created',
+                    'nserver:' => 'domain.nserver.',
+                    'holder:' => 'owner.handle'
+                    );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd', false);
+		$r['regrinfo']['registered'] = isset($r['regrinfo']['domain']['name']) ? 'yes' : 'no';
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.nic-se.se',
+                    'registrar' => 'NIC-SE'
+		                );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.servers.php
+++ b/src/whois.servers.php
@@ -1,643 +1,233 @@
 <?php
-/**
- * Whois servers list
- * 
- * This class supposed to be instantiated for using the phpWhois library
- * 
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-return array(
-'DATA' => array(
-    'bz'       => 'gtld',
-    'com'      => 'gtld',
-    'jobs'     => 'gtld',
-    'li'       => 'ch',
-    'net'      => 'gtld',
-    'su'       => 'ru',
-    'tv'       => 'gtld',
-    'za.org'   => 'zanet',
-    'za.net'   => 'zanet',
-    'xn--p1ai' => 'ru',
-),
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+/* servers.whois	v18   Markus Welters	2004/06/25 */
+/* servers.whois	v17	ross golder	2003/02/09 */
+/* servers.whois	v16	mark jeftovic	2001/02/28 */
+$this->DATA_VERSION = '19';
+$this->DATA = array(
+	'bz'		=> 'gtld',
+	'com'		=> 'gtld',
+	'jobs'		=> 'gtld',
+	'li'		=> 'ch',
+	'net'		=> 'gtld',
+	'su'		=> 'ru',
+	'tv'		=> 'gtld',
+	'za.org'	=> 'zanet',
+	'za.net'	=> 'zanet',
+	'xn--p1ai' => 'ru'
+	);
 /* Non UTF-8 servers */
-'NON_UTF8' => array(
-    'br.whois-servers.net'  => 1,
-    'ca.whois-servers.net'  => 1,
-    'cl.whois-servers.net'  => 1,
-    'hu.whois-servers.net'  => 1,
-    'is.whois-servers.net'  => 1,
-    'pt.whois-servers.net'  => 1,
-    'whois.interdomain.net' => 1,
-    'whois.lacnic.net'      => 1,
-    'whois.nicline.com'     => 1,
-    'whois.ripe.net'        => 1,
-),
+$this->NON_UTF8 = array(
+	'br.whois-servers.net' => 1,
+	'ca.whois-servers.net' => 1,
+	'cl.whois-servers.net' => 1,
+	'hu.whois-servers.net' => 1,
+	'is.whois-servers.net' => 1,
+	'pt.whois-servers.net' => 1,
+	'whois.interdomain.net' => 1,
+	'whois.lacnic.net' => 1,
+	'whois.nicline.com' => 1,
+	'whois.ripe.net' => 1
+	);
 /* If whois Server needs any parameters, enter it here */
-'WHOIS_PARAM' => array(
-    'com.whois-servers.net' => 'domain =$domain',
-    'net.whois-servers.net' => 'domain =$domain',
-    'de.whois-servers.net'  => '-T dn,ace $domain',
-    'jp.whois-servers.net'  => 'DOM $domain/e',
-    'whois.denic.de'        => '-T dn,ace $domain.$tld',
-    'whois.dk-hostmaster.dk' => '--show-handles --charset=utf8 $domain.$tld',
-),
+$this->WHOIS_PARAM = array(
+	'com.whois-servers.net' => 'domain =$',
+	'net.whois-servers.net' => 'domain =$',
+	'de.whois-servers.net'	=> '-T dn,ace $',
+	'jp.whois-servers.net'	=> 'DOM $/e'
+	);
 /* TLD's that have special whois servers or that can only be reached via HTTP */
-'WHOIS_SPECIAL' => array(
-    'ac'                     => 'whois.nic.ac',
-    'academy'                => 'whois.donuts.co',
-    'accountants'            => 'whois.donuts.co',
-    'active'                 => 'whois.afilias-srs.net',
-    'actor'                  => 'whois.unitedtld.com',
-    'ad'                     => '',
-    'ae'                     => 'whois.aeda.net.ae',
-    'aero'                   => 'whois.aero',
-    'af'                     => 'whois.nic.af',
-    'ag'                     => 'whois.nic.ag',
-    'agency'                 => 'whois.donuts.co',
-    'ai'                     => 'whois.ai',
-    'airforce'               => 'whois.unitedtld.com',
-    'al'                     => '',
-    'am'                     => 'whois.amnic.net',
-    'app'                    => 'whois.nic.google',
-    'archi'                  => 'whois.ksregistry.net',
-    'army'                   => 'whois.rightside.co',
-    'arpa'                   => 'whois.iana.org',
-    'as'                     => 'whois.nic.as',
-    'asia'                   => 'whois.nic.asia',
-    'associates'             => 'whois.donuts.co',
-    'at'                     => 'whois.nic.at',
-    'attorney'               => 'whois.rightside.co',
-    'au'                     => 'whois.audns.net.au',
-    'auction'                => 'whois.donuts.co',
-    'audio'                  => 'whois.uniregistry.net',
-    'autos'                  => 'whois.afilias-srs.net',
-    'aw'                     => 'whois.nic.aw',
-    'ax'                     => 'whois.ax',
-    'az'                     => '',
-    'ba'                     => '',
-    'bar'                    => 'whois.nic.bar',
-    'bargains'               => 'whois.donuts.co',
-    'bayern'                 => 'whois-dub.mm-registry.com',
-    'bb'                     => 'http://domains.org.bb/regsearch/getdetails.cfm?DND={domain}.bb',
-    'be'                     => 'whois.dns.be',
-    'beer'                   => 'whois-dub.mm-registry.com',
-    'berlin'                 => 'whois.nic.berlin',
-    'best'                   => 'whois.nic.best',
-    'bg'                     => 'whois.register.bg',
-    'bh'                     => 'whois.nic.bh',
-    'bi'                     => 'whois1.nic.bi',
-    'bid'                    => 'whois.nic.bid',
-    'bike'                   => 'whois.donuts.co',
-    'bio'                    => 'whois.ksregistry.net',
-    'biz'                    => 'whois.biz',
-    'bj'                     => 'whois.nic.bj',
-    'black'                  => 'whois.afilias.net',
-    'blackfriday'            => 'whois.uniregistry.net',
-    'blue'                   => 'whois.afilias.net',
-    'bmw'                    => 'whois.ksregistry.net',
-    'bn'                     => 'whois.bn',
-    'bo'                     => 'whois.nic.bo',
-    'boutique'               => 'whois.donuts.co',
-    'br'                     => 'whois.registro.br',
-    'brussels'               => 'whois.nic.brussels',
-    'build'                  => 'whois.nic.build',
-    'builders'               => 'whois.donuts.co',
-    'buzz'                   => 'whois.nic.buzz',
-    'bw'                     => 'whois.nic.net.bw',
-    'by'                     => 'whois.cctld.by',
-    'bzh'                    => 'whois-bzh.nic.fr',
-    'ca'                     => 'whois.cira.ca',
-    'cab'                    => 'whois.donuts.co',
-    'camera'                 => 'whois.donuts.co',
-    'camp'                   => 'whois.donuts.co',
-    'cancerresearch'         => 'whois.nic.cancerresearch',
-    'capetown'               => 'capetown-whois.registry.net.za',
-    'capital'                => 'whois.donuts.co',
-    'cards'                  => 'whois.donuts.co',
-    'care'                   => 'whois.donuts.co',
-    'career'                 => 'whois.nic.career',
-    'careers'                => 'whois.donuts.co',
-    'cash'                   => 'whois.donuts.co',
-    'cat'                    => 'whois.cat',
-    'catering'               => 'whois.donuts.co',
-    'cc'                     => 'ccwhois.verisign-grs.com',
-    'center'                 => 'whois.donuts.co',
-    'ceo'                    => 'whois.nic.ceo',
-    'cf'                     => 'whois.dot.cf',
-    'ch'                     => 'whois.nic.ch',
-    'cheap'                  => 'whois.donuts.co',
-    'christmas'              => 'whois.uniregistry.net',
-    'church'                 => 'whois.donuts.co',
-    'ci'                     => 'whois.nic.ci',
-    'city'                   => 'whois.donuts.co',
-    'cl'                     => 'whois.nic.cl',
-    'claims'                 => 'whois.donuts.co',
-    'cleaning'               => 'whois.donuts.co',
-    'clinic'                 => 'whois.donuts.co',
-    'clothing'               => 'whois.donuts.co',
-    'club'                   => 'whois.nic.club',
-    'cn'                     => 'whois.cnnic.cn',
-    'co'                     => 'whois.nic.co',
-    'codes'                  => 'whois.donuts.co',
-    'coffee'                 => 'whois.donuts.co',
-    'college'                => 'whois.centralnic.com',
-    'cologne'                => 'whois-fe1.pdt.cologne.tango.knipp.de',
-    'community'              => 'whois.donuts.co',
-    'company'                => 'whois.donuts.co',
-    'computer'               => 'whois.donuts.co',
-    'condos'                 => 'whois.donuts.co',
-    'construction'           => 'whois.donuts.co',
-    'consulting'             => 'whois.unitedtld.com',
-    'contractors'            => 'whois.donuts.co',
-    'cooking'                => 'whois-dub.mm-registry.com',
-    'cool'                   => 'whois.donuts.co',
-    'coop'                   => 'whois.nic.coop',
-    'country'                => 'whois-dub.mm-registry.com',
-    'credit'                 => 'whois.donuts.co',
-    'creditcard'             => 'whois.donuts.co',
-    'cruises'                => 'whois.donuts.co',
-    'cuisinella'             => 'whois.nic.cuisinella',
-    'cx'                     => 'whois.nic.cx',
-    'cy'                     => '',
-    'cz'                     => 'whois.nic.cz',
-    'dance'                  => 'whois.unitedtld.com',
-    'dating'                 => 'whois.donuts.co',
-    'de'                     => 'whois.denic.de',
-    'deals'                  => 'whois.donuts.co',
-    'degree'                 => 'whois.rightside.co',
-    'democrat'               => 'whois.unitedtld.com',
-    'dental'                 => 'whois.donuts.co',
-    'dentist'                => 'whois.rightside.co',
-    'desi'                   => 'whois.ksregistry.net',
-    'dev'                    => 'whois.nic.google',
-    'diamonds'               => 'whois.donuts.co',
-    'digital'                => 'whois.donuts.co',
-    'direct'                 => 'whois.donuts.co',
-    'directory'              => 'whois.donuts.co',
-    'discount'               => 'whois.donuts.co',
-    'dk'                     => 'whois.dk-hostmaster.dk',
-    'dm'                     => 'whois.nic.dm',
-    'domains'                => 'whois.donuts.co',
-    'durban'                 => 'durban-whois.registry.net.za',
-    'dz'                     => 'whois.nic.dz',
-    'ec'                     => 'whois.nic.ec',
-    'edu'                    => 'whois.educause.edu',
-    'education'              => 'whois.donuts.co',
-    'ee'                     => 'whois.tld.ee',
-    'email'                  => 'whois.donuts.co',
-    'engineer'               => 'whois.rightside.co',
-    'engineering'            => 'whois.donuts.co',
-    'enterprises'            => 'whois.donuts.co',
-    'equipment'              => 'whois.donuts.co',
-    'es'                     => 'whois.nic.es',
-    'estate'                 => 'whois.donuts.co',
-    'eu'                     => 'whois.eu',
-    'eus'                    => 'whois.eus.coreregistry.net',
-    'events'                 => 'whois.donuts.co',
-    'exchange'               => 'whois.donuts.co',
-    'expert'                 => 'whois.donuts.co',
-    'exposed'                => 'whois.donuts.co',
-    'fail'                   => 'whois.donuts.co',
-    'farm'                   => 'whois.donuts.co',
-    'feedback'               => 'whois.centralnic.com',
-    'fi'                     => 'whois.fi',
-    'finance'                => 'whois.donuts.co',
-    'financial'              => 'whois.donuts.co',
-    'fish'                   => 'whois.donuts.co',
-    'fishing'                => 'whois-dub.mm-registry.com',
-    'fitness'                => 'whois.donuts.co',
-    'fj'                     => 'whois.usp.ac.fj',
-    'flights'                => 'whois.donuts.co',
-    'florist'                => 'whois.donuts.co',
-    'fm'                     => 'http://www.dot.fm/query_whois.cfm?domain={domain}&tld=fm',
-    'fo'                     => 'whois.nic.fo',
-    'foo'                    => 'domain-registry-whois.l.google.com',
-    'foundation'             => 'whois.donuts.co',
-    'fr'                     => 'whois.nic.fr',
-    'frogans'                => 'whois-frogans.nic.fr',
-    'fund'                   => 'whois.donuts.co',
-    'furniture'              => 'whois.donuts.co',
-    'futbol'                 => 'whois.unitedtld.com',
-    'gal'                    => 'whois.gal.coreregistry.net',
-    'gallery'                => 'whois.donuts.co',
-    'gd'                     => 'whois.nic.gd',
-    'gent'                   => 'whois.nic.gent',
-    'gg'                     => 'whois.gg',
-    'gi'                     => 'whois2.afilias-grs.net',
-    'gift'                   => 'whois.uniregistry.net',
-    'gives'                  => 'whois.rightside.co',
-    'gl'                     => 'whois.nic.gl',
-    'glass'                  => 'whois.donuts.co',
-    'global'                 => 'whois.afilias-srs.net',
-    'globo'                  => 'whois.gtlds.nic.br',
-    'gop'                    => 'whois-cl01.mm-registry.com',
-    'gov'                    => 'whois.dotgov.gov',
-    'gr'                     => '',
-    'graphics'               => 'whois.donuts.co',
-    'gratis'                 => 'whois.donuts.co',
-    'green'                  => 'whois.afilias.net',
-    'gripe'                  => 'whois.donuts.co',
-    'gs'                     => 'whois.nic.gs',
-    'gt'                     => 'http://www.gt/Inscripcion/whois.php?domain={domain}.gt',
-    'guide'                  => 'whois.donuts.co',
-    'guitars'                => 'whois.uniregistry.net',
-    'guru'                   => 'whois.donuts.co',
-    'gy'                     => 'whois.registry.gy',
-    'hamburg'                => 'whois.nic.hamburg',
-    'haus'                   => 'whois.unitedtld.com',
-    'hiphop'                 => 'whois.uniregistry.net',
-    'hiv'                    => 'whois.afilias-srs.net',
-    'hk'                     => 'whois.hkirc.hk',
-    'hn'                     => 'whois.nic.hn',
-    'holdings'               => 'whois.donuts.co',
-    'holiday'                => 'whois.donuts.co',
-    'homes'                  => 'whois.afilias-srs.net',
-    'horse'                  => 'whois-dub.mm-registry.com',
-    'host'                   => 'whois.centralnic.com',
-    'house'                  => 'whois.donuts.co',
-    'hr'                     => 'whois.dns.hr',
-    'ht'                     => 'whois.nic.ht',
-    'hu'                     => 'whois.nic.hu',
-    'id'                     => 'whois.pandi.or.id',
-    'ie'                     => 'whois.domainregistry.ie',
-    'il'                     => 'whois.isoc.org.il',
-    'im'                     => 'whois.nic.im',
-    'immobilien'             => 'whois.unitedtld.com',
-    'in'                     => 'whois.inregistry.net',
-    'industries'             => 'whois.donuts.co',
-    'info'                   => 'whois.afilias.net',
-    'ink'                    => 'whois.centralnic.com',
-    'institute'              => 'whois.donuts.co',
-    'insure'                 => 'whois.donuts.co',
-    'int'                    => 'whois.iana.org',
-    'international'          => 'whois.donuts.co',
-    'investments'            => 'whois.donuts.co',
-    'io'                     => 'whois.nic.io',
-    'iq'                     => 'whois.cmc.iq',
-    'ir'                     => 'whois.nic.ir',
-    'is'                     => 'whois.isnic.is',
-    'it'                     => 'whois.nic.it',
-    'je'                     => 'whois.je',
-    'jetzt'                  => 'whois.nic.jetzt',
-    'joburg'                 => 'joburg-whois.registry.net.za',
-    'jp'                     => 'whois.jprs.jp',
-    'juegos'                 => 'whois.uniregistry.net',
-    'kaufen'                 => 'whois.unitedtld.com',
-    'ke'                     => 'whois.kenic.or.ke',
-    'kg'                     => 'whois.domain.kg',
-    'ki'                     => 'whois.nic.ki',
-    'kim'                    => 'whois.afilias.net',
-    'kitchen'                => 'whois.donuts.co',
-    'kiwi'                   => 'whois.dot-kiwi.com',
-    'koeln'                  => 'whois-fe1.pdt.koeln.tango.knipp.de',
-    'kr'                     => 'whois.kr',
-    'krd'                    => 'whois.aridnrs.net.au',
-    'kred'                   => 'whois.nic.kred',
-    'kz'                     => 'whois.nic.kz',
-    'la'                     => 'whois.nic.la',
-    'lacaixa'                => 'whois.nic.lacaixa',
-    'land'                   => 'whois.donuts.co',
-    'lawyer'                 => 'whois.rightside.co',
-    'lease'                  => 'whois.donuts.co',
-    'lgbt'                   => 'whois.afilias.net',
-    'life'                   => 'whois.donuts.co',
-    'lighting'               => 'whois.donuts.co',
-    'limited'                => 'whois.donuts.co',
-    'limo'                   => 'whois.donuts.co',
-    'link'                   => 'whois.uniregistry.net',
-    'loans'                  => 'whois.donuts.co',
-    'london'                 => 'whois.nic.london',
-    'lotto'                  => 'whois.afilias.net',
-    'lt'                     => 'whois.domreg.lt',
-    'lu'                     => 'whois.dns.lu',
-    'luxe'                   => 'whois-dub.mm-registry.com',
-    'luxury'                 => 'whois.nic.luxury',
-    'lv'                     => 'whois.nic.lv',
-    'ly'                     => 'whois.nic.ly',
-    'ma'                     => 'whois.iam.net.ma',
-    'maison'                 => 'whois.donuts.co',
-    'management'             => 'whois.donuts.co',
-    'mango'                  => 'whois.mango.coreregistry.net',
-    'market'                 => 'whois.rightside.co',
-    'marketing'              => 'whois.donuts.co',
-    'md'                     => 'whois.nic.md',
-    'me'                     => 'whois.nic.me',
-    'media'                  => 'whois.donuts.co',
-    'meet'                   => 'whois.afilias.net',
-    'melbourne'              => 'whois.aridnrs.net.au',
-    'menu'                   => 'whois.nic.menu',
-    'mg'                     => 'whois.nic.mg',
-    'miami'                  => 'whois-dub.mm-registry.com',
-    'mini'                   => 'whois.ksregistry.net',
-    'mk'                     => 'whois.marnet.mk',
-    'ml'                     => 'whois.dot.ml',
-    'mn'                     => 'whois.nic.mn',
-    'mo'                     => 'whois.monic.mo',
-    'mobi'                   => 'whois.dotmobiregistry.net',
-    'moda'                   => 'whois.unitedtld.com',
-    'monash'                 => 'whois.nic.monash',
-    'mortgage'               => 'whois.rightside.co',
-    'moscow'                 => 'whois.nic.moscow',
-    'motorcycles'            => 'whois.afilias-srs.net',
-    'mp'                     => 'whois.nic.mp',
-    'ms'                     => 'whois.nic.ms',
-    'mt'                     => 'http://www.um.edu.mt/cgi-bin/nic/whois?domain={domain}.mt',
-    'mu'                     => 'whois.nic.mu',
-    'museum'                 => 'whois.museum',
-    'mx'                     => 'whois.mx',
-    'my'                     => 'whois.mynic.my',
-    'na'                     => 'whois.na-nic.com.na',
-    'nagoya'                 => 'whois.gmoregistry.net',
-    'name'                   => 'whois.nic.name',
-    'navy'                   => 'whois.rightside.co',
-    'nc'                     => 'whois.nc',
-    'nf'                     => 'whois.nic.nf',
-    'ng'                     => 'whois.nic.net.ng',
-    'ngo'                    => 'whois.publicinterestregistry.net',
-    'ninja'                  => 'whois.unitedtld.com',
-    'nl'                     => 'whois.domain-registry.nl',
-    'no'                     => 'whois.norid.no',
-    'nra'                    => 'whois.afilias-srs.net',
-    'nrw'                    => 'whois-fe1.pdt.nrw.tango.knipp.de',
-    'nu'                     => 'whois.iis.nu',
-    'nyc'                    => 'whois.nic.nyc',
-    'nz'                     => 'whois.srs.net.nz',
-    'okinawa'                => 'whois.gmoregistry.ne',
-    'om'                     => 'whois.registry.om',
-    'onl'                    => 'whois.afilias-srs.net',
-    'org'                    => 'whois.pir.org',
-    'organic'                => 'whois.afilias.net',
-    'ovh'                    => 'whois-ovh.nic.fr',
-    'paris'                  => 'whois-paris.nic.fr',
-    'partners'               => 'whois.donuts.co',
-    'parts'                  => 'whois.donuts.co',
-    'pe'                     => 'kero.yachay.pe',
-    'pf'                     => 'whois.registry.pf',
-    'photo'                  => 'whois.uniregistry.net',
-    'photography'            => 'whois.donuts.co',
-    'photos'                 => 'whois.donuts.co',
-    'ph'                     => 'whois.iana.org',
-    'physio'                 => 'whois.nic.physio',
-    'pics'                   => 'whois.uniregistry.net',
-    'pictures'               => 'whois.donuts.co',
-    'pink'                   => 'whois.afilias.net',
-    'pl'                     => 'whois.dns.pl',
-    'place'                  => 'whois.donuts.co',
-    'plumbing'               => 'whois.donuts.co',
-    'pm'                     => 'whois.nic.pm',
-    'post'                   => 'whois.dotpostregistry.net',
-    'pr'                     => 'whois.nic.pr',
-    'press'                  => 'whois.centralnic.com',
-    'pro'                    => 'whois.dotproregistry.net',
-    'productions'            => 'whois.donuts.co',
-    'properties'             => 'whois.donuts.co',
-    'pt'                     => 'whois.dns.pt',
-    'pub'                    => 'whois.unitedtld.com',
-    'pw'                     => 'whois.nic.pw',
-    'qa'                     => 'whois.registry.qa',
-    'qpon'                   => 'whois.nic.qpon',
-    'quebec'                 => 'whois.quebec.rs.corenic.net',
-    're'                     => 'whois.nic.re',
-    'recipes'                => 'whois.donuts.co',
-    'red'                    => 'whois.afilias.net',
-    'rehab'                  => 'whois.rightside.co',
-    'reise'                  => 'whois.nic.reise',
-    'reisen'                 => 'whois.donuts.co',
-    'rentals'                => 'whois.donuts.co',
-    'repair'                 => 'whois.donuts.co',
-    'report'                 => 'whois.donuts.co',
-    'republican'             => 'whois.rightside.co',
-    'rest'                   => 'whois.centralnic.com',
-    'reviews'                => 'whois.unitedtld.com',
-    'rich'                   => 'whois.afilias-srs.net',
-    'rio'                    => 'whois.gtlds.nic.br',
-    'ro'                     => 'whois.rotld.ro',
-    'rocks'                  => 'whois.unitedtld.com',
-    'rodeo'                  => 'whois-dub.mm-registry.com',
-    'rs'                     => 'whois.rnids.rs',
-    'ru'                     => 'whois.tcinet.ru',
-    'ruhr'                   => 'whois.nic.ruhr',
-    'sa'                     => 'whois.nic.net.sa',
-    'saarland'               => 'whois.ksregistry.net',
-    'sb'                     => 'whois.nic.net.sb',
-    'sc'                     => 'whois2.afilias-grs.net',
-    'scb'                    => 'whois.nic.scb',
-    'schmidt'                => 'whois.nic.schmidt',
-    'schule'                 => 'whois.donuts.co',
-    'scot'                   => 'whois.scot.coreregistry.net',
-    'se'                     => 'whois.iis.se',
-    'services'               => 'whois.donuts.co',
-    'sexy'                   => 'whois.uniregistry.net',
-    'sg'                     => 'whois.sgnic.sg',
-    'sh'                     => 'whois.nic.sh',
-    'shiksha'                => 'whois.afilias.net',
-    'shoes'                  => 'whois.donuts.co',
-    'si'                     => 'whois.arnes.si',
-    'singles'                => 'whois.donuts.co',
-    'sk'                     => 'whois.sk-nic.sk',
-    'sm'                     => 'whois.nic.sm',
-    'sn'                     => 'whois.nic.sn',
-    'so'                     => 'whois.nic.so',
-    'social'                 => 'whois.unitedtld.com',
-    'software'               => 'whois.rightside.co',
-    'sohu'                   => 'whois.gtld.knet.cn',
-    'solar'                  => 'whois.donuts.co',
-    'solutions'              => 'whois.donuts.co',
-    'soy'                    => 'domain-registry-whois.l.google.com',
-    'space'                  => 'whois.nic.space',
-    'spiegel'                => 'whois.ksregistry.net',
-    'st'                     => 'whois.nic.st',
-    'su'                     => 'whois.tcinet.ru',
-    'supplies'               => 'whois.donuts.co',
-    'supply'                 => 'whois.donuts.co',
-    'support'                => 'whois.donuts.co',
-    'surf'                   => 'whois-dub.mm-registry.com',
-    'surgery'                => 'whois.donuts.co',
-    'sx'                     => 'whois.sx',
-    'sy'                     => 'whois.tld.sy',
-    'systems'                => 'whois.donuts.co',
-    'tattoo'                 => 'whois.uniregistry.net',
-    'tax'                    => 'whois.donuts.co',
-    'tc'                     => 'whois.meridiantld.net',
-    'technology'             => 'whois.donuts.co',
-    'tel'                    => 'whois.nic.tel',
-    'tf'                     => 'whois.nic.tf',
-    'th'                     => 'whois.thnic.co.th',
-    'tienda'                 => 'whois.donuts.co',
-    'tips'                   => 'whois.donuts.co',
-    'tirol'                  => 'whois.nic.tirol',
-    'tk'                     => 'whois.dot.tk',
-    'tl'                     => 'whois.nic.tl',
-    'tm'                     => 'whois.nic.tm',
-    'tn'                     => 'whois.ati.tn',
-    'to'                     => 'whois.tonic.to',
-    'today'                  => 'whois.donuts.co',
-    'tokyo'                  => 'whois.nic.tokyo',
-    'tools'                  => 'whois.donuts.co',
-    'town'                   => 'whois.donuts.co',
-    'toys'                   => 'whois.donuts.co',
-    'tr'                     => 'whois.nic.tr',
-    'trade'                  => 'whois.nic.trade',
-    'training'               => 'whois.donuts.co',
-    'travel'                 => 'whois.nic.travel',
-    'tw'                     => 'whois.twnic.net.tw',
-    'tz'                     => 'whois.tznic.or.tz',
-    'ua'                     => 'whois.ua',
-    'ug'                     => 'whois.co.ug',
-    'uk'                     => 'whois.nic.uk',
-    'university'             => 'whois.donuts.co',
-    'uno'                    => 'whois.nic.uno',
-    'us'                     => 'whois.nic.us',
-    'uy'                     => 'whois.nic.org.uy',
-    'uz'                     => 'whois.cctld.uz',
-    'vacations'              => 'whois.donuts.co',
-    'vc'                     => 'whois2.afilias-grs.net',
-    've'                     => 'whois.nic.ve',
-    'vegas'                  => 'whois.afilias-srs.net',
-    'ventures'               => 'whois.donuts.co',
-    'versicherung'           => 'whois.nic.versicherung',
-    'vet'                    => 'whois.rightside.co',
-    'vg'                     => 'ccwhois.ksregistry.net',
-    'viajes'                 => 'whois.donuts.co',
-    'villas'                 => 'whois.donuts.co',
-    'vision'                 => 'whois.donuts.co',
-    'vlaanderen'             => 'whois.nic.vlaanderen',
-    'vodka'                  => 'whois-dub.mm-registry.com',
-    'vote'                   => 'whois.afilias.net',
-    'voting'                 => 'whois.voting.tld-box.at',
-    'voto'                   => 'whois.afilias.net',
-    'voyage'                 => 'whois.donuts.co',
-    'vu'                     => 'vunic.vu',
-    'wang'                   => 'whois.gtld.knet.cn',
-    'watch'                  => 'whois.donuts.co',
-    'webcam'                 => 'whois.nic.webcam',
-    'website'                => 'whois.nic.website',
-    'wed'                    => 'whois.nic.wed',
-    'wf'                     => 'whois.nic.wf',
-    'wien'                   => 'whois.nic.wien',
-    'wiki'                   => 'whois.nic.wiki',
-    'works'                  => 'whois.donuts.co',
-    'ws'                     => 'whois.website.ws',
-    'wtc'                    => 'whois.nic.wtc',
-    'wtf'                    => 'whois.donuts.co',
-    'xxx'                    => 'whois.nic.xxx',
-    'xyz'                    => 'whois.nic.xyz',
-    'yachts'                 => 'whois.afilias-srs.net',
-    'yt'                     => 'whois.nic.yt',
-    'zip'                    => 'domain-registry-whois.l.google.com',
-    'zm'                     => 'whois.nic.zm',
-    'zone'                   => 'whois.donuts.co',
-    'net.au'                 => 'whois.aunic.net',
-    'ae.com'                 => 'whois.centralnic.net',
-    'br.com'                 => 'whois.centralnic.net',
-    'cn.com'                 => 'whois.centralnic.net',
-    'de.com'                 => 'whois.centralnic.net',
-    'eu.com'                 => 'whois.centralnic.net',
-    'gb.com'                 => 'whois.centralnic.net',
-    'hu.com'                 => 'whois.centralnic.net',
-    'jpn.com'                => 'whois.centralnic.net',
-    'kr.com'                 => 'whois.centralnic.net',
-    'no.com'                 => 'whois.centralnic.net',
-    'qc.com'                 => 'whois.centralnic.net',
-    'ru.com'                 => 'whois.centralnic.net',
-    'sa.com'                 => 'whois.centralnic.net',
-    'se.com'                 => 'whois.centralnic.net',
-    'uk.com'                 => 'whois.centralnic.net',
-    'us.com'                 => 'whois.centralnic.net',
-    'uy.com'                 => 'whois.centralnic.net',
-    'za.com'                 => 'whois.centralnic.net',
-    'com.my'                 => 'whois.mynic.net.my',
-    'gb.net'                 => 'whois.centralnic.net',
-    'se.net'                 => 'whois.centralnic.net',
-    'uk.net'                 => 'whois.centralnic.net',
-    'za.net'                 => 'http://www.za.net/cgi-bin/whois.cgi?domain={domain}.za.net',
-    'za.org'                 => 'http://www.za.net/cgi-bin/whois.cgi?domain={domain}.za.org',
-    'com.ru'                 => 'whois.nic.ru',
-    'msk.ru'                 => 'whois.nic.ru',
-    'net.ru'                 => 'whois.nic.ru',
-    'org.ru'                 => 'whois.nic.ru',
-    'pp.ru'                  => 'whois.nic.ru',
-    'sochi.su'               => 'whois.nic.ru',
-    'co.za'                  => 'http://co.za/cgi-bin/whois.sh?Domain={domain}.co.za',
-    'org.za'                 => 'http://www.org.za/cgi-bin/rwhois?domain={domain}.org.za&format=full',
-    'xn--3bst00m'            => 'whois.gtld.knet.cn',
-    'xn--3ds443g'            => 'whois.afilias-srs.net',
-    'xn--3e0b707e'           => 'whois.kr',
-    'xn--4gbrim'             => 'whois.afilias-srs.net',
-    'xn--55qw42g'            => 'whois.conac.cn',
-    'xn--55qx5d'             => 'whois.ngtld.cn',
-    'xn--6frz82g'            => 'whois.afilias.net',
-    'xn--6qq986b3xl'         => 'whois.gtld.knet.cn',
-    'xn--80adxhks'           => 'whois.nic.xn--80adxhks',
-    'xn--80ao21a'            => 'whois.nic.kz',
-    'xn--80asehdb'           => 'whois.online.rs.corenic.net',
-    'xn--80aswg'             => 'whois.site.rs.corenic.net',
-    'xn--c1avg'              => 'whois.publicinterestregistry.net',
-    'xn--cg4bki'             => 'whois.kr',
-    'xn--clchc0ea0b2g2a9gcd' => 'whois.sgnic.sg',
-    'xn--czru2d'             => 'whois.gtld.knet.cn',
-    'xn--d1acj3b'            => 'whois.nic.xn--d1acj3b',
-    'xn--fiq228c5hs'         => 'whois.afilias-srs.net',
-    'xn--fiq64b'             => 'whois.gtld.knet.cn',
-    'xn--fiqs8s'             => 'cwhois.cnnic.cn',
-    'xn--fiqz9s'             => 'cwhois.cnnic.cn',
-    'xn--i1b6b1a6a2e'        => 'whois.publicinterestregistry.net',
-    'xn--io0a7i'             => 'whois.ngtld.cn',
-    'xn--j1amh'              => 'whois.dotukr.com',
-    'xn--j6w193g'            => 'whois.hkirc.hk',
-    'xn--kprw13d'            => 'whois.twnic.net.tw',
-    'xn--kpry57d'            => 'whois.twnic.net.tw',
-    'xn--lgbbat1ad8j'        => 'whois.nic.dz',
-    'xn--mgb9awbf'           => 'whois.registry.om',
-    'xn--mgba3a4f16a'        => 'whois.nic.ir',
-    'xn--mgbaam7a8h'         => 'whois.aeda.net.ae',
-    'xn--mgbab2bd'           => 'whois.bazaar.coreregistry.net',
-    'xn--mgberp4a5d4ar'      => 'whois.nic.net.sa',
-    'xn--mgbx4cd0ab'         => 'whois.mynic.my',
-    'xn--ngbc5azd'           => 'whois.nic.xn--ngbc5azd',
-    'xn--nqv7f'              => 'whois.publicinterestregistry.net',
-    'xn--nqv7fs00ema'        => 'whois.publicinterestregistry.net',
-    'xn--o3cw4h'             => 'whois.thnic.co.th',
-    'xn--ogbpf8fl'           => 'whois.tld.sy',
-    'xn--p1ai'               => 'whois.tcinet.ru',
-    'xn--q9jyb4c'            => 'domain-registry-whois.l.google.com',
-    'xn--rhqv96g'            => 'whois.nic.xn--rhqv96g',
-    'xn--unup4y'             => 'whois.donuts.co',
-    'xn--wgbl6a'             => 'whois.registry.qa',
-    'xn--yfro4i67o'          => 'whois.sgnic.sg',
-    'xn--ygbi2ammx'          => 'whois.pnina.ps',
-    'xn--zfr164b'            => 'whois.conac.cn',
-),
+$this->WHOIS_SPECIAL = array(
+		'ad'	 => '',
+		'ae'	 => 'whois.aeda.net.ae',
+		'af'	 => 'whois.nic.af',
+		'ai'	 => 'http://whois.offshore.ai/cgi-bin/whois.pl?domain-name={domain}.ai',
+		'al'	 => '',
+		'az'	 => '',
+		'ba'	 => '',
+		'bb'	 => 'http://domains.org.bb/regsearch/getdetails.cfm?DND={domain}.bb',
+		'bg'	 => 'http://www.register.bg/bg-nic/displaydomain.pl?domain={domain}.bg&search=exist',
+		'bh'	 => 'whois.nic.bh',
+		'bi'	 => 'whois.nic.bi',
+		'bj'	 => 'whois.nic.bj',
+		'by'	 => '',
+		'bz'	 => 'whois2.afilias-grs.net',
+		'cy'	 => '',
+		'es'	 => '',
+		'fj'	 => 'whois.usp.ac.fj',
+		'fm'     => 'http://www.dot.fm/query_whois.cfm?domain={domain}&tld=fm',
+		'jobs'	 => 'jobswhois.verisign-grs.com',
+		'ke'	 => 'kenic.or.ke',
+		'la'	 => 'whois.centralnic.net',
+		'gr'	 => '',
+		'gs'     => 'http://www.adamsnames.tc/whois/?domain={domain}.gs',
+		'gt'	 => 'http://www.gt/Inscripcion/whois.php?domain={domain}.gt',
+		'me'	 => 'whois.meregistry.net',
+		'mobi'	 => 'whois.dotmobiregistry.net',
+		'ms'     => 'http://www.adamsnames.tc/whois/?domain={domain}.ms',
+		'mt'	 => 'http://www.um.edu.mt/cgi-bin/nic/whois?domain={domain}.mt',
+		'nl'	 => 'whois.domain-registry.nl',
+		'ly'	 => 'whois.nic.ly',
+		'pe'	 => 'kero.rcp.net.pe',
+		'pr'	 => 'whois.uprr.pr',
+		'pro'	 => 'whois.registry.pro',
+		'sc'     => 'whois2.afilias-grs.net',
+		'tc'     => 'http://www.adamsnames.tc/whois/?domain={domain}.tc',
+		'tf'     => 'http://www.adamsnames.tc/whois/?domain={domain}.tf',
+		've'	 => 'whois.nic.ve',
+		'vg'     => 'http://www.adamsnames.tc/whois/?domain={domain}.vg',
+		'net.au' => 'whois.aunic.net',
+		'ae.com' => 'whois.centralnic.net',
+		'br.com' => 'whois.centralnic.net',
+		'cn.com' => 'whois.centralnic.net',
+		'de.com' => 'whois.centralnic.net',
+		'eu.com' => 'whois.centralnic.net',
+		'hu.com' => 'whois.centralnic.net',
+		'jpn.com'=> 'whois.centralnic.net',
+		'kr.com' => 'whois.centralnic.net',
+		'gb.com' => 'whois.centralnic.net',
+		'no.com' => 'whois.centralnic.net',
+		'qc.com' => 'whois.centralnic.net',
+		'ru.com' => 'whois.centralnic.net',
+		'sa.com' => 'whois.centralnic.net',
+		'se.com' => 'whois.centralnic.net',
+		'za.com' => 'whois.centralnic.net',
+		'uk.com' => 'whois.centralnic.net',
+		'us.com' => 'whois.centralnic.net',
+		'uy.com' => 'whois.centralnic.net',
+		'gb.net' => 'whois.centralnic.net',
+		'se.net' => 'whois.centralnic.net',
+		'uk.net' => 'whois.centralnic.net',
+		'za.net' => 'whois.za.net',
+		'za.org' => 'whois.za.net',
+		'co.za'  => 'http://co.za/cgi-bin/whois.sh?Domain={domain}.co.za',
+		'org.za' => 'http://www.org.za/cgi-bin/rwhois?domain={domain}.org.za&format=full'
+		);
 /* handled gTLD whois servers */
-'WHOIS_GTLD_HANDLER' => array(
-    'whois.bulkregister.com' => 'enom',
-    'whois.dotregistrar.com' => 'dotster',
-    'whois.namesdirect.com'  => 'dotster',
-    'whois.psi-usa.info'     => 'psiusa',
-    'whois.www.tv'           => 'tvcorp',
-    'whois.tucows.com'       => 'opensrs',
-    'whois.35.com'           => 'onlinenic',
-    'whois.nominalia.com'    => 'genericb',
-    'whois.encirca.com'      => 'genericb',
-    'whois.corenic.net'      => 'genericb'
-),
-);
+$this->WHOIS_GTLD_HANDLER = array(
+		'whois.bulkregister.com'			=> 'enom',
+		'whois.dotregistrar.com'			=> 'dotster',
+		'whois.namesdirect.com'				=> 'dotster',
+		'whois.psi-usa.info'				=> 'psiusa',
+		'whois.www.tv'						=> 'tvcorp',
+		'whois.tucows.com'					=> 'opensrs',
+		'whois.35.com'						=> 'onlinenic',
+		'whois.nominalia.com'				=> 'genericb',
+		'whois.encirca.com'					=> 'genericb',
+		'whois.corenic.net'					=> 'genericb'
+		);
+/* Non ICANN TLD's */
+$this->WHOIS_NON_ICANN = array (
+		'agent'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'agente'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'america'	=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
+		'amor'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'amore'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'amour'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'arte'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'artes'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'arts'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'asta'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'auction'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'auktion'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'boutique'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'chat'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'chiesa'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'church'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'cia'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'ciao'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'cie'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'club'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'clube'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'com2'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
+		'deporte'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'ditta'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'earth'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
+		'eglise'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'enchere'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'escola'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'escuela'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'esporte'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'etc'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
+		'famiglia'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'familia'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'familie'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'family'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'free'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'hola'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'game'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'ges'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'gmbh'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'golf'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'gratis'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'gratuit'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'iglesia'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'igreja'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'inc'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'jeu'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'jogo'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'juego'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'kids'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'kirche'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'krunst'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'law'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'legge'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'lei'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'leilao'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'ley'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'liebe'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'lion'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
+		'llc'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'llp'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'loi'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'loja'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'love'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'ltd'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'makler'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'med'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'mp3'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'not'		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
+		'online'	=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
+		'recht'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'reise'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'resto'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'school'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'schule'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'scifi'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'scuola'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'shop'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'soc'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'spiel'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'sport'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'subasta'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'tec'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'tech'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'tienda'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'travel'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'turismo'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'usa' 		=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}',
+		'verein'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'viaje'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'viagem'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'video'		=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'voyage'	=> 'http://www.new.net/search_whois.tp?domain={domain}&tld={tld}',
+		'z'			=> 'http://www.adns.net/whois.php?txtDOMAIN={domain}.{tld}'
+		);
+?>

--- a/src/whois.si.php
+++ b/src/whois.si.php
@@ -1,45 +1,43 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__SI_HANDLER__'))
     define('__SI_HANDLER__', 1);
 require_once('whois.parser.php');
-class si_handler {
-    function parse($data_str, $query) {
-        $translate = array(
-            'nic-hdl' => 'handle',
-            'nameserver' => 'nserver'
-        );
-        $contacts = array(
-            'registrant' => 'owner',
-            'tech-c' => 'tech'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.arnes.si',
-            'registrar' => 'ARNES'
-        );
-        return $r;
+class si_handler
+    {
+    function parse($data_str, $query)
+        {
+		$translate = array(
+			'nic-hdl' => 'handle',
+			'nameserver' => 'nserver'
+			);
+		$contacts = array(
+                    'registrant' => 'owner',
+                    'tech-c' => 'tech'
+                        );
+		$r['regrinfo'] = generic_parser_a($data_str['rawdata'], $translate, $contacts, 'domain', 'Ymd');		
+		$r['regyinfo'] = array(
+                  'referrer' => 'http://www.arnes.si',
+                  'registrar' => 'ARNES'
+                  );
+		return $r;
+        }
     }
-}
+?>

--- a/src/whois.su.php
+++ b/src/whois.su.php
@@ -1,54 +1,52 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__SU_HANDLER__'))
-    define('__SU_HANDLER__', 1);
+	define('__SU_HANDLER__', 1);
 require_once('whois.parser.php');
-class su_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domain:' => 'domain.name',
-            'registrar:' => 'domain.sponsor',
-            'state:' => 'domain.status',
-            'person:' => 'owner.name',
-            'phone:' => 'owner.phone',
-            'e-mail:' => 'owner.email',
-            'created:' => 'domain.created',
-            'paid-till:' => 'domain.expires',
-                /*
+class su_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'domain:' => 'domain.name',
+                  'registrar:' => 'domain.sponsor',
+                  'state:' => 'domain.status',
+                  'person:' => 'owner.name',
+                  'phone:' => 'owner.phone',
+                  'e-mail:' => 'owner.email',
+                  'created:' => 'domain.created',
+                  'paid-till:' => 'domain.expires',
+/*
                   'nserver:' => 'domain.nserver.',
                   'source:' => 'domain.source',
                   'type:' => 'owner.type',
                   'org:' => 'owner.organization',
                   'fax-no:' => 'owner.fax',
-                 */
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.ripn.net',
-            'registrar' => 'RUCENTER-REG-RIPN'
-        );
-        return $r;
-    }
-}
+*/
+		              );
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'dmy');
+		$r['regyinfo'] = array(
+                            'referrer' => 'http://www.ripn.net',
+                            'registrar' => 'RUCENTER-REG-RIPN'
+                          );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.tel.php
+++ b/src/whois.tel.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__TEL_HANDLER__'))
-    define('__TEL_HANDLER__', 1);
+	define('__TEL_HANDLER__', 1);
 require_once('whois.parser.php');
-class tel_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], array(), 'mdy');
-        $r['regyinfo'] = array(
-            'referrer' => 'http://www.telnic.org',
-            'registrar' => 'Telnic'
-        );
-        return $r;
-    }
-}
+class tel_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, '-md--y');
+		$r['regyinfo'] = array(
+                  'referrer' => 'http://www.telnic.org',
+                  'registrar' => 'Telnic'
+                  );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.today.php
+++ b//dev/null
@@ -1,41 +0,0 @@
-<?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @copyright Copyright (c) 2020 Joshua Smith
- */
-if (!defined('__TODAY_HANDLER__')) {
-    define('__TODAY_HANDLER__', 1);
-}
-require_once('whois.parser.php');
-/**
- * Class today_handler
- */
-class today_handler
-{
-    function parse($data_str, $query)
-    {
-        $r = [
-            'regrinfo' => generic_parser_b($data_str['rawdata']),
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        if (!isset($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo']['domain']['name'] = $query;
-        }
-        return $r;
-    }
-}

--- a/src/whois.travel.php
+++ b/src/whois.travel.php
@@ -1,35 +1,33 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__TRAVEL_HANDLER__'))
-    define('__TRAVEL_HANDLER__', 1);
+	define('__TRAVEL_HANDLER__', 1);
 require_once('whois.parser.php');
-class travel_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        $r['regyinfo']['referrer'] = 'http://www.nic.travel/';
-        $r['regyinfo']['registrar'] = 'Tralliance Corporation';
-        return $r;
-    }
-}
+class travel_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		$r['regyinfo']['referrer'] = 'http://www.nic.travel/';
+		$r['regyinfo']['registrar'] = 'Tralliance Corporation';
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.uk.php
@@ -0,0 +1,66 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+if (!defined('__UK_HANDLER__'))
+	define('__UK_HANDLER__', 1);
+require_once('whois.parser.php');
+class uk_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                'owner.organization' => 'Registrant:',
+                'owner.address'  => "Registrant's address:",
+                'owner.type' 	 => 'Registrant type:',
+                'domain.created' => 'Registered on:',
+ 				'domain.changed' => 'Last updated:',
+                'domain.expires' => 'Renewal date:',
+                'domain.nserver' => 'Name servers:',
+                'domain.sponsor' => 'Registrar:',
+                'domain.status'	 => 'Registration status:',
+                'domain.dnssec'	 => 'DNSSEC:',
+                '' 				 => 'WHOIS lookup made at',
+                'disclaimer'	 => '--',
+		        );
+		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
+		if (isset($r['regrinfo']['owner']))
+			{
+			$r['regrinfo']['owner']['organization'] = $r['regrinfo']['owner']['organization'][0];
+			$r['regrinfo']['domain']['sponsor'] = $r['regrinfo']['domain']['sponsor'][0];
+			$r['regrinfo']['registered'] = 'yes';
+			$r = format_dates($r, 'dmy');
+			}
+		else
+			{
+			if (strpos($data_str['rawdata'][1],'Error for '))
+				{
+				$r['regrinfo']['registered'] = 'yes';
+				$r['regrinfo']['domain']['status'] = 'invalid';
+				}
+			else
+				$r['regrinfo']['registered'] = 'no';
+			}
+		$r['regyinfo'] = array(
+                    'referrer' => 'http://www.nominet.org.uk',
+                    'registrar' => 'Nominet UK'
+		                );
+		return $r;
+		}
+	}
+?>

--- a/src/whois.us.php
+++ b/src/whois.us.php
@@ -1,48 +1,34 @@
 <?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link      http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-if (!defined('__US_HANDLER__')) {
-    define('__US_HANDLER__', 1);
-}
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+*/
+if(!defined('__US_HANDLER__')) define('__US_HANDLER__',1);
 require_once('whois.parser.php');
 class us_handler
-{
-    /**
-     * @param array  $data_str
-     * @param string $query
-     *
-     * @return array
-     */
-    function parse($data_str, $query)
-    {
-        $r = [
-            'regrinfo' => generic_parser_b($data_str['rawdata'], [], 'ymd'),
-            'regyinfo' => [
-                'referrer'  => 'http://www.neustar.us',
-                'registrar' => 'NEUSTAR INC.',
-            ],
-            'rawdata'  => $data_str['rawdata'],
-        ];
-        return $r;
-    }
-}
+	{
+	function parse ($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata'], false, '-md--y');
+		$r['regyinfo'] = array(
+								'referrer'=>'http://www.neustar.us',
+								'registrar' => 'NEUSTAR INC.'
+							);
+		return $r;
+		}
+	}
+?>

--- a//dev/null
+++ b/src/whois.utils.php
@@ -0,0 +1,119 @@
+<?php
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
+ */
+class utils extends Whois {
+	function showObject(&$obj)
+		{
+		$r = $this->debugObject($obj);
+		return "<pre>$r</pre>\n";
+		}
+	function debugObject($obj,$indent=0)
+		{
+		if (is_array($obj))
+			{
+			$return = '';
+			foreach($obj as $k => $v)
+				{
+				$return .= str_repeat('&nbsp;',$indent);
+					if (is_array($v))
+						{
+						$return .= $k."->Array\n";
+						$return .= $this->debugObject($v,$indent+1);
+						}
+					else
+						{
+						$return .= $k."->$v\n";
+						}
+			}
+			return $return;
+		}
+	}
+	function ns_rr_defined($query) {
+		return checkdnsrr($query,'NS');
+	}
+	function showHTML($result, $link_myself=true, $params='query=$0&amp;output=nice') {
+		$email_regex = "/([-_\w\.]+)(@)([-_\w\.]+)\b/i";
+		$html_regex = "/(?:^|\b)((((http|https|ftp):\/\/)|(www\.))([\w\.]+)([,:%#&\/?~=\w+\.-]+))(?:\b|$)/is";
+		$ip_regex = "/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/i";
+		$out = '';
+		$lempty = true;
+		foreach($result['rawdata'] as $line)
+			{
+			$line = trim($line);
+			if ($line == '')
+				{
+				if ($lempty) continue;
+				else $lempty = true;
+				}
+			else
+				$lempty = false;
+			$out .= $line."\n";
+			}
+		if ($lempty) $out = trim($out);
+		$out = strip_tags($out);
+		$out = preg_replace ($email_regex, '<a href="mailto:$0">$0</a>', $out);
+		$out = preg_replace_callback ($html_regex, 'href_replace', $out);
+		if ($link_myself)
+			{
+			if ($params[0] == '/')
+				$link = $params;
+			else
+				$link = $_SERVER['PHP_SELF'].'?'.$params;
+			$out = preg_replace ($ip_regex, '<a href="'.$link.'">$0</a>', $out);
+			if (isset($result['regrinfo']['domain']['nserver']))
+				{
+				$nserver = $result['regrinfo']['domain']['nserver'];
+				}
+			else
+				$nserver = false;
+			if (isset($result['regrinfo']['network']['nserver']))
+				{
+				$nserver = $result['regrinfo']['network']['nserver'];
+				}
+			if (is_array($nserver))
+				{
+				reset($nserver); 
+				while (list($host, $ip) = each($nserver))
+					{
+					$url = '<a href="'. str_replace('$0',$ip,$link)."\">$host</a>";
+					$out = str_replace($host, $url, $out);
+					$out = str_replace(strtoupper($host), $url, $out);
+					}
+				}
+			}
+		$out = preg_replace ("/(?m)^([-\s\.&;'\w\t\(\)\/]+:\s*)/", '<b>$1</b>', $out);
+		$out = preg_replace ("/(?m)^(%.*)/", '<i>$0</i>', $out);
+		return str_replace("\n","<br/>\n",$out);
+	}
+}
+function href_replace($matches)
+{
+if (substr($matches[0],0,4)=='www.')
+	{
+	$web=$matches[0];
+	$url='http://'.$web;
+	}
+else
+	{
+	$web=$matches[0];
+	$url=$web;
+	}
+return '<a href="'.$url.'" target="_blank">'.$web.'</a>';
+}
+?>

--- a/src/whois.ve.php
+++ b/src/whois.ve.php
@@ -1,60 +1,60 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307,
+USA.
  */
 if (!defined('__VE_HANDLER__'))
-    define('__VE_HANDLER__', 1);
+	define('__VE_HANDLER__', 1);
 require_once('whois.parser.php');
-class ve_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'owner' => 'Titular:',
-            'domain.name' => 'Nombre de Dominio:',
-            'admin' => 'Contacto Administrativo',
-            'tech' => 'Contacto Tecnico',
-            'billing' => 'Contacto de Cobranza:',
-            'domain.created' => 'Fecha de Creacion:',
-            'domain.changed' => 'Ultima Actualizacion:',
-            'domain.expires' => 'Fecha de Vencimiento:',
-            'domain.status' => 'Estatus del dominio:',
-            'domain.nserver' => 'Servidor(es) de Nombres de Dominio'
-        );
-        $r = array();
-        $r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
-        if (!isset($r['regrinfo']['domain']['created']) || is_array($r['regrinfo']['domain']['created'])) {
-            $r['regrinfo'] = array('registered' => 'no');
-            return $r;
-        }
-        $dns = array();
-        foreach ($r['regrinfo']['domain']['nserver'] as $nserv) {
-            if ($nserv[0] == '-')
-                $dns[] = $nserv;
-        }
-        $r['regrinfo']['domain']['nserver'] = $dns;
-        $r['regrinfo'] = get_contacts($r['regrinfo']);
-        $r['regyinfo'] = array(
-            'referrer' => 'http://registro.nic.ve',
-            'registrar' => 'NIC-Venezuela - CNTI'
-        );
-        return $r;
-    }
-}
+class ve_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+						'owner'				=>	'Titular:',
+						'domain.name'		=>	'Nombre de Dominio:',
+						'admin'				=>	'Contacto Administrativo',
+						'tech'				=>	'Contacto Tecnico',
+						'billing'			=>	'Contacto de Cobranza:',
+						'domain.created'	=>	'Fecha de Creacion:',
+						'domain.changed'	=>	'Ultima Actualizacion:',
+						'domain.expires'	=>	'Fecha de Vencimiento:',
+						'domain.status'		=>	'Estatus del dominio:',
+						'domain.nserver'	=>	'Servidor(es) de Nombres de Dominio'
+		              );
+		$r['regrinfo'] = get_blocks($data_str['rawdata'], $items);
+		if (!isset($r['regrinfo']['domain']['created']) || is_array($r['regrinfo']['domain']['created']))
+			{
+			$r['regrinfo'] = array ( 'registered' => 'no');
+			return $r;
+			}
+		$dns = array();
+		foreach($r['regrinfo']['domain']['nserver'] as $nserv)
+			{
+			if ($nserv[0] == '-') $dns[] = $nserv;
+			}
+		$r['regrinfo']['domain']['nserver'] = $dns;
+		$r['regrinfo'] = get_contacts($r['regrinfo']);
+		$r['regyinfo'] = array(
+			'referrer'		=>	'http://registro.nic.ve',
+			'registrar'		=>	'NIC-Venezuela - CNTI'
+               );
+		return $r;		
+		}
+	}
+?>

--- a/src/whois.ws.php
+++ b/src/whois.ws.php
@@ -1,59 +1,60 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__WS_HANDLER__'))
-    define('__WS_HANDLER__', 1);
-use phpWhois\WhoisClient;
+  define('__WS_HANDLER__', 1);
 require_once('whois.parser.php');
-class ws_handler extends WhoisClient {
-    function parse($data_str, $query) {
-        $items = array(
-            'Domain Name:' => 'domain.name',
-            'Registrant Name:' => 'owner.organization',
-            'Registrant Email:' => 'owner.email',
-            'Domain Created:' => 'domain.created',
-            'Domain Last Updated:' => 'domain.changed',
-            'Registrar Name:' => 'domain.sponsor',
-            'Current Nameservers:' => 'domain.nserver.',
-            'Administrative Contact Email:' => 'admin.email',
-            'Administrative Contact Telephone:' => 'admin.phone',
-            'Registrar Whois:' => 'rwhois'
-        );
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
-        $r['regyinfo']['referrer'] = 'http://www.samoanic.ws';
-        $r['regyinfo']['registrar'] = 'Samoa Nic';
-        if (!empty($r['regrinfo']['domain']['name'])) {
-            $r['regrinfo']['registered'] = 'yes';
-            if (isset($r['regrinfo']['rwhois'])) {
-                if ($this->deepWhois) {
-                    $r['regyinfo']['whois'] = $r['regrinfo']['rwhois'];
-                    $r = $this->deepWhois($query, $r);
-                }
-                unset($r['regrinfo']['rwhois']);
-            }
-        } else
-            $r['regrinfo']['registered'] = 'no';
-        return $r;
+class ws_handler extends WhoisClient
+  {
+  function parse($data_str, $query)
+    {
+    $items = array(
+				'Domain Name:' 						=> 'domain.name',
+				'Registrant Name:' 					=> 'owner.organization',
+				'Registrant Email:' 				=> 'owner.email',
+				'Domain Created:' 					=> 'domain.created',
+				'Domain Last Updated:' 				=> 'domain.changed',
+				'Registrar Name:'					=> 'domain.sponsor',
+				'Current Nameservers:' 				=> 'domain.nserver.',
+				'Administrative Contact Email:' 	=> 'admin.email',
+				'Administrative Contact Telephone:' => 'admin.phone',
+				'Registrar Whois:'					=> 'rwhois'
+				);
+	$r['regrinfo'] = generic_parser_b($data_str['rawdata'], $items, 'ymd');
+    $r['regyinfo']['referrer'] = 'http://www.samoanic.ws';
+    $r['regyinfo']['registrar'] = 'Samoa Nic';
+    if (!empty($r['regrinfo']['domain']['name']))
+		{
+		$r['regrinfo']['registered'] = 'yes';
+		if (isset($r['regrinfo']['rwhois']))
+			{
+			if ($this->deep_whois)
+				{
+				$r['regyinfo']['whois']	= $r['regrinfo']['rwhois'];
+				$r = $this->DeepWhois($query,$r);
+				}
+			unset($r['regrinfo']['rwhois']);
+			}
+		}
+    else
+		$r['regrinfo']['registered'] = 'no';
+    return $r;
     }
-}
+  }
+?>

--- a/src/whois.xxx.php
+++ b/src/whois.xxx.php
@@ -1,37 +1,35 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__XXX_HANDLER__'))
-    define('__XXX_HANDLER__', 1);
+	define('__XXX_HANDLER__', 1);
 require_once('whois.parser.php');
-class xxx_handler {
-    function parse($data_str, $query) {
-        $r = array();
-        $r['regrinfo'] = generic_parser_b($data_str['rawdata']);
-        if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
-            $r['regrinfo']['registered'] = 'unknown';
-        $r['regyinfo']['referrer'] = 'http://www.pir.org/';
-        $r['regyinfo']['registrar'] = 'Public Interest Registry';
-        return $r;
-    }
-}
+class xxx_handler
+	{
+	function parse($data_str, $query)
+		{
+		$r['regrinfo'] = generic_parser_b($data_str['rawdata']);
+		if (!strncmp($data_str['rawdata'][0], 'WHOIS LIMIT EXCEEDED', 20))
+			$r['regrinfo']['registered'] = 'unknown';
+		$r['regyinfo']['referrer'] = 'http://www.pir.org/';
+		$r['regyinfo']['registrar'] = 'Public Interest Registry';
+		return $r;
+		}
+	}
+?>

--- a/src/whois.zanet.php
+++ b/src/whois.zanet.php
@@ -1,67 +1,71 @@
 <?php
-/**
- * @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- * 
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- * 
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- * 
- * @link http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
+/*
+Whois.php        PHP classes to conduct whois queries
+Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
+Maintained by David Saez
+For the most recent version of this package visit:
+http://www.phpwhois.org
+This program is free software; you can redistribute it and/or
+modify it under the terms of the GNU General Public License
+as published by the Free Software Foundation; either version 2
+of the License, or (at your option) any later version.
+This program is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  */
 if (!defined('__ZANET_HANDLER__'))
-    define('__ZANET_HANDLER__', 1);
+	define('__ZANET_HANDLER__', 1);
 require_once('whois.parser.php');
-class zanet_handler {
-    function parse($data_str, $query) {
-        $items = array(
-            'domain.name' => 'Domain Name            : ',
-            'domain.created' => 'Record Created         :',
-            'domain.changed' => 'Record	Last Updated    :',
-            'owner.name' => 'Registered for         :',
-            'admin' => 'Administrative Contact :',
-            'tech' => 'Technical Contact      :',
-            'domain.nserver' => 'Domain Name Servers listed in order:',
-            'registered' => 'No such domain: ',
-            '' => 'The ZA NiC whois'
-        );
-        $rawdata = array();
-        foreach ($data_str['rawdata'] as $line) {
-            if (strpos($line, ' Contact ') !== false) {
-                $pos = strpos($line, ':');
-                if ($pos !== false) {
-                    $rawdata[] = substr($line, 0, $pos + 1);
-                    $rawdata[] = trim(substr($line, $pos + 1));
-                    continue;
-                }
-            }
-            $rawdata[] = $line;
-        }
-        $r = array();
-        $r['regrinfo'] = get_blocks($rawdata, $items);
-        if (isset($r['regrinfo']['registered'])) {
-            $r['regrinfo']['registered'] = 'no';
-        } else {
-            if (isset($r['regrinfo']['admin']))
-                $r['regrinfo']['admin'] = get_contact($r['regrinfo']['admin']);
-            if (isset($r['regrinfo']['tech']))
-                $r['regrinfo']['tech'] = get_contact($r['regrinfo']['tech']);
-        }
-        $r['regyinfo']['referrer'] = 'http://www.za.net/'; // or http://www.za.org
-        $r['regyinfo']['registrar'] = 'ZA NiC';
-        format_dates($r, 'xmdxxy');
-        return $r;
-    }
-}
+class zanet_handler
+	{
+	function parse($data_str, $query)
+		{
+		$items = array(
+                  'domain.name' => 'Domain Name            : ',
+                  'domain.created' => 'Record Created         :',
+                  'domain.changed' => 'Record	Last Updated    :',
+                  'owner.name' => 'Registered for         :',
+                  'admin' => 'Administrative Contact :',
+                  'tech' => 'Technical Contact      :',
+                  'domain.nserver' => 'Domain Name Servers listed in order:',
+                  'registered' => 'No such domain: ',
+                  '' => 'The ZA NiC whois'
+		              );
+		$rawdata = array();
+		while (list($key, $line) = each($data_str['rawdata']))
+			{
+			if (strpos($line, ' Contact ') !== false)
+				{
+				$pos = strpos($line, ':');
+				if ($pos !== false)
+					{
+					$rawdata[] = substr($line, 0, $pos + 1);
+					$rawdata[] = trim(substr($line, $pos + 1));
+					continue;
+					}
+				}
+			$rawdata[] = $line;
+			}
+		$r['regrinfo'] = get_blocks($rawdata, $items);
+		if (isset($r['regrinfo']['registered']))
+			{
+			$r['regrinfo']['registered'] = 'no';
+			}
+		else
+			{
+			if (isset($r['regrinfo']['admin']))
+				$r['regrinfo']['admin'] = get_contact($r['regrinfo']['admin']);
+			if (isset($r['regrinfo']['tech']))
+				$r['regrinfo']['tech'] = get_contact($r['regrinfo']['tech']);
+			}
+		$r['regyinfo']['referrer'] = 'http://www.za.net/'; // or http://www.za.org
+		$r['regyinfo']['registrar'] = 'ZA NiC';
+		format_dates($r, 'xmdxxy');
+		return $r;
+		}
+	}
+?>

--- a/update-fixtures.php
+++ b//dev/null
@@ -1,55 +0,0 @@
-<?php
-/**
- * @license   http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2
- * @license
- * This program is free software; you can redistribute it and/or
- * modify it under the terms of the GNU General Public License
- * as published by the Free Software Foundation; either version 2
- * of the License, or (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful,
- * but WITHOUT ANY WARRANTY; without even the implied warranty of
- * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- * GNU General Public License for more details.
- *
- * You should have received a copy of the GNU General Public License
- * along with this program; if not, write to the Free Software
- * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
- *
- * @link      http://phpwhois.pw
- * @copyright Copyright (C)1999,2005 easyDNS Technologies Inc. & Mark Jeftovic
- * @copyright Maintained by David Saez
- * @copyright Copyright (c) 2014 Dmitry Lukashin
- */
-if (file_exists(__DIR__ . '/vendor/autoload.php')) {
-    require_once __DIR__ . '/vendor/autoload.php';
-}
-use phpWhois\Cli\CliHelper;
-use phpWhois\Whois;
-$fixturePath = 'tests/fixtures/';
-$cliHelper = new CliHelper();
-$domains   = $cliHelper->loadDomainList('./test.txt');
-if (!empty($argv[1]) && isset($domains[$argv[1]])) {
-    $domains = [$domains[$argv[1]]];
-}
-$whois = new Whois();
-stream_set_write_buffer(STDIN, 0);
-$domainCount = count($domains);
-$ndx         = 1;
-foreach ($domains as $domain) {
-    try {
-        echo "[$ndx/$domainCount] Creating fixture for `$domain`\n";
-        $result = $whois->whois($domain);
-        $safeDomain = makePathSafe($domain);
-        file_put_contents("{$fixturePath}/{$safeDomain}.txt", $result);
-        $ndx += 1;
-    } catch (Exception $exception) {
-        echo "  Exception: {$error->getMessage()}\n";
-    } catch (Error $error) {
-        echo "  Err: {$error->getMessage()}\n";
-    }
-}
-function makePathSafe(string $filename): string
-{
-    return str_replace(":", '-', $filename);
-}
