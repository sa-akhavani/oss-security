# ====================================================================
# FILE: decidim-accountability/lib/decidim/accountability/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Accountability
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-accountability/spec/system/explore_versions_spec.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 66-93 ---
    66|       expect(page).to have_current_path "#{result_path}/versions"
    67|     end
    68|     it "shows the version author and creation date" do
    69|       within ".card.extra.definition-data" do
    70|         expect(page).to have_content("test suite")
    71|         expect(page).to have_content(Time.zone.today.strftime("%d/%m/%Y"))
    72|       end
    73|     end
    74|     it "shows the changed attributes" do
    75|       expect(page).to have_content("Changes at")
    76|       within ".diff-for-progress" do
    77|         expect(page).to have_content("PROGRESS")
    78|         within ".diff > ul > .del" do
    79|           expect(page).to have_content("25.0")
    80|         end
    81|         within ".diff > ul > .ins" do
    82|           expect(page).to have_content("50.0")
    83|         end
    84|       end
    85|     end
    86|     context "when the version number is malformed" do
    87|       it "displays the page correctly" do
    88|         visit %{#{current_path}'XSS<script>alert('version')<%2Fscript>}
    89|         expect(page).to have_content("VERSION NUMBER\n2 out of 2")
    90|       end
    91|     end
    92|   end
    93| end


# ====================================================================
# FILE: decidim-admin/lib/decidim/admin/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Admin
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-api/lib/decidim/api/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Api
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-assemblies/lib/decidim/assemblies/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Assemblies
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-blogs/lib/decidim/blogs/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Blogs
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-budgets/lib/decidim/budgets/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Budgets
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-comments/lib/decidim/comments/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Comments
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-conferences/lib/decidim/conferences/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Conferences
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-consultations/lib/decidim/consultations/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Consultations
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-core/app/cells/decidim/version_cell.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 19-54 ---
    19|     end
    20|     def i18n_version_number
    21|       i18n("version_number")
    22|     end
    23|     def i18n_back_to_resource
    24|       i18n("back_to_resource")
    25|     end
    26|     def i18n_version_number_out_of_total
    27|       i18n("version_number_out_of_total", current_version: index, total_count: versioned_resource.versions.count)
    28|     end
    29|     def i18n_show_all_versions
    30|       i18n("show_all_versions")
    31|     end
    32|     def i18n_version_author
    33|       i18n("version_author")
    34|     end
    35|     def i18n_version_created_at
    36|       i18n("version_created_at")
    37|     end
    38|     def i18n(string, **params)
    39|       decidim_html_escape(t(string, **params, scope: i18n_scope, default: t(string, **params, scope: default_i18n_scope)))
    40|     end
    41|     def i18n_scope
    42|       options[:i18n_scope]
    43|     end
    44|     def default_i18n_scope
    45|       "decidim.version.show"
    46|     end
    47|     def index
    48|       options[:index]
    49|     end
    50|     def resource_path
    51|       Decidim::ResourceLocatorPresenter.new(versioned_resource).path
    52|     end
    53|   end
    54| end


# ====================================================================
# FILE: decidim-core/lib/decidim/core/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Core
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-debates/lib/decidim/debates/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Debates
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-debates/spec/system/debates_versions_spec.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 62-103 ---
    62|     it "shows the creation date" do
    63|       within ".card.extra.definition-data" do
    64|         expect(page).to have_content(Time.zone.today.strftime("%d/%m/%Y"))
    65|       end
    66|     end
    67|     it "shows the changed attributes" do
    68|       expect(page).to have_content("Changes at")
    69|       within ".diff-for-title-english" do
    70|         expect(page).to have_content("TITLE")
    71|         within ".diff > ul > .ins" do
    72|           expect(page).to have_content(debate.title["en"])
    73|         end
    74|       end
    75|       within ".diff-for-description-english" do
    76|         expect(page).to have_content("DESCRIPTION")
    77|         within ".diff > ul > .ins" do
    78|           expect(page).to have_content(debate.description["en"])
    79|         end
    80|       end
    81|     end
    82|     context "when the version number is malformed" do
    83|       it "displays the page correctly" do
    84|         visit %{#{current_path}'XSS<script>alert('version')<%2Fscript>}
    85|         expect(page).to have_content("VERSION NUMBER\n2 out of 2")
    86|       end
    87|     end
    88|   end
    89|   def update_debate
    90|     form = Decidim::Debates::Admin::DebateForm.from_params(
    91|       debate.attributes.with_indifferent_access.merge(
    92|         title: { "en" => "New title" },
    93|         description: { "en" => "New description" },
    94|         instructions: { "en" => "New instructions" }
    95|       )
    96|     ).with_context(
    97|       current_organization: organization,
    98|       current_participatory_space: component.participatory_space,
    99|       current_component: component
   100|     )
   101|     Decidim::Debates::Admin::UpdateDebate.call(form, debate)
   102|   end
   103| end


# ====================================================================
# FILE: decidim-dev/lib/decidim/dev/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Dev
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-elections/lib/decidim/elections/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Elections
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-forms/lib/decidim/forms/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Forms
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-generators/lib/decidim/generators/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Generators
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-initiatives/lib/decidim/initiatives/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Initiatives
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-initiatives/spec/system/initiatives_versions_spec.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 86-113 ---
    86|     it "shows the creation date" do
    87|       within ".card.extra.definition-data" do
    88|         expect(page).to have_content(Time.zone.today.strftime("%d/%m/%Y"))
    89|       end
    90|     end
    91|     it "shows the changed attributes" do
    92|       expect(page).to have_content("Changes at")
    93|       within ".diff-for-title-english" do
    94|         expect(page).to have_content("TITLE")
    95|         within ".diff > ul > .ins" do
    96|           expect(page).to have_content(translated(initiative.title, locale: :en))
    97|         end
    98|       end
    99|       within ".diff-for-description-english" do
   100|         expect(page).to have_content("DESCRIPTION")
   101|         within ".diff > ul > .ins" do
   102|           expect(page).to have_content(ActionView::Base.full_sanitizer.sanitize(translated(initiative.description, locale: :en), tags: []))
   103|         end
   104|       end
   105|     end
   106|     context "when the version number is malformed" do
   107|       it "displays the page correctly" do
   108|         visit %{#{current_path}'XSS<script>alert('version')<%2Fscript>}
   109|         expect(page).to have_content("VERSION NUMBER\n2 out of 2")
   110|       end
   111|     end
   112|   end
   113| end


# ====================================================================
# FILE: decidim-meetings/lib/decidim/meetings/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Meetings
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-meetings/spec/system/explore_versions_spec.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 69-96 ---
    69|       expect(page).to have_current_path "#{meeting_path}/versions"
    70|     end
    71|     it "shows the version author and creation date" do
    72|       within ".card.extra.definition-data" do
    73|         expect(page).to have_content("test suite")
    74|         expect(page).to have_content(Time.zone.today.strftime("%d/%m/%Y"))
    75|       end
    76|     end
    77|     it "shows the changed attributes" do
    78|       expect(page).to have_content("Changes at")
    79|       within ".diff-for-title-english" do
    80|         expect(page).to have_content("TITLE (ENGLISH)")
    81|         within ".diff > ul > .del" do
    82|           expect(page).to have_content("My title")
    83|         end
    84|         within ".diff > ul > .ins" do
    85|           expect(page).to have_content("My updated title")
    86|         end
    87|       end
    88|     end
    89|     context "when the version number is malformed" do
    90|       it "displays the page correctly" do
    91|         visit %{#{current_path}'XSS<script>alert('version')<%2Fscript>}
    92|         expect(page).to have_content("VERSION NUMBER\n2 out of 2")
    93|       end
    94|     end
    95|   end
    96| end


# ====================================================================
# FILE: decidim-pages/lib/decidim/pages/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Pages
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-participatory_processes/lib/decidim/participatory_processes/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module ParticipatoryProcesses
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-proposals/lib/decidim/proposals/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Proposals
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-proposals/spec/system/collaborative_drafts_versions_spec.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 72-115 ---
    72|       expect(page).to have_content("Changes at")
    73|       within ".diff-for-title" do
    74|         expect(page).to have_content("TITLE")
    75|         within ".diff > ul > .del" do
    76|           expect(page).to have_content(original_title)
    77|         end
    78|         within ".diff > ul > .ins" do
    79|           expect(page).to have_content(edited_title)
    80|         end
    81|       end
    82|       within ".diff-for-body" do
    83|         expect(page).to have_content("BODY")
    84|         within ".diff > ul > .del" do
    85|           expect(page).to have_content(original_body)
    86|         end
    87|         within ".diff > ul > .ins" do
    88|           expect(page).to have_content(edited_body)
    89|         end
    90|       end
    91|     end
    92|     context "when the version number is malformed" do
    93|       it "displays the page correctly" do
    94|         visit %{#{current_path}'XSS<script>alert('version')<%2Fscript>}
    95|         expect(page).to have_content("VERSION NUMBER\n2 out of 2")
    96|       end
    97|     end
    98|   end
    99|   context "when visiting the collaborative draft details" do
   100|     before do
   101|       Decidim.traceability.update!(
   102|         collaborative_draft,
   103|         author,
   104|         title: "Edited title another time"
   105|       )
   106|       visit collaborative_draft_path
   107|     end
   108|     it "shows number of versions" do
   109|       expect(page).to have_css(".versions_status", text: collaborative_draft.versions.count)
   110|     end
   111|     it "shows number of authors" do
   112|       expect(page).to have_css(".authors_status", text: collaborative_draft.versions.group_by(&:whodunnit).size)
   113|     end
   114|   end
   115| end


# ====================================================================
# FILE: decidim-proposals/spec/system/proposals_versions_spec.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 88-115 ---
    88|       expect(page).to have_content("Changes at")
    89|       within ".diff-for-title" do
    90|         expect(page).to have_content("TITLE")
    91|         within ".diff > ul > .del" do
    92|           expect(page).to have_content(translated(proposal.title))
    93|         end
    94|         within ".diff > ul > .ins" do
    95|           expect(page).to have_content(translated(emendation.title))
    96|         end
    97|       end
    98|       within ".diff-for-body" do
    99|         expect(page).to have_content("BODY")
   100|         within ".diff > ul > .del" do
   101|           expect(page).to have_content(translated(proposal.body))
   102|         end
   103|         within ".diff > ul > .ins" do
   104|           expect(page).to have_content(translated(emendation.body))
   105|         end
   106|       end
   107|     end
   108|     context "when the version number is malformed" do
   109|       it "displays the page correctly" do
   110|         visit %{#{current_path}'XSS<script>alert('version')<%2Fscript>}
   111|         expect(page).to have_content("VERSION NUMBER\n2 out of 2")
   112|       end
   113|     end
   114|   end
   115| end


# ====================================================================
# FILE: decidim-sortitions/lib/decidim/sortitions/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Sortitions
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-surveys/lib/decidim/surveys/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Surveys
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-system/lib/decidim/system/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module System
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-templates/lib/decidim/templates/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Templates
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: decidim-verifications/lib/decidim/verifications/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-7 ---
     1| module Decidim
     2|   module Verifications
     3|     def self.version
     4|       "0.27.8"
     5|     end
     6|   end
     7| end


# ====================================================================
# FILE: lib/decidim/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-5 ---
     1| module Decidim
     2|   def self.version
     3|     "0.27.8"
     4|   end
     5| end

