# ====================================================================
# FILE: lib/measured/cache/json.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-27 ---
     1| module Measured::Cache
     2|   class Json
     3|     attr_reader :filename, :path
     4|     def initialize(filename)
     5|       @filename = filename
     6|       raise ArgumentError, "Invalid cache file: #{filename}" unless %w[length.json weight.json volume.json test.json].include?(filename.to_s)
     7|       @path = Pathname.new(File.join(File.dirname(__FILE__), "../../../cache", filename)).cleanpath
     8|     end
     9|     def exist?
    10|       File.exist?(@path)
    11|     end
    12|     def read
    13|       return unless exist?
    14|       decode(JSON.load(File.read(@path), nil, freeze: true))
    15|     end
    16|     def write(table)
    17|       raise ArgumentError, "Cannot overwrite file cache at runtime."
    18|     end
    19|     private
    20|     def encode(table)
    21|       table.each_with_object(table.dup) do |(k1, v1), accu|
    22|         v1.each do |k2, v2|
    23|           if v2.is_a?(Rational)
    24|             accu[k1][k2] = { "numerator" => v2.numerator, "denominator" => v2.denominator }
    25|           end
    26|         end
    27|       end


# ====================================================================
# FILE: lib/measured/version.rb
# Total hunks: 1
# ====================================================================
# --- HUNK 1: Lines 1-3 ---
     1| module Measured
     2|   VERSION = "3.2.1"
     3| end

