{
  "vuln_id": "GHSA-3j9m-hcv9-rpj8",
  "range_index": 0,
  "safe_id": "GHSA-3j9m-hcv9-rpj8",
  "package": "@grafana/data",
  "platform": "NPM",
  "actual_cwe": "CWE-79",
  "actual_cve": "CVE-2021-41174",
  "vulnerable_version": "v7.5.17 \u2192 v8.0.0",
  "patched_version": "v8.2.2 \u2192 v8.2.3",
  "target_cwes": [
    "CWE-506",
    "CWE-79",
    "CWE-1321",
    "CWE-78",
    "CWE-77"
  ],
  "diff_lines": 797,
  "diff_analysis": {
    "vulnerable": true,
    "cwe_found": "CWE-79",
    "evidence": "The OLD TypeScript code removed (`sanitize`, `escapeHtml`, `sanitizeUrl`, `sanitizeAngularInterpolation`, and their re-exports via textUtil) provided XSS protection for user-controlled strings and URLs. Reverting to the OLD state would *remove* these sanitization utilities from the codebase, meaning any existing or future uses that relied on them for neutralizing untrusted input would no longer be available, leading to improper neutralization of input during web page generation (XSS).",
    "analysis_time_seconds": 2.5,
    "token_usage": {
      "input_tokens": 7202,
      "output_tokens": 131,
      "total_tokens": 7333
    },
    "model": "gpt-5.1",
    "provider": "openai"
  },
  "dataset_version": "v3",
  "reverse_mode": true,
  "code_checked": "patched (-)",
  "detected_vulnerable": true,
  "correct_detection": false,
  "analyzed_at": "2026-02-04T01:03:07.671294",
  "model": "gpt-5.1"
}