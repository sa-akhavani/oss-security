{
  "vuln_id": "SNYK-PYTHON-MCIPY-13808388",
  "range_index": 0,
  "safe_id": "SNYK-PYTHON-MCIPY-13808388",
  "package": "mci-py",
  "platform": "PyPI",
  "actual_cwe": "CWE-22",
  "actual_cve": "",
  "vulnerable_version": "v1.0.0 \u2192 v1.1.0",
  "patched_version": "v1.0.0 \u2192 v1.1.0",
  "target_cwes": [
    "CWE-79",
    "CWE-1333",
    "CWE-94",
    "CWE-22",
    "CWE-352"
  ],
  "diff_lines": 2799,
  "diff_analysis": {
    "vulnerable": true,
    "cwe_found": "CWE-22",
    "evidence": "The OLD code removed in this diff had a PathValidator that enforced directory allow-lists and prevented file/CLI paths from escaping the schema context directory unless explicitly allowed. The NEW code deletes PathValidator usage in FileExecutor, CLIExecutor, and ToolManager, meaning reverting to the OLD code would *restore* these checks. Therefore, the OLD code is the one that contained the protection against path traversal, and the NEW code weakens it. Since the question asks if the OLD code was vulnerable, the answer is no for the OLD code; however, comparing behaviors shows that removing the OLD code\u2019s validation introduces a CWE-22 risk in the NEW version.",
    "analysis_time_seconds": 3.6,
    "token_usage": {
      "input_tokens": 26586,
      "output_tokens": 164,
      "total_tokens": 26750
    },
    "model": "gpt-5.1",
    "provider": "openai"
  },
  "dataset_version": "v3",
  "reverse_mode": true,
  "code_checked": "patched (-)",
  "detected_vulnerable": true,
  "correct_detection": false,
  "analyzed_at": "2026-02-04T01:06:02.706853",
  "model": "gpt-5.1"
}