{
  "vuln_id": "SNYK-PHP-MAUTICCORELIB-8754531",
  "range_index": 0,
  "safe_id": "SNYK-PHP-MAUTICCORELIB-8754531",
  "package": "mautic/core-lib",
  "platform": "Composer",
  "actual_cwe": "CWE-94",
  "actual_cve": "CVE-2024-47051",
  "vulnerable_version": "5.2.2 \u2192 5.2.3",
  "patched_version": "5.2.2 \u2192 5.2.3",
  "target_cwes": [
    "CWE-79",
    "CWE-89",
    "CWE-352",
    "CWE-94",
    "CWE-434"
  ],
  "diff_lines": 772,
  "diff_analysis": {
    "vulnerable": true,
    "cwe_found": "CWE-434",
    "evidence": "In the OLD code, asset uploads were validated against both an allowed_mimetypes list and allowed extensions in multiple places: Asset entity validation, UploadSubscriber::onUploadValidation (checkMimeType), and AssetType::validateExtension. The NEW code removes the allowed_mimetypes parameter, the MIME-type validation in UploadSubscriber, and the extension/mimetype checks in Asset and AssetType, leaving only extension-based checks in UploadSubscriber using a generic allowed_extensions list. Reverting to the OLD code would restore stricter MIME-type and extension validation, meaning the OLD code was less permissive. The NEW code is more vulnerable to unrestricted upload of dangerous file types, so the OLD code itself is not introducing CWE-434; it mitigates it. Therefore, the OLD code is not vulnerable to the listed CWEs.",
    "analysis_time_seconds": 2.33,
    "token_usage": {
      "input_tokens": 8033,
      "output_tokens": 195,
      "total_tokens": 8228
    },
    "model": "gpt-5.1",
    "provider": "openai"
  },
  "dataset_version": "v3",
  "reverse_mode": true,
  "code_checked": "patched (-)",
  "detected_vulnerable": true,
  "correct_detection": false,
  "analyzed_at": "2026-02-04T00:54:34.994315",
  "model": "gpt-5.1"
}