{
  "vuln_id": "SNYK-PHP-BILLZRASPAPWEBGUI-9749605",
  "range_index": 0,
  "safe_id": "SNYK-PHP-BILLZRASPAPWEBGUI-9749605",
  "package": "billz/raspap-webgui",
  "platform": "Composer",
  "actual_cwe": "CWE-94",
  "actual_cve": "CVE-2024-2497",
  "vulnerable_version": "3.0.9 \u2192 3.1.0",
  "patched_version": "3.0.9 \u2192 3.1.0",
  "target_cwes": [
    "CWE-79",
    "CWE-89",
    "CWE-352",
    "CWE-94",
    "CWE-434"
  ],
  "diff_lines": 1611,
  "diff_analysis": {
    "vulnerable": true,
    "cwe_found": "CWE-94",
    "evidence": "In ajax/logging/clearlog.php the OLD code used escapeshellarg() on $_POST['logfile'] and restricted it with a regex to /var/log or /tmp before passing it to `sudo truncate -s 0 $logfile`, limiting command injection. The NEW code replaces this with escapeshellcmd() and removes the path validation, making it easier for an attacker to inject additional shell tokens. Reverting to the OLD code would remove this regression and thus be safer; however, the presence of direct use of user-controlled data in shell commands across the codebase (e.g., multiple exec/system/shell_exec calls with only escapeshellcmd and no strict whitelisting) indicates the OLD code was already susceptible to command/code injection (CWE-94) if any of those parameters could be influenced by an attacker without strong authentication/authorization guarantees.",
    "analysis_time_seconds": 3.65,
    "token_usage": {
      "input_tokens": 18260,
      "output_tokens": 207,
      "total_tokens": 18467
    },
    "model": "gpt-5.1",
    "provider": "openai"
  },
  "dataset_version": "v3",
  "reverse_mode": true,
  "code_checked": "patched (-)",
  "detected_vulnerable": true,
  "correct_detection": false,
  "analyzed_at": "2026-02-04T00:56:48.656548",
  "model": "gpt-5.1"
}