{
  "vuln_id": "GHSA-f5f4-m7qp-w6gc",
  "package": "org.jooby:jooby",
  "platform": "Maven",
  "actual_cwe": "CWE-79",
  "actual_cve": "CVE-2019-15477",
  "vulnerable_version": "v1.6.3 \u2192 v1.6.4",
  "patched_version": "v1.6.3 \u2192 v1.6.4",
  "target_cwes": [
    "CWE-79",
    "CWE-352",
    "CWE-502",
    "CWE-89",
    "CWE-862"
  ],
  "diff_lines": 152,
  "diff_analysis": {
    "vulnerable": true,
    "cwe_found": "CWE-79",
    "evidence": "In the old code, Err.DefHandler directly used ex.toMap(stackstrace) as the model for the HTML error view without any output encoding or XSS filtering of fields like \"message\" or \"reason\", which can contain user-controlled data (e.g., request path, parameters). The patch introduces an Env-based XSS filter (env.xss(\"html\")) and applies it to the \"message\" and \"reason\" fields before rendering, indicating the old implementation was vulnerable to reflected/stored XSS in error pages.",
    "analysis_time_seconds": 2.67,
    "token_usage": {
      "input_tokens": 1876,
      "output_tokens": 140,
      "total_tokens": 2016
    },
    "model": "gpt-5.1",
    "provider": "openai"
  },
  "reverse_mode": false,
  "code_checked": "vulnerable (+)",
  "detected_vulnerable": true,
  "correct_detection": true,
  "analyzed_at": "2026-01-30T22:51:01.299030",
  "model": "gpt-5.1"
}