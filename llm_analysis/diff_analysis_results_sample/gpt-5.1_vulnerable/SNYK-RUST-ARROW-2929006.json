{
  "vuln_id": "SNYK-RUST-ARROW-2929006",
  "package": "arrow",
  "platform": "Crates",
  "actual_cwe": "CWE-120",
  "actual_cve": "",
  "vulnerable_version": "6.3.0 \u2192 6.4.0",
  "patched_version": "6.3.0 \u2192 6.4.0",
  "target_cwes": [
    "CWE-787",
    "CWE-125",
    "CWE-120",
    "CWE-770",
    "CWE-476"
  ],
  "diff_lines": 1734,
  "diff_analysis": {
    "vulnerable": true,
    "cwe_found": "CWE-125",
    "evidence": "The old ArrayData::validate implementation only performed shallow structural checks and did not verify that offset buffers for variable-length arrays (Utf8, Binary, List, LargeList, etc.) were within bounds, monotonic, or that dictionary indices were within the valid range. This allowed constructing ArrayData with crafted offset or index buffers that could cause out-of-bounds reads when later accessed. The patch adds validate_full, typed_offsets, validate_each_offset, validate_utf8, validate_offsets_full, and check_bounds, and switches try_new to call validate_full(), enforcing offset and index bounds and preventing such out-of-bounds reads.",
    "analysis_time_seconds": 2.42,
    "token_usage": {
      "input_tokens": 15822,
      "output_tokens": 157,
      "total_tokens": 15979
    },
    "model": "gpt-5.1",
    "provider": "openai"
  },
  "reverse_mode": false,
  "code_checked": "vulnerable (+)",
  "detected_vulnerable": true,
  "correct_detection": true,
  "analyzed_at": "2026-01-30T22:49:11.395449",
  "model": "gpt-5.1"
}